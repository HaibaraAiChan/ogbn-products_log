main start at this time 1648592330.2622528
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7701554298400879
random selection method range initialization spend 0.01898932456970215
time for parepare:  0.3857710361480713
local_output_nid generation:  0.0070645809173583984
local_in_edges_tensor generation:  0.046272993087768555
mini_batch_src_global generation:  0.028308629989624023
r_  generation:  0.3660421371459961
local_output_nid generation:  0.007101774215698242
local_in_edges_tensor generation:  0.01643204689025879
mini_batch_src_global generation:  0.0337677001953125
r_  generation:  0.4049804210662842
local_output_nid generation:  0.007050275802612305
local_in_edges_tensor generation:  0.012925386428833008
mini_batch_src_global generation:  0.02312755584716797
r_  generation:  0.4224507808685303
local_output_nid generation:  0.007123231887817383
local_in_edges_tensor generation:  0.01854419708251953
mini_batch_src_global generation:  0.0258481502532959
r_  generation:  0.4489586353302002
local_output_nid generation:  0.007048845291137695
local_in_edges_tensor generation:  0.01489400863647461
mini_batch_src_global generation:  0.027504682540893555
r_  generation:  0.4733600616455078
local_output_nid generation:  0.007102012634277344
local_in_edges_tensor generation:  0.02184772491455078
mini_batch_src_global generation:  0.030623912811279297
r_  generation:  0.5314385890960693
local_output_nid generation:  0.009544134140014648
local_in_edges_tensor generation:  0.01718306541442871
mini_batch_src_global generation:  0.031769752502441406
r_  generation:  0.49639105796813965
local_output_nid generation:  0.008425474166870117
local_in_edges_tensor generation:  0.01418447494506836
mini_batch_src_global generation:  0.03262472152709961
r_  generation:  0.5050172805786133
local_output_nid generation:  0.007141828536987305
local_in_edges_tensor generation:  0.011930227279663086
mini_batch_src_global generation:  0.03415870666503906
r_  generation:  0.5072925090789795
local_output_nid generation:  0.007106781005859375
local_in_edges_tensor generation:  0.010741949081420898
mini_batch_src_global generation:  0.03520512580871582
r_  generation:  0.5114169120788574
local_output_nid generation:  0.007191658020019531
local_in_edges_tensor generation:  0.010348320007324219
mini_batch_src_global generation:  0.03684234619140625
r_  generation:  0.5196890830993652
local_output_nid generation:  0.019041776657104492
local_in_edges_tensor generation:  0.015013456344604492
mini_batch_src_global generation:  0.042275190353393555
r_  generation:  0.5418097972869873
local_output_nid generation:  0.007151603698730469
local_in_edges_tensor generation:  0.033262014389038086
mini_batch_src_global generation:  0.03929305076599121
r_  generation:  0.5278012752532959
local_output_nid generation:  0.008280277252197266
local_in_edges_tensor generation:  0.04223465919494629
mini_batch_src_global generation:  0.04055523872375488
r_  generation:  0.5502722263336182
local_output_nid generation:  0.007155418395996094
local_in_edges_tensor generation:  0.028343677520751953
mini_batch_src_global generation:  0.04146289825439453
r_  generation:  0.5286209583282471
local_output_nid generation:  0.00838923454284668
local_in_edges_tensor generation:  0.02087092399597168
mini_batch_src_global generation:  0.042298316955566406
r_  generation:  0.5178799629211426
----------------------check_connections_block total spend ----------------------------- 10.694467067718506
generate_one_block  6.177558898925781
generate_one_block  0.557713508605957
generate_one_block  0.5256743431091309
generate_one_block  0.5032684803009033
generate_one_block  0.5115134716033936
generate_one_block  0.5079607963562012
generate_one_block  0.5534279346466064
generate_one_block  0.5517895221710205
generate_one_block  0.5494601726531982
generate_one_block  0.5126008987426758
generate_one_block  0.5457484722137451
generate_one_block  0.5112423896789551
generate_one_block  0.5047976970672607
generate_one_block  0.5031828880310059
generate_one_block  0.5126686096191406
generate_one_block  0.5067791938781738
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.357233762741089
gen group dst list time:  0.2266995906829834
time for parepare:  0.4576103687286377
local_output_nid generation:  0.1602954864501953
local_in_edges_tensor generation:  0.790492057800293
mini_batch_src_global generation:  0.8736841678619385
r_  generation:  10.17169976234436
local_output_nid generation:  0.1641528606414795
local_in_edges_tensor generation:  0.6376826763153076
mini_batch_src_global generation:  1.120373249053955
r_  generation:  10.271819829940796
local_output_nid generation:  0.1646442413330078
local_in_edges_tensor generation:  0.6756458282470703
mini_batch_src_global generation:  1.0897080898284912
r_  generation:  10.419919490814209
local_output_nid generation:  0.19371771812438965
local_in_edges_tensor generation:  0.9386835098266602
mini_batch_src_global generation:  1.1034324169158936
r_  generation:  10.6402006149292
local_output_nid generation:  0.16716742515563965
local_in_edges_tensor generation:  0.668853759765625
mini_batch_src_global generation:  1.198004961013794
r_  generation:  10.676106452941895
local_output_nid generation:  0.1983335018157959
local_in_edges_tensor generation:  0.8292214870452881
mini_batch_src_global generation:  1.1292617321014404
r_  generation:  10.810601234436035
local_output_nid generation:  0.17038607597351074
local_in_edges_tensor generation:  0.6583640575408936
mini_batch_src_global generation:  1.2294886112213135
r_  generation:  10.719912767410278
local_output_nid generation:  0.2094893455505371
local_in_edges_tensor generation:  0.8316817283630371
mini_batch_src_global generation:  1.1388869285583496
r_  generation:  10.788150548934937
local_output_nid generation:  0.16675138473510742
local_in_edges_tensor generation:  0.6568319797515869
mini_batch_src_global generation:  1.2234933376312256
r_  generation:  10.72753357887268
local_output_nid generation:  0.19764328002929688
local_in_edges_tensor generation:  0.8404541015625
mini_batch_src_global generation:  1.1422624588012695
r_  generation:  10.868167400360107
local_output_nid generation:  0.16889643669128418
local_in_edges_tensor generation:  0.6588406562805176
mini_batch_src_global generation:  1.236384630203247
r_  generation:  10.89539361000061
local_output_nid generation:  0.19752883911132812
local_in_edges_tensor generation:  0.8392469882965088
mini_batch_src_global generation:  1.1419460773468018
r_  generation:  10.909690141677856
local_output_nid generation:  0.16942214965820312
local_in_edges_tensor generation:  0.6612608432769775
mini_batch_src_global generation:  1.235158920288086
r_  generation:  10.76587438583374
local_output_nid generation:  0.1974630355834961
local_in_edges_tensor generation:  0.8283023834228516
mini_batch_src_global generation:  1.155569314956665
r_  generation:  10.854047775268555
local_output_nid generation:  0.1682877540588379
local_in_edges_tensor generation:  0.6552023887634277
mini_batch_src_global generation:  1.2402372360229492
r_  generation:  10.82464861869812
local_output_nid generation:  0.19899773597717285
local_in_edges_tensor generation:  0.8434367179870605
mini_batch_src_global generation:  1.144226312637329
r_  generation:  10.836726427078247
----------------------check_connections_block total spend ----------------------------- 233.21464443206787
generate_one_block  15.580035209655762
generate_one_block  15.179177522659302
generate_one_block  14.780569314956665
generate_one_block  14.874083518981934
generate_one_block  15.15746521949768
generate_one_block  14.618061542510986
generate_one_block  15.167720794677734
generate_one_block  15.083601951599121
generate_one_block  14.887342691421509
generate_one_block  15.238939046859741
generate_one_block  14.882616758346558
generate_one_block  14.871405124664307
generate_one_block  15.146974086761475
generate_one_block  15.13934850692749
generate_one_block  14.697617292404175
generate_one_block  15.236747980117798
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1927106380462646
gen group dst list time:  1.051006555557251
time for parepare:  0.46762967109680176
local_output_nid generation:  0.5840177536010742
local_in_edges_tensor generation:  1.5659797191619873
mini_batch_src_global generation:  1.181851863861084
r_  generation:  16.764601469039917
local_output_nid generation:  0.6793158054351807
local_in_edges_tensor generation:  1.4143702983856201
mini_batch_src_global generation:  1.7164850234985352
r_  generation:  15.62997555732727
local_output_nid generation:  0.6694438457489014
local_in_edges_tensor generation:  1.3972759246826172
mini_batch_src_global generation:  1.6756551265716553
r_  generation:  15.86345100402832
local_output_nid generation:  0.6762280464172363
local_in_edges_tensor generation:  1.2850518226623535
mini_batch_src_global generation:  1.686232328414917
r_  generation:  16.142838716506958
local_output_nid generation:  0.6690595149993896
local_in_edges_tensor generation:  1.2815282344818115
mini_batch_src_global generation:  1.6760530471801758
r_  generation:  16.090580463409424
local_output_nid generation:  0.6658015251159668
local_in_edges_tensor generation:  2.651886224746704
mini_batch_src_global generation:  1.5165576934814453
r_  generation:  15.79577374458313
local_output_nid generation:  0.6740756034851074
local_in_edges_tensor generation:  1.2876720428466797
mini_batch_src_global generation:  1.7176361083984375
r_  generation:  16.148167610168457
local_output_nid generation:  0.6765036582946777
local_in_edges_tensor generation:  1.2909224033355713
mini_batch_src_global generation:  1.7744083404541016
r_  generation:  15.89328932762146
local_output_nid generation:  0.6650979518890381
local_in_edges_tensor generation:  1.3114867210388184
mini_batch_src_global generation:  1.7292563915252686
r_  generation:  16.27581810951233
local_output_nid generation:  0.6711053848266602
local_in_edges_tensor generation:  1.2985050678253174
mini_batch_src_global generation:  1.7955381870269775
r_  generation:  15.971827268600464
local_output_nid generation:  0.669379711151123
local_in_edges_tensor generation:  1.3034818172454834
mini_batch_src_global generation:  1.742382287979126
r_  generation:  16.122398138046265
local_output_nid generation:  0.6618242263793945
local_in_edges_tensor generation:  1.289961576461792
mini_batch_src_global generation:  1.7886919975280762
r_  generation:  15.955723285675049
local_output_nid generation:  0.6687412261962891
local_in_edges_tensor generation:  1.2953178882598877
mini_batch_src_global generation:  1.758286476135254
r_  generation:  16.233842134475708
local_output_nid generation:  0.6684837341308594
local_in_edges_tensor generation:  1.294219732284546
mini_batch_src_global generation:  1.7854046821594238
r_  generation:  16.118223905563354
local_output_nid generation:  0.6685843467712402
local_in_edges_tensor generation:  1.3072664737701416
mini_batch_src_global generation:  1.7566323280334473
r_  generation:  16.18364119529724
local_output_nid generation:  0.658104658126831
local_in_edges_tensor generation:  1.3004138469696045
mini_batch_src_global generation:  1.78167724609375
r_  generation:  16.00705361366272
----------------------check_connections_block total spend ----------------------------- 365.3655116558075
generate_one_block  21.75626492500305
generate_one_block  21.538493394851685
generate_one_block  21.44550609588623
generate_one_block  21.434475660324097
generate_one_block  21.58163070678711
generate_one_block  21.428585529327393
generate_one_block  22.457633018493652
generate_one_block  21.7277512550354
generate_one_block  21.378236055374146
generate_one_block  21.586835384368896
generate_one_block  21.52121877670288
generate_one_block  21.515623807907104
generate_one_block  21.505865573883057
generate_one_block  21.5254545211792
generate_one_block  21.494593620300293
generate_one_block  21.843188524246216
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  598.5801560878754
block generation total time  586.2830634117126
average batch blocks generation time:  36.64269146323204
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4305419921875 GB
    Memory Allocated: 1.3259963989257812  GigaBytes
Max Memory Allocated: 1.3259963989257812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3074951171875 GB
    Memory Allocated: 3.2491226196289062  GigaBytes
Max Memory Allocated: 3.488102912902832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.328155517578125  GigaBytes
Max Memory Allocated: 4.021461486816406  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.250659942626953  GigaBytes
Max Memory Allocated: 4.021461486816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.3271069526672363  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.246631145477295  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.3252172470092773  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.2378621101379395  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.328315258026123  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.24505615234375  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.3276915550231934  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.2512388229370117  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 1.3290419578552246  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 3.254835605621338  GigaBytes
Max Memory Allocated: 4.022971153259277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 1.3292961120605469  GigaBytes
Max Memory Allocated: 4.02679967880249  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 3.2510290145874023  GigaBytes
Max Memory Allocated: 4.02679967880249  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 1.3278694152832031  GigaBytes
Max Memory Allocated: 4.02679967880249  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 3.2476963996887207  GigaBytes
Max Memory Allocated: 4.02679967880249  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 1.3306903839111328  GigaBytes
Max Memory Allocated: 4.02679967880249  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.260819911956787  GigaBytes
Max Memory Allocated: 4.02679967880249  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.328597068786621  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.2521305084228516  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.328965187072754  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.25034236907959  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3283562660217285  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.2481093406677246  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.327059268951416  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.248831272125244  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.328765869140625  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.251553535461426  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.328991413116455  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.253828525543213  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36904509365558624 |0.5829312950372696 |0.046191081404685974 |0.00014531612396240234 |0.03447727859020233 |0.0029871463775634766 |
----------------------------------------------------------pseudo_mini_loss sum 8.734016418457031
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  73589445
Number of first layer input nodes during this epoch:  35462096
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 2.3555264472961426  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7140541076660156
random selection method range initialization spend 0.012887001037597656
time for parepare:  0.3752272129058838
local_output_nid generation:  0.0069615840911865234
local_in_edges_tensor generation:  0.03745675086975098
mini_batch_src_global generation:  0.02753138542175293
r_  generation:  0.3534080982208252
local_output_nid generation:  0.007224559783935547
local_in_edges_tensor generation:  0.009109973907470703
mini_batch_src_global generation:  0.03379559516906738
r_  generation:  0.40236783027648926
local_output_nid generation:  0.007218360900878906
local_in_edges_tensor generation:  0.009173154830932617
mini_batch_src_global generation:  0.024721145629882812
r_  generation:  0.4280390739440918
local_output_nid generation:  0.007191896438598633
local_in_edges_tensor generation:  0.009576797485351562
mini_batch_src_global generation:  0.025605440139770508
r_  generation:  0.4636380672454834
local_output_nid generation:  0.007195234298706055
local_in_edges_tensor generation:  0.010404109954833984
mini_batch_src_global generation:  0.029122591018676758
r_  generation:  0.48814964294433594
local_output_nid generation:  0.007239341735839844
local_in_edges_tensor generation:  0.012423992156982422
mini_batch_src_global generation:  0.0320124626159668
r_  generation:  0.5067203044891357
local_output_nid generation:  0.007151365280151367
local_in_edges_tensor generation:  0.009282350540161133
mini_batch_src_global generation:  0.031697750091552734
r_  generation:  0.5411050319671631
local_output_nid generation:  0.007197380065917969
local_in_edges_tensor generation:  0.009152412414550781
mini_batch_src_global generation:  0.03284859657287598
r_  generation:  0.555354118347168
local_output_nid generation:  0.007960081100463867
local_in_edges_tensor generation:  0.02178335189819336
mini_batch_src_global generation:  0.034281015396118164
r_  generation:  0.5203790664672852
local_output_nid generation:  0.0071926116943359375
local_in_edges_tensor generation:  0.014820098876953125
mini_batch_src_global generation:  0.035555124282836914
r_  generation:  0.5591111183166504
local_output_nid generation:  0.010282516479492188
local_in_edges_tensor generation:  0.022248029708862305
mini_batch_src_global generation:  0.03997468948364258
r_  generation:  0.5213828086853027
local_output_nid generation:  0.0073089599609375
local_in_edges_tensor generation:  0.016924381256103516
mini_batch_src_global generation:  0.03832268714904785
r_  generation:  0.5434243679046631
local_output_nid generation:  0.007422924041748047
local_in_edges_tensor generation:  0.013699054718017578
mini_batch_src_global generation:  0.03961586952209473
r_  generation:  0.5252909660339355
local_output_nid generation:  0.007291078567504883
local_in_edges_tensor generation:  0.01165151596069336
mini_batch_src_global generation:  0.04006338119506836
r_  generation:  0.5334210395812988
local_output_nid generation:  0.007319927215576172
local_in_edges_tensor generation:  0.010945320129394531
mini_batch_src_global generation:  0.04300189018249512
r_  generation:  0.5638437271118164
local_output_nid generation:  0.007216930389404297
local_in_edges_tensor generation:  0.014587879180908203
mini_batch_src_global generation:  0.04382514953613281
r_  generation:  0.5400865077972412
----------------------check_connections_block total spend ----------------------------- 10.772017478942871
generate_one_block  0.9015402793884277
generate_one_block  0.5451345443725586
generate_one_block  0.5216150283813477
generate_one_block  0.6357917785644531
generate_one_block  0.604057788848877
generate_one_block  0.7113237380981445
generate_one_block  0.5289208889007568
generate_one_block  0.5119194984436035
generate_one_block  0.5217533111572266
generate_one_block  0.5133261680603027
generate_one_block  0.5159728527069092
generate_one_block  0.5044357776641846
generate_one_block  0.5172882080078125
generate_one_block  0.5067927837371826
generate_one_block  0.5133748054504395
generate_one_block  0.5257551670074463
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.480879068374634
gen group dst list time:  0.2589092254638672
time for parepare:  0.5004668235778809
local_output_nid generation:  0.19201421737670898
local_in_edges_tensor generation:  0.7899107933044434
mini_batch_src_global generation:  0.9175071716308594
r_  generation:  10.548556089401245
local_output_nid generation:  0.20807600021362305
local_in_edges_tensor generation:  0.8631801605224609
mini_batch_src_global generation:  1.171703577041626
r_  generation:  10.5836660861969
local_output_nid generation:  0.17098474502563477
local_in_edges_tensor generation:  1.0653550624847412
mini_batch_src_global generation:  1.1541945934295654
r_  generation:  10.6093270778656
local_output_nid generation:  0.19520950317382812
local_in_edges_tensor generation:  0.8815264701843262
mini_batch_src_global generation:  1.1670851707458496
r_  generation:  10.712356090545654
local_output_nid generation:  0.20658159255981445
local_in_edges_tensor generation:  0.8521897792816162
mini_batch_src_global generation:  1.1665995121002197
r_  generation:  11.032542705535889
local_output_nid generation:  0.20473909378051758
local_in_edges_tensor generation:  0.6626484394073486
mini_batch_src_global generation:  1.1542761325836182
r_  generation:  11.074967861175537
local_output_nid generation:  0.1696915626525879
local_in_edges_tensor generation:  0.8551864624023438
mini_batch_src_global generation:  1.1875245571136475
r_  generation:  10.793163776397705
local_output_nid generation:  0.19640827178955078
local_in_edges_tensor generation:  0.8509116172790527
mini_batch_src_global generation:  1.3785552978515625
r_  generation:  11.202388763427734
local_output_nid generation:  0.21274924278259277
local_in_edges_tensor generation:  0.8683929443359375
mini_batch_src_global generation:  1.194230079650879
r_  generation:  10.848048448562622
local_output_nid generation:  0.18903589248657227
local_in_edges_tensor generation:  0.8497250080108643
mini_batch_src_global generation:  1.2846012115478516
r_  generation:  10.82849907875061
local_output_nid generation:  0.20412135124206543
local_in_edges_tensor generation:  0.8610739707946777
mini_batch_src_global generation:  1.227684497833252
r_  generation:  11.140033483505249
local_output_nid generation:  0.20521020889282227
local_in_edges_tensor generation:  0.6579954624176025
mini_batch_src_global generation:  1.2901787757873535
r_  generation:  11.334885835647583
local_output_nid generation:  0.20465970039367676
local_in_edges_tensor generation:  0.8375036716461182
mini_batch_src_global generation:  1.1678647994995117
r_  generation:  11.069756984710693
local_output_nid generation:  0.17151594161987305
local_in_edges_tensor generation:  0.8323006629943848
mini_batch_src_global generation:  1.2707173824310303
r_  generation:  10.8978431224823
local_output_nid generation:  0.1960155963897705
local_in_edges_tensor generation:  0.8565809726715088
mini_batch_src_global generation:  1.2407617568969727
r_  generation:  11.136663675308228
local_output_nid generation:  0.21677684783935547
local_in_edges_tensor generation:  0.6591923236846924
mini_batch_src_global generation:  1.2012512683868408
r_  generation:  11.164210796356201
----------------------check_connections_block total spend ----------------------------- 240.44938278198242
generate_one_block  15.5930335521698
generate_one_block  16.150010347366333
generate_one_block  15.46320652961731
generate_one_block  15.379016876220703
generate_one_block  15.505462884902954
generate_one_block  15.492473363876343
generate_one_block  15.469112634658813
generate_one_block  15.45255446434021
generate_one_block  15.469299077987671
generate_one_block  15.757771015167236
generate_one_block  15.504579305648804
generate_one_block  15.481587648391724
generate_one_block  15.563767433166504
generate_one_block  15.377925872802734
generate_one_block  15.599490880966187
generate_one_block  15.314048290252686
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2011101245880127
gen group dst list time:  1.0898246765136719
time for parepare:  0.48125147819519043
local_output_nid generation:  0.6086397171020508
local_in_edges_tensor generation:  1.407400369644165
mini_batch_src_global generation:  1.2092299461364746
r_  generation:  15.793595790863037
local_output_nid generation:  0.6747260093688965
local_in_edges_tensor generation:  1.4292807579040527
mini_batch_src_global generation:  1.5686140060424805
r_  generation:  15.877685308456421
local_output_nid generation:  0.6554388999938965
local_in_edges_tensor generation:  1.5736196041107178
mini_batch_src_global generation:  1.503152847290039
r_  generation:  16.142684936523438
local_output_nid generation:  0.6468782424926758
local_in_edges_tensor generation:  1.3158354759216309
mini_batch_src_global generation:  1.5374510288238525
r_  generation:  16.059497117996216
local_output_nid generation:  0.6875960826873779
local_in_edges_tensor generation:  1.2956781387329102
mini_batch_src_global generation:  1.5190660953521729
r_  generation:  16.2804856300354
local_output_nid generation:  0.6844916343688965
local_in_edges_tensor generation:  1.287510871887207
mini_batch_src_global generation:  1.5450170040130615
r_  generation:  16.23786163330078
local_output_nid generation:  0.6796503067016602
local_in_edges_tensor generation:  1.295011043548584
mini_batch_src_global generation:  1.5269761085510254
r_  generation:  16.406371116638184
local_output_nid generation:  0.667863130569458
local_in_edges_tensor generation:  1.2991394996643066
mini_batch_src_global generation:  1.5366404056549072
r_  generation:  16.33251667022705
local_output_nid generation:  0.670748233795166
local_in_edges_tensor generation:  1.2874577045440674
mini_batch_src_global generation:  1.6032750606536865
r_  generation:  16.375826597213745
local_output_nid generation:  0.6636383533477783
local_in_edges_tensor generation:  1.2933695316314697
mini_batch_src_global generation:  1.6905908584594727
r_  generation:  16.26397681236267
local_output_nid generation:  0.6740977764129639
local_in_edges_tensor generation:  1.3369524478912354
mini_batch_src_global generation:  1.6209566593170166
r_  generation:  16.35130000114441
local_output_nid generation:  0.6628565788269043
local_in_edges_tensor generation:  1.3088080883026123
mini_batch_src_global generation:  1.6052377223968506
r_  generation:  16.160715341567993
local_output_nid generation:  0.6698477268218994
local_in_edges_tensor generation:  1.2849702835083008
mini_batch_src_global generation:  1.7445399761199951
r_  generation:  16.448165893554688
local_output_nid generation:  0.659959077835083
local_in_edges_tensor generation:  3.003675937652588
mini_batch_src_global generation:  1.5906412601470947
r_  generation:  16.04599618911743
local_output_nid generation:  0.7007477283477783
local_in_edges_tensor generation:  1.3025720119476318
mini_batch_src_global generation:  1.6620032787322998
r_  generation:  16.420849084854126
local_output_nid generation:  0.6577415466308594
local_in_edges_tensor generation:  1.3080356121063232
mini_batch_src_global generation:  1.6385748386383057
r_  generation:  16.306150674819946
----------------------check_connections_block total spend ----------------------------- 366.87584614753723
generate_one_block  21.83121657371521
generate_one_block  21.700435638427734
generate_one_block  21.713814735412598
generate_one_block  21.654509782791138
generate_one_block  21.499825954437256
generate_one_block  21.787830352783203
generate_one_block  21.898907899856567
generate_one_block  22.476784706115723
generate_one_block  21.648000240325928
generate_one_block  21.68287706375122
generate_one_block  21.673951387405396
generate_one_block  21.65852999687195
generate_one_block  21.773075342178345
generate_one_block  21.637726545333862
generate_one_block  21.673340559005737
generate_one_block  21.673272609710693
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 2.3555264472961426  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

connection checking time:  607.3252289295197
block generation total time  596.5574395656586
average batch blocks generation time:  37.28483997285366
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3286590576171875  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.251474380493164  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3290882110595703  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.252331256866455  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3273077011108398  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.250415802001953  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3285126686096191  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.2521238327026367  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3274831771850586  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.246490001678467  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3290772438049316  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.250257968902588  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3279824256896973  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.2498693466186523  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3308305740356445  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.26084566116333  GigaBytes
Max Memory Allocated: 4.031348705291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3276457786560059  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.2453908920288086  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3286771774291992  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.251047134399414  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.329319953918457  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.2529778480529785  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3289661407470703  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.253322124481201  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3279285430908203  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.250454902648926  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3274116516113281  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.24383544921875  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.328169822692871  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.250101089477539  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 1.3253579139709473  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2371826171875 GB
    Memory Allocated: 3.2422494888305664  GigaBytes
Max Memory Allocated: 4.033766269683838  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3828699290752411 |0.45472781360149384 |0.003732725977897644 |0.00013945996761322021 |0.0048770904541015625 |0.001565694808959961 |
----------------------------------------------------------pseudo_mini_loss sum 5.073486804962158
Total (block generation + training)time/epoch 1278.8977346420288
Training time/epoch 1648594918.486741
Training time without block to device /epoch 1648594911.211096
Training time without total dataloading part /epoch 0.1415541172027588
load block tensor time/epoch 6.125918865203857
block to device time/epoch 7.275645017623901
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  73591719
Number of first layer input nodes during this epoch: Using backend: pytorch
 35461061
