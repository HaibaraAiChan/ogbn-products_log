main start at this time 1648539804.6377783
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.39003968238830566
random selection method range initialization spend 0.01623082160949707
time for parepare:  0.28107452392578125
local_output_nid generation:  0.0064699649810791016
local_in_edges_tensor generation:  0.04012870788574219
mini_batch_src_global generation:  0.016652584075927734
r_  generation:  0.18595051765441895
local_output_nid generation:  0.007245063781738281
local_in_edges_tensor generation:  0.006523847579956055
mini_batch_src_global generation:  0.029285907745361328
r_  generation:  0.25802111625671387
local_output_nid generation:  0.007354736328125
local_in_edges_tensor generation:  0.011667966842651367
mini_batch_src_global generation:  0.02991771697998047
r_  generation:  0.22976970672607422
local_output_nid generation:  0.0072133541107177734
local_in_edges_tensor generation:  0.007251739501953125
mini_batch_src_global generation:  0.016531944274902344
r_  generation:  0.23807072639465332
local_output_nid generation:  0.0072629451751708984
local_in_edges_tensor generation:  0.006436586380004883
mini_batch_src_global generation:  0.01581263542175293
r_  generation:  0.24085545539855957
local_output_nid generation:  0.007202863693237305
local_in_edges_tensor generation:  0.007774829864501953
mini_batch_src_global generation:  0.01851487159729004
r_  generation:  0.2571849822998047
local_output_nid generation:  0.007251262664794922
local_in_edges_tensor generation:  0.006982564926147461
mini_batch_src_global generation:  0.019297122955322266
r_  generation:  0.26424098014831543
local_output_nid generation:  0.007375478744506836
local_in_edges_tensor generation:  0.006344795227050781
mini_batch_src_global generation:  0.01989150047302246
r_  generation:  0.269214391708374
local_output_nid generation:  0.00719451904296875
local_in_edges_tensor generation:  0.020708799362182617
mini_batch_src_global generation:  0.01964545249938965
r_  generation:  0.2732701301574707
local_output_nid generation:  0.007340192794799805
local_in_edges_tensor generation:  0.01250314712524414
mini_batch_src_global generation:  0.0211029052734375
r_  generation:  0.2756640911102295
local_output_nid generation:  0.007308244705200195
local_in_edges_tensor generation:  0.008920431137084961
mini_batch_src_global generation:  0.022098779678344727
r_  generation:  0.30468273162841797
local_output_nid generation:  0.008249759674072266
local_in_edges_tensor generation:  0.0073070526123046875
mini_batch_src_global generation:  0.022817611694335938
r_  generation:  0.27787280082702637
local_output_nid generation:  0.008591175079345703
local_in_edges_tensor generation:  0.0069582462310791016
mini_batch_src_global generation:  0.023325681686401367
r_  generation:  0.2739574909210205
local_output_nid generation:  0.007252693176269531
local_in_edges_tensor generation:  0.006478309631347656
mini_batch_src_global generation:  0.023676156997680664
r_  generation:  0.30807995796203613
local_output_nid generation:  0.007458925247192383
local_in_edges_tensor generation:  0.0068514347076416016
mini_batch_src_global generation:  0.02395033836364746
r_  generation:  0.2942943572998047
local_output_nid generation:  0.007443666458129883
local_in_edges_tensor generation:  0.009100675582885742
mini_batch_src_global generation:  0.026015043258666992
r_  generation:  0.28162097930908203
----------------------check_connections_block total spend ----------------------------- 5.987964391708374
generate_one_block  6.27977180480957
generate_one_block  0.3011178970336914
generate_one_block  0.3018360137939453
generate_one_block  0.27838635444641113
generate_one_block  0.2826709747314453
generate_one_block  0.28467321395874023
generate_one_block  0.2826268672943115
generate_one_block  0.2839958667755127
generate_one_block  0.28098225593566895
generate_one_block  0.2789895534515381
generate_one_block  0.2882254123687744
generate_one_block  0.28313326835632324
generate_one_block  0.2844724655151367
generate_one_block  0.275831937789917
generate_one_block  0.29386043548583984
generate_one_block  0.2778136730194092
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0857677459716797
gen group dst list time:  0.15715718269348145
time for parepare:  0.46530938148498535
local_output_nid generation:  0.11180305480957031
local_in_edges_tensor generation:  0.4354991912841797
mini_batch_src_global generation:  0.37827348709106445
r_  generation:  4.723174571990967
local_output_nid generation:  0.1368703842163086
local_in_edges_tensor generation:  0.43151402473449707
mini_batch_src_global generation:  0.4760861396789551
r_  generation:  4.821712970733643
local_output_nid generation:  0.12822651863098145
local_in_edges_tensor generation:  0.3931412696838379
mini_batch_src_global generation:  0.44263219833374023
r_  generation:  4.8791327476501465
local_output_nid generation:  0.1361091136932373
local_in_edges_tensor generation:  0.43352651596069336
mini_batch_src_global generation:  0.43763184547424316
r_  generation:  5.005710601806641
local_output_nid generation:  0.11085009574890137
local_in_edges_tensor generation:  0.30548882484436035
mini_batch_src_global generation:  0.4708123207092285
r_  generation:  5.00633430480957
local_output_nid generation:  0.12042450904846191
local_in_edges_tensor generation:  0.4119894504547119
mini_batch_src_global generation:  0.4740791320800781
r_  generation:  4.980282545089722
local_output_nid generation:  0.12160873413085938
local_in_edges_tensor generation:  0.2963099479675293
mini_batch_src_global generation:  0.4686906337738037
r_  generation:  5.129129409790039
local_output_nid generation:  0.11116504669189453
local_in_edges_tensor generation:  0.28786325454711914
mini_batch_src_global generation:  0.469266414642334
r_  generation:  5.005701065063477
local_output_nid generation:  0.12023091316223145
local_in_edges_tensor generation:  0.3901338577270508
mini_batch_src_global generation:  0.4756312370300293
r_  generation:  5.005221366882324
local_output_nid generation:  0.12021493911743164
local_in_edges_tensor generation:  0.2950136661529541
mini_batch_src_global generation:  0.4729304313659668
r_  generation:  5.206955909729004
local_output_nid generation:  0.1134181022644043
local_in_edges_tensor generation:  0.28935837745666504
mini_batch_src_global generation:  0.5172252655029297
r_  generation:  5.097934722900391
local_output_nid generation:  0.11763739585876465
local_in_edges_tensor generation:  0.3864738941192627
mini_batch_src_global generation:  0.4851560592651367
r_  generation:  5.064221620559692
local_output_nid generation:  0.13806653022766113
local_in_edges_tensor generation:  0.3108851909637451
mini_batch_src_global generation:  0.4767758846282959
r_  generation:  5.070316791534424
local_output_nid generation:  0.11160540580749512
local_in_edges_tensor generation:  0.2904520034790039
mini_batch_src_global generation:  0.5064151287078857
r_  generation:  5.143317222595215
local_output_nid generation:  0.1111452579498291
local_in_edges_tensor generation:  0.28495335578918457
mini_batch_src_global generation:  0.4875295162200928
r_  generation:  5.089824914932251
local_output_nid generation:  0.13783526420593262
local_in_edges_tensor generation:  0.3909180164337158
mini_batch_src_global generation:  0.47763514518737793
r_  generation:  5.041523218154907
----------------------check_connections_block total spend ----------------------------- 108.92861413955688
generate_one_block  6.880206346511841
generate_one_block  6.296495676040649
generate_one_block  6.332708120346069
generate_one_block  6.100443124771118
generate_one_block  6.1336891651153564
generate_one_block  6.306772708892822
generate_one_block  6.347562074661255
generate_one_block  6.11503267288208
generate_one_block  6.254416227340698
generate_one_block  6.217195749282837
generate_one_block  6.430437803268433
generate_one_block  6.114216566085815
generate_one_block  6.188310861587524
generate_one_block  6.075690269470215
generate_one_block  6.516481876373291
generate_one_block  6.112186908721924
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1386032104492188
gen group dst list time:  0.8531477451324463
time for parepare:  0.4650306701660156
local_output_nid generation:  0.4985842704772949
local_in_edges_tensor generation:  1.1817357540130615
mini_batch_src_global generation:  1.0179216861724854
r_  generation:  13.56093168258667
local_output_nid generation:  0.530430793762207
local_in_edges_tensor generation:  1.1649987697601318
mini_batch_src_global generation:  1.2870562076568604
r_  generation:  14.127662420272827
local_output_nid generation:  0.5332248210906982
local_in_edges_tensor generation:  1.036036729812622
mini_batch_src_global generation:  1.3451056480407715
r_  generation:  14.260242938995361
local_output_nid generation:  0.5638797283172607
local_in_edges_tensor generation:  1.1523559093475342
mini_batch_src_global generation:  1.3377819061279297
r_  generation:  14.43412470817566
local_output_nid generation:  0.5434348583221436
local_in_edges_tensor generation:  1.1931591033935547
mini_batch_src_global generation:  1.3292429447174072
r_  generation:  14.334228515625
local_output_nid generation:  0.5281322002410889
local_in_edges_tensor generation:  2.1453499794006348
mini_batch_src_global generation:  1.3549716472625732
r_  generation:  14.23892617225647
local_output_nid generation:  0.561934232711792
local_in_edges_tensor generation:  1.0796077251434326
mini_batch_src_global generation:  1.4682347774505615
r_  generation:  14.534703493118286
local_output_nid generation:  0.5656726360321045
local_in_edges_tensor generation:  1.1391925811767578
mini_batch_src_global generation:  1.3297529220581055
r_  generation:  14.539870262145996
local_output_nid generation:  0.5104391574859619
local_in_edges_tensor generation:  1.1450340747833252
mini_batch_src_global generation:  1.379725456237793
r_  generation:  14.442523002624512
local_output_nid generation:  0.5538985729217529
local_in_edges_tensor generation:  1.022346019744873
mini_batch_src_global generation:  1.3722481727600098
r_  generation:  14.325029373168945
local_output_nid generation:  0.568171501159668
local_in_edges_tensor generation:  1.153435230255127
mini_batch_src_global generation:  1.387916088104248
r_  generation:  14.585348129272461
local_output_nid generation:  0.5707340240478516
local_in_edges_tensor generation:  1.1355006694793701
mini_batch_src_global generation:  1.3471550941467285
r_  generation:  14.484560251235962
local_output_nid generation:  0.5196967124938965
local_in_edges_tensor generation:  1.099276065826416
mini_batch_src_global generation:  1.3748798370361328
r_  generation:  14.308541297912598
local_output_nid generation:  0.5697000026702881
local_in_edges_tensor generation:  1.0883660316467285
mini_batch_src_global generation:  1.4134242534637451
r_  generation:  14.34686827659607
local_output_nid generation:  0.5628299713134766
local_in_edges_tensor generation:  1.1453425884246826
mini_batch_src_global generation:  1.3642213344573975
r_  generation:  14.64722466468811
local_output_nid generation:  0.571796178817749
local_in_edges_tensor generation:  1.1361594200134277
mini_batch_src_global generation:  1.3608367443084717
r_  generation:  14.509125709533691
----------------------check_connections_block total spend ----------------------------- 319.94237661361694
generate_one_block  19.138052701950073
generate_one_block  18.989665508270264
generate_one_block  19.057337522506714
generate_one_block  19.183239936828613
generate_one_block  19.18859553337097
generate_one_block  18.740792989730835
generate_one_block  19.799184799194336
generate_one_block  19.18938183784485
generate_one_block  19.289809703826904
generate_one_block  19.378750801086426
generate_one_block  19.289877891540527
generate_one_block  19.236475229263306
generate_one_block  18.77950406074524
generate_one_block  18.90092372894287
generate_one_block  18.982680559158325
generate_one_block  19.339525938034058
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  428.8709907531738
block generation total time  406.90564489364624
average batch blocks generation time:  25.43160280585289
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2352294921875 GB
    Memory Allocated: 1.1257696151733398  GigaBytes
Max Memory Allocated: 1.1257696151733398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6219482421875 GB
    Memory Allocated: 2.5681309700012207  GigaBytes
Max Memory Allocated: 2.9993906021118164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6688232421875 GB
    Memory Allocated: 1.128042221069336  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6688232421875 GB
    Memory Allocated: 2.567495822906494  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6707763671875 GB
    Memory Allocated: 1.1257710456848145  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6707763671875 GB
    Memory Allocated: 2.562990665435791  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6707763671875 GB
    Memory Allocated: 1.1249094009399414  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6707763671875 GB
    Memory Allocated: 2.5517125129699707  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6707763671875 GB
    Memory Allocated: 1.1265931129455566  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6707763671875 GB
    Memory Allocated: 2.5607500076293945  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6707763671875 GB
    Memory Allocated: 1.1284284591674805  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6707763671875 GB
    Memory Allocated: 2.568990707397461  GigaBytes
Max Memory Allocated: 3.300605297088623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6707763671875 GB
    Memory Allocated: 1.1287474632263184  GigaBytes
Max Memory Allocated: 3.301271915435791  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4129638671875 GB
    Memory Allocated: 2.5701379776000977  GigaBytes
Max Memory Allocated: 3.301271915435791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4129638671875 GB
    Memory Allocated: 1.128108024597168  GigaBytes
Max Memory Allocated: 3.30490779876709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4129638671875 GB
    Memory Allocated: 2.56611967086792  GigaBytes
Max Memory Allocated: 3.30490779876709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4129638671875 GB
    Memory Allocated: 1.1280841827392578  GigaBytes
Max Memory Allocated: 3.30490779876709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4129638671875 GB
    Memory Allocated: 2.5682387351989746  GigaBytes
Max Memory Allocated: 3.30490779876709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4129638671875 GB
    Memory Allocated: 1.13189697265625  GigaBytes
Max Memory Allocated: 3.30490779876709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.575904369354248  GigaBytes
Max Memory Allocated: 3.30490779876709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1275310516357422  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.567448139190674  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1270289421081543  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5677332878112793  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1286530494689941  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5684056282043457  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1271381378173828  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5632619857788086  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.126683235168457  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5648350715637207  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1289949417114258  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5676732063293457  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3260160982608795 |0.46025586128234863 |0.04586145281791687 |0.00014039874076843262 |0.0325382798910141 |0.002117633819580078 |
----------------------------------------------------------pseudo_mini_loss sum 8.813566207885742
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64152942
Number of first layer input nodes during this epoch:  34053289
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.814640998840332  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4357941150665283
random selection method range initialization spend 0.01216578483581543
time for parepare:  0.3514842987060547
local_output_nid generation:  0.008006811141967773
local_in_edges_tensor generation:  0.028948545455932617
mini_batch_src_global generation:  0.01731085777282715
r_  generation:  0.18715381622314453
local_output_nid generation:  0.009829282760620117
local_in_edges_tensor generation:  0.007067203521728516
mini_batch_src_global generation:  0.0210416316986084
r_  generation:  0.20621871948242188
local_output_nid generation:  0.009776830673217773
local_in_edges_tensor generation:  0.006898164749145508
mini_batch_src_global generation:  0.012536287307739258
r_  generation:  0.2192702293395996
local_output_nid generation:  0.009957551956176758
local_in_edges_tensor generation:  0.007000446319580078
mini_batch_src_global generation:  0.013276815414428711
r_  generation:  0.23181843757629395
local_output_nid generation:  0.00982809066772461
local_in_edges_tensor generation:  0.008847951889038086
mini_batch_src_global generation:  0.01319742202758789
r_  generation:  0.2497389316558838
local_output_nid generation:  0.0099029541015625
local_in_edges_tensor generation:  0.0070343017578125
mini_batch_src_global generation:  0.016762495040893555
r_  generation:  0.2498188018798828
local_output_nid generation:  0.009926557540893555
local_in_edges_tensor generation:  0.009025335311889648
mini_batch_src_global generation:  0.016554832458496094
r_  generation:  0.2779533863067627
local_output_nid generation:  0.009943485260009766
local_in_edges_tensor generation:  0.0072247982025146484
mini_batch_src_global generation:  0.01723504066467285
r_  generation:  0.2637979984283447
local_output_nid generation:  0.009958982467651367
local_in_edges_tensor generation:  0.00739288330078125
mini_batch_src_global generation:  0.017539024353027344
r_  generation:  0.2803456783294678
local_output_nid generation:  0.012953996658325195
local_in_edges_tensor generation:  0.008606433868408203
mini_batch_src_global generation:  0.022612810134887695
r_  generation:  0.282024621963501
local_output_nid generation:  0.009909391403198242
local_in_edges_tensor generation:  0.008362531661987305
mini_batch_src_global generation:  0.019984006881713867
r_  generation:  0.27786827087402344
local_output_nid generation:  0.009905099868774414
local_in_edges_tensor generation:  0.008365631103515625
mini_batch_src_global generation:  0.020513057708740234
r_  generation:  0.274914026260376
local_output_nid generation:  0.009992122650146484
local_in_edges_tensor generation:  0.007155895233154297
mini_batch_src_global generation:  0.020931243896484375
r_  generation:  0.2793443202972412
local_output_nid generation:  0.009974956512451172
local_in_edges_tensor generation:  0.0071163177490234375
mini_batch_src_global generation:  0.02089548110961914
r_  generation:  0.2786140441894531
local_output_nid generation:  0.0099945068359375
local_in_edges_tensor generation:  0.00700688362121582
mini_batch_src_global generation:  0.021666526794433594
r_  generation:  0.3091316223144531
local_output_nid generation:  0.019301176071166992
local_in_edges_tensor generation:  0.007241249084472656
mini_batch_src_global generation:  0.02230978012084961
r_  generation:  0.2913856506347656
----------------------check_connections_block total spend ----------------------------- 5.9278883934021
generate_one_block  0.597318172454834
generate_one_block  0.5374691486358643
generate_one_block  0.4045090675354004
generate_one_block  0.32955265045166016
generate_one_block  0.2987663745880127
generate_one_block  0.28020668029785156
generate_one_block  0.2793285846710205
generate_one_block  0.29696154594421387
generate_one_block  0.28391146659851074
generate_one_block  0.2807340621948242
generate_one_block  0.28249478340148926
generate_one_block  0.2838096618652344
generate_one_block  0.28253746032714844
generate_one_block  0.28009963035583496
generate_one_block  0.2826805114746094
generate_one_block  0.2816040515899658
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.302072286605835
gen group dst list time:  0.19302082061767578
time for parepare:  0.4806220531463623
local_output_nid generation:  0.11548662185668945
local_in_edges_tensor generation:  0.39629697799682617
mini_batch_src_global generation:  0.35530900955200195
r_  generation:  4.495265007019043
local_output_nid generation:  0.12328314781188965
local_in_edges_tensor generation:  0.41496777534484863
mini_batch_src_global generation:  0.43645429611206055
r_  generation:  4.9189369678497314
local_output_nid generation:  0.13800644874572754
local_in_edges_tensor generation:  0.3005998134613037
mini_batch_src_global generation:  0.4139127731323242
r_  generation:  4.8001320362091064
local_output_nid generation:  0.11119937896728516
local_in_edges_tensor generation:  0.5252716541290283
mini_batch_src_global generation:  0.44407224655151367
r_  generation:  5.070176839828491
local_output_nid generation:  0.13751745223999023
local_in_edges_tensor generation:  0.30899620056152344
mini_batch_src_global generation:  0.4603903293609619
r_  generation:  4.959435701370239
local_output_nid generation:  0.1131138801574707
local_in_edges_tensor generation:  0.2968454360961914
mini_batch_src_global generation:  0.4620521068572998
r_  generation:  5.0333192348480225
local_output_nid generation:  0.11806821823120117
local_in_edges_tensor generation:  0.3965280055999756
mini_batch_src_global generation:  0.4978044033050537
r_  generation:  5.070064067840576
local_output_nid generation:  0.13911652565002441
local_in_edges_tensor generation:  0.30382251739501953
mini_batch_src_global generation:  0.46776270866394043
r_  generation:  4.995075941085815
local_output_nid generation:  0.1116480827331543
local_in_edges_tensor generation:  0.39682745933532715
mini_batch_src_global generation:  0.47679710388183594
r_  generation:  5.173783540725708
local_output_nid generation:  0.13756465911865234
local_in_edges_tensor generation:  0.30069541931152344
mini_batch_src_global generation:  0.48020482063293457
r_  generation:  5.013769149780273
local_output_nid generation:  0.1125633716583252
local_in_edges_tensor generation:  0.29320526123046875
mini_batch_src_global generation:  0.4805421829223633
r_  generation:  5.127189874649048
local_output_nid generation:  0.11785411834716797
local_in_edges_tensor generation:  0.3960421085357666
mini_batch_src_global generation:  0.5313951969146729
r_  generation:  5.079952239990234
local_output_nid generation:  0.13828420639038086
local_in_edges_tensor generation:  0.29673314094543457
mini_batch_src_global generation:  0.4783644676208496
r_  generation:  5.09752082824707
local_output_nid generation:  0.11061763763427734
local_in_edges_tensor generation:  0.3992624282836914
mini_batch_src_global generation:  0.49959349632263184
r_  generation:  5.199422836303711
local_output_nid generation:  0.1378316879272461
local_in_edges_tensor generation:  0.294081449508667
mini_batch_src_global generation:  0.47652435302734375
r_  generation:  5.068356990814209
local_output_nid generation:  0.10992145538330078
local_in_edges_tensor generation:  0.34574413299560547
mini_batch_src_global generation:  0.4813351631164551
r_  generation:  5.111124277114868
----------------------check_connections_block total spend ----------------------------- 109.09934425354004
generate_one_block  6.630407094955444
generate_one_block  6.831476926803589
generate_one_block  6.184637069702148
generate_one_block  6.558991432189941
generate_one_block  6.236993074417114
generate_one_block  6.233114004135132
generate_one_block  6.446855783462524
generate_one_block  6.216759920120239
generate_one_block  6.503571510314941
generate_one_block  6.339352369308472
generate_one_block  6.209038019180298
generate_one_block  6.518441438674927
generate_one_block  6.201827764511108
generate_one_block  6.495458126068115
generate_one_block  6.203463077545166
generate_one_block  6.107299566268921
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.129744291305542
gen group dst list time:  0.898470401763916
time for parepare:  0.5016658306121826
local_output_nid generation:  0.5286142826080322
local_in_edges_tensor generation:  1.3616054058074951
mini_batch_src_global generation:  1.0432777404785156
r_  generation:  14.007761716842651
local_output_nid generation:  0.5687921047210693
local_in_edges_tensor generation:  1.1949076652526855
mini_batch_src_global generation:  1.2960011959075928
r_  generation:  14.277117013931274
local_output_nid generation:  0.5795879364013672
local_in_edges_tensor generation:  1.3135688304901123
mini_batch_src_global generation:  1.2955992221832275
r_  generation:  14.352442264556885
local_output_nid generation:  0.5287160873413086
local_in_edges_tensor generation:  1.2060093879699707
mini_batch_src_global generation:  1.3182907104492188
r_  generation:  14.584639310836792
local_output_nid generation:  0.5487184524536133
local_in_edges_tensor generation:  1.197239637374878
mini_batch_src_global generation:  1.349100112915039
r_  generation:  14.484681367874146
local_output_nid generation:  0.5342776775360107
local_in_edges_tensor generation:  1.1776862144470215
mini_batch_src_global generation:  1.414090633392334
r_  generation:  14.613531827926636
local_output_nid generation:  0.5746872425079346
local_in_edges_tensor generation:  1.1924803256988525
mini_batch_src_global generation:  1.3972017765045166
r_  generation:  14.440704584121704
local_output_nid generation:  0.5649645328521729
local_in_edges_tensor generation:  1.1703007221221924
mini_batch_src_global generation:  1.5074818134307861
r_  generation:  14.79859209060669
local_output_nid generation:  0.5659258365631104
local_in_edges_tensor generation:  1.1876180171966553
mini_batch_src_global generation:  1.3433647155761719
r_  generation:  14.565826654434204
local_output_nid generation:  0.5320324897766113
local_in_edges_tensor generation:  1.1949169635772705
mini_batch_src_global generation:  1.3423914909362793
r_  generation:  14.56305980682373
local_output_nid generation:  0.5500895977020264
local_in_edges_tensor generation:  1.2031183242797852
mini_batch_src_global generation:  1.371931552886963
r_  generation:  14.615131139755249
local_output_nid generation:  0.5344448089599609
local_in_edges_tensor generation:  1.1765587329864502
mini_batch_src_global generation:  1.3966076374053955
r_  generation:  14.788561820983887
local_output_nid generation:  0.5710816383361816
local_in_edges_tensor generation:  1.1451618671417236
mini_batch_src_global generation:  1.4005966186523438
r_  generation:  14.40515685081482
local_output_nid generation:  0.5593841075897217
local_in_edges_tensor generation:  2.615525007247925
mini_batch_src_global generation:  1.3422651290893555
r_  generation:  14.199954748153687
local_output_nid generation:  0.5660011768341064
local_in_edges_tensor generation:  1.188211441040039
mini_batch_src_global generation:  1.4187803268432617
r_  generation:  14.50736665725708
local_output_nid generation:  0.5552306175231934
local_in_edges_tensor generation:  1.1888492107391357
mini_batch_src_global generation:  1.320197582244873
r_  generation:  14.672488689422607
----------------------check_connections_block total spend ----------------------------- 324.69072461128235
generate_one_block  19.35691738128662
generate_one_block  19.350727796554565
generate_one_block  19.341097593307495
generate_one_block  19.360069513320923
generate_one_block  19.268200159072876
generate_one_block  19.39561891555786
generate_one_block  19.325087785720825
generate_one_block  19.86801052093506
generate_one_block  19.346639156341553
generate_one_block  19.34717297554016
generate_one_block  19.42773938179016
generate_one_block  19.424434900283813
generate_one_block  19.350013494491577
generate_one_block  19.29723620414734
generate_one_block  19.376558542251587
generate_one_block  19.268120765686035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.814640998840332  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

connection checking time:  433.7900688648224
block generation total time  412.02133226394653
average batch blocks generation time:  25.75133326649666
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1280779838562012  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.567697048187256  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1277575492858887  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5677547454833984  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1267905235290527  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.562954902648926  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.12687349319458  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5668978691101074  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1264433860778809  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.562067985534668  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.128462314605713  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.568105697631836  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1282753944396973  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5668749809265137  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1307296752929688  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5749459266662598  GigaBytes
Max Memory Allocated: 3.3097453117370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1271018981933594  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5632123947143555  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.128420352935791  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.567902088165283  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1298675537109375  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5701231956481934  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.128669261932373  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.569155216217041  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.12623929977417  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5626773834228516  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1275677680969238  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5634355545043945  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1287875175476074  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5674781799316406  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 1.1272506713867188  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4149169921875 GB
    Memory Allocated: 2.5574393272399902  GigaBytes
Max Memory Allocated: 3.3100829124450684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3403603434562683 |0.300421878695488 |0.004245862364768982 |0.00013384222984313965 |0.004891544580459595 |0.0027174949645996094 |
----------------------------------------------------------pseudo_mini_loss sum 5.128137588500977
Total (block generation + training)time/epoch 897.5209710597992
Training time/epoch 1648541641.4853456
Training time without block to device /epoch 1648541636.6785955
Training time without total dataloading part /epoch 0.15105748176574707
load block tensor time/epoch 5.445765495300293
block to device time/epoch 4.806750059127808
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64146805
Number of first layer input nodes during this epoch: Using backend: pytorch
 34052731
