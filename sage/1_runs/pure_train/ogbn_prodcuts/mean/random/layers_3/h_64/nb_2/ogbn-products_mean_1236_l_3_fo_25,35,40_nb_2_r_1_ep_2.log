main start at this time 1648537409.7105763
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3886418342590332
random selection method range initialization spend 0.017180204391479492
time for parepare:  0.2807602882385254
local_output_nid generation:  0.04685568809509277
local_in_edges_tensor generation:  0.10757613182067871
mini_batch_src_global generation:  0.11708736419677734
r_  generation:  1.8994319438934326
local_output_nid generation:  0.0487363338470459
local_in_edges_tensor generation:  0.08805704116821289
mini_batch_src_global generation:  0.14460086822509766
r_  generation:  2.045029401779175
----------------------check_connections_block total spend ----------------------------- 5.4217236042022705
generate_one_block  7.860944747924805
generate_one_block  2.518179416656494
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.06549334526062
gen group dst list time:  0.06529831886291504
time for parepare:  0.5122334957122803
local_output_nid generation:  0.32750916481018066
local_in_edges_tensor generation:  1.0552799701690674
mini_batch_src_global generation:  1.0496268272399902
r_  generation:  15.091373205184937
local_output_nid generation:  0.5697405338287354
local_in_edges_tensor generation:  1.0273168087005615
mini_batch_src_global generation:  1.3489418029785156
r_  generation:  15.265157222747803
----------------------check_connections_block total spend ----------------------------- 41.582497119903564
generate_one_block  19.12722635269165
generate_one_block  18.80363416671753
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.0607330799102783
gen group dst list time:  0.19556140899658203
time for parepare:  0.4883091449737549
local_output_nid generation:  0.6389436721801758
local_in_edges_tensor generation:  1.4680204391479492
mini_batch_src_global generation:  1.266397476196289
r_  generation:  18.57025647163391
local_output_nid generation:  0.6773457527160645
local_in_edges_tensor generation:  1.443631887435913
mini_batch_src_global generation:  1.6170003414154053
r_  generation:  18.56540608406067
----------------------check_connections_block total spend ----------------------------- 51.64337468147278
generate_one_block  24.187873601913452
generate_one_block  23.745437622070312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  93.22587180137634
block generation total time  85.86417174339294
average batch blocks generation time:  42.93208587169647
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5028076171875 GB
    Memory Allocated: 1.409740924835205  GigaBytes
Max Memory Allocated: 1.409740924835205  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6395263671875 GB
    Memory Allocated: 3.984328269958496  GigaBytes
Max Memory Allocated: 4.227819919586182  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3992919921875 GB
    Memory Allocated: 1.4266929626464844  GigaBytes
Max Memory Allocated: 4.527853012084961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3992919921875 GB
    Memory Allocated: 3.986698627471924  GigaBytes
Max Memory Allocated: 4.527853012084961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3770202398300171 |1.0555087327957153 |0.7697627544403076 |0.0018451213836669922 |0.07659351825714111 |0.006791830062866211 |
----------------------------------------------------------pseudo_mini_loss sum 8.818300247192383
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10780094
Number of first layer input nodes during this epoch:  4499172
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.3992919921875 GB
    Memory Allocated: 2.599437713623047  GigaBytes
Max Memory Allocated: 4.530222415924072  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4103250503540039
random selection method range initialization spend 0.014250040054321289
time for parepare:  0.29590415954589844
local_output_nid generation:  0.050391197204589844
local_in_edges_tensor generation:  0.1016838550567627
mini_batch_src_global generation:  0.1163630485534668
r_  generation:  1.8669493198394775
local_output_nid generation:  0.05747699737548828
local_in_edges_tensor generation:  0.08400726318359375
mini_batch_src_global generation:  0.15373706817626953
r_  generation:  1.9796793460845947
----------------------check_connections_block total spend ----------------------------- 5.348391532897949
generate_one_block  3.119795322418213
generate_one_block  2.4980661869049072
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.065737724304199
gen group dst list time:  0.06270122528076172
time for parepare:  0.45743727684020996
local_output_nid generation:  0.3377091884613037
local_in_edges_tensor generation:  1.0026872158050537
mini_batch_src_global generation:  1.027500867843628
r_  generation:  14.62280559539795
local_output_nid generation:  0.36136412620544434
local_in_edges_tensor generation:  1.0414888858795166
mini_batch_src_global generation:  1.4119839668273926
r_  generation:  14.695768117904663
----------------------check_connections_block total spend ----------------------------- 40.35415863990784
generate_one_block  19.28235101699829
generate_one_block  19.0603084564209
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2157142162323
gen group dst list time:  0.15622401237487793
time for parepare:  0.5009329319000244
local_output_nid generation:  0.6343698501586914
local_in_edges_tensor generation:  1.418543815612793
mini_batch_src_global generation:  1.2403204441070557
r_  generation:  18.62988305091858
local_output_nid generation:  0.6724381446838379
local_in_edges_tensor generation:  1.425952672958374
mini_batch_src_global generation:  1.6239807605743408
r_  generation:  18.439380407333374
----------------------check_connections_block total spend ----------------------------- 51.6442437171936
generate_one_block  24.02186346054077
generate_one_block  24.739379167556763
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.3992919921875 GB
    Memory Allocated: 2.599437713623047  GigaBytes
Max Memory Allocated: 4.530222415924072  GigaBytes

connection checking time:  91.99840235710144
block generation total time  87.10390210151672
average batch blocks generation time:  43.55195105075836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3992919921875 GB
    Memory Allocated: 1.4276609420776367  GigaBytes
Max Memory Allocated: 4.530222415924072  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3992919921875 GB
    Memory Allocated: 3.9882450103759766  GigaBytes
Max Memory Allocated: 4.530222415924072  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2391357421875 GB
    Memory Allocated: 1.4272751808166504  GigaBytes
Max Memory Allocated: 4.532589435577393  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2391357421875 GB
    Memory Allocated: 3.9831080436706543  GigaBytes
Max Memory Allocated: 4.532589435577393  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40400445461273193 |0.7100684642791748 |0.014841794967651367 |0.00016582012176513672 |0.09855401515960693 |0.0027213096618652344 |
----------------------------------------------------------pseudo_mini_loss sum 5.145612716674805
Total (block generation + training)time/epoch 209.45403003692627
Training time/epoch 1648537891.353184
Training time without block to device /epoch 1648537889.933047
Training time without total dataloading part /epoch 0.2298445701599121
load block tensor time/epoch 0.8080089092254639
block to device time/epoch 1.4201369285583496
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10779692
Number of first layer input nodes during this epoch:  4499173
