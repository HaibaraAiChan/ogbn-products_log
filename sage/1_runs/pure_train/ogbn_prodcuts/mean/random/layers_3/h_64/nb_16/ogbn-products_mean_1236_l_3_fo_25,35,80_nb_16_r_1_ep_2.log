main start at this time 1648564255.8653688
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6494519710540771
random selection method range initialization spend 0.014075040817260742
time for parepare:  0.3630201816558838
local_output_nid generation:  0.0069963932037353516
local_in_edges_tensor generation:  0.03714489936828613
mini_batch_src_global generation:  0.025045394897460938
r_  generation:  0.3542947769165039
local_output_nid generation:  0.007197380065917969
local_in_edges_tensor generation:  0.019655704498291016
mini_batch_src_global generation:  0.032941579818725586
r_  generation:  0.40621280670166016
local_output_nid generation:  0.007090091705322266
local_in_edges_tensor generation:  0.012792348861694336
mini_batch_src_global generation:  0.03133034706115723
r_  generation:  0.4184725284576416
local_output_nid generation:  0.007205009460449219
local_in_edges_tensor generation:  0.010986804962158203
mini_batch_src_global generation:  0.02543473243713379
r_  generation:  0.4521486759185791
local_output_nid generation:  0.007131338119506836
local_in_edges_tensor generation:  0.009875774383544922
mini_batch_src_global generation:  0.026883363723754883
r_  generation:  0.4658794403076172
local_output_nid generation:  0.007097005844116211
local_in_edges_tensor generation:  0.009972810745239258
mini_batch_src_global generation:  0.030114412307739258
r_  generation:  0.48886871337890625
local_output_nid generation:  0.007122993469238281
local_in_edges_tensor generation:  0.010317802429199219
mini_batch_src_global generation:  0.030985116958618164
r_  generation:  0.4985923767089844
local_output_nid generation:  0.007123231887817383
local_in_edges_tensor generation:  0.01002359390258789
mini_batch_src_global generation:  0.03261399269104004
r_  generation:  0.5002734661102295
local_output_nid generation:  0.007130861282348633
local_in_edges_tensor generation:  0.009920120239257812
mini_batch_src_global generation:  0.033373355865478516
r_  generation:  0.5037431716918945
local_output_nid generation:  0.007174968719482422
local_in_edges_tensor generation:  0.009850740432739258
mini_batch_src_global generation:  0.03475594520568848
r_  generation:  0.5023953914642334
local_output_nid generation:  0.007113218307495117
local_in_edges_tensor generation:  0.00991964340209961
mini_batch_src_global generation:  0.04007220268249512
r_  generation:  0.5150768756866455
local_output_nid generation:  0.00708460807800293
local_in_edges_tensor generation:  0.009863615036010742
mini_batch_src_global generation:  0.03844332695007324
r_  generation:  0.521007776260376
local_output_nid generation:  0.007073402404785156
local_in_edges_tensor generation:  0.009929180145263672
mini_batch_src_global generation:  0.03876352310180664
r_  generation:  0.5223202705383301
local_output_nid generation:  0.007081031799316406
local_in_edges_tensor generation:  0.009865999221801758
mini_batch_src_global generation:  0.04009389877319336
r_  generation:  0.5253043174743652
local_output_nid generation:  0.00709223747253418
local_in_edges_tensor generation:  0.009893655776977539
mini_batch_src_global generation:  0.04060196876525879
r_  generation:  0.5205228328704834
local_output_nid generation:  0.007077693939208984
local_in_edges_tensor generation:  0.00989532470703125
mini_batch_src_global generation:  0.040807485580444336
r_  generation:  0.5197350978851318
----------------------check_connections_block total spend ----------------------------- 10.249034881591797
generate_one_block  5.581321954727173
generate_one_block  0.4885585308074951
generate_one_block  0.5138068199157715
generate_one_block  0.49118614196777344
generate_one_block  0.4961073398590088
generate_one_block  0.501518726348877
generate_one_block  0.5026614665985107
generate_one_block  0.49895644187927246
generate_one_block  0.49697184562683105
generate_one_block  0.5056979656219482
generate_one_block  0.5109915733337402
generate_one_block  0.49764347076416016
generate_one_block  0.4957594871520996
generate_one_block  0.4993116855621338
generate_one_block  0.5004332065582275
generate_one_block  0.49496889114379883
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.6421878337860107
gen group dst list time:  0.2368602752685547
time for parepare:  0.44696474075317383
local_output_nid generation:  0.159318208694458
local_in_edges_tensor generation:  0.5746736526489258
mini_batch_src_global generation:  0.5104999542236328
r_  generation:  6.394823312759399
local_output_nid generation:  0.18484759330749512
local_in_edges_tensor generation:  0.4513273239135742
mini_batch_src_global generation:  0.6421010494232178
r_  generation:  6.56207799911499
local_output_nid generation:  0.16838741302490234
local_in_edges_tensor generation:  0.4486691951751709
mini_batch_src_global generation:  0.6404199600219727
r_  generation:  6.826187610626221
local_output_nid generation:  0.16805028915405273
local_in_edges_tensor generation:  0.45125341415405273
mini_batch_src_global generation:  0.6638941764831543
r_  generation:  6.7656309604644775
local_output_nid generation:  0.17231273651123047
local_in_edges_tensor generation:  0.4433577060699463
mini_batch_src_global generation:  0.6690464019775391
r_  generation:  6.858330011367798
local_output_nid generation:  0.1687624454498291
local_in_edges_tensor generation:  0.5981540679931641
mini_batch_src_global generation:  0.6959438323974609
r_  generation:  6.889399528503418
local_output_nid generation:  0.20113682746887207
local_in_edges_tensor generation:  0.45876121520996094
mini_batch_src_global generation:  0.6838366985321045
r_  generation:  7.013421058654785
local_output_nid generation:  0.1696164608001709
local_in_edges_tensor generation:  0.4546167850494385
mini_batch_src_global generation:  0.6888427734375
r_  generation:  6.947877883911133
local_output_nid generation:  0.17686963081359863
local_in_edges_tensor generation:  0.8444869518280029
mini_batch_src_global generation:  0.6960117816925049
r_  generation:  6.866348743438721
local_output_nid generation:  0.18041229248046875
local_in_edges_tensor generation:  0.46149492263793945
mini_batch_src_global generation:  0.7192091941833496
r_  generation:  7.056567192077637
local_output_nid generation:  0.17014622688293457
local_in_edges_tensor generation:  0.4796020984649658
mini_batch_src_global generation:  0.6915743350982666
r_  generation:  7.046637296676636
local_output_nid generation:  0.20063996315002441
local_in_edges_tensor generation:  0.5379507541656494
mini_batch_src_global generation:  0.6882607936859131
r_  generation:  6.954667329788208
local_output_nid generation:  0.1690998077392578
local_in_edges_tensor generation:  0.4456760883331299
mini_batch_src_global generation:  0.790212869644165
r_  generation:  7.9461328983306885
local_output_nid generation:  0.20583486557006836
local_in_edges_tensor generation:  0.5636429786682129
mini_batch_src_global generation:  0.735175371170044
r_  generation:  7.290625095367432
local_output_nid generation:  0.1896054744720459
local_in_edges_tensor generation:  0.5790083408355713
mini_batch_src_global generation:  0.7099690437316895
r_  generation:  6.983773231506348
local_output_nid generation:  0.18880963325500488
local_in_edges_tensor generation:  0.44303441047668457
mini_batch_src_global generation:  0.755476713180542
r_  generation:  7.11583399772644
----------------------check_connections_block total spend ----------------------------- 153.00178861618042
generate_one_block  9.809707641601562
generate_one_block  8.955759048461914
generate_one_block  9.288297414779663
generate_one_block  8.931260824203491
generate_one_block  8.885090589523315
generate_one_block  9.305026769638062
generate_one_block  8.96142864227295
generate_one_block  9.11698842048645
generate_one_block  9.265113592147827
generate_one_block  9.011021137237549
generate_one_block  9.313236236572266
generate_one_block  8.932117938995361
generate_one_block  9.22647738456726
generate_one_block  8.994056463241577
generate_one_block  8.965131759643555
generate_one_block  9.250576496124268
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.06990385055542
gen group dst list time:  0.9845218658447266
time for parepare:  0.4908580780029297
local_output_nid generation:  0.562549352645874
local_in_edges_tensor generation:  1.2930707931518555
mini_batch_src_global generation:  1.119363784790039
r_  generation:  14.746862888336182
local_output_nid generation:  0.6111690998077393
local_in_edges_tensor generation:  1.2471306324005127
mini_batch_src_global generation:  1.5379979610443115
r_  generation:  14.706008195877075
local_output_nid generation:  0.6069343090057373
local_in_edges_tensor generation:  1.340172529220581
mini_batch_src_global generation:  1.4638350009918213
r_  generation:  14.882790565490723
local_output_nid generation:  0.6060018539428711
local_in_edges_tensor generation:  1.2046334743499756
mini_batch_src_global generation:  1.4441032409667969
r_  generation:  14.9001624584198
local_output_nid generation:  0.616814136505127
local_in_edges_tensor generation:  1.1910412311553955
mini_batch_src_global generation:  1.3996336460113525
r_  generation:  15.15089225769043
local_output_nid generation:  0.5668201446533203
local_in_edges_tensor generation:  2.303537607192993
mini_batch_src_global generation:  1.4232351779937744
r_  generation:  15.0343496799469
local_output_nid generation:  0.5852851867675781
local_in_edges_tensor generation:  1.1034255027770996
mini_batch_src_global generation:  1.499478816986084
r_  generation:  15.005930185317993
local_output_nid generation:  0.6107664108276367
local_in_edges_tensor generation:  1.2149996757507324
mini_batch_src_global generation:  1.4575726985931396
r_  generation:  15.008821964263916
local_output_nid generation:  0.6088905334472656
local_in_edges_tensor generation:  1.216580867767334
mini_batch_src_global generation:  1.5675768852233887
r_  generation:  15.210870742797852
local_output_nid generation:  0.5988447666168213
local_in_edges_tensor generation:  1.217369556427002
mini_batch_src_global generation:  1.42429518699646
r_  generation:  15.21763014793396
local_output_nid generation:  0.5776932239532471
local_in_edges_tensor generation:  1.2256555557250977
mini_batch_src_global generation:  1.441678524017334
r_  generation:  15.084653615951538
local_output_nid generation:  0.6107068061828613
local_in_edges_tensor generation:  1.0927708148956299
mini_batch_src_global generation:  1.4740557670593262
r_  generation:  15.016573429107666
local_output_nid generation:  0.6074786186218262
local_in_edges_tensor generation:  1.2171778678894043
mini_batch_src_global generation:  1.5132477283477783
r_  generation:  15.212645530700684
local_output_nid generation:  0.6069352626800537
local_in_edges_tensor generation:  1.2092516422271729
mini_batch_src_global generation:  1.4144952297210693
r_  generation:  15.269734859466553
local_output_nid generation:  0.5583314895629883
local_in_edges_tensor generation:  1.2211964130401611
mini_batch_src_global generation:  1.443749189376831
r_  generation:  15.09611439704895
local_output_nid generation:  0.5905435085296631
local_in_edges_tensor generation:  1.088026523590088
mini_batch_src_global generation:  1.5600535869598389
r_  generation:  14.937103509902954
----------------------check_connections_block total spend ----------------------------- 337.2509388923645
generate_one_block  20.155783891677856
generate_one_block  20.03860592842102
generate_one_block  20.118914127349854
generate_one_block  20.169034481048584
generate_one_block  20.17370104789734
generate_one_block  19.961419820785522
generate_one_block  20.62347102165222
generate_one_block  20.11070442199707
generate_one_block  20.012843370437622
generate_one_block  20.205496072769165
generate_one_block  20.03687286376953
generate_one_block  20.014835357666016
generate_one_block  20.094874143600464
generate_one_block  20.055636644363403
generate_one_block  20.03269600868225
generate_one_block  20.292184829711914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  490.2527275085449
block generation total time  468.3083643913269
average batch blocks generation time:  29.26927277445793
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3094482421875 GB
    Memory Allocated: 1.2063298225402832  GigaBytes
Max Memory Allocated: 1.2063298225402832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9500732421875 GB
    Memory Allocated: 2.938872814178467  GigaBytes
Max Memory Allocated: 3.2241287231445312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 1.209752082824707  GigaBytes
Max Memory Allocated: 3.6040940284729004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 2.9395060539245605  GigaBytes
Max Memory Allocated: 3.6040940284729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 1.2072248458862305  GigaBytes
Max Memory Allocated: 3.604727268218994  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 2.939216136932373  GigaBytes
Max Memory Allocated: 3.604727268218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 1.2043476104736328  GigaBytes
Max Memory Allocated: 3.604727268218994  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 2.9254751205444336  GigaBytes
Max Memory Allocated: 3.604727268218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 1.2072510719299316  GigaBytes
Max Memory Allocated: 3.604727268218994  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 2.934788703918457  GigaBytes
Max Memory Allocated: 3.604727268218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 1.208493709564209  GigaBytes
Max Memory Allocated: 3.604727268218994  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 2.943007469177246  GigaBytes
Max Memory Allocated: 3.604727268218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 1.2105717658996582  GigaBytes
Max Memory Allocated: 3.60636043548584  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 2.9442572593688965  GigaBytes
Max Memory Allocated: 3.60636043548584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 1.2109971046447754  GigaBytes
Max Memory Allocated: 3.608431339263916  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 2.943180561065674  GigaBytes
Max Memory Allocated: 3.608431339263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 1.2060561180114746  GigaBytes
Max Memory Allocated: 3.608431339263916  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 2.9339489936828613  GigaBytes
Max Memory Allocated: 3.608431339263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8739013671875 GB
    Memory Allocated: 1.2104339599609375  GigaBytes
Max Memory Allocated: 3.608431339263916  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.949338912963867  GigaBytes
Max Memory Allocated: 3.608431339263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2099008560180664  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.944331169128418  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.208134651184082  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.938412666320801  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.208885669708252  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9402737617492676  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.207127571105957  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.935736656188965  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2080140113830566  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9379773139953613  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2100434303283691  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9429774284362793  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.34401337802410126 |0.4981258511543274 |0.04761882126331329 |0.00014418363571166992 |0.029258444905281067 |0.006356000900268555 |
----------------------------------------------------------pseudo_mini_loss sum 8.785333633422852
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  70324399
Number of first layer input nodes during this epoch:  34744273
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.02645206451416  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6690688133239746
random selection method range initialization spend 0.014656782150268555
time for parepare:  0.38816237449645996
local_output_nid generation:  0.0069124698638916016
local_in_edges_tensor generation:  0.04730582237243652
mini_batch_src_global generation:  0.027600765228271484
r_  generation:  0.3729119300842285
local_output_nid generation:  0.007394313812255859
local_in_edges_tensor generation:  0.011471748352050781
mini_batch_src_global generation:  0.04525470733642578
r_  generation:  0.404815673828125
local_output_nid generation:  0.007103443145751953
local_in_edges_tensor generation:  0.03820395469665527
mini_batch_src_global generation:  0.023074865341186523
r_  generation:  0.43676161766052246
local_output_nid generation:  0.00716400146484375
local_in_edges_tensor generation:  0.014939546585083008
mini_batch_src_global generation:  0.025655269622802734
r_  generation:  0.4710206985473633
local_output_nid generation:  0.008386373519897461
local_in_edges_tensor generation:  0.012728214263916016
mini_batch_src_global generation:  0.027736663818359375
r_  generation:  0.5046215057373047
local_output_nid generation:  0.008660554885864258
local_in_edges_tensor generation:  0.011286497116088867
mini_batch_src_global generation:  0.032219886779785156
r_  generation:  0.5078239440917969
local_output_nid generation:  0.0075833797454833984
local_in_edges_tensor generation:  0.010219812393188477
mini_batch_src_global generation:  0.031636953353881836
r_  generation:  0.4991898536682129
local_output_nid generation:  0.007085084915161133
local_in_edges_tensor generation:  0.010211467742919922
mini_batch_src_global generation:  0.03294849395751953
r_  generation:  0.5144634246826172
local_output_nid generation:  0.007170438766479492
local_in_edges_tensor generation:  0.010082244873046875
mini_batch_src_global generation:  0.034449100494384766
r_  generation:  0.5104315280914307
local_output_nid generation:  0.007088661193847656
local_in_edges_tensor generation:  0.00932002067565918
mini_batch_src_global generation:  0.035283803939819336
r_  generation:  0.5251069068908691
local_output_nid generation:  0.007147550582885742
local_in_edges_tensor generation:  0.00919961929321289
mini_batch_src_global generation:  0.039530277252197266
r_  generation:  0.5258722305297852
local_output_nid generation:  0.007134437561035156
local_in_edges_tensor generation:  0.00904226303100586
mini_batch_src_global generation:  0.03836464881896973
r_  generation:  0.5486128330230713
local_output_nid generation:  0.007128477096557617
local_in_edges_tensor generation:  0.013698816299438477
mini_batch_src_global generation:  0.041188955307006836
r_  generation:  0.5340900421142578
local_output_nid generation:  0.007194995880126953
local_in_edges_tensor generation:  0.010136604309082031
mini_batch_src_global generation:  0.04006385803222656
r_  generation:  0.5474541187286377
local_output_nid generation:  0.007286548614501953
local_in_edges_tensor generation:  0.026334285736083984
mini_batch_src_global generation:  0.041823387145996094
r_  generation:  0.5522613525390625
local_output_nid generation:  0.00742650032043457
local_in_edges_tensor generation:  0.019574880599975586
mini_batch_src_global generation:  0.04151034355163574
r_  generation:  0.5682234764099121
----------------------check_connections_block total spend ----------------------------- 10.790813684463501
generate_one_block  0.8654425144195557
generate_one_block  0.5170872211456299
generate_one_block  0.5191597938537598
generate_one_block  0.507138729095459
generate_one_block  0.5167074203491211
generate_one_block  0.49953126907348633
generate_one_block  0.5112950801849365
generate_one_block  0.5104527473449707
generate_one_block  0.5053112506866455
generate_one_block  0.5084879398345947
generate_one_block  0.5357327461242676
generate_one_block  0.5071542263031006
generate_one_block  0.512197732925415
generate_one_block  0.5129482746124268
generate_one_block  0.512958288192749
generate_one_block  0.514747142791748
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2659103870391846
gen group dst list time:  0.24348187446594238
time for parepare:  0.4816553592681885
local_output_nid generation:  0.1708977222442627
local_in_edges_tensor generation:  0.6177725791931152
mini_batch_src_global generation:  0.5716495513916016
r_  generation:  7.011652708053589
local_output_nid generation:  0.19585013389587402
local_in_edges_tensor generation:  0.7060487270355225
mini_batch_src_global generation:  0.8833808898925781
r_  generation:  6.621613502502441
local_output_nid generation:  0.18980121612548828
local_in_edges_tensor generation:  0.5700926780700684
mini_batch_src_global generation:  0.6643574237823486
r_  generation:  6.892021894454956
local_output_nid generation:  0.1793978214263916
local_in_edges_tensor generation:  0.435197114944458
mini_batch_src_global generation:  0.7553138732910156
r_  generation:  6.84101939201355
local_output_nid generation:  0.18256235122680664
local_in_edges_tensor generation:  0.5572443008422852
mini_batch_src_global generation:  0.7007136344909668
r_  generation:  7.0832178592681885
local_output_nid generation:  0.1856997013092041
local_in_edges_tensor generation:  0.43293023109436035
mini_batch_src_global generation:  0.780228853225708
r_  generation:  6.982088804244995
local_output_nid generation:  0.18496036529541016
local_in_edges_tensor generation:  0.5573241710662842
mini_batch_src_global generation:  0.720322847366333
r_  generation:  7.045261859893799
local_output_nid generation:  0.18475127220153809
local_in_edges_tensor generation:  0.44408345222473145
mini_batch_src_global generation:  0.7729065418243408
r_  generation:  6.990867853164673
local_output_nid generation:  0.19197964668273926
local_in_edges_tensor generation:  0.5573272705078125
mini_batch_src_global generation:  0.7125766277313232
r_  generation:  7.0845043659210205
local_output_nid generation:  0.1704409122467041
local_in_edges_tensor generation:  0.443828821182251
mini_batch_src_global generation:  0.7774674892425537
r_  generation:  6.984375
local_output_nid generation:  0.18936753273010254
local_in_edges_tensor generation:  0.5669171810150146
mini_batch_src_global generation:  0.7206480503082275
r_  generation:  7.185756683349609
local_output_nid generation:  0.18128395080566406
local_in_edges_tensor generation:  0.4630565643310547
mini_batch_src_global generation:  0.7242116928100586
r_  generation:  7.043288469314575
local_output_nid generation:  0.1869046688079834
local_in_edges_tensor generation:  0.5614519119262695
mini_batch_src_global generation:  0.7258291244506836
r_  generation:  7.258332014083862
local_output_nid generation:  0.2080082893371582
local_in_edges_tensor generation:  0.43808889389038086
mini_batch_src_global generation:  0.6965847015380859
r_  generation:  7.01561975479126
local_output_nid generation:  0.16991949081420898
local_in_edges_tensor generation:  0.5615057945251465
mini_batch_src_global generation:  0.7220795154571533
r_  generation:  7.250139236450195
local_output_nid generation:  0.20165061950683594
local_in_edges_tensor generation:  0.4383096694946289
mini_batch_src_global generation:  0.7016980648040771
r_  generation:  7.008031606674194
----------------------check_connections_block total spend ----------------------------- 154.7258801460266
generate_one_block  9.552314281463623
generate_one_block  9.948511123657227
generate_one_block  9.015249252319336
generate_one_block  9.491008043289185
generate_one_block  9.138035774230957
generate_one_block  9.275864839553833
generate_one_block  9.425593137741089
generate_one_block  9.016655683517456
generate_one_block  9.42438268661499
generate_one_block  9.211363315582275
generate_one_block  9.91897201538086
generate_one_block  9.553100109100342
generate_one_block  9.448963403701782
generate_one_block  8.947256803512573
generate_one_block  9.418320655822754
generate_one_block  8.92997121810913
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.146674871444702
gen group dst list time:  1.0593645572662354
time for parepare:  0.4882805347442627
local_output_nid generation:  0.5730061531066895
local_in_edges_tensor generation:  1.3733925819396973
mini_batch_src_global generation:  1.1188158988952637
r_  generation:  14.859110116958618
local_output_nid generation:  0.615652322769165
local_in_edges_tensor generation:  1.2521765232086182
mini_batch_src_global generation:  1.3739731311798096
r_  generation:  14.893322706222534
local_output_nid generation:  0.6168920993804932
local_in_edges_tensor generation:  1.348165512084961
mini_batch_src_global generation:  1.396806001663208
r_  generation:  15.131556272506714
local_output_nid generation:  0.5783910751342773
local_in_edges_tensor generation:  1.215162754058838
mini_batch_src_global generation:  1.430973768234253
r_  generation:  15.302037477493286
local_output_nid generation:  0.6098241806030273
local_in_edges_tensor generation:  1.2066428661346436
mini_batch_src_global generation:  1.4198596477508545
r_  generation:  15.439652681350708
local_output_nid generation:  0.6094088554382324
local_in_edges_tensor generation:  1.2025725841522217
mini_batch_src_global generation:  1.4662830829620361
r_  generation:  15.503414869308472
local_output_nid generation:  0.6153140068054199
local_in_edges_tensor generation:  1.2179746627807617
mini_batch_src_global generation:  1.4633193016052246
r_  generation:  15.448632717132568
local_output_nid generation:  0.6101062297821045
local_in_edges_tensor generation:  1.2156603336334229
mini_batch_src_global generation:  1.4901750087738037
r_  generation:  15.529232025146484
local_output_nid generation:  0.6101260185241699
local_in_edges_tensor generation:  1.205744981765747
mini_batch_src_global generation:  1.4787845611572266
r_  generation:  15.38733696937561
local_output_nid generation:  0.6103785037994385
local_in_edges_tensor generation:  1.075944185256958
mini_batch_src_global generation:  1.5573961734771729
r_  generation:  15.201077222824097
local_output_nid generation:  0.6148231029510498
local_in_edges_tensor generation:  1.2162859439849854
mini_batch_src_global generation:  1.6136033535003662
r_  generation:  15.271647453308105
local_output_nid generation:  0.6130180358886719
local_in_edges_tensor generation:  1.2168612480163574
mini_batch_src_global generation:  1.5942728519439697
r_  generation:  15.452385663986206
local_output_nid generation:  0.617426872253418
local_in_edges_tensor generation:  1.214970350265503
mini_batch_src_global generation:  1.858689308166504
r_  generation:  16.049104928970337
local_output_nid generation:  0.6292695999145508
local_in_edges_tensor generation:  2.751941204071045
mini_batch_src_global generation:  1.4652750492095947
r_  generation:  15.450173139572144
local_output_nid generation:  0.5921599864959717
local_in_edges_tensor generation:  1.235689401626587
mini_batch_src_global generation:  1.4485762119293213
r_  generation:  15.62277865409851
local_output_nid generation:  0.612436056137085
local_in_edges_tensor generation:  1.2124605178833008
mini_batch_src_global generation:  1.4765639305114746
r_  generation:  15.430432558059692
----------------------check_connections_block total spend ----------------------------- 344.7552921772003
generate_one_block  20.779948711395264
generate_one_block  20.687853813171387
generate_one_block  20.54317879676819
generate_one_block  20.596936464309692
generate_one_block  20.509236097335815
generate_one_block  20.637096643447876
generate_one_block  20.874240398406982
generate_one_block  21.133841276168823
generate_one_block  20.55520510673523
generate_one_block  20.567925214767456
generate_one_block  20.570443630218506
generate_one_block  20.578134298324585
generate_one_block  20.611387014389038
generate_one_block  20.55028223991394
generate_one_block  20.607526540756226
generate_one_block  20.532192707061768
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.02645206451416  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

connection checking time:  499.48117232322693
block generation total time  480.0509912967682
average batch blocks generation time:  30.003186956048012
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.209169864654541  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.941956043243408  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2098350524902344  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.941375255584717  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2084765434265137  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.939216136932373  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2078008651733398  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.942944049835205  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.207590103149414  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9370808601379395  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2092046737670898  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.941133975982666  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.20772123336792  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9382519721984863  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2109994888305664  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9490604400634766  GigaBytes
Max Memory Allocated: 3.6131811141967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2067208290100098  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9330434799194336  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2089781761169434  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9420719146728516  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2101716995239258  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9445061683654785  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2096819877624512  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9428505897521973  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2088351249694824  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.939983367919922  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2062549591064453  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9322848320007324  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2088656425476074  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.940864086151123  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 1.2062482833862305  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6961669921875 GB
    Memory Allocated: 2.9300031661987305  GigaBytes
Max Memory Allocated: 3.6148433685302734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.35393233597278595 |0.3663521260023117 |0.0037156343460083008 |0.00013846158981323242 |0.005307674407958984 |0.0028696060180664062 |
----------------------------------------------------------pseudo_mini_loss sum 5.12592887878418
Total (block generation + training)time/epoch 1044.7826817035675
Training time/epoch 1648566373.086358
Training time without block to device /epoch 1648566367.224724
Training time without total dataloading part /epoch 0.1494579315185547
load block tensor time/epoch 5.662917375564575
block to device time/epoch 5.861634016036987
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  70322458
Number of first layer input nodes during this epoch: Using backend: pytorch
 34744878
