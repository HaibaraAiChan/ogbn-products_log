main start at this time 1648507001.5505772
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6660208702087402
random selection method range initialization spend 0.016683340072631836
time for parepare:  0.36788034439086914
local_output_nid generation:  0.007063150405883789
local_in_edges_tensor generation:  0.04039955139160156
mini_batch_src_global generation:  0.027370691299438477
r_  generation:  0.3592214584350586
local_output_nid generation:  0.007150888442993164
local_in_edges_tensor generation:  0.018548011779785156
mini_batch_src_global generation:  0.03539109230041504
r_  generation:  0.41268014907836914
local_output_nid generation:  0.007129192352294922
local_in_edges_tensor generation:  0.00906682014465332
mini_batch_src_global generation:  0.025973796844482422
r_  generation:  0.42188119888305664
local_output_nid generation:  0.007174015045166016
local_in_edges_tensor generation:  0.018393754959106445
mini_batch_src_global generation:  0.028485536575317383
r_  generation:  0.465869665145874
local_output_nid generation:  0.008296728134155273
local_in_edges_tensor generation:  0.014840126037597656
mini_batch_src_global generation:  0.03021979331970215
r_  generation:  0.4725959300994873
local_output_nid generation:  0.007115840911865234
local_in_edges_tensor generation:  0.012530326843261719
mini_batch_src_global generation:  0.033034324645996094
r_  generation:  0.5004796981811523
local_output_nid generation:  0.007092714309692383
local_in_edges_tensor generation:  0.011224031448364258
mini_batch_src_global generation:  0.03430962562561035
r_  generation:  0.5141899585723877
local_output_nid generation:  0.007175445556640625
local_in_edges_tensor generation:  0.010275840759277344
mini_batch_src_global generation:  0.03522372245788574
r_  generation:  0.5071218013763428
local_output_nid generation:  0.00973200798034668
local_in_edges_tensor generation:  0.010066986083984375
mini_batch_src_global generation:  0.03490424156188965
r_  generation:  0.5075702667236328
local_output_nid generation:  0.007154226303100586
local_in_edges_tensor generation:  0.009532451629638672
mini_batch_src_global generation:  0.035959720611572266
r_  generation:  0.513824462890625
local_output_nid generation:  0.007165670394897461
local_in_edges_tensor generation:  0.009200334548950195
mini_batch_src_global generation:  0.03790879249572754
r_  generation:  0.5205388069152832
local_output_nid generation:  0.00719451904296875
local_in_edges_tensor generation:  0.009429693222045898
mini_batch_src_global generation:  0.03830242156982422
r_  generation:  0.5220847129821777
local_output_nid generation:  0.0072019100189208984
local_in_edges_tensor generation:  0.009645462036132812
mini_batch_src_global generation:  0.042653799057006836
r_  generation:  0.5372107028961182
local_output_nid generation:  0.007178068161010742
local_in_edges_tensor generation:  0.01407480239868164
mini_batch_src_global generation:  0.046819448471069336
r_  generation:  0.5338602066040039
local_output_nid generation:  0.00717616081237793
local_in_edges_tensor generation:  0.010340690612792969
mini_batch_src_global generation:  0.04151725769042969
r_  generation:  0.5269665718078613
local_output_nid generation:  0.007174968719482422
local_in_edges_tensor generation:  0.009317874908447266
mini_batch_src_global generation:  0.052356719970703125
r_  generation:  0.5300214290618896
----------------------check_connections_block total spend ----------------------------- 10.51187539100647
generate_one_block  6.055391788482666
generate_one_block  0.5068707466125488
generate_one_block  0.5154702663421631
generate_one_block  0.5064544677734375
generate_one_block  0.5090410709381104
generate_one_block  0.5169413089752197
generate_one_block  0.5033361911773682
generate_one_block  0.5022096633911133
generate_one_block  0.502220869064331
generate_one_block  0.5111887454986572
generate_one_block  0.5130143165588379
generate_one_block  0.5047054290771484
generate_one_block  0.5331597328186035
generate_one_block  0.5538442134857178
generate_one_block  0.507836103439331
generate_one_block  0.5486986637115479
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.528088331222534
gen group dst list time:  0.2538642883300781
time for parepare:  0.4741079807281494
local_output_nid generation:  0.19584393501281738
local_in_edges_tensor generation:  0.8240334987640381
mini_batch_src_global generation:  0.9529833793640137
r_  generation:  11.048024892807007
local_output_nid generation:  0.20408248901367188
local_in_edges_tensor generation:  0.8520386219024658
mini_batch_src_global generation:  1.3073387145996094
r_  generation:  10.59498119354248
local_output_nid generation:  0.20317411422729492
local_in_edges_tensor generation:  1.0303452014923096
mini_batch_src_global generation:  1.2142632007598877
r_  generation:  10.663390636444092
local_output_nid generation:  0.18399524688720703
local_in_edges_tensor generation:  0.8744919300079346
mini_batch_src_global generation:  1.1776247024536133
r_  generation:  10.834830045700073
local_output_nid generation:  0.1820847988128662
local_in_edges_tensor generation:  0.6671247482299805
mini_batch_src_global generation:  1.2274725437164307
r_  generation:  10.924421310424805
local_output_nid generation:  0.20301151275634766
local_in_edges_tensor generation:  0.843742847442627
mini_batch_src_global generation:  1.156369686126709
r_  generation:  11.041362762451172
local_output_nid generation:  0.17031216621398926
local_in_edges_tensor generation:  0.664478063583374
mini_batch_src_global generation:  1.178389549255371
r_  generation:  10.806419849395752
local_output_nid generation:  0.2036120891571045
local_in_edges_tensor generation:  0.8359012603759766
mini_batch_src_global generation:  1.1445488929748535
r_  generation:  11.097774505615234
local_output_nid generation:  0.17061734199523926
local_in_edges_tensor generation:  0.7375195026397705
mini_batch_src_global generation:  1.1824345588684082
r_  generation:  10.856397867202759
local_output_nid generation:  0.20126724243164062
local_in_edges_tensor generation:  0.7715616226196289
mini_batch_src_global generation:  1.1895911693572998
r_  generation:  11.030475854873657
local_output_nid generation:  0.17371392250061035
local_in_edges_tensor generation:  0.841341495513916
mini_batch_src_global generation:  1.1593997478485107
r_  generation:  10.885685205459595
local_output_nid generation:  0.19199156761169434
local_in_edges_tensor generation:  0.6601791381835938
mini_batch_src_global generation:  1.189122200012207
r_  generation:  10.96673321723938
local_output_nid generation:  0.18136334419250488
local_in_edges_tensor generation:  0.8447940349578857
mini_batch_src_global generation:  1.2159535884857178
r_  generation:  12.338099479675293
local_output_nid generation:  0.20291948318481445
local_in_edges_tensor generation:  0.8449409008026123
mini_batch_src_global generation:  1.2951030731201172
r_  generation:  11.356369733810425
local_output_nid generation:  0.20129013061523438
local_in_edges_tensor generation:  0.8543152809143066
mini_batch_src_global generation:  1.1558740139007568
r_  generation:  11.21842336654663
local_output_nid generation:  0.1719224452972412
local_in_edges_tensor generation:  0.667003870010376
mini_batch_src_global generation:  1.2066595554351807
r_  generation:  10.866957187652588
----------------------check_connections_block total spend ----------------------------- 241.42778182029724
generate_one_block  16.108686208724976
generate_one_block  15.303063154220581
generate_one_block  14.867569923400879
generate_one_block  15.215988159179688
generate_one_block  15.230026006698608
generate_one_block  14.84446668624878
generate_one_block  15.219592571258545
generate_one_block  14.940221548080444
generate_one_block  15.290167808532715
generate_one_block  15.534393548965454
generate_one_block  15.15104079246521
generate_one_block  15.213011503219604
generate_one_block  15.26058316230774
generate_one_block  16.404705286026
generate_one_block  15.378228664398193
generate_one_block  15.321593046188354
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.34053111076355
gen group dst list time:  1.0861930847167969
time for parepare:  0.4815683364868164
local_output_nid generation:  0.663214921951294
local_in_edges_tensor generation:  1.931812047958374
mini_batch_src_global generation:  1.8925764560699463
r_  generation:  23.563552141189575
local_output_nid generation:  0.6884064674377441
local_in_edges_tensor generation:  1.8724489212036133
mini_batch_src_global generation:  2.635608196258545
r_  generation:  23.748300313949585
local_output_nid generation:  0.6728811264038086
local_in_edges_tensor generation:  1.977051019668579
mini_batch_src_global generation:  2.8612828254699707
r_  generation:  23.962371587753296
local_output_nid generation:  0.669736385345459
local_in_edges_tensor generation:  1.7987565994262695
mini_batch_src_global generation:  2.8436710834503174
r_  generation:  24.058620929718018
local_output_nid generation:  0.6795628070831299
local_in_edges_tensor generation:  1.8033256530761719
mini_batch_src_global generation:  2.5490670204162598
r_  generation:  24.193820238113403
local_output_nid generation:  0.6811950206756592
local_in_edges_tensor generation:  3.3865303993225098
mini_batch_src_global generation:  2.6460394859313965
r_  generation:  24.07013988494873
local_output_nid generation:  0.6805665493011475
local_in_edges_tensor generation:  1.8177611827850342
mini_batch_src_global generation:  2.6143717765808105
r_  generation:  24.276306867599487
local_output_nid generation:  0.6603600978851318
local_in_edges_tensor generation:  1.8313848972320557
mini_batch_src_global generation:  2.655503988265991
r_  generation:  23.93856191635132
local_output_nid generation:  0.664431095123291
local_in_edges_tensor generation:  1.8320558071136475
mini_batch_src_global generation:  2.6711056232452393
r_  generation:  24.30689835548401
local_output_nid generation:  0.6706554889678955
local_in_edges_tensor generation:  1.8072731494903564
mini_batch_src_global generation:  2.742513418197632
r_  generation:  24.481529235839844
local_output_nid generation:  0.6822373867034912
local_in_edges_tensor generation:  1.9248113632202148
mini_batch_src_global generation:  2.7537026405334473
r_  generation:  24.284798622131348
local_output_nid generation:  0.6822080612182617
local_in_edges_tensor generation:  1.8092164993286133
mini_batch_src_global generation:  2.5816245079040527
r_  generation:  24.406063079833984
local_output_nid generation:  0.6723170280456543
local_in_edges_tensor generation:  1.8299860954284668
mini_batch_src_global generation:  2.8280928134918213
r_  generation:  24.337877988815308
local_output_nid generation:  0.6640791893005371
local_in_edges_tensor generation:  1.8090178966522217
mini_batch_src_global generation:  2.692031145095825
r_  generation:  24.426327228546143
local_output_nid generation:  0.6746273040771484
local_in_edges_tensor generation:  1.9147953987121582
mini_batch_src_global generation:  2.77006459236145
r_  generation:  24.40619993209839
local_output_nid generation:  0.6703519821166992
local_in_edges_tensor generation:  1.8171257972717285
mini_batch_src_global generation:  2.65194034576416
r_  generation:  24.45361614227295
----------------------check_connections_block total spend ----------------------------- 541.5116062164307
generate_one_block  32.88735556602478
generate_one_block  32.86817145347595
generate_one_block  33.15509915351868
generate_one_block  32.91340613365173
generate_one_block  33.16260528564453
generate_one_block  33.313441038131714
generate_one_block  35.013521909713745
generate_one_block  33.34216117858887
generate_one_block  33.276366233825684
generate_one_block  33.24578905105591
generate_one_block  33.0081090927124
generate_one_block  33.2859947681427
generate_one_block  33.392592668533325
generate_one_block  33.25423789024353
generate_one_block  33.254542112350464
generate_one_block  33.78007125854492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  782.9393880367279
block generation total time  778.4368028640747
average batch blocks generation time:  48.65230017900467
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6258544921875 GB
    Memory Allocated: 1.5201373100280762  GigaBytes
Max Memory Allocated: 1.5201373100280762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7996826171875 GB
    Memory Allocated: 2.9248929023742676  GigaBytes
Max Memory Allocated: 3.618682861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6473388671875 GB
    Memory Allocated: 1.5197734832763672  GigaBytes
Max Memory Allocated: 4.538324356079102  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6473388671875 GB
    Memory Allocated: 2.9177913665771484  GigaBytes
Max Memory Allocated: 4.538324356079102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6473388671875 GB
    Memory Allocated: 1.5211739540100098  GigaBytes
Max Memory Allocated: 4.538324356079102  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1102294921875 GB
    Memory Allocated: 2.9249935150146484  GigaBytes
Max Memory Allocated: 4.538324356079102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1102294921875 GB
    Memory Allocated: 1.522519588470459  GigaBytes
Max Memory Allocated: 4.538689136505127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1121826171875 GB
    Memory Allocated: 2.9275097846984863  GigaBytes
Max Memory Allocated: 4.538689136505127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5235595703125  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9296350479125977  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.522446632385254  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9270410537719727  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5172834396362305  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9134521484375  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.518136978149414  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9153857231140137  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5175518989562988  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.915421485900879  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5216927528381348  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9255075454711914  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.519425868988037  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.919114589691162  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5182342529296875  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.916356086730957  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5185928344726562  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9180874824523926  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5183238983154297  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9169116020202637  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5211706161499023  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.921639919281006  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5224990844726562  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.925309658050537  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3570796102285385 |0.8827804177999496 |0.049110665917396545 |0.00014792382717132568 |0.018605053424835205 |0.0018839836120605469 |
----------------------------------------------------------pseudo_mini_loss sum 8.156709671020508
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  74215814
Number of first layer input nodes during this epoch:  36080117
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.90925931930542  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6669065952301025
random selection method range initialization spend 0.013661384582519531
time for parepare:  0.3781771659851074
local_output_nid generation:  0.006945610046386719
local_in_edges_tensor generation:  0.03801870346069336
mini_batch_src_global generation:  0.026880264282226562
r_  generation:  0.36589574813842773
local_output_nid generation:  0.0072422027587890625
local_in_edges_tensor generation:  0.017014026641845703
mini_batch_src_global generation:  0.038878679275512695
r_  generation:  0.4073982238769531
local_output_nid generation:  0.0071065425872802734
local_in_edges_tensor generation:  0.009575605392456055
mini_batch_src_global generation:  0.02334880828857422
r_  generation:  0.42231321334838867
local_output_nid generation:  0.00730443000793457
local_in_edges_tensor generation:  0.008817911148071289
mini_batch_src_global generation:  0.03599214553833008
r_  generation:  0.46614885330200195
local_output_nid generation:  0.007156848907470703
local_in_edges_tensor generation:  0.009102106094360352
mini_batch_src_global generation:  0.028687715530395508
r_  generation:  0.48543548583984375
local_output_nid generation:  0.00720977783203125
local_in_edges_tensor generation:  0.009294748306274414
mini_batch_src_global generation:  0.031011104583740234
r_  generation:  0.5013184547424316
local_output_nid generation:  0.00716853141784668
local_in_edges_tensor generation:  0.008855819702148438
mini_batch_src_global generation:  0.03210926055908203
r_  generation:  0.508169412612915
local_output_nid generation:  0.007139444351196289
local_in_edges_tensor generation:  0.00982213020324707
mini_batch_src_global generation:  0.03323984146118164
r_  generation:  0.5047817230224609
local_output_nid generation:  0.007187604904174805
local_in_edges_tensor generation:  0.00897836685180664
mini_batch_src_global generation:  0.03550529479980469
r_  generation:  0.5129201412200928
local_output_nid generation:  0.007178306579589844
local_in_edges_tensor generation:  0.012763261795043945
mini_batch_src_global generation:  0.035753726959228516
r_  generation:  0.577678918838501
local_output_nid generation:  0.007181882858276367
local_in_edges_tensor generation:  0.009130477905273438
mini_batch_src_global generation:  0.05070996284484863
r_  generation:  0.5591504573822021
local_output_nid generation:  0.007979154586791992
local_in_edges_tensor generation:  0.009027957916259766
mini_batch_src_global generation:  0.038445472717285156
r_  generation:  0.5453066825866699
local_output_nid generation:  0.0072345733642578125
local_in_edges_tensor generation:  0.025114059448242188
mini_batch_src_global generation:  0.042913198471069336
r_  generation:  0.5726172924041748
local_output_nid generation:  0.010866403579711914
local_in_edges_tensor generation:  0.034863948822021484
mini_batch_src_global generation:  0.04100918769836426
r_  generation:  0.5293800830841064
local_output_nid generation:  0.007217884063720703
local_in_edges_tensor generation:  0.02453923225402832
mini_batch_src_global generation:  0.04270052909851074
r_  generation:  0.5294895172119141
local_output_nid generation:  0.007283449172973633
local_in_edges_tensor generation:  0.01787567138671875
mini_batch_src_global generation:  0.04239320755004883
r_  generation:  0.5316028594970703
----------------------check_connections_block total spend ----------------------------- 10.800559043884277
generate_one_block  0.8821213245391846
generate_one_block  0.5375514030456543
generate_one_block  0.5332908630371094
generate_one_block  0.5302834510803223
generate_one_block  0.5223178863525391
generate_one_block  0.5239143371582031
generate_one_block  0.5342323780059814
generate_one_block  0.5060453414916992
generate_one_block  0.5413177013397217
generate_one_block  0.5180742740631104
generate_one_block  0.605658769607544
generate_one_block  0.625901460647583
generate_one_block  0.715139627456665
generate_one_block  0.5526931285858154
generate_one_block  0.5196840763092041
generate_one_block  0.5213820934295654
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.6526598930358887
gen group dst list time:  0.2649071216583252
time for parepare:  0.4940776824951172
local_output_nid generation:  0.17130446434020996
local_in_edges_tensor generation:  0.9227480888366699
mini_batch_src_global generation:  0.9878783226013184
r_  generation:  10.34792160987854
local_output_nid generation:  0.20893573760986328
local_in_edges_tensor generation:  0.9941599369049072
mini_batch_src_global generation:  1.2750749588012695
r_  generation:  10.498424053192139
local_output_nid generation:  0.18973422050476074
local_in_edges_tensor generation:  0.8395700454711914
mini_batch_src_global generation:  1.2385661602020264
r_  generation:  10.761360883712769
local_output_nid generation:  0.20476937294006348
local_in_edges_tensor generation:  0.8429055213928223
mini_batch_src_global generation:  1.1777822971343994
r_  generation:  11.211429595947266
local_output_nid generation:  0.20522689819335938
local_in_edges_tensor generation:  0.6693217754364014
mini_batch_src_global generation:  1.1359381675720215
r_  generation:  11.230268478393555
local_output_nid generation:  0.20117688179016113
local_in_edges_tensor generation:  0.8323264122009277
mini_batch_src_global generation:  1.1489641666412354
r_  generation:  11.213194131851196
local_output_nid generation:  0.20440077781677246
local_in_edges_tensor generation:  0.8418769836425781
mini_batch_src_global generation:  1.176060438156128
r_  generation:  11.094051837921143
local_output_nid generation:  0.17103266716003418
local_in_edges_tensor generation:  0.8445050716400146
mini_batch_src_global generation:  1.2898097038269043
r_  generation:  10.928149700164795
local_output_nid generation:  0.19580388069152832
local_in_edges_tensor generation:  0.8522894382476807
mini_batch_src_global generation:  1.302079200744629
r_  generation:  11.01339340209961
local_output_nid generation:  0.19596481323242188
local_in_edges_tensor generation:  0.8393616676330566
mini_batch_src_global generation:  1.2570929527282715
r_  generation:  10.960530042648315
local_output_nid generation:  0.2085878849029541
local_in_edges_tensor generation:  0.8420042991638184
mini_batch_src_global generation:  1.2925755977630615
r_  generation:  11.216259956359863
local_output_nid generation:  0.20542645454406738
local_in_edges_tensor generation:  0.8524298667907715
mini_batch_src_global generation:  1.2063918113708496
r_  generation:  11.242189407348633
local_output_nid generation:  0.20190191268920898
local_in_edges_tensor generation:  0.8462932109832764
mini_batch_src_global generation:  1.2119324207305908
r_  generation:  11.401118278503418
local_output_nid generation:  0.20287251472473145
local_in_edges_tensor generation:  0.6631836891174316
mini_batch_src_global generation:  1.219658374786377
r_  generation:  11.310959100723267
local_output_nid generation:  0.20663881301879883
local_in_edges_tensor generation:  0.8376755714416504
mini_batch_src_global generation:  1.1594908237457275
r_  generation:  11.328348159790039
local_output_nid generation:  0.21277761459350586
local_in_edges_tensor generation:  0.8323884010314941
mini_batch_src_global generation:  1.187664270401001
r_  generation:  11.222433090209961
----------------------check_connections_block total spend ----------------------------- 242.76455163955688
generate_one_block  15.57239818572998
generate_one_block  16.213331937789917
generate_one_block  15.88004994392395
generate_one_block  15.626295804977417
generate_one_block  15.470097303390503
generate_one_block  15.555673837661743
generate_one_block  15.56165599822998
generate_one_block  15.514556407928467
generate_one_block  15.503473281860352
generate_one_block  15.74214792251587
generate_one_block  15.606025457382202
generate_one_block  15.493552207946777
generate_one_block  15.654359340667725
generate_one_block  15.51525354385376
generate_one_block  15.49497365951538
generate_one_block  15.460663318634033
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2795259952545166
gen group dst list time:  1.115009069442749
time for parepare:  0.48413896560668945
local_output_nid generation:  0.6503806114196777
local_in_edges_tensor generation:  2.071622371673584
mini_batch_src_global generation:  1.9539337158203125
r_  generation:  23.71027636528015
local_output_nid generation:  0.6990976333618164
local_in_edges_tensor generation:  2.0136334896087646
mini_batch_src_global generation:  2.783494472503662
r_  generation:  24.466941595077515
local_output_nid generation:  0.714226484298706
local_in_edges_tensor generation:  2.1406493186950684
mini_batch_src_global generation:  2.719172716140747
r_  generation:  24.54018998146057
local_output_nid generation:  0.6909987926483154
local_in_edges_tensor generation:  1.8481993675231934
mini_batch_src_global generation:  2.8381917476654053
r_  generation:  24.829819202423096
local_output_nid generation:  0.7112314701080322
local_in_edges_tensor generation:  1.8385813236236572
mini_batch_src_global generation:  2.75382661819458
r_  generation:  24.71864604949951
local_output_nid generation:  0.6883807182312012
local_in_edges_tensor generation:  1.8452787399291992
mini_batch_src_global generation:  2.8465704917907715
r_  generation:  24.95946979522705
local_output_nid generation:  0.7045321464538574
local_in_edges_tensor generation:  1.8524987697601318
mini_batch_src_global generation:  2.7713470458984375
r_  generation:  24.876933813095093
local_output_nid generation:  0.6901264190673828
local_in_edges_tensor generation:  1.8552813529968262
mini_batch_src_global generation:  2.8132781982421875
r_  generation:  24.886720657348633
local_output_nid generation:  0.7088367938995361
local_in_edges_tensor generation:  1.852900743484497
mini_batch_src_global generation:  2.7662770748138428
r_  generation:  24.89880633354187
local_output_nid generation:  0.7022137641906738
local_in_edges_tensor generation:  1.8564348220825195
mini_batch_src_global generation:  2.8135128021240234
r_  generation:  24.922154426574707
local_output_nid generation:  0.7190051078796387
local_in_edges_tensor generation:  1.8544354438781738
mini_batch_src_global generation:  2.797668695449829
r_  generation:  25.080997705459595
local_output_nid generation:  0.7012386322021484
local_in_edges_tensor generation:  1.850804090499878
mini_batch_src_global generation:  2.802335739135742
r_  generation:  25.460212230682373
local_output_nid generation:  0.7081320285797119
local_in_edges_tensor generation:  1.851733684539795
mini_batch_src_global generation:  2.79080867767334
r_  generation:  25.04943823814392
local_output_nid generation:  0.7033164501190186
local_in_edges_tensor generation:  3.9612951278686523
mini_batch_src_global generation:  2.540621757507324
r_  generation:  24.941959142684937
local_output_nid generation:  0.7024121284484863
local_in_edges_tensor generation:  1.868605375289917
mini_batch_src_global generation:  2.7238173484802246
r_  generation:  25.060028314590454
local_output_nid generation:  0.6906359195709229
local_in_edges_tensor generation:  1.8452489376068115
mini_batch_src_global generation:  2.807401657104492
r_  generation:  24.9649817943573
----------------------check_connections_block total spend ----------------------------- 556.5945031642914
generate_one_block  34.05459928512573
generate_one_block  33.81670069694519
generate_one_block  33.93769812583923
generate_one_block  33.91411876678467
generate_one_block  33.74002122879028
generate_one_block  33.99008083343506
generate_one_block  34.07778453826904
generate_one_block  34.63368797302246
generate_one_block  36.13133788108826
generate_one_block  36.11927509307861
generate_one_block  36.75769639015198
generate_one_block  36.45475196838379
generate_one_block  37.10307049751282
generate_one_block  36.41500163078308
generate_one_block  37.43635177612305
generate_one_block  37.33483600616455
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.90925931930542  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

connection checking time:  799.3590548038483
block generation total time  815.7815208435059
average batch blocks generation time:  50.986345052719116
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5205745697021484  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9238409996032715  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.521573543548584  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.926011562347412  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5181875228881836  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.91567325592041  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.526442527770996  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.934544563293457  GigaBytes
Max Memory Allocated: 4.54585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.517660140991211  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.914736747741699  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5186710357666016  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.91786527633667  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.519312858581543  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.922044277191162  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5176916122436523  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.916513442993164  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5187172889709473  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9182591438293457  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5196642875671387  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9186882972717285  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5240745544433594  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9279227256774902  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.519169807434082  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.918282985687256  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5251541137695312  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9275341033935547  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.519864559173584  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9201102256774902  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5222368240356445  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9258713722229004  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.5196013450622559  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 2.9195075035095215  GigaBytes
Max Memory Allocated: 4.551009654998779  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36075033247470856 |0.8542972505092621 |0.005670264363288879 |0.00014071166515350342 |0.008913978934288025 |0.0027704238891601562 |
----------------------------------------------------------pseudo_mini_loss sum 5.924132347106934
Total (block generation + training)time/epoch 1707.5906171798706
Training time/epoch 1648510412.3955905
Training time without block to device /epoch 1648510398.7268345
Training time without total dataloading part /epoch 0.23836970329284668
load block tensor time/epoch 5.772005319595337
block to device time/epoch 13.668756008148193
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  74214430
Number of first layer input nodes during this epoch: Using backend: pytorch
 36085252
