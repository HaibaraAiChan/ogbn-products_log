main start at this time 1648504976.8962383
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6974787712097168
random selection method range initialization spend 0.014384269714355469
time for parepare:  0.38419413566589355
local_output_nid generation:  0.01361703872680664
local_in_edges_tensor generation:  0.05242204666137695
mini_batch_src_global generation:  0.051920413970947266
r_  generation:  0.9214568138122559
local_output_nid generation:  0.01996898651123047
local_in_edges_tensor generation:  0.036174774169921875
mini_batch_src_global generation:  0.07406401634216309
r_  generation:  1.0350825786590576
local_output_nid generation:  0.019740581512451172
local_in_edges_tensor generation:  0.04627680778503418
mini_batch_src_global generation:  0.05400800704956055
r_  generation:  1.029475212097168
local_output_nid generation:  0.021610021591186523
local_in_edges_tensor generation:  0.05874276161193848
mini_batch_src_global generation:  0.06866884231567383
r_  generation:  1.1170203685760498
local_output_nid generation:  0.0218355655670166
local_in_edges_tensor generation:  0.03299379348754883
mini_batch_src_global generation:  0.07365870475769043
r_  generation:  1.2039909362792969
local_output_nid generation:  0.020798444747924805
local_in_edges_tensor generation:  0.07115912437438965
mini_batch_src_global generation:  0.09057950973510742
r_  generation:  1.1287693977355957
local_output_nid generation:  0.027141809463500977
local_in_edges_tensor generation:  0.04195690155029297
mini_batch_src_global generation:  0.0735630989074707
r_  generation:  1.0845253467559814
local_output_nid generation:  0.013989448547363281
local_in_edges_tensor generation:  0.02260899543762207
mini_batch_src_global generation:  0.0735321044921875
r_  generation:  1.1274867057800293
----------------------check_connections_block total spend ----------------------------- 11.504618883132935
generate_one_block  6.642945766448975
generate_one_block  1.035414457321167
generate_one_block  1.0417072772979736
generate_one_block  1.0732126235961914
generate_one_block  1.1386744976043701
generate_one_block  1.0719630718231201
generate_one_block  1.1442985534667969
generate_one_block  1.0598032474517822
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.556953191757202
gen group dst list time:  0.19910979270935059
time for parepare:  0.4799654483795166
local_output_nid generation:  0.24755287170410156
local_in_edges_tensor generation:  1.0938856601715088
mini_batch_src_global generation:  1.2581748962402344
r_  generation:  15.220553636550903
local_output_nid generation:  0.28084683418273926
local_in_edges_tensor generation:  1.1754672527313232
mini_batch_src_global generation:  1.709686517715454
r_  generation:  15.456547260284424
local_output_nid generation:  0.27250146865844727
local_in_edges_tensor generation:  1.1525461673736572
mini_batch_src_global generation:  1.609311580657959
r_  generation:  15.522603988647461
local_output_nid generation:  0.27141857147216797
local_in_edges_tensor generation:  1.2326734066009521
mini_batch_src_global generation:  1.6847021579742432
r_  generation:  15.51871395111084
local_output_nid generation:  0.28286147117614746
local_in_edges_tensor generation:  1.1406984329223633
mini_batch_src_global generation:  1.7197012901306152
r_  generation:  15.706367492675781
local_output_nid generation:  0.28340983390808105
local_in_edges_tensor generation:  1.138681173324585
mini_batch_src_global generation:  1.6143162250518799
r_  generation:  15.681910991668701
local_output_nid generation:  0.2521700859069824
local_in_edges_tensor generation:  1.1439881324768066
mini_batch_src_global generation:  1.7298600673675537
r_  generation:  15.702131271362305
local_output_nid generation:  0.27277207374572754
local_in_edges_tensor generation:  0.9585421085357666
mini_batch_src_global generation:  1.7298791408538818
r_  generation:  15.621965408325195
----------------------check_connections_block total spend ----------------------------- 170.63286924362183
generate_one_block  21.785771369934082
generate_one_block  22.718666553497314
generate_one_block  22.23348355293274
generate_one_block  21.83279061317444
generate_one_block  21.72628355026245
generate_one_block  21.789225816726685
generate_one_block  21.806221961975098
generate_one_block  21.772364854812622
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.216773509979248
gen group dst list time:  0.6307640075683594
time for parepare:  0.4933009147644043
local_output_nid generation:  0.6601893901824951
local_in_edges_tensor generation:  2.0838334560394287
mini_batch_src_global generation:  2.032926321029663
r_  generation:  25.519699335098267
local_output_nid generation:  0.7174456119537354
local_in_edges_tensor generation:  2.1256723403930664
mini_batch_src_global generation:  2.8547511100769043
r_  generation:  25.06730580329895
local_output_nid generation:  0.7361798286437988
local_in_edges_tensor generation:  2.024092197418213
mini_batch_src_global generation:  2.618932008743286
r_  generation:  25.399696350097656
local_output_nid generation:  0.7095322608947754
local_in_edges_tensor generation:  1.864912986755371
mini_batch_src_global generation:  2.7716996669769287
r_  generation:  25.237201929092407
local_output_nid generation:  0.7264101505279541
local_in_edges_tensor generation:  1.8743829727172852
mini_batch_src_global generation:  2.7817678451538086
r_  generation:  25.41970944404602
local_output_nid generation:  0.7089564800262451
local_in_edges_tensor generation:  1.8811619281768799
mini_batch_src_global generation:  2.8291215896606445
r_  generation:  25.313369274139404
local_output_nid generation:  0.7156984806060791
local_in_edges_tensor generation:  1.8778891563415527
mini_batch_src_global generation:  2.6924333572387695
r_  generation:  25.459327936172485
local_output_nid generation:  0.7102632522583008
local_in_edges_tensor generation:  1.8681364059448242
mini_batch_src_global generation:  2.9105424880981445
r_  generation:  25.359449863433838
----------------------check_connections_block total spend ----------------------------- 283.2200608253479
generate_one_block  34.27324438095093
generate_one_block  35.649903774261475
generate_one_block  33.91888737678528
generate_one_block  33.93573188781738
generate_one_block  34.21895122528076
generate_one_block  35.32095551490784
generate_one_block  34.251068115234375
generate_one_block  34.61316394805908
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  453.8529300689697
block generation total time  451.84671449661255
average batch blocks generation time:  56.48083931207657
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7430419921875 GB
    Memory Allocated: 1.6403040885925293  GigaBytes
Max Memory Allocated: 1.6403040885925293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3387451171875 GB
    Memory Allocated: 3.305365562438965  GigaBytes
Max Memory Allocated: 3.829843521118164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6336669921875 GB
    Memory Allocated: 1.6448659896850586  GigaBytes
Max Memory Allocated: 4.946300983428955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6356201171875 GB
    Memory Allocated: 3.307607650756836  GigaBytes
Max Memory Allocated: 4.946300983428955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 1.6464166641235352  GigaBytes
Max Memory Allocated: 4.9483137130737305  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 3.309218406677246  GigaBytes
Max Memory Allocated: 4.9483137130737305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 1.642171859741211  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 3.300281524658203  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 1.643205165863037  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 3.3022122383117676  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 1.6438579559326172  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 3.3027267456054688  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 1.6430306434631348  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 3.3014492988586426  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 1.6455016136169434  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 3.3066916465759277  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3605993688106537 |1.1317285895347595 |0.09148150682449341 |0.00016993284225463867 |0.04168415069580078 |0.0038013458251953125 |
----------------------------------------------------------pseudo_mini_loss sum 8.187447547912598
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  40529072
Number of first layer input nodes during this epoch:  18221864
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 3.258464813232422  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6904704570770264
random selection method range initialization spend 0.01342320442199707
time for parepare:  0.3942568302154541
local_output_nid generation:  0.014923810958862305
local_in_edges_tensor generation:  0.052266597747802734
mini_batch_src_global generation:  0.05631446838378906
r_  generation:  0.8500244617462158
local_output_nid generation:  0.019998550415039062
local_in_edges_tensor generation:  0.0313568115234375
mini_batch_src_global generation:  0.06688523292541504
r_  generation:  0.888350248336792
local_output_nid generation:  0.013792276382446289
local_in_edges_tensor generation:  0.031522274017333984
mini_batch_src_global generation:  0.04892468452453613
r_  generation:  0.9062883853912354
local_output_nid generation:  0.013873577117919922
local_in_edges_tensor generation:  0.02785634994506836
mini_batch_src_global generation:  0.05701041221618652
r_  generation:  0.9964685440063477
local_output_nid generation:  0.013959407806396484
local_in_edges_tensor generation:  0.03357958793640137
mini_batch_src_global generation:  0.06776142120361328
r_  generation:  1.0579991340637207
local_output_nid generation:  0.014365673065185547
local_in_edges_tensor generation:  0.022145986557006836
mini_batch_src_global generation:  0.0741720199584961
r_  generation:  1.1117656230926514
local_output_nid generation:  0.014281511306762695
local_in_edges_tensor generation:  0.025564193725585938
mini_batch_src_global generation:  0.07162141799926758
r_  generation:  1.1146416664123535
local_output_nid generation:  0.014459848403930664
local_in_edges_tensor generation:  0.017296552658081055
mini_batch_src_global generation:  0.0844259262084961
r_  generation:  1.1143884658813477
----------------------check_connections_block total spend ----------------------------- 10.625269889831543
generate_one_block  1.4047505855560303
generate_one_block  1.050224781036377
generate_one_block  1.0403499603271484
generate_one_block  1.0480732917785645
generate_one_block  1.0402040481567383
generate_one_block  1.0503120422363281
generate_one_block  1.0596747398376465
generate_one_block  1.0364553928375244
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.376710891723633
gen group dst list time:  0.2081596851348877
time for parepare:  0.48038601875305176
local_output_nid generation:  0.24774479866027832
local_in_edges_tensor generation:  1.1493384838104248
mini_batch_src_global generation:  1.2748494148254395
r_  generation:  15.133334636688232
local_output_nid generation:  0.28746628761291504
local_in_edges_tensor generation:  1.1927647590637207
mini_batch_src_global generation:  1.6714611053466797
r_  generation:  15.321251153945923
local_output_nid generation:  0.28823351860046387
local_in_edges_tensor generation:  1.415684700012207
mini_batch_src_global generation:  1.7596004009246826
r_  generation:  15.564684391021729
local_output_nid generation:  0.2997736930847168
local_in_edges_tensor generation:  1.1615912914276123
mini_batch_src_global generation:  1.9792213439941406
r_  generation:  16.14475679397583
local_output_nid generation:  0.2874410152435303
local_in_edges_tensor generation:  1.158102035522461
mini_batch_src_global generation:  2.018171548843384
r_  generation:  16.46203064918518
local_output_nid generation:  0.30310654640197754
local_in_edges_tensor generation:  1.1623327732086182
mini_batch_src_global generation:  2.060075044631958
r_  generation:  16.24191927909851
local_output_nid generation:  0.29332947731018066
local_in_edges_tensor generation:  1.1531105041503906
mini_batch_src_global generation:  1.837275743484497
r_  generation:  15.844604253768921
local_output_nid generation:  0.3004181385040283
local_in_edges_tensor generation:  1.1754579544067383
mini_batch_src_global generation:  2.0017313957214355
r_  generation:  16.210687398910522
----------------------check_connections_block total spend ----------------------------- 175.70276737213135
generate_one_block  22.592081785202026
generate_one_block  22.11903214454651
generate_one_block  21.941123962402344
generate_one_block  22.259084701538086
generate_one_block  22.446900844573975
generate_one_block  22.156866312026978
generate_one_block  22.23562240600586
generate_one_block  22.157830238342285
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2194037437438965
gen group dst list time:  0.6156771183013916
time for parepare:  0.4785318374633789
local_output_nid generation:  0.6390380859375
local_in_edges_tensor generation:  1.8750972747802734
mini_batch_src_global generation:  1.9638347625732422
r_  generation:  24.81869411468506
local_output_nid generation:  0.7080955505371094
local_in_edges_tensor generation:  2.1604959964752197
mini_batch_src_global generation: Using backend: pytorch
 2.795463800430298
r_  generation:  25.664079427719116
local_output_nid generation:  0.709446907043457
local_in_edges_tensor generation:  1.88395094871521
mini_batch_src_global generation:  2.788552761077881
r_  generation:  25.764474868774414
local_output_nid generation:  0.6992170810699463
local_in_edges_tensor generation:  1.8920328617095947
mini_batch_src_global generation:  2.9636919498443604
r_  generation:  25.80313229560852
local_output_nid generation:  0.711885929107666
local_in_edges_tensor generation:  1.8952720165252686
mini_batch_src_global generation:  2.85565185546875
r_  generation:  26.00033402442932
local_output_nid generation:  0.7043805122375488
local_in_edges_tensor generation:  1.8831000328063965
mini_batch_src_global generation:  3.0303597450256348
r_  generation:  25.882685899734497
local_output_nid generation:  0.7247064113616943
local_in_edges_tensor generation:  1.8889615535736084
mini_batch_src_global generation:  2.964811325073242
r_  generation:  26.07451295852661
local_output_nid generation:  0.7047429084777832
local_in_edges_tensor generation:  1.8980426788330078
mini_batch_src_global generation:  3.136704683303833
r_  generation:  28.270952939987183
----------------------check_connections_block total spend ----------------------------- 289.345210313797
generate_one_block  35.00167942047119
generate_one_block  35.00067615509033
generate_one_block  34.91605067253113
generate_one_block  35.6527898311615
generate_one_block  34.968504428863525
generate_one_block  34.89510464668274
generate_one_block  35.11038589477539
generate_one_block  35.465874433517456
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 3.258464813232422  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

connection checking time:  465.04797768592834
block generation total time  458.9196078777313
average batch blocks generation time:  57.364950984716415
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 1.6447687149047852  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 3.3050131797790527  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6375732421875 GB
    Memory Allocated: 1.6480703353881836  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 3.313447952270508  GigaBytes
Max Memory Allocated: 4.9502339363098145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.6414599418640137  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 3.298048496246338  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.642530918121338  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 3.3011012077331543  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.642690658569336  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 3.30068302154541  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 1.6455392837524414  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1141357421875 GB
    Memory Allocated: 3.3054637908935547  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9656982421875 GB
    Memory Allocated: 1.6468443870544434  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9656982421875 GB
    Memory Allocated: 3.309627056121826  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9656982421875 GB
    Memory Allocated: 1.6451268196105957  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9656982421875 GB
    Memory Allocated: 3.306370735168457  GigaBytes
Max Memory Allocated: 4.954582691192627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37928852438926697 |0.9945317804813385 |0.0049307942390441895 |0.00013688206672668457 |0.018304884433746338 |0.0017070770263671875 |
----------------------------------------------------------pseudo_mini_loss sum 5.912210464477539
Total (block generation + training)time/epoch 993.6002097129822
Training time/epoch 1648506997.4546323
Training time without block to device /epoch 1648506989.498378
Training time without total dataloading part /epoch 0.18868756294250488
load block tensor time/epoch 3.0343081951141357
block to device time/epoch 7.956254243850708
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  40529601
Number of first layer input nodes during this epoch:  18220916
