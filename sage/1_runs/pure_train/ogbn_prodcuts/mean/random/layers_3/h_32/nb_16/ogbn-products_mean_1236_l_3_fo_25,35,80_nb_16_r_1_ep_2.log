main start at this time 1648446681.1270077
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6316258907318115
random selection method range initialization spend 0.014605522155761719
time for parepare:  0.3699796199798584
local_output_nid generation:  0.006976127624511719
local_in_edges_tensor generation:  0.03714108467102051
mini_batch_src_global generation:  0.0416562557220459
r_  generation:  0.3696858882904053
local_output_nid generation:  0.0072362422943115234
local_in_edges_tensor generation:  0.016720056533813477
mini_batch_src_global generation:  0.03377938270568848
r_  generation:  0.40763092041015625
local_output_nid generation:  0.00720524787902832
local_in_edges_tensor generation:  0.009821176528930664
mini_batch_src_global generation:  0.023524045944213867
r_  generation:  0.42053651809692383
local_output_nid generation:  0.007305622100830078
local_in_edges_tensor generation:  0.013076305389404297
mini_batch_src_global generation:  0.02625894546508789
r_  generation:  0.45838069915771484
local_output_nid generation:  0.00718998908996582
local_in_edges_tensor generation:  0.00984501838684082
mini_batch_src_global generation:  0.02860546112060547
r_  generation:  0.46880435943603516
local_output_nid generation:  0.007247447967529297
local_in_edges_tensor generation:  0.009630203247070312
mini_batch_src_global generation:  0.031160593032836914
r_  generation:  0.5015218257904053
local_output_nid generation:  0.007176876068115234
local_in_edges_tensor generation:  0.009747743606567383
mini_batch_src_global generation:  0.03267312049865723
r_  generation:  0.509131669998169
local_output_nid generation:  0.0071659088134765625
local_in_edges_tensor generation:  0.009721994400024414
mini_batch_src_global generation:  0.03363680839538574
r_  generation:  0.5025217533111572
local_output_nid generation:  0.0071828365325927734
local_in_edges_tensor generation:  0.009634256362915039
mini_batch_src_global generation:  0.03542041778564453
r_  generation:  0.5178797245025635
local_output_nid generation:  0.007143974304199219
local_in_edges_tensor generation:  0.00981450080871582
mini_batch_src_global generation:  0.036036014556884766
r_  generation:  0.5255858898162842
local_output_nid generation:  0.007300376892089844
local_in_edges_tensor generation:  0.010115861892700195
mini_batch_src_global generation:  0.03791689872741699
r_  generation:  0.5143122673034668
local_output_nid generation:  0.007299661636352539
local_in_edges_tensor generation:  0.009432792663574219
mini_batch_src_global generation:  0.03939414024353027
r_  generation:  0.5215883255004883
local_output_nid generation:  0.007165193557739258
local_in_edges_tensor generation:  0.009799480438232422
mini_batch_src_global generation:  0.0423583984375
r_  generation:  0.5359947681427002
local_output_nid generation:  0.00715947151184082
local_in_edges_tensor generation:  0.009763717651367188
mini_batch_src_global generation:  0.041321754455566406
r_  generation:  0.5363922119140625
local_output_nid generation:  0.0071527957916259766
local_in_edges_tensor generation:  0.009928464889526367
mini_batch_src_global generation:  0.04211282730102539
r_  generation:  0.5346572399139404
local_output_nid generation:  0.007124423980712891
local_in_edges_tensor generation:  0.009657621383666992
mini_batch_src_global generation:  0.04237675666809082
r_  generation:  0.5216608047485352
----------------------check_connections_block total spend ----------------------------- 10.448206901550293
generate_one_block  5.715790510177612
generate_one_block  0.5090789794921875
generate_one_block  0.5171165466308594
generate_one_block  0.5090079307556152
generate_one_block  0.5106472969055176
generate_one_block  0.5047929286956787
generate_one_block  0.5062885284423828
generate_one_block  0.5006139278411865
generate_one_block  0.5037417411804199
generate_one_block  0.503272533416748
generate_one_block  0.5147454738616943
generate_one_block  0.5026412010192871
generate_one_block  0.5068502426147461
generate_one_block  0.5056099891662598
generate_one_block  0.5067815780639648
generate_one_block  0.5024430751800537
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.384982109069824
gen group dst list time:  0.23601651191711426
time for parepare:  0.4472036361694336
local_output_nid generation:  0.16016864776611328
local_in_edges_tensor generation:  0.534912109375
mini_batch_src_global generation:  0.5206382274627686
r_  generation:  6.350840330123901
local_output_nid generation:  0.16408824920654297
local_in_edges_tensor generation:  0.43812036514282227
mini_batch_src_global generation:  0.6492602825164795
r_  generation:  6.548607110977173
local_output_nid generation:  0.1673574447631836
local_in_edges_tensor generation:  0.44338417053222656
mini_batch_src_global generation:  0.6368668079376221
r_  generation:  6.828730821609497
local_output_nid generation:  0.17393732070922852
local_in_edges_tensor generation:  0.4486355781555176
mini_batch_src_global generation:  0.7234249114990234
r_  generation:  6.8816399574279785
local_output_nid generation:  0.17435598373413086
local_in_edges_tensor generation:  0.5003936290740967
mini_batch_src_global generation:  0.689183235168457
r_  generation:  6.874913215637207
local_output_nid generation:  0.17490696907043457
local_in_edges_tensor generation:  0.47192859649658203
mini_batch_src_global generation:  0.689030647277832
r_  generation:  6.95465350151062
local_output_nid generation:  0.20013809204101562
local_in_edges_tensor generation:  0.5190322399139404
mini_batch_src_global generation:  0.6837410926818848
r_  generation:  6.869723320007324
local_output_nid generation:  0.17395973205566406
local_in_edges_tensor generation:  0.456676721572876
mini_batch_src_global generation:  0.7228686809539795
r_  generation:  7.009669542312622
local_output_nid generation:  0.16794705390930176
local_in_edges_tensor generation:  0.6221110820770264
mini_batch_src_global generation:  0.6853134632110596
r_  generation:  6.90835428237915
local_output_nid generation:  0.18897652626037598
local_in_edges_tensor generation:  0.6183109283447266
mini_batch_src_global generation:  0.6874628067016602
r_  generation:  7.103909969329834
local_output_nid generation:  0.16948747634887695
local_in_edges_tensor generation:  0.4541294574737549
mini_batch_src_global generation:  0.7204010486602783
r_  generation:  7.045790195465088
local_output_nid generation:  0.19924402236938477
local_in_edges_tensor generation:  0.5795495510101318
mini_batch_src_global generation:  0.6899852752685547
r_  generation:  6.944640159606934
local_output_nid generation:  0.16879725456237793
local_in_edges_tensor generation:  0.44975709915161133
mini_batch_src_global generation:  0.7413983345031738
r_  generation:  7.0871171951293945
local_output_nid generation:  0.17014455795288086
local_in_edges_tensor generation:  0.47275733947753906
mini_batch_src_global generation:  0.7169485092163086
r_  generation:  6.995705842971802
local_output_nid generation:  0.19948220252990723
local_in_edges_tensor generation:  0.5430357456207275
mini_batch_src_global generation:  0.7063033580780029
r_  generation:  6.969331741333008
local_output_nid generation:  0.17415618896484375
local_in_edges_tensor generation:  0.44365692138671875
mini_batch_src_global generation:  0.7419228553771973
r_  generation:  7.0479254722595215
----------------------check_connections_block total spend ----------------------------- 151.63640189170837
generate_one_block  9.890990257263184
generate_one_block  9.002801656723022
generate_one_block  9.156415224075317
generate_one_block  9.184456825256348
generate_one_block  9.042508840560913
generate_one_block  9.096322059631348
generate_one_block  9.165874004364014
generate_one_block  9.031699180603027
generate_one_block  9.185239553451538
generate_one_block  9.215871334075928
generate_one_block  8.989090204238892
generate_one_block  8.999505758285522
generate_one_block  9.272649765014648
generate_one_block  9.005984783172607
generate_one_block  8.897459506988525
generate_one_block  9.312242031097412
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.128856897354126
gen group dst list time:  0.9938256740570068
time for parepare:  0.4982185363769531
local_output_nid generation:  0.5663187503814697
local_in_edges_tensor generation:  1.3215458393096924
mini_batch_src_global generation:  1.1277682781219482
r_  generation:  14.718876838684082
local_output_nid generation:  0.6160681247711182
local_in_edges_tensor generation:  1.399139642715454
mini_batch_src_global generation:  1.509885549545288
r_  generation:  14.73110318183899
local_output_nid generation:  0.6125125885009766
local_in_edges_tensor generation:  1.2124531269073486
mini_batch_src_global generation:  1.6153593063354492
r_  generation:  15.554886102676392
local_output_nid generation:  0.6274404525756836
local_in_edges_tensor generation:  1.2197871208190918
mini_batch_src_global generation:  1.554809808731079
r_  generation:  15.067374229431152
local_output_nid generation:  0.621340274810791
local_in_edges_tensor generation:  1.2213563919067383
mini_batch_src_global generation:  1.6042587757110596
r_  generation:  15.745317459106445
local_output_nid generation:  0.6238877773284912
local_in_edges_tensor generation:  2.4357595443725586
mini_batch_src_global generation:  1.6614491939544678
r_  generation:  15.576853513717651
local_output_nid generation:  0.6215097904205322
local_in_edges_tensor generation:  1.221567153930664
mini_batch_src_global generation:  1.5959553718566895
r_  generation:  15.839398622512817
local_output_nid generation:  0.633134126663208
local_in_edges_tensor generation:  1.2140986919403076
mini_batch_src_global generation:  1.4688396453857422
r_  generation:  15.353648900985718
local_output_nid generation:  0.6290493011474609
local_in_edges_tensor generation:  1.222639799118042
mini_batch_src_global generation:  1.4209270477294922
r_  generation:  15.307085275650024
local_output_nid generation:  0.57952880859375
local_in_edges_tensor generation:  1.1463963985443115
mini_batch_src_global generation:  1.5526390075683594
r_  generation:  15.157759428024292
local_output_nid generation:  0.6152892112731934
local_in_edges_tensor generation:  1.1880533695220947
mini_batch_src_global generation:  1.543142318725586
r_  generation:  15.331905364990234
local_output_nid generation:  0.6232573986053467
local_in_edges_tensor generation:  1.2325489521026611
mini_batch_src_global generation:  1.4722790718078613
r_  generation:  15.139766931533813
local_output_nid generation:  0.5743803977966309
local_in_edges_tensor generation:  1.2278552055358887
mini_batch_src_global generation:  1.4438636302947998
r_  generation:  14.933892011642456
local_output_nid generation:  0.6043298244476318
local_in_edges_tensor generation:  1.0867443084716797
mini_batch_src_global generation:  1.472264289855957
r_  generation:  14.918169021606445
local_output_nid generation:  0.6110031604766846
local_in_edges_tensor generation:  1.2117486000061035
mini_batch_src_global generation:  1.48195481300354
r_  generation:  15.207008361816406
local_output_nid generation:  0.6148765087127686
local_in_edges_tensor generation:  1.2177395820617676
mini_batch_src_global generation:  1.4255568981170654
r_  generation:  15.222116231918335
----------------------check_connections_block total spend ----------------------------- 342.8527328968048
generate_one_block  20.194732427597046
generate_one_block  20.063949823379517
generate_one_block  19.96065068244934
generate_one_block  20.3046293258667
generate_one_block  20.34076714515686
generate_one_block  20.286094188690186
generate_one_block  20.42749786376953
generate_one_block  19.963955640792847
generate_one_block  20.05983567237854
generate_one_block  20.111905097961426
generate_one_block  20.197922229766846
generate_one_block  20.269045114517212
generate_one_block  20.20698618888855
generate_one_block  20.206074476242065
generate_one_block  19.702991008758545
generate_one_block  20.365968465805054
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  494.4891347885132
block generation total time  469.1121163368225
average batch blocks generation time:  29.319507271051407
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3094482421875 GB
    Memory Allocated: 1.2061686515808105  GigaBytes
Max Memory Allocated: 1.2061686515808105  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4676513671875 GB
    Memory Allocated: 2.285191535949707  GigaBytes
Max Memory Allocated: 2.5992870330810547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1903076171875 GB
    Memory Allocated: 1.2083830833435059  GigaBytes
Max Memory Allocated: 3.145737648010254  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1903076171875 GB
    Memory Allocated: 2.2821240425109863  GigaBytes
Max Memory Allocated: 3.145737648010254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1903076171875 GB
    Memory Allocated: 1.2077851295471191  GigaBytes
Max Memory Allocated: 3.145737648010254  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1903076171875 GB
    Memory Allocated: 2.2815260887145996  GigaBytes
Max Memory Allocated: 3.145737648010254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1903076171875 GB
    Memory Allocated: 1.2107038497924805  GigaBytes
Max Memory Allocated: 3.145737648010254  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1922607421875 GB
    Memory Allocated: 2.290947914123535  GigaBytes
Max Memory Allocated: 3.145737648010254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.209843635559082  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2884469032287598  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2088141441345215  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2844676971435547  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2060317993164062  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.278622627258301  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2078948020935059  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2825002670288086  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2051124572753906  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2777023315429688  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2088007926940918  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2836689949035645  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2064108848571777  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2811923027038574  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2057695388793945  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2788286209106445  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2078580856323242  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2812747955322266  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2072606086730957  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.282163143157959  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2098360061645508  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.285548210144043  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.209794521331787  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.285640239715576  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3331602066755295 |0.5153062343597412 |0.044722363352775574 |0.00017783045768737793 |0.01120951771736145 |0.002439260482788086 |
----------------------------------------------------------pseudo_mini_loss sum 8.279431343078613
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  70322262
Number of first layer input nodes during this epoch:  34748239
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.0254321098327637  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7595438957214355
random selection method range initialization spend 0.016678333282470703
time for parepare:  0.3842897415161133
local_output_nid generation:  0.007089138031005859
local_in_edges_tensor generation:  0.03990793228149414
mini_batch_src_global generation:  0.0285491943359375
r_  generation:  0.3779597282409668
local_output_nid generation:  0.007145881652832031
local_in_edges_tensor generation:  0.014931201934814453
mini_batch_src_global generation:  0.03420901298522949
r_  generation:  0.41034579277038574
local_output_nid generation:  0.007143974304199219
local_in_edges_tensor generation:  0.009912729263305664
mini_batch_src_global generation:  0.02345752716064453
r_  generation:  0.43082189559936523
local_output_nid generation:  0.007191181182861328
local_in_edges_tensor generation:  0.009581804275512695
mini_batch_src_global generation:  0.026093721389770508
r_  generation:  0.48438191413879395
local_output_nid generation:  0.00713658332824707
local_in_edges_tensor generation:  0.009256601333618164
mini_batch_src_global generation:  0.028374910354614258
r_  generation:  0.4859764575958252
local_output_nid generation:  0.007205009460449219
local_in_edges_tensor generation:  0.009299516677856445
mini_batch_src_global generation:  0.031272172927856445
r_  generation:  0.5420947074890137
local_output_nid generation:  0.007176876068115234
local_in_edges_tensor generation:  0.009301900863647461
mini_batch_src_global generation:  0.03259396553039551
r_  generation:  0.5167851448059082
local_output_nid generation:  0.0071527957916259766
local_in_edges_tensor generation:  0.009333372116088867
mini_batch_src_global generation:  0.03354382514953613
r_  generation:  0.5292263031005859
local_output_nid generation:  0.0077435970306396484
local_in_edges_tensor generation:  0.01852726936340332
mini_batch_src_global generation:  0.03503608703613281
r_  generation:  0.5420875549316406
local_output_nid generation:  0.007181406021118164
local_in_edges_tensor generation:  0.014945268630981445
mini_batch_src_global generation:  0.03615760803222656
r_  generation:  0.5376887321472168
local_output_nid generation:  0.008543968200683594
local_in_edges_tensor generation:  0.021637439727783203
mini_batch_src_global generation:  0.03823351860046387
r_  generation:  0.5271933078765869
local_output_nid generation:  0.007165193557739258
local_in_edges_tensor generation:  0.01697540283203125
mini_batch_src_global generation:  0.04406261444091797
r_  generation:  0.5397744178771973
local_output_nid generation:  0.0071468353271484375
local_in_edges_tensor generation:  0.013652324676513672
mini_batch_src_global generation:  0.04201650619506836
r_  generation:  0.542405366897583
local_output_nid generation:  0.008874177932739258
local_in_edges_tensor generation:  0.01200103759765625
mini_batch_src_global generation:  0.041825294494628906
r_  generation:  0.5384156703948975
local_output_nid generation:  0.00722956657409668
local_in_edges_tensor generation:  0.011070728302001953
mini_batch_src_global generation:  0.04176521301269531
r_  generation:  0.5517721176147461
local_output_nid generation:  0.007198333740234375
local_in_edges_tensor generation:  0.009947538375854492
mini_batch_src_global generation:  0.04205155372619629
r_  generation:  0.5293576717376709
----------------------check_connections_block total spend ----------------------------- 10.825112581253052
generate_one_block  0.8667044639587402
generate_one_block  0.5374109745025635
generate_one_block  0.5131571292877197
generate_one_block  0.5168836116790771
generate_one_block  0.523792028427124
generate_one_block  0.5119767189025879
generate_one_block  0.5152332782745361
generate_one_block  0.5117785930633545
generate_one_block  0.5150516033172607
generate_one_block  0.5295042991638184
generate_one_block  0.524989128112793
generate_one_block  0.5112307071685791
generate_one_block  0.526331901550293
generate_one_block  0.533123254776001
generate_one_block  0.5187056064605713
generate_one_block  0.5193169116973877
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.447094202041626
gen group dst list time:  0.254915714263916
time for parepare:  0.46933889389038086
local_output_nid generation:  0.1651015281677246
local_in_edges_tensor generation:  0.5952436923980713
mini_batch_src_global generation:  0.5177984237670898
r_  generation:  6.728602409362793
local_output_nid generation:  0.20601367950439453
local_in_edges_tensor generation:  0.6958420276641846
mini_batch_src_global generation:  0.6720547676086426
r_  generation:  6.954749584197998
local_output_nid generation:  0.19683527946472168
local_in_edges_tensor generation:  0.6338455677032471
mini_batch_src_global generation:  0.6352999210357666
r_  generation:  6.6507792472839355
local_output_nid generation:  0.1735093593597412
local_in_edges_tensor generation:  0.5962388515472412
mini_batch_src_global generation:  0.6951491832733154
r_  generation:  7.022327184677124
local_output_nid generation:  0.19768476486206055
local_in_edges_tensor generation:  0.4524664878845215
mini_batch_src_global generation:  0.6750583648681641
r_  generation:  6.870456218719482
local_output_nid generation:  0.16537809371948242
local_in_edges_tensor generation:  0.5678238868713379
mini_batch_src_global generation:  0.7231943607330322
r_  generation:  7.148945331573486
local_output_nid generation:  0.19828009605407715
local_in_edges_tensor generation:  0.45529913902282715
mini_batch_src_global generation:  0.6969263553619385
r_  generation:  6.964801549911499
local_output_nid generation:  0.1746973991394043
local_in_edges_tensor generation:  0.5635826587677002
mini_batch_src_global generation:  0.7205865383148193
r_  generation:  7.133862018585205
local_output_nid generation:  0.17734503746032715
local_in_edges_tensor generation:  0.44688987731933594
mini_batch_src_global generation:  0.7163505554199219
r_  generation:  6.9393322467803955
local_output_nid generation:  0.18601655960083008
local_in_edges_tensor generation:  0.5622966289520264
mini_batch_src_global generation:  0.722747802734375
r_  generation:  7.066595554351807
local_output_nid generation:  0.1677403450012207
local_in_edges_tensor generation:  0.46255970001220703
mini_batch_src_global generation:  0.7196776866912842
r_  generation:  6.954050064086914
local_output_nid generation:  0.18628621101379395
local_in_edges_tensor generation:  0.571108341217041
mini_batch_src_global generation:  0.7270176410675049
r_  generation:  7.102671146392822
local_output_nid generation:  0.1766824722290039
local_in_edges_tensor generation:  0.45868945121765137
mini_batch_src_global generation:  0.7295074462890625
r_  generation:  6.974907875061035
local_output_nid generation:  0.18235373497009277
local_in_edges_tensor generation:  0.5615048408508301
mini_batch_src_global generation:  0.731489896774292
r_  generation:  7.134020090103149
local_output_nid generation:  0.19158244132995605
local_in_edges_tensor generation:  0.44292259216308594
mini_batch_src_global generation:  0.7256245613098145
r_  generation:  6.961040258407593
local_output_nid generation:  0.17647624015808105
local_in_edges_tensor generation:  0.5704987049102783
mini_batch_src_global generation:  0.7604160308837891
r_  generation:  7.107912063598633
----------------------check_connections_block total spend ----------------------------- 154.03681921958923
generate_one_block  9.40769100189209
generate_one_block  9.608883142471313
generate_one_block  9.43343997001648
generate_one_block  9.133706092834473
generate_one_block  9.448621034622192
generate_one_block  9.040159225463867
generate_one_block  9.546051025390625
generate_one_block  9.223283052444458
generate_one_block  9.244212865829468
generate_one_block  9.5680832862854
generate_one_block  9.0793297290802
generate_one_block  9.426785707473755
generate_one_block  9.048243999481201
generate_one_block  9.428755044937134
generate_one_block  8.986210584640503
generate_one_block  9.402948141098022
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.192283868789673
gen group dst list time:  1.0341169834136963
time for parepare:  0.48969340324401855
local_output_nid generation:  0.6320631504058838
local_in_edges_tensor generation:  1.306509256362915
mini_batch_src_global generation:  1.0853934288024902
r_  generation:  14.769937753677368
local_output_nid generation:  0.6172161102294922
local_in_edges_tensor generation:  1.314845085144043
mini_batch_src_global generation:  1.3885462284088135
r_  generation:  15.305232763290405
local_output_nid generation:  0.6177747249603271
local_in_edges_tensor generation:  1.4464502334594727
mini_batch_src_global generation:  1.3926522731781006
r_  generation:  15.229242324829102
local_output_nid generation:  0.6152887344360352
local_in_edges_tensor generation:  1.226196050643921
mini_batch_src_global generation:  1.4142992496490479
r_  generation:  15.49560809135437
local_output_nid generation:  0.6273016929626465
local_in_edges_tensor generation:  1.2180206775665283
mini_batch_src_global generation:  1.4259881973266602
r_  generation:  15.438010454177856
local_output_nid generation:  0.6189267635345459
local_in_edges_tensor generation:  1.2277333736419678
mini_batch_src_global generation:  1.4282763004302979
r_  generation:  15.377354621887207
local_output_nid generation:  0.6075780391693115
local_in_edges_tensor generation:  1.2399425506591797
mini_batch_src_global generation:  1.4492759704589844
r_  generation:  15.778063535690308
local_output_nid generation:  0.6102445125579834
local_in_edges_tensor generation:  1.2460107803344727
mini_batch_src_global generation:  1.4699115753173828
r_  generation:  15.354822874069214
local_output_nid generation:  0.6047036647796631
local_in_edges_tensor generation:  1.2366023063659668
mini_batch_src_global generation:  1.4493992328643799
r_  generation:  15.430738687515259
local_output_nid generation:  0.6010127067565918
local_in_edges_tensor generation:  1.2254314422607422
mini_batch_src_global generation:  1.4649226665496826
r_  generation:  15.39486026763916
local_output_nid generation:  0.6138169765472412
local_in_edges_tensor generation:  1.230255126953125
mini_batch_src_global generation:  1.4546587467193604
r_  generation:  15.458397626876831
local_output_nid generation:  0.5975911617279053
local_in_edges_tensor generation:  1.2343268394470215
mini_batch_src_global generation:  1.484306812286377
r_  generation:  15.40932846069336
local_output_nid generation:  0.6200575828552246
local_in_edges_tensor generation:  1.2363576889038086
mini_batch_src_global generation:  1.506819486618042
r_  generation:  15.41042709350586
local_output_nid generation:  0.5990011692047119
local_in_edges_tensor generation:  2.884626865386963
mini_batch_src_global generation:  1.434537410736084
r_  generation:  15.17457914352417
local_output_nid generation:  0.610630989074707
local_in_edges_tensor generation:  1.2439985275268555
mini_batch_src_global generation:  1.5542221069335938
r_  generation:  15.385037422180176
local_output_nid generation:  0.6089696884155273
local_in_edges_tensor generation:  1.179692029953003
mini_batch_src_global generation:  1.6247379779815674
r_  generation:  15.347720623016357
----------------------check_connections_block total spend ----------------------------- 345.0454828739166
generate_one_block  20.87138080596924
generate_one_block  20.773688793182373
generate_one_block  20.689558267593384
generate_one_block  20.800464153289795
generate_one_block  20.68327307701111
generate_one_block  20.68235158920288
generate_one_block  20.786832332611084
generate_one_block  21.09278631210327
generate_one_block  20.67633605003357
generate_one_block  20.676214456558228
generate_one_block  20.70173144340515
generate_one_block  20.696715831756592
generate_one_block  20.749489068984985
generate_one_block  20.631176948547363
generate_one_block  20.664664268493652
generate_one_block  20.663132429122925
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.0254321098327637  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

connection checking time:  499.08230209350586
block generation total time  480.8661997318268
average batch blocks generation time:  30.054137483239174
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2086524963378906  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.282630443572998  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.208326816558838  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.283506393432617  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.205902099609375  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.278428554534912  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2111554145812988  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2901015281677246  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2057080268859863  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.277803421020508  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2083840370178223  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2814550399780273  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2083415985107422  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.28416109085083  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2083921432495117  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2807888984680176  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2078094482421875  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.281980037689209  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2062897682189941  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2795300483703613  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2109742164611816  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2855091094970703  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2066044807434082  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2810654640197754  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2106328010559082  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.286745548248291  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2083454132080078  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2823901176452637  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.2088665962219238  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.2844324111938477  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 1.209397792816162  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1942138671875 GB
    Memory Allocated: 2.282374858856201  GigaBytes
Max Memory Allocated: 3.1532669067382812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.31589867174625397 |0.3574245274066925 |0.0037326067686080933 |0.00014603137969970703 |0.004876494407653809 |0.0027189254760742188 |
----------------------------------------------------------pseudo_mini_loss sum 6.003989219665527
Total (block generation + training)time/epoch 1044.8468515872955
Training time/epoch 1648448804.0400674
Training time without block to device /epoch 1648448798.321275
Training time without total dataloading part /epoch 0.14280104637145996
load block tensor time/epoch 5.0543787479400635
block to device time/epoch 5.71879243850708
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  70327242
Number of first layer input nodes during this epoch: Using backend: pytorch
 34750248
