main start at this time 1648421273.496582
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.37285685539245605
random selection method range initialization spend 0.016392230987548828
time for parepare:  0.2791175842285156
local_output_nid generation:  0.01251220703125
local_in_edges_tensor generation:  0.03604006767272949
mini_batch_src_global generation:  0.029429197311401367
r_  generation:  0.4165000915527344
local_output_nid generation:  0.01385807991027832
local_in_edges_tensor generation:  0.022399187088012695
mini_batch_src_global generation:  0.041541337966918945
r_  generation:  0.46845459938049316
local_output_nid generation:  0.013668298721313477
local_in_edges_tensor generation:  0.013098478317260742
mini_batch_src_global generation:  0.028979063034057617
r_  generation:  0.48468995094299316
local_output_nid generation:  0.013862848281860352
local_in_edges_tensor generation:  0.012248754501342773
mini_batch_src_global generation:  0.029714584350585938
r_  generation:  0.5225913524627686
local_output_nid generation:  0.013668060302734375
local_in_edges_tensor generation:  0.01196146011352539
mini_batch_src_global generation:  0.0319666862487793
r_  generation:  0.5489954948425293
local_output_nid generation:  0.013715028762817383
local_in_edges_tensor generation:  0.012074947357177734
mini_batch_src_global generation:  0.03664278984069824
r_  generation:  0.5682792663574219
local_output_nid generation:  0.013763904571533203
local_in_edges_tensor generation:  0.012093067169189453
mini_batch_src_global generation:  0.03783822059631348
r_  generation:  0.5792856216430664
local_output_nid generation:  0.013654232025146484
local_in_edges_tensor generation:  0.011960268020629883
mini_batch_src_global generation:  0.03886842727661133
r_  generation:  0.5814106464385986
----------------------check_connections_block total spend ----------------------------- 5.689030170440674
generate_one_block  5.893687725067139
generate_one_block  0.5897903442382812
generate_one_block  0.6449105739593506
generate_one_block  0.5949661731719971
generate_one_block  0.6515607833862305
generate_one_block  0.593095064163208
generate_one_block  0.6028847694396973
generate_one_block  0.6372594833374023
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9777841567993164
gen group dst list time:  0.11639070510864258
time for parepare:  0.43999314308166504
local_output_nid generation:  0.16574501991271973
local_in_edges_tensor generation:  0.6087160110473633
mini_batch_src_global generation:  0.5365595817565918
r_  generation:  7.054092645645142
local_output_nid generation:  0.1782083511352539
local_in_edges_tensor generation:  0.44083261489868164
mini_batch_src_global generation:  0.6743073463439941
r_  generation:  7.329265832901001
local_output_nid generation:  0.17966246604919434
local_in_edges_tensor generation:  0.4439563751220703
mini_batch_src_global generation:  0.6651279926300049
r_  generation:  7.48710036277771
local_output_nid generation:  0.17242097854614258
local_in_edges_tensor generation:  0.4456160068511963
mini_batch_src_global generation:  0.6776022911071777
r_  generation:  7.69375467300415
local_output_nid generation:  0.17737817764282227
local_in_edges_tensor generation:  0.5371448993682861
mini_batch_src_global generation:  0.7106189727783203
r_  generation:  7.640932559967041
local_output_nid generation:  0.1740713119506836
local_in_edges_tensor generation:  0.4461197853088379
mini_batch_src_global generation:  0.7055995464324951
r_  generation:  7.688165664672852
local_output_nid generation:  0.20398235321044922
local_in_edges_tensor generation:  0.5128324031829834
mini_batch_src_global generation:  0.7335636615753174
r_  generation:  7.683390140533447
local_output_nid generation:  0.1760861873626709
local_in_edges_tensor generation:  0.45356082916259766
mini_batch_src_global generation:  0.7440035343170166
r_  generation:  7.820711135864258
----------------------check_connections_block total spend ----------------------------- 81.3403148651123
generate_one_block  10.030420303344727
generate_one_block  9.673316478729248
generate_one_block  10.089434385299683
generate_one_block  9.868329763412476
generate_one_block  9.62457013130188
generate_one_block  9.799089431762695
generate_one_block  9.803455591201782
generate_one_block  9.609160900115967
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.0773017406463623
gen group dst list time:  0.48968982696533203
time for parepare:  0.4602994918823242
local_output_nid generation:  0.5554947853088379
local_in_edges_tensor generation:  1.3221766948699951
mini_batch_src_global generation:  1.1236109733581543
r_  generation:  15.477834463119507
local_output_nid generation:  0.571603536605835
local_in_edges_tensor generation:  1.2703168392181396
mini_batch_src_global generation:  1.4694859981536865
r_  generation:  15.850645780563354
local_output_nid generation:  0.6246166229248047
local_in_edges_tensor generation:  1.2551090717315674
mini_batch_src_global generation:  1.4220142364501953
r_  generation:  16.29164218902588
local_output_nid generation:  0.5866420269012451
local_in_edges_tensor generation:  1.2364416122436523
mini_batch_src_global generation:  1.4998502731323242
r_  generation:  16.065317630767822
local_output_nid generation:  0.5925331115722656
local_in_edges_tensor generation:  1.2390856742858887
mini_batch_src_global generation:  1.548671007156372
r_  generation:  16.237849473953247
local_output_nid generation:  0.6169719696044922
local_in_edges_tensor generation:  1.1787872314453125
mini_batch_src_global generation:  1.7081842422485352
r_  generation:  16.92780089378357
local_output_nid generation:  0.6244111061096191
local_in_edges_tensor generation:  1.2664556503295898
mini_batch_src_global generation:  1.6149802207946777
r_  generation:  16.14677619934082
local_output_nid generation:  0.60272216796875
local_in_edges_tensor generation:  1.1860969066619873
mini_batch_src_global generation:  1.5854904651641846
r_  generation:  16.132750749588013
----------------------check_connections_block total spend ----------------------------- 178.8686878681183
generate_one_block  21.139832735061646
generate_one_block  21.931366682052612
generate_one_block  20.876961946487427
generate_one_block  20.987794637680054
generate_one_block  21.204314947128296
generate_one_block  21.170565843582153
generate_one_block  20.87447428703308
generate_one_block  20.682680368423462
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  260.2090027332306
block generation total time  247.3657684326172
average batch blocks generation time:  30.92072105407715
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3289794921875 GB
    Memory Allocated: 1.2224502563476562  GigaBytes
Max Memory Allocated: 1.2224502563476562  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5340576171875 GB
    Memory Allocated: 2.3438758850097656  GigaBytes
Max Memory Allocated: 2.6436758041381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 1.2291364669799805  GigaBytes
Max Memory Allocated: 3.209599494934082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 2.3498926162719727  GigaBytes
Max Memory Allocated: 3.209599494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 1.2270898818969727  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 2.346867561340332  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 1.224656581878662  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 2.3373351097106934  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 1.226212501525879  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 2.340726852416992  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 1.2258224487304688  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 2.3430519104003906  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 1.223921298980713  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2508544921875 GB
    Memory Allocated: 2.3372764587402344  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 1.2265849113464355  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.3437609672546387  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.33901482820510864 |0.580143004655838 |0.09095904231071472 |0.0001690387725830078 |0.018144071102142334 |0.0036458969116210938 |
----------------------------------------------------------pseudo_mini_loss sum 8.316396713256836
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  35917639
Number of first layer input nodes during this epoch:  17476756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.0680155754089355  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5226562023162842
random selection method range initialization spend 0.015756845474243164
time for parepare:  0.27800750732421875
local_output_nid generation:  0.012222528457641602
local_in_edges_tensor generation:  0.03968477249145508
mini_batch_src_global generation:  0.04787707328796387
r_  generation:  0.40263843536376953
local_output_nid generation:  0.013733863830566406
local_in_edges_tensor generation:  0.03432321548461914
mini_batch_src_global generation:  0.040204524993896484
r_  generation:  0.48184633255004883
local_output_nid generation:  0.014703989028930664
local_in_edges_tensor generation:  0.02814340591430664
mini_batch_src_global generation:  0.02610468864440918
r_  generation:  0.5081770420074463
local_output_nid generation:  0.015026092529296875
local_in_edges_tensor generation:  0.02291727066040039
mini_batch_src_global generation:  0.02968144416809082
r_  generation:  0.511620044708252
local_output_nid generation:  0.014899969100952148
local_in_edges_tensor generation:  0.012190103530883789
mini_batch_src_global generation:  0.03193950653076172
r_  generation:  0.5539364814758301
local_output_nid generation:  0.013634204864501953
local_in_edges_tensor generation:  0.011797904968261719
mini_batch_src_global generation:  0.03629326820373535
r_  generation:  0.5583851337432861
local_output_nid generation:  0.01356363296508789
local_in_edges_tensor generation:  0.012509822845458984
mini_batch_src_global generation:  0.037229061126708984
r_  generation:  0.5748264789581299
local_output_nid generation:  0.013657331466674805
local_in_edges_tensor generation:  0.011612176895141602
mini_batch_src_global generation:  0.03872084617614746
r_  generation:  0.5932838916778564
----------------------check_connections_block total spend ----------------------------- 5.80925989151001
generate_one_block  0.9999880790710449
generate_one_block  0.623354434967041
generate_one_block  0.6555745601654053
generate_one_block  0.7912213802337646
generate_one_block  0.7468559741973877
generate_one_block  0.6113491058349609
generate_one_block  0.5893759727478027
generate_one_block  0.5922098159790039
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.148202896118164
gen group dst list time:  0.12410974502563477
time for parepare:  0.46269917488098145
local_output_nid generation:  0.17582178115844727
local_in_edges_tensor generation:  0.5649614334106445
mini_batch_src_global generation:  0.5606915950775146
r_  generation:  7.45839262008667
local_output_nid generation:  0.2072451114654541
local_in_edges_tensor generation:  0.6080367565155029
mini_batch_src_global generation:  0.7889678478240967
r_  generation:  7.4084508419036865
local_output_nid generation:  0.192183256149292
local_in_edges_tensor generation:  0.7232739925384521
mini_batch_src_global generation:  0.7081713676452637
r_  generation:  8.063118696212769
local_output_nid generation:  0.20448017120361328
local_in_edges_tensor generation:  0.5809459686279297
mini_batch_src_global generation:  0.7763206958770752
r_  generation:  7.639769792556763
local_output_nid generation:  0.1928877830505371
local_in_edges_tensor generation:  0.5753774642944336
mini_batch_src_global generation:  0.7293598651885986
r_  generation:  8.018122673034668
local_output_nid generation:  0.2029552459716797
local_in_edges_tensor generation:  0.45299482345581055
mini_batch_src_global generation:  0.7144026756286621
r_  generation:  7.722361326217651
local_output_nid generation:  0.17718982696533203
local_in_edges_tensor generation:  0.5749881267547607
mini_batch_src_global generation:  0.7494664192199707
r_  generation:  7.915060997009277
local_output_nid generation:  0.20176959037780762
local_in_edges_tensor generation:  0.453139066696167
mini_batch_src_global generation:  0.7166283130645752
r_  generation:  7.677976131439209
----------------------check_connections_block total spend ----------------------------- 84.61459922790527
generate_one_block  10.257292032241821
generate_one_block  10.05957555770874
generate_one_block  9.72336459159851
generate_one_block  10.1029212474823
generate_one_block  9.93513298034668
generate_one_block  10.063317060470581
generate_one_block  9.797386646270752
generate_one_block  10.61065149307251
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2162249088287354
gen group dst list time:  0.5214614868164062
time for parepare:  0.4974966049194336
local_output_nid generation:  0.5994327068328857
local_in_edges_tensor generation:  1.4009082317352295
mini_batch_src_global generation:  1.1315505504608154
r_  generation:  15.706266164779663
local_output_nid generation:  0.6366062164306641
local_in_edges_tensor generation:  1.3598949909210205
mini_batch_src_global generation: Using backend: pytorch
 1.5510094165802002
r_  generation:  15.788384437561035
local_output_nid generation:  0.6241476535797119
local_in_edges_tensor generation:  1.1018626689910889
mini_batch_src_global generation:  1.5421574115753174
r_  generation:  16.003950357437134
local_output_nid generation:  0.6217987537384033
local_in_edges_tensor generation:  1.2229344844818115
mini_batch_src_global generation:  1.5007476806640625
r_  generation:  16.23308753967285
local_output_nid generation:  0.6190037727355957
local_in_edges_tensor generation:  1.2247936725616455
mini_batch_src_global generation:  1.443087100982666
r_  generation:  16.3032648563385
local_output_nid generation:  0.5943641662597656
local_in_edges_tensor generation:  1.2426156997680664
mini_batch_src_global generation:  1.516160249710083
r_  generation:  16.228441953659058
local_output_nid generation:  0.6101107597351074
local_in_edges_tensor generation:  1.2476091384887695
mini_batch_src_global generation:  1.5233662128448486
r_  generation:  16.18015456199646
local_output_nid generation:  0.6114790439605713
local_in_edges_tensor generation:  1.2462563514709473
mini_batch_src_global generation:  1.6038079261779785
r_  generation:  16.158933401107788
----------------------check_connections_block total spend ----------------------------- 178.59004735946655
generate_one_block  21.110365867614746
generate_one_block  21.15608525276184
generate_one_block  21.047110080718994
generate_one_block  21.66131019592285
generate_one_block  21.07114315032959
generate_one_block  20.83775496482849
generate_one_block  21.131835460662842
generate_one_block  21.265979528427124
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.0680155754089355  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

connection checking time:  263.2046465873718
block generation total time  249.83122611045837
average batch blocks generation time:  31.228903263807297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 1.2290053367614746  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.3510818481445312  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 1.229172706604004  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.3492393493652344  GigaBytes
Max Memory Allocated: 3.2165632247924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 1.2253150939941406  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.3377561569213867  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 1.225083827972412  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.341766834259033  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 1.2248587608337402  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.3392820358276367  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 1.2265901565551758  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.3418455123901367  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 1.2275495529174805  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.348147392272949  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 1.2265706062316895  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0672607421875 GB
    Memory Allocated: 2.342097282409668  GigaBytes
Max Memory Allocated: 3.2167348861694336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3295390009880066 |0.4215927720069885 |0.003910750150680542 |0.00014737248420715332 |0.00478634238243103 |0.002936124801635742 |
----------------------------------------------------------pseudo_mini_loss sum 6.043735027313232
Total (block generation + training)time/epoch 554.8123645782471
Training time/epoch 1648422428.0927117
Training time without block to device /epoch 1648422424.7199695
Training time without total dataloading part /epoch 0.07369184494018555
load block tensor time/epoch 2.6363120079040527
block to device time/epoch 3.372742176055908
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  35924313
Number of first layer input nodes during this epoch:  17480176
