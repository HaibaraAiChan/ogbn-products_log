main start at this time 1648503770.6884553
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6676020622253418
random selection method range initialization spend 0.017273902893066406
time for parepare:  0.3780231475830078
local_output_nid generation:  0.025799274444580078
local_in_edges_tensor generation:  0.10252141952514648
mini_batch_src_global generation:  0.11090373992919922
r_  generation:  1.6088521480560303
local_output_nid generation:  0.026499509811401367
local_in_edges_tensor generation:  0.07595968246459961
mini_batch_src_global generation:  0.13696718215942383
r_  generation:  1.7116386890411377
local_output_nid generation:  0.02597212791442871
local_in_edges_tensor generation:  0.06546807289123535
mini_batch_src_global generation:  0.10892081260681152
r_  generation:  1.7708165645599365
local_output_nid generation:  0.026262283325195312
local_in_edges_tensor generation:  0.06900763511657715
mini_batch_src_global generation:  0.12051010131835938
r_  generation:  1.8736183643341064
----------------------check_connections_block total spend ----------------------------- 9.270055294036865
generate_one_block  7.851189613342285
generate_one_block  2.3845224380493164
generate_one_block  2.2814390659332275
generate_one_block  2.1513619422912598
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.322711944580078
gen group dst list time:  0.13452744483947754
time for parepare:  0.45140552520751953
local_output_nid generation:  0.33716821670532227
local_in_edges_tensor generation:  1.5892572402954102
mini_batch_src_global generation:  1.6314630508422852
r_  generation:  20.245970249176025
local_output_nid generation:  0.3632540702819824
local_in_edges_tensor generation:  1.5084795951843262
mini_batch_src_global generation:  2.2788796424865723
r_  generation:  20.179975986480713
local_output_nid generation:  0.3642435073852539
local_in_edges_tensor generation:  1.3981499671936035
mini_batch_src_global generation:  2.2023255825042725
r_  generation:  20.481843948364258
local_output_nid generation:  0.36153364181518555
local_in_edges_tensor generation:  2.2804689407348633
mini_batch_src_global generation:  2.070204734802246
r_  generation:  20.488698482513428
----------------------check_connections_block total spend ----------------------------- 112.83398938179016
generate_one_block  28.39280605316162
generate_one_block  27.860085010528564
generate_one_block  27.880937337875366
generate_one_block  28.00139880180359
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4009010791778564
gen group dst list time:  0.35491943359375
time for parepare:  0.5118627548217773
local_output_nid generation:  0.7229595184326172
local_in_edges_tensor generation:  2.0507001876831055
mini_batch_src_global generation:  1.9948005676269531
r_  generation:  26.36314058303833
local_output_nid generation:  0.7559902667999268
local_in_edges_tensor generation:  1.9851300716400146
mini_batch_src_global generation:  2.9419195652008057
r_  generation:  26.31000852584839
local_output_nid generation:  0.7560708522796631
local_in_edges_tensor generation:  2.1493520736694336
mini_batch_src_global generation:  2.9137485027313232
r_  generation:  26.689656019210815
local_output_nid generation:  0.7440714836120605
local_in_edges_tensor generation:  1.9006919860839844
mini_batch_src_global generation:  2.9035656452178955
r_  generation:  26.57075262069702
----------------------check_connections_block total spend ----------------------------- 148.06214213371277
generate_one_block  35.39617943763733
generate_one_block  35.102330684661865
generate_one_block  35.46218299865723
generate_one_block  36.63800549507141
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  260.89613151550293
block generation total time  254.73392581939697
average batch blocks generation time:  63.68348145484924
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8504638671875 GB
    Memory Allocated: 1.7562265396118164  GigaBytes
Max Memory Allocated: 1.7562265396118164  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7996826171875 GB
    Memory Allocated: 3.6846818923950195  GigaBytes
Max Memory Allocated: 4.326070308685303  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 1.7626118659973145  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 3.6774258613586426  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 1.761803150177002  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 3.676567554473877  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 1.7635369300842285  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 3.678551197052002  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4151507019996643 |1.3131108283996582 |0.1923726201057434 |0.00017565488815307617 |0.031165719032287598 |0.001608133316040039 |
----------------------------------------------------------pseudo_mini_loss sum 8.173223495483398
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21872254
Number of first layer input nodes during this epoch:  9171897
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 3.5941309928894043  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6646785736083984
random selection method range initialization spend 0.014578104019165039
time for parepare:  0.39459991455078125
local_output_nid generation:  0.028298139572143555
local_in_edges_tensor generation:  0.10538315773010254
mini_batch_src_global generation:  0.10559225082397461
r_  generation:  1.6528375148773193
local_output_nid generation:  0.028764963150024414
local_in_edges_tensor generation:  0.14974641799926758
mini_batch_src_global generation:  0.14614415168762207
r_  generation:  1.8094570636749268
local_output_nid generation:  0.046511173248291016
local_in_edges_tensor generation:  0.06820082664489746
mini_batch_src_global generation:  0.11017727851867676
r_  generation:  1.7519943714141846
local_output_nid generation:  0.026020526885986328
local_in_edges_tensor generation:  0.05086565017700195
mini_batch_src_global generation:  0.11847591400146484
r_  generation:  1.8945329189300537
----------------------check_connections_block total spend ----------------------------- 9.552608966827393
generate_one_block  2.6275222301483154
generate_one_block  2.5814106464385986
generate_one_block Using backend: pytorch
 2.159541130065918
generate_one_block  2.192716360092163
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3740854263305664
gen group dst list time:  0.1497347354888916
time for parepare:  0.47711730003356934
local_output_nid generation:  0.366253137588501
local_in_edges_tensor generation:  1.3773386478424072
mini_batch_src_global generation:  1.6344027519226074
r_  generation:  20.18479585647583
local_output_nid generation:  0.3792126178741455
local_in_edges_tensor generation:  1.4799041748046875
mini_batch_src_global generation:  2.329369068145752
r_  generation:  20.62671661376953
local_output_nid generation:  0.371410608291626
local_in_edges_tensor generation:  1.6436984539031982
mini_batch_src_global generation:  2.0900685787200928
r_  generation:  20.762301921844482
local_output_nid generation:  0.37226414680480957
local_in_edges_tensor generation:  1.4324934482574463
mini_batch_src_global generation:  2.234668016433716
r_  generation:  20.99358820915222
----------------------check_connections_block total spend ----------------------------- 113.48024034500122
generate_one_block  28.558623552322388
generate_one_block  29.184341192245483
generate_one_block  28.345638513565063
generate_one_block  28.760462999343872
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.216939926147461
gen group dst list time:  0.3264904022216797
time for parepare:  0.49251222610473633
local_output_nid generation:  0.683213472366333
local_in_edges_tensor generation:  2.0525412559509277
mini_batch_src_global generation:  2.096125364303589
r_  generation:  26.68796682357788
local_output_nid generation:  0.7297115325927734
local_in_edges_tensor generation:  2.119442939758301
mini_batch_src_global generation:  3.1080257892608643
r_  generation:  26.58251142501831
local_output_nid generation:  0.7375514507293701
local_in_edges_tensor generation:  1.9170994758605957
mini_batch_src_global generation:  2.9993977546691895
r_  generation:  26.865144729614258
local_output_nid generation:  0.7415037155151367
local_in_edges_tensor generation:  2.0138847827911377
mini_batch_src_global generation:  2.821251392364502
r_  generation:  27.018306493759155
----------------------check_connections_block total spend ----------------------------- 149.91485691070557
generate_one_block  35.780717849731445
generate_one_block  35.6579966545105
generate_one_block  35.76743960380554
generate_one_block  35.80101203918457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 3.5941309928894043  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

connection checking time:  263.3950972557068
block generation total time  257.85623240470886
average batch blocks generation time:  64.46405810117722
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 1.7651853561401367  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3875732421875 GB
    Memory Allocated: 3.6842164993286133  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3895263671875 GB
    Memory Allocated: 1.7600455284118652  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3895263671875 GB
    Memory Allocated: 3.6734166145324707  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3895263671875 GB
    Memory Allocated: 1.7625961303710938  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3895263671875 GB
    Memory Allocated: 3.6789989471435547  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3895263671875 GB
    Memory Allocated: 1.7674436569213867  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3895263671875 GB
    Memory Allocated: 3.6858596801757812  GigaBytes
Max Memory Allocated: 5.323112964630127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3875589370727539 |1.1858208775520325 |0.008399367332458496 |0.00014907121658325195 |0.07155388593673706 |0.0026230812072753906 |
----------------------------------------------------------pseudo_mini_loss sum 5.914297103881836
Total (block generation + training)time/epoch 578.7173094749451
Training time/epoch 1648504973.3217337
Training time without block to device /epoch 1648504968.5784502
Training time without total dataloading part /epoch 0.3230323791503906
load block tensor time/epoch 1.5502357482910156
block to device time/epoch 4.74328351020813
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21873017
Number of first layer input nodes during this epoch:  9171026
