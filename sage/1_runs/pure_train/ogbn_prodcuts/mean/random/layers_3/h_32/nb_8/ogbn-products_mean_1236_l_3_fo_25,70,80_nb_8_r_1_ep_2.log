main start at this time 1648473812.8437457
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.634498119354248
random selection method range initialization spend 0.01818108558654785
time for parepare:  0.3775777816772461
local_output_nid generation:  0.013817071914672852
local_in_edges_tensor generation:  0.05365324020385742
mini_batch_src_global generation:  0.053888559341430664
r_  generation:  0.8124485015869141
local_output_nid generation:  0.013802051544189453
local_in_edges_tensor generation:  0.03200936317443848
mini_batch_src_global generation:  0.0757608413696289
r_  generation:  0.8752331733703613
local_output_nid generation:  0.013791799545288086
local_in_edges_tensor generation:  0.027227401733398438
mini_batch_src_global generation:  0.05535459518432617
r_  generation:  0.9104619026184082
local_output_nid generation:  0.013951539993286133
local_in_edges_tensor generation:  0.02289414405822754
mini_batch_src_global generation:  0.05875706672668457
r_  generation:  0.9821455478668213
local_output_nid generation:  0.01369929313659668
local_in_edges_tensor generation:  0.018351078033447266
mini_batch_src_global generation:  0.06557106971740723
r_  generation:  1.0277719497680664
local_output_nid generation:  0.013770818710327148
local_in_edges_tensor generation:  0.01940155029296875
mini_batch_src_global generation:  0.07207512855529785
r_  generation:  1.0507473945617676
local_output_nid generation:  0.013686895370483398
local_in_edges_tensor generation:  0.02733612060546875
mini_batch_src_global generation:  0.07427048683166504
r_  generation:  1.0799179077148438
local_output_nid generation:  0.013725519180297852
local_in_edges_tensor generation:  0.02151203155517578
mini_batch_src_global generation:  0.07532310485839844
r_  generation:  1.073981761932373
----------------------check_connections_block total spend ----------------------------- 10.279325723648071
generate_one_block  6.159716606140137
generate_one_block  1.0231013298034668
generate_one_block  1.034106731414795
generate_one_block  1.019186019897461
generate_one_block  1.0350842475891113
generate_one_block  1.070338249206543
generate_one_block  1.0805892944335938
generate_one_block  1.0696439743041992
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.4866209030151367
gen group dst list time:  0.19231510162353516
time for parepare:  0.4554562568664551
local_output_nid generation:  0.2639038562774658
local_in_edges_tensor generation:  1.0966377258300781
mini_batch_src_global generation:  1.3762171268463135
r_  generation:  15.420000076293945
local_output_nid generation:  0.28135180473327637
local_in_edges_tensor generation:  1.1668901443481445
mini_batch_src_global generation:  1.7021856307983398
r_  generation:  15.469167947769165
local_output_nid generation:  0.24975824356079102
local_in_edges_tensor generation:  1.282088041305542
mini_batch_src_global generation:  1.6541180610656738
r_  generation:  15.564313888549805
local_output_nid generation:  0.28266000747680664
local_in_edges_tensor generation:  1.061413049697876
mini_batch_src_global generation:  1.736546277999878
r_  generation:  15.54862380027771
local_output_nid generation:  0.2803161144256592
local_in_edges_tensor generation:  1.1416985988616943
mini_batch_src_global generation:  1.771268367767334
r_  generation:  15.803726196289062
local_output_nid generation:  0.27919960021972656
local_in_edges_tensor generation:  1.1301629543304443
mini_batch_src_global generation:  1.673081874847412
r_  generation:  15.85425090789795
local_output_nid generation:  0.24989032745361328
local_in_edges_tensor generation:  1.1547167301177979
mini_batch_src_global generation:  1.7123732566833496
r_  generation:  15.788546323776245
local_output_nid generation:  0.273052453994751
local_in_edges_tensor generation:  0.9395546913146973
mini_batch_src_global generation:  1.7863883972167969
r_  generation:  15.772813081741333
----------------------check_connections_block total spend ----------------------------- 172.0229344367981
generate_one_block  21.784026384353638
generate_one_block  21.784380435943604
generate_one_block  22.37091302871704
generate_one_block  21.549132823944092
generate_one_block  21.751400232315063
generate_one_block  21.633464097976685
generate_one_block  21.673313856124878
generate_one_block  21.889681339263916
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1930863857269287
gen group dst list time:  0.6217472553253174
time for parepare:  0.4872012138366699
local_output_nid generation:  0.6504077911376953
local_in_edges_tensor generation:  1.5150766372680664
mini_batch_src_global generation:  1.278064250946045
r_  generation:  16.670814752578735
local_output_nid generation:  0.7226994037628174
local_in_edges_tensor generation:  1.464879035949707
mini_batch_src_global generation:  1.7459235191345215
r_  generation:  16.76777458190918
local_output_nid generation:  0.6841866970062256
local_in_edges_tensor generation:  1.5435945987701416
mini_batch_src_global generation:  1.6369030475616455
r_  generation:  17.022585153579712
local_output_nid generation:  0.7028055191040039
local_in_edges_tensor generation:  1.360229253768921
mini_batch_src_global generation:  1.7392818927764893
r_  generation:  16.84607195854187
local_output_nid generation:  0.6785211563110352
local_in_edges_tensor generation:  1.315018892288208
mini_batch_src_global generation:  1.7271151542663574
r_  generation:  17.078274488449097
local_output_nid generation:  0.673560619354248
local_in_edges_tensor generation:  1.3622207641601562
mini_batch_src_global generation:  1.8229079246520996
r_  generation:  16.96181035041809
local_output_nid generation:  0.692650556564331
local_in_edges_tensor generation:  1.3734309673309326
mini_batch_src_global generation:  1.7947511672973633
r_  generation:  17.096803188323975
local_output_nid generation:  0.6859707832336426
local_in_edges_tensor generation:  1.3649859428405762
mini_batch_src_global generation:  1.9987404346466064
r_  generation:  17.576651573181152
----------------------check_connections_block total spend ----------------------------- 192.66106176376343
generate_one_block  22.854538202285767
generate_one_block  23.661700010299683
generate_one_block  22.666433572769165
generate_one_block  22.543859720230103
generate_one_block  22.545183420181274
generate_one_block  22.528407335281372
generate_one_block  22.553603410720825
generate_one_block  22.58665657043457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  364.6839962005615
block generation total time  356.3766944408417
average batch blocks generation time:  44.54708680510521
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5535888671875 GB
    Memory Allocated: 1.4506664276123047  GigaBytes
Max Memory Allocated: 1.4506664276123047  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7254638671875 GB
    Memory Allocated: 2.934727668762207  GigaBytes
Max Memory Allocated: 3.458709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.454261302947998  GigaBytes
Max Memory Allocated: 3.938129425048828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.936006546020508  GigaBytes
Max Memory Allocated: 3.938129425048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.4555482864379883  GigaBytes
Max Memory Allocated: 3.9403204917907715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.937697410583496  GigaBytes
Max Memory Allocated: 3.9403204917907715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.452192783355713  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.9296960830688477  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.4527173042297363  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.930372714996338  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.453150749206543  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.9301090240478516  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.452770709991455  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.9308905601501465  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.455770492553711  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.935483455657959  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.35846057534217834 |0.8732622861862183 |0.09016051888465881 |0.00016948580741882324 |0.014887958765029907 |0.0038352012634277344 |
----------------------------------------------------------pseudo_mini_loss sum 8.26410961151123
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  40321434
Number of first layer input nodes during this epoch:  18016910
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.7071495056152344  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7312519550323486
random selection method range initialization spend 0.025530576705932617
time for parepare:  0.401885986328125
local_output_nid generation:  0.015503883361816406
local_in_edges_tensor generation:  0.05012869834899902
mini_batch_src_global generation:  0.0564572811126709
r_  generation:  0.8212778568267822
local_output_nid generation:  0.024824142456054688
local_in_edges_tensor generation:  0.03216433525085449
mini_batch_src_global generation:  0.07557916641235352
r_  generation:  0.9073915481567383
local_output_nid generation:  0.016469717025756836
local_in_edges_tensor generation:  0.046933889389038086
mini_batch_src_global generation:  0.05115032196044922
r_  generation:  0.9460299015045166
local_output_nid generation:  0.01776576042175293
local_in_edges_tensor generation:  0.05666613578796387
mini_batch_src_global generation:  0.059441566467285156
r_  generation:  1.0264365673065186
local_output_nid generation:  0.019364118576049805
local_in_edges_tensor generation:  0.025363922119140625
mini_batch_src_global generation:  0.06575846672058105
r_  generation:  1.0333843231201172
local_output_nid generation:  0.016762495040893555
local_in_edges_tensor generation:  0.029782533645629883
mini_batch_src_global generation:  0.07158446311950684
r_  generation:  1.0794668197631836
local_output_nid generation:  0.016721248626708984
local_in_edges_tensor generation:  0.03838229179382324
mini_batch_src_global generation:  0.07956814765930176
r_  generation:  1.1193158626556396
local_output_nid generation:  0.016728639602661133
local_in_edges_tensor generation:  0.06393885612487793
mini_batch_src_global generation:  0.0754246711730957
r_  generation:  1.124626874923706
----------------------check_connections_block total spend ----------------------------- 10.831993103027344
generate_one_block  1.4544775485992432
generate_one_block  1.0465340614318848
generate_one_block  1.0112409591674805
generate_one_block  1.037538766860962
generate_one_block  1.0417084693908691
generate_one_block  1.0794062614440918
generate_one_block  1.0428197383880615
generate_one_block  1.0400748252868652
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.4837734699249268
gen group dst list time:  0.18519282341003418
time for parepare:  0.4839622974395752
local_output_nid generation:  0.24313735961914062
local_in_edges_tensor generation:  1.0862109661102295
mini_batch_src_global generation:  1.3357510566711426
r_  generation:  15.461944818496704
local_output_nid generation:  0.29139161109924316
local_in_edges_tensor generation:  1.160806655883789
mini_batch_src_global generation:  1.8210711479187012
r_  generation:  15.396958589553833
local_output_nid generation:  0.28644323348999023
local_in_edges_tensor generation:  1.3887488842010498
mini_batch_src_global generation:  1.685319423675537
r_  generation:  15.488649606704712
local_output_nid generation:  0.278933048248291
local_in_edges_tensor generation:  1.1447579860687256
mini_batch_src_global generation:  1.8501465320587158
r_  generation:  15.76370358467102
local_output_nid generation:  0.2890751361846924
local_in_edges_tensor generation:  1.183459758758545
mini_batch_src_global generation:  1.7241976261138916
r_  generation:  15.726671695709229
local_output_nid generation:  0.27466726303100586
local_in_edges_tensor generation:  1.1429500579833984
mini_batch_src_global generation:  1.924867868423462
r_  generation:  15.886983633041382
local_output_nid generation:  0.28880810737609863
local_in_edges_tensor generation:  1.1822826862335205
mini_batch_src_global generation:  1.7533128261566162
r_  generation:  15.824022769927979
local_output_nid generation:  0.2747015953063965
local_in_edges_tensor generation:  1.1475307941436768
mini_batch_src_global generation:  1.8925724029541016
r_  generation:  15.891061305999756
----------------------check_connections_block total spend ----------------------------- 173.75865268707275
generate_one_block  22.13939332962036
generate_one_block  22.12187433242798
generate_one_block  22.084455728530884
generate_one_block  22.079089164733887
generate_one_block  22.3351092338562
generate_one_block  22.24799919128418
generate_one_block  22.230910778045654
generate_one_block  22.25550389289856
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2431399822235107
gen group dst list time:  0.60666823387146
time for parepare:  0.486713171005249
local_output_nid generation:  0.6437714099884033
local_in_edges_tensor generation:  1.4068999290466309
mini_batch_src_global generation:  1.2630679607391357
r_  generation:  16.50198531150818
local_output_nid generation:  0.7244889736175537
local_in_edges_tensor generation:  1.3989646434783936
mini_batch_src_global generation: Using backend: pytorch
 1.6545917987823486
r_  generation:  16.942603588104248
local_output_nid generation:  0.7254319190979004
local_in_edges_tensor generation:  1.484593391418457
mini_batch_src_global generation:  1.6770985126495361
r_  generation:  17.065661430358887
local_output_nid generation:  0.7117047309875488
local_in_edges_tensor generation:  1.3784801959991455
mini_batch_src_global generation:  1.7188079357147217
r_  generation:  17.10752010345459
local_output_nid generation:  0.7318804264068604
local_in_edges_tensor generation:  1.3599083423614502
mini_batch_src_global generation:  1.8187556266784668
r_  generation:  17.37142848968506
local_output_nid generation:  0.697415828704834
local_in_edges_tensor generation:  1.3899190425872803
mini_batch_src_global generation:  1.8120884895324707
r_  generation:  17.44322109222412
local_output_nid generation:  0.7238659858703613
local_in_edges_tensor generation:  1.3477365970611572
mini_batch_src_global generation:  1.6772656440734863
r_  generation:  17.513540506362915
local_output_nid generation:  0.7160239219665527
local_in_edges_tensor generation:  1.376115083694458
mini_batch_src_global generation:  1.775564193725586
r_  generation:  17.35869026184082
----------------------check_connections_block total spend ----------------------------- 194.1846387386322
generate_one_block  22.824950456619263
generate_one_block  22.848896265029907
generate_one_block  22.877228021621704
generate_one_block  23.462435483932495
generate_one_block  22.69444704055786
generate_one_block  22.732057809829712
generate_one_block  22.781527280807495
generate_one_block  23.316704750061035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.7071495056152344  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

connection checking time:  367.94329142570496
block generation total time  361.0325827598572
average batch blocks generation time:  45.12907284498215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.453749656677246  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.933353900909424  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.45513916015625  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.934999465942383  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.4511685371398926  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.9266629219055176  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.453202247619629  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.9315719604492188  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.4525771141052246  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.9304256439208984  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 1.4549169540405273  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0203857421875 GB
    Memory Allocated: 2.9348225593566895  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.8621826171875 GB
    Memory Allocated: 1.456355094909668  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.8621826171875 GB
    Memory Allocated: 2.938760280609131  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.8621826171875 GB
    Memory Allocated: 1.4552159309387207  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.8621826171875 GB
    Memory Allocated: 2.935379981994629  GigaBytes
Max Memory Allocated: 3.9430928230285645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.361564964056015 |0.8094335794448853 |0.008355826139450073 |0.0001398324966430664 |0.008632302284240723 |0.0018274784088134766 |
----------------------------------------------------------pseudo_mini_loss sum 5.947708606719971
Total (block generation + training)time/epoch 790.771842956543
Training time/epoch 1648475437.666815
Training time without block to device /epoch 1648475431.1913464
Training time without total dataloading part /epoch 0.13885116577148438
load block tensor time/epoch 2.89251971244812
block to device time/epoch 6.475468635559082
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  40323997
Number of first layer input nodes during this epoch:  18015927
