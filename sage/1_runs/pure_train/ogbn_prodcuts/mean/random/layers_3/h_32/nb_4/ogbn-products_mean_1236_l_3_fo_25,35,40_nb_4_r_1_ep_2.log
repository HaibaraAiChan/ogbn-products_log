main start at this time 1648420539.5836277
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4039769172668457
random selection method range initialization spend 0.01723456382751465
time for parepare:  0.28350234031677246
local_output_nid generation:  0.024026870727539062
local_in_edges_tensor generation:  0.05558609962463379
mini_batch_src_global generation:  0.05755114555358887
r_  generation:  0.9105300903320312
local_output_nid generation:  0.026108741760253906
local_in_edges_tensor generation:  0.03879809379577637
mini_batch_src_global generation:  0.0744941234588623
r_  generation:  0.986614465713501
local_output_nid generation:  0.025833606719970703
local_in_edges_tensor generation:  0.03357243537902832
mini_batch_src_global generation:  0.0578155517578125
r_  generation:  1.0288922786712646
local_output_nid generation:  0.025771141052246094
local_in_edges_tensor generation:  0.061078786849975586
mini_batch_src_global generation:  0.06739497184753418
r_  generation:  1.121671438217163
----------------------check_connections_block total spend ----------------------------- 5.535157918930054
generate_one_block  6.617695093154907
generate_one_block  1.1311976909637451
generate_one_block  1.129544973373413
generate_one_block  1.1391196250915527
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.014951467514038
gen group dst list time:  0.09873414039611816
time for parepare:  0.44861865043640137
local_output_nid generation:  0.24920988082885742
local_in_edges_tensor generation:  0.7653236389160156
mini_batch_src_global generation:  0.7821934223175049
r_  generation:  10.39207935333252
local_output_nid generation:  0.24504375457763672
local_in_edges_tensor generation:  0.7884957790374756
mini_batch_src_global generation:  0.9806053638458252
r_  generation:  10.683081150054932
local_output_nid generation:  0.2559199333190918
local_in_edges_tensor generation:  0.7842800617218018
mini_batch_src_global generation:  0.9756121635437012
r_  generation:  10.903193235397339
local_output_nid generation:  0.27127861976623535
local_in_edges_tensor generation:  1.1933190822601318
mini_batch_src_global generation:  1.007591962814331
r_  generation:  11.078031778335571
----------------------check_connections_block total spend ----------------------------- 59.0569167137146
generate_one_block  14.816126823425293
generate_one_block  14.132978677749634
generate_one_block  14.512406826019287
generate_one_block  14.203146696090698
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.249346971511841
gen group dst list time:  0.27570652961730957
time for parepare:  0.46523308753967285
local_output_nid generation:  0.6180899143218994
local_in_edges_tensor generation:  1.4144713878631592
mini_batch_src_global generation:  1.2747833728790283
r_  generation:  17.82097363471985
local_output_nid generation:  0.6692347526550293
local_in_edges_tensor generation:  1.4641830921173096
mini_batch_src_global generation:  1.5624327659606934
r_  generation:  17.759696006774902
local_output_nid generation:  0.6579840183258057
local_in_edges_tensor generation:  1.2842700481414795
mini_batch_src_global generation:  1.5208327770233154
r_  generation:  17.512049913406372
local_output_nid generation:  0.628563404083252
local_in_edges_tensor generation:  1.2430617809295654
mini_batch_src_global generation:  1.6227927207946777
r_  generation:  17.711036682128906
----------------------check_connections_block total spend ----------------------------- 97.60378932952881
generate_one_block  22.53906536102295
generate_one_block  22.458919286727905
generate_one_block  22.602524518966675
generate_one_block  23.36794877052307
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  156.6607060432434
block generation total time  148.6331169605255
average batch blocks generation time:  37.15827924013138
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4168701171875 GB
    Memory Allocated: 1.3174076080322266  GigaBytes
Max Memory Allocated: 1.3174076080322266  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1258544921875 GB
    Memory Allocated: 2.68287992477417  GigaBytes
Max Memory Allocated: 2.8919215202331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2059326171875 GB
    Memory Allocated: 1.3252005577087402  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2059326171875 GB
    Memory Allocated: 2.6783671379089355  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0360107421875 GB
    Memory Allocated: 1.3253278732299805  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0360107421875 GB
    Memory Allocated: 2.6770730018615723  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0360107421875 GB
    Memory Allocated: 1.3250126838684082  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0360107421875 GB
    Memory Allocated: 2.676003932952881  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.35763537883758545 |0.7394368648529053 |0.18010807037353516 |0.00016689300537109375 |0.02118140459060669 |0.0035669803619384766 |
----------------------------------------------------------pseudo_mini_loss sum 8.300239562988281
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19822780
Number of first layer input nodes during this epoch:  8894438
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.0360107421875 GB
    Memory Allocated: 2.3290982246398926  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3911609649658203
random selection method range initialization spend 0.013786554336547852
time for parepare:  0.2817502021789551
local_output_nid generation:  0.024006128311157227
local_in_edges_tensor generation:  0.044235944747924805
mini_batch_src_global generation:  0.07341480255126953
r_  generation:  0.9927771091461182
local_output_nid generation:  0.026105403900146484
local_in_edges_tensor generation:  0.04354691505432129
mini_batch_src_global generation:  0.08190417289733887
r_  generation:  1.1298058032989502
local_output_nid generation:  0.026865720748901367
local_in_edges_tensor generation:  0.07250046730041504
mini_batch_src_global generation:  0.06664919853210449
r_  generation:  1.0602445602416992
local_output_nid generation:  0.02976679801940918
local_in_edges_tensor generation:  0.032408714294433594
mini_batch_src_global generation:  0.06519341468811035
r_  generation:  1.121002197265625
----------------------check_connections_block total spend ----------------------------- 5.916107177734375
generate_one_block  1.599088191986084
generate_one_block  1.1700809001922607
generate_one_block  1.544848918914795Using backend: pytorch

generate_one_block  1.1357765197753906
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1280276775360107
gen group dst list time:  0.11615705490112305
time for parepare:  0.46752429008483887
local_output_nid generation:  0.2662041187286377
local_in_edges_tensor generation:  0.8332970142364502
mini_batch_src_global generation:  0.7984838485717773
r_  generation:  10.931419372558594
local_output_nid generation:  0.2812459468841553
local_in_edges_tensor generation:  0.8338649272918701
mini_batch_src_global generation:  1.0362763404846191
r_  generation:  11.105490684509277
local_output_nid generation:  0.279278039932251
local_in_edges_tensor generation:  0.7647757530212402
mini_batch_src_global generation:  0.9731147289276123
r_  generation:  11.014435291290283
local_output_nid generation:  0.2638719081878662
local_in_edges_tensor generation:  0.7688968181610107
mini_batch_src_global generation:  1.0434598922729492
r_  generation:  11.156039953231812
----------------------check_connections_block total spend ----------------------------- 60.2134211063385
generate_one_block  14.76509714126587
generate_one_block  14.978748559951782
generate_one_block  14.309296607971191
generate_one_block  14.507270097732544
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.201003313064575
gen group dst list time:  0.2853882312774658
time for parepare:  0.48732638359069824
local_output_nid generation:  0.617933988571167
local_in_edges_tensor generation:  1.508007287979126
mini_batch_src_global generation:  1.1972014904022217
r_  generation:  17.185099363327026
local_output_nid generation:  0.6553585529327393
local_in_edges_tensor generation:  1.40879487991333
mini_batch_src_global generation:  1.7413685321807861
r_  generation:  17.313480377197266
local_output_nid generation:  0.6386151313781738
local_in_edges_tensor generation:  1.539503812789917
mini_batch_src_global generation:  1.587895154953003
r_  generation:  17.509681463241577
local_output_nid generation:  0.6399610042572021
local_in_edges_tensor generation:  1.290497064590454
mini_batch_src_global generation:  1.6933925151824951
r_  generation:  17.679939031600952
----------------------check_connections_block total spend ----------------------------- 97.12867021560669
generate_one_block  22.690097332000732
generate_one_block  22.499428272247314
generate_one_block  22.499785900115967
generate_one_block  22.641009092330933
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.0360107421875 GB
    Memory Allocated: 2.3290982246398926  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

connection checking time:  157.3420913219452
block generation total time  148.89073300361633
average batch blocks generation time:  37.22268325090408
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0360107421875 GB
    Memory Allocated: 1.3258967399597168  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0360107421875 GB
    Memory Allocated: 2.6829466819763184  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0379638671875 GB
    Memory Allocated: 1.3246283531188965  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0379638671875 GB
    Memory Allocated: 2.674473285675049  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0379638671875 GB
    Memory Allocated: 1.3246941566467285  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0379638671875 GB
    Memory Allocated: 2.6755409240722656  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0379638671875 GB
    Memory Allocated: 1.3263354301452637  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0379638671875 GB
    Memory Allocated: 2.681100368499756  GigaBytes
Max Memory Allocated: 3.53798770904541  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3599780797958374 |0.49030280113220215 |0.00573885440826416 |0.0001506805419921875 |0.0044640302658081055 |0.0011544227600097656 |
----------------------------------------------------------pseudo_mini_loss sum 6.030265808105469
Total (block generation + training)time/epoch 341.00962948799133
Training time/epoch 1648421270.130731
Training time without block to device /epoch 1648421268.16952
Training time without total dataloading part /epoch 0.04256868362426758
load block tensor time/epoch 1.4399123191833496
block to device time/epoch 1.9612112045288086
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19819192
Number of first layer input nodes during this epoch:  8892775
