main start at this time 1648472817.3175251
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6726114749908447
random selection method range initialization spend 0.014417409896850586
time for parepare:  0.37439560890197754
local_output_nid generation:  0.025180816650390625
local_in_edges_tensor generation:  0.08685159683227539
mini_batch_src_global generation:  0.10661864280700684
r_  generation:  1.58319091796875
local_output_nid generation:  0.025829792022705078
local_in_edges_tensor generation:  0.07616376876831055
mini_batch_src_global generation:  0.1404569149017334
r_  generation:  1.6777551174163818
local_output_nid generation:  0.025587081909179688
local_in_edges_tensor generation:  0.05473923683166504
mini_batch_src_global generation:  0.11578249931335449
r_  generation:  1.7268543243408203
local_output_nid generation:  0.026005983352661133
local_in_edges_tensor generation:  0.06462359428405762
mini_batch_src_global generation:  0.11747050285339355
r_  generation:  1.8191883563995361
----------------------check_connections_block total spend ----------------------------- 9.05751919746399
generate_one_block  7.298787593841553
generate_one_block  2.229011058807373
generate_one_block  2.1946849822998047
generate_one_block  2.172210931777954
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5166585445404053
gen group dst list time:  0.1216433048248291
time for parepare:  0.429398775100708
local_output_nid generation:  0.32805442810058594
local_in_edges_tensor generation:  1.3777186870574951
mini_batch_src_global generation:  1.6481823921203613
r_  generation:  19.75806760787964
local_output_nid generation:  0.35338592529296875
local_in_edges_tensor generation:  1.2540168762207031
mini_batch_src_global generation:  2.1392228603363037
r_  generation:  20.201666831970215
local_output_nid generation:  0.37402772903442383
local_in_edges_tensor generation:  1.7863736152648926
mini_batch_src_global generation:  2.3242526054382324
r_  generation:  20.55291748046875
local_output_nid generation:  0.37293577194213867
local_in_edges_tensor generation:  2.204244613647461
mini_batch_src_global generation:  2.115530014038086
r_  generation:  20.611307621002197
----------------------check_connections_block total spend ----------------------------- 112.32753396034241
generate_one_block  28.847975730895996
generate_one_block  28.364503383636475
generate_one_block  28.303203105926514
generate_one_block  28.472203731536865
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1963469982147217
gen group dst list time:  0.32958364486694336
time for parepare:  0.4719524383544922
local_output_nid generation:  0.6603000164031982
local_in_edges_tensor generation:  1.4262933731079102
mini_batch_src_global generation:  1.2365684509277344
r_  generation:  17.235257625579834
local_output_nid generation:  0.664703369140625
local_in_edges_tensor generation:  1.5586466789245605
mini_batch_src_global generation:  1.672008752822876
r_  generation:  17.627974271774292
local_output_nid generation:  0.7143595218658447
local_in_edges_tensor generation:  1.349458932876587
mini_batch_src_global generation:  1.6228363513946533
r_  generation:  17.88823103904724
local_output_nid generation:  0.7143683433532715
local_in_edges_tensor generation:  1.4081151485443115
mini_batch_src_global generation:  1.7477116584777832
r_  generation:  18.074206829071045
----------------------check_connections_block total spend ----------------------------- 99.16905760765076
generate_one_block  23.455208778381348
generate_one_block  23.35963535308838
generate_one_block  23.419395685195923
generate_one_block  24.143659591674805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  211.49659156799316
block generation total time  208.3657853603363
average batch blocks generation time:  52.091446340084076
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6590576171875 GB
    Memory Allocated: 1.5686607360839844  GigaBytes
Max Memory Allocated: 1.5686607360839844  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4266357421875 GB
    Memory Allocated: 3.3163628578186035  GigaBytes
Max Memory Allocated: 3.959719181060791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.7137451171875 GB
    Memory Allocated: 1.575533390045166  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.7137451171875 GB
    Memory Allocated: 3.310478687286377  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5633544921875 GB
    Memory Allocated: 1.5741443634033203  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5633544921875 GB
    Memory Allocated: 3.3078055381774902  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5633544921875 GB
    Memory Allocated: 1.5750188827514648  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5633544921875 GB
    Memory Allocated: 3.3090109825134277  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.32315683364868164 |0.9995842576026917 |0.1930137276649475 |0.00017970800399780273 |0.02314966917037964 |0.003548860549926758 |
----------------------------------------------------------pseudo_mini_loss sum 8.239788055419922
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21808714
Number of first layer input nodes during this epoch:  9105938
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.5633544921875 GB
    Memory Allocated: 3.0425896644592285  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6849155426025391
random selection method range initialization spend 0.014923572540283203
time for parepare:  0.38905978202819824
local_output_nid generation:  0.03120136260986328
local_in_edges_tensor generation:  0.10307717323303223
mini_batch_src_global generation:  0.10888457298278809
r_  generation:  1.6892242431640625
local_output_nid generation:  0.03280353546142578
local_in_edges_tensor generation:  0.11692333221435547
mini_batch_src_global generation:  0.1473093032836914
r_  generation:  1.828967809677124
local_output_nid generation:  0.038156986236572266
local_in_edges_tensor generation:  0.11309480667114258
mini_batch_src_global generation:  0.1124429702758789
r_  generation:  1.7579052448272705
local_output_nid generation:  0.027136564254760742
local_in_edges_tensor generation:  0.05098986625671387
mini_batch_src_global generation:  0.12225866317749023
r_  generation:  1.9520399570465088
----------------------check_connections_block total spend ----------------------------- 9.773545980453491
generate_one_block  2.5824055671691895
generate_one_block  2.1859869956970215
generate_one_block Using backend: pytorch
 2.209095001220703
generate_one_block  2.2038004398345947
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3381736278533936
gen group dst list time:  0.1225125789642334
time for parepare:  0.4306366443634033
local_output_nid generation:  0.336683988571167
local_in_edges_tensor generation:  1.404801607131958
mini_batch_src_global generation:  1.6787307262420654
r_  generation:  20.677306652069092
local_output_nid generation:  0.3778254985809326
local_in_edges_tensor generation:  1.5492756366729736
mini_batch_src_global generation:  2.2336301803588867
r_  generation:  20.497891426086426
local_output_nid generation:  0.3728508949279785
local_in_edges_tensor generation:  1.662959337234497
mini_batch_src_global generation:  2.304719924926758
r_  generation:  20.83742046356201
local_output_nid generation:  0.3731672763824463
local_in_edges_tensor generation:  1.4459037780761719
mini_batch_src_global generation:  2.2761037349700928
r_  generation:  20.845791339874268
----------------------check_connections_block total spend ----------------------------- 114.10068345069885
generate_one_block  28.633524656295776
generate_one_block  29.18333125114441
generate_one_block  28.42972445487976
generate_one_block  28.792473793029785
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1017518043518066
gen group dst list time:  0.32334232330322266
time for parepare:  0.49317479133605957
local_output_nid generation:  0.6865739822387695
local_in_edges_tensor generation:  1.5304985046386719
mini_batch_src_global generation:  1.2978432178497314
r_  generation:  17.61101484298706
local_output_nid generation:  0.7462236881256104
local_in_edges_tensor generation:  1.4630577564239502
mini_batch_src_global generation:  1.8821587562561035
r_  generation:  17.633974075317383
local_output_nid generation:  0.7526407241821289
local_in_edges_tensor generation:  1.40031099319458
mini_batch_src_global generation:  1.648710012435913
r_  generation:  17.93223547935486
local_output_nid generation:  0.7448244094848633
local_in_edges_tensor generation:  1.3842968940734863
mini_batch_src_global generation:  1.6861233711242676
r_  generation:  18.205090284347534
----------------------check_connections_block total spend ----------------------------- 100.15636444091797
generate_one_block  23.507352590560913
generate_one_block  23.53033208847046
generate_one_block  23.304789066314697
generate_one_block  23.33216619491577
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.5633544921875 GB
    Memory Allocated: 3.0425896644592285  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

connection checking time:  214.25704789161682
block generation total time  208.71369409561157
average batch blocks generation time:  52.17842352390289
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5633544921875 GB
    Memory Allocated: 1.5754704475402832  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5633544921875 GB
    Memory Allocated: 3.312155246734619  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5653076171875 GB
    Memory Allocated: 1.5727219581604004  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5653076171875 GB
    Memory Allocated: 3.304084300994873  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5653076171875 GB
    Memory Allocated: 1.5752177238464355  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5653076171875 GB
    Memory Allocated: 3.3098530769348145  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5653076171875 GB
    Memory Allocated: 1.579634189605713  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5653076171875 GB
    Memory Allocated: 3.3184256553649902  GigaBytes
Max Memory Allocated: 4.5491461753845215  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3051564693450928 |0.8355739116668701 |0.004021167755126953 |0.00015032291412353516 |0.005322575569152832 |0.001825094223022461 |
----------------------------------------------------------pseudo_mini_loss sum 5.961948394775391
Total (block generation + training)time/epoch 474.0348331928253
Training time/epoch 1648473809.1681807
Training time without block to device /epoch 1648473805.825885
Training time without total dataloading part /epoch 0.03980135917663574
load block tensor time/epoch 1.220625877380371
block to device time/epoch 3.3422956466674805
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21805790
Number of first layer input nodes during this epoch:  9103570
