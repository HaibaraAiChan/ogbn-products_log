main start at this time 1648475441.7955358
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6276552677154541
random selection method range initialization spend 0.01714920997619629
time for parepare:  0.3713557720184326
local_output_nid generation:  0.007086992263793945
local_in_edges_tensor generation:  0.039755821228027344
mini_batch_src_global generation:  0.026828765869140625
r_  generation:  0.36017441749572754
local_output_nid generation:  0.007151365280151367
local_in_edges_tensor generation:  0.01650834083557129
mini_batch_src_global generation:  0.03338503837585449
r_  generation:  0.40193843841552734
local_output_nid generation:  0.007140159606933594
local_in_edges_tensor generation:  0.009694576263427734
mini_batch_src_global generation:  0.023077964782714844
r_  generation:  0.4143650531768799
local_output_nid generation:  0.007124185562133789
local_in_edges_tensor generation:  0.009425163269042969
mini_batch_src_global generation:  0.02561044692993164
r_  generation:  0.44960594177246094
local_output_nid generation:  0.007109403610229492
local_in_edges_tensor generation:  0.009444236755371094
mini_batch_src_global generation:  0.027948856353759766
r_  generation:  0.4748678207397461
local_output_nid generation:  0.007134437561035156
local_in_edges_tensor generation:  0.009430408477783203
mini_batch_src_global generation:  0.030887603759765625
r_  generation:  0.4931340217590332
local_output_nid generation:  0.007119655609130859
local_in_edges_tensor generation:  0.009604215621948242
mini_batch_src_global generation:  0.032065629959106445
r_  generation:  0.4973325729370117
local_output_nid generation:  0.007106304168701172
local_in_edges_tensor generation:  0.009479284286499023
mini_batch_src_global generation:  0.032907724380493164
r_  generation:  0.5010135173797607
local_output_nid generation:  0.0071430206298828125
local_in_edges_tensor generation:  0.009341239929199219
mini_batch_src_global generation:  0.034494638442993164
r_  generation:  0.5145807266235352
local_output_nid generation:  0.007114887237548828
local_in_edges_tensor generation:  0.009374141693115234
mini_batch_src_global generation:  0.03559470176696777
r_  generation:  0.5179862976074219
local_output_nid generation:  0.007143497467041016
local_in_edges_tensor generation:  0.00937795639038086
mini_batch_src_global generation:  0.037786006927490234
r_  generation:  0.511462926864624
local_output_nid generation:  0.00709080696105957
local_in_edges_tensor generation:  0.009386301040649414
mini_batch_src_global generation:  0.038704633712768555
r_  generation:  0.5172548294067383
local_output_nid generation:  0.007119417190551758
local_in_edges_tensor generation:  0.009480714797973633
mini_batch_src_global generation:  0.04011416435241699
r_  generation:  0.5364072322845459
local_output_nid generation:  0.007109642028808594
local_in_edges_tensor generation:  0.009768009185791016
mini_batch_src_global generation:  0.04096198081970215
r_  generation:  0.5256049633026123
local_output_nid generation:  0.007113933563232422
local_in_edges_tensor generation:  0.009718656539916992
mini_batch_src_global generation:  0.04179525375366211
r_  generation:  0.5339851379394531
local_output_nid generation:  0.007088661193847656
local_in_edges_tensor generation:  0.009357929229736328
mini_batch_src_global generation:  0.04221630096435547
r_  generation:  0.533541202545166
----------------------check_connections_block total spend ----------------------------- 10.333426237106323
generate_one_block  5.642159700393677
generate_one_block  0.49802064895629883
generate_one_block  0.5108304023742676
generate_one_block  0.5045807361602783
generate_one_block  0.5085601806640625
generate_one_block  0.5312666893005371
generate_one_block  0.5065314769744873
generate_one_block  0.5477015972137451
generate_one_block  0.5048816204071045
generate_one_block  0.5071108341217041
generate_one_block  0.5591237545013428
generate_one_block  0.5109357833862305
generate_one_block  0.5551619529724121
generate_one_block  0.5106022357940674
generate_one_block  0.5113050937652588
generate_one_block  0.5050787925720215
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.510908603668213
gen group dst list time:  0.22757291793823242
time for parepare:  0.4811868667602539
local_output_nid generation:  0.17457056045532227
local_in_edges_tensor generation:  0.8187134265899658
mini_batch_src_global generation:  0.8962197303771973
r_  generation:  10.659032821655273
local_output_nid generation:  0.20557785034179688
local_in_edges_tensor generation:  0.8731560707092285
mini_batch_src_global generation:  1.2352871894836426
r_  generation:  10.45025634765625
local_output_nid generation:  0.19355416297912598
local_in_edges_tensor generation:  0.6734380722045898
mini_batch_src_global generation:  1.146773338317871
r_  generation:  10.509336709976196
local_output_nid generation:  0.20548033714294434
local_in_edges_tensor generation:  1.024836778640747
mini_batch_src_global generation:  1.1142427921295166
r_  generation:  10.820241689682007
local_output_nid generation:  0.1727309226989746
local_in_edges_tensor generation:  0.7443137168884277
mini_batch_src_global generation:  1.1431913375854492
r_  generation:  10.750683069229126
local_output_nid generation:  0.20452165603637695
local_in_edges_tensor generation:  0.793400764465332
mini_batch_src_global generation:  1.1779227256774902
r_  generation:  10.92907190322876
local_output_nid generation:  0.16664552688598633
local_in_edges_tensor generation:  0.8061766624450684
mini_batch_src_global generation:  1.1397058963775635
r_  generation:  10.663800477981567
local_output_nid generation:  0.19878268241882324
local_in_edges_tensor generation:  0.717670202255249
mini_batch_src_global generation:  1.1842024326324463
r_  generation:  10.827891111373901
local_output_nid generation:  0.16687917709350586
local_in_edges_tensor generation:  0.8464770317077637
mini_batch_src_global generation:  1.154735803604126
r_  generation:  10.707467317581177
local_output_nid generation:  0.19244170188903809
local_in_edges_tensor generation:  0.6692883968353271
mini_batch_src_global generation:  1.2140114307403564
r_  generation:  10.902403593063354
local_output_nid generation:  0.19861578941345215
local_in_edges_tensor generation:  0.8501830101013184
mini_batch_src_global generation:  1.1449246406555176
r_  generation:  10.823375225067139
local_output_nid generation:  0.16834259033203125
local_in_edges_tensor generation:  0.6719963550567627
mini_batch_src_global generation:  1.1879725456237793
r_  generation:  10.728749513626099
local_output_nid generation:  0.20015954971313477
local_in_edges_tensor generation:  0.8416671752929688
mini_batch_src_global generation:  1.1493511199951172
r_  generation:  10.922792911529541
local_output_nid generation:  0.17331790924072266
local_in_edges_tensor generation:  0.677483320236206
mini_batch_src_global generation:  1.1766767501831055
r_  generation:  10.703027486801147
local_output_nid generation:  0.19837164878845215
local_in_edges_tensor generation:  0.8494811058044434
mini_batch_src_global generation:  1.144286870956421
r_  generation:  10.891107082366943
local_output_nid generation:  0.17028427124023438
local_in_edges_tensor generation:  0.7669718265533447
mini_batch_src_global generation:  1.184220552444458
r_  generation:  10.794881820678711
----------------------check_connections_block total spend ----------------------------- 235.36118507385254
generate_one_block  15.869099855422974
generate_one_block  15.057470560073853
generate_one_block  14.680114507675171
generate_one_block  15.26264500617981
generate_one_block  14.795292615890503
generate_one_block  15.132204055786133
generate_one_block  15.063546419143677
generate_one_block  14.619126796722412
generate_one_block  15.359022855758667
generate_one_block  14.948470830917358
generate_one_block  14.823196172714233
generate_one_block  15.14075517654419
generate_one_block  14.754862070083618
generate_one_block  15.10690426826477
generate_one_block  15.157712697982788
generate_one_block  14.897667407989502
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1669564247131348
gen group dst list time:  1.087890863418579
time for parepare:  0.4758944511413574
local_output_nid generation:  0.6511819362640381
local_in_edges_tensor generation:  1.4241349697113037
mini_batch_src_global generation:  1.1601500511169434
r_  generation:  15.471662282943726
local_output_nid generation:  0.6634805202484131
local_in_edges_tensor generation:  1.391141414642334
mini_batch_src_global generation:  1.596156120300293
r_  generation:  15.504799604415894
local_output_nid generation:  0.6628167629241943
local_in_edges_tensor generation:  1.2793164253234863
mini_batch_src_global generation:  1.6001760959625244
r_  generation:  15.87680459022522
local_output_nid generation:  0.6758749485015869
local_in_edges_tensor generation:  1.2837104797363281
mini_batch_src_global generation:  1.54988431930542
r_  generation:  15.843509197235107
local_output_nid generation:  0.6630864143371582
local_in_edges_tensor generation:  1.2880604267120361
mini_batch_src_global generation:  1.6739003658294678
r_  generation:  16.188761472702026
local_output_nid generation:  0.6592071056365967
local_in_edges_tensor generation:  2.5048909187316895
mini_batch_src_global generation:  1.4931836128234863
r_  generation:  16.03736162185669
local_output_nid generation:  0.6588401794433594
local_in_edges_tensor generation:  1.277554988861084
mini_batch_src_global generation:  1.5217077732086182
r_  generation:  16.264225482940674
local_output_nid generation:  0.654212474822998
local_in_edges_tensor generation:  1.288090705871582
mini_batch_src_global generation:  1.5517830848693848
r_  generation:  16.10880470275879
local_output_nid generation:  0.6044771671295166
local_in_edges_tensor generation:  1.283843994140625
mini_batch_src_global generation:  1.5607421398162842
r_  generation:  16.06680989265442
local_output_nid generation:  0.6410129070281982
local_in_edges_tensor generation:  1.1711626052856445
mini_batch_src_global generation:  1.7294600009918213
r_  generation:  16.03224468231201
local_output_nid generation:  0.6703441143035889
local_in_edges_tensor generation:  1.3000199794769287
mini_batch_src_global generation:  1.6559429168701172
r_  generation:  16.144428730010986
local_output_nid generation:  0.6713037490844727
local_in_edges_tensor generation:  1.3018946647644043
mini_batch_src_global generation:  1.6573421955108643
r_  generation:  15.795719385147095
local_output_nid generation:  0.6537277698516846
local_in_edges_tensor generation:  1.2879445552825928
mini_batch_src_global generation:  1.6867172718048096
r_  generation:  16.20614981651306
local_output_nid generation:  0.6746833324432373
local_in_edges_tensor generation:  1.295752763748169
mini_batch_src_global generation:  1.5746619701385498
r_  generation:  15.99456524848938
local_output_nid generation:  0.6694238185882568
local_in_edges_tensor generation:  1.3042271137237549
mini_batch_src_global generation:  1.6149778366088867
r_  generation:  16.25848078727722
local_output_nid generation:  0.6719865798950195
local_in_edges_tensor generation:  1.2894625663757324
mini_batch_src_global generation:  1.609323501586914
r_  generation:  16.25110960006714
----------------------check_connections_block total spend ----------------------------- 361.67469930648804
generate_one_block  21.39937424659729
generate_one_block  21.342031717300415
generate_one_block  21.396098852157593
generate_one_block  21.65790629386902
generate_one_block  21.804971933364868
generate_one_block  21.554666996002197
generate_one_block  22.33204483985901
generate_one_block  21.548073530197144
generate_one_block  21.487996339797974
generate_one_block  21.508464336395264
generate_one_block  21.470422744750977
generate_one_block  21.472140550613403
generate_one_block  21.450923442840576
generate_one_block  21.389220237731934
generate_one_block  21.502847909927368
generate_one_block  21.81285071372986
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  597.0358843803406
block generation total time  585.7981259822845
average batch blocks generation time:  36.612382873892784
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4305419921875 GB
    Memory Allocated: 1.3287382125854492  GigaBytes
Max Memory Allocated: 1.3287382125854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0340576171875 GB
    Memory Allocated: 2.557372570037842  GigaBytes
Max Memory Allocated: 2.934451103210449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4754638671875 GB
    Memory Allocated: 1.3278779983520508  GigaBytes
Max Memory Allocated: 3.5429306030273438  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4754638671875 GB
    Memory Allocated: 2.5503926277160645  GigaBytes
Max Memory Allocated: 3.5429306030273438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4754638671875 GB
    Memory Allocated: 1.3283309936523438  GigaBytes
Max Memory Allocated: 3.5429306030273438  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4754638671875 GB
    Memory Allocated: 2.5520057678222656  GigaBytes
Max Memory Allocated: 3.5429306030273438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3035888671875 GB
    Memory Allocated: 1.3295893669128418  GigaBytes
Max Memory Allocated: 3.5429306030273438  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3055419921875 GB
    Memory Allocated: 2.5569839477539062  GigaBytes
Max Memory Allocated: 3.5429306030273438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3294010162353516  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.555497169494629  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3284602165222168  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5526537895202637  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.327275276184082  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.548245429992676  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3268847465515137  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5497984886169434  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3262319564819336  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5476737022399902  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.328845500946045  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5530452728271484  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3275370597839355  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.551028251647949  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3274965286254883  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.548980712890625  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.327578067779541  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5494894981384277  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3265337944030762  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5479021072387695  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.328859806060791  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5518269538879395  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3283777236938477  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5511207580566406  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36196814477443695 |0.594610333442688 |0.04309365153312683 |0.00015211105346679688 |0.013040587306022644 |0.003893613815307617 |
----------------------------------------------------------pseudo_mini_loss sum 8.235103607177734
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  73598212
Number of first layer input nodes during this epoch:  35464626
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.354320526123047  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7490479946136475
random selection method range initialization spend 0.01564502716064453
time for parepare:  0.36931943893432617
local_output_nid generation:  0.006872653961181641
local_in_edges_tensor generation:  0.03631711006164551
mini_batch_src_global generation:  0.028841257095336914
r_  generation:  0.3548140525817871
local_output_nid generation:  0.007092952728271484
local_in_edges_tensor generation:  0.011525630950927734
mini_batch_src_global generation:  0.034041643142700195
r_  generation:  0.40807533264160156
local_output_nid generation:  0.0070416927337646484
local_in_edges_tensor generation:  0.0090789794921875
mini_batch_src_global generation:  0.023503780364990234
r_  generation:  0.42972898483276367
local_output_nid generation:  0.007146120071411133
local_in_edges_tensor generation:  0.009063482284545898
mini_batch_src_global generation:  0.025961637496948242
r_  generation:  0.4589409828186035
local_output_nid generation:  0.007060050964355469
local_in_edges_tensor generation:  0.00902557373046875
mini_batch_src_global generation:  0.028289794921875
r_  generation:  0.47170209884643555
local_output_nid generation:  0.007124662399291992
local_in_edges_tensor generation:  0.00901484489440918
mini_batch_src_global generation:  0.0330653190612793
r_  generation:  0.5048842430114746
local_output_nid generation:  0.007089138031005859
local_in_edges_tensor generation:  0.009097814559936523
mini_batch_src_global generation:  0.031949520111083984
r_  generation:  0.5079638957977295
local_output_nid generation:  0.007088422775268555
local_in_edges_tensor generation:  0.009276151657104492
mini_batch_src_global generation:  0.03323650360107422
r_  generation:  0.5181276798248291
local_output_nid generation:  0.007074594497680664
local_in_edges_tensor generation:  0.00915980339050293
mini_batch_src_global generation:  0.03432106971740723
r_  generation:  0.5231473445892334
local_output_nid generation:  0.007044553756713867
local_in_edges_tensor generation:  0.01842045783996582
mini_batch_src_global generation:  0.03623533248901367
r_  generation:  0.5331025123596191
local_output_nid generation:  0.007630825042724609
local_in_edges_tensor generation:  0.023685693740844727
mini_batch_src_global generation:  0.03749275207519531
r_  generation:  0.5181739330291748
local_output_nid generation:  0.007260799407958984
local_in_edges_tensor generation:  0.018192768096923828
mini_batch_src_global generation:  0.03884768486022949
r_  generation:  0.5364127159118652
local_output_nid generation:  0.007129669189453125
local_in_edges_tensor generation:  0.018704652786254883
mini_batch_src_global generation:  0.0399937629699707
r_  generation:  0.5443105697631836
local_output_nid generation:  0.008158206939697266
local_in_edges_tensor generation:  0.01235651969909668
mini_batch_src_global generation:  0.04090714454650879
r_  generation:  0.5272693634033203
local_output_nid generation:  0.0071408748626708984
local_in_edges_tensor generation:  0.010708093643188477
mini_batch_src_global generation:  0.041651248931884766
r_  generation:  0.5365688800811768
local_output_nid generation:  0.011744022369384766
local_in_edges_tensor generation:  0.009952068328857422
mini_batch_src_global generation:  0.04160618782043457
r_  generation:  0.5657241344451904
----------------------check_connections_block total spend ----------------------------- 10.632230997085571
generate_one_block  0.8775861263275146
generate_one_block  0.5300071239471436
generate_one_block  0.5051612854003906
generate_one_block  0.5101318359375
generate_one_block  0.5213057994842529
generate_one_block  0.5043044090270996
generate_one_block  0.513702392578125
generate_one_block  0.5022425651550293
generate_one_block  0.5078015327453613
generate_one_block  0.5072517395019531
generate_one_block  0.5058846473693848
generate_one_block  0.52410888671875
generate_one_block  0.5254998207092285
generate_one_block  0.5088338851928711
generate_one_block  0.5552446842193604
generate_one_block  0.5414688587188721
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5212717056274414
gen group dst list time:  0.25442051887512207
time for parepare:  0.4865849018096924
local_output_nid generation:  0.17084693908691406
local_in_edges_tensor generation:  0.817516565322876
mini_batch_src_global generation:  0.9127089977264404
r_  generation:  10.583114862442017
local_output_nid generation:  0.20682764053344727
local_in_edges_tensor generation:  0.8795044422149658
mini_batch_src_global generation:  1.221954107284546
r_  generation:  10.626852750778198
local_output_nid generation:  0.19034099578857422
local_in_edges_tensor generation:  0.9929242134094238
mini_batch_src_global generation:  1.1621131896972656
r_  generation:  10.735218524932861
local_output_nid generation:  0.2004234790802002
local_in_edges_tensor generation:  0.8668720722198486
mini_batch_src_global generation:  1.1641993522644043
r_  generation:  11.026989221572876
local_output_nid generation:  0.2039475440979004
local_in_edges_tensor generation:  0.6624834537506104
mini_batch_src_global generation:  1.1546845436096191
r_  generation:  10.906599760055542
local_output_nid generation:  0.173323392868042
local_in_edges_tensor generation:  0.8377375602722168
mini_batch_src_global generation:  1.265174388885498
r_  generation:  10.906798839569092
local_output_nid generation:  0.19400453567504883
local_in_edges_tensor generation:  0.8462090492248535
mini_batch_src_global generation:  1.1978135108947754
r_  generation:  11.081236124038696
local_output_nid generation:  0.20675349235534668
local_in_edges_tensor generation:  0.8309187889099121
mini_batch_src_global generation:  1.1825478076934814
r_  generation:  11.120532274246216
local_output_nid generation:  0.20856142044067383
local_in_edges_tensor generation:  0.6709656715393066
mini_batch_src_global generation:  1.141484260559082
r_  generation:  11.018005609512329
local_output_nid generation:  0.1741023063659668
local_in_edges_tensor generation:  0.8350107669830322
mini_batch_src_global generation:  1.3062446117401123
r_  generation:  10.941406965255737
local_output_nid generation:  0.19252991676330566
local_in_edges_tensor generation:  0.8468997478485107
mini_batch_src_global generation:  1.2477688789367676
r_  generation:  11.17202639579773
local_output_nid generation:  0.20195984840393066
local_in_edges_tensor generation:  0.8357675075531006
mini_batch_src_global generation:  1.189337968826294
r_  generation:  11.195387601852417
local_output_nid generation:  0.20589184761047363
local_in_edges_tensor generation:  0.6773507595062256
mini_batch_src_global generation:  1.155775547027588
r_  generation:  11.177273750305176
local_output_nid generation:  0.17143702507019043
local_in_edges_tensor generation:  0.8445084095001221
mini_batch_src_global generation:  1.2942664623260498
r_  generation:  10.9656503200531
local_output_nid generation:  0.19339680671691895
local_in_edges_tensor generation:  0.8443598747253418
mini_batch_src_global generation:  1.3865814208984375
r_  generation:  11.336254835128784
local_output_nid generation:  0.19256114959716797
local_in_edges_tensor generation:  0.8540515899658203
mini_batch_src_global generation:  1.3480782508850098
r_  generation:  11.032217979431152
----------------------check_connections_block total spend ----------------------------- 241.5178997516632
generate_one_block  15.542505264282227
generate_one_block  16.231489896774292
generate_one_block  15.377360820770264
generate_one_block  15.55729866027832
generate_one_block  15.166544675827026
generate_one_block  15.42625880241394
generate_one_block  15.561838865280151
generate_one_block  15.610681056976318
generate_one_block  15.30353832244873
generate_one_block  15.777544021606445
generate_one_block  15.52975344657898
generate_one_block  15.534876585006714
generate_one_block  15.319781303405762
generate_one_block  15.365536451339722
generate_one_block  15.511539697647095
generate_one_block  15.25665283203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.171992301940918
gen group dst list time:  1.137134075164795
time for parepare:  0.5028119087219238
local_output_nid generation:  0.6272988319396973
local_in_edges_tensor generation:  1.329434871673584
mini_batch_src_global generation:  1.2029800415039062
r_  generation:  15.498779773712158
local_output_nid generation:  0.6644313335418701
local_in_edges_tensor generation:  1.336404800415039
mini_batch_src_global generation:  1.560765027999878
r_  generation:  15.638532161712646
local_output_nid generation:  0.6730589866638184
local_in_edges_tensor generation:  1.427884817123413
mini_batch_src_global generation:  1.8017730712890625
r_  generation:  16.523606538772583
local_output_nid generation:  0.6927962303161621
local_in_edges_tensor generation:  1.2993614673614502
mini_batch_src_global generation:  1.6095240116119385
r_  generation:  16.473034858703613
local_output_nid generation:  0.6841928958892822
local_in_edges_tensor generation:  1.2916114330291748
mini_batch_src_global generation:  1.814539909362793
r_  generation:  16.482208013534546
local_output_nid generation:  0.6774916648864746
local_in_edges_tensor generation:  1.308082103729248
mini_batch_src_global generation:  1.7411940097808838
r_  generation:  16.454411506652832
local_output_nid generation:  0.6928391456604004
local_in_edges_tensor generation:  1.3012104034423828
mini_batch_src_global generation:  1.6464905738830566
r_  generation:  17.004615545272827
local_output_nid generation:  0.6740834712982178
local_in_edges_tensor generation:  1.3073890209197998
mini_batch_src_global generation:  1.587813377380371
r_  generation:  16.432133197784424
local_output_nid generation:  0.6666369438171387
local_in_edges_tensor generation:  1.3324244022369385
mini_batch_src_global generation:  1.6037375926971436
r_  generation:  16.674614906311035
local_output_nid generation:  0.6903197765350342
local_in_edges_tensor generation:  1.299133062362671
mini_batch_src_global generation:  1.6596791744232178
r_  generation:  16.454472303390503
local_output_nid generation:  0.6841425895690918
local_in_edges_tensor generation:  1.298630952835083
mini_batch_src_global generation:  1.8296632766723633
r_  generation:  16.63883900642395
local_output_nid generation:  0.6759181022644043
local_in_edges_tensor generation:  1.310211181640625
mini_batch_src_global generation:  1.7557337284088135
r_  generation:  16.51591968536377
local_output_nid generation:  0.6900486946105957
local_in_edges_tensor generation:  1.304647445678711
mini_batch_src_global generation:  1.6508662700653076
r_  generation:  16.741700172424316
local_output_nid generation:  0.6739325523376465
local_in_edges_tensor generation:  2.9471514225006104
mini_batch_src_global generation:  1.5577969551086426
r_  generation:  16.446247577667236
local_output_nid generation:  0.6694834232330322
local_in_edges_tensor generation:  1.3249707221984863
mini_batch_src_global generation:  1.5906877517700195
r_  generation:  16.695964097976685
local_output_nid generation:  0.6884808540344238
local_in_edges_tensor generation:  1.3258488178253174
mini_batch_src_global generation:  1.5866460800170898
r_  generation:  16.4940447807312
----------------------check_connections_block total spend ----------------------------- 371.6899447441101
generate_one_block  22.069868326187134
generate_one_block  21.940352201461792
generate_one_block  21.875864267349243
generate_one_block  21.931665658950806
generate_one_block  21.84843373298645
generate_one_block  21.92357087135315
generate_one_block  21.920150995254517
generate_one_block  22.210262775421143
generate_one_block  21.91094708442688
generate_one_block  21.97262692451477
generate_one_block  21.885855436325073
generate_one_block  21.931983947753906
generate_one_block  21.990524768829346
generate_one_block  21.925816297531128
generate_one_block  21.916658401489258
generate_one_block  21.996134281158447
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.354320526123047  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

connection checking time:  613.2078444957733
block generation total time  599.3239166736603
average batch blocks generation time:  37.45774479210377
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3278121948242188  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.550936222076416  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.328547477722168  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5537142753601074  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3266191482543945  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.547274589538574  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3326053619384766  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.560678005218506  GigaBytes
Max Memory Allocated: 3.5430550575256348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3261399269104004  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5462851524353027  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3277826309204102  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5506649017333984  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3298063278198242  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5541892051696777  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3269553184509277  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.549100875854492  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3264269828796387  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.548710823059082  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.32781982421875  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5498085021972656  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.329422950744629  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5524868965148926  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3274664878845215  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5491905212402344  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3297710418701172  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.554462432861328  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3288469314575195  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.552485466003418  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.328418254852295  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.550764560699463  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 1.3280091285705566  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1356201171875 GB
    Memory Allocated: 2.5497002601623535  GigaBytes
Max Memory Allocated: 3.5475172996520996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.33415739238262177 |0.4595912843942642 |0.004186972975730896 |0.00014095008373260498 |0.009471818804740906 |0.0013680458068847656 |
----------------------------------------------------------pseudo_mini_loss sum 5.965218544006348
Total (block generation + training)time/epoch 1286.5001266002655
Training time/epoch 1648478037.9086163
Training time without block to device /epoch 1648478030.5551558
Training time without total dataloading part /epoch 0.22216391563415527
load block tensor time/epoch 5.346518278121948
block to device time/epoch 7.3534605503082275
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  73591256
Number of first layer input nodes during this epoch: Using backend: pytorch
 35462468
