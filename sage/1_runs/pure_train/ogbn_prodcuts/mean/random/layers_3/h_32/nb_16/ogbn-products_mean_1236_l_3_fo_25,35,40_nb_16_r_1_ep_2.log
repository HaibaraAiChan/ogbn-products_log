main start at this time 1648422431.929678
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.327085018157959
random selection method range initialization spend 0.014244318008422852
time for parepare:  0.27972412109375
local_output_nid generation:  0.006441354751586914
local_in_edges_tensor generation:  0.0284271240234375
mini_batch_src_global generation:  0.014384269714355469
r_  generation:  0.18958020210266113
local_output_nid generation:  0.007197856903076172
local_in_edges_tensor generation:  0.006985902786254883
mini_batch_src_global generation:  0.018658876419067383
r_  generation:  0.21108412742614746
local_output_nid generation:  0.0072062015533447266
local_in_edges_tensor generation:  0.00667572021484375
mini_batch_src_global generation:  0.012257814407348633
r_  generation:  0.22408223152160645
local_output_nid generation:  0.007260560989379883
local_in_edges_tensor generation:  0.006815671920776367
mini_batch_src_global generation:  0.013166666030883789
r_  generation:  0.23800325393676758
local_output_nid generation:  0.007397651672363281
local_in_edges_tensor generation:  0.009396076202392578
mini_batch_src_global generation:  0.014659643173217773
r_  generation:  0.23886895179748535
local_output_nid generation:  0.0072650909423828125
local_in_edges_tensor generation:  0.006705760955810547
mini_batch_src_global generation:  0.015699148178100586
r_  generation:  0.25351858139038086
local_output_nid generation:  0.007184743881225586
local_in_edges_tensor generation:  0.006841182708740234
mini_batch_src_global generation:  0.016806840896606445
r_  generation:  0.26093554496765137
local_output_nid generation:  0.007347822189331055
local_in_edges_tensor generation:  0.0066623687744140625
mini_batch_src_global generation:  0.017371177673339844
r_  generation:  0.26292991638183594
local_output_nid generation:  0.0072956085205078125
local_in_edges_tensor generation:  0.0066988468170166016
mini_batch_src_global generation:  0.017194509506225586
r_  generation:  0.27215099334716797
local_output_nid generation:  0.007289409637451172
local_in_edges_tensor generation:  0.008619070053100586
mini_batch_src_global generation:  0.020546436309814453
r_  generation:  0.27361035346984863
local_output_nid generation:  0.007276773452758789
local_in_edges_tensor generation:  0.007188320159912109
mini_batch_src_global generation:  0.02002573013305664
r_  generation:  0.27474498748779297
local_output_nid generation:  0.007418155670166016
local_in_edges_tensor generation:  0.007151126861572266
mini_batch_src_global generation:  0.02034163475036621
r_  generation:  0.27788805961608887
local_output_nid generation:  0.007311582565307617
local_in_edges_tensor generation:  0.006821870803833008
mini_batch_src_global generation:  0.020508289337158203
r_  generation:  0.2761406898498535
local_output_nid generation:  0.007173776626586914
local_in_edges_tensor generation:  0.006885528564453125
mini_batch_src_global generation:  0.0205838680267334
r_  generation:  0.2780721187591553
local_output_nid generation:  0.007216215133666992
local_in_edges_tensor generation:  0.006777763366699219
mini_batch_src_global generation:  0.021726369857788086
r_  generation:  0.27932024002075195
local_output_nid generation:  0.007280588150024414
local_in_edges_tensor generation:  0.006760597229003906
mini_batch_src_global generation:  0.021937847137451172
r_  generation:  0.27781176567077637
----------------------check_connections_block total spend ----------------------------- 5.683511734008789
generate_one_block  5.51471734046936
generate_one_block  0.2744865417480469
generate_one_block  0.29235291481018066
generate_one_block  0.32540273666381836
generate_one_block  0.2875943183898926
generate_one_block  0.28163719177246094
generate_one_block  0.2803521156311035
generate_one_block  0.2793288230895996
generate_one_block  0.2861061096191406
generate_one_block  0.3222694396972656
generate_one_block  0.29260826110839844
generate_one_block  0.2820403575897217
generate_one_block  0.2895355224609375
generate_one_block  0.2899668216705322
generate_one_block  0.30988025665283203
generate_one_block  0.339780330657959
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.131584882736206
gen group dst list time:  0.15373897552490234
time for parepare:  0.449554443359375
local_output_nid generation:  0.10476851463317871
local_in_edges_tensor generation:  0.47996020317077637
mini_batch_src_global generation:  0.34421777725219727
r_  generation:  4.5069098472595215
local_output_nid generation:  0.11862707138061523
local_in_edges_tensor generation:  0.2901303768157959
mini_batch_src_global generation:  0.43572425842285156
r_  generation:  4.684937238693237
local_output_nid generation:  0.11210775375366211
local_in_edges_tensor generation:  0.29426097869873047
mini_batch_src_global generation:  0.4179093837738037
r_  generation:  4.7992095947265625
local_output_nid generation:  0.12417912483215332
local_in_edges_tensor generation:  0.295992374420166
mini_batch_src_global generation:  0.44297194480895996
r_  generation:  4.872905969619751
local_output_nid generation:  0.11099910736083984
local_in_edges_tensor generation:  0.30097198486328125
mini_batch_src_global generation:  0.4563868045806885
r_  generation:  5.097937345504761
local_output_nid generation:  0.11212038993835449
local_in_edges_tensor generation:  0.3028743267059326
mini_batch_src_global generation:  0.4922184944152832
r_  generation:  5.064603567123413
local_output_nid generation:  0.11139106750488281
local_in_edges_tensor generation:  0.29512882232666016
mini_batch_src_global generation:  0.47531843185424805
r_  generation:  4.999267339706421
local_output_nid generation:  0.11065244674682617
local_in_edges_tensor generation:  0.297849178314209
mini_batch_src_global generation:  0.4756777286529541
r_  generation:  5.028599739074707
local_output_nid generation:  0.11125421524047852
local_in_edges_tensor generation:  0.4669625759124756
mini_batch_src_global generation:  0.4706838130950928
r_  generation:  5.072643756866455
local_output_nid generation:  0.13853764533996582
local_in_edges_tensor generation:  0.3393685817718506
mini_batch_src_global generation:  0.4824981689453125
r_  generation:  5.100984573364258
local_output_nid generation:  0.11203837394714355
local_in_edges_tensor generation:  0.30226564407348633
mini_batch_src_global generation:  0.5016741752624512
r_  generation:  5.162017583847046
local_output_nid generation:  0.11147904396057129
local_in_edges_tensor generation:  0.29592156410217285
mini_batch_src_global generation:  0.48155665397644043
r_  generation:  5.142456531524658
local_output_nid generation:  0.1380782127380371
local_in_edges_tensor generation:  0.4481019973754883
mini_batch_src_global generation:  0.48343372344970703
r_  generation:  5.159711599349976
local_output_nid generation:  0.11143994331359863
local_in_edges_tensor generation:  0.3075416088104248
mini_batch_src_global generation:  0.5140495300292969
r_  generation:  5.163268327713013
local_output_nid generation:  0.11084723472595215
local_in_edges_tensor generation:  0.29450511932373047
mini_batch_src_global generation:  0.48596692085266113
r_  generation:  5.149169206619263
local_output_nid generation:  0.11069011688232422
local_in_edges_tensor generation:  0.40556907653808594
mini_batch_src_global generation:  0.5014145374298096
r_  generation:  5.115936040878296
----------------------check_connections_block total spend ----------------------------- 108.45164084434509
generate_one_block  6.985122919082642
generate_one_block  6.271813154220581
generate_one_block  6.547996520996094
generate_one_block  6.20452094078064
generate_one_block  6.267982721328735
generate_one_block  6.177418947219849
generate_one_block  6.581024408340454
generate_one_block  6.218884229660034
generate_one_block  6.299513578414917
generate_one_block  6.3822901248931885
generate_one_block  6.454156875610352
generate_one_block  6.172910928726196
generate_one_block  6.238874435424805
generate_one_block  6.3950889110565186
generate_one_block  6.400617361068726
generate_one_block  6.5402679443359375
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2479147911071777
gen group dst list time:  0.8563604354858398
time for parepare:  0.48005032539367676
local_output_nid generation:  0.5243587493896484
local_in_edges_tensor generation:  1.1595103740692139
mini_batch_src_global generation:  1.0287184715270996
r_  generation:  13.95520305633545
local_output_nid generation:  0.582007646560669
local_in_edges_tensor generation:  1.12831449508667
mini_batch_src_global generation:  1.290241003036499
r_  generation:  14.394400835037231
local_output_nid generation:  0.5389063358306885
local_in_edges_tensor generation:  1.2700941562652588
mini_batch_src_global generation:  1.3340239524841309
r_  generation:  14.357712507247925
local_output_nid generation:  0.5687386989593506
local_in_edges_tensor generation:  1.2059645652770996
mini_batch_src_global generation:  1.5368921756744385
r_  generation:  15.045159578323364
local_output_nid generation:  0.5787675380706787
local_in_edges_tensor generation:  1.182375431060791
mini_batch_src_global generation:  1.491905927658081
r_  generation:  14.591593742370605
local_output_nid generation:  0.561028242111206
local_in_edges_tensor generation:  2.239610433578491
mini_batch_src_global generation:  1.3312265872955322
r_  generation:  14.455944538116455
local_output_nid generation:  0.5745103359222412
local_in_edges_tensor generation:  1.0300352573394775
mini_batch_src_global generation:  1.425306797027588
r_  generation:  14.492897987365723
local_output_nid generation:  0.5780673027038574
local_in_edges_tensor generation:  1.1429414749145508
mini_batch_src_global generation:  1.3627283573150635
r_  generation:  14.54947543144226
local_output_nid generation:  0.5386176109313965
local_in_edges_tensor generation:  1.166994333267212
mini_batch_src_global generation:  1.3908207416534424
r_  generation:  14.541890859603882
local_output_nid generation:  0.5626795291900635
local_in_edges_tensor generation:  1.0929253101348877
mini_batch_src_global generation:  1.4796526432037354
r_  generation:  14.961521863937378
local_output_nid generation:  0.5756888389587402
local_in_edges_tensor generation:  1.1780543327331543
mini_batch_src_global generation:  1.5605292320251465
r_  generation:  14.597563743591309
local_output_nid generation:  0.576263427734375
local_in_edges_tensor generation:  1.1428635120391846
mini_batch_src_global generation:  1.422079086303711
r_  generation:  14.396031856536865
local_output_nid generation:  0.5751779079437256
local_in_edges_tensor generation:  1.1512084007263184
mini_batch_src_global generation:  1.3795654773712158
r_  generation:  15.426886081695557
local_output_nid generation:  0.5917437076568604
local_in_edges_tensor generation:  1.1520023345947266
mini_batch_src_global generation:  1.6528828144073486
r_  generation:  14.960654258728027
local_output_nid generation:  0.5791282653808594
local_in_edges_tensor generation:  1.1519882678985596
mini_batch_src_global generation:  1.5861613750457764
r_  generation:  14.610358476638794
local_output_nid generation:  0.5739762783050537
local_in_edges_tensor generation:  1.1516828536987305
mini_batch_src_global generation:  1.4412658214569092
r_  generation:  14.447470426559448
----------------------check_connections_block total spend ----------------------------- 326.970308303833
generate_one_block  19.397783756256104
generate_one_block  19.29548478126526
generate_one_block  19.481895685195923
generate_one_block  19.403961896896362
generate_one_block  18.933380126953125
generate_one_block  19.101272583007812
generate_one_block  20.794963598251343
generate_one_block  19.618009328842163
generate_one_block  19.16796588897705
generate_one_block  18.98948073387146
generate_one_block  19.04533338546753
generate_one_block  19.049784660339355
generate_one_block  19.202608108520508
generate_one_block  19.04962396621704
generate_one_block  19.90108323097229
generate_one_block  19.52280068397522
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 4.4345855712890625e-05  GigaBytes
Max Memory Allocated: 4.4345855712890625e-05  GigaBytes

connection checking time:  435.4219491481781
block generation total time  412.0939164161682
average batch blocks generation time:  25.755869776010513
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2332763671875 GB
    Memory Allocated: 1.1256303787231445  GigaBytes
Max Memory Allocated: 1.1256303787231445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2606201171875 GB
    Memory Allocated: 2.024057388305664  GigaBytes
Max Memory Allocated: 2.428524971008301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4910888671875 GB
    Memory Allocated: 1.1275224685668945  GigaBytes
Max Memory Allocated: 2.8621163368225098  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4910888671875 GB
    Memory Allocated: 2.0221405029296875  GigaBytes
Max Memory Allocated: 2.8621163368225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4910888671875 GB
    Memory Allocated: 1.1275453567504883  GigaBytes
Max Memory Allocated: 2.8621163368225098  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4910888671875 GB
    Memory Allocated: 2.0228114128112793  GigaBytes
Max Memory Allocated: 2.8621163368225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2860107421875 GB
    Memory Allocated: 1.1302809715270996  GigaBytes
Max Memory Allocated: 2.8621163368225098  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2879638671875 GB
    Memory Allocated: 2.028134346008301  GigaBytes
Max Memory Allocated: 2.8621163368225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.130138874053955  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.028005599975586  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1290836334228516  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.023120403289795  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1274828910827637  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0194005966186523  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1262660026550293  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0197887420654297  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.125868797302246  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0191173553466797  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1288161277770996  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.023634433746338  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1280598640441895  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.021676540374756  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.127486228942871  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.019310474395752  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1264023780822754  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0197367668151855  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1262774467468262  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0191268920898438  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.129286766052246  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.023611545562744  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1280303001403809  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0216126441955566  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3038439601659775 |0.4579564183950424 |0.04368710517883301 |0.000145837664604187 |0.010930478572845459 |0.001645803451538086 |
----------------------------------------------------------pseudo_mini_loss sum 8.314075469970703
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64148512
Number of first layer input nodes during this epoch:  34054276
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.812990665435791  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4480757713317871
random selection method range initialization spend 0.014635562896728516
time for parepare:  0.2803976535797119
local_output_nid generation:  0.0063359737396240234
local_in_edges_tensor generation:  0.028144359588623047
mini_batch_src_global generation:  0.01487112045288086
r_  generation:  0.19634103775024414
local_output_nid generation:  0.009966373443603516
local_in_edges_tensor generation:  0.007036447525024414
mini_batch_src_global generation:  0.019587278366088867
r_  generation:  0.2142622470855713
local_output_nid generation:  0.007159709930419922
local_in_edges_tensor generation:  0.008172273635864258
mini_batch_src_global generation:  0.014708757400512695
r_  generation:  0.2237682342529297
local_output_nid generation:  0.007228374481201172
local_in_edges_tensor generation:  0.006533145904541016
mini_batch_src_global generation:  0.013334035873413086
r_  generation:  0.24187040328979492
local_output_nid generation:  0.0071446895599365234
local_in_edges_tensor generation:  0.007277727127075195
mini_batch_src_global generation:  0.013446331024169922
r_  generation:  0.24320268630981445
local_output_nid generation:  0.007165193557739258
local_in_edges_tensor generation:  0.0064847469329833984
mini_batch_src_global generation:  0.015937328338623047
r_  generation:  0.2562699317932129
local_output_nid generation:  0.00712275505065918
local_in_edges_tensor generation:  0.006943225860595703
mini_batch_src_global generation:  0.016977310180664062
r_  generation:  0.2601335048675537
local_output_nid generation:  0.007218837738037109
local_in_edges_tensor generation:  0.006502866744995117
mini_batch_src_global generation:  0.01727771759033203
r_  generation:  0.2629969120025635
local_output_nid generation:  0.007123470306396484
local_in_edges_tensor generation:  0.006556987762451172
mini_batch_src_global generation:  0.017363548278808594
r_  generation:  0.2640819549560547
local_output_nid generation:  0.007111072540283203
local_in_edges_tensor generation:  0.00635528564453125
mini_batch_src_global generation:  0.01863241195678711
r_  generation:  0.27965760231018066
local_output_nid generation:  0.007205963134765625
local_in_edges_tensor generation:  0.006348133087158203
mini_batch_src_global generation:  0.01988816261291504
r_  generation:  0.3133366107940674
local_output_nid generation:  0.007611751556396484
local_in_edges_tensor generation:  0.006556510925292969
mini_batch_src_global generation:  0.02034449577331543
r_  generation:  0.28170037269592285
local_output_nid generation:  0.007231950759887695
local_in_edges_tensor generation:  0.006402492523193359
mini_batch_src_global generation:  0.0230562686920166
r_  generation:  0.304790735244751
local_output_nid generation:  0.007345438003540039
local_in_edges_tensor generation:  0.00637364387512207
mini_batch_src_global generation:  0.02102828025817871
r_  generation:  0.2817244529724121
local_output_nid generation:  0.00842142105102539
local_in_edges_tensor generation:  0.021758079528808594
mini_batch_src_global generation:  0.02117323875427246
r_  generation:  0.27903294563293457
local_output_nid generation:  0.0071718692779541016
local_in_edges_tensor generation:  0.012579917907714844
mini_batch_src_global generation:  0.02699422836303711
r_  generation:  0.2890584468841553
----------------------check_connections_block total spend ----------------------------- 5.8773064613342285
generate_one_block  0.6024658679962158
generate_one_block  0.343705415725708
generate_one_block  0.2975587844848633
generate_one_block  0.2874720096588135
generate_one_block  0.28664541244506836
generate_one_block  0.28496456146240234
generate_one_block  0.2870371341705322
generate_one_block  0.27874159812927246
generate_one_block  0.28134751319885254
generate_one_block  0.2879965305328369
generate_one_block  0.3034048080444336
generate_one_block  0.2930605411529541
generate_one_block  0.29433155059814453
generate_one_block  0.3087296485900879
generate_one_block  0.28995466232299805
generate_one_block  0.29183459281921387
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.22701358795166
gen group dst list time:  0.16573524475097656
time for parepare:  0.48963427543640137
local_output_nid generation:  0.14336681365966797
local_in_edges_tensor generation:  0.392315149307251
mini_batch_src_global generation:  0.3418002128601074
r_  generation:  4.623944520950317
local_output_nid generation:  0.13795948028564453
local_in_edges_tensor generation:  0.4092724323272705
mini_batch_src_global generation:  0.46924424171447754
r_  generation:  4.813687562942505
local_output_nid generation:  0.17693686485290527
local_in_edges_tensor generation:  0.2984626293182373
mini_batch_src_global generation:  0.4218099117279053
r_  generation:  4.851090431213379
local_output_nid generation:  0.11075735092163086
local_in_edges_tensor generation:  0.5330872535705566
mini_batch_src_global generation:  0.511669397354126
r_  generation:  5.3475422859191895
local_output_nid generation:  0.14052438735961914
local_in_edges_tensor generation:  0.40565061569213867
mini_batch_src_global generation:  0.519711971282959
r_  generation:  5.13378381729126
local_output_nid generation:  0.1456761360168457
local_in_edges_tensor generation:  0.29096293449401855
mini_batch_src_global generation:  0.46636223793029785
r_  generation:  5.107552528381348
local_output_nid generation:  0.1112816333770752
local_in_edges_tensor generation:  0.39843058586120605
mini_batch_src_global generation:  0.4874141216278076
r_  generation:  5.21278977394104
local_output_nid generation:  0.15130019187927246
local_in_edges_tensor generation:  0.2939639091491699
mini_batch_src_global generation:  0.4699890613555908
r_  generation:  5.043303489685059
local_output_nid generation:  0.11748647689819336
local_in_edges_tensor generation:  0.4017179012298584
mini_batch_src_global generation:  0.47933197021484375
r_  generation:  5.179298400878906
local_output_nid generation:  0.1270599365234375
local_in_edges_tensor generation:  0.2960488796234131
mini_batch_src_global generation:  0.4838857650756836
r_  generation:  5.1446380615234375
local_output_nid generation:  0.1332545280456543
local_in_edges_tensor generation:  0.2962377071380615
mini_batch_src_global generation:  0.4809834957122803
r_  generation:  5.149954795837402
local_output_nid generation:  0.12767386436462402
local_in_edges_tensor generation:  0.40488576889038086
mini_batch_src_global generation:  0.4984874725341797
r_  generation:  5.286915302276611
local_output_nid generation:  0.14275503158569336
local_in_edges_tensor generation:  0.29755163192749023
mini_batch_src_global generation:  0.5006015300750732
r_  generation:  5.144723415374756
local_output_nid generation:  0.11194133758544922
local_in_edges_tensor generation:  0.4082810878753662
mini_batch_src_global generation:  0.48613667488098145
r_  generation:  5.176733493804932
local_output_nid generation:  0.11231255531311035
local_in_edges_tensor generation:  0.2980666160583496
mini_batch_src_global generation:  0.504166841506958
r_  generation:  5.2302021980285645
local_output_nid generation:  0.13904666900634766
local_in_edges_tensor generation:  0.2945411205291748
mini_batch_src_global generation:  0.48160290718078613
r_  generation:  5.134124040603638
----------------------check_connections_block total spend ----------------------------- 111.12853789329529
generate_one_block  6.744101524353027
generate_one_block  7.033830165863037
generate_one_block  6.256439208984375
generate_one_block  6.6597583293914795
generate_one_block  6.318417072296143
generate_one_block  6.376980304718018
generate_one_block  6.616565942764282
generate_one_block  6.278170824050903
generate_one_block  6.615504264831543
generate_one_block  6.37528133392334
generate_one_block  6.8736138343811035
generate_one_block  6.47215723991394
generate_one_block  6.666894197463989
generate_one_block  6.816306114196777
generate_one_block  6.941742897033691
generate_one_block  6.802879571914673
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.211604118347168
gen group dst list time:  0.9592313766479492
time for parepare:  0.5014548301696777
local_output_nid generation:  0.579517126083374
local_in_edges_tensor generation:  1.2029967308044434
mini_batch_src_global generation:  1.056833028793335
r_  generation:  14.128183603286743
local_output_nid generation:  0.5780384540557861
local_in_edges_tensor generation:  1.1817667484283447
mini_batch_src_global generation:  1.4659762382507324
r_  generation:  14.27914547920227
local_output_nid generation:  0.6003119945526123
local_in_edges_tensor generation:  1.2561378479003906
mini_batch_src_global generation:  1.4165763854980469
r_  generation:  14.347724199295044
local_output_nid generation:  0.5834569931030273
local_in_edges_tensor generation:  1.1347410678863525
mini_batch_src_global generation:  1.467510461807251
r_  generation:  14.620592594146729
local_output_nid generation:  0.5804336071014404
local_in_edges_tensor generation:  1.128157615661621
mini_batch_src_global generation:  1.4255352020263672
r_  generation:  14.629822731018066
local_output_nid generation:  0.582211971282959
local_in_edges_tensor generation:  1.13496732711792
mini_batch_src_global generation:  1.3302090167999268
r_  generation:  14.751543760299683
local_output_nid generation:  0.5453629493713379
local_in_edges_tensor generation:  1.1624267101287842
mini_batch_src_global generation:  1.3392705917358398
r_  generation:  14.730815887451172
local_output_nid generation:  0.558354377746582
local_in_edges_tensor generation:  1.1511168479919434
mini_batch_src_global generation:  1.3502326011657715
r_  generation:  14.586925268173218
local_output_nid generation:  0.5747809410095215
local_in_edges_tensor generation:  1.1462085247039795
mini_batch_src_global generation:  1.3414463996887207
r_  generation:  14.641414642333984
local_output_nid generation:  0.5423822402954102
local_in_edges_tensor generation:  1.1372177600860596
mini_batch_src_global generation:  1.4057652950286865
r_  generation:  14.644381284713745
local_output_nid generation:  0.5801455974578857
local_in_edges_tensor generation:  1.1520299911499023
mini_batch_src_global generation:  1.3927180767059326
r_  generation:  14.624712705612183
local_output_nid generation:  0.5678942203521729
local_in_edges_tensor generation:  1.0177006721496582
mini_batch_src_global generation:  1.445378303527832
r_  generation:  14.598956108093262
local_output_nid generation:  0.5806789398193359
local_in_edges_tensor generation:  1.142913818359375
mini_batch_src_global generation:  1.502410888671875
r_  generation:  14.446141481399536
local_output_nid generation:  0.5714609622955322
local_in_edges_tensor generation:  2.7644407749176025
mini_batch_src_global generation:  1.355686902999878
r_  generation:  14.278870344161987
local_output_nid generation:  0.5849988460540771
local_in_edges_tensor generation:  1.156358242034912
mini_batch_src_global generation:  1.5194127559661865
r_  generation:  14.59391474723816
local_output_nid generation:  0.5762512683868408
local_in_edges_tensor generation:  1.142554759979248
mini_batch_src_global generation:  1.4638257026672363
r_  generation:  14.717771530151367
----------------------check_connections_block total spend ----------------------------- 325.3828036785126
generate_one_block  19.372359037399292
generate_one_block  19.52394437789917
generate_one_block  19.535315990447998
generate_one_block  19.845945835113525
generate_one_block  19.38143563270569
generate_one_block  19.440077543258667
generate_one_block  19.594735145568848
generate_one_block  19.7677218914032
generate_one_block  19.30183458328247
generate_one_block  19.331251621246338
generate_one_block  19.37661576271057
generate_one_block  19.3120276927948
generate_one_block  19.60972499847412
generate_one_block  19.272106885910034
generate_one_block  19.470561742782593
generate_one_block  19.414344787597656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.812990665435791  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

connection checking time:  436.51134157180786
block generation total time  417.3986463546753
average batch blocks generation time:  26.087415397167206
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1275887489318848  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0217199325561523  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1282711029052734  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0250020027160645  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1275477409362793  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.021317481994629  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1313562393188477  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0298523902893066  GigaBytes
Max Memory Allocated: 2.869948387145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.127784252166748  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0196733474731445  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1264653205871582  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.019611358642578  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1264338493347168  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.022956371307373  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1260886192321777  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0196127891540527  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.126335620880127  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.019859790802002  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1274290084838867  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.020681381225586  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1281328201293945  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.023829936981201  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1274223327636719  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0206847190856934  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1283564567565918  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.025590419769287  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1274223327636719  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.0209951400756836  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1276702880859375  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.022754192352295  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 1.1274261474609375  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0848388671875 GB
    Memory Allocated: 2.02154541015625  GigaBytes
Max Memory Allocated: 2.8717260360717773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.30614660680294037 |0.3092978149652481 |0.0036620348691940308 |0.0001370161771774292 |0.004888266324996948 |0.002797365188598633 |
----------------------------------------------------------pseudo_mini_loss sum 6.030349254608154
Total (block generation + training)time/epoch 905.7525198459625
Training time/epoch 1648424286.99395
Training time without block to device /epoch 1648424282.0451849
Training time without total dataloading part /epoch 0.14179444313049316
load block tensor time/epoch 4.898345708847046
block to device time/epoch 4.94876503944397
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64138402
Number of first layer input nodes during this epoch: Using backend: pytorch
 34045386
