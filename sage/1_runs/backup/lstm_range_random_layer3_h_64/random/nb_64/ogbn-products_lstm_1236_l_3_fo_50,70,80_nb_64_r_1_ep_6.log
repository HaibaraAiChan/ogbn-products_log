main start at this time 1648235931.922438
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7648165225982666
random selection method range initialization spend 0.018204689025878906
time for parepare:  0.38558077812194824
local_output_nid generation:  0.0018434524536132812
local_in_edges_tensor generation:  0.031372785568237305
mini_batch_src_global generation:  0.007875919342041016
r_  generation:  0.08979177474975586
local_output_nid generation:  0.003007173538208008
local_in_edges_tensor generation:  0.0025391578674316406
mini_batch_src_global generation:  0.009361505508422852
r_  generation:  0.09255385398864746
local_output_nid generation:  0.002045154571533203
local_in_edges_tensor generation:  0.002475738525390625
mini_batch_src_global generation:  0.005200386047363281
r_  generation:  0.09233593940734863
local_output_nid generation:  0.0030722618103027344
local_in_edges_tensor generation:  0.0024919509887695312
mini_batch_src_global generation:  0.005070686340332031
r_  generation:  0.09564828872680664
local_output_nid generation:  0.004373788833618164
local_in_edges_tensor generation:  0.002751588821411133
mini_batch_src_global generation:  0.005331277847290039
r_  generation:  0.09645724296569824
local_output_nid generation:  0.001959562301635742
local_in_edges_tensor generation:  0.002689361572265625
mini_batch_src_global generation:  0.005500316619873047
r_  generation:  0.09763789176940918
local_output_nid generation:  0.0019190311431884766
local_in_edges_tensor generation:  0.0024733543395996094
mini_batch_src_global generation:  0.005856752395629883
r_  generation:  0.1036691665649414
local_output_nid generation:  0.0019965171813964844
local_in_edges_tensor generation:  0.0025904178619384766
mini_batch_src_global generation:  0.005816459655761719
r_  generation:  0.10236835479736328
local_output_nid generation:  0.001916646957397461
local_in_edges_tensor generation:  0.0024671554565429688
mini_batch_src_global generation:  0.00612187385559082
r_  generation:  0.10852956771850586
local_output_nid generation:  0.0019271373748779297
local_in_edges_tensor generation:  0.0024917125701904297
mini_batch_src_global generation:  0.006810188293457031
r_  generation:  0.11261510848999023
local_output_nid generation:  0.0019125938415527344
local_in_edges_tensor generation:  0.0032858848571777344
mini_batch_src_global generation:  0.006911754608154297
r_  generation:  0.1152188777923584
local_output_nid generation:  0.001918792724609375
local_in_edges_tensor generation:  0.0031447410583496094
mini_batch_src_global generation:  0.008149862289428711
r_  generation:  0.11073517799377441
local_output_nid generation:  0.0019123554229736328
local_in_edges_tensor generation:  0.0024728775024414062
mini_batch_src_global generation:  0.007720470428466797
r_  generation:  0.11482048034667969
local_output_nid generation:  0.0019049644470214844
local_in_edges_tensor generation:  0.002521991729736328
mini_batch_src_global generation:  0.007687807083129883
r_  generation:  0.11586499214172363
local_output_nid generation:  0.001893758773803711
local_in_edges_tensor generation:  0.0025086402893066406
mini_batch_src_global generation:  0.007610797882080078
r_  generation:  0.1140139102935791
local_output_nid generation:  0.0019180774688720703
local_in_edges_tensor generation:  0.0026335716247558594
mini_batch_src_global generation:  0.007727384567260742
r_  generation:  0.11336946487426758
local_output_nid generation:  0.0019228458404541016
local_in_edges_tensor generation:  0.0025031566619873047
mini_batch_src_global generation:  0.00820159912109375
r_  generation:  0.11512327194213867
local_output_nid generation:  0.0019011497497558594
local_in_edges_tensor generation:  0.002471923828125
mini_batch_src_global generation:  0.007971525192260742
r_  generation:  0.11667919158935547
local_output_nid generation:  0.0019123554229736328
local_in_edges_tensor generation:  0.0024526119232177734
mini_batch_src_global generation:  0.007995128631591797
r_  generation:  0.11519646644592285
local_output_nid generation:  0.0019116401672363281
local_in_edges_tensor generation:  0.002475261688232422
mini_batch_src_global generation:  0.00825643539428711
r_  generation:  0.11756277084350586
local_output_nid generation:  0.0019011497497558594
local_in_edges_tensor generation:  0.0024847984313964844
mini_batch_src_global generation:  0.008054494857788086
r_  generation:  0.11857962608337402
local_output_nid generation:  0.0019195079803466797
local_in_edges_tensor generation:  0.0024836063385009766
mini_batch_src_global generation:  0.008456707000732422
r_  generation:  0.11512160301208496
local_output_nid generation:  0.0019161701202392578
local_in_edges_tensor generation:  0.0053594112396240234
mini_batch_src_global generation:  0.008227825164794922
r_  generation:  0.11795330047607422
local_output_nid generation:  0.00191497802734375
local_in_edges_tensor generation:  0.0024864673614501953
mini_batch_src_global generation:  0.008422613143920898
r_  generation:  0.1194610595703125
local_output_nid generation:  0.001935720443725586
local_in_edges_tensor generation:  0.0024878978729248047
mini_batch_src_global generation:  0.008662939071655273
r_  generation:  0.11952066421508789
local_output_nid generation:  0.0019099712371826172
local_in_edges_tensor generation:  0.002526521682739258
mini_batch_src_global generation:  0.008130311965942383
r_  generation:  0.12065267562866211
local_output_nid generation:  0.0019712448120117188
local_in_edges_tensor generation:  0.002475738525390625
mini_batch_src_global generation:  0.008705615997314453
r_  generation:  0.11524558067321777
local_output_nid generation:  0.0019190311431884766
local_in_edges_tensor generation:  0.002460956573486328
mini_batch_src_global generation:  0.008254528045654297
r_  generation:  0.11889839172363281
local_output_nid generation:  0.0019409656524658203
local_in_edges_tensor generation:  0.0024747848510742188
mini_batch_src_global generation:  0.008409738540649414
r_  generation:  0.11959147453308105
local_output_nid generation:  0.0019254684448242188
local_in_edges_tensor generation:  0.045031070709228516
mini_batch_src_global generation:  0.00840139389038086
r_  generation:  0.12224197387695312
local_output_nid generation:  0.001873016357421875
local_in_edges_tensor generation:  0.002510547637939453
mini_batch_src_global generation:  0.008140802383422852
r_  generation:  0.11895918846130371
local_output_nid generation:  0.0018849372863769531
local_in_edges_tensor generation:  0.0024809837341308594
mini_batch_src_global generation:  0.008815526962280273
r_  generation:  0.11974287033081055
local_output_nid generation:  0.0018813610076904297
local_in_edges_tensor generation:  0.0025205612182617188
mini_batch_src_global generation:  0.008404254913330078
r_  generation:  0.11967277526855469
local_output_nid generation:  0.0018770694732666016
local_in_edges_tensor generation:  0.00782012939453125
mini_batch_src_global generation:  0.00858163833618164
r_  generation:  0.11850333213806152
local_output_nid generation:  0.0018908977508544922
local_in_edges_tensor generation:  0.007125139236450195
mini_batch_src_global generation:  0.008708477020263672
r_  generation:  0.11919665336608887
local_output_nid generation:  0.0018923282623291016
local_in_edges_tensor generation:  0.009281396865844727
mini_batch_src_global generation:  0.008492231369018555
r_  generation:  0.11687326431274414
local_output_nid generation:  0.0018734931945800781
local_in_edges_tensor generation:  0.006197452545166016
mini_batch_src_global generation:  0.0085906982421875
r_  generation:  0.1169586181640625
local_output_nid generation:  0.0018782615661621094
local_in_edges_tensor generation:  0.005892276763916016
mini_batch_src_global generation:  0.008906364440917969
r_  generation:  0.12131762504577637
local_output_nid generation:  0.0018720626831054688
local_in_edges_tensor generation:  0.0055446624755859375
mini_batch_src_global generation:  0.008566141128540039
r_  generation:  0.11896014213562012
local_output_nid generation:  0.001894235610961914
local_in_edges_tensor generation:  0.005257606506347656
mini_batch_src_global generation:  0.008666276931762695
r_  generation:  0.11847615242004395
local_output_nid generation:  0.0018835067749023438
local_in_edges_tensor generation:  0.004837512969970703
mini_batch_src_global generation:  0.008385658264160156
r_  generation:  0.11693406105041504
local_output_nid generation:  0.001874685287475586
local_in_edges_tensor generation:  0.00471806526184082
mini_batch_src_global generation:  0.008534431457519531
r_  generation:  0.1181023120880127
local_output_nid generation:  0.0018782615661621094
local_in_edges_tensor generation:  0.004442930221557617
mini_batch_src_global generation:  0.008941411972045898
r_  generation:  0.12668752670288086
local_output_nid generation:  0.0030601024627685547
local_in_edges_tensor generation:  0.006462574005126953
mini_batch_src_global generation:  0.008791923522949219
r_  generation:  0.1170496940612793
local_output_nid generation:  0.001951456069946289
local_in_edges_tensor generation:  0.008532047271728516
mini_batch_src_global generation:  0.009193897247314453
r_  generation:  0.11902403831481934
local_output_nid generation:  0.00189208984375
local_in_edges_tensor generation:  0.008092880249023438
mini_batch_src_global generation:  0.008836507797241211
r_  generation:  0.13737273216247559
local_output_nid generation:  0.002979278564453125
local_in_edges_tensor generation:  0.0071430206298828125
mini_batch_src_global generation:  0.008632898330688477
r_  generation:  0.13182902336120605
local_output_nid generation:  0.0031473636627197266
local_in_edges_tensor generation:  0.006664276123046875
mini_batch_src_global generation:  0.008865833282470703
r_  generation:  0.11853766441345215
local_output_nid generation:  0.0020835399627685547
local_in_edges_tensor generation:  0.006369829177856445
mini_batch_src_global generation:  0.008792400360107422
r_  generation:  0.12056946754455566
local_output_nid generation:  0.0019462108612060547
local_in_edges_tensor generation:  0.005883932113647461
mini_batch_src_global generation:  0.008991003036499023
r_  generation:  0.11810946464538574
local_output_nid generation:  0.0019114017486572266
local_in_edges_tensor generation:  0.005587100982666016
mini_batch_src_global generation:  0.008610725402832031
r_  generation:  0.11965513229370117
local_output_nid generation:  0.001924276351928711
local_in_edges_tensor generation:  0.00513458251953125
mini_batch_src_global generation:  0.008685111999511719
r_  generation:  0.10515141487121582
local_output_nid generation:  0.0019257068634033203
local_in_edges_tensor generation:  0.004766225814819336
mini_batch_src_global generation:  0.008760213851928711
r_  generation:  0.12031936645507812
local_output_nid generation:  0.0019152164459228516
local_in_edges_tensor generation:  0.0045337677001953125
mini_batch_src_global generation:  0.008696794509887695
r_  generation:  0.12009906768798828
local_output_nid generation:  0.0019061565399169922
local_in_edges_tensor generation:  0.004178524017333984
mini_batch_src_global generation:  0.008663415908813477
r_  generation:  0.12053942680358887
local_output_nid generation:  0.0019402503967285156
local_in_edges_tensor generation:  0.004065275192260742
mini_batch_src_global generation:  0.008681297302246094
r_  generation:  0.12011909484863281
local_output_nid generation:  0.0019197463989257812
local_in_edges_tensor generation:  0.003945112228393555
mini_batch_src_global generation:  0.008621454238891602
r_  generation:  0.12126731872558594
local_output_nid generation:  0.0019135475158691406
local_in_edges_tensor generation:  0.0037353038787841797
mini_batch_src_global generation:  0.008876562118530273
r_  generation:  0.12154102325439453
local_output_nid generation:  0.0019214153289794922
local_in_edges_tensor generation:  0.0038919448852539062
mini_batch_src_global generation:  0.00955510139465332
r_  generation:  0.10800743103027344
local_output_nid generation:  0.0019161701202392578
local_in_edges_tensor generation:  0.0033850669860839844
mini_batch_src_global generation:  0.008664608001708984
r_  generation:  0.11675143241882324
local_output_nid generation:  0.0019195079803466797
local_in_edges_tensor generation:  0.0033750534057617188
mini_batch_src_global generation:  0.00870656967163086
r_  generation:  0.12919902801513672
local_output_nid generation:  0.0019214153289794922
local_in_edges_tensor generation:  0.0034542083740234375
mini_batch_src_global generation:  0.008473396301269531
r_  generation:  0.12195324897766113
local_output_nid generation:  0.0019106864929199219
local_in_edges_tensor generation:  0.0033359527587890625
mini_batch_src_global generation:  0.00873875617980957
r_  generation:  0.11922073364257812
local_output_nid generation:  0.0018696784973144531
local_in_edges_tensor generation:  0.0030019283294677734
mini_batch_src_global generation:  0.008403778076171875
r_  generation:  0.1042330265045166
----------------------check_connections_block total spend ----------------------------- 10.166878461837769
generate_one_block  5.787848234176636
generate_one_block  0.12410306930541992
generate_one_block  0.13057780265808105
generate_one_block  0.12351632118225098
generate_one_block  0.12438321113586426
generate_one_block  0.12726116180419922
generate_one_block  0.1251981258392334
generate_one_block  0.12537145614624023
generate_one_block  0.1274878978729248
generate_one_block  0.12677574157714844
generate_one_block  0.13050484657287598
generate_one_block  0.13167858123779297
generate_one_block  0.13933706283569336
generate_one_block  0.12993836402893066
generate_one_block  0.13003826141357422
generate_one_block  0.16288542747497559
generate_one_block  0.14217495918273926
generate_one_block  0.15721464157104492
generate_one_block  0.14303374290466309
generate_one_block  0.1310291290283203
generate_one_block  0.13086795806884766
generate_one_block  0.12868595123291016
generate_one_block  0.1293635368347168
generate_one_block  0.1544816493988037
generate_one_block  0.14106965065002441
generate_one_block  0.1320786476135254
generate_one_block  0.13087129592895508
generate_one_block  0.12871551513671875
generate_one_block  0.1310436725616455
generate_one_block  0.16053390502929688
generate_one_block  0.13791394233703613
generate_one_block  0.13033318519592285
generate_one_block  0.12816286087036133
generate_one_block  0.12806487083435059
generate_one_block  0.13024401664733887
generate_one_block  0.1560676097869873
generate_one_block  0.1367495059967041
generate_one_block  0.12947940826416016
generate_one_block  0.13074755668640137
generate_one_block  0.12829017639160156
generate_one_block  0.13152599334716797
generate_one_block  0.15469670295715332
generate_one_block  0.13874292373657227
generate_one_block  0.13578367233276367
generate_one_block  0.13101768493652344
generate_one_block  0.12995219230651855
generate_one_block  0.14838790893554688
generate_one_block  0.14165520668029785
generate_one_block  0.13471674919128418
generate_one_block  0.1327822208404541
generate_one_block  0.1287679672241211
generate_one_block  0.13887667655944824
generate_one_block  0.12763381004333496
generate_one_block  0.12695765495300293
generate_one_block  0.12734365463256836
generate_one_block  0.1264019012451172
generate_one_block  0.1287674903869629
generate_one_block  0.13019537925720215
generate_one_block  0.13804054260253906
generate_one_block  0.12701010704040527
generate_one_block  0.1280677318572998
generate_one_block  0.12652850151062012
generate_one_block  0.12787747383117676
generate_one_block  0.12367415428161621
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.377131223678589
gen group dst list time:  0.3504447937011719
time for parepare:  0.4628582000732422
local_output_nid generation:  0.06105780601501465
local_in_edges_tensor generation:  0.37034106254577637
mini_batch_src_global generation:  0.31804966926574707
r_  generation:  3.71272611618042
local_output_nid generation:  0.061887502670288086
local_in_edges_tensor generation:  0.227020263671875
mini_batch_src_global generation:  0.40938854217529297
r_  generation:  3.893589496612549
local_output_nid generation:  0.06100606918334961
local_in_edges_tensor generation:  0.22816777229309082
mini_batch_src_global generation:  0.3947031497955322
r_  generation:  3.969219207763672
local_output_nid generation:  0.06081342697143555
local_in_edges_tensor generation:  0.22878575325012207
mini_batch_src_global generation:  0.44103193283081055
r_  generation:  4.048421859741211
local_output_nid generation:  0.061217546463012695
local_in_edges_tensor generation:  0.2447664737701416
mini_batch_src_global generation:  0.4184873104095459
r_  generation:  4.110175371170044
local_output_nid generation:  0.06098294258117676
local_in_edges_tensor generation:  0.3501863479614258
mini_batch_src_global generation:  0.4251890182495117
r_  generation:  4.2084641456604
local_output_nid generation:  0.09011101722717285
local_in_edges_tensor generation:  0.26999783515930176
mini_batch_src_global generation:  0.4452495574951172
r_  generation:  4.174381732940674
local_output_nid generation:  0.06267261505126953
local_in_edges_tensor generation:  0.24986052513122559
mini_batch_src_global generation:  0.43395066261291504
r_  generation:  4.192169904708862
local_output_nid generation:  0.06230640411376953
local_in_edges_tensor generation:  0.24669766426086426
mini_batch_src_global generation:  0.4499177932739258
r_  generation:  4.27522873878479
local_output_nid generation:  0.06207132339477539
local_in_edges_tensor generation:  0.2732574939727783
mini_batch_src_global generation:  0.4422416687011719
r_  generation:  4.290610313415527
local_output_nid generation:  0.09121990203857422
local_in_edges_tensor generation:  0.3483150005340576
mini_batch_src_global generation:  0.4450948238372803
r_  generation:  4.298384666442871
local_output_nid generation:  0.06344795227050781
local_in_edges_tensor generation:  0.2671184539794922
mini_batch_src_global generation:  0.44809412956237793
r_  generation:  4.254135370254517
local_output_nid generation:  0.062473297119140625
local_in_edges_tensor generation:  0.2565181255340576
mini_batch_src_global generation:  0.4650101661682129
r_  generation:  4.374713659286499
local_output_nid generation:  0.062056779861450195
local_in_edges_tensor generation:  0.2753329277038574
mini_batch_src_global generation:  0.45267271995544434
r_  generation:  4.291884422302246
local_output_nid generation:  0.09123754501342773
local_in_edges_tensor generation:  0.33629560470581055
mini_batch_src_global generation:  0.4657125473022461
r_  generation:  4.289783477783203
local_output_nid generation:  0.06470990180969238
local_in_edges_tensor generation:  0.2677011489868164
mini_batch_src_global generation:  0.534308671951294
r_  generation:  5.0193212032318115
local_output_nid generation:  0.09046459197998047
local_in_edges_tensor generation:  0.3748762607574463
mini_batch_src_global generation:  0.5041992664337158
r_  generation:  4.283633708953857
local_output_nid generation:  0.0862576961517334
local_in_edges_tensor generation:  0.2707943916320801
mini_batch_src_global generation:  0.4681088924407959
r_  generation:  4.3770432472229
local_output_nid generation:  0.06244206428527832
local_in_edges_tensor generation:  0.3580160140991211
mini_batch_src_global generation:  0.4709138870239258
r_  generation:  4.237886190414429
local_output_nid generation:  0.08072018623352051
local_in_edges_tensor generation:  0.26749730110168457
mini_batch_src_global generation:  0.45362043380737305
r_  generation:  4.285594701766968
local_output_nid generation:  0.06188702583312988
local_in_edges_tensor generation:  0.2527806758880615
mini_batch_src_global generation:  0.4590744972229004
r_  generation:  4.365598917007446
local_output_nid generation:  0.061685800552368164
local_in_edges_tensor generation:  0.3009805679321289
mini_batch_src_global generation:  0.45426273345947266
r_  generation:  4.31039023399353
local_output_nid generation:  0.08984565734863281
local_in_edges_tensor generation:  0.3147714138031006
mini_batch_src_global generation:  0.4611973762512207
r_  generation:  4.247689962387085
local_output_nid generation:  0.06316471099853516
local_in_edges_tensor generation:  0.25980257987976074
mini_batch_src_global generation:  0.4502835273742676
r_  generation:  4.285900831222534
local_output_nid generation:  0.062183380126953125
local_in_edges_tensor generation:  0.25170087814331055
mini_batch_src_global generation:  0.4616227149963379
r_  generation:  4.385886907577515
local_output_nid generation:  0.06207418441772461
local_in_edges_tensor generation:  0.30152225494384766
mini_batch_src_global generation:  0.45580124855041504
r_  generation:  4.3284430503845215
local_output_nid generation:  0.0899496078491211
local_in_edges_tensor generation:  0.3279078006744385
mini_batch_src_global generation:  0.44875192642211914
r_  generation:  4.127572536468506
local_output_nid generation:  0.06325554847717285
local_in_edges_tensor generation:  0.26347875595092773
mini_batch_src_global generation:  0.4503028392791748
r_  generation:  4.326732397079468
local_output_nid generation:  0.06257915496826172
local_in_edges_tensor generation:  0.2515373229980469
mini_batch_src_global generation:  0.4689035415649414
r_  generation:  4.270434141159058
local_output_nid generation:  0.06486392021179199
local_in_edges_tensor generation:  0.3013627529144287
mini_batch_src_global generation:  0.4563109874725342
r_  generation:  4.373690843582153
local_output_nid generation:  0.09079337120056152
local_in_edges_tensor generation:  0.31678342819213867
mini_batch_src_global generation:  0.46614718437194824
r_  generation:  4.320956468582153
local_output_nid generation:  0.06257510185241699
local_in_edges_tensor generation:  0.26161718368530273
mini_batch_src_global generation:  0.45236873626708984
r_  generation:  4.2894203662872314
local_output_nid generation:  0.062081098556518555
local_in_edges_tensor generation:  0.2481212615966797
mini_batch_src_global generation:  0.46860837936401367
r_  generation:  4.349279403686523
local_output_nid generation:  0.061716556549072266
local_in_edges_tensor generation:  0.30089449882507324
mini_batch_src_global generation:  0.45409345626831055
r_  generation:  4.325454950332642
local_output_nid generation:  0.09009599685668945
local_in_edges_tensor generation:  0.3286435604095459
mini_batch_src_global generation:  0.4542274475097656
r_  generation:  4.296609401702881
local_output_nid generation:  0.06364679336547852
local_in_edges_tensor generation:  0.2627134323120117
mini_batch_src_global generation:  0.4562692642211914
r_  generation:  4.3361170291900635
local_output_nid generation:  0.06189918518066406
local_in_edges_tensor generation:  0.2516462802886963
mini_batch_src_global generation:  0.4591810703277588
r_  generation:  4.396585464477539
local_output_nid generation:  0.06106257438659668
local_in_edges_tensor generation:  0.33053159713745117
mini_batch_src_global generation:  0.4503152370452881
r_  generation:  4.323643684387207
local_output_nid generation:  0.09086394309997559
local_in_edges_tensor generation:  0.2917454242706299
mini_batch_src_global generation:  0.4547278881072998
r_  generation:  4.298779010772705
local_output_nid generation:  0.06319665908813477
local_in_edges_tensor generation:  0.26003313064575195
mini_batch_src_global generation:  0.45371508598327637
r_  generation:  4.300274133682251
local_output_nid generation:  0.06374382972717285
local_in_edges_tensor generation:  0.24561429023742676
mini_batch_src_global generation:  0.45656538009643555
r_  generation:  4.347602128982544
local_output_nid generation:  0.06199479103088379
local_in_edges_tensor generation:  0.33547353744506836
mini_batch_src_global generation:  0.45575761795043945
r_  generation:  4.386234283447266
local_output_nid generation:  0.09021782875061035
local_in_edges_tensor generation:  0.2889130115509033
mini_batch_src_global generation:  0.45461297035217285
r_  generation:  4.2633912563323975
local_output_nid generation:  0.06230354309082031
local_in_edges_tensor generation:  0.2623889446258545
mini_batch_src_global generation:  0.4515841007232666
r_  generation:  4.311341047286987
local_output_nid generation:  0.06206679344177246
local_in_edges_tensor generation:  0.24618220329284668
mini_batch_src_global generation:  0.456531286239624
r_  generation:  4.348748207092285
local_output_nid generation:  0.061727285385131836
local_in_edges_tensor generation:  0.3301277160644531
mini_batch_src_global generation:  0.45485520362854004
r_  generation:  4.333466053009033
local_output_nid generation:  0.09217190742492676
local_in_edges_tensor generation:  0.2868661880493164
mini_batch_src_global generation:  0.44919562339782715
r_  generation:  4.098550081253052
local_output_nid generation:  0.06297087669372559
local_in_edges_tensor generation:  0.25853800773620605
mini_batch_src_global generation:  0.4513428211212158
r_  generation:  4.341692209243774
local_output_nid generation:  0.06217074394226074
local_in_edges_tensor generation:  0.2456512451171875
mini_batch_src_global generation:  0.4673488140106201
r_  generation:  4.3514182567596436
local_output_nid generation:  0.062096357345581055
local_in_edges_tensor generation:  0.35912609100341797
mini_batch_src_global generation:  0.48729825019836426
r_  generation:  4.299785137176514
local_output_nid generation:  0.090911865234375
local_in_edges_tensor generation:  0.2688014507293701
mini_batch_src_global generation:  0.4534726142883301
r_  generation:  4.256069898605347
local_output_nid generation:  0.06229066848754883
local_in_edges_tensor generation:  0.24991917610168457
mini_batch_src_global generation:  0.48207831382751465
r_  generation:  4.140371561050415
local_output_nid generation:  0.07559061050415039
local_in_edges_tensor generation:  0.24152374267578125
mini_batch_src_global generation:  0.4955151081085205
r_  generation:  4.300508499145508
local_output_nid generation:  0.0973198413848877
local_in_edges_tensor generation:  0.35950398445129395
mini_batch_src_global generation:  0.4616067409515381
r_  generation:  4.273667573928833
local_output_nid generation:  0.06549334526062012
local_in_edges_tensor generation:  0.2677149772644043
mini_batch_src_global generation:  0.4533040523529053
r_  generation:  4.128573894500732
local_output_nid generation:  0.06541657447814941
local_in_edges_tensor generation:  0.25261425971984863
mini_batch_src_global generation:  0.4757084846496582
r_  generation:  4.374603509902954
local_output_nid generation:  0.061281681060791016
local_in_edges_tensor generation:  0.23977136611938477
mini_batch_src_global generation:  0.45413899421691895
r_  generation:  4.294179201126099
local_output_nid generation:  0.09167027473449707
local_in_edges_tensor generation:  0.3768162727355957
mini_batch_src_global generation:  0.45380234718322754
r_  generation:  4.320450305938721
local_output_nid generation:  0.062235116958618164
local_in_edges_tensor generation:  0.2694263458251953
mini_batch_src_global generation:  0.4515414237976074
r_  generation:  4.284741163253784
local_output_nid generation:  0.06239581108093262
local_in_edges_tensor generation:  0.2527275085449219
mini_batch_src_global generation:  0.46085548400878906
r_  generation:  4.351510047912598
local_output_nid generation:  0.06216835975646973
local_in_edges_tensor generation:  0.33105945587158203
mini_batch_src_global generation:  0.4552311897277832
r_  generation:  4.350815057754517
local_output_nid generation:  0.09082818031311035
local_in_edges_tensor generation:  0.304518461227417
mini_batch_src_global generation:  0.455172061920166
r_  generation:  4.2783379554748535
local_output_nid generation:  0.06519412994384766
local_in_edges_tensor generation:  0.2593410015106201
mini_batch_src_global generation:  0.476421594619751
r_  generation:  4.334643125534058
local_output_nid generation:  0.060448408126831055
local_in_edges_tensor generation:  0.242401123046875
mini_batch_src_global generation:  0.46022653579711914
r_  generation:  4.132517337799072
----------------------check_connections_block total spend ----------------------------- 372.80867767333984
generate_one_block  5.844273805618286
generate_one_block  5.999229907989502
generate_one_block  5.432345628738403
generate_one_block  5.854429244995117
generate_one_block  5.5175065994262695
generate_one_block  5.416904449462891
generate_one_block  5.452322244644165
generate_one_block  5.861455917358398
generate_one_block  5.428090333938599
generate_one_block  5.443424701690674
generate_one_block  5.473528146743774
generate_one_block  5.875405788421631
generate_one_block  5.4181883335113525
generate_one_block  5.446072101593018
generate_one_block  5.855045795440674
generate_one_block  5.6241044998168945
generate_one_block  5.379490852355957
generate_one_block  5.397918701171875
generate_one_block  5.8749775886535645
generate_one_block  5.389586448669434
generate_one_block  5.4135870933532715
generate_one_block  5.39121150970459
generate_one_block  5.842824459075928
generate_one_block  5.3960230350494385
generate_one_block  5.453136205673218
generate_one_block  5.5228893756866455
generate_one_block  5.742864608764648
generate_one_block  5.96177077293396
generate_one_block  5.425448179244995
generate_one_block  5.702199220657349
generate_one_block  5.650081634521484
generate_one_block  5.386210918426514
generate_one_block  5.42418098449707
generate_one_block  5.739537239074707
generate_one_block  5.591327428817749
generate_one_block  5.427761077880859
generate_one_block  5.433539867401123
generate_one_block  5.838684797286987
generate_one_block  5.406445741653442
generate_one_block  5.408536911010742
generate_one_block  5.560258626937866
generate_one_block  5.849997282028198
generate_one_block  5.40976095199585
generate_one_block  5.418927431106567
generate_one_block  5.803968667984009
generate_one_block  5.462474822998047
generate_one_block  5.3594324588775635
generate_one_block  5.442349433898926
generate_one_block  5.879201650619507
generate_one_block  5.4251508712768555
generate_one_block  5.446556806564331
generate_one_block  5.676976680755615
generate_one_block  5.576665639877319
generate_one_block  5.51572060585022
generate_one_block  5.3973894119262695
generate_one_block  5.8821282386779785
generate_one_block  5.372012138366699
generate_one_block  5.503108739852905
generate_one_block  5.4607298374176025
generate_one_block  5.817798852920532
generate_one_block  5.417976140975952
generate_one_block  5.483485698699951
generate_one_block  5.819659948348999
generate_one_block  5.3768041133880615
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1505768299102783
gen group dst list time:  3.0724754333496094
time for parepare:  0.4719727039337158
local_output_nid generation:  0.4645223617553711
local_in_edges_tensor generation:  1.6311359405517578
mini_batch_src_global generation:  1.5694060325622559
r_  generation:  18.649227142333984
local_output_nid generation:  0.5109093189239502
local_in_edges_tensor generation:  1.6901025772094727
mini_batch_src_global generation:  1.9998610019683838
r_  generation:  19.297251224517822
local_output_nid generation:  0.5146386623382568
local_in_edges_tensor generation:  1.500244140625
mini_batch_src_global generation:  2.2992687225341797
r_  generation:  19.56030559539795
local_output_nid generation:  0.5126490592956543
local_in_edges_tensor generation:  1.5113964080810547
mini_batch_src_global generation:  2.318441867828369
r_  generation:  19.671936750411987
local_output_nid generation:  0.5211174488067627
local_in_edges_tensor generation:  1.5458922386169434
mini_batch_src_global generation:  2.1922109127044678
r_  generation:  19.606215715408325
local_output_nid generation:  0.5403811931610107
local_in_edges_tensor generation:  1.514526605606079
mini_batch_src_global generation:  2.0936760902404785
r_  generation:  19.592204093933105
local_output_nid generation:  0.5269045829772949
local_in_edges_tensor generation:  1.503673791885376
mini_batch_src_global generation:  2.0681846141815186
r_  generation:  19.782460689544678
local_output_nid generation:  0.5108323097229004
local_in_edges_tensor generation:  1.5130140781402588
mini_batch_src_global generation:  2.134092330932617
r_  generation:  19.3907732963562
local_output_nid generation:  0.5183901786804199
local_in_edges_tensor generation:  1.5468406677246094
mini_batch_src_global generation:  2.3907370567321777
r_  generation:  19.664668560028076
local_output_nid generation:  0.5371782779693604
local_in_edges_tensor generation:  1.557229995727539
mini_batch_src_global generation:  2.221500873565674
r_  generation:  19.914854288101196
local_output_nid generation:  0.5134665966033936
local_in_edges_tensor generation:  1.5215981006622314
mini_batch_src_global generation:  2.098802328109741
r_  generation:  19.74711585044861
local_output_nid generation:  0.5144538879394531
local_in_edges_tensor generation:  1.5093064308166504
mini_batch_src_global generation:  2.064204454421997
r_  generation:  19.902474641799927
local_output_nid generation:  0.5232772827148438
local_in_edges_tensor generation:  1.5236973762512207
mini_batch_src_global generation:  2.3536834716796875
r_  generation:  19.856796503067017
local_output_nid generation:  0.5272462368011475
local_in_edges_tensor generation:  1.5298240184783936
mini_batch_src_global generation:  2.298226833343506
r_  generation:  19.702385187149048
local_output_nid generation:  0.5112259387969971
local_in_edges_tensor generation:  1.5338737964630127
mini_batch_src_global generation:  2.1933250427246094
r_  generation:  19.809848070144653
local_output_nid generation:  0.5215873718261719
local_in_edges_tensor generation:  1.5085246562957764
mini_batch_src_global generation:  2.078141450881958
r_  generation:  19.84079074859619
local_output_nid generation:  0.5147852897644043
local_in_edges_tensor generation:  1.5392014980316162
mini_batch_src_global generation:  2.3281867504119873
r_  generation:  19.72073721885681
local_output_nid generation:  0.5212631225585938
local_in_edges_tensor generation:  1.6434431076049805
mini_batch_src_global generation:  2.299985885620117
r_  generation:  19.74388813972473
local_output_nid generation:  0.5313098430633545
local_in_edges_tensor generation:  1.5503127574920654
mini_batch_src_global generation:  2.1868834495544434
r_  generation:  19.737773418426514
local_output_nid generation:  0.5141205787658691
local_in_edges_tensor generation:  1.5169708728790283
mini_batch_src_global generation:  2.089874267578125
r_  generation:  19.702868223190308
local_output_nid generation:  0.5116682052612305
local_in_edges_tensor generation:  1.512479305267334
mini_batch_src_global generation:  2.1394805908203125
r_  generation:  19.723024368286133
local_output_nid generation:  0.5205769538879395
local_in_edges_tensor generation:  1.528308629989624
mini_batch_src_global generation:  2.388526678085327
r_  generation:  19.79409408569336
local_output_nid generation:  0.5247938632965088
local_in_edges_tensor generation:  1.5435032844543457
mini_batch_src_global generation:  2.1913061141967773
r_  generation:  19.734917640686035
local_output_nid generation:  0.5171630382537842
local_in_edges_tensor generation:  1.512948989868164
mini_batch_src_global generation:  2.0801892280578613
r_  generation:  19.823421239852905
local_output_nid generation:  0.5233888626098633
local_in_edges_tensor generation:  1.5396912097930908
mini_batch_src_global generation:  2.219186782836914
r_  generation:  19.81658101081848
local_output_nid generation:  0.5135295391082764
local_in_edges_tensor generation:  1.6454429626464844
mini_batch_src_global generation:  2.3351752758026123
r_  generation:  19.796545267105103
local_output_nid generation:  0.5184593200683594
local_in_edges_tensor generation:  1.5363380908966064
mini_batch_src_global generation:  2.1624481678009033
r_  generation:  19.890730142593384
local_output_nid generation:  0.5126595497131348
local_in_edges_tensor generation:  1.5127122402191162
mini_batch_src_global generation:  2.085585832595825
r_  generation:  20.21962547302246
local_output_nid generation:  0.5279800891876221
local_in_edges_tensor generation:  1.514554500579834
mini_batch_src_global generation:  2.4463207721710205
r_  generation:  19.744800090789795
local_output_nid generation:  0.5320079326629639
local_in_edges_tensor generation:  1.5652053356170654
mini_batch_src_global generation:  2.2003157138824463
r_  generation:  19.97262191772461
local_output_nid generation:  0.5241801738739014
local_in_edges_tensor generation:  1.5158073902130127
mini_batch_src_global generation:  2.0999722480773926
r_  generation:  19.893908500671387
local_output_nid generation:  0.534170389175415
local_in_edges_tensor generation:  1.534411907196045
mini_batch_src_global generation:  2.443033456802368
r_  generation:  19.865268230438232
local_output_nid generation:  0.525216817855835
local_in_edges_tensor generation:  1.5527839660644531
mini_batch_src_global generation:  2.23626708984375
r_  generation:  19.79743719100952
local_output_nid generation:  0.5152435302734375
local_in_edges_tensor generation:  1.5079915523529053
mini_batch_src_global generation:  2.090449094772339
r_  generation:  19.853792905807495
local_output_nid generation:  0.5361826419830322
local_in_edges_tensor generation:  1.5282552242279053
mini_batch_src_global generation:  2.4391303062438965
r_  generation:  19.907978296279907
local_output_nid generation:  0.5307943820953369
local_in_edges_tensor generation:  1.5762650966644287
mini_batch_src_global generation:  2.1966018676757812
r_  generation:  19.976616859436035
local_output_nid generation:  0.5155742168426514
local_in_edges_tensor generation:  1.517853021621704
mini_batch_src_global generation:  2.140165328979492
r_  generation:  19.973830938339233
local_output_nid generation:  0.5092148780822754
local_in_edges_tensor generation:  1.5304510593414307
mini_batch_src_global generation:  2.3970460891723633
r_  generation:  19.8398118019104
local_output_nid generation:  0.541151762008667
local_in_edges_tensor generation:  1.5700199604034424
mini_batch_src_global generation:  2.233383893966675
r_  generation:  19.943787336349487
local_output_nid generation:  0.5108330249786377
local_in_edges_tensor generation:  1.5086185932159424
mini_batch_src_global generation:  2.160688638687134
r_  generation:  19.86708950996399
local_output_nid generation:  0.5330531597137451
local_in_edges_tensor generation:  1.5359082221984863
mini_batch_src_global generation:  2.438302516937256
r_  generation:  19.893231630325317
local_output_nid generation:  0.5322046279907227
local_in_edges_tensor generation:  1.5553183555603027
mini_batch_src_global generation:  2.180525302886963
r_  generation:  20.009957551956177
local_output_nid generation:  0.5139870643615723
local_in_edges_tensor generation:  1.5595934391021729
mini_batch_src_global generation:  2.2959001064300537
r_  generation:  19.889874935150146
local_output_nid generation:  0.5128674507141113
local_in_edges_tensor generation:  1.5372698307037354
mini_batch_src_global generation:  2.4072916507720947
r_  generation:  19.95204448699951
local_output_nid generation:  0.5560197830200195
local_in_edges_tensor generation:  1.5609636306762695
mini_batch_src_global generation:  2.176072120666504
r_  generation:  20.09540104866028
local_output_nid generation:  0.5141253471374512
local_in_edges_tensor generation:  1.5210249423980713
mini_batch_src_global generation:  2.213517665863037
r_  generation:  19.863863945007324
local_output_nid generation:  0.5149872303009033
local_in_edges_tensor generation:  1.537675142288208
mini_batch_src_global generation:  2.347573757171631
r_  generation:  19.866185188293457
local_output_nid generation:  0.526167631149292
local_in_edges_tensor generation:  1.5169463157653809
mini_batch_src_global generation:  2.1186482906341553
r_  generation:  20.135828971862793
local_output_nid generation:  0.521277904510498
local_in_edges_tensor generation:  1.5874524116516113
mini_batch_src_global generation:  2.258765935897827
r_  generation:  20.075144052505493
local_output_nid generation:  0.5141074657440186
local_in_edges_tensor generation:  1.5500378608703613
mini_batch_src_global generation: terminate called after throwing an instance of 'c10::CUDAOutOfMemoryError'
  what():  CUDA out of memory. Tried to allocate 198.00 MiB (GPU 0; 23.62 GiB total capacity; 21.25 GiB already allocated; 169.44 MiB free; 21.27 GiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff8048208b2 in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x2021b (0x7ff804a7a21b in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x21034 (0x7ff804a7b034 in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x2167d (0x7ff804a7b67d in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x223 (0x7ff8079030d3 in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xd1357a (0x7ff8059a257a in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xd384f7 (0x7ff8059c74f7 in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x123220c (0x7ff83ef2520c in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x120e6ba (0x7ff83ef016ba in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x1217137 (0x7ff83ef0a137 in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: <unknown function> + 0x123220c (0x7ff83ef2520c in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xbd (0x7ff83eff100d in /home/cc/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: torch::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>)::{lambda()#1}::operator()() const + 0xa8 (0x7ff6441afcc0 in /home/cc/.local/lib/python3.6/site-packages/dgl/tensoradapter/pytorch/libtensoradapter_pytorch_1.7.1.so)
frame #13: torch::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x51 (0x7ff6441afd44 in /home/cc/.local/lib/python3.6/site-packages/dgl/tensoradapter/pytorch/libtensoradapter_pytorch_1.7.1.so)
frame #14: TAempty + 0x129 (0x7ff6441ac2e6 in /home/cc/.local/lib/python3.6/site-packages/dgl/tensoradapter/pytorch/libtensoradapter_pytorch_1.7.1.so)
frame #15: dgl::runtime::NDArray::Empty(std::vector<long, std::allocator<long> >, DLDataType, DLContext) + 0xb6 (0x7ff656713586 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #16: dgl::aten::NewIdArray(long, DLContext, unsigned char) + 0x6d (0x7ff655ee414d in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #17: std::pair<dgl::runtime::NDArray, dgl::runtime::NDArray> dgl::aten::impl::Sort<(DLDeviceType)2, int>(dgl::runtime::NDArray, int) + 0x68 (0x7ff6568b83c8 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #18: dgl::aten::Sort(dgl::runtime::NDArray, int) + 0x3ca (0x7ff655ef759a in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #19: void dgl::aten::impl::COOSort_<(DLDeviceType)2, int>(dgl::aten::COOMatrix*, bool) + 0x5b (0x7ff6568ba64b in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #20: dgl::aten::COOSort_(dgl::aten::COOMatrix*, bool) + 0x374 (0x7ff655ef2e34 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #21: dgl::aten::COOSort(dgl::aten::COOMatrix, bool) + 0x471 (0x7ff655f3ac61 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #22: dgl::aten::CSRMatrix dgl::aten::impl::COOToCSR<(DLDeviceType)2, int>(dgl::aten::COOMatrix) + 0xc4 (0x7ff6568b8844 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #23: dgl::aten::COOToCSR(dgl::aten::COOMatrix) + 0x43b (0x7ff655ef1dcb in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #24: dgl::UnitGraph::GetInCSR(bool) const + 0xc0 (0x7ff65685dce0 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #25: dgl::UnitGraph::GetFormat(dgl::SparseFormat) const + 0x4d (0x7ff65685ed4d in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #26: dgl::UnitGraph::InDegrees(unsigned long, dgl::runtime::NDArray) const + 0x36 (0x7ff656860246 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #27: dgl::HeteroGraph::InDegrees(unsigned long, dgl::runtime::NDArray) const + 0x46 (0x7ff6567628f6 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #28: <unknown function> + 0xe0de99 (0x7ff65676ae99 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #29: DGLFuncCall + 0x48 (0x7ff6566f76e8 in /home/cc/.local/lib/python3.6/site-packages/dgl/libdgl.so)
frame #30: <unknown function> + 0x167a3 (0x7ff6437f77a3 in /home/cc/.local/lib/python3.6/site-packages/dgl/_ffi/_cy3/core.cpython-36m-x86_64-linux-gnu.so)
frame #31: <unknown function> + 0x16acb (0x7ff6437f7acb in /home/cc/.local/lib/python3.6/site-packages/dgl/_ffi/_cy3/core.cpython-36m-x86_64-linux-gnu.so)
<omitting python frames>
frame #33: python() [0x57e965]
frame #35: python() [0x57f8ad]
frame #36: python() [0x57e8bc]
frame #38: python() [0x57609f]
frame #39: python() [0x57f96b]
frame #40: python() [0x57e8bc]
frame #42: python() [0x576736]
frame #43: python() [0x57f96b]
frame #44: python() [0x57e8bc]
frame #46: python() [0x57f8ad]
frame #47: python() [0x57e8bc]
frame #49: python() [0x57609f]
frame #50: python() [0x57f96b]
frame #51: python() [0x57e8bc]
frame #53: python() [0x57609f]
frame #58: python() [0x57609f]
frame #62: python() [0x539ba4]

