main start at this time 1648214974.0226655
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6488308906555176
random selection method range initialization spend 0.014340400695800781
time for parepare:  0.3611135482788086
local_output_nid generation:  0.0018229484558105469
local_in_edges_tensor generation:  0.031354665756225586
mini_batch_src_global generation:  0.006771564483642578
r_  generation:  0.08122467994689941
local_output_nid generation:  0.0018537044525146484
local_in_edges_tensor generation:  0.0025877952575683594
mini_batch_src_global generation:  0.007949590682983398
r_  generation:  0.0867147445678711
local_output_nid generation:  0.0018780231475830078
local_in_edges_tensor generation:  0.0025556087493896484
mini_batch_src_global generation:  0.004952669143676758
r_  generation:  0.09256911277770996
local_output_nid generation:  0.0018582344055175781
local_in_edges_tensor generation:  0.002546548843383789
mini_batch_src_global generation:  0.004987239837646484
r_  generation:  0.0933835506439209
local_output_nid generation:  0.0018634796142578125
local_in_edges_tensor generation:  0.00257110595703125
mini_batch_src_global generation:  0.005080699920654297
r_  generation:  0.09361577033996582
local_output_nid generation:  0.0018646717071533203
local_in_edges_tensor generation:  0.002666473388671875
mini_batch_src_global generation:  0.00531315803527832
r_  generation:  0.09745240211486816
local_output_nid generation:  0.0018610954284667969
local_in_edges_tensor generation:  0.0025331974029541016
mini_batch_src_global generation:  0.005695343017578125
r_  generation:  0.09866929054260254
local_output_nid generation:  0.0018706321716308594
local_in_edges_tensor generation:  0.002529144287109375
mini_batch_src_global generation:  0.005647897720336914
r_  generation:  0.0992879867553711
local_output_nid generation:  0.001859426498413086
local_in_edges_tensor generation:  0.002534627914428711
mini_batch_src_global generation:  0.006116390228271484
r_  generation:  0.10237717628479004
local_output_nid generation:  0.001867055892944336
local_in_edges_tensor generation:  0.0025358200073242188
mini_batch_src_global generation:  0.006707906723022461
r_  generation:  0.1054985523223877
local_output_nid generation:  0.001859903335571289
local_in_edges_tensor generation:  0.0025429725646972656
mini_batch_src_global generation:  0.009057283401489258
r_  generation:  0.10805726051330566
local_output_nid generation:  0.0018451213836669922
local_in_edges_tensor generation:  0.0025644302368164062
mini_batch_src_global generation:  0.00701594352722168
r_  generation:  0.10602021217346191
local_output_nid generation:  0.001852273941040039
local_in_edges_tensor generation:  0.0025262832641601562
mini_batch_src_global generation:  0.007171154022216797
r_  generation:  0.1075124740600586
local_output_nid generation:  0.0018579959869384766
local_in_edges_tensor generation:  0.002542734146118164
mini_batch_src_global generation:  0.008434534072875977
r_  generation:  0.1100466251373291
local_output_nid generation:  0.0018684864044189453
local_in_edges_tensor generation:  0.0025637149810791016
mini_batch_src_global generation:  0.007442474365234375
r_  generation:  0.11011767387390137
local_output_nid generation:  0.0018346309661865234
local_in_edges_tensor generation:  0.0025086402893066406
mini_batch_src_global generation:  0.0075414180755615234
r_  generation:  0.1118462085723877
local_output_nid generation:  0.0019168853759765625
local_in_edges_tensor generation:  0.0025942325592041016
mini_batch_src_global generation:  0.007900476455688477
r_  generation:  0.11074352264404297
local_output_nid generation:  0.0018570423126220703
local_in_edges_tensor generation:  0.002550840377807617
mini_batch_src_global generation:  0.007852554321289062
r_  generation:  0.1129903793334961
local_output_nid generation:  0.0018527507781982422
local_in_edges_tensor generation:  0.0025124549865722656
mini_batch_src_global generation:  0.007848739624023438
r_  generation:  0.11082959175109863
local_output_nid generation:  0.0018782615661621094
local_in_edges_tensor generation:  0.0025229454040527344
mini_batch_src_global generation:  0.00805807113647461
r_  generation:  0.11138439178466797
local_output_nid generation:  0.0018548965454101562
local_in_edges_tensor generation:  0.002564668655395508
mini_batch_src_global generation:  0.0077457427978515625
r_  generation:  0.11817193031311035
local_output_nid generation:  0.0018601417541503906
local_in_edges_tensor generation:  0.0025424957275390625
mini_batch_src_global generation:  0.00817251205444336
r_  generation:  0.11165189743041992
local_output_nid generation:  0.0018486976623535156
local_in_edges_tensor generation:  0.002549886703491211
mini_batch_src_global generation:  0.008036375045776367
r_  generation:  0.11228561401367188
local_output_nid generation:  0.0018513202667236328
local_in_edges_tensor generation:  0.002534151077270508
mini_batch_src_global generation:  0.008083581924438477
r_  generation:  0.11728191375732422
local_output_nid generation:  0.0018868446350097656
local_in_edges_tensor generation:  0.0025482177734375
mini_batch_src_global generation:  0.008407831192016602
r_  generation:  0.11450552940368652
local_output_nid generation:  0.0018656253814697266
local_in_edges_tensor generation:  0.002541780471801758
mini_batch_src_global generation:  0.007895469665527344
r_  generation:  0.11393022537231445
local_output_nid generation:  0.0018723011016845703
local_in_edges_tensor generation:  0.0025436878204345703
mini_batch_src_global generation:  0.008291006088256836
r_  generation:  0.11638021469116211
local_output_nid generation:  0.0018498897552490234
local_in_edges_tensor generation:  0.0025331974029541016
mini_batch_src_global generation:  0.008071422576904297
r_  generation:  0.11438536643981934
local_output_nid generation:  0.0018579959869384766
local_in_edges_tensor generation:  0.0025424957275390625
mini_batch_src_global generation:  0.008397340774536133
r_  generation:  0.11309456825256348
local_output_nid generation:  0.0018756389617919922
local_in_edges_tensor generation:  0.033194541931152344
mini_batch_src_global generation:  0.008001089096069336
r_  generation:  0.11784243583679199
local_output_nid generation:  0.0018470287322998047
local_in_edges_tensor generation:  0.002531766891479492
mini_batch_src_global generation:  0.008041620254516602
r_  generation:  0.11432647705078125
local_output_nid generation:  0.0018734931945800781
local_in_edges_tensor generation:  0.0025510787963867188
mini_batch_src_global generation:  0.008252382278442383
r_  generation:  0.11450457572937012
local_output_nid generation:  0.001852273941040039
local_in_edges_tensor generation:  0.0025157928466796875
mini_batch_src_global generation:  0.008208513259887695
r_  generation:  0.11706376075744629
local_output_nid generation:  0.0018551349639892578
local_in_edges_tensor generation:  0.005362272262573242
mini_batch_src_global generation:  0.00819253921508789
r_  generation:  0.11377930641174316
local_output_nid generation:  0.0018587112426757812
local_in_edges_tensor generation:  0.005029439926147461
mini_batch_src_global generation:  0.008495092391967773
r_  generation:  0.11567258834838867
local_output_nid generation:  0.0018494129180908203
local_in_edges_tensor generation:  0.0047872066497802734
mini_batch_src_global generation:  0.008272171020507812
r_  generation:  0.11835980415344238
local_output_nid generation:  0.0018448829650878906
local_in_edges_tensor generation:  0.004470109939575195
mini_batch_src_global generation:  0.008155107498168945
r_  generation:  0.1153099536895752
local_output_nid generation:  0.001844167709350586
local_in_edges_tensor generation:  0.004284858703613281
mini_batch_src_global generation:  0.008359193801879883
r_  generation:  0.11333775520324707
local_output_nid generation:  0.0018515586853027344
local_in_edges_tensor generation:  0.004069328308105469
mini_batch_src_global generation:  0.008247852325439453
r_  generation:  0.12022614479064941
local_output_nid generation:  0.0018694400787353516
local_in_edges_tensor generation:  0.00650787353515625
mini_batch_src_global generation:  0.008412837982177734
r_  generation:  0.11456775665283203
local_output_nid generation:  0.0018503665924072266
local_in_edges_tensor generation:  0.005986928939819336
mini_batch_src_global generation:  0.008257627487182617
r_  generation:  0.11537814140319824
local_output_nid generation:  0.0029425621032714844
local_in_edges_tensor generation:  0.005719423294067383
mini_batch_src_global generation:  0.008339881896972656
r_  generation:  0.11717605590820312
local_output_nid generation:  0.0019164085388183594
local_in_edges_tensor generation:  0.005384206771850586
mini_batch_src_global generation:  0.008170366287231445
r_  generation:  0.11503791809082031
local_output_nid generation:  0.0018663406372070312
local_in_edges_tensor generation:  0.004997968673706055
mini_batch_src_global generation:  0.008284807205200195
r_  generation:  0.11547636985778809
local_output_nid generation:  0.0018568038940429688
local_in_edges_tensor generation:  0.004731178283691406
mini_batch_src_global generation:  0.008502483367919922
r_  generation:  0.11913418769836426
local_output_nid generation:  0.0018544197082519531
local_in_edges_tensor generation:  0.004445075988769531
mini_batch_src_global generation:  0.008191347122192383
r_  generation:  0.11553597450256348
local_output_nid generation:  0.0018680095672607422
local_in_edges_tensor generation:  0.00431513786315918
mini_batch_src_global generation:  0.008310556411743164
r_  generation:  0.11603808403015137
local_output_nid generation:  0.0018630027770996094
local_in_edges_tensor generation:  0.004030942916870117
mini_batch_src_global generation:  0.008526086807250977
r_  generation:  0.11918759346008301
local_output_nid generation:  0.0018546581268310547
local_in_edges_tensor generation:  0.0038645267486572266
mini_batch_src_global generation:  0.011626482009887695
r_  generation:  0.11694645881652832
local_output_nid generation:  0.001870870590209961
local_in_edges_tensor generation:  0.003803253173828125
mini_batch_src_global generation:  0.008476734161376953
r_  generation:  0.11681127548217773
local_output_nid generation:  0.003279447555541992
local_in_edges_tensor generation:  0.003545045852661133
mini_batch_src_global generation:  0.008592367172241211
r_  generation:  0.1192026138305664
local_output_nid generation:  0.0020825862884521484
local_in_edges_tensor generation:  0.003368377685546875
mini_batch_src_global generation:  0.00854039192199707
r_  generation:  0.10417866706848145
local_output_nid generation:  0.0019295215606689453
local_in_edges_tensor generation:  0.0034236907958984375
mini_batch_src_global generation:  0.008541107177734375
r_  generation:  0.11735939979553223
local_output_nid generation:  0.0019390583038330078
local_in_edges_tensor generation:  0.003244161605834961
mini_batch_src_global generation:  0.008917570114135742
r_  generation:  0.11781954765319824
local_output_nid generation:  0.0018894672393798828
local_in_edges_tensor generation:  0.003187894821166992
mini_batch_src_global generation:  0.008423089981079102
r_  generation:  0.12013792991638184
local_output_nid generation:  0.0018916130065917969
local_in_edges_tensor generation:  0.0030519962310791016
mini_batch_src_global generation:  0.008265495300292969
r_  generation:  0.11776280403137207
local_output_nid generation:  0.0018992424011230469
local_in_edges_tensor generation:  0.0030078887939453125
mini_batch_src_global generation:  0.008511066436767578
r_  generation:  0.11731576919555664
local_output_nid generation:  0.0019037723541259766
local_in_edges_tensor generation:  0.0029413700103759766
mini_batch_src_global generation:  0.008591413497924805
r_  generation:  0.11870098114013672
local_output_nid generation:  0.0018842220306396484
local_in_edges_tensor generation:  0.002855539321899414
mini_batch_src_global generation:  0.008407115936279297
r_  generation:  0.11503052711486816
local_output_nid generation:  0.0018808841705322266
local_in_edges_tensor generation:  0.0028090476989746094
mini_batch_src_global generation:  0.008405685424804688
r_  generation:  0.11485767364501953
local_output_nid generation:  0.001893758773803711
local_in_edges_tensor generation:  0.0028083324432373047
mini_batch_src_global generation:  0.008303403854370117
r_  generation:  0.12016415596008301
local_output_nid generation:  0.0018630027770996094
local_in_edges_tensor generation:  0.002770662307739258
mini_batch_src_global generation:  0.008358955383300781
r_  generation:  0.11562275886535645
local_output_nid generation:  0.0019004344940185547
local_in_edges_tensor generation:  0.002845287322998047
mini_batch_src_global generation:  0.008502721786499023
r_  generation:  0.11851620674133301
local_output_nid generation:  0.0018169879913330078
local_in_edges_tensor generation:  0.0026688575744628906
mini_batch_src_global generation:  0.008190393447875977
r_  generation:  0.10262799263000488
----------------------check_connections_block total spend ----------------------------- 9.767695188522339
generate_one_block  5.7662880420684814
generate_one_block  0.12427210807800293
generate_one_block  0.1285858154296875
generate_one_block  0.1225435733795166
generate_one_block  0.1236729621887207
generate_one_block  0.1229090690612793
generate_one_block  0.12481164932250977
generate_one_block  0.12520456314086914
generate_one_block  0.1239774227142334
generate_one_block  0.1255478858947754
generate_one_block  0.12746620178222656
generate_one_block  0.12479138374328613
generate_one_block  0.12318873405456543
generate_one_block  0.12383866310119629
generate_one_block  0.12506628036499023
generate_one_block  0.12399768829345703
generate_one_block  0.12296342849731445
generate_one_block  0.12251758575439453
generate_one_block  0.12615704536437988
generate_one_block  0.12346148490905762
generate_one_block  0.12346792221069336
generate_one_block  0.12297797203063965
generate_one_block  0.12295675277709961
generate_one_block  0.12449479103088379
generate_one_block  0.12720131874084473
generate_one_block  0.13532495498657227
generate_one_block  0.15891432762145996
generate_one_block  0.13373255729675293
generate_one_block  0.1273350715637207
generate_one_block  0.12559747695922852
generate_one_block  0.12645912170410156
generate_one_block  0.12474250793457031
generate_one_block  0.12241697311401367
generate_one_block  0.12447047233581543
generate_one_block  0.12869715690612793
generate_one_block  0.15030503273010254
generate_one_block  0.13686323165893555
generate_one_block  0.12828421592712402
generate_one_block  0.12912297248840332
generate_one_block  0.12617874145507812
generate_one_block  0.12497806549072266
generate_one_block  0.12640690803527832
generate_one_block  0.12409806251525879
generate_one_block  0.12892818450927734
generate_one_block  0.15108013153076172
generate_one_block  0.13744544982910156
generate_one_block  0.13127756118774414
generate_one_block  0.12765002250671387
generate_one_block  0.12715625762939453
generate_one_block  0.12483787536621094
generate_one_block  0.1257162094116211
generate_one_block  0.12406611442565918
generate_one_block  0.1284804344177246
generate_one_block  0.1417067050933838
generate_one_block  0.13280844688415527
generate_one_block  0.12941551208496094
generate_one_block  0.1289200782775879
generate_one_block  0.1268925666809082
generate_one_block  0.12313199043273926
generate_one_block  0.12430286407470703
generate_one_block  0.12494158744812012
generate_one_block  0.12882351875305176
generate_one_block  0.12444424629211426
generate_one_block  0.1211702823638916
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.545698642730713
gen group dst list time:  0.35707831382751465
time for parepare:  0.4671609401702881
local_output_nid generation:  0.061432838439941406
local_in_edges_tensor generation:  0.3616325855255127
mini_batch_src_global generation:  0.33289265632629395
r_  generation:  4.0330634117126465
local_output_nid generation:  0.0952754020690918
local_in_edges_tensor generation:  0.3816657066345215
mini_batch_src_global generation:  0.45148491859436035
r_  generation:  4.066306114196777
local_output_nid generation:  0.09190201759338379
local_in_edges_tensor generation:  0.5094752311706543
mini_batch_src_global generation:  0.3949742317199707
r_  generation:  4.141465663909912
local_output_nid generation:  0.06735992431640625
local_in_edges_tensor generation:  0.4040837287902832
mini_batch_src_global generation:  0.4109201431274414
r_  generation:  4.094916582107544
local_output_nid generation:  0.09338927268981934
local_in_edges_tensor generation:  0.3106071949005127
mini_batch_src_global generation:  0.42260026931762695
r_  generation:  4.148738622665405
local_output_nid generation:  0.06363892555236816
local_in_edges_tensor generation:  0.2751734256744385
mini_batch_src_global generation:  0.46733856201171875
r_  generation:  4.202757358551025
local_output_nid generation:  0.07179999351501465
local_in_edges_tensor generation:  0.26672816276550293
mini_batch_src_global generation:  0.46036243438720703
r_  generation:  4.238697528839111
local_output_nid generation:  0.07452034950256348
local_in_edges_tensor generation:  0.3719778060913086
mini_batch_src_global generation:  0.43909621238708496
r_  generation:  4.18574070930481
local_output_nid generation:  0.07368874549865723
local_in_edges_tensor generation:  0.28501343727111816
mini_batch_src_global generation:  0.4424118995666504
r_  generation:  4.259251356124878
local_output_nid generation:  0.0639500617980957
local_in_edges_tensor generation:  0.26656389236450195
mini_batch_src_global generation:  0.4585888385772705
r_  generation:  4.2803850173950195
local_output_nid generation:  0.06323695182800293
local_in_edges_tensor generation:  0.27201318740844727
mini_batch_src_global generation:  0.47138309478759766
r_  generation:  4.282260417938232
local_output_nid generation:  0.07458758354187012
local_in_edges_tensor generation:  0.3628716468811035
mini_batch_src_global generation:  0.4520437717437744
r_  generation:  4.2754905223846436
local_output_nid generation:  0.07280731201171875
local_in_edges_tensor generation:  0.28272438049316406
mini_batch_src_global generation:  0.45090270042419434
r_  generation:  4.275296449661255
local_output_nid generation:  0.06801915168762207
local_in_edges_tensor generation:  0.26156163215637207
mini_batch_src_global generation:  0.4691798686981201
r_  generation:  4.35796594619751
local_output_nid generation:  0.06312322616577148
local_in_edges_tensor generation:  0.25101757049560547
mini_batch_src_global generation:  0.48106980323791504
r_  generation:  4.311256647109985
local_output_nid generation:  0.07489013671875
local_in_edges_tensor generation:  0.37879014015197754
mini_batch_src_global generation:  0.458021879196167
r_  generation:  4.30338716506958
local_output_nid generation:  0.07228803634643555
local_in_edges_tensor generation:  0.2748994827270508
mini_batch_src_global generation:  0.45528292655944824
r_  generation:  4.287091016769409
local_output_nid generation:  0.06301045417785645
local_in_edges_tensor generation:  0.2584097385406494
mini_batch_src_global generation:  0.4742300510406494
r_  generation:  4.342649459838867
local_output_nid generation:  0.062470436096191406
local_in_edges_tensor generation:  0.2619144916534424
mini_batch_src_global generation:  0.4545755386352539
r_  generation:  4.319277763366699
local_output_nid generation:  0.07448697090148926
local_in_edges_tensor generation:  0.3634154796600342
mini_batch_src_global generation:  0.455672025680542
r_  generation:  4.293837308883667
local_output_nid generation:  0.07305002212524414
local_in_edges_tensor generation:  0.2749669551849365
mini_batch_src_global generation:  0.45821166038513184
r_  generation:  4.312416076660156
local_output_nid generation:  0.06315255165100098
local_in_edges_tensor generation:  0.2629992961883545
mini_batch_src_global generation:  0.4645092487335205
r_  generation:  4.367344379425049
local_output_nid generation:  0.06265568733215332
local_in_edges_tensor generation:  0.2622404098510742
mini_batch_src_global generation:  0.47577500343322754
r_  generation:  4.298821449279785
local_output_nid generation:  0.07456612586975098
local_in_edges_tensor generation:  0.36415863037109375
mini_batch_src_global generation:  0.4577362537384033
r_  generation:  4.328631162643433
local_output_nid generation:  0.07395148277282715
local_in_edges_tensor generation:  0.27667951583862305
mini_batch_src_global generation:  0.4605216979980469
r_  generation:  4.356785297393799
local_output_nid generation:  0.06327962875366211
local_in_edges_tensor generation:  0.25893616676330566
mini_batch_src_global generation:  0.48336172103881836
r_  generation:  4.3832688331604
local_output_nid generation:  0.06221795082092285
local_in_edges_tensor generation:  0.24698615074157715
mini_batch_src_global generation:  0.46358394622802734
r_  generation:  4.1909637451171875
local_output_nid generation:  0.07517766952514648
local_in_edges_tensor generation:  0.36723852157592773
mini_batch_src_global generation:  0.46776604652404785
r_  generation:  4.362645864486694
local_output_nid generation:  0.07294225692749023
local_in_edges_tensor generation:  0.2759251594543457
mini_batch_src_global generation:  0.4570944309234619
r_  generation:  4.343216896057129
local_output_nid generation:  0.06349873542785645
local_in_edges_tensor generation:  0.2588181495666504
mini_batch_src_global generation:  0.4808318614959717
r_  generation:  4.392457723617554
local_output_nid generation:  0.06283974647521973
local_in_edges_tensor generation:  0.2493135929107666
mini_batch_src_global generation:  0.46181678771972656
r_  generation:  4.417246580123901
local_output_nid generation:  0.06237173080444336
local_in_edges_tensor generation:  0.35823893547058105
mini_batch_src_global generation:  0.4550473690032959
r_  generation:  4.334681987762451
local_output_nid generation:  0.09105062484741211
local_in_edges_tensor generation:  0.2815852165222168
mini_batch_src_global generation:  0.45539331436157227
r_  generation:  4.195661544799805
local_output_nid generation:  0.06372594833374023
local_in_edges_tensor generation:  0.26345014572143555
mini_batch_src_global generation:  0.4581139087677002
r_  generation:  4.410086631774902
local_output_nid generation:  0.06674647331237793
local_in_edges_tensor generation:  0.24841547012329102
mini_batch_src_global generation:  0.49391794204711914
r_  generation:  4.39215350151062
local_output_nid generation:  0.0628666877746582
local_in_edges_tensor generation:  0.2891426086425781
mini_batch_src_global generation:  0.45845675468444824
r_  generation:  4.328794717788696
local_output_nid generation:  0.09113407135009766
local_in_edges_tensor generation:  0.3316490650177002
mini_batch_src_global generation:  0.47138476371765137
r_  generation:  4.313102960586548
local_output_nid generation:  0.06283164024353027
local_in_edges_tensor generation:  0.2689797878265381
mini_batch_src_global generation:  0.45328307151794434
r_  generation:  4.275428771972656
local_output_nid generation:  0.07794547080993652
local_in_edges_tensor generation:  0.2581667900085449
mini_batch_src_global generation:  0.47149014472961426
r_  generation:  4.427718639373779
local_output_nid generation:  0.06243157386779785
local_in_edges_tensor generation:  0.24729299545288086
mini_batch_src_global generation:  0.4635329246520996
r_  generation:  4.308880805969238
local_output_nid generation:  0.07463502883911133
local_in_edges_tensor generation:  0.3759193420410156
mini_batch_src_global generation:  0.4613511562347412
r_  generation:  4.350337266921997
local_output_nid generation:  0.07373619079589844
local_in_edges_tensor generation:  0.2757682800292969
mini_batch_src_global generation:  0.45728588104248047
r_  generation:  4.332114219665527
local_output_nid generation:  0.06718301773071289
local_in_edges_tensor generation:  0.25908565521240234
mini_batch_src_global generation:  0.4797244071960449
r_  generation:  4.422996282577515
local_output_nid generation:  0.06203651428222656
local_in_edges_tensor generation:  0.26062536239624023
mini_batch_src_global generation:  0.45615291595458984
r_  generation:  4.327222585678101
local_output_nid generation:  0.07160735130310059
local_in_edges_tensor generation:  0.36505603790283203
mini_batch_src_global generation:  0.46717262268066406
r_  generation:  4.311016798019409
local_output_nid generation:  0.07900118827819824
local_in_edges_tensor generation:  0.2853987216949463
mini_batch_src_global generation:  0.45174670219421387
r_  generation:  4.288179636001587
local_output_nid generation:  0.06287908554077148
local_in_edges_tensor generation:  0.2559623718261719
mini_batch_src_global generation:  0.4593994617462158
r_  generation:  4.239466667175293
local_output_nid generation:  0.06287550926208496
local_in_edges_tensor generation:  0.25014400482177734
mini_batch_src_global generation:  0.47438883781433105
r_  generation:  4.394054651260376
local_output_nid generation:  0.06280875205993652
local_in_edges_tensor generation:  0.3158392906188965
mini_batch_src_global generation:  0.4538695812225342
r_  generation:  4.363483667373657
local_output_nid generation:  0.09155416488647461
local_in_edges_tensor generation:  0.3193783760070801
mini_batch_src_global generation:  0.4624192714691162
r_  generation:  4.312918186187744
local_output_nid generation:  0.06349420547485352
local_in_edges_tensor generation:  0.26754069328308105
mini_batch_src_global generation:  0.4625098705291748
r_  generation:  4.353809356689453
local_output_nid generation:  0.06790781021118164
local_in_edges_tensor generation:  0.24828505516052246
mini_batch_src_global generation:  0.4884490966796875
r_  generation:  4.200968980789185
local_output_nid generation:  0.06223106384277344
local_in_edges_tensor generation:  0.2908167839050293
mini_batch_src_global generation:  0.4538094997406006
r_  generation:  4.307780981063843
local_output_nid generation:  0.0912330150604248
local_in_edges_tensor generation:  0.342120885848999
mini_batch_src_global generation:  0.4530477523803711
r_  generation:  4.2864158153533936
local_output_nid generation:  0.06412053108215332
local_in_edges_tensor generation:  0.26903772354125977
mini_batch_src_global generation:  0.46096277236938477
r_  generation:  4.226284742355347
local_output_nid generation:  0.06340789794921875
local_in_edges_tensor generation:  0.2564117908477783
mini_batch_src_global generation:  0.48262453079223633
r_  generation:  4.380695581436157
local_output_nid generation:  0.06190657615661621
local_in_edges_tensor generation:  0.30678248405456543
mini_batch_src_global generation:  0.4548766613006592
r_  generation:  4.297622203826904
local_output_nid generation:  0.09222936630249023
local_in_edges_tensor generation:  0.3244645595550537
mini_batch_src_global generation:  0.4594383239746094
r_  generation:  4.371785879135132
local_output_nid generation:  0.06231355667114258
local_in_edges_tensor generation:  0.26627349853515625
mini_batch_src_global generation:  0.45643091201782227
r_  generation:  4.318652153015137
local_output_nid generation:  0.06239652633666992
local_in_edges_tensor generation:  0.25465941429138184
mini_batch_src_global generation:  0.47527551651000977
r_  generation:  4.361965179443359
local_output_nid generation:  0.0621333122253418
local_in_edges_tensor generation:  0.3457505702972412
mini_batch_src_global generation:  0.4584362506866455
r_  generation:  4.331769227981567
local_output_nid generation:  0.09226441383361816
local_in_edges_tensor generation:  0.29272985458374023
mini_batch_src_global generation:  0.4549281597137451
r_  generation:  4.325676918029785
local_output_nid generation:  0.06276440620422363
local_in_edges_tensor generation:  0.26116132736206055
mini_batch_src_global generation:  0.45915818214416504
r_  generation:  4.462531566619873
local_output_nid generation:  0.060570478439331055
local_in_edges_tensor generation:  0.24561119079589844
mini_batch_src_global generation:  0.47217226028442383
r_  generation:  4.1567301750183105
----------------------check_connections_block total spend ----------------------------- 376.1229410171509
generate_one_block  5.855914354324341
generate_one_block  6.4603495597839355
generate_one_block  6.036645174026489
generate_one_block  5.7071144580841064
generate_one_block  5.72436261177063
generate_one_block  5.678573131561279
generate_one_block  5.650015115737915
generate_one_block  5.472475051879883
generate_one_block  5.605046987533569
generate_one_block  5.729468584060669
generate_one_block  5.500075817108154
generate_one_block  5.62141227722168
generate_one_block  6.046697616577148
generate_one_block  5.909509897232056
generate_one_block  5.660478353500366
generate_one_block  5.789113283157349
generate_one_block  5.413593053817749
generate_one_block  5.43402624130249
generate_one_block  5.69731068611145
generate_one_block  5.496646881103516
generate_one_block  5.406397342681885
generate_one_block  5.465996265411377
generate_one_block  5.622821092605591
generate_one_block  5.56433629989624
generate_one_block  5.47167706489563
generate_one_block  5.515892744064331
generate_one_block  5.694863319396973
generate_one_block  5.994837760925293
generate_one_block  5.466281414031982
generate_one_block  5.700999975204468
generate_one_block  5.641113042831421
generate_one_block  5.397140264511108
generate_one_block  5.4524195194244385
generate_one_block  5.690660715103149
generate_one_block  5.597283840179443
generate_one_block  5.4406187534332275
generate_one_block  5.508037567138672
generate_one_block  5.986408472061157
generate_one_block  5.59760046005249
generate_one_block  5.85619044303894
generate_one_block  5.641669511795044
generate_one_block  5.835952997207642
generate_one_block  5.49730372428894
generate_one_block  5.507934808731079
generate_one_block  5.703895807266235
generate_one_block  5.614114761352539
generate_one_block  5.388203144073486
generate_one_block  5.513140678405762
generate_one_block  5.738424301147461
generate_one_block  5.5938098430633545
generate_one_block  5.491095781326294
generate_one_block  5.470229625701904
generate_one_block  5.799064874649048
generate_one_block  5.537519693374634
generate_one_block  5.504349946975708
generate_one_block  5.726125717163086
generate_one_block  5.591217041015625
generate_one_block  5.567010402679443
generate_one_block  5.493856430053711
generate_one_block  5.821701288223267
generate_one_block  5.453615665435791
generate_one_block  5.564192056655884
generate_one_block  5.868370294570923
generate_one_block  5.64409875869751
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3180038928985596
gen group dst list time:  3.0787689685821533
time for parepare:  0.49743103981018066
local_output_nid generation:  0.5280978679656982
local_in_edges_tensor generation:  1.1021959781646729
mini_batch_src_global generation:  0.9290392398834229
r_  generation:  12.073075532913208
local_output_nid generation:  0.5057613849639893
local_in_edges_tensor generation:  1.0889718532562256
mini_batch_src_global generation:  1.1741924285888672
r_  generation:  12.327011585235596
local_output_nid generation:  0.49448680877685547
local_in_edges_tensor generation:  1.2487950325012207
mini_batch_src_global generation:  1.2341632843017578
r_  generation:  12.510173797607422
local_output_nid generation:  0.49361348152160645
local_in_edges_tensor generation:  1.0476837158203125
mini_batch_src_global generation:  1.2782862186431885
r_  generation:  12.415057182312012
local_output_nid generation:  0.5108649730682373
local_in_edges_tensor generation:  0.9207308292388916
mini_batch_src_global generation:  1.4535224437713623
r_  generation:  12.953551530838013
local_output_nid generation:  0.5128612518310547
local_in_edges_tensor generation:  1.0439209938049316
mini_batch_src_global generation:  1.2347157001495361
r_  generation:  12.895341873168945
local_output_nid generation:  0.48362064361572266
local_in_edges_tensor generation:  1.060103178024292
mini_batch_src_global generation:  1.2549207210540771
r_  generation:  12.73366641998291
local_output_nid generation:  0.4990847110748291
local_in_edges_tensor generation:  1.0684266090393066
mini_batch_src_global generation:  1.2801837921142578
r_  generation:  12.515249013900757
local_output_nid generation:  0.4990098476409912
local_in_edges_tensor generation:  1.0610558986663818
mini_batch_src_global generation:  1.3232502937316895
r_  generation:  12.440603733062744
local_output_nid generation:  0.5192873477935791
local_in_edges_tensor generation:  0.9336850643157959
mini_batch_src_global generation:  1.4444220066070557
r_  generation:  12.521176815032959
local_output_nid generation:  0.5120463371276855
local_in_edges_tensor generation:  1.0502455234527588
mini_batch_src_global generation:  1.4728035926818848
r_  generation:  13.17194676399231
local_output_nid generation:  0.5127067565917969
local_in_edges_tensor generation:  1.0539085865020752
mini_batch_src_global generation:  1.311070442199707
r_  generation:  13.192758083343506
local_output_nid generation:  0.526421308517456
local_in_edges_tensor generation:  1.0900630950927734
mini_batch_src_global generation:  1.3100130558013916
r_  generation:  12.818719387054443
local_output_nid generation:  0.49638938903808594
local_in_edges_tensor generation:  1.081392526626587
mini_batch_src_global generation:  1.2839939594268799
r_  generation:  12.606771230697632
local_output_nid generation:  0.49715113639831543
local_in_edges_tensor generation:  1.0660357475280762
mini_batch_src_global generation:  1.3372876644134521
r_  generation:  12.565183162689209
local_output_nid generation:  0.5200240612030029
local_in_edges_tensor generation:  0.9339389801025391
mini_batch_src_global generation:  1.4312260150909424
r_  generation:  12.532809734344482
local_output_nid generation:  0.5114610195159912
local_in_edges_tensor generation:  1.0596590042114258
mini_batch_src_global generation:  1.274507999420166
r_  generation:  12.838505744934082
local_output_nid generation:  0.5147697925567627
local_in_edges_tensor generation:  1.050400972366333
mini_batch_src_global generation:  1.2190349102020264
r_  generation:  12.890342235565186
local_output_nid generation:  0.5230748653411865
local_in_edges_tensor generation:  1.049769401550293
mini_batch_src_global generation:  1.2233142852783203
r_  generation:  12.838978052139282
local_output_nid generation:  0.48175883293151855
local_in_edges_tensor generation:  1.0654258728027344
mini_batch_src_global generation:  1.2859101295471191
r_  generation:  12.500674486160278
local_output_nid generation:  0.49894070625305176
local_in_edges_tensor generation:  1.0078601837158203
mini_batch_src_global generation:  1.332554578781128
r_  generation:  12.494910717010498
local_output_nid generation:  0.5267703533172607
local_in_edges_tensor generation:  0.9817380905151367
mini_batch_src_global generation:  1.3682708740234375
r_  generation:  12.558029413223267
local_output_nid generation:  0.5112607479095459
local_in_edges_tensor generation:  1.0568394660949707
mini_batch_src_global generation:  1.2737913131713867
r_  generation:  12.919820308685303
local_output_nid generation:  0.5184445381164551
local_in_edges_tensor generation:  1.055595874786377
mini_batch_src_global generation:  1.2240102291107178
r_  generation:  12.788972854614258
local_output_nid generation:  0.4837682247161865
local_in_edges_tensor generation:  1.0900242328643799
mini_batch_src_global generation:  1.2921428680419922
r_  generation:  12.644344091415405
local_output_nid generation:  0.4982285499572754
local_in_edges_tensor generation:  1.0264506340026855
mini_batch_src_global generation:  1.3522701263427734
r_  generation:  12.44890570640564
local_output_nid generation:  0.5147900581359863
local_in_edges_tensor generation:  0.9779443740844727
mini_batch_src_global generation:  1.3127202987670898
r_  generation:  12.72151231765747
local_output_nid generation:  0.5155227184295654
local_in_edges_tensor generation:  1.0609560012817383
mini_batch_src_global generation:  1.2741403579711914
r_  generation:  12.896548748016357
local_output_nid generation:  0.5119075775146484
local_in_edges_tensor generation:  1.0548021793365479
mini_batch_src_global generation:  1.2235348224639893
r_  generation:  12.913327932357788
local_output_nid generation:  0.4785466194152832
local_in_edges_tensor generation:  1.1048285961151123
mini_batch_src_global generation:  1.2891526222229004
r_  generation:  12.743235111236572
local_output_nid generation:  0.49907517433166504
local_in_edges_tensor generation:  1.0784711837768555
mini_batch_src_global generation:  1.3001940250396729
r_  generation:  12.591907739639282
local_output_nid generation:  0.5142269134521484
local_in_edges_tensor generation:  0.938779354095459
mini_batch_src_global generation:  1.475700855255127
r_  generation:  12.96699070930481
local_output_nid generation:  0.5565564632415771
local_in_edges_tensor generation:  1.0673162937164307
mini_batch_src_global generation:  1.2816712856292725
r_  generation:  12.7593994140625
local_output_nid generation:  0.47293972969055176
local_in_edges_tensor generation:  1.0936455726623535
mini_batch_src_global generation:  1.277951717376709
r_  generation:  13.108173131942749
local_output_nid generation:  0.5274415016174316
local_in_edges_tensor generation:  1.1550564765930176
mini_batch_src_global generation:  1.5073542594909668
r_  generation:  13.019739151000977
local_output_nid generation:  0.5521659851074219
local_in_edges_tensor generation:  1.0720903873443604
mini_batch_src_global generation:  1.2726001739501953
r_  generation:  12.76809310913086
local_output_nid generation:  0.4711949825286865
local_in_edges_tensor generation:  1.077791690826416
mini_batch_src_global generation:  1.2968716621398926
r_  generation:  12.615808725357056
local_output_nid generation:  0.4926142692565918
local_in_edges_tensor generation:  0.9288220405578613
mini_batch_src_global generation:  1.4569404125213623
r_  generation:  12.906396627426147
local_output_nid generation:  0.5163562297821045
local_in_edges_tensor generation:  1.1186842918395996
mini_batch_src_global generation:  1.3321819305419922
r_  generation:  13.147643566131592
local_output_nid generation:  0.5296647548675537
local_in_edges_tensor generation:  1.0532348155975342
mini_batch_src_global generation:  1.2515463829040527
r_  generation:  12.805426836013794
local_output_nid generation:  0.4825143814086914
local_in_edges_tensor generation:  1.0966086387634277
mini_batch_src_global generation:  1.2883265018463135
r_  generation:  12.668400049209595
local_output_nid generation:  0.5002939701080322
local_in_edges_tensor generation:  0.9373977184295654
mini_batch_src_global generation:  1.4065124988555908
r_  generation:  12.653197050094604
local_output_nid generation:  0.5257980823516846
local_in_edges_tensor generation:  1.0832204818725586
mini_batch_src_global generation:  1.3117597103118896
r_  generation:  12.978515625
local_output_nid generation:  0.521249532699585
local_in_edges_tensor generation:  1.0629780292510986
mini_batch_src_global generation:  1.2501330375671387
r_  generation:  12.950965881347656
local_output_nid generation:  0.492997407913208
local_in_edges_tensor generation:  1.0740087032318115
mini_batch_src_global generation:  1.2698204517364502
r_  generation:  12.82593059539795
local_output_nid generation:  0.4836735725402832
local_in_edges_tensor generation:  1.0645396709442139
mini_batch_src_global generation:  1.278836727142334
r_  generation:  12.649529457092285
local_output_nid generation:  0.5112121105194092
local_in_edges_tensor generation:  0.9321670532226562
mini_batch_src_global generation:  1.304563283920288
r_  generation:  12.631952047348022
local_output_nid generation:  0.5192720890045166
local_in_edges_tensor generation:  1.0609347820281982
mini_batch_src_global generation:  1.340066909790039
r_  generation:  13.047770261764526
local_output_nid generation:  0.5123081207275391
local_in_edges_tensor generation:  1.0565779209136963
mini_batch_src_global generation:  1.2214024066925049
r_  generation:  12.817720174789429
local_output_nid generation:  0.4781148433685303
local_in_edges_tensor generation: Using backend: pytorch
 1.0826995372772217
mini_batch_src_global generation:  1.264803409576416
r_  generation:  12.451441526412964
local_output_nid generation:  0.5000143051147461
local_in_edges_tensor generation:  0.9288582801818848
mini_batch_src_global generation:  1.4884955883026123
r_  generation:  12.889057636260986
local_output_nid generation:  0.504852294921875
local_in_edges_tensor generation:  1.0826892852783203
mini_batch_src_global generation:  1.3194589614868164
r_  generation:  12.418940305709839
local_output_nid generation:  0.5030350685119629
local_in_edges_tensor generation:  0.9393916130065918
mini_batch_src_global generation:  1.3829545974731445
r_  generation:  12.656988382339478
local_output_nid generation:  0.5283377170562744
local_in_edges_tensor generation:  1.0601491928100586
mini_batch_src_global generation:  1.3112332820892334
r_  generation:  12.82006549835205
local_output_nid generation:  0.5114932060241699
local_in_edges_tensor generation:  1.0590782165527344
mini_batch_src_global generation:  1.222017526626587
r_  generation:  12.649505138397217
local_output_nid generation:  0.47330236434936523
local_in_edges_tensor generation:  1.063840627670288
mini_batch_src_global generation:  1.2758424282073975
r_  generation:  12.488532304763794
local_output_nid generation:  0.5205788612365723
local_in_edges_tensor generation:  0.9490387439727783
mini_batch_src_global generation:  1.289362907409668
r_  generation:  13.03092360496521
local_output_nid generation:  0.5197908878326416
local_in_edges_tensor generation:  4.981042385101318
mini_batch_src_global generation:  1.2909398078918457
r_  generation:  12.880342245101929
local_output_nid generation:  0.47239041328430176
local_in_edges_tensor generation:  1.0545790195465088
mini_batch_src_global generation:  1.2425422668457031
r_  generation:  12.554332256317139
local_output_nid generation:  0.5182363986968994
local_in_edges_tensor generation:  0.9492301940917969
mini_batch_src_global generation:  1.2935421466827393
r_  generation:  12.91370177268982
local_output_nid generation:  0.5164453983306885
local_in_edges_tensor generation:  1.057842493057251
mini_batch_src_global generation:  1.2365918159484863
r_  generation:  12.864758014678955
local_output_nid generation:  0.47443199157714844
local_in_edges_tensor generation:  1.072866678237915
mini_batch_src_global generation:  1.3019907474517822
r_  generation:  12.5215744972229
local_output_nid generation:  0.5082182884216309
local_in_edges_tensor generation:  0.9482557773590088
mini_batch_src_global generation:  1.38322114944458
r_  generation:  12.688698768615723
local_output_nid generation:  0.5184240341186523
local_in_edges_tensor generation:  1.0598726272583008
mini_batch_src_global generation:  1.289367914199829
r_  generation:  12.756886005401611
----------------------check_connections_block total spend ----------------------------- 1151.6304914951324
generate_one_block  17.45509624481201
generate_one_block  17.417330503463745
generate_one_block  17.379951000213623
generate_one_block  17.506317138671875
generate_one_block  17.221942901611328
generate_one_block  17.1872296333313
generate_one_block  17.48086142539978
generate_one_block  17.274797439575195
generate_one_block  17.459745168685913
generate_one_block  16.9136483669281
generate_one_block  17.225995302200317
generate_one_block  17.130617380142212
generate_one_block  17.930824518203735
generate_one_block  17.377780437469482
generate_one_block  17.305413007736206
generate_one_block  16.794427394866943
generate_one_block  17.162163972854614
generate_one_block  17.15625548362732
generate_one_block  17.39180088043213
generate_one_block  17.181259155273438
generate_one_block  17.20418667793274
generate_one_block  16.808783054351807
generate_one_block  17.10318899154663
generate_one_block  17.22925615310669
generate_one_block  17.45243000984192
generate_one_block  17.54322648048401
generate_one_block  16.97701358795166
generate_one_block  16.813215017318726
generate_one_block  17.21012020111084
generate_one_block  17.257869958877563
generate_one_block  17.504899740219116
generate_one_block  17.39987564086914
generate_one_block  17.231334686279297
generate_one_block  16.807398557662964
generate_one_block  17.313851833343506
generate_one_block  17.38254475593567
generate_one_block  17.334330797195435
generate_one_block  17.420854330062866
generate_one_block  17.667585849761963
generate_one_block  17.215494394302368
generate_one_block  16.990179538726807
generate_one_block  17.110335111618042
generate_one_block  17.289376497268677
generate_one_block  17.375466108322144
generate_one_block  17.410589694976807
generate_one_block  17.382081270217896
generate_one_block  17.133939743041992
generate_one_block  17.29683518409729
generate_one_block  16.812845945358276
generate_one_block  17.344974994659424
generate_one_block  17.275453567504883
generate_one_block  17.469988346099854
generate_one_block  17.353559255599976
generate_one_block  17.47824454307556
generate_one_block  17.15970277786255
generate_one_block  18.13062858581543
generate_one_block  18.283620595932007
generate_one_block  18.591889142990112
generate_one_block  18.599475622177124
generate_one_block  18.61995029449463
generate_one_block  18.345099925994873
generate_one_block  18.62942886352539
generate_one_block  18.556466341018677
generate_one_block  18.343288898468018
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

connection checking time:  1527.7534325122833
block generation total time  1476.9416415691376
average batch blocks generation time:  23.077213149517775
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1766357421875 GB
    Memory Allocated: 1.0846538543701172  GigaBytes
Max Memory Allocated: 1.0846538543701172  GigaBytes

Traceback (most recent call last):
  File "pseudo_mini_batch_range_products_sage.py", line 455, in <module>
    main()
  File "pseudo_mini_batch_range_products_sage.py", line 451, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_products_sage.py", line 276, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_products.py", line 48, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 28.00 MiB (GPU 0; 23.62 GiB total capacity; 20.51 GiB already allocated; 27.44 MiB free; 21.07 GiB reserved in total by PyTorch)
