main start at this time 1648198782.4886632
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6856377124786377
random selection method range initialization spend 0.017526626586914062
time for parepare:  0.3734171390533447
local_output_nid generation:  0.0018928050994873047
local_in_edges_tensor generation:  0.0355985164642334
mini_batch_src_global generation:  0.008240222930908203
r_  generation:  0.09044480323791504
local_output_nid generation:  0.0018999576568603516
local_in_edges_tensor generation:  0.002523660659790039
mini_batch_src_global generation:  0.015122175216674805
r_  generation:  0.09266853332519531
local_output_nid generation:  0.0018742084503173828
local_in_edges_tensor generation:  0.0026938915252685547
mini_batch_src_global generation:  0.006097078323364258
r_  generation:  0.09523868560791016
local_output_nid generation:  0.0018689632415771484
local_in_edges_tensor generation:  0.0029668807983398438
mini_batch_src_global generation:  0.005312681198120117
r_  generation:  0.09468913078308105
local_output_nid generation:  0.0018835067749023438
local_in_edges_tensor generation:  0.002513408660888672
mini_batch_src_global generation:  0.005278825759887695
r_  generation:  0.09850478172302246
local_output_nid generation:  0.0018908977508544922
local_in_edges_tensor generation:  0.0025691986083984375
mini_batch_src_global generation:  0.005566120147705078
r_  generation:  0.09883666038513184
local_output_nid generation:  0.0018928050994873047
local_in_edges_tensor generation:  0.002531290054321289
mini_batch_src_global generation:  0.005916595458984375
r_  generation:  0.10239410400390625
local_output_nid generation:  0.006018400192260742
local_in_edges_tensor generation:  0.0025033950805664062
mini_batch_src_global generation:  0.0061473846435546875
r_  generation:  0.10310578346252441
local_output_nid generation:  0.0018801689147949219
local_in_edges_tensor generation:  0.0029287338256835938
mini_batch_src_global generation:  0.006543874740600586
r_  generation:  0.10245394706726074
local_output_nid generation:  0.0019021034240722656
local_in_edges_tensor generation:  0.0024871826171875
mini_batch_src_global generation:  0.007088422775268555
r_  generation:  0.10793399810791016
local_output_nid generation:  0.0018749237060546875
local_in_edges_tensor generation:  0.002952098846435547
mini_batch_src_global generation:  0.007105588912963867
r_  generation:  0.10687661170959473
local_output_nid generation:  0.0018665790557861328
local_in_edges_tensor generation:  0.0025107860565185547
mini_batch_src_global generation:  0.0070569515228271484
r_  generation:  0.10724759101867676
local_output_nid generation:  0.0018706321716308594
local_in_edges_tensor generation:  0.002496480941772461
mini_batch_src_global generation:  0.007417440414428711
r_  generation:  0.11055254936218262
local_output_nid generation:  0.0018856525421142578
local_in_edges_tensor generation:  0.0032300949096679688
mini_batch_src_global generation:  0.007743120193481445
r_  generation:  0.1115720272064209
local_output_nid generation:  0.0018699169158935547
local_in_edges_tensor generation:  0.002527952194213867
mini_batch_src_global generation:  0.0079498291015625
r_  generation:  0.11200404167175293
local_output_nid generation:  0.0018901824951171875
local_in_edges_tensor generation:  0.0024595260620117188
mini_batch_src_global generation:  0.007784366607666016
r_  generation:  0.11467552185058594
local_output_nid generation:  0.0018694400787353516
local_in_edges_tensor generation:  0.002525806427001953
mini_batch_src_global generation:  0.008270978927612305
r_  generation:  0.12022900581359863
local_output_nid generation:  0.0018916130065917969
local_in_edges_tensor generation:  0.0024459362030029297
mini_batch_src_global generation:  0.008118391036987305
r_  generation:  0.11550259590148926
local_output_nid generation:  0.001889944076538086
local_in_edges_tensor generation:  0.0024614334106445312
mini_batch_src_global generation:  0.008175134658813477
r_  generation:  0.11485958099365234
local_output_nid generation:  0.002046823501586914
local_in_edges_tensor generation:  0.0024912357330322266
mini_batch_src_global generation:  0.008311986923217773
r_  generation:  0.11694931983947754
local_output_nid generation:  0.002054929733276367
local_in_edges_tensor generation:  0.0025811195373535156
mini_batch_src_global generation:  0.008102178573608398
r_  generation:  0.1148076057434082
local_output_nid generation:  0.0020465850830078125
local_in_edges_tensor generation:  0.002499103546142578
mini_batch_src_global generation:  0.008332490921020508
r_  generation:  0.11502647399902344
local_output_nid generation:  0.0020368099212646484
local_in_edges_tensor generation:  0.002466917037963867
mini_batch_src_global generation:  0.008092641830444336
r_  generation:  0.11429166793823242
local_output_nid generation:  0.002047300338745117
local_in_edges_tensor generation:  0.0024793148040771484
mini_batch_src_global generation:  0.008222341537475586
r_  generation:  0.11510634422302246
local_output_nid generation:  0.0020589828491210938
local_in_edges_tensor generation:  0.0024940967559814453
mini_batch_src_global generation:  0.008637666702270508
r_  generation:  0.11902904510498047
local_output_nid generation:  0.002025127410888672
local_in_edges_tensor generation:  0.0025587081909179688
mini_batch_src_global generation:  0.008260250091552734
r_  generation:  0.11634683609008789
local_output_nid generation:  0.0020279884338378906
local_in_edges_tensor generation:  0.0024764537811279297
mini_batch_src_global generation:  0.008609533309936523
r_  generation:  0.11694598197937012
local_output_nid generation:  0.0020303726196289062
local_in_edges_tensor generation:  0.0025153160095214844
mini_batch_src_global generation:  0.0084381103515625
r_  generation:  0.1200876235961914
local_output_nid generation:  0.002026081085205078
local_in_edges_tensor generation:  0.0024924278259277344
mini_batch_src_global generation:  0.008541345596313477
r_  generation:  0.11666703224182129
local_output_nid generation:  0.0018851757049560547
local_in_edges_tensor generation:  0.0359807014465332
mini_batch_src_global generation:  0.008544921875
r_  generation:  0.11636924743652344
local_output_nid generation:  0.0018541812896728516
local_in_edges_tensor generation:  0.005511283874511719
mini_batch_src_global generation:  0.008257627487182617
r_  generation:  0.11952590942382812
local_output_nid generation:  0.0018744468688964844
local_in_edges_tensor generation:  0.005154609680175781
mini_batch_src_global generation:  0.00878596305847168
r_  generation:  0.11511850357055664
local_output_nid generation:  0.0018720626831054688
local_in_edges_tensor generation:  0.0048902034759521484
mini_batch_src_global generation:  0.00848388671875
r_  generation:  0.11682963371276855
local_output_nid generation:  0.0018689632415771484
local_in_edges_tensor generation:  0.004614353179931641
mini_batch_src_global generation:  0.008707523345947266
r_  generation:  0.11626577377319336
local_output_nid generation:  0.001882791519165039
local_in_edges_tensor generation:  0.00439000129699707
mini_batch_src_global generation:  0.008543252944946289
r_  generation:  0.11736822128295898
local_output_nid generation:  0.0018610954284667969
local_in_edges_tensor generation:  0.006637096405029297
mini_batch_src_global generation:  0.008426189422607422
r_  generation:  0.11994290351867676
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.006200551986694336
mini_batch_src_global generation:  0.008517742156982422
r_  generation:  0.11628150939941406
local_output_nid generation:  0.0019397735595703125
local_in_edges_tensor generation:  0.005808353424072266
mini_batch_src_global generation:  0.008544445037841797
r_  generation:  0.11612105369567871
local_output_nid generation:  0.0018792152404785156
local_in_edges_tensor generation:  0.00540614128112793
mini_batch_src_global generation:  0.008453845977783203
r_  generation:  0.1214606761932373
local_output_nid generation:  0.001873016357421875
local_in_edges_tensor generation:  0.005035400390625
mini_batch_src_global generation:  0.008702516555786133
r_  generation:  0.11609911918640137
local_output_nid generation:  0.0018656253814697266
local_in_edges_tensor generation:  0.00473475456237793
mini_batch_src_global generation:  0.008455514907836914
r_  generation:  0.11745405197143555
local_output_nid generation:  0.0018837451934814453
local_in_edges_tensor generation:  0.004557371139526367
mini_batch_src_global generation:  0.008853435516357422
r_  generation:  0.11980223655700684
local_output_nid generation:  0.0018701553344726562
local_in_edges_tensor generation:  0.004319429397583008
mini_batch_src_global generation:  0.008640289306640625
r_  generation:  0.11659717559814453
local_output_nid generation:  0.0018856525421142578
local_in_edges_tensor generation:  0.0040378570556640625
mini_batch_src_global generation:  0.008512020111083984
r_  generation:  0.11813592910766602
local_output_nid generation:  0.0018668174743652344
local_in_edges_tensor generation:  0.003874540328979492
mini_batch_src_global generation:  0.008775472640991211
r_  generation:  0.11918020248413086
local_output_nid generation:  0.0024123191833496094
local_in_edges_tensor generation:  0.0036933422088623047
mini_batch_src_global generation:  0.011048316955566406
r_  generation:  0.11702466011047363
local_output_nid generation:  0.0026874542236328125
local_in_edges_tensor generation:  0.0035903453826904297
mini_batch_src_global generation:  0.008796215057373047
r_  generation:  0.11804342269897461
local_output_nid generation:  0.0020415782928466797
local_in_edges_tensor generation:  0.0036499500274658203
mini_batch_src_global generation:  0.00864863395690918
r_  generation:  0.11900568008422852
local_output_nid generation:  0.0019176006317138672
local_in_edges_tensor generation:  0.0032737255096435547
mini_batch_src_global generation:  0.008473873138427734
r_  generation:  0.1183629035949707
local_output_nid generation:  0.001909494400024414
local_in_edges_tensor generation:  0.0032427310943603516
mini_batch_src_global generation:  0.008677482604980469
r_  generation:  0.11774778366088867
local_output_nid generation:  0.0018966197967529297
local_in_edges_tensor generation:  0.0030829906463623047
mini_batch_src_global generation:  0.00842428207397461
r_  generation:  0.12139201164245605
local_output_nid generation:  0.0018951892852783203
local_in_edges_tensor generation:  0.002971649169921875
mini_batch_src_global generation:  0.00868368148803711
r_  generation:  0.1053457260131836
local_output_nid generation:  0.0018885135650634766
local_in_edges_tensor generation:  0.002928018569946289
mini_batch_src_global generation:  0.008867025375366211
r_  generation:  0.1170353889465332
local_output_nid generation:  0.0018906593322753906
local_in_edges_tensor generation:  0.002886056900024414
mini_batch_src_global generation:  0.008626461029052734
r_  generation:  0.11804342269897461
local_output_nid generation:  0.0018858909606933594
local_in_edges_tensor generation:  0.0028176307678222656
mini_batch_src_global generation:  0.008555889129638672
r_  generation:  0.12123227119445801
local_output_nid generation:  0.0018916130065917969
local_in_edges_tensor generation:  0.002797365188598633
mini_batch_src_global generation:  0.00873565673828125
r_  generation:  0.11780786514282227
local_output_nid generation:  0.0020055770874023438
local_in_edges_tensor generation:  0.002790689468383789
mini_batch_src_global generation:  0.008797168731689453
r_  generation:  0.1189420223236084
local_output_nid generation:  0.001893758773803711
local_in_edges_tensor generation:  0.0027971267700195312
mini_batch_src_global generation:  0.008664131164550781
r_  generation:  0.11847925186157227
local_output_nid generation:  0.0018889904022216797
local_in_edges_tensor generation:  0.0030188560485839844
mini_batch_src_global generation:  0.008522987365722656
r_  generation:  0.12000513076782227
local_output_nid generation:  0.0019049644470214844
local_in_edges_tensor generation:  0.002687692642211914
mini_batch_src_global generation:  0.011256933212280273
r_  generation:  0.13021349906921387
local_output_nid generation:  0.0018982887268066406
local_in_edges_tensor generation:  0.003576040267944336
mini_batch_src_global generation:  0.008921146392822266
r_  generation:  0.128448486328125
local_output_nid generation:  0.0019006729125976562
local_in_edges_tensor generation:  0.008696317672729492
mini_batch_src_global generation:  0.02492046356201172
r_  generation:  0.12231302261352539
local_output_nid generation:  0.001922607421875
local_in_edges_tensor generation:  0.012501716613769531
mini_batch_src_global generation:  0.009629011154174805
r_  generation:  0.1184854507446289
local_output_nid generation:  0.002983570098876953
local_in_edges_tensor generation:  0.011360645294189453
mini_batch_src_global generation:  0.009218692779541016
r_  generation:  0.1051187515258789
----------------------check_connections_block total spend ----------------------------- 10.10401439666748
generate_one_block  5.6915364265441895
generate_one_block  0.12373471260070801
generate_one_block  0.13305211067199707
generate_one_block  0.12456345558166504
generate_one_block  0.1253812313079834
generate_one_block  0.12676239013671875
generate_one_block  0.12627458572387695
generate_one_block  0.1246175765991211
generate_one_block  0.1259911060333252
generate_one_block  0.12769055366516113
generate_one_block  0.1301441192626953
generate_one_block  0.139265775680542
generate_one_block  0.14160633087158203
generate_one_block  0.12911438941955566
generate_one_block  0.12953424453735352
generate_one_block  0.12557363510131836
generate_one_block  0.12624883651733398
generate_one_block  0.1266310214996338
generate_one_block  0.12908411026000977
generate_one_block  0.12526226043701172
generate_one_block  0.12712526321411133
generate_one_block  0.18459796905517578
generate_one_block  0.17147016525268555
generate_one_block  0.1827559471130371
generate_one_block  0.18445897102355957
generate_one_block  0.15116190910339355
generate_one_block  0.16646790504455566
generate_one_block  0.17205190658569336
generate_one_block  0.14915895462036133
generate_one_block  0.1371908187866211
generate_one_block  0.13484740257263184
generate_one_block  0.12874841690063477
generate_one_block  0.12768769264221191
generate_one_block  0.12849807739257812
generate_one_block  0.1478254795074463
generate_one_block  0.12803030014038086
generate_one_block  0.12751030921936035
generate_one_block  0.12460947036743164
generate_one_block  0.1281447410583496
generate_one_block  0.12691807746887207
generate_one_block  0.12751269340515137
generate_one_block  0.1282670497894287
generate_one_block  0.13363027572631836
generate_one_block  0.12915539741516113
generate_one_block  0.12905645370483398
generate_one_block  0.12758088111877441
generate_one_block  0.1280500888824463
generate_one_block  0.1261439323425293
generate_one_block  0.12848329544067383
generate_one_block  0.12729835510253906
generate_one_block  0.1273946762084961
generate_one_block  0.12907671928405762
generate_one_block  0.1273341178894043
generate_one_block  0.12790822982788086
generate_one_block  0.1287686824798584
generate_one_block  0.12640929222106934
generate_one_block  0.13007020950317383
generate_one_block  0.12830781936645508
generate_one_block  0.1235342025756836
generate_one_block  0.12789392471313477
generate_one_block  0.12790679931640625
generate_one_block  0.12917661666870117
generate_one_block  0.1265096664428711
generate_one_block  0.12342453002929688
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2471415996551514
gen group dst list time:  0.3339500427246094
time for parepare:  0.48174190521240234
local_output_nid generation:  0.06494784355163574
local_in_edges_tensor generation:  0.2743706703186035
mini_batch_src_global generation:  0.19271588325500488
r_  generation:  2.3421411514282227
local_output_nid generation:  0.1033620834350586
local_in_edges_tensor generation:  0.26349472999572754
mini_batch_src_global generation:  0.24875545501708984
r_  generation:  2.4504315853118896
local_output_nid generation:  0.0645902156829834
local_in_edges_tensor generation:  0.29202795028686523
mini_batch_src_global generation:  0.24370646476745605
r_  generation:  2.5223724842071533
local_output_nid generation:  0.09456872940063477
local_in_edges_tensor generation:  0.2883188724517822
mini_batch_src_global generation:  0.24056625366210938
r_  generation:  2.569746494293213
local_output_nid generation:  0.06592226028442383
local_in_edges_tensor generation:  0.2466268539428711
mini_batch_src_global generation:  0.2540853023529053
r_  generation:  2.647888660430908
local_output_nid generation:  0.1057741641998291
local_in_edges_tensor generation:  0.22237586975097656
mini_batch_src_global generation:  0.25714540481567383
r_  generation:  2.580796718597412
local_output_nid generation:  0.06445550918579102
local_in_edges_tensor generation:  0.17715954780578613
mini_batch_src_global generation:  0.26381921768188477
r_  generation:  2.585799217224121
local_output_nid generation:  0.06351113319396973
local_in_edges_tensor generation:  0.16533350944519043
mini_batch_src_global generation:  0.2724120616912842
r_  generation:  2.603327751159668
local_output_nid generation:  0.06338334083557129
local_in_edges_tensor generation:  0.16396856307983398
mini_batch_src_global generation:  0.2657766342163086
r_  generation:  2.625810146331787
local_output_nid generation:  0.0633232593536377
local_in_edges_tensor generation:  0.22810864448547363
mini_batch_src_global generation:  0.2680838108062744
r_  generation:  2.663579225540161
local_output_nid generation:  0.09281802177429199
local_in_edges_tensor generation:  0.2076890468597412
mini_batch_src_global generation:  0.2726726531982422
r_  generation:  2.630115270614624
local_output_nid generation:  0.06515812873840332
local_in_edges_tensor generation:  0.16929292678833008
mini_batch_src_global generation:  0.27294254302978516
r_  generation:  2.6255300045013428
local_output_nid generation:  0.06399345397949219
local_in_edges_tensor generation:  0.16391611099243164
mini_batch_src_global generation:  0.27619481086730957
r_  generation:  2.6758902072906494
local_output_nid generation:  0.06347179412841797
local_in_edges_tensor generation:  0.1586308479309082
mini_batch_src_global generation:  0.273118257522583
r_  generation:  2.656721830368042
local_output_nid generation:  0.06429576873779297
local_in_edges_tensor generation:  0.20546889305114746
mini_batch_src_global generation:  0.2749507427215576
r_  generation:  2.6796953678131104
local_output_nid generation:  0.0634455680847168
local_in_edges_tensor generation:  0.21128249168395996
mini_batch_src_global generation:  0.3011336326599121
r_  generation:  2.6675939559936523
local_output_nid generation:  0.09180259704589844
local_in_edges_tensor generation:  0.17089223861694336
mini_batch_src_global generation:  0.2730274200439453
r_  generation:  2.616746664047241
local_output_nid generation:  0.06875038146972656
local_in_edges_tensor generation:  0.1598825454711914
mini_batch_src_global generation:  0.2736344337463379
r_  generation:  2.618731737136841
local_output_nid generation:  0.06314945220947266
local_in_edges_tensor generation:  0.16015219688415527
mini_batch_src_global generation:  0.27667713165283203
r_  generation:  2.6185998916625977
local_output_nid generation:  0.06371665000915527
local_in_edges_tensor generation:  0.15606236457824707
mini_batch_src_global generation:  0.2749147415161133
r_  generation:  2.6527111530303955
local_output_nid generation:  0.06300687789916992
local_in_edges_tensor generation:  0.19521450996398926
mini_batch_src_global generation:  0.27769994735717773
r_  generation:  2.6753735542297363
local_output_nid generation:  0.06330609321594238
local_in_edges_tensor generation:  0.21076273918151855
mini_batch_src_global generation:  0.2755610942840576
r_  generation:  2.701495885848999
local_output_nid generation:  0.09165024757385254
local_in_edges_tensor generation:  0.17380189895629883
mini_batch_src_global generation:  0.27248620986938477
r_  generation:  2.6291861534118652
local_output_nid generation:  0.06495141983032227
local_in_edges_tensor generation:  0.16442394256591797
mini_batch_src_global generation:  0.27605676651000977
r_  generation:  2.6404225826263428
local_output_nid generation:  0.06396770477294922
local_in_edges_tensor generation:  0.1631319522857666
mini_batch_src_global generation:  0.2814452648162842
r_  generation:  2.6778831481933594
local_output_nid generation:  0.06347870826721191
local_in_edges_tensor generation:  0.1570291519165039
mini_batch_src_global generation:  0.2755622863769531
r_  generation:  2.666142225265503
local_output_nid generation:  0.06313061714172363
local_in_edges_tensor generation:  0.19518685340881348
mini_batch_src_global generation:  0.27531957626342773
r_  generation:  2.6451027393341064
local_output_nid generation:  0.06374812126159668
local_in_edges_tensor generation:  0.19296836853027344
mini_batch_src_global generation:  0.2788808345794678
r_  generation:  2.7079434394836426
local_output_nid generation:  0.09268665313720703
local_in_edges_tensor generation:  0.18676066398620605
mini_batch_src_global generation:  0.2786245346069336
r_  generation:  2.638253688812256
local_output_nid generation:  0.06511187553405762
local_in_edges_tensor generation:  0.16772031784057617
mini_batch_src_global generation:  0.27655673027038574
r_  generation:  2.646613121032715
local_output_nid generation:  0.06466245651245117
local_in_edges_tensor generation:  0.16593265533447266
mini_batch_src_global generation:  0.279890775680542
r_  generation:  2.6974432468414307
local_output_nid generation:  0.06329989433288574
local_in_edges_tensor generation:  0.15803313255310059
mini_batch_src_global generation:  0.27638888359069824
r_  generation:  2.6665241718292236
local_output_nid generation:  0.06321978569030762
local_in_edges_tensor generation:  0.20284128189086914
mini_batch_src_global generation:  0.27507495880126953
r_  generation:  2.6803314685821533
local_output_nid generation:  0.06357383728027344
local_in_edges_tensor generation:  0.2108619213104248
mini_batch_src_global generation:  0.275684118270874
r_  generation:  2.6772282123565674
local_output_nid generation:  0.09188199043273926
local_in_edges_tensor generation:  0.1712052822113037
mini_batch_src_global generation:  0.27678418159484863
r_  generation:  2.641601324081421
local_output_nid generation:  0.06501960754394531
local_in_edges_tensor generation:  0.16288995742797852
mini_batch_src_global generation:  0.34747767448425293
r_  generation:  2.923787832260132
local_output_nid generation:  0.1028599739074707
local_in_edges_tensor generation:  0.25312232971191406
mini_batch_src_global generation:  0.2944321632385254
r_  generation:  2.8118133544921875
local_output_nid generation:  0.07424473762512207
local_in_edges_tensor generation:  0.24650144577026367
mini_batch_src_global generation:  0.31438183784484863
r_  generation:  2.623908519744873
local_output_nid generation:  0.08039188385009766
local_in_edges_tensor generation:  0.1793811321258545
mini_batch_src_global generation:  0.3482396602630615
r_  generation:  2.941864252090454
local_output_nid generation:  0.09494400024414062
local_in_edges_tensor generation:  0.25197696685791016
mini_batch_src_global generation:  0.2927892208099365
r_  generation:  2.873673915863037
local_output_nid generation:  0.09191036224365234
local_in_edges_tensor generation:  0.2568380832672119
mini_batch_src_global generation:  0.27710437774658203
r_  generation:  2.637181043624878
local_output_nid generation:  0.0673060417175293
local_in_edges_tensor generation:  0.17937827110290527
mini_batch_src_global generation:  0.296781063079834
r_  generation:  2.872962474822998
local_output_nid generation:  0.09273672103881836
local_in_edges_tensor generation:  0.25038886070251465
mini_batch_src_global generation:  0.27905964851379395
r_  generation:  2.7644920349121094
local_output_nid generation:  0.06580233573913574
local_in_edges_tensor generation:  0.24657177925109863
mini_batch_src_global generation:  0.30446338653564453
r_  generation:  2.6409003734588623
local_output_nid generation:  0.07988786697387695
local_in_edges_tensor generation:  0.17684340476989746
mini_batch_src_global generation:  0.2784085273742676
r_  generation:  2.6813480854034424
local_output_nid generation:  0.06365418434143066
local_in_edges_tensor generation:  0.17424511909484863
mini_batch_src_global generation:  0.28948974609375
r_  generation:  2.7280609607696533
local_output_nid generation:  0.06279253959655762
local_in_edges_tensor generation:  0.24633240699768066
mini_batch_src_global generation:  0.29752254486083984
r_  generation:  2.6267735958099365
local_output_nid generation:  0.08269381523132324
local_in_edges_tensor generation:  0.17569994926452637
mini_batch_src_global generation:  0.27457213401794434
r_  generation:  2.6264090538024902
local_output_nid generation:  0.06368756294250488
local_in_edges_tensor generation:  0.1638805866241455
mini_batch_src_global generation:  0.2791259288787842
r_  generation:  2.643183946609497
local_output_nid generation:  0.06310462951660156
local_in_edges_tensor generation:  0.16177606582641602
mini_batch_src_global generation:  0.28393006324768066
r_  generation:  2.66151762008667
local_output_nid generation:  0.06326794624328613
local_in_edges_tensor generation:  0.17915844917297363
mini_batch_src_global generation:  0.28858470916748047
r_  generation:  2.669048547744751
local_output_nid generation:  0.06207609176635742
local_in_edges_tensor generation:  0.18981361389160156
mini_batch_src_global generation:  0.2879600524902344
r_  generation:  2.643678903579712
local_output_nid generation:  0.09148240089416504
local_in_edges_tensor generation:  0.2101898193359375
mini_batch_src_global generation:  0.2739851474761963
r_  generation:  2.625746965408325
local_output_nid generation:  0.06393241882324219
local_in_edges_tensor generation:  0.1740882396697998
mini_batch_src_global generation:  0.2760441303253174
r_  generation:  2.6339845657348633
local_output_nid generation:  0.06310820579528809
local_in_edges_tensor generation:  0.16115665435791016
mini_batch_src_global generation:  0.28003573417663574
r_  generation:  2.631537675857544
local_output_nid generation:  0.06342005729675293
local_in_edges_tensor generation:  0.1613175868988037
mini_batch_src_global generation:  0.283919095993042
r_  generation:  2.6609041690826416
local_output_nid generation:  0.06515622138977051
local_in_edges_tensor generation:  0.15560460090637207
mini_batch_src_global generation:  0.2764859199523926
r_  generation:  2.628937244415283
local_output_nid generation:  0.06391167640686035
local_in_edges_tensor generation:  0.21672368049621582
mini_batch_src_global generation:  0.2974562644958496
r_  generation:  2.682006597518921
local_output_nid generation:  0.06229209899902344
local_in_edges_tensor generation:  0.21281909942626953
mini_batch_src_global generation:  0.28647637367248535
r_  generation:  2.6310946941375732
local_output_nid generation:  0.0817251205444336
local_in_edges_tensor generation:  0.17041873931884766
mini_batch_src_global generation:  0.2761118412017822
r_  generation:  2.636906623840332
local_output_nid generation:  0.06416201591491699
local_in_edges_tensor generation:  0.16154932975769043
mini_batch_src_global generation:  0.2788095474243164
r_  generation:  2.634518623352051
local_output_nid generation:  0.06352734565734863
local_in_edges_tensor generation:  0.1656339168548584
mini_batch_src_global generation:  0.2756338119506836
r_  generation:  2.6796374320983887
local_output_nid generation:  0.06299662590026855
local_in_edges_tensor generation:  0.15645289421081543
mini_batch_src_global generation:  0.2773120403289795
r_  generation:  2.691776990890503
local_output_nid generation:  0.06174731254577637
local_in_edges_tensor generation:  0.20053553581237793
mini_batch_src_global generation:  0.3016326427459717
r_  generation:  2.6156139373779297
----------------------check_connections_block total spend ----------------------------- 237.92980647087097
generate_one_block  3.7343287467956543
generate_one_block  3.799779176712036
generate_one_block  3.320816993713379
generate_one_block  3.3453710079193115
generate_one_block  3.3140738010406494
generate_one_block  3.413097858428955
generate_one_block  3.6214303970336914
generate_one_block  3.3467905521392822
generate_one_block  3.3253769874572754
generate_one_block  3.312433958053589
generate_one_block  3.3447346687316895
generate_one_block  3.3239967823028564
generate_one_block  3.3247039318084717
generate_one_block  3.5145490169525146
generate_one_block  3.6381423473358154
generate_one_block  3.314276695251465
generate_one_block  3.293839693069458
generate_one_block  3.2869510650634766
generate_one_block  3.5062415599823
generate_one_block  3.7708852291107178
generate_one_block  3.6990175247192383
generate_one_block  3.4015119075775146
generate_one_block  3.335516929626465
generate_one_block  3.341717481613159
generate_one_block  3.84043025970459
generate_one_block  3.3944692611694336
generate_one_block  3.720794677734375
generate_one_block  3.8435144424438477
generate_one_block  3.36155104637146
generate_one_block  3.7488317489624023
generate_one_block  3.383471727371216
generate_one_block  3.2987284660339355
generate_one_block  3.3032145500183105
generate_one_block  3.361328363418579
generate_one_block  3.427159309387207
generate_one_block  3.8168389797210693
generate_one_block  3.777531623840332
generate_one_block  3.2740790843963623
generate_one_block  3.368528127670288
generate_one_block  3.323207139968872
generate_one_block  3.828294515609741
generate_one_block  3.3276145458221436
generate_one_block  3.317746162414551
generate_one_block  3.304248571395874
generate_one_block  3.343313455581665
generate_one_block  3.3232128620147705
generate_one_block  3.653292179107666
generate_one_block  3.3930718898773193
generate_one_block  3.309885025024414
generate_one_block  3.3261399269104004
generate_one_block  3.328380584716797
generate_one_block  3.309385299682617
generate_one_block  3.362154960632324
generate_one_block  3.7571210861206055
generate_one_block  3.3564953804016113
generate_one_block  3.399492025375366
generate_one_block  3.7175755500793457
generate_one_block  3.42936110496521
generate_one_block  3.292384386062622
generate_one_block  3.3702147006988525
generate_one_block  3.6876232624053955
generate_one_block  3.457498550415039
generate_one_block  3.3151581287384033
generate_one_block  3.254850387573242
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.39611554145813
gen group dst list time:  2.625927209854126
time for parepare:  0.4817540645599365
local_output_nid generation:  0.41304492950439453
local_in_edges_tensor generation:  0.9667339324951172
mini_batch_src_global generation:  0.8386845588684082
r_  generation:  10.607414960861206
local_output_nid generation:  0.4442250728607178
local_in_edges_tensor generation:  0.9414894580841064
mini_batch_src_global generation:  1.045091152191162
r_  generation:  10.870521068572998
local_output_nid generation:  0.4314844608306885
local_in_edges_tensor generation:  1.1004464626312256
mini_batch_src_global generation:  1.0757005214691162
r_  generation:  10.839673042297363
local_output_nid generation:  0.41760802268981934
local_in_edges_tensor generation:  0.797492265701294
mini_batch_src_global generation:  1.2418742179870605
r_  generation:  11.459297895431519
local_output_nid generation:  0.44730257987976074
local_in_edges_tensor generation:  0.9142992496490479
mini_batch_src_global generation:  1.1040897369384766
r_  generation:  11.175431251525879
local_output_nid generation:  0.4283106327056885
local_in_edges_tensor generation:  0.9308509826660156
mini_batch_src_global generation:  1.1585280895233154
r_  generation:  10.875216722488403
local_output_nid generation:  0.4258382320404053
local_in_edges_tensor generation:  0.7972064018249512
mini_batch_src_global generation:  1.220069169998169
r_  generation:  10.943295240402222
local_output_nid generation:  0.44590115547180176
local_in_edges_tensor generation:  0.9128892421722412
mini_batch_src_global generation:  1.0752406120300293
r_  generation:  11.216492414474487
local_output_nid generation:  0.4228401184082031
local_in_edges_tensor generation:  0.9369800090789795
mini_batch_src_global generation:  1.1146044731140137
r_  generation:  10.915640592575073
local_output_nid generation:  0.42263364791870117
local_in_edges_tensor generation:  0.804379940032959
mini_batch_src_global generation:  1.2545254230499268
r_  generation:  11.088326454162598
local_output_nid generation:  0.4499380588531494
local_in_edges_tensor generation:  0.9175941944122314
mini_batch_src_global generation:  1.0823421478271484
r_  generation:  11.133497953414917
local_output_nid generation:  0.42418885231018066
local_in_edges_tensor generation:  0.9360926151275635
mini_batch_src_global generation:  1.118788480758667
r_  generation:  10.817938327789307
local_output_nid generation:  0.4420490264892578
local_in_edges_tensor generation:  0.7979252338409424
mini_batch_src_global generation:  1.1278164386749268
r_  generation:  11.180153369903564
local_output_nid generation:  0.44965577125549316
local_in_edges_tensor generation:  0.9128077030181885
mini_batch_src_global generation:  1.097923755645752
r_  generation:  10.907560348510742
local_output_nid generation:  0.414294958114624
local_in_edges_tensor generation:  0.8207154273986816
mini_batch_src_global generation:  1.2138433456420898
r_  generation:  10.978317975997925
local_output_nid generation:  0.4460000991821289
local_in_edges_tensor generation:  0.8993473052978516
mini_batch_src_global generation:  1.0784733295440674
r_  generation:  11.167218446731567
local_output_nid generation:  0.430574893951416
local_in_edges_tensor generation:  0.9422957897186279
mini_batch_src_global generation:  1.100168228149414
r_  generation:  10.801177024841309
local_output_nid generation:  0.41475534439086914
local_in_edges_tensor generation:  0.8031895160675049
mini_batch_src_global generation:  1.1714329719543457
r_  generation:  11.085985660552979
local_output_nid generation:  0.44896411895751953
local_in_edges_tensor generation:  0.914771556854248
mini_batch_src_global generation:  1.0779180526733398
r_  generation:  11.113139390945435
local_output_nid generation:  0.4204597473144531
local_in_edges_tensor generation:  0.9189848899841309
mini_batch_src_global generation:  1.1300079822540283
r_  generation:  10.769291400909424
local_output_nid generation:  0.44124650955200195
local_in_edges_tensor generation:  0.7982432842254639
mini_batch_src_global generation:  1.2773311138153076
r_  generation:  11.368545293807983
local_output_nid generation:  0.4424622058868408
local_in_edges_tensor generation:  0.931617021560669
mini_batch_src_global generation:  1.1116604804992676
r_  generation:  10.946287631988525
local_output_nid generation:  0.4033997058868408
local_in_edges_tensor generation:  0.8672504425048828
mini_batch_src_global generation:  1.1804273128509521
r_  generation:  10.811404943466187
local_output_nid generation:  0.44187235832214355
local_in_edges_tensor generation:  0.856569766998291
mini_batch_src_global generation:  1.0770618915557861
r_  generation:  11.255499362945557
local_output_nid generation:  0.42299342155456543
local_in_edges_tensor generation:  0.9373335838317871
mini_batch_src_global generation:  1.1020286083221436
r_  generation:  10.868641376495361
local_output_nid generation:  0.4112222194671631
local_in_edges_tensor generation:  0.8124608993530273
mini_batch_src_global generation:  1.2145161628723145
r_  generation:  10.925449132919312
local_output_nid generation:  0.43718647956848145
local_in_edges_tensor generation:  0.8972985744476318
mini_batch_src_global generation:  1.074052095413208
r_  generation:  11.196264028549194
local_output_nid generation:  0.4213383197784424
local_in_edges_tensor generation:  0.9348630905151367
mini_batch_src_global generation:  1.1207704544067383
r_  generation:  10.841346025466919
local_output_nid generation:  0.41510653495788574
local_in_edges_tensor generation:  0.8017735481262207
mini_batch_src_global generation:  1.2655894756317139
r_  generation:  10.90557599067688
local_output_nid generation:  0.4427669048309326
local_in_edges_tensor generation:  0.9231529235839844
mini_batch_src_global generation:  1.0803782939910889
r_  generation:  11.227614879608154
local_output_nid generation:  0.4368774890899658
local_in_edges_tensor generation:  0.9358584880828857
mini_batch_src_global generation:  1.112128496170044
r_  generation:  10.814523696899414
local_output_nid generation:  0.41970276832580566
local_in_edges_tensor generation:  0.7993566989898682
mini_batch_src_global generation:  1.1762287616729736
r_  generation:  11.056704044342041
local_output_nid generation:  0.4381906986236572
local_in_edges_tensor generation:  0.9047801494598389
mini_batch_src_global generation:  1.073594331741333
r_  generation:  11.083636283874512
local_output_nid generation:  0.41170763969421387
local_in_edges_tensor generation:  0.9186391830444336
mini_batch_src_global generation:  1.118182897567749
r_  generation:  10.761276960372925
local_output_nid generation:  0.43009233474731445
local_in_edges_tensor generation:  0.8000049591064453
mini_batch_src_global generation:  1.1330254077911377
r_  generation:  11.209596872329712
local_output_nid generation:  0.45144081115722656
local_in_edges_tensor generation:  0.9193429946899414
mini_batch_src_global generation:  1.0846378803253174
r_  generation:  10.930203914642334
local_output_nid generation:  0.39763450622558594
local_in_edges_tensor generation:  0.797623872756958
mini_batch_src_global generation:  1.2280786037445068
r_  generation:  10.899446487426758
local_output_nid generation:  0.44275879859924316
local_in_edges_tensor generation:  0.9138422012329102
mini_batch_src_global generation:  1.0777931213378906
r_  generation:  11.244609594345093
local_output_nid generation:  0.4213736057281494
local_in_edges_tensor generation:  0.9427094459533691
mini_batch_src_global generation:  1.1069185733795166
r_  generation:  10.828420877456665
local_output_nid generation:  0.4113779067993164
local_in_edges_tensor generation:  0.7945642471313477
mini_batch_src_global generation:  1.137282371520996
r_  generation:  11.13540530204773
local_output_nid generation:  0.44318485260009766
local_in_edges_tensor generation:  0.909616231918335
mini_batch_src_global generation:  1.071357011795044
r_  generation:  11.075003623962402
local_output_nid generation:  0.39939141273498535
local_in_edges_tensor generation:  0.911409854888916
mini_batch_src_global generation:  1.1060857772827148
r_  generation:  10.903057336807251
local_output_nid generation:  0.44245457649230957
local_in_edges_tensor generation:  0.7961075305938721
mini_batch_src_global generation:  1.1550371646881104
r_  generation:  11.162840127944946
local_output_nid generation:  0.44289278984069824
local_in_edges_tensor generation:  0.9253947734832764
mini_batch_src_global generation:  1.0864593982696533
r_  generation:  10.918627738952637
local_output_nid generation:  0.4014878273010254
local_in_edges_tensor generation:  0.7925655841827393
mini_batch_src_global generation:  1.2611217498779297
r_  generation:  10.860738039016724
local_output_nid generation:  0.44510507583618164
local_in_edges_tensor generation:  0.9157805442810059
mini_batch_src_global generation:  1.11478853225708
r_  generation:  11.189614295959473
local_output_nid generation:  0.4095127582550049
local_in_edges_tensor generation:  0.9100940227508545
mini_batch_src_global generation:  1.0919177532196045
r_  generation:  10.739035844802856
local_output_nid generation:  0.43184685707092285
local_in_edges_tensor generation:  0.8061432838439941
mini_batch_src_global generation:  1.1258258819580078
r_  generation:  11.190700769424438
local_output_nid generation:  0.45012831687927246
local_in_edges_tensor generation:  0.9040899276733398
mini_batch_src_global generation:  1.101142406463623
r_  generation:  10.84586477279663Using backend: pytorch

local_output_nid generation:  0.40421175956726074
local_in_edges_tensor generation:  0.8005070686340332
mini_batch_src_global generation:  1.1677725315093994
r_  generation:  11.070678234100342
local_output_nid generation:  0.43924832344055176
local_in_edges_tensor generation:  0.9125525951385498
mini_batch_src_global generation:  1.0780525207519531
r_  generation:  11.142694473266602
local_output_nid generation:  0.4058346748352051
local_in_edges_tensor generation:  0.9171452522277832
mini_batch_src_global generation:  1.099168300628662
r_  generation:  10.725230693817139
local_output_nid generation:  0.43805599212646484
local_in_edges_tensor generation:  0.7937638759613037
mini_batch_src_global generation:  1.1283068656921387
r_  generation:  11.186644792556763
local_output_nid generation:  0.450789213180542
local_in_edges_tensor generation:  0.9185037612915039
mini_batch_src_global generation:  1.0847606658935547
r_  generation:  10.928860902786255
local_output_nid generation:  0.3975253105163574
local_in_edges_tensor generation:  0.7863059043884277
mini_batch_src_global generation:  1.2383592128753662
r_  generation:  10.782903671264648
local_output_nid generation:  0.4449641704559326
local_in_edges_tensor generation:  0.9241368770599365
mini_batch_src_global generation:  1.1441333293914795
r_  generation:  11.174898386001587
local_output_nid generation:  0.43399763107299805
local_in_edges_tensor generation:  0.931114673614502
mini_batch_src_global generation:  1.106337070465088
r_  generation:  10.837181091308594
local_output_nid generation:  0.42607545852661133
local_in_edges_tensor generation:  4.247380971908569
mini_batch_src_global generation:  1.154792308807373
r_  generation:  10.950525760650635
local_output_nid generation:  0.43903326988220215
local_in_edges_tensor generation:  0.9132869243621826
mini_batch_src_global generation:  1.0826401710510254
r_  generation:  10.904129028320312
local_output_nid generation:  0.3980250358581543
local_in_edges_tensor generation:  0.8023433685302734
mini_batch_src_global generation:  1.204387903213501
r_  generation:  11.06660008430481
local_output_nid generation:  0.44829273223876953
local_in_edges_tensor generation:  0.9176037311553955
mini_batch_src_global generation:  1.1640288829803467
r_  generation:  11.105835199356079
local_output_nid generation:  0.4247572422027588
local_in_edges_tensor generation:  0.9526822566986084
mini_batch_src_global generation:  1.1135199069976807
r_  generation:  10.86906886100769
local_output_nid generation:  0.41849756240844727
local_in_edges_tensor generation:  0.8169205188751221
mini_batch_src_global generation:  1.1361095905303955
r_  generation:  11.06971549987793
local_output_nid generation:  0.4406402111053467
local_in_edges_tensor generation:  0.9106950759887695
mini_batch_src_global generation:  1.1729490756988525
r_  generation:  11.40155816078186
----------------------check_connections_block total spend ----------------------------- 989.1262147426605
generate_one_block  15.054975748062134
generate_one_block  15.690213203430176
generate_one_block  15.068805932998657
generate_one_block  14.590728759765625
generate_one_block  15.16877007484436
generate_one_block  14.925540447235107
generate_one_block  14.542351007461548
generate_one_block  15.303492307662964
generate_one_block  15.701903104782104
generate_one_block  15.1911780834198
generate_one_block  14.552015781402588
generate_one_block  15.129819393157959
generate_one_block  15.450928211212158
generate_one_block  14.939144849777222
generate_one_block  15.124619245529175
generate_one_block  14.946551084518433
generate_one_block  14.994050025939941
generate_one_block  14.578192710876465
generate_one_block  14.961378335952759
generate_one_block  14.936006784439087
generate_one_block  14.559285163879395
generate_one_block  15.070788860321045
generate_one_block  14.957687377929688
generate_one_block  14.639702320098877
generate_one_block  15.199084043502808
generate_one_block  15.246024370193481
generate_one_block  14.534081935882568
generate_one_block  15.122170448303223
generate_one_block  14.998529434204102
generate_one_block  14.730704307556152
generate_one_block  15.15756607055664
generate_one_block  15.11787486076355
generate_one_block  14.619396448135376
generate_one_block  15.060392141342163
generate_one_block  15.120282888412476
generate_one_block  15.199029922485352
generate_one_block  14.725101232528687
generate_one_block  15.062521696090698
generate_one_block  15.426631689071655
generate_one_block  14.970530271530151
generate_one_block  14.676809787750244
generate_one_block  15.260832071304321
generate_one_block  15.004707336425781
generate_one_block  14.80109167098999
generate_one_block  15.02336859703064
generate_one_block  15.08603024482727
generate_one_block  15.094473361968994
generate_one_block  15.00105333328247
generate_one_block  14.636565208435059
generate_one_block  15.329874038696289
generate_one_block  14.965566396713257
generate_one_block  14.805219888687134
generate_one_block  15.279075622558594
generate_one_block  15.153842210769653
generate_one_block  14.515190601348877
generate_one_block  15.129699230194092
generate_one_block  15.275765895843506
generate_one_block  15.027514934539795
generate_one_block  14.652243614196777
generate_one_block  15.130456924438477
generate_one_block  15.193513870239258
generate_one_block  15.045940399169922
generate_one_block  14.66724419593811
generate_one_block  15.102632761001587
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

connection checking time:  1227.0560212135315
block generation total time  1181.2645404338837
average batch blocks generation time:  18.457258444279432
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0867919921875 GB
    Memory Allocated: 0.9897708892822266  GigaBytes
Max Memory Allocated: 0.9897708892822266  GigaBytes

Traceback (most recent call last):
  File "pseudo_mini_batch_range_products_sage.py", line 455, in <module>
    main()
  File "pseudo_mini_batch_range_products_sage.py", line 451, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_products_sage.py", line 276, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_products.py", line 48, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 20.72 GiB already allocated; 3.44 MiB free; 21.14 GiB reserved in total by PyTorch)
