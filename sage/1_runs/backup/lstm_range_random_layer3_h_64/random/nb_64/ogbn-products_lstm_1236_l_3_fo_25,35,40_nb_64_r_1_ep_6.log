main start at this time 1648186202.1897054
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4016244411468506
random selection method range initialization spend 0.013844013214111328
time for parepare:  0.2769026756286621
local_output_nid generation:  0.0017795562744140625
local_in_edges_tensor generation:  0.02150440216064453
mini_batch_src_global generation:  0.0036695003509521484
r_  generation:  0.04161787033081055
local_output_nid generation:  0.0018777847290039062
local_in_edges_tensor generation:  0.0018525123596191406
mini_batch_src_global generation:  0.004224300384521484
r_  generation:  0.04259634017944336
local_output_nid generation:  0.0018563270568847656
local_in_edges_tensor generation:  0.0018341541290283203
mini_batch_src_global generation:  0.0026216506958007812
r_  generation:  0.04347562789916992
local_output_nid generation:  0.0018658638000488281
local_in_edges_tensor generation:  0.001825094223022461
mini_batch_src_global generation:  0.0025873184204101562
r_  generation:  0.04478955268859863
local_output_nid generation:  0.0018754005432128906
local_in_edges_tensor generation:  0.0018248558044433594
mini_batch_src_global generation:  0.0026400089263916016
r_  generation:  0.044713735580444336
local_output_nid generation:  0.0018587112426757812
local_in_edges_tensor generation:  0.0018336772918701172
mini_batch_src_global generation:  0.002666950225830078
r_  generation:  0.04590582847595215
local_output_nid generation:  0.0018680095672607422
local_in_edges_tensor generation:  0.0018870830535888672
mini_batch_src_global generation:  0.002729654312133789
r_  generation:  0.04655909538269043
local_output_nid generation:  0.0018832683563232422
local_in_edges_tensor generation:  0.001786947250366211
mini_batch_src_global generation:  0.0027964115142822266
r_  generation:  0.04647016525268555
local_output_nid generation:  0.0018799304962158203
local_in_edges_tensor generation:  0.0017695426940917969
mini_batch_src_global generation:  0.0028815269470214844
r_  generation:  0.047293901443481445
local_output_nid generation:  0.0018858909606933594
local_in_edges_tensor generation:  0.0018310546875
mini_batch_src_global generation:  0.002931833267211914
r_  generation:  0.04612994194030762
local_output_nid generation:  0.0018799304962158203
local_in_edges_tensor generation:  0.001813650131225586
mini_batch_src_global generation:  0.0029680728912353516
r_  generation:  0.04686450958251953
local_output_nid generation:  0.0018711090087890625
local_in_edges_tensor generation:  0.008198738098144531
mini_batch_src_global generation:  0.003220081329345703
r_  generation:  0.04717898368835449
local_output_nid generation:  0.0018706321716308594
local_in_edges_tensor generation:  0.0067920684814453125
mini_batch_src_global generation:  0.003145933151245117
r_  generation:  0.04967641830444336
local_output_nid generation:  0.0018877983093261719
local_in_edges_tensor generation:  0.011840105056762695
mini_batch_src_global generation:  0.00351715087890625
r_  generation:  0.048870086669921875
local_output_nid generation:  0.0018739700317382812
local_in_edges_tensor generation:  0.009745597839355469
mini_batch_src_global generation:  0.0034797191619873047
r_  generation:  0.049262285232543945
local_output_nid generation:  0.0018932819366455078
local_in_edges_tensor generation:  0.008365392684936523
mini_batch_src_global generation:  0.003507852554321289
r_  generation:  0.048073768615722656
local_output_nid generation:  0.0018696784973144531
local_in_edges_tensor generation:  0.007130861282348633
mini_batch_src_global generation:  0.003592252731323242
r_  generation:  0.04973912239074707
local_output_nid generation:  0.0018854141235351562
local_in_edges_tensor generation:  0.006064891815185547
mini_batch_src_global generation:  0.0036208629608154297
r_  generation:  0.0501246452331543
local_output_nid generation:  0.0018591880798339844
local_in_edges_tensor generation:  0.005161762237548828
mini_batch_src_global generation:  0.0036134719848632812
r_  generation:  0.050116539001464844
local_output_nid generation:  0.0018608570098876953
local_in_edges_tensor generation:  0.004477262496948242
mini_batch_src_global generation:  0.0035359859466552734
r_  generation:  0.05089855194091797
local_output_nid generation:  0.0018706321716308594
local_in_edges_tensor generation:  0.003966569900512695
mini_batch_src_global generation:  0.003621339797973633
r_  generation:  0.050878286361694336
local_output_nid generation:  0.0018787384033203125
local_in_edges_tensor generation:  0.0038352012634277344
mini_batch_src_global generation:  0.003482341766357422
r_  generation:  0.05041313171386719
local_output_nid generation:  0.0018627643585205078
local_in_edges_tensor generation:  0.0033714771270751953
mini_batch_src_global generation:  0.003597259521484375
r_  generation:  0.05242323875427246
local_output_nid generation:  0.0018661022186279297
local_in_edges_tensor generation:  0.0031435489654541016
mini_batch_src_global generation:  0.003699064254760742
r_  generation:  0.051108598709106445
local_output_nid generation:  0.0018646717071533203
local_in_edges_tensor generation:  0.0027437210083007812
mini_batch_src_global generation:  0.003562450408935547
r_  generation:  0.05136895179748535
local_output_nid generation:  0.0018694400787353516
local_in_edges_tensor generation:  0.0024976730346679688
mini_batch_src_global generation:  0.0037322044372558594
r_  generation:  0.05103611946105957
local_output_nid generation:  0.0018787384033203125
local_in_edges_tensor generation:  0.0025072097778320312
mini_batch_src_global generation:  0.003707408905029297
r_  generation:  0.05096578598022461
local_output_nid generation:  0.0018763542175292969
local_in_edges_tensor generation:  0.0023157596588134766
mini_batch_src_global generation:  0.0035800933837890625
r_  generation:  0.05191469192504883
local_output_nid generation:  0.0018646717071533203
local_in_edges_tensor generation:  0.002184152603149414
mini_batch_src_global generation:  0.00374603271484375
r_  generation:  0.051424264907836914
local_output_nid generation:  0.0018589496612548828
local_in_edges_tensor generation:  0.022320985794067383
mini_batch_src_global generation:  0.0034377574920654297
r_  generation:  0.05169796943664551
local_output_nid generation:  0.0018558502197265625
local_in_edges_tensor generation:  0.0019872188568115234
mini_batch_src_global generation:  0.0036928653717041016
r_  generation:  0.05470728874206543
local_output_nid generation:  0.0018820762634277344
local_in_edges_tensor generation:  0.0027055740356445312
mini_batch_src_global generation:  0.003936290740966797
r_  generation:  0.05176281929016113
local_output_nid generation:  0.0018656253814697266
local_in_edges_tensor generation:  0.0019497871398925781
mini_batch_src_global generation:  0.003572702407836914
r_  generation:  0.05180191993713379
local_output_nid generation:  0.001850128173828125
local_in_edges_tensor generation:  0.001905679702758789
mini_batch_src_global generation:  0.003868579864501953
r_  generation:  0.051679134368896484
local_output_nid generation:  0.0018813610076904297
local_in_edges_tensor generation:  0.0019075870513916016
mini_batch_src_global generation:  0.003590822219848633
r_  generation:  0.05196118354797363
local_output_nid generation:  0.0018575191497802734
local_in_edges_tensor generation:  0.0018792152404785156
mini_batch_src_global generation:  0.003644704818725586
r_  generation:  0.0515289306640625
local_output_nid generation:  0.001873016357421875
local_in_edges_tensor generation:  0.0018458366394042969
mini_batch_src_global generation:  0.0038068294525146484
r_  generation:  0.05480766296386719
local_output_nid generation:  0.002871274948120117
local_in_edges_tensor generation:  0.0019073486328125
mini_batch_src_global generation:  0.0035161972045898438
r_  generation:  0.05143260955810547
local_output_nid generation:  0.00193023681640625
local_in_edges_tensor generation:  0.0017523765563964844
mini_batch_src_global generation:  0.003826618194580078
r_  generation:  0.05077338218688965
local_output_nid generation:  0.00186920166015625
local_in_edges_tensor generation:  0.0017693042755126953
mini_batch_src_global generation:  0.003621339797973633
r_  generation:  0.050142526626586914
local_output_nid generation:  0.0018815994262695312
local_in_edges_tensor generation:  0.0018429756164550781
mini_batch_src_global generation:  0.003488302230834961
r_  generation:  0.052889108657836914
local_output_nid generation:  0.0018603801727294922
local_in_edges_tensor generation:  0.0017235279083251953
mini_batch_src_global generation:  0.0038580894470214844
r_  generation:  0.05089735984802246
local_output_nid generation:  0.0018720626831054688
local_in_edges_tensor generation:  0.0017154216766357422
mini_batch_src_global generation:  0.0034224987030029297
r_  generation:  0.05178976058959961
local_output_nid generation:  0.0018680095672607422
local_in_edges_tensor generation:  0.0017552375793457031
mini_batch_src_global generation:  0.003699779510498047
r_  generation:  0.05230379104614258
local_output_nid generation:  0.0018703937530517578
local_in_edges_tensor generation:  0.0018475055694580078
mini_batch_src_global generation:  0.003787994384765625
r_  generation:  0.05199098587036133
local_output_nid generation:  0.0034284591674804688
local_in_edges_tensor generation:  0.0017306804656982422
mini_batch_src_global generation:  0.0036432743072509766
r_  generation:  0.05086159706115723
local_output_nid generation:  0.002106904983520508
local_in_edges_tensor generation:  0.0017278194427490234
mini_batch_src_global generation:  0.003870725631713867
r_  generation:  0.051886796951293945
local_output_nid generation:  0.0019333362579345703
local_in_edges_tensor generation:  0.0017437934875488281
mini_batch_src_global generation:  0.0035505294799804688
r_  generation:  0.0517425537109375
local_output_nid generation:  0.0019085407257080078
local_in_edges_tensor generation:  0.0016946792602539062
mini_batch_src_global generation:  0.003741025924682617
r_  generation:  0.051424503326416016
local_output_nid generation:  0.0019001960754394531
local_in_edges_tensor generation:  0.0017893314361572266
mini_batch_src_global generation:  0.003854513168334961
r_  generation:  0.05132460594177246
local_output_nid generation:  0.0019023418426513672
local_in_edges_tensor generation:  0.0017163753509521484
mini_batch_src_global generation:  0.003642559051513672
r_  generation:  0.051598310470581055
local_output_nid generation:  0.0018863677978515625
local_in_edges_tensor generation:  0.0019006729125976562
mini_batch_src_global generation:  0.0038552284240722656
r_  generation:  0.05080819129943848
local_output_nid generation:  0.0019023418426513672
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.0036995410919189453
r_  generation:  0.052584171295166016
local_output_nid generation:  0.0018990039825439453
local_in_edges_tensor generation:  0.0017437934875488281
mini_batch_src_global generation:  0.0037288665771484375
r_  generation:  0.052164316177368164
local_output_nid generation:  0.0019004344940185547
local_in_edges_tensor generation:  0.0017521381378173828
mini_batch_src_global generation:  0.003916025161743164
r_  generation:  0.05093812942504883
local_output_nid generation:  0.0018756389617919922
local_in_edges_tensor generation:  0.0018172264099121094
mini_batch_src_global generation:  0.0034906864166259766
r_  generation:  0.05339646339416504
local_output_nid generation:  0.0019102096557617188
local_in_edges_tensor generation:  0.0016891956329345703
mini_batch_src_global generation:  0.003793478012084961
r_  generation:  0.051741600036621094
local_output_nid generation:  0.0018885135650634766
local_in_edges_tensor generation:  0.0017292499542236328
mini_batch_src_global generation:  0.0038156509399414062
r_  generation:  0.05272173881530762
local_output_nid generation:  0.0019054412841796875
local_in_edges_tensor generation:  0.0017218589782714844
mini_batch_src_global generation:  0.0036966800689697266
r_  generation:  0.05278730392456055
local_output_nid generation:  0.0018947124481201172
local_in_edges_tensor generation:  0.001741170883178711
mini_batch_src_global generation:  0.003947257995605469
r_  generation:  0.050878047943115234
local_output_nid generation:  0.0019092559814453125
local_in_edges_tensor generation:  0.0017635822296142578
mini_batch_src_global generation:  0.0035865306854248047
r_  generation:  0.052031517028808594
local_output_nid generation:  0.001894235610961914
local_in_edges_tensor generation:  0.0017445087432861328
mini_batch_src_global generation:  0.0036313533782958984
r_  generation:  0.05354762077331543
local_output_nid generation:  0.0019040107727050781
local_in_edges_tensor generation:  0.001735687255859375
mini_batch_src_global generation:  0.0038640499114990234
r_  generation:  0.05366110801696777
local_output_nid generation:  0.0018305778503417969
local_in_edges_tensor generation:  0.0016925334930419922
mini_batch_src_global generation:  0.003493785858154297
r_  generation:  0.049948930740356445
----------------------check_connections_block total spend ----------------------------- 4.749394655227661
generate_one_block  5.531875848770142
generate_one_block  0.06847500801086426
generate_one_block  0.07213282585144043
generate_one_block  0.06786823272705078
generate_one_block  0.06788063049316406
generate_one_block  0.0683286190032959
generate_one_block  0.0681619644165039
generate_one_block  0.06831026077270508
generate_one_block  0.0692605972290039
generate_one_block  0.06847071647644043
generate_one_block  0.0695343017578125
generate_one_block  0.06812787055969238
generate_one_block  0.06834077835083008
generate_one_block  0.06809473037719727
generate_one_block  0.06859421730041504
generate_one_block  0.06804585456848145
generate_one_block  0.06815361976623535
generate_one_block  0.06727337837219238
generate_one_block  0.069244384765625
generate_one_block  0.0682687759399414
generate_one_block  0.08108854293823242
generate_one_block  0.0740211009979248
generate_one_block  0.06998062133789062
generate_one_block  0.06911349296569824
generate_one_block  0.06916427612304688
generate_one_block  0.06789016723632812
generate_one_block  0.06991028785705566
generate_one_block  0.068267822265625
generate_one_block  0.06811785697937012
generate_one_block  0.06852436065673828
generate_one_block  0.06876468658447266
generate_one_block  0.06924247741699219
generate_one_block  0.08980536460876465
generate_one_block  0.09325265884399414
generate_one_block  0.0869908332824707
generate_one_block  0.08093476295471191
generate_one_block  0.07588672637939453
generate_one_block  0.0731954574584961
generate_one_block  0.08759880065917969
generate_one_block  0.10276412963867188
generate_one_block  0.08891081809997559
generate_one_block  0.08330345153808594
generate_one_block  0.07630729675292969
generate_one_block  0.09262585639953613
generate_one_block  0.08321523666381836
generate_one_block  0.07770752906799316
generate_one_block  0.08943009376525879
generate_one_block  0.08353304862976074
generate_one_block  0.07953143119812012
generate_one_block  0.07647323608398438
generate_one_block  0.0733184814453125
generate_one_block  0.08610200881958008
generate_one_block  0.07976388931274414
generate_one_block  0.07852888107299805
generate_one_block  0.07436847686767578
generate_one_block  0.07311010360717773
generate_one_block  0.07188558578491211
generate_one_block  0.0707406997680664
generate_one_block  0.06841397285461426
generate_one_block  0.07063412666320801
generate_one_block  0.06894278526306152
generate_one_block  0.06866192817687988
generate_one_block  0.06838846206665039
generate_one_block  0.06678032875061035
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0712151527404785
gen group dst list time:  0.2067422866821289
time for parepare:  0.4650752544403076
local_output_nid generation:  0.052396535873413086
local_in_edges_tensor generation:  0.21071338653564453
mini_batch_src_global generation:  0.10898876190185547
r_  generation:  1.452108383178711
local_output_nid generation:  0.0861654281616211
local_in_edges_tensor generation:  0.10168766975402832
mini_batch_src_global generation:  0.1410527229309082
r_  generation:  1.5171358585357666
local_output_nid generation:  0.0658867359161377
local_in_edges_tensor generation:  0.10203409194946289
mini_batch_src_global generation:  0.13017559051513672
r_  generation:  1.576056957244873
local_output_nid generation:  0.06125521659851074
local_in_edges_tensor generation:  0.09882497787475586
mini_batch_src_global generation:  0.1311192512512207
r_  generation:  1.608548879623413
local_output_nid generation:  0.06038951873779297
local_in_edges_tensor generation:  0.19553923606872559
mini_batch_src_global generation:  0.1427595615386963
r_  generation:  1.6796445846557617
local_output_nid generation:  0.14557957649230957
local_in_edges_tensor generation:  0.09174919128417969
mini_batch_src_global generation:  0.14012813568115234
r_  generation:  1.6571786403656006
local_output_nid generation:  0.04529452323913574
local_in_edges_tensor generation:  0.10696125030517578
mini_batch_src_global generation:  0.149627685546875
r_  generation:  1.716355323791504
local_output_nid generation:  0.041320085525512695
local_in_edges_tensor generation:  0.11059141159057617
mini_batch_src_global generation:  0.1478574275970459
r_  generation:  1.7253403663635254
local_output_nid generation:  0.04843473434448242
local_in_edges_tensor generation:  0.14949870109558105
mini_batch_src_global generation:  0.16206645965576172
r_  generation:  1.6696937084197998
local_output_nid generation:  0.04916119575500488
local_in_edges_tensor generation:  0.08058547973632812
mini_batch_src_global generation:  0.15793609619140625
r_  generation:  1.6867146492004395
local_output_nid generation:  0.04085588455200195
local_in_edges_tensor generation:  0.09162044525146484
mini_batch_src_global generation:  0.17343497276306152
r_  generation:  1.6979613304138184
local_output_nid generation:  0.04042196273803711
local_in_edges_tensor generation:  0.05682945251464844
mini_batch_src_global generation:  0.15961956977844238
r_  generation:  1.719043493270874
local_output_nid generation:  0.04043459892272949
local_in_edges_tensor generation:  0.08609437942504883
mini_batch_src_global generation:  0.15517354011535645
r_  generation:  1.7424726486206055
local_output_nid generation:  0.040174007415771484
local_in_edges_tensor generation:  0.08060622215270996
mini_batch_src_global generation:  0.15784478187561035
r_  generation:  1.737339973449707
local_output_nid generation:  0.040741682052612305
local_in_edges_tensor generation:  0.10893845558166504
mini_batch_src_global generation:  0.16466832160949707
r_  generation:  1.7215125560760498
local_output_nid generation:  0.05488753318786621
local_in_edges_tensor generation:  0.10576558113098145
mini_batch_src_global generation:  0.16233611106872559
r_  generation:  1.7731120586395264
local_output_nid generation:  0.06080889701843262
local_in_edges_tensor generation:  0.08645248413085938
mini_batch_src_global generation:  0.1558668613433838
r_  generation:  1.699134349822998
local_output_nid generation:  0.0415339469909668
local_in_edges_tensor generation:  0.05928349494934082
mini_batch_src_global generation:  0.155409574508667
r_  generation:  1.6937434673309326
local_output_nid generation:  0.04312276840209961
local_in_edges_tensor generation:  0.06346535682678223
mini_batch_src_global generation:  0.15897607803344727
r_  generation:  1.726146936416626
local_output_nid generation:  0.040839433670043945
local_in_edges_tensor generation:  0.0615839958190918
mini_batch_src_global generation:  0.1558077335357666
r_  generation:  1.7071037292480469
local_output_nid generation:  0.04099297523498535
local_in_edges_tensor generation:  0.06999349594116211
mini_batch_src_global generation:  0.16845011711120605
r_  generation:  1.7342398166656494
local_output_nid generation:  0.04050087928771973
local_in_edges_tensor generation:  0.06208920478820801
mini_batch_src_global generation:  0.15575027465820312
r_  generation:  1.7395501136779785
local_output_nid generation:  0.04073166847229004
local_in_edges_tensor generation:  0.06393766403198242
mini_batch_src_global generation:  0.16166234016418457
r_  generation:  1.7284131050109863
local_output_nid generation:  0.040874481201171875
local_in_edges_tensor generation:  0.11942529678344727
mini_batch_src_global generation:  0.15647506713867188
r_  generation:  1.7426197528839111
local_output_nid generation:  0.04078555107116699
local_in_edges_tensor generation:  0.11120080947875977
mini_batch_src_global generation:  0.1601567268371582
r_  generation:  1.75596022605896
local_output_nid generation:  0.04881119728088379
local_in_edges_tensor generation:  0.10053658485412598
mini_batch_src_global generation:  0.15722227096557617
r_  generation:  1.7446553707122803
local_output_nid generation:  0.0578763484954834
local_in_edges_tensor generation:  0.06921267509460449
mini_batch_src_global generation:  0.1577599048614502
r_  generation:  1.7220478057861328
local_output_nid generation:  0.0419461727142334
local_in_edges_tensor generation:  0.06603622436523438
mini_batch_src_global generation:  0.16007709503173828
r_  generation:  1.7307536602020264
local_output_nid generation:  0.041066884994506836
local_in_edges_tensor generation:  0.0937507152557373
mini_batch_src_global generation:  0.16690993309020996
r_  generation:  1.7181510925292969
local_output_nid generation:  0.04123115539550781
local_in_edges_tensor generation:  0.054326534271240234
mini_batch_src_global generation:  0.1599750518798828
r_  generation:  1.7318432331085205
local_output_nid generation:  0.04094839096069336
local_in_edges_tensor generation:  0.06074666976928711
mini_batch_src_global generation:  0.16214370727539062
r_  generation:  1.7226762771606445
local_output_nid generation:  0.040551185607910156
local_in_edges_tensor generation:  0.07040214538574219
mini_batch_src_global generation:  0.16021251678466797
r_  generation:  1.7372429370880127
local_output_nid generation:  0.04077434539794922
local_in_edges_tensor generation:  0.06963920593261719
mini_batch_src_global generation:  0.17203617095947266
r_  generation:  1.7189829349517822
local_output_nid generation:  0.04059910774230957
local_in_edges_tensor generation:  0.11474871635437012
mini_batch_src_global generation:  0.15933775901794434
r_  generation:  1.742095708847046
local_output_nid generation:  0.040601253509521484
local_in_edges_tensor generation:  0.10147809982299805
mini_batch_src_global generation:  0.16530609130859375
r_  generation:  1.7805638313293457
local_output_nid generation:  0.06539011001586914
local_in_edges_tensor generation:  0.0969095230102539
mini_batch_src_global generation:  0.15985727310180664
r_  generation:  1.7363932132720947
local_output_nid generation:  0.04174685478210449
local_in_edges_tensor generation:  0.05830574035644531
mini_batch_src_global generation:  0.15777039527893066
r_  generation:  1.7413830757141113
local_output_nid generation:  0.03998255729675293
local_in_edges_tensor generation:  0.07334470748901367
mini_batch_src_global generation:  0.1554579734802246
r_  generation:  1.7193756103515625
local_output_nid generation:  0.041277408599853516
local_in_edges_tensor generation:  0.07171297073364258
mini_batch_src_global generation:  0.1594066619873047
r_  generation:  1.7147634029388428
local_output_nid generation:  0.04052448272705078
local_in_edges_tensor generation:  0.05313992500305176
mini_batch_src_global generation:  0.1587831974029541
r_  generation:  1.724653959274292
local_output_nid generation:  0.040902137756347656
local_in_edges_tensor generation:  0.060666561126708984
mini_batch_src_global generation:  0.15657258033752441
r_  generation:  1.7313616275787354
local_output_nid generation:  0.04088711738586426
local_in_edges_tensor generation:  0.08644580841064453
mini_batch_src_global generation:  0.19386625289916992
r_  generation:  1.7510626316070557
local_output_nid generation:  0.04069375991821289
local_in_edges_tensor generation:  0.06435298919677734
mini_batch_src_global generation:  0.15967392921447754
r_  generation:  1.745004415512085
local_output_nid generation:  0.0399627685546875
local_in_edges_tensor generation:  0.1312248706817627
mini_batch_src_global generation:  0.15958380699157715
r_  generation:  1.726379632949829
local_output_nid generation:  0.04879617691040039
local_in_edges_tensor generation:  0.10440301895141602
mini_batch_src_global generation:  0.1764235496520996
r_  generation:  1.759242296218872
local_output_nid generation:  0.05752062797546387
local_in_edges_tensor generation:  0.06192469596862793
mini_batch_src_global generation:  0.15908503532409668
r_  generation:  1.7169556617736816
local_output_nid generation:  0.041155099868774414
local_in_edges_tensor generation:  0.06716346740722656
mini_batch_src_global generation:  0.1590883731842041
r_  generation:  1.711219310760498
local_output_nid generation:  0.040924787521362305
local_in_edges_tensor generation:  0.06320071220397949
mini_batch_src_global generation:  0.16465473175048828
r_  generation:  1.7175953388214111
local_output_nid generation:  0.041106462478637695
local_in_edges_tensor generation:  0.07138705253601074
mini_batch_src_global generation:  0.15940213203430176
r_  generation:  1.7139880657196045
local_output_nid generation:  0.040984153747558594
local_in_edges_tensor generation:  0.053174734115600586
mini_batch_src_global generation:  0.1577458381652832
r_  generation:  1.7221038341522217
local_output_nid generation:  0.041266679763793945
local_in_edges_tensor generation:  0.0699307918548584
mini_batch_src_global generation:  0.15871953964233398
r_  generation:  1.7262609004974365
local_output_nid generation:  0.04012608528137207
local_in_edges_tensor generation:  0.05861783027648926
mini_batch_src_global generation:  0.1590898036956787
r_  generation:  1.7469162940979004
local_output_nid generation:  0.04083824157714844
local_in_edges_tensor generation:  0.07746315002441406
mini_batch_src_global generation:  0.15841984748840332
r_  generation:  1.767212152481079
local_output_nid generation:  0.04095315933227539
local_in_edges_tensor generation:  0.0868222713470459
mini_batch_src_global generation:  0.15968847274780273
r_  generation:  1.7265748977661133
local_output_nid generation:  0.04109835624694824
local_in_edges_tensor generation:  0.11357378959655762
mini_batch_src_global generation:  0.16157793998718262
r_  generation:  1.7613377571105957
local_output_nid generation:  0.04893064498901367
local_in_edges_tensor generation:  0.06816339492797852
mini_batch_src_global generation:  0.15640854835510254
r_  generation:  1.7384464740753174
local_output_nid generation:  0.04935622215270996
local_in_edges_tensor generation:  0.058919429779052734
mini_batch_src_global generation:  0.15650153160095215
r_  generation:  1.7004547119140625
local_output_nid generation:  0.04205775260925293
local_in_edges_tensor generation:  0.08650875091552734
mini_batch_src_global generation:  0.18033719062805176
r_  generation:  1.7440385818481445
local_output_nid generation:  0.04092216491699219
local_in_edges_tensor generation:  0.05269002914428711
mini_batch_src_global generation:  0.16048336029052734
r_  generation:  1.724738597869873
local_output_nid generation:  0.041080474853515625
local_in_edges_tensor generation:  0.08259963989257812
mini_batch_src_global generation:  0.15887212753295898
r_  generation:  1.7263545989990234
local_output_nid generation:  0.040563344955444336
local_in_edges_tensor generation:  0.07025718688964844
mini_batch_src_global generation:  0.16054439544677734
r_  generation:  1.7172966003417969
local_output_nid generation:  0.04102826118469238
local_in_edges_tensor generation:  0.07970571517944336
mini_batch_src_global generation:  0.15679669380187988
r_  generation:  1.7352488040924072
local_output_nid generation:  0.040856361389160156
local_in_edges_tensor generation:  0.0762789249420166
mini_batch_src_global generation:  0.16306233406066895
r_  generation:  1.7395577430725098
local_output_nid generation:  0.03945159912109375
local_in_edges_tensor generation:  0.05914044380187988
mini_batch_src_global generation:  0.17628121376037598
r_  generation:  1.7030503749847412
----------------------check_connections_block total spend ----------------------------- 148.61609959602356
generate_one_block  2.331350564956665
generate_one_block  2.268665075302124
generate_one_block  1.9307591915130615
generate_one_block  1.9853847026824951
generate_one_block  1.9333815574645996
generate_one_block  1.945868730545044
generate_one_block  1.9496614933013916
generate_one_block  1.9345264434814453
generate_one_block  1.9609313011169434
generate_one_block  1.9627671241760254
generate_one_block  1.986755132675171
generate_one_block  1.9531893730163574
generate_one_block  2.0072200298309326
generate_one_block  2.0456628799438477
generate_one_block  2.166053056716919
generate_one_block  2.039015531539917
generate_one_block  1.9279026985168457
generate_one_block  1.9166061878204346
generate_one_block  1.9368655681610107
generate_one_block  1.9493381977081299
generate_one_block  1.9419612884521484
generate_one_block  1.9494800567626953
generate_one_block  1.9186654090881348
generate_one_block  1.9516375064849854
generate_one_block  1.9738051891326904
generate_one_block  1.9442956447601318
generate_one_block  1.942812204360962
generate_one_block  2.2654483318328857
generate_one_block  1.9628593921661377
generate_one_block  2.1209239959716797
generate_one_block  2.1165010929107666
generate_one_block  2.0441980361938477
generate_one_block  1.9924356937408447
generate_one_block  1.945845603942871
generate_one_block  1.9661712646484375
generate_one_block  1.964836597442627
generate_one_block  1.9510178565979004
generate_one_block  1.9410450458526611
generate_one_block  1.9502177238464355
generate_one_block  1.950613021850586
generate_one_block  1.974130392074585
generate_one_block  1.9660451412200928
generate_one_block  1.9610772132873535
generate_one_block  1.9465363025665283
generate_one_block  1.9666273593902588
generate_one_block  1.990689992904663
generate_one_block  2.0977232456207275
generate_one_block  2.1213340759277344
generate_one_block  2.0223236083984375
generate_one_block  1.981231451034546
generate_one_block  1.9667189121246338
generate_one_block  1.9235405921936035
generate_one_block  1.9566748142242432
generate_one_block  2.0034615993499756
generate_one_block  1.9346668720245361
generate_one_block  1.967231273651123
generate_one_block  1.9318037033081055
generate_one_block  2.00274658203125
generate_one_block  1.9265029430389404
generate_one_block  1.9815452098846436
generate_one_block  1.9500057697296143
generate_one_block  1.9709904193878174
generate_one_block  1.994579792022705
generate_one_block  2.0811569690704346
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.129108190536499
gen group dst list time:  2.039989948272705
time for parepare:  0.48542213439941406
local_output_nid generation:  0.37934446334838867
local_in_edges_tensor generation:  0.9008643627166748
mini_batch_src_global generation:  0.6864652633666992
r_  generation:  9.19709300994873
local_output_nid generation:  0.38369011878967285
local_in_edges_tensor generation:  0.8432571887969971
mini_batch_src_global generation:  0.857933521270752
r_  generation:  9.4881112575531
local_output_nid generation:  0.38123202323913574
local_in_edges_tensor generation:  0.7816190719604492
mini_batch_src_global generation:  0.8598189353942871
r_  generation:  9.490541458129883
local_output_nid generation:  0.3507812023162842
local_in_edges_tensor generation:  0.7779974937438965
mini_batch_src_global generation:  0.924466609954834
r_  generation:  9.373042106628418
local_output_nid generation:  0.3670687675476074
local_in_edges_tensor generation:  0.6674931049346924
mini_batch_src_global generation:  0.8926219940185547
r_  generation:  9.357405424118042
local_output_nid generation:  0.339996337890625
local_in_edges_tensor generation:  0.6605319976806641
mini_batch_src_global generation:  0.9686732292175293
r_  generation:  9.353195905685425
local_output_nid generation:  0.34972214698791504
local_in_edges_tensor generation:  0.777949333190918
mini_batch_src_global generation:  0.905266284942627
r_  generation:  9.338431596755981
local_output_nid generation:  0.368471622467041
local_in_edges_tensor generation:  0.6672625541687012
mini_batch_src_global generation:  0.9024267196655273
r_  generation:  9.289957761764526
local_output_nid generation:  0.3416118621826172
local_in_edges_tensor generation:  0.6704730987548828
mini_batch_src_global generation:  1.0524280071258545
r_  generation:  9.320265769958496
local_output_nid generation:  0.3505082130432129
local_in_edges_tensor generation:  0.7979030609130859
mini_batch_src_global generation:  0.9208741188049316
r_  generation:  9.357780933380127
local_output_nid generation:  0.3659090995788574
local_in_edges_tensor generation:  0.6694307327270508
mini_batch_src_global generation:  0.902010440826416
r_  generation:  9.611779928207397
local_output_nid generation:  0.3357086181640625
local_in_edges_tensor generation:  0.7496328353881836
mini_batch_src_global generation:  0.9397337436676025
r_  generation:  9.315596103668213
local_output_nid generation:  0.35434865951538086
local_in_edges_tensor generation:  0.7012577056884766
mini_batch_src_global generation:  0.93170166015625
r_  generation:  9.327565431594849
local_output_nid generation:  0.350630521774292
local_in_edges_tensor generation:  0.6689879894256592
mini_batch_src_global generation:  0.8995578289031982
r_  generation:  9.646611213684082
local_output_nid generation:  0.3510570526123047
local_in_edges_tensor generation:  0.7887403964996338
mini_batch_src_global generation:  0.9065291881561279
r_  generation:  9.37896728515625
local_output_nid generation:  0.3664240837097168
local_in_edges_tensor generation:  0.6762716770172119
mini_batch_src_global generation:  0.9045376777648926
r_  generation:  9.263177871704102
local_output_nid generation:  0.33782410621643066
local_in_edges_tensor generation:  0.6627171039581299
mini_batch_src_global generation:  0.9435172080993652
r_  generation:  9.542465925216675
local_output_nid generation:  0.34813976287841797
local_in_edges_tensor generation:  0.7766153812408447
mini_batch_src_global generation:  0.9032416343688965
r_  generation:  9.376332998275757
local_output_nid generation:  0.3653419017791748
local_in_edges_tensor generation:  0.6681160926818848
mini_batch_src_global generation:  0.9015865325927734
r_  generation:  9.279996395111084
local_output_nid generation:  0.333418607711792
local_in_edges_tensor generation:  0.6641445159912109
mini_batch_src_global generation:  0.9313476085662842
r_  generation:  9.396836042404175
local_output_nid generation:  0.3472590446472168
local_in_edges_tensor generation:  0.7749180793762207
mini_batch_src_global generation:  0.9027774333953857
r_  generation:  9.320013523101807
local_output_nid generation:  0.3686368465423584
local_in_edges_tensor generation:  0.6690409183502197
mini_batch_src_global generation:  0.904120922088623
r_  generation:  9.364667654037476
local_output_nid generation:  0.33447265625
local_in_edges_tensor generation:  0.6612424850463867
mini_batch_src_global generation:  0.9770767688751221
r_  generation:  9.316296339035034
local_output_nid generation:  0.34897422790527344
local_in_edges_tensor generation:  0.796738862991333
mini_batch_src_global generation:  0.904609203338623
r_  generation:  9.356884956359863
local_output_nid generation:  0.3666341304779053
local_in_edges_tensor generation:  0.6682565212249756
mini_batch_src_global generation:  0.9039461612701416
r_  generation:  9.71007227897644
local_output_nid generation:  0.33858466148376465
local_in_edges_tensor generation:  0.7600629329681396
mini_batch_src_global generation:  0.9321517944335938
r_  generation:  9.332612991333008
local_output_nid generation:  0.36281871795654297
local_in_edges_tensor generation:  0.6961367130279541
mini_batch_src_global generation:  0.9038131237030029
r_  generation:  9.275777339935303
local_output_nid generation:  0.34929871559143066
local_in_edges_tensor generation:  0.6705951690673828
mini_batch_src_global generation:  0.9748873710632324
r_  generation:  9.64259123802185
local_output_nid generation:  0.3477590084075928
local_in_edges_tensor generation:  0.7825829982757568
mini_batch_src_global generation:  0.9039242267608643
r_  generation:  9.359070301055908
local_output_nid generation:  0.3695192337036133
local_in_edges_tensor generation:  0.6725044250488281
mini_batch_src_global generation:  0.9046120643615723
r_  generation:  9.437633275985718
local_output_nid generation:  0.3468198776245117
local_in_edges_tensor generation:  0.668792724609375
mini_batch_src_global generation:  0.933624267578125
r_  generation:  9.527989625930786
local_output_nid generation:  0.35059571266174316
local_in_edges_tensor generation:  0.7828867435455322
mini_batch_src_global generation:  0.9143221378326416
r_  generation:  9.424988031387329
local_output_nid generation:  0.366192102432251
local_in_edges_tensor generation:  0.6644289493560791
mini_batch_src_global generation:  1.024233341217041
r_  generation:  10.190528392791748
local_output_nid generation:  0.38101911544799805
local_in_edges_tensor generation:  0.8036584854125977
mini_batch_src_global generation:  1.1036064624786377
r_  generation:  9.627503156661987
local_output_nid generation:  0.3796966075897217
local_in_edges_tensor generation:  0.7777011394500732
mini_batch_src_global generation:  0.9044034481048584
r_  generation:  9.482714653015137
local_output_nid generation:  0.3384974002838135
local_in_edges_tensor generation:  0.6693112850189209
mini_batch_src_global generation:  1.0391974449157715
r_  generation:  9.39371109008789
local_output_nid generation:  0.3597896099090576
local_in_edges_tensor generation:  0.7939515113830566
mini_batch_src_global generation:  0.9114701747894287
r_  generation:  9.304148435592651
local_output_nid generation:  0.3508615493774414
local_in_edges_tensor generation:  0.6639842987060547
mini_batch_src_global generation:  0.9801537990570068
r_  generation:  9.602102756500244
local_output_nid generation:  0.3478255271911621
local_in_edges_tensor generation:  0.7843639850616455
mini_batch_src_global generation:  0.9116542339324951
r_  generation:  9.409496307373047
local_output_nid generation:  0.36458611488342285
local_in_edges_tensor generation:  0.6643366813659668
mini_batch_src_global generation:  0.9040517807006836
r_  generation:  9.290162801742554
local_output_nid generation:  0.33746814727783203
local_in_edges_tensor generation:  0.670008659362793
mini_batch_src_global generation:  0.9381699562072754
r_  generation:  9.55601716041565
local_output_nid generation:  0.3467710018157959
local_in_edges_tensor generation:  0.7780447006225586
mini_batch_src_global generation:  0.9040021896362305
r_  generation:  9.377874612808228
local_output_nid generation:  0.3651711940765381
local_in_edges_tensor generation:  0.6621251106262207
mini_batch_src_global generation:  0.9007053375244141
r_  generation:  9.401112079620361
local_output_nid generation:  0.3367130756378174
local_in_edges_tensor generation:  0.6642675399780273
mini_batch_src_global generation:  0.9158289432525635
r_  generation:  9.449284791946411
local_output_nid generation:  0.3469102382659912
local_in_edges_tensor generation:  0.7748591899871826
mini_batch_src_global generation:  0.9152426719665527
r_  generation:  9.252192258834839
local_output_nid generation:  0.363483190536499
local_in_edges_tensor generation:  0.667273759841919
mini_batch_src_global generation:  0.8960738182067871
r_  generation:  9.507615089416504
local_output_nid generation:  0.33220434188842773
local_in_edges_tensor generation:  0.6560332775115967
mini_batch_src_global generation:  0.9732635021209717
r_  generation:  9.391346216201782
local_output_nid generation:  0.3537614345550537
local_in_edges_tensor generation:  0.801091194152832
mini_batch_src_global generation:  0.9021422863006592
r_  generation:  9.34429669380188
local_output_nid generation:  0.3519856929779053
local_in_edges_tensor generation:  0.6625404357910156Using backend: pytorch

mini_batch_src_global generation:  0.9451675415039062
r_  generation:  9.54960036277771
local_output_nid generation:  0.34741854667663574
local_in_edges_tensor generation:  0.7808554172515869
mini_batch_src_global generation:  0.9131064414978027
r_  generation:  9.35957646369934
local_output_nid generation:  0.3662590980529785
local_in_edges_tensor generation:  0.667372465133667
mini_batch_src_global generation:  0.8987455368041992
r_  generation:  9.336105585098267
local_output_nid generation:  0.3334317207336426
local_in_edges_tensor generation:  0.6632218360900879
mini_batch_src_global generation:  0.9204661846160889
r_  generation:  9.604360580444336
local_output_nid generation:  0.34703969955444336
local_in_edges_tensor generation:  0.7725234031677246
mini_batch_src_global generation:  0.8992962837219238
r_  generation:  9.353201866149902
local_output_nid generation:  0.36695003509521484
local_in_edges_tensor generation:  0.6654360294342041
mini_batch_src_global generation:  0.9014108180999756
r_  generation:  9.449430465698242
local_output_nid generation:  0.33466267585754395
local_in_edges_tensor generation:  0.6573901176452637
mini_batch_src_global generation:  0.9300551414489746
r_  generation:  9.461107015609741
local_output_nid generation:  0.3601858615875244
local_in_edges_tensor generation:  0.7859456539154053
mini_batch_src_global generation:  0.9166831970214844
r_  generation:  9.329506397247314
local_output_nid generation:  0.3520514965057373
local_in_edges_tensor generation:  0.664560079574585
mini_batch_src_global generation:  0.9524388313293457
r_  generation:  9.588814735412598
local_output_nid generation:  0.3411567211151123
local_in_edges_tensor generation:  3.616828680038452
mini_batch_src_global generation:  0.9070048332214355
r_  generation:  9.4245285987854
local_output_nid generation:  0.3712942600250244
local_in_edges_tensor generation:  0.7003481388092041
mini_batch_src_global generation:  0.9049732685089111
r_  generation:  9.385339975357056
local_output_nid generation:  0.33376526832580566
local_in_edges_tensor generation:  0.6685113906860352
mini_batch_src_global generation:  0.9295270442962646
r_  generation:  9.607836484909058
local_output_nid generation:  0.3462209701538086
local_in_edges_tensor generation:  0.778106689453125
mini_batch_src_global generation:  0.9013814926147461
r_  generation:  9.315666913986206
local_output_nid generation:  0.36563920974731445
local_in_edges_tensor generation:  0.665522575378418
mini_batch_src_global generation:  0.898911714553833
r_  generation:  9.446581363677979
local_output_nid generation:  0.3364582061767578
local_in_edges_tensor generation:  0.6641604900360107
mini_batch_src_global generation:  0.9813554286956787
r_  generation:  9.4087553024292
local_output_nid generation:  0.3422660827636719
local_in_edges_tensor generation:  0.7979788780212402
mini_batch_src_global generation:  0.899773359298706
r_  generation:  9.16591191291809
----------------------check_connections_block total spend ----------------------------- 840.5975036621094
generate_one_block  12.758439064025879
generate_one_block  12.32205843925476
generate_one_block  12.793590068817139
generate_one_block  12.289921998977661
generate_one_block  12.66887378692627
generate_one_block  12.37402057647705
generate_one_block  12.34183406829834
generate_one_block  12.767748355865479
generate_one_block  12.48560357093811
generate_one_block  12.387164115905762
generate_one_block  12.757268190383911
generate_one_block  12.325843334197998
generate_one_block  13.53884506225586
generate_one_block  13.009593725204468
generate_one_block  12.809937477111816
generate_one_block  12.374503374099731
generate_one_block  12.217194557189941
generate_one_block  12.769327878952026
generate_one_block  12.206599235534668
generate_one_block  12.688109159469604
generate_one_block  12.343109607696533
generate_one_block  12.291244745254517
generate_one_block  12.697941064834595
generate_one_block  12.325674295425415
generate_one_block  12.785231590270996
generate_one_block  12.572272062301636
generate_one_block  12.537049293518066
generate_one_block  12.502064943313599
generate_one_block  12.28355073928833
generate_one_block  12.817724466323853
generate_one_block  12.297529220581055
generate_one_block  12.866206884384155
generate_one_block  12.385144710540771
generate_one_block  12.691937685012817
generate_one_block  12.429434299468994
generate_one_block  12.35125184059143
generate_one_block  12.76776647567749
generate_one_block  12.343177556991577
generate_one_block  13.00976276397705
generate_one_block  12.275228500366211
generate_one_block  12.762380838394165
generate_one_block  12.453835010528564
generate_one_block  12.616878986358643
generate_one_block  12.571473360061646
generate_one_block  12.298124313354492
generate_one_block  12.736058712005615
generate_one_block  12.233669996261597
generate_one_block  12.725513458251953
generate_one_block  12.344019651412964
generate_one_block  13.116791725158691
generate_one_block  12.822324514389038
generate_one_block  12.470794439315796
generate_one_block  12.752673149108887
generate_one_block  12.363529920578003
generate_one_block  12.618096351623535
generate_one_block  12.346386432647705
generate_one_block  12.722244262695312
generate_one_block  12.461445331573486
generate_one_block  12.799079418182373
generate_one_block  12.391236543655396
generate_one_block  12.75909161567688
generate_one_block  12.517547369003296
generate_one_block  12.79569935798645
generate_one_block  12.234535932540894
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

connection checking time:  989.2136032581329
block generation total time  931.9192295074463
average batch blocks generation time:  14.561237961053848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0008544921875 GB
    Memory Allocated: 0.9090309143066406  GigaBytes
Max Memory Allocated: 0.9090309143066406  GigaBytes

Traceback (most recent call last):
  File "pseudo_mini_batch_range_products_sage.py", line 455, in <module>
    main()
  File "pseudo_mini_batch_range_products_sage.py", line 451, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_products_sage.py", line 276, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_products.py", line 48, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 14.00 MiB (GPU 0; 23.62 GiB total capacity; 20.45 GiB already allocated; 3.44 MiB free; 21.18 GiB reserved in total by PyTorch)
