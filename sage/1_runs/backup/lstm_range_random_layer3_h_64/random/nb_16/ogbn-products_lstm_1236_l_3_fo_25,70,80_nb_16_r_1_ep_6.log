main start at this time 1648211642.5718973
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6657156944274902
random selection method range initialization spend 0.014557361602783203
time for parepare:  0.38782715797424316
local_output_nid generation:  0.017992496490478516
local_in_edges_tensor generation:  0.04131770133972168
mini_batch_src_global generation:  0.027103900909423828
r_  generation:  0.398897647857666
local_output_nid generation:  0.023615598678588867
local_in_edges_tensor generation:  0.019495010375976562
mini_batch_src_global generation:  0.03347611427307129
r_  generation:  0.4429447650909424
local_output_nid generation:  0.010555028915405273
local_in_edges_tensor generation:  0.01812291145324707
mini_batch_src_global generation:  0.04577755928039551
r_  generation:  0.44083452224731445
local_output_nid generation:  0.010786056518554688
local_in_edges_tensor generation:  0.009774446487426758
mini_batch_src_global generation:  0.025774478912353516
r_  generation:  0.4666321277618408
local_output_nid generation:  0.010632753372192383
local_in_edges_tensor generation:  0.009626626968383789
mini_batch_src_global generation:  0.02777409553527832
r_  generation:  0.48160672187805176
local_output_nid generation:  0.01079702377319336
local_in_edges_tensor generation:  0.04121518135070801
mini_batch_src_global generation:  0.030864477157592773
r_  generation:  0.5059967041015625
local_output_nid generation:  0.012807130813598633
local_in_edges_tensor generation:  0.03388786315917969
mini_batch_src_global generation:  0.03209829330444336
r_  generation:  0.5388007164001465
local_output_nid generation:  0.01776266098022461
local_in_edges_tensor generation:  0.02445077896118164
mini_batch_src_global generation:  0.033371925354003906
r_  generation:  0.5092301368713379
local_output_nid generation:  0.007568359375
local_in_edges_tensor generation:  0.01780986785888672
mini_batch_src_global generation:  0.0345613956451416
r_  generation:  0.5191202163696289
local_output_nid generation:  0.007626533508300781
local_in_edges_tensor generation:  0.017908811569213867
mini_batch_src_global generation:  0.03633761405944824
r_  generation:  0.552696943283081
local_output_nid generation:  0.0074901580810546875
local_in_edges_tensor generation:  0.022052764892578125
mini_batch_src_global generation:  0.04157543182373047
r_  generation:  0.5612068176269531
local_output_nid generation:  0.008379697799682617
local_in_edges_tensor generation:  0.023756027221679688
mini_batch_src_global generation:  0.050731658935546875
r_  generation:  0.5318043231964111
local_output_nid generation:  0.008567333221435547
local_in_edges_tensor generation:  0.01806497573852539
mini_batch_src_global generation:  0.040021657943725586
r_  generation:  0.5294022560119629
local_output_nid generation:  0.007232189178466797
local_in_edges_tensor generation:  0.01414179801940918
mini_batch_src_global generation:  0.04068589210510254
r_  generation:  0.5463149547576904
local_output_nid generation:  0.007246732711791992
local_in_edges_tensor generation:  0.011856317520141602
mini_batch_src_global generation:  0.04196500778198242
r_  generation:  0.5336933135986328
local_output_nid generation:  0.007271766662597656
local_in_edges_tensor generation:  0.01197052001953125
mini_batch_src_global generation:  0.04429364204406738
r_  generation:  0.5498757362365723
----------------------check_connections_block total spend ----------------------------- 11.049919605255127
generate_one_block  6.098610162734985
generate_one_block  0.4974193572998047
generate_one_block  0.5184919834136963
generate_one_block  0.5122931003570557
generate_one_block  0.5188643932342529
generate_one_block  0.552734375
generate_one_block  0.5116250514984131
generate_one_block  0.5579185485839844
generate_one_block  0.5505161285400391
generate_one_block  0.5066726207733154
generate_one_block  0.5396251678466797
generate_one_block  0.5060927867889404
generate_one_block  0.5146317481994629
generate_one_block  0.5614688396453857
generate_one_block  0.551203727722168
generate_one_block  0.5090427398681641
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.453707695007324
gen group dst list time:  0.22792959213256836
time for parepare:  0.4595506191253662
local_output_nid generation:  0.16178655624389648
local_in_edges_tensor generation:  0.8308238983154297
mini_batch_src_global generation:  0.8758766651153564
r_  generation:  10.453448295593262
local_output_nid generation:  0.20184993743896484
local_in_edges_tensor generation:  1.0687079429626465
mini_batch_src_global generation:  1.2103087902069092
r_  generation:  10.491864919662476
local_output_nid generation:  0.1993720531463623
local_in_edges_tensor generation:  0.8548414707183838
mini_batch_src_global generation:  1.2122061252593994
r_  generation:  10.702086687088013
local_output_nid generation:  0.16991806030273438
local_in_edges_tensor generation:  0.8236000537872314
mini_batch_src_global generation:  1.1102516651153564
r_  generation:  10.776712894439697
local_output_nid generation:  0.19674134254455566
local_in_edges_tensor generation:  0.6710331439971924
mini_batch_src_global generation:  1.2032592296600342
r_  generation:  10.858417272567749
local_output_nid generation:  0.1707606315612793
local_in_edges_tensor generation:  0.7911086082458496
mini_batch_src_global generation:  1.1218757629394531
r_  generation:  10.830146312713623
local_output_nid generation:  0.19911551475524902
local_in_edges_tensor generation:  0.7053713798522949
mini_batch_src_global generation:  1.1908199787139893
r_  generation:  11.038148164749146
local_output_nid generation:  0.1676485538482666
local_in_edges_tensor generation:  0.8351871967315674
mini_batch_src_global generation:  1.1487982273101807
r_  generation:  10.885164260864258
local_output_nid generation:  0.19325780868530273
local_in_edges_tensor generation:  0.6614022254943848
mini_batch_src_global generation:  1.2507400512695312
r_  generation:  10.983766555786133
local_output_nid generation:  0.17677617073059082
local_in_edges_tensor generation:  0.8343007564544678
mini_batch_src_global generation:  1.1672930717468262
r_  generation:  10.760071039199829
local_output_nid generation:  0.17856597900390625
local_in_edges_tensor generation:  0.661961555480957
mini_batch_src_global generation:  1.2440900802612305
r_  generation:  10.879852056503296
local_output_nid generation:  0.18219828605651855
local_in_edges_tensor generation:  0.827239990234375
mini_batch_src_global generation:  1.1691720485687256
r_  generation:  10.801563739776611
local_output_nid generation:  0.18099355697631836
local_in_edges_tensor generation:  0.6607577800750732
mini_batch_src_global generation:  1.2566168308258057
r_  generation:  10.824020385742188
local_output_nid generation:  0.19927263259887695
local_in_edges_tensor generation:  0.8323948383331299
mini_batch_src_global generation:  1.1562199592590332
r_  generation:  10.916279554367065
local_output_nid generation:  0.17132997512817383
local_in_edges_tensor generation:  0.6662662029266357
mini_batch_src_global generation:  1.2185146808624268
r_  generation:  10.795151472091675
local_output_nid generation:  0.2148275375366211
local_in_edges_tensor generation:  0.8360674381256104
mini_batch_src_global generation:  1.1452584266662598
r_  generation:  10.986989259719849
----------------------check_connections_block total spend ----------------------------- 236.24467396736145
generate_one_block  15.699903726577759
generate_one_block  15.236381530761719
generate_one_block  14.95913577079773
generate_one_block  15.06714153289795
generate_one_block  15.029160022735596
generate_one_block  14.624165534973145
generate_one_block Using backend: pytorch
 15.09746503829956
generate_one_block  15.257294654846191
generate_one_block  14.862634181976318
generate_one_block  15.137160778045654
generate_one_block  15.17790174484253
generate_one_block  14.588969469070435
generate_one_block  15.155457258224487
generate_one_block  15.175001859664917
generate_one_block  14.668028593063354
generate_one_block  15.244245529174805
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2318320274353027
gen group dst list time:  1.0781383514404297
time for parepare:  0.5108091831207275
local_output_nid generation:  0.6173269748687744
local_in_edges_tensor generation:  1.413388967514038
mini_batch_src_global generation:  1.173433780670166
r_  generation:  15.60978364944458
local_output_nid generation:  0.670135498046875
local_in_edges_tensor generation:  1.610121726989746
mini_batch_src_global generation:  1.6975452899932861
r_  generation:  15.701087236404419
local_output_nid generation:  0.6483960151672363
local_in_edges_tensor generation:  1.3338396549224854
mini_batch_src_global generation:  1.5417709350585938
r_  generation:  15.746716976165771
local_output_nid generation:  0.6484842300415039
local_in_edges_tensor generation:  1.2340636253356934
mini_batch_src_global generation:  1.7358033657073975
r_  generation:  15.795716285705566
local_output_nid generation:  0.6667819023132324
local_in_edges_tensor generation:  1.3024747371673584
mini_batch_src_global generation:  1.7781567573547363
r_  generation:  16.439059257507324
local_output_nid generation:  0.6646053791046143
local_in_edges_tensor generation:  2.6518571376800537
mini_batch_src_global generation:  1.5533647537231445
r_  generation:  15.816542148590088
local_output_nid generation:  0.6712899208068848
local_in_edges_tensor generation:  1.2833316326141357
mini_batch_src_global generation:  1.6807513236999512
r_  generation:  16.18234157562256
local_output_nid generation:  0.6679732799530029
local_in_edges_tensor generation:  1.3038485050201416
mini_batch_src_global generation:  1.7734856605529785
r_  generation:  15.902976512908936
local_output_nid generation:  0.6647679805755615
local_in_edges_tensor generation:  1.2976105213165283
mini_batch_src_global generation:  1.7012295722961426
r_  generation:  16.065727949142456
local_output_nid generation:  0.6530935764312744
local_in_edges_tensor generation:  1.2864608764648438
mini_batch_src_global generation:  1.7593932151794434
r_  generation:  16.01085329055786
local_output_nid generation:  0.6625328063964844
local_in_edges_tensor generation:  1.2968676090240479
mini_batch_src_global generation:  1.7034671306610107
r_  generation:  16.083521127700806
local_output_nid generation:  0.6517667770385742
local_in_edges_tensor generation:  1.2954833507537842
mini_batch_src_global generation:  1.7575993537902832
r_  generation:  15.865559816360474
local_output_nid generation:  0.6690130233764648
local_in_edges_tensor generation:  1.2950401306152344
mini_batch_src_global generation:  1.7133204936981201
r_  generation:  16.210798025131226
local_output_nid generation:  0.6769082546234131
local_in_edges_tensor generation:  1.2895276546478271
mini_batch_src_global generation:  1.779477596282959
r_  generation:  15.991795539855957
local_output_nid generation:  0.6687788963317871
local_in_edges_tensor generation:  1.3416452407836914
mini_batch_src_global generation:  1.7199466228485107
r_  generation:  16.217038869857788
local_output_nid generation:  0.647064208984375
local_in_edges_tensor generation:  1.2693872451782227
mini_batch_src_global generation:  1.7601919174194336
r_  generation:  16.065649032592773
----------------------check_connections_block total spend ----------------------------- 363.14403462409973
generate_one_block  21.69454789161682
generate_one_block  21.495158433914185
generate_one_block  21.559938669204712
generate_one_block  21.474879026412964
generate_one_block  21.38897466659546
generate_one_block  21.409907341003418
generate_one_block  22.257036209106445
generate_one_block  21.513739585876465
generate_one_block  21.432239532470703
generate_one_block  21.520949125289917
generate_one_block  21.606773376464844
generate_one_block  21.45807123184204
generate_one_block  21.465659141540527
generate_one_block  21.569727659225464
generate_one_block  21.5246365070343
generate_one_block  21.8104829788208
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

connection checking time:  599.3887085914612
block generation total time  586.1627686023712
average batch blocks generation time:  36.6351730376482
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4324951171875 GB
    Memory Allocated: 1.3267292976379395  GigaBytes
Max Memory Allocated: 1.3267292976379395  GigaBytes

Traceback (most recent call last):
  File "pseudo_mini_batch_range_products_sage.py", line 455, in <module>
    main()
  File "pseudo_mini_batch_range_products_sage.py", line 451, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_products_sage.py", line 276, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_products.py", line 48, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 58.00 MiB (GPU 0; 23.62 GiB total capacity; 20.76 GiB already allocated; 51.44 MiB free; 20.96 GiB reserved in total by PyTorch)
