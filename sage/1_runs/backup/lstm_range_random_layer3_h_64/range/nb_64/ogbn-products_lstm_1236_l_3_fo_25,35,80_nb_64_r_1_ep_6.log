main start at this time 1648270550.3258648
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6395981311798096
range selection method range initialization spend 0.028528213500976562
time for parepare:  0.36769676208496094
local_output_nid generation:  0.0009613037109375
local_in_edges_tensor generation:  0.03547263145446777
mini_batch_src_global generation:  0.006952047348022461
r_  generation:  0.08550453186035156
local_output_nid generation:  0.0010192394256591797
local_in_edges_tensor generation:  0.0014498233795166016
mini_batch_src_global generation:  0.011803627014160156
r_  generation:  0.09406280517578125
local_output_nid generation:  0.000985860824584961
local_in_edges_tensor generation:  0.0015001296997070312
mini_batch_src_global generation:  0.006905078887939453
r_  generation:  0.09176969528198242
local_output_nid generation:  0.0010187625885009766
local_in_edges_tensor generation:  0.0014226436614990234
mini_batch_src_global generation:  0.005560159683227539
r_  generation:  0.09259867668151855
local_output_nid generation:  0.0009949207305908203
local_in_edges_tensor generation:  0.001481771469116211
mini_batch_src_global generation:  0.005329608917236328
r_  generation:  0.09669923782348633
local_output_nid generation:  0.0010480880737304688
local_in_edges_tensor generation:  0.001644134521484375
mini_batch_src_global generation:  0.005536317825317383
r_  generation:  0.1004183292388916
local_output_nid generation:  0.0010020732879638672
local_in_edges_tensor generation:  0.0015876293182373047
mini_batch_src_global generation:  0.0060749053955078125
r_  generation:  0.10014772415161133
local_output_nid generation:  0.0010323524475097656
local_in_edges_tensor generation:  0.0015175342559814453
mini_batch_src_global generation:  0.005989551544189453
r_  generation:  0.10322427749633789
local_output_nid generation:  0.0009853839874267578
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.006430387496948242
r_  generation:  0.10166287422180176
local_output_nid generation:  0.0010123252868652344
local_in_edges_tensor generation:  0.0015869140625
mini_batch_src_global generation:  0.006920576095581055
r_  generation:  0.10678720474243164
local_output_nid generation:  0.0009984970092773438
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.006834268569946289
r_  generation:  0.10744857788085938
local_output_nid generation:  0.0009992122650146484
local_in_edges_tensor generation:  0.0015797615051269531
mini_batch_src_global generation:  0.0070667266845703125
r_  generation:  0.10639405250549316
local_output_nid generation:  0.0010097026824951172
local_in_edges_tensor generation:  0.0016105175018310547
mini_batch_src_global generation:  0.007327079772949219
r_  generation:  0.11131739616394043
local_output_nid generation:  0.0009989738464355469
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.00785374641418457
r_  generation:  0.11045598983764648
local_output_nid generation:  0.0009968280792236328
local_in_edges_tensor generation:  0.0014798641204833984
mini_batch_src_global generation:  0.007804155349731445
r_  generation:  0.11149144172668457
local_output_nid generation:  0.0009987354278564453
local_in_edges_tensor generation:  0.0016791820526123047
mini_batch_src_global generation:  0.008039474487304688
r_  generation:  0.1123201847076416
local_output_nid generation:  0.0009911060333251953
local_in_edges_tensor generation:  0.0015556812286376953
mini_batch_src_global generation:  0.008095979690551758
r_  generation:  0.11244726181030273
local_output_nid generation:  0.0009932518005371094
local_in_edges_tensor generation:  0.0017771720886230469
mini_batch_src_global generation:  0.008104324340820312
r_  generation:  0.11365461349487305
local_output_nid generation:  0.001001596450805664
local_in_edges_tensor generation:  0.0023746490478515625
mini_batch_src_global generation:  0.007894515991210938
r_  generation:  0.11672544479370117
local_output_nid generation:  0.0009992122650146484
local_in_edges_tensor generation:  0.0030984878540039062
mini_batch_src_global generation:  0.008425474166870117
r_  generation:  0.11313939094543457
local_output_nid generation:  0.0010035037994384766
local_in_edges_tensor generation:  0.0030193328857421875
mini_batch_src_global generation:  0.008230209350585938
r_  generation:  0.11356830596923828
local_output_nid generation:  0.001020669937133789
local_in_edges_tensor generation:  0.0030515193939208984
mini_batch_src_global generation:  0.008494853973388672
r_  generation:  0.11166667938232422
local_output_nid generation:  0.0009984970092773438
local_in_edges_tensor generation:  0.003069639205932617
mini_batch_src_global generation:  0.010746955871582031
r_  generation:  0.11613702774047852
local_output_nid generation:  0.001191854476928711
local_in_edges_tensor generation:  0.0030028820037841797
mini_batch_src_global generation:  0.00821828842163086
r_  generation:  0.1131892204284668
local_output_nid generation:  0.0010335445404052734
local_in_edges_tensor generation:  0.002256631851196289
mini_batch_src_global generation:  0.008512496948242188
r_  generation:  0.11490154266357422
local_output_nid generation:  0.0010349750518798828
local_in_edges_tensor generation:  0.002028226852416992
mini_batch_src_global generation:  0.008120298385620117
r_  generation:  0.11678314208984375
local_output_nid generation:  0.0010275840759277344
local_in_edges_tensor generation:  0.002957582473754883
mini_batch_src_global generation:  0.008708477020263672
r_  generation:  0.11484146118164062
local_output_nid generation:  0.0010225772857666016
local_in_edges_tensor generation:  0.004228353500366211
mini_batch_src_global generation:  0.00878000259399414
r_  generation:  0.11822080612182617
local_output_nid generation:  0.0010347366333007812
local_in_edges_tensor generation:  0.036641836166381836
mini_batch_src_global generation:  0.007741212844848633
r_  generation:  0.11858391761779785
local_output_nid generation:  0.0010426044464111328
local_in_edges_tensor generation:  0.002893686294555664
mini_batch_src_global generation:  0.008528470993041992
r_  generation:  0.11543846130371094
local_output_nid generation:  0.0010373592376708984
local_in_edges_tensor generation:  0.002100706100463867
mini_batch_src_global generation:  0.008408069610595703
r_  generation:  0.11469864845275879
local_output_nid generation:  0.0010509490966796875
local_in_edges_tensor generation:  0.0020647048950195312
mini_batch_src_global generation:  0.008587121963500977
r_  generation:  0.11890816688537598
local_output_nid generation:  0.0010361671447753906
local_in_edges_tensor generation:  0.004189252853393555
mini_batch_src_global generation:  0.008876323699951172
r_  generation:  0.11619091033935547
local_output_nid generation:  0.0010340213775634766
local_in_edges_tensor generation:  0.00420689582824707
mini_batch_src_global generation:  0.008444070816040039
r_  generation:  0.1166079044342041
local_output_nid generation:  0.0010221004486083984
local_in_edges_tensor generation:  0.004243373870849609
mini_batch_src_global generation:  0.010107278823852539
r_  generation:  0.12031006813049316
local_output_nid generation:  0.0010421276092529297
local_in_edges_tensor generation:  0.0041353702545166016
mini_batch_src_global generation:  0.00869441032409668
r_  generation:  0.11536526679992676
local_output_nid generation:  0.001100301742553711
local_in_edges_tensor generation:  0.004178524017333984
mini_batch_src_global generation:  0.008579015731811523
r_  generation:  0.11728763580322266
local_output_nid generation:  0.0010764598846435547
local_in_edges_tensor generation:  0.0029201507568359375
mini_batch_src_global generation:  0.008991479873657227
r_  generation:  0.11563467979431152
local_output_nid generation:  0.0010938644409179688
local_in_edges_tensor generation:  0.002290010452270508
mini_batch_src_global generation:  0.008344411849975586
r_  generation:  0.11757636070251465
local_output_nid generation:  0.0010938644409179688
local_in_edges_tensor generation:  0.0020568370819091797
mini_batch_src_global generation:  0.008373737335205078
r_  generation:  0.11853504180908203
local_output_nid generation:  0.0010979175567626953
local_in_edges_tensor generation:  0.002302408218383789
mini_batch_src_global generation:  0.008165121078491211
r_  generation:  0.11668157577514648
local_output_nid generation:  0.0010886192321777344
local_in_edges_tensor generation:  0.002284526824951172
mini_batch_src_global generation:  0.008700847625732422
r_  generation:  0.11777496337890625
local_output_nid generation:  0.001093149185180664
local_in_edges_tensor generation:  0.0022864341735839844
mini_batch_src_global generation:  0.008834600448608398
r_  generation:  0.11690425872802734
local_output_nid generation:  0.0010869503021240234
local_in_edges_tensor generation:  0.002286672592163086
mini_batch_src_global generation:  0.008547306060791016
r_  generation:  0.11894607543945312
local_output_nid generation:  0.0011858940124511719
local_in_edges_tensor generation:  0.0023224353790283203
mini_batch_src_global generation:  0.00853276252746582
r_  generation:  0.11606740951538086
local_output_nid generation:  0.0010843276977539062
local_in_edges_tensor generation:  0.0022885799407958984
mini_batch_src_global generation:  0.008319854736328125
r_  generation:  0.11632990837097168
local_output_nid generation:  0.0010972023010253906
local_in_edges_tensor generation:  0.002254009246826172
mini_batch_src_global generation:  0.008569717407226562
r_  generation:  0.11941719055175781
local_output_nid generation:  0.0010693073272705078
local_in_edges_tensor generation:  0.0022344589233398438
mini_batch_src_global generation:  0.008905649185180664
r_  generation:  0.11661648750305176
local_output_nid generation:  0.0011029243469238281
local_in_edges_tensor generation:  0.00237274169921875
mini_batch_src_global generation:  0.008447408676147461
r_  generation:  0.11754989624023438
local_output_nid generation:  0.0011043548583984375
local_in_edges_tensor generation:  0.0022733211517333984
mini_batch_src_global generation:  0.009913444519042969
r_  generation:  0.12569403648376465
local_output_nid generation:  0.0010924339294433594
local_in_edges_tensor generation:  0.0030241012573242188
mini_batch_src_global generation:  0.008466958999633789
r_  generation:  0.17047476768493652
local_output_nid generation:  0.0012316703796386719
local_in_edges_tensor generation:  0.0024204254150390625
mini_batch_src_global generation:  0.010720252990722656
r_  generation:  0.12029838562011719
local_output_nid generation:  0.0011029243469238281
local_in_edges_tensor generation:  0.0024750232696533203
mini_batch_src_global generation:  0.010448694229125977
r_  generation:  0.12871527671813965
local_output_nid generation:  0.0010807514190673828
local_in_edges_tensor generation:  0.0022215843200683594
mini_batch_src_global generation:  0.01027059555053711
r_  generation:  0.11877036094665527
local_output_nid generation:  0.0011050701141357422
local_in_edges_tensor generation:  0.002281665802001953
mini_batch_src_global generation:  0.010569095611572266
r_  generation:  0.11751246452331543
local_output_nid generation:  0.0010869503021240234
local_in_edges_tensor generation:  0.0020973682403564453
mini_batch_src_global generation:  0.008517026901245117
r_  generation:  0.12117528915405273
local_output_nid generation:  0.0010991096496582031
local_in_edges_tensor generation:  0.0021669864654541016
mini_batch_src_global generation:  0.008485078811645508
r_  generation:  0.11780047416687012
local_output_nid generation:  0.0011091232299804688
local_in_edges_tensor generation:  0.0021071434020996094
mini_batch_src_global generation:  0.00880575180053711
r_  generation:  0.11913180351257324
local_output_nid generation:  0.0010838508605957031
local_in_edges_tensor generation:  0.002157926559448242
mini_batch_src_global generation:  0.00860142707824707
r_  generation:  0.1053314208984375
local_output_nid generation:  0.001092672348022461
local_in_edges_tensor generation:  0.002271890640258789
mini_batch_src_global generation:  0.008738040924072266
r_  generation:  0.11643385887145996
local_output_nid generation:  0.0011069774627685547
local_in_edges_tensor generation:  0.0020911693572998047
mini_batch_src_global generation:  0.008608818054199219
r_  generation:  0.12313127517700195
local_output_nid generation:  0.0011281967163085938
local_in_edges_tensor generation:  0.0020711421966552734
mini_batch_src_global generation:  0.008748292922973633
r_  generation:  0.11653900146484375
local_output_nid generation:  0.001089334487915039
local_in_edges_tensor generation:  0.0021135807037353516
mini_batch_src_global generation:  0.008420228958129883
r_  generation:  0.11937451362609863
local_output_nid generation:  0.001066446304321289
local_in_edges_tensor generation:  0.0020456314086914062
mini_batch_src_global generation:  0.008211851119995117
r_  generation:  0.1024169921875
----------------------check_connections_block total spend ----------------------------- 9.947122573852539
generate_one_block  6.330590724945068
generate_one_block  0.1255183219909668
generate_one_block  0.12818384170532227
generate_one_block  0.12487506866455078
generate_one_block  0.12571358680725098
generate_one_block  0.12336301803588867
generate_one_block  0.12659549713134766
generate_one_block  0.12483334541320801
generate_one_block  0.1250898838043213
generate_one_block  0.12550640106201172
generate_one_block  0.12920022010803223
generate_one_block  0.17646479606628418
generate_one_block  0.15251946449279785
generate_one_block  0.14293932914733887
generate_one_block  0.16530609130859375
generate_one_block  0.13892340660095215
generate_one_block  0.13686227798461914
generate_one_block  0.15317988395690918
generate_one_block  0.13945627212524414
generate_one_block  0.14053583145141602
generate_one_block  0.1549081802368164
generate_one_block  0.14263510704040527
generate_one_block  0.14150309562683105
generate_one_block  0.13373017311096191
generate_one_block  0.1428680419921875
generate_one_block  0.12698149681091309
generate_one_block  0.1329038143157959
generate_one_block  0.14002656936645508
generate_one_block  0.1253032684326172
generate_one_block  0.12645411491394043
generate_one_block  0.12485694885253906
generate_one_block  0.13054108619689941
generate_one_block  0.1269221305847168
generate_one_block  0.12574553489685059
generate_one_block  0.12629485130310059
generate_one_block  0.12611746788024902
generate_one_block  0.12713193893432617
generate_one_block  0.1292264461517334
generate_one_block  0.1256849765777588
generate_one_block  0.1258687973022461
generate_one_block  0.14398932456970215
generate_one_block  0.12846851348876953
generate_one_block  0.1263899803161621
generate_one_block  0.1329345703125
generate_one_block  0.12443208694458008
generate_one_block  0.12573766708374023
generate_one_block  0.1280045509338379
generate_one_block  0.127105712890625
generate_one_block  0.1263444423675537
generate_one_block  0.12487554550170898
generate_one_block  0.12583184242248535
generate_one_block  0.12544822692871094
generate_one_block  0.12642478942871094
generate_one_block  0.1316392421722412
generate_one_block  0.12696552276611328
generate_one_block  0.12869811058044434
generate_one_block  0.12934613227844238
generate_one_block  0.1265087127685547
generate_one_block  0.12398862838745117
generate_one_block  0.12718558311462402
generate_one_block  0.12902355194091797
generate_one_block  0.12548041343688965
generate_one_block  0.1318223476409912
generate_one_block  0.123260498046875
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.4513099193573
gen group dst list time:  0.36211562156677246
time for parepare:  0.4711167812347412
local_output_nid generation:  0.04461479187011719
local_in_edges_tensor generation:  0.21219134330749512
mini_batch_src_global generation:  0.18827390670776367
r_  generation:  2.3078603744506836
local_output_nid generation:  0.05841994285583496
local_in_edges_tensor generation:  0.1579291820526123
mini_batch_src_global generation:  0.23898077011108398
r_  generation:  2.3960983753204346
local_output_nid generation:  0.051943063735961914
local_in_edges_tensor generation:  0.19968199729919434
mini_batch_src_global generation:  0.22966408729553223
r_  generation:  2.4470136165618896
local_output_nid generation:  0.06165122985839844
local_in_edges_tensor generation:  0.1801164150238037
mini_batch_src_global generation:  0.27517008781433105
r_  generation:  2.802727222442627
local_output_nid generation:  0.07201671600341797
local_in_edges_tensor generation:  0.25476932525634766
mini_batch_src_global generation:  0.320934534072876
r_  generation:  2.7293527126312256
local_output_nid generation:  0.06926751136779785
local_in_edges_tensor generation:  0.20824742317199707
mini_batch_src_global generation:  0.25134801864624023
r_  generation:  2.534294605255127
local_output_nid generation:  0.05785179138183594
local_in_edges_tensor generation:  0.16158342361450195
mini_batch_src_global generation:  0.26187753677368164
r_  generation:  2.6899094581604004
local_output_nid generation:  0.05776190757751465
local_in_edges_tensor generation:  0.22271275520324707
mini_batch_src_global generation:  0.2666332721710205
r_  generation:  2.5543503761291504
local_output_nid generation:  0.06905412673950195
local_in_edges_tensor generation:  0.16325139999389648
mini_batch_src_global generation:  0.2608973979949951
r_  generation:  2.568312168121338
local_output_nid generation:  0.05931878089904785
local_in_edges_tensor generation:  0.15809965133666992
mini_batch_src_global generation:  0.2654404640197754
r_  generation:  2.6100168228149414
local_output_nid generation:  0.06011509895324707
local_in_edges_tensor generation:  0.1600353717803955
mini_batch_src_global generation:  0.27601122856140137
r_  generation:  2.666343927383423
local_output_nid generation:  0.060359954833984375
local_in_edges_tensor generation:  0.21647238731384277
mini_batch_src_global generation:  0.2712554931640625
r_  generation:  2.6679694652557373
local_output_nid generation:  0.07910704612731934
local_in_edges_tensor generation:  0.209183931350708
mini_batch_src_global generation:  0.2808265686035156
r_  generation:  2.612499713897705
local_output_nid generation:  0.06098628044128418
local_in_edges_tensor generation:  0.16842913627624512
mini_batch_src_global generation:  0.2692248821258545
r_  generation:  2.610013484954834
local_output_nid generation:  0.060816049575805664
local_in_edges_tensor generation:  0.16234755516052246
mini_batch_src_global generation:  0.27199339866638184
r_  generation:  2.6103157997131348
local_output_nid generation:  0.061710357666015625
local_in_edges_tensor generation:  0.16603946685791016
mini_batch_src_global generation:  0.27765989303588867
r_  generation:  2.655608892440796
local_output_nid generation:  0.062021732330322266
local_in_edges_tensor generation:  0.17989420890808105
mini_batch_src_global generation:  0.27185916900634766
r_  generation:  2.6812920570373535
local_output_nid generation:  0.06160879135131836
local_in_edges_tensor generation:  0.22243499755859375
mini_batch_src_global generation:  0.27115941047668457
r_  generation:  2.638871192932129
local_output_nid generation:  0.08338284492492676
local_in_edges_tensor generation:  0.17343354225158691
mini_batch_src_global generation:  0.2741711139678955
r_  generation:  2.6071484088897705
local_output_nid generation:  0.0627753734588623
local_in_edges_tensor generation:  0.16718792915344238
mini_batch_src_global generation:  0.27361369132995605
r_  generation:  2.6422464847564697
local_output_nid generation:  0.06412267684936523
local_in_edges_tensor generation:  0.16278648376464844
mini_batch_src_global generation:  0.27422070503234863
r_  generation:  2.675025701522827
local_output_nid generation:  0.06233954429626465
local_in_edges_tensor generation:  0.1615760326385498
mini_batch_src_global generation:  0.2735896110534668
r_  generation:  2.6425490379333496
local_output_nid generation:  0.06196165084838867
local_in_edges_tensor generation:  0.2050926685333252
mini_batch_src_global generation:  0.28298377990722656
r_  generation:  2.637147903442383
local_output_nid generation:  0.06964850425720215
local_in_edges_tensor generation:  0.21968698501586914
mini_batch_src_global generation:  0.27286767959594727
r_  generation:  2.6346189975738525
local_output_nid generation:  0.07081484794616699
local_in_edges_tensor generation:  0.17167425155639648
mini_batch_src_global generation:  0.2709465026855469
r_  generation:  2.624399423599243
local_output_nid generation:  0.0628814697265625
local_in_edges_tensor generation:  0.16518259048461914
mini_batch_src_global generation:  0.26961326599121094
r_  generation:  2.606022834777832
local_output_nid generation:  0.06361937522888184
local_in_edges_tensor generation:  0.16602468490600586
mini_batch_src_global generation:  0.2796916961669922
r_  generation:  2.692345142364502
local_output_nid generation:  0.06372809410095215
local_in_edges_tensor generation:  0.16767072677612305
mini_batch_src_global generation:  0.29035115242004395
r_  generation:  2.6928083896636963
local_output_nid generation:  0.0631871223449707
local_in_edges_tensor generation:  0.20769214630126953
mini_batch_src_global generation:  0.2723708152770996
r_  generation:  2.658778429031372
local_output_nid generation:  0.07065677642822266
local_in_edges_tensor generation:  0.2157268524169922
mini_batch_src_global generation:  0.2797558307647705
r_  generation:  2.648188829421997
local_output_nid generation:  0.07175779342651367
local_in_edges_tensor generation:  0.17459392547607422
mini_batch_src_global generation:  0.2744290828704834
r_  generation:  2.643425226211548
local_output_nid generation:  0.06345582008361816
local_in_edges_tensor generation:  0.16703248023986816
mini_batch_src_global generation:  0.2718849182128906
r_  generation:  2.615844488143921
local_output_nid generation:  0.06343483924865723
local_in_edges_tensor generation:  0.16632366180419922
mini_batch_src_global generation:  0.2771174907684326
r_  generation:  2.7026240825653076
local_output_nid generation:  0.06374907493591309
local_in_edges_tensor generation:  0.16609930992126465
mini_batch_src_global generation:  0.275423526763916
r_  generation:  2.6794424057006836
local_output_nid generation:  0.06306743621826172
local_in_edges_tensor generation:  0.16819167137145996
mini_batch_src_global generation:  0.27305078506469727
r_  generation:  2.6659414768218994
local_output_nid generation:  0.06311798095703125
local_in_edges_tensor generation:  0.20552325248718262
mini_batch_src_global generation:  0.27914929389953613
r_  generation:  2.6457338333129883
local_output_nid generation:  0.09000992774963379
local_in_edges_tensor generation:  0.21928167343139648
mini_batch_src_global generation:  0.27316880226135254
r_  generation:  2.639422655105591
local_output_nid generation:  0.06353306770324707
local_in_edges_tensor generation:  0.17530393600463867
mini_batch_src_global generation:  0.2745800018310547
r_  generation:  2.6202123165130615
local_output_nid generation:  0.06566452980041504
local_in_edges_tensor generation:  0.1681513786315918
mini_batch_src_global generation:  0.27496790885925293
r_  generation:  2.6511576175689697
local_output_nid generation:  0.0636742115020752
local_in_edges_tensor generation:  0.16655993461608887
mini_batch_src_global generation:  0.28557395935058594
r_  generation:  2.6586451530456543
local_output_nid generation:  0.0677344799041748
local_in_edges_tensor generation:  0.16556382179260254
mini_batch_src_global generation:  0.27677202224731445
r_  generation:  2.6957218647003174
local_output_nid generation:  0.06349420547485352
local_in_edges_tensor generation:  0.21142911911010742
mini_batch_src_global generation:  0.28636980056762695
r_  generation:  2.6617307662963867
local_output_nid generation:  0.09185481071472168
local_in_edges_tensor generation:  0.22100424766540527
mini_batch_src_global generation:  0.27557897567749023
r_  generation:  2.6678590774536133
local_output_nid generation:  0.06471586227416992
local_in_edges_tensor generation:  0.17816615104675293
mini_batch_src_global generation:  0.2761521339416504
r_  generation:  2.6497199535369873
local_output_nid generation:  0.06374573707580566
local_in_edges_tensor generation:  0.16750240325927734
mini_batch_src_global generation:  0.27625322341918945
r_  generation:  2.615389108657837
local_output_nid generation:  0.06401801109313965
local_in_edges_tensor generation:  0.16997075080871582
mini_batch_src_global generation:  0.2735469341278076
r_  generation:  2.6974244117736816
local_output_nid generation:  0.06389570236206055
local_in_edges_tensor generation:  0.164581298828125
mini_batch_src_global generation:  0.2762877941131592
r_  generation:  2.6400415897369385
local_output_nid generation:  0.06429576873779297
local_in_edges_tensor generation:  0.21441316604614258
mini_batch_src_global generation:  0.2728567123413086
r_  generation:  2.668196201324463
local_output_nid generation:  0.07285284996032715
local_in_edges_tensor generation:  0.22932767868041992
mini_batch_src_global generation:  0.2747311592102051
r_  generation:  2.6333842277526855
local_output_nid generation:  0.07342839241027832
local_in_edges_tensor generation:  0.177293062210083
mini_batch_src_global generation:  0.2716696262359619
r_  generation:  2.6174306869506836
local_output_nid generation:  0.06638693809509277
local_in_edges_tensor generation:  0.16909098625183105
mini_batch_src_global generation:  0.2766897678375244
r_  generation:  2.6373257637023926
local_output_nid generation:  0.06437087059020996
local_in_edges_tensor generation:  0.16851353645324707
mini_batch_src_global generation:  0.28664064407348633
r_  generation:  2.698573112487793
local_output_nid generation:  0.06365752220153809
local_in_edges_tensor generation:  0.16389250755310059
mini_batch_src_global generation:  0.2737257480621338
r_  generation:  2.63248610496521
local_output_nid generation:  0.06612801551818848
local_in_edges_tensor generation:  0.21436262130737305
mini_batch_src_global generation:  0.275820255279541
r_  generation:  2.6825594902038574
local_output_nid generation:  0.0745394229888916
local_in_edges_tensor generation:  0.2329120635986328
mini_batch_src_global generation:  0.2751328945159912
r_  generation:  2.649998426437378
local_output_nid generation:  0.07448935508728027
local_in_edges_tensor generation:  0.17925620079040527
mini_batch_src_global generation:  0.2744567394256592
r_  generation:  2.64684796333313
local_output_nid generation:  0.06527256965637207
local_in_edges_tensor generation:  0.16970610618591309
mini_batch_src_global generation:  0.2803502082824707
r_  generation:  2.6514956951141357
local_output_nid generation:  0.06890320777893066
local_in_edges_tensor generation:  0.17073464393615723
mini_batch_src_global generation:  0.28588223457336426
r_  generation:  2.701476812362671
local_output_nid generation:  0.06303620338439941
local_in_edges_tensor generation:  0.16823935508728027
mini_batch_src_global generation:  0.2720823287963867
r_  generation:  2.63484263420105
local_output_nid generation:  0.06464529037475586
local_in_edges_tensor generation:  0.21483850479125977
mini_batch_src_global generation:  0.28592610359191895
r_  generation:  2.6772241592407227
local_output_nid generation:  0.09398698806762695
local_in_edges_tensor generation:  0.22411680221557617
mini_batch_src_global generation:  0.28940868377685547
r_  generation:  2.657125473022461
local_output_nid generation:  0.06396722793579102
local_in_edges_tensor generation:  0.17676329612731934
mini_batch_src_global generation:  0.270967960357666
r_  generation:  2.6196131706237793
local_output_nid generation:  0.06493425369262695
local_in_edges_tensor generation:  0.17020082473754883
mini_batch_src_global generation:  0.27805662155151367
r_  generation:  2.6533756256103516
local_output_nid generation:  0.0622866153717041
local_in_edges_tensor generation:  0.169602632522583
mini_batch_src_global generation:  0.27861452102661133
r_  generation:  2.6015584468841553
----------------------check_connections_block total spend ----------------------------- 234.85424995422363
generate_one_block  3.751469373703003
generate_one_block  3.921720027923584
generate_one_block  3.6329002380371094
generate_one_block  3.3282413482666016
generate_one_block  3.324740171432495
generate_one_block  3.3009846210479736
generate_one_block  3.354306697845459
generate_one_block  3.3254008293151855
generate_one_block  3.414900779724121
generate_one_block  3.6473069190979004
generate_one_block  3.3836278915405273
generate_one_block  3.3452141284942627
generate_one_block  3.302126884460449
generate_one_block  3.3323376178741455
generate_one_block  3.4099440574645996
generate_one_block  3.314305305480957
generate_one_block  3.655137777328491
generate_one_block  3.4513280391693115
generate_one_block  3.306544542312622
generate_one_block  3.367328405380249
generate_one_block  3.314950704574585
generate_one_block  3.346623659133911
generate_one_block  3.2925796508789062
generate_one_block  3.621415615081787
generate_one_block  3.4215362071990967
generate_one_block  3.322859525680542
generate_one_block  3.33933687210083
generate_one_block  3.8648929595947266
generate_one_block  3.3527941703796387
generate_one_block  3.310737371444702
generate_one_block  3.6121301651000977
generate_one_block  3.4612159729003906
generate_one_block  3.3353493213653564
generate_one_block  3.304236650466919
generate_one_block  3.332760810852051
generate_one_block  3.320725202560425
generate_one_block  3.3373286724090576
generate_one_block  3.488034725189209
generate_one_block  3.6084744930267334
generate_one_block  3.296933174133301
generate_one_block  3.3958308696746826
generate_one_block  3.3056583404541016
generate_one_block  3.3802943229675293
generate_one_block  3.359384775161743
generate_one_block  3.628058433532715
generate_one_block  3.4462828636169434
generate_one_block  3.3226959705352783
generate_one_block  3.3365721702575684
generate_one_block  3.310817003250122
generate_one_block  3.3282811641693115
generate_one_block  3.3523824214935303
generate_one_block  3.5844521522521973
generate_one_block  3.4969282150268555
generate_one_block  3.3882863521575928
generate_one_block  3.34834361076355
generate_one_block  3.361192464828491
generate_one_block  3.560011863708496
generate_one_block  3.8292109966278076
generate_one_block  3.411545515060425
generate_one_block  3.7613933086395264
generate_one_block  3.3526594638824463
generate_one_block  3.3640730381011963
generate_one_block  3.358773946762085
generate_one_block  3.7029478549957275
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.203185796737671
gen group dst list time:  2.6085336208343506
time for parepare:  0.4971883296966553
local_output_nid generation:  0.3786602020263672
local_in_edges_tensor generation:  0.9791569709777832
mini_batch_src_global generation:  0.8575942516326904
r_  generation:  10.595974206924438
local_output_nid generation:  0.4140908718109131
local_in_edges_tensor generation:  0.8803703784942627
mini_batch_src_global generation:  1.0366709232330322
r_  generation:  10.815030336380005
local_output_nid generation:  0.3987751007080078
local_in_edges_tensor generation:  0.924893856048584
mini_batch_src_global generation:  1.0987513065338135
r_  generation:  10.775811195373535
local_output_nid generation:  0.43317222595214844
local_in_edges_tensor generation:  0.7681701183319092
mini_batch_src_global generation:  1.2238290309906006
r_  generation:  10.939164876937866
local_output_nid generation:  0.4363138675689697
local_in_edges_tensor generation:  0.898289680480957
mini_batch_src_global generation:  1.06797456741333
r_  generation:  11.213406085968018
local_output_nid generation:  0.394794225692749
local_in_edges_tensor generation:  0.9055290222167969
mini_batch_src_global generation:  1.108858346939087
r_  generation:  11.00782299041748
local_output_nid generation:  0.4438655376434326
local_in_edges_tensor generation:  0.793328046798706
mini_batch_src_global generation:  1.1551811695098877
r_  generation:  11.235981225967407
local_output_nid generation:  0.43381738662719727
local_in_edges_tensor generation:  0.9163038730621338
mini_batch_src_global generation:  1.0636827945709229
r_  generation:  11.053410291671753
local_output_nid generation:  0.4000701904296875
local_in_edges_tensor generation:  0.907862663269043
mini_batch_src_global generation:  1.1110234260559082
r_  generation:  10.907634973526001
local_output_nid generation:  0.4353189468383789
local_in_edges_tensor generation:  0.7976000308990479
mini_batch_src_global generation:  1.0681359767913818
r_  generation:  11.272974729537964
local_output_nid generation:  0.4125046730041504
local_in_edges_tensor generation:  0.9121272563934326
mini_batch_src_global generation:  1.112687110900879
r_  generation:  10.900890827178955
local_output_nid generation:  0.42659544944763184
local_in_edges_tensor generation:  0.7931787967681885
mini_batch_src_global generation:  1.2469284534454346
r_  generation:  11.0382080078125
local_output_nid generation:  0.441103458404541
local_in_edges_tensor generation:  0.9076995849609375
mini_batch_src_global generation:  1.0690333843231201
r_  generation:  11.181494951248169
local_output_nid generation:  0.4069492816925049
local_in_edges_tensor generation:  0.9230594635009766
mini_batch_src_global generation:  1.1202411651611328
r_  generation:  10.844598293304443
local_output_nid generation:  0.4613621234893799
local_in_edges_tensor generation:  0.7952423095703125
mini_batch_src_global generation:  1.1693010330200195
r_  generation:  11.341190338134766
local_output_nid generation:  0.4489634037017822
local_in_edges_tensor generation:  0.9232001304626465
mini_batch_src_global generation:  1.066380500793457
r_  generation:  11.139020442962646
local_output_nid generation:  0.41533946990966797
local_in_edges_tensor generation:  0.8039007186889648
mini_batch_src_global generation:  1.1966063976287842
r_  generation:  11.087043285369873
local_output_nid generation:  0.45581483840942383
local_in_edges_tensor generation:  0.9160544872283936
mini_batch_src_global generation:  1.1549372673034668
r_  generation:  12.668144941329956
local_output_nid generation:  0.4593803882598877
local_in_edges_tensor generation:  0.9169518947601318
mini_batch_src_global generation:  1.2443158626556396
r_  generation:  11.20495319366455
local_output_nid generation:  0.407651424407959
local_in_edges_tensor generation:  0.9272115230560303
mini_batch_src_global generation:  1.1325981616973877
r_  generation:  10.980651378631592
local_output_nid generation:  0.45002198219299316
local_in_edges_tensor generation:  0.7985544204711914
mini_batch_src_global generation:  1.193138599395752
r_  generation:  11.618178606033325
local_output_nid generation:  0.45919275283813477
local_in_edges_tensor generation:  0.9298839569091797
mini_batch_src_global generation:  1.1162364482879639
r_  generation:  11.011876583099365
local_output_nid generation:  0.40868282318115234
local_in_edges_tensor generation:  0.7995665073394775
mini_batch_src_global generation:  1.191833734512329
r_  generation:  10.908671617507935
local_output_nid generation:  0.44348955154418945
local_in_edges_tensor generation:  0.905536413192749
mini_batch_src_global generation:  1.068840742111206
r_  generation:  11.261156558990479
local_output_nid generation:  0.42606210708618164
local_in_edges_tensor generation:  0.941826581954956
mini_batch_src_global generation:  1.0673351287841797
r_  generation:  10.8494873046875
local_output_nid generation:  0.41967225074768066
local_in_edges_tensor generation:  0.8146002292633057
mini_batch_src_global generation:  1.232309341430664
r_  generation:  10.940701484680176
local_output_nid generation:  0.44568824768066406
local_in_edges_tensor generation:  0.9062409400939941
mini_batch_src_global generation:  1.0681729316711426
r_  generation:  11.366668701171875
local_output_nid generation:  0.4165318012237549
local_in_edges_tensor generation:  0.9328289031982422
mini_batch_src_global generation:  1.1050331592559814
r_  generation:  11.041118383407593
local_output_nid generation:  0.4364016056060791
local_in_edges_tensor generation:  0.8001234531402588
mini_batch_src_global generation:  1.2349059581756592
r_  generation:  10.991957902908325
local_output_nid generation:  0.447310209274292
local_in_edges_tensor generation:  0.919212818145752
mini_batch_src_global generation:  1.0683503150939941
r_  generation:  11.370331525802612
local_output_nid generation:  0.41974544525146484
local_in_edges_tensor generation:  0.9403729438781738
mini_batch_src_global generation:  1.089479923248291
r_  generation:  10.807539939880371
local_output_nid generation:  0.4267387390136719
local_in_edges_tensor generation:  0.8019695281982422
mini_batch_src_global generation:  1.2308344841003418
r_  generation:  10.870326519012451
local_output_nid generation:  0.45163750648498535
local_in_edges_tensor generation:  0.9172077178955078
mini_batch_src_global generation:  1.0728912353515625
r_  generation:  11.38414192199707
local_output_nid generation:  0.41321587562561035
local_in_edges_tensor generation:  0.9448490142822266
mini_batch_src_global generation:  1.0940957069396973
r_  generation:  10.868192911148071
local_output_nid generation:  0.4294407367706299
local_in_edges_tensor generation:  0.7992029190063477
mini_batch_src_global generation:  1.2281489372253418
r_  generation:  10.949854373931885
local_output_nid generation:  0.4526512622833252
local_in_edges_tensor generation:  0.9174623489379883
mini_batch_src_global generation:  1.065197229385376
r_  generation:  11.220462560653687
local_output_nid generation:  0.41438865661621094
local_in_edges_tensor generation:  0.9322965145111084
mini_batch_src_global generation:  1.0901062488555908
r_  generation:  10.835020065307617
local_output_nid generation:  0.43705177307128906
local_in_edges_tensor generation:  0.8014752864837646
mini_batch_src_global generation:  1.2298178672790527
r_  generation:  10.97018837928772
local_output_nid generation:  0.44820618629455566
local_in_edges_tensor generation:  0.91796875
mini_batch_src_global generation:  1.0669066905975342
r_  generation:  11.25700044631958
local_output_nid generation:  0.41811704635620117
local_in_edges_tensor generation:  0.9438991546630859
mini_batch_src_global generation:  1.105158805847168
r_  generation:  10.833787202835083
local_output_nid generation:  0.4344608783721924
local_in_edges_tensor generation:  0.8041388988494873
mini_batch_src_global generation:  1.1551365852355957
r_  generation:  11.131538152694702
local_output_nid generation:  0.45018959045410156
local_in_edges_tensor generation:  0.9160432815551758
mini_batch_src_global generation:  1.0662672519683838
r_  generation:  11.182996988296509
local_output_nid generation:  0.41005611419677734
local_in_edges_tensor generation:  0.9372141361236572
mini_batch_src_global generation:  1.098656177520752
r_  generation:  10.883934736251831
local_output_nid generation:  0.4432659149169922
local_in_edges_tensor generation:  0.8137280941009521
mini_batch_src_global generation:  1.1443450450897217
r_  generation:  11.085485935211182
local_output_nid generation:  0.44818806648254395
local_in_edges_tensor generation:  0.91408371925354
mini_batch_src_global generation:  1.0616016387939453
r_  generation:  11.234539270401001
local_output_nid generation:  0.41162586212158203
local_in_edges_tensor generation:  0.9444656372070312
mini_batch_src_global generation:  1.1074721813201904
r_  generation:  10.889661073684692
local_output_nid generation:  0.43491697311401367
local_in_edges_tensor generation:  0.7878978252410889
mini_batch_src_global generation:  1.2731640338897705
r_  generation:  12.308310270309448
local_output_nid generation:  0.4580962657928467
local_in_edges_tensor generation:  0.9250917434692383
mini_batch_src_global generation:  1.1777703762054443
r_  generation:  10.981170177459717
local_output_nid generation:  0.44913244247436523
local_in_edges_tensor generation:  0.8006312847137451
mini_batch_src_global generation:  1.1392590999603271
r_  generation:  11.091018438339233
local_output_nid generation:  0.4619271755218506Using backend: pytorch

local_in_edges_tensor generation:  0.9168941974639893
mini_batch_src_global generation:  1.0662922859191895
r_  generation:  11.28109335899353
local_output_nid generation:  0.4096341133117676
local_in_edges_tensor generation:  0.9184794425964355
mini_batch_src_global generation:  1.0983881950378418
r_  generation:  10.920953035354614
local_output_nid generation:  0.46494579315185547
local_in_edges_tensor generation:  0.8167839050292969
mini_batch_src_global generation:  1.1214277744293213
r_  generation:  11.227872610092163
local_output_nid generation:  0.457489013671875
local_in_edges_tensor generation:  0.9131948947906494
mini_batch_src_global generation:  1.0630276203155518
r_  generation:  11.246065378189087
local_output_nid generation:  0.41556787490844727
local_in_edges_tensor generation:  0.9250037670135498
mini_batch_src_global generation:  1.0955638885498047
r_  generation:  10.94456696510315
local_output_nid generation:  0.4708578586578369
local_in_edges_tensor generation:  0.8208334445953369
mini_batch_src_global generation:  1.145686149597168
r_  generation:  11.327810287475586
local_output_nid generation:  0.4615662097930908
local_in_edges_tensor generation:  0.9313089847564697
mini_batch_src_global generation:  1.0741126537322998
r_  generation:  11.37408995628357
local_output_nid generation:  0.40958547592163086
local_in_edges_tensor generation:  0.9175746440887451
mini_batch_src_global generation:  1.0936503410339355
r_  generation:  10.900863647460938
local_output_nid generation:  0.4594154357910156
local_in_edges_tensor generation:  4.335866212844849
mini_batch_src_global generation:  1.1971817016601562
r_  generation:  11.036052942276001
local_output_nid generation:  0.4141411781311035
local_in_edges_tensor generation:  0.9121034145355225
mini_batch_src_global generation:  1.0974376201629639
r_  generation:  10.9710693359375
local_output_nid generation:  0.43689942359924316
local_in_edges_tensor generation:  0.814037561416626
mini_batch_src_global generation:  1.1202349662780762
r_  generation:  11.037969589233398
local_output_nid generation:  0.45654296875
local_in_edges_tensor generation:  0.9212303161621094
mini_batch_src_global generation:  1.066774845123291
r_  generation:  11.467504024505615
local_output_nid generation:  0.42963647842407227
local_in_edges_tensor generation:  0.9525690078735352
mini_batch_src_global generation:  1.1057374477386475
r_  generation:  10.931900262832642
local_output_nid generation:  0.43750786781311035
local_in_edges_tensor generation:  0.818270206451416
mini_batch_src_global generation:  1.151655673980713
r_  generation:  11.205678462982178
local_output_nid generation:  0.4521348476409912
local_in_edges_tensor generation:  0.916792631149292
mini_batch_src_global generation:  1.0673141479492188
r_  generation:  11.311959028244019
----------------------check_connections_block total spend ----------------------------- 996.0609092712402
generate_one_block  15.039847135543823
generate_one_block  14.94484281539917
generate_one_block  15.287151336669922
generate_one_block  15.085469722747803
generate_one_block  14.60090184211731
generate_one_block  15.173540353775024
generate_one_block  15.156955242156982
generate_one_block  14.628336906433105
generate_one_block  14.9840989112854
generate_one_block  15.16680359840393
generate_one_block  15.091625928878784
generate_one_block  14.561163425445557
generate_one_block  15.623166799545288
generate_one_block  15.121984243392944
generate_one_block  14.639507055282593
generate_one_block  15.051782608032227
generate_one_block  15.172897815704346
generate_one_block  15.016461849212646
generate_one_block  14.660370826721191
generate_one_block  15.27297067642212
generate_one_block  15.069223880767822
generate_one_block  14.532255411148071
generate_one_block  15.107076644897461
generate_one_block  15.063609838485718
generate_one_block  14.640636205673218
generate_one_block  15.25222110748291
generate_one_block  15.194267272949219
generate_one_block  15.136538028717041
generate_one_block  14.705104112625122
generate_one_block  15.133079767227173
generate_one_block  15.130105257034302
generate_one_block  15.06558895111084
generate_one_block  14.851993322372437
generate_one_block  15.107744216918945
generate_one_block  15.19276237487793
generate_one_block  15.127666234970093
generate_one_block  14.696656942367554
generate_one_block  15.108149290084839
generate_one_block  15.425725936889648
generate_one_block  15.06816816329956
generate_one_block  14.785805225372314
generate_one_block  15.053027629852295
generate_one_block  15.220320224761963
generate_one_block  15.138930320739746
generate_one_block  14.685389041900635
generate_one_block  15.068901300430298
generate_one_block  15.129651308059692
generate_one_block  15.09607219696045
generate_one_block  14.629518747329712
generate_one_block  15.11566424369812
generate_one_block  15.231102466583252
generate_one_block  15.263294696807861
generate_one_block  14.657841444015503
generate_one_block  15.211784839630127
generate_one_block  15.313733100891113
generate_one_block  15.161220788955688
generate_one_block  14.728641510009766
generate_one_block  15.310110092163086
generate_one_block  15.147966861724854
generate_one_block  15.036466121673584
generate_one_block  14.748053312301636
generate_one_block  15.21618914604187
generate_one_block  15.169466733932495
generate_one_block  15.13801121711731
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

connection checking time:  1230.9151592254639
block generation total time  1181.9864733219147
average batch blocks generation time:  18.468538645654917
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0848388671875 GB
    Memory Allocated: 0.9910459518432617  GigaBytes
Max Memory Allocated: 0.9910459518432617  GigaBytes

Traceback (most recent call last):
  File "pseudo_mini_batch_range_products_sage.py", line 455, in <module>
    main()
  File "pseudo_mini_batch_range_products_sage.py", line 451, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_products_sage.py", line 276, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_products.py", line 48, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 20.66 GiB already allocated; 11.44 MiB free; 21.13 GiB reserved in total by PyTorch)
