main start at this time 1648257958.3112493
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3397641181945801
range selection method range initialization spend 0.02891707420349121
time for parepare:  0.27497267723083496
local_output_nid generation:  0.0008852481842041016
local_in_edges_tensor generation:  0.01632547378540039
mini_batch_src_global generation:  0.003682851791381836
r_  generation:  0.042883872985839844
local_output_nid generation:  0.0009946823120117188
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.004084348678588867
r_  generation:  0.042974233627319336
local_output_nid generation:  0.0009739398956298828
local_in_edges_tensor generation:  0.0010104179382324219
mini_batch_src_global generation:  0.0028493404388427734
r_  generation:  0.044137001037597656
local_output_nid generation:  0.0009815692901611328
local_in_edges_tensor generation:  0.0010440349578857422
mini_batch_src_global generation:  0.002621889114379883
r_  generation:  0.04460573196411133
local_output_nid generation:  0.0009725093841552734
local_in_edges_tensor generation:  0.0010640621185302734
mini_batch_src_global generation:  0.0025947093963623047
r_  generation:  0.04510211944580078
local_output_nid generation:  0.0010063648223876953
local_in_edges_tensor generation:  0.0010852813720703125
mini_batch_src_global generation:  0.0026242733001708984
r_  generation:  0.0455622673034668
local_output_nid generation:  0.0009815692901611328
local_in_edges_tensor generation:  0.0010836124420166016
mini_batch_src_global generation:  0.002712726593017578
r_  generation:  0.045265913009643555
local_output_nid generation:  0.0009968280792236328
local_in_edges_tensor generation:  0.0011022090911865234
mini_batch_src_global generation:  0.002721071243286133
r_  generation:  0.046599626541137695
local_output_nid generation:  0.0009889602661132812
local_in_edges_tensor generation:  0.0010113716125488281
mini_batch_src_global generation:  0.0027971267700195312
r_  generation:  0.04633045196533203
local_output_nid generation:  0.0009963512420654297
local_in_edges_tensor generation:  0.0010919570922851562
mini_batch_src_global generation:  0.0028808116912841797
r_  generation:  0.047751665115356445
local_output_nid generation:  0.001005411148071289
local_in_edges_tensor generation:  0.0010485649108886719
mini_batch_src_global generation:  0.0028951168060302734
r_  generation:  0.0510404109954834
local_output_nid generation:  0.0010027885437011719
local_in_edges_tensor generation:  0.001089334487915039
mini_batch_src_global generation:  0.002954244613647461
r_  generation:  0.04734683036804199
local_output_nid generation:  0.0009906291961669922
local_in_edges_tensor generation:  0.0010733604431152344
mini_batch_src_global generation:  0.0030050277709960938
r_  generation:  0.04721260070800781
local_output_nid generation:  0.0009930133819580078
local_in_edges_tensor generation:  0.0010783672332763672
mini_batch_src_global generation:  0.0032024383544921875
r_  generation:  0.04783153533935547
local_output_nid generation:  0.0009887218475341797
local_in_edges_tensor generation:  0.0010852813720703125
mini_batch_src_global generation:  0.003095388412475586
r_  generation:  0.048284292221069336
local_output_nid generation:  0.0009984970092773438
local_in_edges_tensor generation:  0.0011212825775146484
mini_batch_src_global generation:  0.003231525421142578
r_  generation:  0.048799991607666016
local_output_nid generation:  0.0009877681732177734
local_in_edges_tensor generation:  0.001039743423461914
mini_batch_src_global generation:  0.0033104419708251953
r_  generation:  0.048951148986816406
local_output_nid generation:  0.001013040542602539
local_in_edges_tensor generation:  0.0010840892791748047
mini_batch_src_global generation:  0.0034537315368652344
r_  generation:  0.05008244514465332
local_output_nid generation:  0.0009748935699462891
local_in_edges_tensor generation:  0.0010638236999511719
mini_batch_src_global generation:  0.0033435821533203125
r_  generation:  0.05003023147583008
local_output_nid generation:  0.0009987354278564453
local_in_edges_tensor generation:  0.0011267662048339844
mini_batch_src_global generation:  0.003310680389404297
r_  generation:  0.05056929588317871
local_output_nid generation:  0.0009758472442626953
local_in_edges_tensor generation:  0.0010845661163330078
mini_batch_src_global generation:  0.003434419631958008
r_  generation:  0.05047798156738281
local_output_nid generation:  0.0009927749633789062
local_in_edges_tensor generation:  0.001073598861694336
mini_batch_src_global generation:  0.0033125877380371094
r_  generation:  0.05082082748413086
local_output_nid generation:  0.0009756088256835938
local_in_edges_tensor generation:  0.0010747909545898438
mini_batch_src_global generation:  0.0034215450286865234
r_  generation:  0.05051445960998535
local_output_nid generation:  0.0009839534759521484
local_in_edges_tensor generation:  0.0010714530944824219
mini_batch_src_global generation:  0.0035219192504882812
r_  generation:  0.05081605911254883
local_output_nid generation:  0.0009739398956298828
local_in_edges_tensor generation:  0.001100301742553711
mini_batch_src_global generation:  0.003472566604614258
r_  generation:  0.05073094367980957
local_output_nid generation:  0.0010001659393310547
local_in_edges_tensor generation:  0.0010797977447509766
mini_batch_src_global generation:  0.0035805702209472656
r_  generation:  0.050864458084106445
local_output_nid generation:  0.0009636878967285156
local_in_edges_tensor generation:  0.0010857582092285156
mini_batch_src_global generation:  0.0034427642822265625
r_  generation:  0.05088615417480469
local_output_nid generation:  0.0009875297546386719
local_in_edges_tensor generation:  0.001035928726196289
mini_batch_src_global generation:  0.003606557846069336
r_  generation:  0.05118751525878906
local_output_nid generation:  0.0009715557098388672
local_in_edges_tensor generation:  0.019805192947387695
mini_batch_src_global generation:  0.003292083740234375
r_  generation:  0.05133652687072754
local_output_nid generation:  0.0009813308715820312
local_in_edges_tensor generation:  0.001026153564453125
mini_batch_src_global generation:  0.003515958786010742
r_  generation:  0.051721811294555664
local_output_nid generation:  0.0009884834289550781
local_in_edges_tensor generation:  0.0010120868682861328
mini_batch_src_global generation:  0.003619670867919922
r_  generation:  0.051946163177490234
local_output_nid generation:  0.0009686946868896484
local_in_edges_tensor generation:  0.0010161399841308594
mini_batch_src_global generation:  0.003463268280029297
r_  generation:  0.05107474327087402
local_output_nid generation:  0.0009965896606445312
local_in_edges_tensor generation:  0.0011491775512695312
mini_batch_src_global generation:  0.0035126209259033203
r_  generation:  0.0519254207611084
local_output_nid generation:  0.0009765625
local_in_edges_tensor generation:  0.0010857582092285156
mini_batch_src_global generation:  0.003691434860229492
r_  generation:  0.05160975456237793
local_output_nid generation:  0.0009770393371582031
local_in_edges_tensor generation:  0.0010895729064941406
mini_batch_src_global generation:  0.003431558609008789
r_  generation:  0.05094718933105469
local_output_nid generation:  0.0009925365447998047
local_in_edges_tensor generation:  0.0010547637939453125
mini_batch_src_global generation:  0.0035631656646728516
r_  generation:  0.052643775939941406
local_output_nid generation:  0.000980377197265625
local_in_edges_tensor generation:  0.001016378402709961
mini_batch_src_global generation:  0.0036134719848632812
r_  generation:  0.050821781158447266
local_output_nid generation:  0.0010013580322265625
local_in_edges_tensor generation:  0.0011534690856933594
mini_batch_src_global generation:  0.0036699771881103516
r_  generation:  0.05288100242614746
local_output_nid generation:  0.0010144710540771484
local_in_edges_tensor generation:  0.0014154911041259766
mini_batch_src_global generation:  0.0053136348724365234
r_  generation:  0.05078697204589844
local_output_nid generation:  0.0009829998016357422
local_in_edges_tensor generation:  0.001188039779663086
mini_batch_src_global generation:  0.003656625747680664
r_  generation:  0.054924964904785156
local_output_nid generation:  0.0010323524475097656
local_in_edges_tensor generation:  0.0014035701751708984
mini_batch_src_global generation:  0.012872695922851562
r_  generation:  0.06831741333007812
local_output_nid generation:  0.001279592514038086
local_in_edges_tensor generation:  0.0013041496276855469
mini_batch_src_global generation:  0.005221843719482422
r_  generation:  0.07270288467407227
local_output_nid generation:  0.001054525375366211
local_in_edges_tensor generation:  0.0012335777282714844
mini_batch_src_global generation:  0.00462031364440918
r_  generation:  0.05641055107116699
local_output_nid generation:  0.0010318756103515625
local_in_edges_tensor generation:  0.0011060237884521484
mini_batch_src_global generation:  0.003964424133300781
r_  generation:  0.05267786979675293
local_output_nid generation:  0.0010302066802978516
local_in_edges_tensor generation:  0.0010938644409179688
mini_batch_src_global generation:  0.003707408905029297
r_  generation:  0.05440926551818848
local_output_nid generation:  0.0010356903076171875
local_in_edges_tensor generation:  0.0010976791381835938
mini_batch_src_global generation:  0.006504535675048828
r_  generation:  0.053627729415893555
local_output_nid generation:  0.0010075569152832031
local_in_edges_tensor generation:  0.0010919570922851562
mini_batch_src_global generation:  0.004044532775878906
r_  generation:  0.057064056396484375
local_output_nid generation:  0.0010292530059814453
local_in_edges_tensor generation:  0.0011463165283203125
mini_batch_src_global generation:  0.003736257553100586
r_  generation:  0.052736759185791016
local_output_nid generation:  0.0010042190551757812
local_in_edges_tensor generation:  0.001104116439819336
mini_batch_src_global generation:  0.0037450790405273438
r_  generation:  0.054788827896118164
local_output_nid generation:  0.001009225845336914
local_in_edges_tensor generation:  0.0011777877807617188
mini_batch_src_global generation:  0.003809690475463867
r_  generation:  0.056688785552978516
local_output_nid generation:  0.0010082721710205078
local_in_edges_tensor generation:  0.0011038780212402344
mini_batch_src_global generation:  0.0038721561431884766
r_  generation:  0.05309271812438965
local_output_nid generation:  0.0010030269622802734
local_in_edges_tensor generation:  0.0011665821075439453
mini_batch_src_global generation:  0.003998756408691406
r_  generation:  0.05425834655761719
local_output_nid generation:  0.0009856224060058594
local_in_edges_tensor generation:  0.0010387897491455078
mini_batch_src_global generation:  0.003702878952026367
r_  generation:  0.052785396575927734
local_output_nid generation:  0.0010190010070800781
local_in_edges_tensor generation:  0.0011162757873535156
mini_batch_src_global generation:  0.003758668899536133
r_  generation:  0.05220794677734375
local_output_nid generation:  0.0009944438934326172
local_in_edges_tensor generation:  0.0010228157043457031
mini_batch_src_global generation:  0.003945589065551758
r_  generation:  0.05336642265319824
local_output_nid generation:  0.000995635986328125
local_in_edges_tensor generation:  0.0010333061218261719
mini_batch_src_global generation:  0.003689289093017578
r_  generation:  0.052468299865722656
local_output_nid generation:  0.0009987354278564453
local_in_edges_tensor generation:  0.001033782958984375
mini_batch_src_global generation:  0.004054546356201172
r_  generation:  0.054155588150024414
local_output_nid generation:  0.000993967056274414
local_in_edges_tensor generation:  0.0010383129119873047
mini_batch_src_global generation:  0.003772735595703125
r_  generation:  0.05438113212585449
local_output_nid generation:  0.0010056495666503906
local_in_edges_tensor generation:  0.0010483264923095703
mini_batch_src_global generation:  0.0037338733673095703
r_  generation:  0.05516552925109863
local_output_nid generation:  0.0009827613830566406
local_in_edges_tensor generation:  0.0012602806091308594
mini_batch_src_global generation:  0.004004240036010742
r_  generation:  0.051497459411621094
local_output_nid generation:  0.00098419189453125
local_in_edges_tensor generation:  0.0012423992156982422
mini_batch_src_global generation:  0.006131649017333984
r_  generation:  0.05328512191772461
local_output_nid generation:  0.000997304916381836
local_in_edges_tensor generation:  0.001177072525024414
mini_batch_src_global generation:  0.003763437271118164
r_  generation:  0.056076765060424805
local_output_nid generation:  0.0009677410125732422
local_in_edges_tensor generation:  0.0011603832244873047
mini_batch_src_global generation:  0.003906965255737305
r_  generation:  0.05180788040161133
local_output_nid generation:  0.0009672641754150391
local_in_edges_tensor generation:  0.0011279582977294922
mini_batch_src_global generation:  0.003557443618774414
r_  generation:  0.050910234451293945
----------------------check_connections_block total spend ----------------------------- 4.609928131103516
generate_one_block  6.182156324386597
generate_one_block  0.06888079643249512
generate_one_block  0.0713198184967041
generate_one_block  0.06845903396606445
generate_one_block  0.06862235069274902
generate_one_block  0.06771636009216309
generate_one_block  0.06891226768493652
generate_one_block  0.0717616081237793
generate_one_block  0.06803727149963379
generate_one_block  0.06890392303466797
generate_one_block  0.06967639923095703
generate_one_block  0.06937146186828613
generate_one_block  0.06796050071716309
generate_one_block  0.07041573524475098
generate_one_block  0.06920599937438965
generate_one_block  0.09227299690246582
generate_one_block  0.07934832572937012
generate_one_block  0.07342886924743652
generate_one_block  0.07201075553894043
generate_one_block  0.0699162483215332
generate_one_block  0.07296228408813477
generate_one_block  0.08591461181640625
generate_one_block  0.09504532814025879
generate_one_block  0.09822964668273926
generate_one_block  0.11630892753601074
generate_one_block  0.11314129829406738
generate_one_block  0.11611723899841309
generate_one_block  0.1117696762084961
generate_one_block  0.09703278541564941
generate_one_block  0.0871419906616211
generate_one_block  0.08195137977600098
generate_one_block  0.07808327674865723
generate_one_block  0.0749504566192627
generate_one_block  0.07420754432678223
generate_one_block  0.07139778137207031
generate_one_block  0.07118058204650879
generate_one_block  0.07181382179260254
generate_one_block  0.07023191452026367
generate_one_block  0.0701911449432373
generate_one_block  0.06992769241333008
generate_one_block  0.0696563720703125
generate_one_block  0.07146954536437988
generate_one_block  0.07068014144897461
generate_one_block  0.07054853439331055
generate_one_block  0.06817412376403809
generate_one_block  0.06920838356018066
generate_one_block  0.06917881965637207
generate_one_block  0.06883692741394043
generate_one_block  0.06852006912231445
generate_one_block  0.06841349601745605
generate_one_block  0.0692892074584961
generate_one_block  0.0687568187713623
generate_one_block  0.06840348243713379
generate_one_block  0.07073402404785156
generate_one_block  0.07333064079284668
generate_one_block  0.06949996948242188
generate_one_block  0.07019782066345215
generate_one_block  0.06893014907836914
generate_one_block  0.06774759292602539
generate_one_block  0.06716394424438477
generate_one_block  0.0694127082824707
generate_one_block  0.06821084022521973
generate_one_block  0.06892514228820801
generate_one_block  0.06597089767456055
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.268685817718506
gen group dst list time:  0.2201552391052246
time for parepare:  0.46932291984558105
local_output_nid generation:  0.025280475616455078
local_in_edges_tensor generation:  0.15676426887512207
mini_batch_src_global generation:  0.11241674423217773
r_  generation:  1.4806745052337646
local_output_nid generation:  0.035665273666381836
local_in_edges_tensor generation:  0.10026764869689941
mini_batch_src_global generation:  0.1388561725616455
r_  generation:  1.4826676845550537
local_output_nid generation:  0.02996063232421875
local_in_edges_tensor generation:  0.0832986831665039
mini_batch_src_global generation:  0.13654851913452148
r_  generation:  1.5837886333465576
local_output_nid generation:  0.034259796142578125
local_in_edges_tensor generation:  0.15370416641235352
mini_batch_src_global generation:  0.13467764854431152
r_  generation:  1.6316723823547363
local_output_nid generation:  0.0339202880859375
local_in_edges_tensor generation:  0.0855402946472168
mini_batch_src_global generation:  0.13280725479125977
r_  generation:  1.6209018230438232
local_output_nid generation:  0.033791303634643555
local_in_edges_tensor generation:  0.08997607231140137
mini_batch_src_global generation:  0.19625496864318848
r_  generation:  1.8431639671325684
local_output_nid generation:  0.04354143142700195
local_in_edges_tensor generation:  0.16599130630493164
mini_batch_src_global generation:  0.15445756912231445
r_  generation:  1.7447702884674072
local_output_nid generation:  0.032758474349975586
local_in_edges_tensor generation:  0.1247091293334961
mini_batch_src_global generation:  0.1558065414428711
r_  generation:  1.766723394393921
local_output_nid generation:  0.045728445053100586
local_in_edges_tensor generation:  0.07683324813842773
mini_batch_src_global generation:  0.14984989166259766
r_  generation:  1.6728136539459229
local_output_nid generation:  0.03333282470703125
local_in_edges_tensor generation:  0.08543848991394043
mini_batch_src_global generation:  0.16096186637878418
r_  generation:  1.755335807800293
local_output_nid generation:  0.03384518623352051
local_in_edges_tensor generation:  0.12843894958496094
mini_batch_src_global generation:  0.17404460906982422
r_  generation:  1.8239483833312988
local_output_nid generation:  0.04812264442443848
local_in_edges_tensor generation:  0.07802009582519531
mini_batch_src_global generation:  0.15637469291687012
r_  generation:  1.7055480480194092
local_output_nid generation:  0.034067392349243164
local_in_edges_tensor generation:  0.06189274787902832
mini_batch_src_global generation:  0.15481925010681152
r_  generation:  1.6999125480651855
local_output_nid generation:  0.03438901901245117
local_in_edges_tensor generation:  0.0794382095336914
mini_batch_src_global generation:  0.15953350067138672
r_  generation:  1.7437641620635986
local_output_nid generation:  0.03496384620666504
local_in_edges_tensor generation:  0.06952857971191406
mini_batch_src_global generation:  0.1658034324645996
r_  generation:  1.734867811203003
local_output_nid generation:  0.03522968292236328
local_in_edges_tensor generation:  0.06483840942382812
mini_batch_src_global generation:  0.17001867294311523
r_  generation:  1.739948034286499
local_output_nid generation:  0.03547048568725586
local_in_edges_tensor generation:  0.10821032524108887
mini_batch_src_global generation:  0.16797876358032227
r_  generation:  1.792623519897461
local_output_nid generation:  0.04121732711791992
local_in_edges_tensor generation:  0.09352231025695801
mini_batch_src_global generation:  0.15879416465759277
r_  generation:  1.8089444637298584
local_output_nid generation:  0.04725813865661621
local_in_edges_tensor generation:  0.0821068286895752
mini_batch_src_global generation:  0.15741872787475586
r_  generation:  1.709594488143921
local_output_nid generation:  0.03595900535583496
local_in_edges_tensor generation:  0.0754396915435791
mini_batch_src_global generation:  0.16610479354858398
r_  generation:  1.7187902927398682
local_output_nid generation:  0.035736799240112305
local_in_edges_tensor generation:  0.06217670440673828
mini_batch_src_global generation:  0.15949487686157227
r_  generation:  1.7598774433135986
local_output_nid generation:  0.03586292266845703
local_in_edges_tensor generation:  0.08258867263793945
mini_batch_src_global generation:  0.15811419486999512
r_  generation:  1.7120726108551025
local_output_nid generation:  0.03595471382141113
local_in_edges_tensor generation:  0.059710025787353516
mini_batch_src_global generation:  0.16753101348876953
r_  generation:  1.7333025932312012
local_output_nid generation:  0.03642606735229492
local_in_edges_tensor generation:  0.07233572006225586
mini_batch_src_global generation:  0.15744662284851074
r_  generation:  1.7304463386535645
local_output_nid generation:  0.03636741638183594
local_in_edges_tensor generation:  0.11211872100830078
mini_batch_src_global generation:  0.17848730087280273
r_  generation:  1.7364623546600342
local_output_nid generation:  0.042855262756347656
local_in_edges_tensor generation:  0.11829471588134766
mini_batch_src_global generation:  0.15970134735107422
r_  generation:  1.8042035102844238
local_output_nid generation:  0.03910708427429199
local_in_edges_tensor generation:  0.09144186973571777
mini_batch_src_global generation:  0.16568422317504883
r_  generation:  1.7308685779571533
local_output_nid generation:  0.04371476173400879
local_in_edges_tensor generation:  0.06751012802124023
mini_batch_src_global generation:  0.1661512851715088
r_  generation:  1.7343618869781494
local_output_nid generation:  0.04153943061828613
local_in_edges_tensor generation:  0.05417656898498535
mini_batch_src_global generation:  0.16145634651184082
r_  generation:  1.7153277397155762
local_output_nid generation:  0.0367889404296875
local_in_edges_tensor generation:  0.07204389572143555
mini_batch_src_global generation:  0.16145801544189453
r_  generation:  1.7240989208221436
local_output_nid generation:  0.03890681266784668
local_in_edges_tensor generation:  0.06249713897705078
mini_batch_src_global generation:  0.16622352600097656
r_  generation:  1.727647066116333
local_output_nid generation:  0.0371401309967041
local_in_edges_tensor generation:  0.07671976089477539
mini_batch_src_global generation:  0.162062406539917
r_  generation:  1.7270236015319824
local_output_nid generation:  0.037020206451416016
local_in_edges_tensor generation:  0.07781124114990234
mini_batch_src_global generation:  0.1603231430053711
r_  generation:  1.7190756797790527
local_output_nid generation:  0.037232160568237305
local_in_edges_tensor generation:  0.10683441162109375
mini_batch_src_global generation:  0.16533470153808594
r_  generation:  1.7336888313293457
local_output_nid generation:  0.03705620765686035
local_in_edges_tensor generation:  0.10289907455444336
mini_batch_src_global generation:  0.1597309112548828
r_  generation:  1.7347757816314697
local_output_nid generation:  0.044081926345825195
local_in_edges_tensor generation:  0.06629729270935059
mini_batch_src_global generation:  0.19573378562927246
r_  generation:  1.7271502017974854
local_output_nid generation:  0.049344539642333984
local_in_edges_tensor generation:  0.06300926208496094
mini_batch_src_global generation:  0.16522932052612305
r_  generation:  1.7229995727539062
local_output_nid generation:  0.03730297088623047
local_in_edges_tensor generation:  0.06528592109680176
mini_batch_src_global generation:  0.16869878768920898
r_  generation:  1.7035953998565674
local_output_nid generation:  0.03730297088623047
local_in_edges_tensor generation:  0.061936140060424805
mini_batch_src_global generation:  0.16815447807312012
r_  generation:  1.72196364402771
local_output_nid generation:  0.03889822959899902
local_in_edges_tensor generation:  0.05601048469543457
mini_batch_src_global generation:  0.16244244575500488
r_  generation:  1.7125234603881836
local_output_nid generation:  0.03762459754943848
local_in_edges_tensor generation:  0.05232691764831543
mini_batch_src_global generation:  0.15877914428710938
r_  generation:  1.7314481735229492
local_output_nid generation:  0.037477970123291016
local_in_edges_tensor generation:  0.06179547309875488
mini_batch_src_global generation:  0.16063499450683594
r_  generation:  1.7476284503936768
local_output_nid generation:  0.0378720760345459
local_in_edges_tensor generation:  0.08239579200744629
mini_batch_src_global generation:  0.16345930099487305
r_  generation:  1.9248602390289307
local_output_nid generation:  0.0626976490020752
local_in_edges_tensor generation:  0.15667939186096191
mini_batch_src_global generation:  0.15895557403564453
r_  generation:  1.729109764099121
local_output_nid generation:  0.03801703453063965
local_in_edges_tensor generation:  0.07939481735229492
mini_batch_src_global generation:  0.16342759132385254
r_  generation:  1.7646698951721191
local_output_nid generation:  0.04039788246154785
local_in_edges_tensor generation:  0.10836410522460938
mini_batch_src_global generation:  0.17612385749816895
r_  generation:  1.8359124660491943
local_output_nid generation:  0.07283997535705566
local_in_edges_tensor generation:  0.11323761940002441
mini_batch_src_global generation:  0.1615140438079834
r_  generation:  1.7351443767547607
local_output_nid generation:  0.03801465034484863
local_in_edges_tensor generation:  0.09034538269042969
mini_batch_src_global generation:  0.1624608039855957
r_  generation:  1.7322611808776855
local_output_nid generation:  0.03764700889587402
local_in_edges_tensor generation:  0.06319165229797363
mini_batch_src_global generation:  0.16372394561767578
r_  generation:  1.7545173168182373
local_output_nid generation:  0.037741899490356445
local_in_edges_tensor generation:  0.12568306922912598
mini_batch_src_global generation:  0.1794605255126953
r_  generation:  1.8683640956878662
local_output_nid generation:  0.046102046966552734
local_in_edges_tensor generation:  0.14435768127441406
mini_batch_src_global generation:  0.16100382804870605
r_  generation:  1.7178735733032227
local_output_nid generation:  0.046227216720581055
local_in_edges_tensor generation:  0.09836506843566895
mini_batch_src_global generation:  0.16147637367248535
r_  generation:  1.729295015335083
local_output_nid generation:  0.03799796104431152
local_in_edges_tensor generation:  0.06252408027648926
mini_batch_src_global generation:  0.1602168083190918
r_  generation:  1.7322735786437988
local_output_nid generation:  0.037926435470581055
local_in_edges_tensor generation:  0.07619833946228027
mini_batch_src_global generation:  0.16713500022888184
r_  generation:  1.7338509559631348
local_output_nid generation:  0.038182973861694336
local_in_edges_tensor generation:  0.09562849998474121
mini_batch_src_global generation:  0.16037631034851074
r_  generation:  1.7486002445220947
local_output_nid generation:  0.03834033012390137
local_in_edges_tensor generation:  0.0766146183013916
mini_batch_src_global generation:  0.16037750244140625
r_  generation:  1.7564713954925537
local_output_nid generation:  0.03839516639709473
local_in_edges_tensor generation:  0.0798025131225586
mini_batch_src_global generation:  0.17609357833862305
r_  generation:  1.754296064376831
local_output_nid generation:  0.038494110107421875
local_in_edges_tensor generation:  0.10684370994567871
mini_batch_src_global generation:  0.1778562068939209
r_  generation:  1.737661600112915
local_output_nid generation:  0.03785347938537598
local_in_edges_tensor generation:  0.10655713081359863
mini_batch_src_global generation:  0.17272591590881348
r_  generation:  1.779062271118164
local_output_nid generation:  0.046697139739990234
local_in_edges_tensor generation:  0.10836958885192871
mini_batch_src_global generation:  0.16355204582214355
r_  generation:  1.7471821308135986
local_output_nid generation:  0.047059059143066406
local_in_edges_tensor generation:  0.07074308395385742
mini_batch_src_global generation:  0.1633741855621338
r_  generation:  1.7526674270629883
local_output_nid generation:  0.03847098350524902
local_in_edges_tensor generation:  0.07584905624389648
mini_batch_src_global generation:  0.15991473197937012
r_  generation:  1.7418766021728516
local_output_nid generation:  0.038513898849487305
local_in_edges_tensor generation:  0.06860923767089844
mini_batch_src_global generation:  0.16971278190612793
r_  generation:  1.7167565822601318
local_output_nid generation:  0.0373687744140625
local_in_edges_tensor generation:  0.053130388259887695
mini_batch_src_global generation:  0.15700793266296387
r_  generation:  1.6907916069030762
----------------------check_connections_block total spend ----------------------------- 150.23399353027344
generate_one_block  2.3588249683380127
generate_one_block  2.2644360065460205
generate_one_block  1.9793701171875
generate_one_block  2.004885673522949
generate_one_block  2.0617687702178955
generate_one_block  2.0570054054260254
generate_one_block  2.075575113296509
generate_one_block  2.0240416526794434
generate_one_block  1.952765703201294
generate_one_block  1.9605958461761475
generate_one_block  2.001713991165161
generate_one_block  1.966216802597046
generate_one_block  1.9353199005126953
generate_one_block  1.9484801292419434
generate_one_block  1.9954755306243896
generate_one_block  1.9623708724975586
generate_one_block  1.9748923778533936
generate_one_block  1.9573662281036377
generate_one_block  1.9642364978790283
generate_one_block  2.0440683364868164
generate_one_block  2.0816128253936768
generate_one_block  2.0696144104003906
generate_one_block  2.0606322288513184
generate_one_block  1.9612884521484375
generate_one_block  1.939096212387085
generate_one_block  1.9690907001495361
generate_one_block  1.9855575561523438
generate_one_block  2.2716054916381836
generate_one_block  1.9201326370239258
generate_one_block  1.9566140174865723
generate_one_block  1.9537043571472168
generate_one_block  1.9679455757141113
generate_one_block  1.9713761806488037
generate_one_block  1.9722788333892822
generate_one_block  2.0782976150512695
generate_one_block  2.071237087249756
generate_one_block  2.065401315689087
generate_one_block  2.031425952911377
generate_one_block  1.9984238147735596
generate_one_block  1.9582011699676514
generate_one_block  2.0076744556427
generate_one_block  1.977057933807373
generate_one_block  1.97092604637146
generate_one_block  1.980226993560791
generate_one_block  1.9500315189361572
generate_one_block  1.9628262519836426
generate_one_block  1.9599275588989258
generate_one_block  1.957066535949707
generate_one_block  1.9554665088653564
generate_one_block  1.98081374168396
generate_one_block  1.9841110706329346
generate_one_block  1.9783546924591064
generate_one_block  2.0627222061157227
generate_one_block  2.1275277137756348
generate_one_block  2.1398088932037354
generate_one_block  2.0100479125976562
generate_one_block  2.004864454269409
generate_one_block  1.9740753173828125
generate_one_block  1.9617278575897217
generate_one_block  1.9533557891845703
generate_one_block  1.9763362407684326
generate_one_block  1.959911823272705
generate_one_block  1.9626445770263672
generate_one_block  1.9184443950653076
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1567888259887695
gen group dst list time:  1.9866828918457031
time for parepare:  0.4685637950897217
local_output_nid generation:  0.3095276355743408
local_in_edges_tensor generation:  0.859764814376831
mini_batch_src_global generation:  0.7174484729766846
r_  generation:  9.754966735839844
local_output_nid generation:  0.350583553314209
local_in_edges_tensor generation:  0.9256289005279541
mini_batch_src_global generation:  0.974236249923706
r_  generation:  9.278985023498535
local_output_nid generation:  0.36160826683044434
local_in_edges_tensor generation:  0.6595382690429688
mini_batch_src_global generation:  0.8818700313568115
r_  generation:  9.71883511543274
local_output_nid generation:  0.33669471740722656
local_in_edges_tensor generation:  0.7688560485839844
mini_batch_src_global generation:  0.8880908489227295
r_  generation:  9.229909896850586
local_output_nid generation:  0.3526427745819092
local_in_edges_tensor generation:  0.6533632278442383
mini_batch_src_global generation:  0.897268533706665
r_  generation:  9.45735239982605
local_output_nid generation:  0.327028751373291
local_in_edges_tensor generation:  0.7180600166320801
mini_batch_src_global generation:  0.9473707675933838
r_  generation:  9.292195796966553
local_output_nid generation:  0.337296724319458
local_in_edges_tensor generation:  0.7125675678253174
mini_batch_src_global generation:  0.9038479328155518
r_  generation:  9.286272048950195
local_output_nid generation:  0.3487088680267334
local_in_edges_tensor generation:  0.6572716236114502
mini_batch_src_global generation:  0.8968715667724609
r_  generation:  9.551204919815063
local_output_nid generation:  0.34253621101379395
local_in_edges_tensor generation:  0.7649428844451904
mini_batch_src_global generation:  0.9156637191772461
r_  generation:  9.245814323425293
local_output_nid generation:  0.3300783634185791
local_in_edges_tensor generation:  0.6680798530578613
mini_batch_src_global generation:  0.9117176532745361
r_  generation:  9.267385005950928
local_output_nid generation:  0.3450508117675781
local_in_edges_tensor generation:  0.6595444679260254
mini_batch_src_global generation:  0.9081847667694092
r_  generation:  9.635906219482422
local_output_nid generation:  0.34653210639953613
local_in_edges_tensor generation:  0.769939661026001
mini_batch_src_global generation:  0.907707929611206
r_  generation:  9.328229904174805
local_output_nid generation:  0.36035823822021484
local_in_edges_tensor generation:  0.6691298484802246
mini_batch_src_global generation:  0.9004967212677002
r_  generation:  9.210985898971558
local_output_nid generation:  0.33156847953796387
local_in_edges_tensor generation:  0.6642172336578369
mini_batch_src_global generation:  0.9484617710113525
r_  generation:  9.510313749313354
local_output_nid generation:  0.3472115993499756
local_in_edges_tensor generation:  0.771958589553833
mini_batch_src_global generation:  0.90641188621521
r_  generation:  9.336462497711182
local_output_nid generation:  0.36243224143981934
local_in_edges_tensor generation:  0.6663367748260498
mini_batch_src_global generation:  0.9022958278656006
r_  generation:  9.279694318771362
local_output_nid generation:  0.3384103775024414
local_in_edges_tensor generation:  0.6657917499542236
mini_batch_src_global generation:  0.9656267166137695
r_  generation:  9.531617879867554
local_output_nid generation:  0.348494291305542
local_in_edges_tensor generation:  0.7826406955718994
mini_batch_src_global generation:  0.9107401371002197
r_  generation:  9.404831647872925
local_output_nid generation:  0.36202049255371094
local_in_edges_tensor generation:  0.6612045764923096
mini_batch_src_global generation:  0.9016323089599609
r_  generation:  9.297266244888306
local_output_nid generation:  0.33809614181518555
local_in_edges_tensor generation:  0.6655480861663818
mini_batch_src_global generation:  1.0027389526367188
r_  generation:  9.373116493225098
local_output_nid generation:  0.3469228744506836
local_in_edges_tensor generation:  0.7799801826477051
mini_batch_src_global generation:  0.917454719543457
r_  generation:  9.27480149269104
local_output_nid generation:  0.36408448219299316
local_in_edges_tensor generation:  0.6616592407226562
mini_batch_src_global generation:  1.0152156352996826
r_  generation:  10.287229537963867
local_output_nid generation:  0.3835880756378174
local_in_edges_tensor generation:  0.79734206199646
mini_batch_src_global generation:  1.532900333404541
r_  generation:  9.401663064956665
local_output_nid generation:  0.37871694564819336
local_in_edges_tensor generation:  0.7856509685516357
mini_batch_src_global generation:  0.9123504161834717
r_  generation:  9.661634922027588
local_output_nid generation:  0.34834933280944824
local_in_edges_tensor generation:  0.7893824577331543
mini_batch_src_global generation:  0.9194576740264893
r_  generation:  9.37807297706604
local_output_nid generation:  0.37058091163635254
local_in_edges_tensor generation:  0.6765451431274414
mini_batch_src_global generation:  0.9164292812347412
r_  generation:  9.43172574043274
local_output_nid generation:  0.343212366104126
local_in_edges_tensor generation:  0.6708097457885742
mini_batch_src_global generation:  0.9572815895080566
r_  generation:  9.53835678100586
local_output_nid generation:  0.35405993461608887
local_in_edges_tensor generation:  0.792961597442627
mini_batch_src_global generation:  0.9288361072540283
r_  generation:  9.459298133850098
local_output_nid generation:  0.3667573928833008
local_in_edges_tensor generation:  0.6739070415496826
mini_batch_src_global generation:  0.9130780696868896
r_  generation:  9.669922351837158
local_output_nid generation:  0.34295654296875
local_in_edges_tensor generation:  0.7462399005889893
mini_batch_src_global generation:  0.9401137828826904
r_  generation:  9.375606060028076
local_output_nid generation:  0.38102102279663086
local_in_edges_tensor generation:  0.7237086296081543
mini_batch_src_global generation:  0.9108150005340576
r_  generation:  9.269868850708008
local_output_nid generation:  0.3376286029815674
local_in_edges_tensor generation:  0.6743178367614746
mini_batch_src_global generation:  0.9444420337677002
r_  generation:  9.587348461151123
local_output_nid generation:  0.3533637523651123
local_in_edges_tensor generation:  0.7921183109283447
mini_batch_src_global generation:  0.9154703617095947
r_  generation:  9.41565203666687
local_output_nid generation:  0.3704397678375244
local_in_edges_tensor generation:  0.6714513301849365
mini_batch_src_global generation:  0.9109511375427246
r_  generation:  9.41526985168457
local_output_nid generation:  0.34091830253601074
local_in_edges_tensor generation:  0.6679458618164062
mini_batch_src_global generation:  0.9321389198303223
r_  generation:  9.49519157409668
local_output_nid generation:  0.35135602951049805
local_in_edges_tensor generation:  0.7847261428833008
mini_batch_src_global generation:  0.9053208827972412
r_  generation:  9.375332117080688
local_output_nid generation:  0.3694324493408203
local_in_edges_tensor generation:  0.6688406467437744
mini_batch_src_global generation:  0.9013800621032715
r_  generation:  9.475582122802734
local_output_nid generation:  0.3405873775482178
local_in_edges_tensor generation:  0.675959587097168
mini_batch_src_global generation:  0.9777593612670898
r_  generation:  9.39638352394104
local_output_nid generation:  0.38270115852355957
local_in_edges_tensor generation:  0.791149377822876
mini_batch_src_global generation:  0.9062619209289551
r_  generation:  9.296305894851685
local_output_nid generation:  0.3416576385498047
local_in_edges_tensor generation:  0.6694254875183105
mini_batch_src_global generation:  0.9455702304840088
r_  generation:  9.629500150680542
local_output_nid generation:  0.3535013198852539
local_in_edges_tensor generation:  0.7899448871612549
mini_batch_src_global generation:  0.910027027130127
r_  generation:  9.426558494567871
local_output_nid generation:  0.36811208724975586
local_in_edges_tensor generation:  0.6704740524291992
mini_batch_src_global generation:  0.9046809673309326
r_  generation:  9.370641946792603
local_output_nid generation:  0.34697866439819336
local_in_edges_tensor generation:  0.6729357242584229
mini_batch_src_global generation:  0.9294438362121582
r_  generation:  9.554205179214478
local_output_nid generation:  0.35323333740234375
local_in_edges_tensor generation:  0.7863366603851318
mini_batch_src_global generation:  0.9146356582641602
r_  generation:  9.367670774459839
local_output_nid generation:  0.3691883087158203
local_in_edges_tensor generation:  0.6738271713256836
mini_batch_src_global generation:  0.9059343338012695
r_  generation:  9.449243783950806
local_output_nid generation:  0.33925533294677734
local_in_edges_tensor generation:  0.6590704917907715
mini_batch_src_global generation:  0.9534571170806885
r_  generation:  9.226056814193726
local_output_nid generation:  0.37598252296447754
local_in_edges_tensor generation:  0.7792935371398926
mini_batch_src_global generation:  0.9070663452148438
r_  generation:  9.15897011756897
local_output_nid generation:  0.33226871490478516
local_in_edges_tensor generation:  0.6718525886535645
mini_batch_src_global generation:  0.9361379146575928
r_  generation:  9.443900346755981
local_output_nid generation:  0.34677863121032715
local_in_edges_tensor generation: Using backend: pytorch
 0.7778177261352539
mini_batch_src_global generation:  0.8961105346679688
r_  generation:  9.216939449310303
local_output_nid generation:  0.3646376132965088
local_in_edges_tensor generation:  0.6713733673095703
mini_batch_src_global generation:  0.8984782695770264
r_  generation:  9.27704930305481
local_output_nid generation:  0.33457326889038086
local_in_edges_tensor generation:  0.6700601577758789
mini_batch_src_global generation:  0.9308507442474365
r_  generation:  9.433982610702515
local_output_nid generation:  0.34561920166015625
local_in_edges_tensor generation:  0.7923300266265869
mini_batch_src_global generation:  0.9110724925994873
r_  generation:  9.218446016311646
local_output_nid generation:  0.34601712226867676
local_in_edges_tensor generation:  0.6612675189971924
mini_batch_src_global generation:  0.9292242527008057
r_  generation:  9.42560625076294
local_output_nid generation:  0.33616089820861816
local_in_edges_tensor generation:  0.6862146854400635
mini_batch_src_global generation:  0.9297583103179932
r_  generation:  9.287030935287476
local_output_nid generation:  0.3780200481414795
local_in_edges_tensor generation:  0.78688645362854
mini_batch_src_global generation:  0.9095754623413086
r_  generation:  9.316525936126709
local_output_nid generation:  0.3378303050994873
local_in_edges_tensor generation:  0.6798210144042969
mini_batch_src_global generation:  0.947685718536377
r_  generation:  9.531445264816284
local_output_nid generation:  0.3461439609527588
local_in_edges_tensor generation:  0.7779786586761475
mini_batch_src_global generation:  0.9048893451690674
r_  generation:  9.280663251876831
local_output_nid generation:  0.36770081520080566
local_in_edges_tensor generation:  3.4450531005859375
mini_batch_src_global generation:  0.9150502681732178
r_  generation:  9.481918096542358
local_output_nid generation:  0.32607197761535645
local_in_edges_tensor generation:  0.6615791320800781
mini_batch_src_global generation:  0.9815199375152588
r_  generation:  9.175880432128906
local_output_nid generation:  0.3572275638580322
local_in_edges_tensor generation:  0.7909986972808838
mini_batch_src_global generation:  0.9034543037414551
r_  generation:  9.16810131072998
local_output_nid generation:  0.35083794593811035
local_in_edges_tensor generation:  0.669633150100708
mini_batch_src_global generation:  0.939997673034668
r_  generation:  9.513051986694336
local_output_nid generation:  0.3450040817260742
local_in_edges_tensor generation:  0.7814760208129883
mini_batch_src_global generation:  0.9097084999084473
r_  generation:  9.271891355514526
local_output_nid generation:  0.3632636070251465
local_in_edges_tensor generation:  0.6642675399780273
mini_batch_src_global generation:  0.8996424674987793
r_  generation:  9.271278858184814
local_output_nid generation:  0.33746933937072754
local_in_edges_tensor generation:  0.6674537658691406
mini_batch_src_global generation:  0.9229323863983154
r_  generation:  9.468649625778198
----------------------check_connections_block total spend ----------------------------- 840.229344367981
generate_one_block  12.633179187774658
generate_one_block  12.618248224258423
generate_one_block  12.298497200012207
generate_one_block  12.625638961791992
generate_one_block  12.449241161346436
generate_one_block  12.191300868988037
generate_one_block  12.789156436920166
generate_one_block  12.285499334335327
generate_one_block  12.268308877944946
generate_one_block  12.757408857345581
generate_one_block  12.353646993637085
generate_one_block  12.240800619125366
generate_one_block  13.040655136108398
generate_one_block  12.167618036270142
generate_one_block  12.745407819747925
generate_one_block  12.31150770187378
generate_one_block  12.294799327850342
generate_one_block  12.726880311965942
generate_one_block  12.150815725326538
generate_one_block  12.674281120300293
generate_one_block  12.263953685760498
generate_one_block  12.210821866989136
generate_one_block  12.68095850944519
generate_one_block  12.265177488327026
generate_one_block  12.184613227844238
generate_one_block  12.917174816131592
generate_one_block  12.24866533279419
generate_one_block  12.782124996185303
generate_one_block  12.283037900924683
generate_one_block  12.53755497932434
generate_one_block  12.42178463935852
generate_one_block  12.198926448822021
generate_one_block  12.718449354171753
generate_one_block  12.245924472808838
generate_one_block  12.622068881988525
generate_one_block  12.338711500167847
generate_one_block  12.219082355499268
generate_one_block  12.664266347885132
generate_one_block  12.475610971450806
generate_one_block  12.669446229934692
generate_one_block  12.402966022491455
generate_one_block  12.240662813186646
generate_one_block  12.6316819190979
generate_one_block  12.305883884429932
generate_one_block  12.632766246795654
generate_one_block  12.16932201385498
generate_one_block  12.691513538360596
generate_one_block  12.286641120910645
generate_one_block  12.167895078659058
generate_one_block  12.66498851776123
generate_one_block  12.272109746932983
generate_one_block  12.860637903213501
generate_one_block  12.195430994033813
generate_one_block  12.714530944824219
generate_one_block  12.418370008468628
generate_one_block  12.800006628036499
generate_one_block  12.347822427749634
generate_one_block  12.315316915512085
generate_one_block  12.577508926391602
generate_one_block  12.218218803405762
generate_one_block  12.652702331542969
generate_one_block  12.20975923538208
generate_one_block  12.608237266540527
generate_one_block  12.272053718566895
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

connection checking time:  990.4633378982544
block generation total time  925.7171697616577
average batch blocks generation time:  14.464330777525902
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9989013671875 GB
    Memory Allocated: 0.9093494415283203  GigaBytes
Max Memory Allocated: 0.9093494415283203  GigaBytes

Traceback (most recent call last):
  File "pseudo_mini_batch_range_products_sage.py", line 455, in <module>
    main()
  File "pseudo_mini_batch_range_products_sage.py", line 451, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_products_sage.py", line 276, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_products.py", line 48, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 14.00 MiB (GPU 0; 23.62 GiB total capacity; 20.31 GiB already allocated; 7.44 MiB free; 21.18 GiB reserved in total by PyTorch)
