main start at this time 1648286769.2300436
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6602804660797119
range selection method range initialization spend 0.029036521911621094
time for parepare:  0.38136959075927734
local_output_nid generation:  0.0009658336639404297
local_in_edges_tensor generation:  0.03579401969909668
mini_batch_src_global generation:  0.006445169448852539
r_  generation:  0.08532261848449707
local_output_nid generation:  0.0010080337524414062
local_in_edges_tensor generation:  0.001481771469116211
mini_batch_src_global generation:  0.007681608200073242
r_  generation:  0.0907294750213623
local_output_nid generation:  0.0009799003601074219
local_in_edges_tensor generation:  0.001781463623046875
mini_batch_src_global generation:  0.004825115203857422
r_  generation:  0.09299993515014648
local_output_nid generation:  0.000990152359008789
local_in_edges_tensor generation:  0.0018110275268554688
mini_batch_src_global generation:  0.0049097537994384766
r_  generation:  0.09464216232299805
local_output_nid generation:  0.0009751319885253906
local_in_edges_tensor generation:  0.001982450485229492
mini_batch_src_global generation:  0.005091190338134766
r_  generation:  0.09559798240661621
local_output_nid generation:  0.0009891986846923828
local_in_edges_tensor generation:  0.00177001953125
mini_batch_src_global generation:  0.005417346954345703
r_  generation:  0.0970621109008789
local_output_nid generation:  0.00096893310546875
local_in_edges_tensor generation:  0.001817941665649414
mini_batch_src_global generation:  0.0056607723236083984
r_  generation:  0.10004925727844238
local_output_nid generation:  0.001005411148071289
local_in_edges_tensor generation:  0.0018274784088134766
mini_batch_src_global generation:  0.00566554069519043
r_  generation:  0.10220909118652344
local_output_nid generation:  0.0009853839874267578
local_in_edges_tensor generation:  0.0017900466918945312
mini_batch_src_global generation:  0.006137847900390625
r_  generation:  0.10207009315490723
local_output_nid generation:  0.000997304916381836
local_in_edges_tensor generation:  0.0018336772918701172
mini_batch_src_global generation:  0.006763458251953125
r_  generation:  0.10663104057312012
local_output_nid generation:  0.0010025501251220703
local_in_edges_tensor generation:  0.0024003982543945312
mini_batch_src_global generation:  0.006808280944824219
r_  generation:  0.10687756538391113
local_output_nid generation:  0.0009758472442626953
local_in_edges_tensor generation:  0.0031189918518066406
mini_batch_src_global generation:  0.006975412368774414
r_  generation:  0.10985445976257324
local_output_nid generation:  0.0009925365447998047
local_in_edges_tensor generation:  0.0032415390014648438
mini_batch_src_global generation:  0.007296562194824219
r_  generation:  0.1123197078704834
local_output_nid generation:  0.0009667873382568359
local_in_edges_tensor generation:  0.0023500919342041016
mini_batch_src_global generation:  0.0075855255126953125
r_  generation:  0.11038732528686523
local_output_nid generation:  0.0009930133819580078
local_in_edges_tensor generation:  0.0017919540405273438
mini_batch_src_global generation:  0.007379055023193359
r_  generation:  0.11647677421569824
local_output_nid generation:  0.0010266304016113281
local_in_edges_tensor generation:  0.0018246173858642578
mini_batch_src_global generation:  0.022529125213623047
r_  generation:  0.11598563194274902
local_output_nid generation:  0.0011551380157470703
local_in_edges_tensor generation:  0.0042421817779541016
mini_batch_src_global generation:  0.03424239158630371
r_  generation:  0.14191889762878418
local_output_nid generation:  0.0010075569152832031
local_in_edges_tensor generation:  0.0045125484466552734
mini_batch_src_global generation:  0.0326838493347168
r_  generation:  0.1719226837158203
local_output_nid generation:  0.0010902881622314453
local_in_edges_tensor generation:  0.004316568374633789
mini_batch_src_global generation:  0.023585796356201172
r_  generation:  0.15666842460632324
local_output_nid generation:  0.0010807514190673828
local_in_edges_tensor generation:  0.004659414291381836
mini_batch_src_global generation:  0.01071786880493164
r_  generation:  0.11762857437133789
local_output_nid generation:  0.0010612010955810547
local_in_edges_tensor generation:  0.004340648651123047
mini_batch_src_global generation:  0.010140419006347656
r_  generation:  0.11929988861083984
local_output_nid generation:  0.00109100341796875
local_in_edges_tensor generation:  0.004357099533081055
mini_batch_src_global generation:  0.008558988571166992
r_  generation:  0.13662219047546387
local_output_nid generation:  0.0011014938354492188
local_in_edges_tensor generation:  0.004204750061035156
mini_batch_src_global generation:  0.008371591567993164
r_  generation:  0.1246798038482666
local_output_nid generation:  0.0010864734649658203
local_in_edges_tensor generation:  0.005254268646240234
mini_batch_src_global generation:  0.009699821472167969
r_  generation:  0.15921902656555176
local_output_nid generation:  0.0010762214660644531
local_in_edges_tensor generation:  0.00249481201171875
mini_batch_src_global generation:  0.02048492431640625
r_  generation:  0.11814522743225098
local_output_nid generation:  0.0010807514190673828
local_in_edges_tensor generation:  0.0020873546600341797
mini_batch_src_global generation:  0.007989168167114258
r_  generation:  0.12211942672729492
local_output_nid generation:  0.0010712146759033203
local_in_edges_tensor generation:  0.002069711685180664
mini_batch_src_global generation:  0.008664131164550781
r_  generation:  0.12680411338806152
local_output_nid generation:  0.0010879039764404297
local_in_edges_tensor generation:  0.002090930938720703
mini_batch_src_global generation:  0.00841379165649414
r_  generation:  0.14412784576416016
local_output_nid generation:  0.0012278556823730469
local_in_edges_tensor generation:  0.04576563835144043
mini_batch_src_global generation:  0.020802974700927734
r_  generation:  0.11956143379211426
local_output_nid generation:  0.0010709762573242188
local_in_edges_tensor generation:  0.0037491321563720703
mini_batch_src_global generation:  0.009096145629882812
r_  generation:  0.11775493621826172
local_output_nid generation:  0.0010781288146972656
local_in_edges_tensor generation:  0.004456281661987305
mini_batch_src_global generation:  0.008454561233520508
r_  generation:  0.1159369945526123
local_output_nid generation:  0.0010678768157958984
local_in_edges_tensor generation:  0.004403829574584961
mini_batch_src_global generation:  0.008702993392944336
r_  generation:  0.15979981422424316
local_output_nid generation:  0.002373933792114258
local_in_edges_tensor generation:  0.007439374923706055
mini_batch_src_global generation:  0.018087148666381836
r_  generation:  0.11704730987548828
local_output_nid generation:  0.0010635852813720703
local_in_edges_tensor generation:  0.004461526870727539
mini_batch_src_global generation:  0.008649110794067383
r_  generation:  0.11816716194152832
local_output_nid generation:  0.0010633468627929688
local_in_edges_tensor generation:  0.0036950111389160156
mini_batch_src_global generation:  0.008812665939331055
r_  generation:  0.13062691688537598
local_output_nid generation:  0.0011005401611328125
local_in_edges_tensor generation:  0.0021653175354003906
mini_batch_src_global generation:  0.008190393447875977
r_  generation:  0.1729269027709961
local_output_nid generation:  0.0014300346374511719
local_in_edges_tensor generation:  0.003844022750854492
mini_batch_src_global generation:  0.01538991928100586
r_  generation:  0.16873645782470703
local_output_nid generation:  0.0011394023895263672
local_in_edges_tensor generation:  0.004178285598754883
mini_batch_src_global generation:  0.008756399154663086
r_  generation:  0.12694549560546875
local_output_nid generation:  0.0011196136474609375
local_in_edges_tensor generation:  0.00426483154296875
mini_batch_src_global generation:  0.008656740188598633
r_  generation:  0.11875104904174805
local_output_nid generation:  0.0012655258178710938
local_in_edges_tensor generation:  0.004235982894897461
mini_batch_src_global generation:  0.008886337280273438
r_  generation:  0.12171530723571777
local_output_nid generation:  0.0011019706726074219
local_in_edges_tensor generation:  0.002075672149658203
mini_batch_src_global generation:  0.008457660675048828
r_  generation:  0.11868643760681152
local_output_nid generation:  0.0010955333709716797
local_in_edges_tensor generation:  0.002094268798828125
mini_batch_src_global generation:  0.00860142707824707
r_  generation:  0.11946225166320801
local_output_nid generation:  0.0010883808135986328
local_in_edges_tensor generation:  0.002196788787841797
mini_batch_src_global generation:  0.008754253387451172
r_  generation:  0.12082481384277344
local_output_nid generation:  0.0010840892791748047
local_in_edges_tensor generation:  0.0020837783813476562
mini_batch_src_global generation:  0.008546113967895508
r_  generation:  0.1641407012939453
local_output_nid generation:  0.0013926029205322266
local_in_edges_tensor generation:  0.0025703907012939453
mini_batch_src_global generation:  0.011382579803466797
r_  generation:  0.1552269458770752
local_output_nid generation:  0.0014023780822753906
local_in_edges_tensor generation:  0.002641439437866211
mini_batch_src_global generation:  0.011629819869995117
r_  generation:  0.1568772792816162
local_output_nid generation:  0.0013844966888427734
local_in_edges_tensor generation:  0.0028655529022216797
mini_batch_src_global generation:  0.01213693618774414
r_  generation:  0.15291047096252441
local_output_nid generation:  0.0023517608642578125
local_in_edges_tensor generation:  0.0040285587310791016
mini_batch_src_global generation:  0.03326296806335449
r_  generation:  0.12647056579589844
local_output_nid generation:  0.0011904239654541016
local_in_edges_tensor generation:  0.004564046859741211
mini_batch_src_global generation:  0.010808467864990234
r_  generation:  0.12269115447998047
local_output_nid generation:  0.0011587142944335938
local_in_edges_tensor generation:  0.004380702972412109
mini_batch_src_global generation:  0.011022090911865234
r_  generation:  0.12208747863769531
local_output_nid generation:  0.0011584758758544922
local_in_edges_tensor generation:  0.0036606788635253906
mini_batch_src_global generation:  0.011024951934814453
r_  generation:  0.13590097427368164
local_output_nid generation:  0.0012102127075195312
local_in_edges_tensor generation:  0.0020287036895751953
mini_batch_src_global generation:  0.01054835319519043
r_  generation:  0.12305855751037598
local_output_nid generation:  0.0011277198791503906
local_in_edges_tensor generation:  0.0023267269134521484
mini_batch_src_global generation:  0.022466659545898438
r_  generation:  0.14704561233520508
local_output_nid generation:  0.0011065006256103516
local_in_edges_tensor generation:  0.002534151077270508
mini_batch_src_global generation:  0.01635003089904785
r_  generation:  0.15750980377197266
local_output_nid generation:  0.0019192695617675781
local_in_edges_tensor generation:  0.0039033889770507812
mini_batch_src_global generation:  0.032794952392578125
r_  generation:  0.1278071403503418
local_output_nid generation:  0.0010981559753417969
local_in_edges_tensor generation:  0.0022706985473632812
mini_batch_src_global generation:  0.010835409164428711
r_  generation:  0.14508843421936035
local_output_nid generation:  0.0012404918670654297
local_in_edges_tensor generation:  0.004415035247802734
mini_batch_src_global generation:  0.010958671569824219
r_  generation:  0.1392662525177002
local_output_nid generation:  0.0010807514190673828
local_in_edges_tensor generation:  0.004492521286010742
mini_batch_src_global generation:  0.010996103286743164
r_  generation:  0.12170886993408203
local_output_nid generation:  0.001089334487915039
local_in_edges_tensor generation:  0.0036008358001708984
mini_batch_src_global generation:  0.010642766952514648
r_  generation:  0.10902786254882812
local_output_nid generation:  0.0010704994201660156
local_in_edges_tensor generation:  0.0020568370819091797
mini_batch_src_global generation:  0.010818958282470703
r_  generation:  0.11877822875976562
local_output_nid generation:  0.001073598861694336
local_in_edges_tensor generation:  0.0021758079528808594
mini_batch_src_global generation:  0.010893106460571289
r_  generation:  0.12976694107055664
local_output_nid generation:  0.0010786056518554688
local_in_edges_tensor generation:  0.0020754337310791016
mini_batch_src_global generation:  0.00906515121459961
r_  generation:  0.11963081359863281
local_output_nid generation:  0.0010738372802734375
local_in_edges_tensor generation:  0.002295255661010742
mini_batch_src_global generation:  0.00880885124206543
r_  generation:  0.11939811706542969
local_output_nid generation:  0.001035928726196289
local_in_edges_tensor generation:  0.002018451690673828
mini_batch_src_global generation:  0.008378267288208008
r_  generation:  0.10654044151306152
----------------------check_connections_block total spend ----------------------------- 11.02235746383667
generate_one_block  6.175935983657837
generate_one_block  0.12915873527526855
generate_one_block  0.1283588409423828
generate_one_block  0.12459850311279297
generate_one_block  0.12598276138305664
generate_one_block  0.12324285507202148
generate_one_block  0.1266002655029297
generate_one_block  0.12347984313964844
generate_one_block  0.12478351593017578
generate_one_block  0.12882447242736816
generate_one_block  0.13042926788330078
generate_one_block  0.12558650970458984
generate_one_block  0.13087868690490723
generate_one_block  0.13930797576904297
generate_one_block  0.14879775047302246
generate_one_block  0.15259885787963867
generate_one_block  0.18205833435058594
generate_one_block  0.2132275104522705
generate_one_block  0.2241530418395996
generate_one_block  0.21719670295715332
generate_one_block  0.17914676666259766
generate_one_block  0.14617347717285156
generate_one_block  0.13960838317871094
generate_one_block  0.13895630836486816
generate_one_block  0.14472031593322754
generate_one_block  0.13037395477294922
generate_one_block  0.12956809997558594
generate_one_block  0.1295609474182129
generate_one_block  0.12566423416137695
generate_one_block  0.1255040168762207
generate_one_block  0.12753915786743164
generate_one_block  0.1285855770111084
generate_one_block  0.12833452224731445
generate_one_block  0.12569427490234375
generate_one_block  0.13099074363708496
generate_one_block  0.12744379043579102
generate_one_block  0.12737083435058594
generate_one_block  0.1258070468902588
generate_one_block  0.12758517265319824
generate_one_block  0.1262500286102295
generate_one_block  0.1275768280029297
generate_one_block  0.12671566009521484
generate_one_block  0.14096474647521973
generate_one_block  0.1348412036895752
generate_one_block  0.1259324550628662
generate_one_block  0.12949728965759277
generate_one_block  0.1268622875213623
generate_one_block  0.13052773475646973
generate_one_block  0.13335371017456055
generate_one_block  0.13330841064453125
generate_one_block  0.1284162998199463
generate_one_block  0.16559743881225586
generate_one_block  0.14804959297180176
generate_one_block  0.18939709663391113
generate_one_block  0.18645858764648438
generate_one_block  0.18659424781799316
generate_one_block  0.15296244621276855
generate_one_block  0.13719749450683594
generate_one_block  0.13072800636291504
generate_one_block  0.1279008388519287
generate_one_block  0.13498640060424805
generate_one_block  0.156691312789917
generate_one_block  0.16683673858642578
generate_one_block  0.15015268325805664
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.2649648189544678
gen group dst list time:  0.3810257911682129
time for parepare:  0.46780991554260254
local_output_nid generation:  0.04412722587585449
local_in_edges_tensor generation:  0.4392240047454834
mini_batch_src_global generation:  0.32427144050598145
r_  generation:  3.7947986125946045
local_output_nid generation:  0.047987937927246094
local_in_edges_tensor generation:  0.20839953422546387
mini_batch_src_global generation:  0.4591095447540283
r_  generation:  3.990751266479492
local_output_nid generation:  0.061379432678222656
local_in_edges_tensor generation:  0.2895946502685547
mini_batch_src_global generation:  0.39327263832092285
r_  generation:  4.201317548751831
local_output_nid generation:  0.05759596824645996
local_in_edges_tensor generation:  0.3823578357696533
mini_batch_src_global generation:  0.42937278747558594
r_  generation:  4.056259393692017
local_output_nid generation:  0.058261871337890625
local_in_edges_tensor generation:  0.255993127822876
mini_batch_src_global generation:  0.42329883575439453
r_  generation:  4.176698207855225
local_output_nid generation:  0.05552816390991211
local_in_edges_tensor generation:  0.2386476993560791
mini_batch_src_global generation:  0.45330047607421875
r_  generation:  4.167910814285278
local_output_nid generation:  0.0568850040435791
local_in_edges_tensor generation:  0.3560316562652588
mini_batch_src_global generation:  0.4345216751098633
r_  generation:  4.233737945556641
local_output_nid generation:  0.07217717170715332
local_in_edges_tensor generation:  0.29079365730285645
mini_batch_src_global generation:  0.4335200786590576
r_  generation:  4.145262002944946
local_output_nid generation:  0.05838203430175781
local_in_edges_tensor generation:  0.25196218490600586
mini_batch_src_global generation:  0.4407498836517334
r_  generation:  4.219334602355957
local_output_nid generation:  0.05832695960998535
local_in_edges_tensor generation:  0.24099206924438477
mini_batch_src_global generation:  0.44666337966918945
r_  generation:  4.289119482040405
local_output_nid generation:  0.05889129638671875
local_in_edges_tensor generation:  0.3706953525543213
mini_batch_src_global generation:  0.45458436012268066
r_  generation:  4.296505689620972
local_output_nid generation:  0.0713038444519043
local_in_edges_tensor generation:  0.27179980278015137
mini_batch_src_global generation:  0.5177083015441895
r_  generation:  4.87713360786438
local_output_nid generation:  0.09052753448486328
local_in_edges_tensor generation:  0.3667416572570801
mini_batch_src_global generation:  0.5553772449493408
r_  generation:  4.249950170516968
local_output_nid generation:  0.07272458076477051
local_in_edges_tensor generation:  0.27367687225341797
mini_batch_src_global generation:  0.4943568706512451
r_  generation:  4.392054796218872
local_output_nid generation:  0.0662686824798584
local_in_edges_tensor generation:  0.37554287910461426
mini_batch_src_global generation:  0.4615800380706787
r_  generation:  4.2126240730285645
local_output_nid generation:  0.06745290756225586
local_in_edges_tensor generation:  0.27266526222229004
mini_batch_src_global generation:  0.45091843605041504
r_  generation:  4.285366535186768
local_output_nid generation:  0.061032772064208984
local_in_edges_tensor generation:  0.2635843753814697
mini_batch_src_global generation:  0.4553375244140625
r_  generation:  4.369601249694824
local_output_nid generation:  0.06041073799133301
local_in_edges_tensor generation:  0.29792046546936035
mini_batch_src_global generation:  0.45423269271850586
r_  generation:  4.292699575424194
local_output_nid generation:  0.0829935073852539
local_in_edges_tensor generation:  0.31192517280578613
mini_batch_src_global generation:  0.4481649398803711
r_  generation:  4.076391935348511
local_output_nid generation:  0.0629887580871582
local_in_edges_tensor generation:  0.2617974281311035
mini_batch_src_global generation:  0.46025562286376953
r_  generation:  4.32756233215332
local_output_nid generation:  0.06155514717102051
local_in_edges_tensor generation:  0.24269461631774902
mini_batch_src_global generation:  0.4558866024017334
r_  generation:  4.329359531402588
local_output_nid generation:  0.061844587326049805
local_in_edges_tensor generation:  0.3552372455596924
mini_batch_src_global generation:  0.4498026371002197
r_  generation:  4.2660064697265625
local_output_nid generation:  0.08465003967285156
local_in_edges_tensor generation:  0.27409958839416504
mini_batch_src_global generation:  0.45096564292907715
r_  generation:  4.218541860580444
local_output_nid generation:  0.06177854537963867
local_in_edges_tensor generation:  0.2513880729675293
mini_batch_src_global generation:  0.4860422611236572
r_  generation:  4.270804166793823
local_output_nid generation:  0.06197333335876465
local_in_edges_tensor generation:  0.2416975498199463
mini_batch_src_global generation:  0.4795956611633301
r_  generation:  4.142096757888794
local_output_nid generation:  0.06958174705505371
local_in_edges_tensor generation:  0.3748025894165039
mini_batch_src_global generation:  0.4494647979736328
r_  generation:  4.232085227966309
local_output_nid generation:  0.07129430770874023
local_in_edges_tensor generation:  0.27612733840942383
mini_batch_src_global generation:  0.5295429229736328
r_  generation:  5.091922998428345
local_output_nid generation:  0.10124540328979492
local_in_edges_tensor generation:  0.38399839401245117
mini_batch_src_global generation:  0.4809126853942871
r_  generation:  4.388603687286377
local_output_nid generation:  0.09228396415710449
local_in_edges_tensor generation:  0.2872335910797119
mini_batch_src_global generation:  0.472440242767334
r_  generation:  4.391520023345947
local_output_nid generation:  0.06297063827514648
local_in_edges_tensor generation:  0.36981201171875
mini_batch_src_global generation:  0.4859733581542969
r_  generation:  4.278465270996094
local_output_nid generation:  0.07934856414794922
local_in_edges_tensor generation:  0.2757120132446289
mini_batch_src_global generation:  0.4563770294189453
r_  generation:  4.2875330448150635
local_output_nid generation:  0.0632631778717041
local_in_edges_tensor generation:  0.257828950881958
mini_batch_src_global generation:  0.4705026149749756
r_  generation:  4.3644700050354
local_output_nid generation:  0.06299662590026855
local_in_edges_tensor generation:  0.2503056526184082
mini_batch_src_global generation:  0.4588139057159424
r_  generation:  4.339278936386108
local_output_nid generation:  0.08892440795898438
local_in_edges_tensor generation:  0.37020087242126465
mini_batch_src_global generation:  0.45428037643432617
r_  generation:  4.265421628952026
local_output_nid generation:  0.06316637992858887
local_in_edges_tensor generation:  0.278827428817749
mini_batch_src_global generation:  0.45323610305786133
r_  generation:  4.306856393814087
local_output_nid generation:  0.06298828125
local_in_edges_tensor generation:  0.26775312423706055
mini_batch_src_global generation:  0.44945406913757324
r_  generation:  4.341658115386963
local_output_nid generation:  0.06344890594482422
local_in_edges_tensor generation:  0.37244200706481934
mini_batch_src_global generation:  0.4715251922607422
r_  generation:  4.329487562179565
local_output_nid generation:  0.09055900573730469
local_in_edges_tensor generation:  0.27635836601257324
mini_batch_src_global generation:  0.45302534103393555
r_  generation:  4.253973960876465
local_output_nid generation:  0.06359338760375977
local_in_edges_tensor generation:  0.2635350227355957
mini_batch_src_global generation:  0.47214674949645996
r_  generation:  4.360003709793091
local_output_nid generation:  0.07553696632385254
local_in_edges_tensor generation:  0.2710390090942383
mini_batch_src_global generation:  0.4629378318786621
r_  generation:  4.318033695220947
local_output_nid generation:  0.09083986282348633
local_in_edges_tensor generation:  0.35410523414611816
mini_batch_src_global generation:  0.4566679000854492
r_  generation:  4.2616589069366455
local_output_nid generation:  0.06372809410095215
local_in_edges_tensor generation:  0.2763702869415283
mini_batch_src_global generation:  0.45513129234313965
r_  generation:  4.302858829498291
local_output_nid generation:  0.06426239013671875
local_in_edges_tensor generation:  0.2600834369659424
mini_batch_src_global generation:  0.4634256362915039
r_  generation:  4.391279935836792
local_output_nid generation:  0.06430363655090332
local_in_edges_tensor generation:  0.3054525852203369
mini_batch_src_global generation:  0.45630335807800293
r_  generation:  4.328157663345337
local_output_nid generation:  0.09126687049865723
local_in_edges_tensor generation:  0.33435654640197754
mini_batch_src_global generation:  0.4524040222167969
r_  generation:  4.258858680725098
local_output_nid generation:  0.06368660926818848
local_in_edges_tensor generation:  0.2717776298522949
mini_batch_src_global generation:  0.45098257064819336
r_  generation:  4.3184802532196045
local_output_nid generation:  0.06387996673583984
local_in_edges_tensor generation:  0.25063419342041016
mini_batch_src_global generation:  0.45316410064697266
r_  generation:  4.349846839904785
local_output_nid generation:  0.0672159194946289
local_in_edges_tensor generation:  0.31288576126098633
mini_batch_src_global generation:  0.45572710037231445
r_  generation:  4.332066297531128
local_output_nid generation:  0.09192180633544922
local_in_edges_tensor generation:  0.33687472343444824
mini_batch_src_global generation:  0.4542124271392822
r_  generation:  4.104693651199341
local_output_nid generation:  0.06423044204711914
local_in_edges_tensor generation:  0.26695966720581055
mini_batch_src_global generation:  0.45598912239074707
r_  generation:  4.295198440551758
local_output_nid generation:  0.06374526023864746
local_in_edges_tensor generation:  0.26257848739624023
mini_batch_src_global generation:  0.45142030715942383
r_  generation:  4.347484111785889
local_output_nid generation:  0.06432294845581055
local_in_edges_tensor generation:  0.38143467903137207
mini_batch_src_global generation:  0.47704625129699707
r_  generation:  4.30479621887207
local_output_nid generation:  0.09279322624206543
local_in_edges_tensor generation:  0.2737610340118408
mini_batch_src_global generation:  0.4489762783050537
r_  generation:  4.1193718910217285
local_output_nid generation:  0.06463098526000977
local_in_edges_tensor generation:  0.2577030658721924
mini_batch_src_global generation:  0.47287821769714355
r_  generation:  4.3418920040130615
local_output_nid generation:  0.0670919418334961
local_in_edges_tensor generation:  0.24691009521484375
mini_batch_src_global generation:  0.4853372573852539
r_  generation:  4.304879903793335
local_output_nid generation:  0.07384800910949707
local_in_edges_tensor generation:  0.3927345275878906
mini_batch_src_global generation:  0.4714317321777344
r_  generation:  4.287152290344238
local_output_nid generation:  0.07446408271789551
local_in_edges_tensor generation:  0.2756466865539551
mini_batch_src_global generation:  0.4583742618560791
r_  generation:  4.332783460617065
local_output_nid generation:  0.06534433364868164
local_in_edges_tensor generation:  0.25872015953063965
mini_batch_src_global generation:  0.4682493209838867
r_  generation:  4.414897203445435
local_output_nid generation:  0.0628211498260498
local_in_edges_tensor generation:  0.30916452407836914
mini_batch_src_global generation:  0.4508516788482666
r_  generation:  4.142916679382324
local_output_nid generation:  0.09391522407531738
local_in_edges_tensor generation:  0.3267831802368164
mini_batch_src_global generation:  0.45056796073913574
r_  generation:  4.117698669433594
local_output_nid generation:  0.0648958683013916
local_in_edges_tensor generation:  0.26900649070739746
mini_batch_src_global generation:  0.4540553092956543
r_  generation:  4.366363763809204
local_output_nid generation:  0.06392288208007812
local_in_edges_tensor generation:  0.24855995178222656
mini_batch_src_global generation:  0.4617924690246582
r_  generation:  4.334913492202759
local_output_nid generation:  0.0644071102142334
local_in_edges_tensor generation:  0.37415075302124023
mini_batch_src_global generation:  0.4531722068786621
r_  generation:  4.3277716636657715
local_output_nid generation:  0.09266495704650879
local_in_edges_tensor generation:  0.2708721160888672
mini_batch_src_global generation:  0.44576382637023926
r_  generation:  4.178376913070679
----------------------check_connections_block total spend ----------------------------- 375.66036772727966
generate_one_block  5.899213075637817
generate_one_block  6.340869426727295
generate_one_block  5.506418704986572
generate_one_block  5.428610563278198
generate_one_block  5.487682342529297
generate_one_block  5.770133972167969
generate_one_block  5.569296598434448
generate_one_block  5.3720550537109375
generate_one_block  5.451531887054443
generate_one_block  5.653947830200195
generate_one_block  5.701556205749512
generate_one_block  5.432068824768066
generate_one_block  5.443690538406372
generate_one_block  5.64103364944458
generate_one_block  5.685490608215332
generate_one_block  5.394489765167236
generate_one_block  5.488612413406372
generate_one_block  5.528382301330566
generate_one_block  5.7022905349731445
generate_one_block  5.503347396850586
generate_one_block  5.429683446884155
generate_one_block  5.498567581176758
generate_one_block  5.721081256866455
generate_one_block  5.403357744216919
generate_one_block  5.417664051055908
generate_one_block  5.660465717315674
generate_one_block  5.6929545402526855
generate_one_block  6.032464027404785
generate_one_block  5.459573030471802
generate_one_block  5.67036509513855
generate_one_block  5.596219062805176
generate_one_block  5.409177780151367
generate_one_block  5.482841730117798
generate_one_block  5.64743971824646
generate_one_block  5.627878427505493
generate_one_block  5.382977485656738
generate_one_block  5.446504831314087
generate_one_block  5.527377605438232
generate_one_block  5.747248649597168
generate_one_block  5.368487119674683
generate_one_block  5.557766914367676
generate_one_block  5.582404613494873
generate_one_block  5.728784799575806
generate_one_block  5.4443254470825195
generate_one_block  5.448091745376587
generate_one_block  5.591679334640503
generate_one_block  5.667649507522583
generate_one_block  5.474308252334595
generate_one_block  5.436701059341431
generate_one_block  5.630320072174072
generate_one_block  5.686363935470581
generate_one_block  5.407938480377197
generate_one_block  5.415179252624512
generate_one_block  5.7241058349609375
generate_one_block  5.7172932624816895
generate_one_block  5.489060163497925
generate_one_block  5.4781646728515625
generate_one_block  5.885655164718628
generate_one_block  5.385821580886841
generate_one_block  5.425327777862549
generate_one_block  5.499517440795898
generate_one_block  5.843568801879883
generate_one_block  5.407998561859131
generate_one_block  5.333212375640869
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.0564846992492676
gen group dst list time:  3.033957004547119
time for parepare:  0.4657416343688965
local_output_nid generation:  0.43047547340393066
local_in_edges_tensor generation:  1.0952718257904053
mini_batch_src_global generation:  0.933251142501831
r_  generation:  11.970081090927124
local_output_nid generation:  0.48586511611938477
local_in_edges_tensor generation:  1.1052086353302002
mini_batch_src_global generation:  1.224426031112671
r_  generation:  12.295099973678589
local_output_nid generation:  0.4806199073791504
local_in_edges_tensor generation:  1.0422539710998535
mini_batch_src_global generation:  1.233006477355957
r_  generation:  12.535194873809814
local_output_nid generation:  0.4748232364654541
local_in_edges_tensor generation:  1.0202116966247559
mini_batch_src_global generation:  1.2811777591705322
r_  generation:  12.389705896377563
local_output_nid generation:  0.5058856010437012
local_in_edges_tensor generation:  0.9077780246734619
mini_batch_src_global generation:  1.376685619354248
r_  generation:  12.615890979766846
local_output_nid generation:  0.5053467750549316
local_in_edges_tensor generation:  1.0261800289154053
mini_batch_src_global generation:  1.3873016834259033
r_  generation:  12.551356554031372
local_output_nid generation:  0.5010430812835693
local_in_edges_tensor generation:  1.0374534130096436
mini_batch_src_global generation:  1.4533443450927734
r_  generation:  13.021126747131348
local_output_nid generation:  0.5051050186157227
local_in_edges_tensor generation:  1.028148889541626
mini_batch_src_global generation:  1.245509147644043
r_  generation:  12.731428146362305
local_output_nid generation:  0.5031721591949463
local_in_edges_tensor generation:  1.0443482398986816
mini_batch_src_global generation:  1.2400314807891846
r_  generation:  12.721294164657593
local_output_nid generation:  0.4842875003814697
local_in_edges_tensor generation:  1.0612468719482422
mini_batch_src_global generation:  1.3942818641662598
r_  generation:  12.890080690383911
local_output_nid generation:  0.5118718147277832
local_in_edges_tensor generation:  1.0335185527801514
mini_batch_src_global generation:  1.2465753555297852
r_  generation:  12.904184818267822
local_output_nid generation:  0.5212030410766602
local_in_edges_tensor generation:  1.0330226421356201
mini_batch_src_global generation:  1.2187669277191162
r_  generation:  12.691497802734375
local_output_nid generation:  0.49704718589782715
local_in_edges_tensor generation:  1.056257963180542
mini_batch_src_global generation:  1.2765560150146484
r_  generation:  12.701651334762573
local_output_nid generation:  0.4814438819885254
local_in_edges_tensor generation:  1.0514631271362305
mini_batch_src_global generation:  1.3094899654388428
r_  generation:  12.498618841171265
local_output_nid generation:  0.513840913772583
local_in_edges_tensor generation:  0.92875075340271
mini_batch_src_global generation:  1.4050014019012451
r_  generation:  12.506542921066284
local_output_nid generation:  0.5186491012573242
local_in_edges_tensor generation:  1.0477025508880615
mini_batch_src_global generation:  1.4074621200561523
r_  generation:  12.591888427734375
local_output_nid generation:  0.5159347057342529
local_in_edges_tensor generation:  1.045881748199463
mini_batch_src_global generation:  1.2838850021362305
r_  generation:  12.812461853027344
local_output_nid generation:  0.5129873752593994
local_in_edges_tensor generation:  1.0471045970916748
mini_batch_src_global generation:  1.225203514099121
r_  generation:  12.972617149353027
local_output_nid generation:  0.5220000743865967
local_in_edges_tensor generation:  1.040231704711914
mini_batch_src_global generation:  1.2245643138885498
r_  generation:  12.72940707206726
local_output_nid generation:  0.4885745048522949
local_in_edges_tensor generation:  1.0561981201171875
mini_batch_src_global generation:  1.3183636665344238
r_  generation:  12.72564697265625
local_output_nid generation:  0.498016357421875
local_in_edges_tensor generation:  1.0593798160552979
mini_batch_src_global generation:  1.2991273403167725
r_  generation:  12.531501531600952
local_output_nid generation:  0.5080249309539795
local_in_edges_tensor generation:  0.9993906021118164
mini_batch_src_global generation:  1.485034465789795
r_  generation:  12.894232034683228
local_output_nid generation:  0.5126810073852539
local_in_edges_tensor generation:  1.047084093093872
mini_batch_src_global generation:  1.2507283687591553
r_  generation:  12.797132968902588
local_output_nid generation:  0.4909534454345703
local_in_edges_tensor generation:  1.071329116821289
mini_batch_src_global generation:  1.2920806407928467
r_  generation:  12.660645008087158
local_output_nid generation:  0.4816582202911377
local_in_edges_tensor generation:  1.0548079013824463
mini_batch_src_global generation:  1.2896192073822021
r_  generation:  12.441236972808838
local_output_nid generation:  0.514070987701416
local_in_edges_tensor generation:  0.9462761878967285
mini_batch_src_global generation:  1.4216892719268799
r_  generation:  12.471182823181152
local_output_nid generation:  0.5252385139465332
local_in_edges_tensor generation:  1.0458223819732666
mini_batch_src_global generation:  1.3193283081054688
r_  generation:  12.786715269088745
local_output_nid generation:  0.5175549983978271
local_in_edges_tensor generation:  1.072340726852417
mini_batch_src_global generation:  1.3250060081481934
r_  generation:  12.916465282440186
local_output_nid generation:  0.519094705581665
local_in_edges_tensor generation:  1.053889274597168
mini_batch_src_global generation:  1.2253029346466064
r_  generation:  12.937805652618408
local_output_nid generation:  0.5102112293243408
local_in_edges_tensor generation:  1.0634729862213135
mini_batch_src_global generation:  1.2787129878997803
r_  generation:  12.8707857131958
local_output_nid generation:  0.4980747699737549
local_in_edges_tensor generation:  1.0718767642974854
mini_batch_src_global generation:  1.2826263904571533
r_  generation:  12.543657541275024
local_output_nid generation:  0.49454617500305176
local_in_edges_tensor generation:  1.0552613735198975
mini_batch_src_global generation:  1.3434734344482422
r_  generation:  12.502840280532837
local_output_nid generation:  0.5182156562805176
local_in_edges_tensor generation:  0.9373173713684082
mini_batch_src_global generation:  1.4112462997436523
r_  generation:  12.717728853225708
local_output_nid generation:  0.5135085582733154
local_in_edges_tensor generation:  1.086122989654541
mini_batch_src_global generation:  1.279181718826294
r_  generation:  12.764018774032593
local_output_nid generation:  0.5118918418884277
local_in_edges_tensor generation:  1.0487186908721924
mini_batch_src_global generation:  1.2394278049468994
r_  generation:  13.046977758407593
local_output_nid generation:  0.515540361404419
local_in_edges_tensor generation:  1.0559983253479004
mini_batch_src_global generation:  1.2266738414764404
r_  generation:  12.868415355682373
local_output_nid generation:  0.4939284324645996
local_in_edges_tensor generation:  1.0758569240570068
mini_batch_src_global generation:  1.2685914039611816
r_  generation:  12.834457159042358
local_output_nid generation:  0.48817014694213867
local_in_edges_tensor generation:  1.0607969760894775
mini_batch_src_global generation:  1.296337366104126
r_  generation:  12.559351921081543
local_output_nid generation:  0.5157961845397949
local_in_edges_tensor generation:  0.9350128173828125
mini_batch_src_global generation:  1.4258720874786377
r_  generation:  12.629011154174805
local_output_nid generation:  0.532322883605957
local_in_edges_tensor generation:  1.0759859085083008
mini_batch_src_global generation:  1.288297176361084
r_  generation:  12.768050909042358
local_output_nid generation:  0.5173749923706055
local_in_edges_tensor generation:  1.0616412162780762
mini_batch_src_global generation:  1.280850887298584
r_  generation:  12.992483377456665
local_output_nid generation:  0.5210340023040771
local_in_edges_tensor generation:  1.0542128086090088
mini_batch_src_global generation:  1.2218852043151855
r_  generation:  12.939404487609863
local_output_nid generation:  0.5022706985473633
local_in_edges_tensor generation:  1.0804591178894043
mini_batch_src_global generation:  1.2663483619689941
r_  generation:  12.82962441444397
local_output_nid generation:  0.5089089870452881
local_in_edges_tensor generation:  1.069685459136963
mini_batch_src_global generation:  1.3059704303741455
r_  generation:  12.63559627532959
local_output_nid generation:  0.4904747009277344
local_in_edges_tensor generation:  0.929774284362793
mini_batch_src_global generation:  1.3755106925964355
r_  generation:  12.567713737487793
local_output_nid generation:  0.5383255481719971
local_in_edges_tensor generation:  1.0598726272583008
mini_batch_src_global generation:  1.3185350894927979
r_  generation:  12.652520895004272
local_output_nid generation:  0.519582986831665
local_in_edges_tensor generation:  1.0632133483886719
mini_batch_src_global generation:  1.291799545288086
r_  generation:  12.801174640655518
local_output_nid generation:  0.5152332782745361
local_in_edges_tensor generation:  1.0507707595825195
mini_batch_src_global generation:  1.2235219478607178
r_  generation:  12.934220314025879
local_output_nid generation:  0.5152132511138916
local_in_edges_tensor generation:  1.045975923538208
mini_batch_src_global generation:  1.2216072082519531
r_  generation:  12.755578994750977
local_output_nid generation:  0.5068275928497314
local_in_edges_tensor generation:  1.0694684982299805
mini_batch_src_global generation: Using backend: pytorch
 1.3158164024353027
r_  generation:  12.716068983078003
local_output_nid generation:  0.48738861083984375
local_in_edges_tensor generation:  1.0326507091522217
mini_batch_src_global generation:  1.2963237762451172
r_  generation:  12.626699447631836
local_output_nid generation:  0.5179696083068848
local_in_edges_tensor generation:  0.9640078544616699
mini_batch_src_global generation:  1.3483247756958008
r_  generation:  12.585498571395874
local_output_nid generation:  0.5157256126403809
local_in_edges_tensor generation:  1.0845446586608887
mini_batch_src_global generation:  1.3026401996612549
r_  generation:  12.707090854644775
local_output_nid generation:  0.5170893669128418
local_in_edges_tensor generation:  1.0546808242797852
mini_batch_src_global generation:  1.2654848098754883
r_  generation:  12.894160985946655
local_output_nid generation:  0.517383337020874
local_in_edges_tensor generation:  1.0729279518127441
mini_batch_src_global generation:  1.2416598796844482
r_  generation:  12.886658430099487
local_output_nid generation:  0.4786407947540283
local_in_edges_tensor generation:  1.0718657970428467
mini_batch_src_global generation:  1.297307014465332
r_  generation:  12.814098596572876
local_output_nid generation:  0.5174119472503662
local_in_edges_tensor generation:  0.9267280101776123
mini_batch_src_global generation:  1.3803069591522217
r_  generation:  12.649563074111938
local_output_nid generation:  0.5277025699615479
local_in_edges_tensor generation:  5.233710765838623
mini_batch_src_global generation:  1.3629505634307861
r_  generation:  12.587486267089844
local_output_nid generation:  0.513221025466919
local_in_edges_tensor generation:  1.0483407974243164
mini_batch_src_global generation:  1.2196307182312012
r_  generation:  12.788626670837402
local_output_nid generation:  0.486555814743042
local_in_edges_tensor generation:  1.042609691619873
mini_batch_src_global generation:  1.242211103439331
r_  generation:  12.429589986801147
local_output_nid generation:  0.5041115283966064
local_in_edges_tensor generation:  0.932396650314331
mini_batch_src_global generation:  1.2844934463500977
r_  generation:  12.848138570785522
local_output_nid generation:  0.5228292942047119
local_in_edges_tensor generation:  1.0527799129486084
mini_batch_src_global generation:  1.223602533340454
r_  generation:  12.78073763847351
local_output_nid generation:  0.5035960674285889
local_in_edges_tensor generation:  1.085411787033081
mini_batch_src_global generation:  1.2819077968597412
r_  generation:  12.499027967453003
local_output_nid generation:  0.48703956604003906
local_in_edges_tensor generation:  0.9397573471069336
mini_batch_src_global generation:  1.3874669075012207
r_  generation:  12.585419416427612
----------------------check_connections_block total spend ----------------------------- 1147.8666787147522
generate_one_block  17.329468727111816
generate_one_block  17.202775955200195
generate_one_block  17.53088402748108
generate_one_block  17.539694786071777
generate_one_block  17.44140625
generate_one_block  17.363394737243652
generate_one_block  16.913668155670166
generate_one_block  17.311788082122803
generate_one_block  17.272825479507446
generate_one_block  17.18247890472412
generate_one_block  17.43324637413025
generate_one_block  17.322981595993042
generate_one_block  17.830370664596558
generate_one_block  17.06213879585266
generate_one_block  17.031494855880737
generate_one_block  17.284654140472412
generate_one_block  17.23283815383911
generate_one_block  17.478237867355347
generate_one_block  17.29862904548645
generate_one_block  17.322409868240356
generate_one_block  16.907745122909546
generate_one_block  17.238070011138916
generate_one_block  17.366268396377563
generate_one_block  17.17005228996277
generate_one_block  17.242156744003296
generate_one_block  17.77359914779663
generate_one_block  17.327168464660645
generate_one_block  17.432390451431274
generate_one_block  16.954619646072388
generate_one_block  17.41122579574585
generate_one_block  17.255037307739258
generate_one_block  17.331859350204468
generate_one_block  17.35094118118286
generate_one_block  17.456448793411255
generate_one_block  17.43817138671875
generate_one_block  17.397089958190918
generate_one_block  17.348676919937134
generate_one_block  17.031064748764038
generate_one_block  17.60336208343506
generate_one_block  17.402376651763916
generate_one_block  17.501574516296387
generate_one_block  17.30271887779236
generate_one_block  17.43296504020691
generate_one_block  17.471333980560303
generate_one_block  17.442916870117188
generate_one_block  17.316391229629517
generate_one_block  17.258948802947998
generate_one_block  17.065632820129395
generate_one_block  16.887646198272705
generate_one_block  17.894161701202393
generate_one_block  18.0633282661438
generate_one_block  18.700743675231934
generate_one_block  18.57141637802124
generate_one_block  18.77176260948181
generate_one_block  18.94617795944214
generate_one_block  18.99182629585266
generate_one_block  18.842044591903687
generate_one_block  19.127867460250854
generate_one_block  18.88297438621521
generate_one_block  19.05934715270996
generate_one_block  19.146005392074585
generate_one_block  19.283883094787598
generate_one_block  19.210276126861572
generate_one_block  19.482985734939575
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0006527900695800781  GigaBytes
Max Memory Allocated: 0.0006527900695800781  GigaBytes

connection checking time:  1523.5270464420319
block generation total time  1487.962929725647
average batch blocks generation time:  23.249420776963234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1766357421875 GB
    Memory Allocated: 1.0836434364318848  GigaBytes
Max Memory Allocated: 1.0836434364318848  GigaBytes

Traceback (most recent call last):
  File "pseudo_mini_batch_range_products_sage.py", line 455, in <module>
    main()
  File "pseudo_mini_batch_range_products_sage.py", line 451, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_products_sage.py", line 276, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_products.py", line 48, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 20.47 GiB already allocated; 9.44 MiB free; 21.08 GiB reserved in total by PyTorch)
