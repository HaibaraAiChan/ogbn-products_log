main start at this time 1647909600.502765
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6455471515655518
random selection method range initialization spend 0.015085697174072266
time for parepare:  0.36502671241760254
local_output_nid generation:  0.003561735153198242
local_in_edges_tensor generation:  0.03199005126953125
mini_batch_src_global generation:  0.018566131591796875
r_  generation:  0.16426992416381836
local_output_nid generation:  0.0037355422973632812
local_in_edges_tensor generation:  0.005753755569458008
mini_batch_src_global generation:  0.026721715927124023
r_  generation:  0.18261361122131348
local_output_nid generation:  0.0036988258361816406
local_in_edges_tensor generation:  0.0052683353424072266
mini_batch_src_global generation:  0.011099100112915039
r_  generation:  0.19293212890625
local_output_nid generation:  0.0037360191345214844
local_in_edges_tensor generation:  0.005314826965332031
mini_batch_src_global generation:  0.011643171310424805
r_  generation:  0.20164251327514648
local_output_nid generation:  0.00368499755859375
local_in_edges_tensor generation:  0.005266666412353516
mini_batch_src_global generation:  0.011451959609985352
r_  generation:  0.20607256889343262
local_output_nid generation:  0.003730297088623047
local_in_edges_tensor generation:  0.00520777702331543
mini_batch_src_global generation:  0.013499021530151367
r_  generation:  0.21398663520812988
local_output_nid generation:  0.0037164688110351562
local_in_edges_tensor generation:  0.005168914794921875
mini_batch_src_global generation:  0.014208793640136719
r_  generation:  0.2238612174987793
local_output_nid generation:  0.003674745559692383
local_in_edges_tensor generation:  0.005236148834228516
mini_batch_src_global generation:  0.014216423034667969
r_  generation:  0.2276761531829834
local_output_nid generation:  0.00365447998046875
local_in_edges_tensor generation:  0.005239009857177734
mini_batch_src_global generation:  0.01517486572265625
r_  generation:  0.22536826133728027
local_output_nid generation:  0.003674745559692383
local_in_edges_tensor generation:  0.005135059356689453
mini_batch_src_global generation:  0.015727996826171875
r_  generation:  0.23456358909606934
local_output_nid generation:  0.003674745559692383
local_in_edges_tensor generation:  0.005126237869262695
mini_batch_src_global generation:  0.0166780948638916
r_  generation:  0.23439407348632812
local_output_nid generation:  0.0036923885345458984
local_in_edges_tensor generation:  0.005580425262451172
mini_batch_src_global generation:  0.01736903190612793
r_  generation:  0.24228167533874512
local_output_nid generation:  0.003718137741088867
local_in_edges_tensor generation:  0.0050809383392333984
mini_batch_src_global generation:  0.01748037338256836
r_  generation:  0.24718379974365234
local_output_nid generation:  0.003658294677734375
local_in_edges_tensor generation:  0.010772228240966797
mini_batch_src_global generation:  0.017991304397583008
r_  generation:  0.2407057285308838
local_output_nid generation:  0.003663778305053711
local_in_edges_tensor generation:  0.009328126907348633
mini_batch_src_global generation:  0.018624305725097656
r_  generation:  0.24472570419311523
local_output_nid generation:  0.0036673545837402344
local_in_edges_tensor generation:  0.008585214614868164
mini_batch_src_global generation:  0.01988363265991211
r_  generation:  0.24998736381530762
local_output_nid generation:  0.003679990768432617
local_in_edges_tensor generation:  0.00799250602722168
mini_batch_src_global generation:  0.019174575805664062
r_  generation:  0.24698305130004883
local_output_nid generation:  0.003659963607788086
local_in_edges_tensor generation:  0.007521390914916992
mini_batch_src_global generation:  0.019304275512695312
r_  generation:  0.24502062797546387
local_output_nid generation:  0.0036592483520507812
local_in_edges_tensor generation:  0.006930828094482422
mini_batch_src_global generation:  0.019197463989257812
r_  generation:  0.25196218490600586
local_output_nid generation:  0.0036919116973876953
local_in_edges_tensor generation:  0.006490230560302734
mini_batch_src_global generation:  0.01983046531677246
r_  generation:  0.24288129806518555
local_output_nid generation:  0.0036950111389160156
local_in_edges_tensor generation:  0.005960941314697266
mini_batch_src_global generation:  0.01977825164794922
r_  generation:  0.24905157089233398
local_output_nid generation:  0.003688812255859375
local_in_edges_tensor generation:  0.005984306335449219
mini_batch_src_global generation:  0.019550323486328125
r_  generation:  0.2535891532897949
local_output_nid generation:  0.0036835670471191406
local_in_edges_tensor generation:  0.005762338638305664
mini_batch_src_global generation:  0.02640080451965332
r_  generation:  0.25072431564331055
local_output_nid generation:  0.003640413284301758
local_in_edges_tensor generation:  0.0057375431060791016
mini_batch_src_global generation:  0.0198361873626709
r_  generation:  0.24704456329345703
local_output_nid generation:  0.0036623477935791016
local_in_edges_tensor generation:  0.005524158477783203
mini_batch_src_global generation:  0.019821882247924805
r_  generation:  0.2519338130950928
local_output_nid generation:  0.003667593002319336
local_in_edges_tensor generation:  0.006344318389892578
mini_batch_src_global generation:  0.02008533477783203
r_  generation:  0.24769186973571777
local_output_nid generation:  0.003662109375
local_in_edges_tensor generation:  0.010697364807128906
mini_batch_src_global generation:  0.020491838455200195
r_  generation:  0.2515137195587158
local_output_nid generation:  0.0047986507415771484
local_in_edges_tensor generation:  0.00957345962524414
mini_batch_src_global generation:  0.019773006439208984
r_  generation:  0.2500579357147217
local_output_nid generation:  0.0036644935607910156
local_in_edges_tensor generation:  0.008687973022460938
mini_batch_src_global generation:  0.020405292510986328
r_  generation:  0.2506892681121826
local_output_nid generation:  0.003663778305053711
local_in_edges_tensor generation:  0.00784921646118164
mini_batch_src_global generation:  0.019500732421875
r_  generation:  0.2503843307495117
local_output_nid generation:  0.0036499500274658203
local_in_edges_tensor generation:  0.0073473453521728516
mini_batch_src_global generation:  0.020278215408325195
r_  generation:  0.2498641014099121
local_output_nid generation:  0.0036230087280273438
local_in_edges_tensor generation:  0.06294775009155273
mini_batch_src_global generation:  0.019752025604248047
r_  generation:  0.2468404769897461
----------------------check_connections_block total spend ----------------------------- 10.369147777557373
generate_one_block  5.795355319976807
generate_one_block  0.25039052963256836
generate_one_block  0.2510807514190674
generate_one_block  0.25726866722106934
generate_one_block  0.2553589344024658
generate_one_block  0.2563014030456543
generate_one_block  0.2722961902618408
generate_one_block  0.25532031059265137
generate_one_block  0.2517359256744385
generate_one_block  0.2588534355163574
generate_one_block  0.2563772201538086
generate_one_block  0.25725269317626953
generate_one_block  0.25427937507629395
generate_one_block  0.2581925392150879
generate_one_block  0.2540738582611084
generate_one_block  0.2565774917602539
generate_one_block  0.25222039222717285
generate_one_block  0.2554898262023926
generate_one_block  0.2596566677093506
generate_one_block  0.25493693351745605
generate_one_block  0.25774407386779785
generate_one_block  0.2582371234893799
generate_one_block  0.2594437599182129
generate_one_block  0.25531935691833496
generate_one_block  0.2631850242614746
generate_one_block  0.25763654708862305
generate_one_block  0.2552974224090576
generate_one_block  0.2716026306152344
generate_one_block  0.25853729248046875
generate_one_block  0.2550232410430908
generate_one_block  0.257094144821167
generate_one_block  0.256619930267334
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.856783866882324
gen group dst list time:  0.30380821228027344
time for parepare:  0.4659309387207031
local_output_nid generation:  0.1112208366394043
local_in_edges_tensor generation:  0.6192269325256348
mini_batch_src_global generation:  0.5560846328735352
r_  generation:  6.3869616985321045
local_output_nid generation:  0.10311269760131836
local_in_edges_tensor generation:  0.8120648860931396
mini_batch_src_global generation:  0.7016592025756836
r_  generation:  6.635412693023682
local_output_nid generation:  0.1376640796661377
local_in_edges_tensor generation:  0.8740274906158447
mini_batch_src_global generation:  0.6883087158203125
r_  generation:  6.641163110733032
local_output_nid generation:  0.10633397102355957
local_in_edges_tensor generation:  0.4244346618652344
mini_batch_src_global generation:  0.7083640098571777
r_  generation:  6.8080384731292725
local_output_nid generation:  0.10608887672424316
local_in_edges_tensor generation:  0.41524672508239746
mini_batch_src_global generation:  0.7792918682098389
r_  generation:  6.905750274658203
local_output_nid generation:  0.10706019401550293
local_in_edges_tensor generation:  0.41118621826171875
mini_batch_src_global generation:  0.7326452732086182
r_  generation:  7.075148582458496
local_output_nid generation:  0.11785650253295898
local_in_edges_tensor generation:  0.5682883262634277
mini_batch_src_global generation:  0.7811968326568604
r_  generation:  6.8835015296936035
local_output_nid generation:  0.11596822738647461
local_in_edges_tensor generation:  0.4376833438873291
mini_batch_src_global generation:  0.7563173770904541
r_  generation:  7.021517515182495
local_output_nid generation:  0.10457539558410645
local_in_edges_tensor generation:  0.4145691394805908
mini_batch_src_global generation:  0.7671351432800293
r_  generation:  6.923143625259399
local_output_nid generation:  0.13449716567993164
local_in_edges_tensor generation:  0.5661513805389404
mini_batch_src_global generation:  0.7416059970855713
r_  generation:  6.899437665939331
local_output_nid generation:  0.10544085502624512
local_in_edges_tensor generation:  0.4334540367126465
mini_batch_src_global generation:  0.7722592353820801
r_  generation:  7.055140256881714
local_output_nid generation:  0.10502052307128906
local_in_edges_tensor generation:  0.5698056221008301
mini_batch_src_global generation:  0.7788426876068115
r_  generation:  6.949537992477417
local_output_nid generation:  0.12992501258850098
local_in_edges_tensor generation:  0.43540430068969727
mini_batch_src_global generation:  0.8429553508758545
r_  generation:  8.00269603729248
local_output_nid generation:  0.13896989822387695
local_in_edges_tensor generation:  0.5705835819244385
mini_batch_src_global generation:  0.8369019031524658
r_  generation:  7.288829565048218
local_output_nid generation:  0.10509133338928223
local_in_edges_tensor generation:  0.5837843418121338
mini_batch_src_global generation:  0.788032054901123
r_  generation:  6.918747186660767
local_output_nid generation:  0.12390661239624023
local_in_edges_tensor generation:  0.43445396423339844
mini_batch_src_global generation:  0.7818293571472168
r_  generation:  7.114798545837402
local_output_nid generation:  0.10527181625366211
local_in_edges_tensor generation:  0.4902946949005127
mini_batch_src_global generation:  0.749464750289917
r_  generation:  7.009872198104858
local_output_nid generation:  0.13715887069702148
local_in_edges_tensor generation:  0.5069382190704346
mini_batch_src_global generation:  0.7483651638031006
r_  generation:  7.031126022338867
local_output_nid generation:  0.11033940315246582
local_in_edges_tensor generation:  0.42685699462890625
mini_batch_src_global generation:  0.778517484664917
r_  generation:  7.092862844467163
local_output_nid generation:  0.1186676025390625
local_in_edges_tensor generation:  0.5750899314880371
mini_batch_src_global generation:  0.7674977779388428
r_  generation:  6.922087669372559
local_output_nid generation:  0.11968541145324707
local_in_edges_tensor generation:  0.4341623783111572
mini_batch_src_global generation:  0.7814743518829346
r_  generation:  7.105498313903809
local_output_nid generation:  0.10531497001647949
local_in_edges_tensor generation:  0.5298557281494141
mini_batch_src_global generation:  0.7550301551818848
r_  generation:  6.999386310577393
local_output_nid generation:  0.1361386775970459
local_in_edges_tensor generation:  0.47988343238830566
mini_batch_src_global generation:  0.7617340087890625
r_  generation:  7.144988775253296
local_output_nid generation:  0.10901546478271484
local_in_edges_tensor generation:  0.4238286018371582
mini_batch_src_global generation:  0.7680597305297852
r_  generation:  7.05123496055603
local_output_nid generation:  0.13498401641845703
local_in_edges_tensor generation:  0.5663819313049316
mini_batch_src_global generation:  0.748035192489624
r_  generation:  6.876877069473267
local_output_nid generation:  0.10523533821105957
local_in_edges_tensor generation:  0.43791937828063965
mini_batch_src_global generation:  0.7938382625579834
r_  generation:  7.119229555130005
local_output_nid generation:  0.10671424865722656
local_in_edges_tensor generation:  0.5674891471862793
mini_batch_src_global generation:  0.7788021564483643
r_  generation:  6.944185256958008
local_output_nid generation:  0.12739086151123047
local_in_edges_tensor generation:  0.43587636947631836
mini_batch_src_global generation:  0.7488698959350586
r_  generation:  7.110109090805054
local_output_nid generation:  0.1052541732788086
local_in_edges_tensor generation:  0.4245021343231201
mini_batch_src_global generation:  0.7777678966522217
r_  generation:  7.035764932632446
local_output_nid generation:  0.13463187217712402
local_in_edges_tensor generation:  0.5712509155273438
mini_batch_src_global generation:  0.7483742237091064
r_  generation:  7.009368896484375
local_output_nid generation:  0.10715484619140625
local_in_edges_tensor generation:  0.44069671630859375
mini_batch_src_global generation:  0.7963597774505615
r_  generation:  7.110749006271362
local_output_nid generation:  0.13393497467041016
local_in_edges_tensor generation:  0.5807440280914307
mini_batch_src_global generation:  0.7578113079071045
r_  generation:  6.882588148117065
----------------------check_connections_block total spend ----------------------------- 306.5805721282959
generate_one_block  9.664913177490234
generate_one_block  9.645147800445557
generate_one_block  9.24601411819458
generate_one_block  9.814016580581665
generate_one_block  9.520915508270264
generate_one_block  9.350146055221558
generate_one_block  9.52386736869812
generate_one_block  9.131648540496826
generate_one_block  9.604525327682495
generate_one_block  9.336082935333252
generate_one_block  9.35363221168518
generate_one_block  9.52351450920105
generate_one_block  9.418024063110352
generate_one_block  9.651970624923706
generate_one_block  9.209646701812744
generate_one_block  9.57436227798462
generate_one_block  9.18343734741211
generate_one_block  9.572767496109009
generate_one_block  9.404969692230225
generate_one_block  9.297860622406006
generate_one_block  9.584798812866211
generate_one_block  9.283117294311523
generate_one_block  9.616179943084717
generate_one_block  9.151652097702026
generate_one_block  9.539690494537354
generate_one_block  9.326524019241333
generate_one_block  9.544925212860107
generate_one_block  9.18037223815918
generate_one_block  9.517675638198853
generate_one_block  9.305107593536377
generate_one_block  9.409905672073364
generate_one_block  9.311281681060791
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.334279775619507
gen group dst list time:  1.7912590503692627
time for parepare:  0.4596285820007324
local_output_nid generation:  0.5353634357452393
local_in_edges_tensor generation:  1.6875717639923096
mini_batch_src_global generation:  1.7537212371826172
r_  generation:  20.89794111251831
local_output_nid generation:  0.5833790302276611
local_in_edges_tensor generation:  1.7466113567352295
mini_batch_src_global generation:  2.426194429397583
r_  generation:  22.01772427558899
local_output_nid generation:  0.6215410232543945
local_in_edges_tensor generation:  1.8597760200500488
mini_batch_src_global generation:  2.3861794471740723
r_  generation:  21.866332292556763
local_output_nid generation:  0.6027145385742188
local_in_edges_tensor generation:  1.702202558517456
mini_batch_src_global generation:  2.428192377090454
r_  generation:  22.347171783447266
local_output_nid generation:  0.5948672294616699
local_in_edges_tensor generation:  1.7085497379302979
mini_batch_src_global generation:  2.3344550132751465
r_  generation:  22.01810359954834
local_output_nid generation:  0.5773000717163086
local_in_edges_tensor generation:  1.7078781127929688
mini_batch_src_global generation:  2.394594430923462
r_  generation:  22.369323253631592
local_output_nid generation:  0.5915224552154541
local_in_edges_tensor generation:  1.7183327674865723
mini_batch_src_global generation:  2.324509382247925
r_  generation:  22.05011820793152
local_output_nid generation:  0.5685479640960693
local_in_edges_tensor generation:  1.7008323669433594
mini_batch_src_global generation:  2.3865909576416016
r_  generation:  22.337095499038696
local_output_nid generation:  0.6155471801757812
local_in_edges_tensor generation:  1.6828937530517578
mini_batch_src_global generation:  2.3096110820770264
r_  generation:  21.995357275009155
local_output_nid generation:  0.607356071472168
local_in_edges_tensor generation:  1.7031199932098389
mini_batch_src_global generation:  2.423515558242798
r_  generation:  23.3560209274292
local_output_nid generation:  0.6095325946807861
local_in_edges_tensor generation:  1.750199556350708
mini_batch_src_global generation:  2.5590834617614746
r_  generation:  22.226859092712402
local_output_nid generation:  0.5959274768829346
local_in_edges_tensor generation:  1.7455899715423584
mini_batch_src_global generation:  2.542903423309326
r_  generation:  22.687552213668823
local_output_nid generation:  0.6272428035736084
local_in_edges_tensor generation:  1.708956241607666
mini_batch_src_global generation:  2.3634066581726074
r_  generation:  22.456855058670044
local_output_nid generation:  0.6073520183563232
local_in_edges_tensor generation:  1.7086679935455322
mini_batch_src_global generation:  2.382554769515991
r_  generation:  22.806200742721558
local_output_nid generation:  0.6127698421478271
local_in_edges_tensor generation:  1.7207887172698975
mini_batch_src_global generation:  2.4339754581451416
r_  generation:  22.516525268554688
local_output_nid generation:  0.6078882217407227
local_in_edges_tensor generation:  1.7345101833343506
mini_batch_src_global generation:  2.4772043228149414
r_  generation:  22.572070598602295
local_output_nid generation:  0.6088595390319824
local_in_edges_tensor generation:  1.7144279479980469
mini_batch_src_global generation:  2.528562307357788
r_  generation:  22.20287775993347
local_output_nid generation:  0.622826337814331
local_in_edges_tensor generation:  1.7221555709838867
mini_batch_src_global generation:  2.5152244567871094
r_  generation:  22.620007514953613
local_output_nid generation:  0.6159770488739014
local_in_edges_tensor generation:  1.8227059841156006
mini_batch_src_global generation:  2.560075044631958
r_  generation:  22.38035535812378
local_output_nid generation:  0.6003577709197998
local_in_edges_tensor generation:  1.7261693477630615
mini_batch_src_global generation:  2.4386847019195557
r_  generation:  22.836145162582397
local_output_nid generation:  0.6058871746063232
local_in_edges_tensor generation:  1.7044529914855957
mini_batch_src_global generation:  2.3382229804992676
r_  generation:  22.56308913230896
local_output_nid generation:  0.6126804351806641
local_in_edges_tensor generation:  1.7122771739959717
mini_batch_src_global generation:  2.467266798019409
r_  generation:  22.539307355880737
local_output_nid generation:  0.6158590316772461
local_in_edges_tensor generation:  1.7378120422363281
mini_batch_src_global generation:  2.627798080444336
r_  generation:  22.25753617286682
local_output_nid generation:  0.6097855567932129
local_in_edges_tensor generation:  1.7220568656921387
mini_batch_src_global generation:  2.4940338134765625
r_  generation:  22.388937950134277
local_output_nid generation:  0.6111299991607666
local_in_edges_tensor generation:  1.8113579750061035
mini_batch_src_global generation:  2.5564143657684326
r_  generation:  22.303576946258545
local_output_nid generation:  0.6390564441680908
local_in_edges_tensor generation:  1.714690923690796
mini_batch_src_global generation:  2.42122483253479
r_  generation:  22.623932123184204
local_output_nid generation:  0.6117961406707764
local_in_edges_tensor generation:  1.706963300704956
mini_batch_src_global generation:  2.353135585784912
r_  generation:  22.397267818450928
local_output_nid generation:  0.6130807399749756
local_in_edges_tensor generation:  1.7149691581726074
mini_batch_src_global generation:  2.5553555488586426
r_  generation:  22.52606511116028
local_output_nid generation:  0.6091816425323486
local_in_edges_tensor generation:  1.716275930404663
mini_batch_src_global generation:  2.7027182579040527
r_  generation:  22.4869225025177
local_output_nid generation:  0.6036357879638672
local_in_edges_tensor generation:  1.6950538158416748
mini_batch_src_global generation:  2.4698221683502197
r_  generation:  22.408093690872192
local_output_nid generation:  0.6160521507263184
local_in_edges_tensor generation:  1.7487449645996094
mini_batch_src_global generation:  2.474668025970459
r_  generation:  22.68533682823181
local_output_nid generation:  0.6084554195404053
local_in_edges_tensor generation:  1.7061784267425537
mini_batch_src_global generation:  2.400017261505127
r_  generation:  22.882384061813354
----------------------check_connections_block total spend ----------------------------- 996.7029142379761
generate_one_block  31.072306156158447
generate_one_block  30.775704860687256
generate_one_block  30.805667638778687
generate_one_block  30.955913543701172
generate_one_block  30.52184820175171
generate_one_block  34.259514808654785
generate_one_block  30.829079627990723
generate_one_block  30.72909379005432
generate_one_block  30.62052869796753
generate_one_block  30.655107259750366
generate_one_block  30.970836639404297
generate_one_block  30.610991954803467
generate_one_block  30.92384123802185
generate_one_block  31.00856065750122
generate_one_block  30.934012413024902
generate_one_block  31.00154733657837
generate_one_block  30.9689724445343
generate_one_block  31.142046689987183
generate_one_block  31.6106276512146
generate_one_block  30.883198022842407
generate_one_block  30.970309495925903
generate_one_block  30.902427434921265
generate_one_block  31.05022644996643
generate_one_block  30.624067544937134
generate_one_block  30.735135078430176
generate_one_block  31.129095792770386
generate_one_block  30.983535289764404
generate_one_block  30.857792615890503
generate_one_block  30.845917224884033
generate_one_block  30.922499179840088
generate_one_block  30.925662517547607
generate_one_block  34.14121103286743
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  1303.283486366272
block generation total time  1297.1659729480743
average batch blocks generation time:  40.53643665462732
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4871826171875 GB
    Memory Allocated: 1.3985862731933594  GigaBytes
Max Memory Allocated: 1.3985862731933594  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.1453857421875 GB
    Memory Allocated: 3.127997875213623  GigaBytes
Max Memory Allocated: 3.842109203338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4188232421875 GB
    Memory Allocated: 1.395805835723877  GigaBytes
Max Memory Allocated: 4.562729358673096  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4188232421875 GB
    Memory Allocated: 3.1136398315429688  GigaBytes
Max Memory Allocated: 4.562729358673096  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4188232421875 GB
    Memory Allocated: 1.3965129852294922  GigaBytes
Max Memory Allocated: 4.562729358673096  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4188232421875 GB
    Memory Allocated: 3.11800479888916  GigaBytes
Max Memory Allocated: 4.562729358673096  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2469482421875 GB
    Memory Allocated: 1.4002509117126465  GigaBytes
Max Memory Allocated: 4.562729358673096  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2489013671875 GB
    Memory Allocated: 3.1296072006225586  GigaBytes
Max Memory Allocated: 4.562729358673096  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 1.394850730895996  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 3.114492416381836  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 1.3956003189086914  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 3.11845064163208  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 1.394181728363037  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 3.1098074913024902  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 1.3928842544555664  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 3.1029810905456543  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 1.39024019241333  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 3.0971055030822754  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 1.4002857208251953  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 3.1268792152404785  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 1.3989958763122559  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 3.1233773231506348  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 1.3960237503051758  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 3.1207032203674316  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 1.3987035751342773  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2508544921875 GB
    Memory Allocated: 3.124481201171875  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0809326171875 GB
    Memory Allocated: 1.400698184967041  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0809326171875 GB
    Memory Allocated: 3.1289477348327637  GigaBytes
Max Memory Allocated: 4.56916618347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9110107421875 GB
    Memory Allocated: 1.399792194366455  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9110107421875 GB
    Memory Allocated: 3.12528657913208  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9110107421875 GB
    Memory Allocated: 1.3985481262207031  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9110107421875 GB
    Memory Allocated: 3.1220436096191406  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9110107421875 GB
    Memory Allocated: 1.3961920738220215  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9110107421875 GB
    Memory Allocated: 3.1159582138061523  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9110107421875 GB
    Memory Allocated: 1.3998003005981445  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9110107421875 GB
    Memory Allocated: 3.127135753631592  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9110107421875 GB
    Memory Allocated: 1.400364875793457  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9129638671875 GB
    Memory Allocated: 3.1338448524475098  GigaBytes
Max Memory Allocated: 4.569876670837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3977899551391602  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1193666458129883  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4004368782043457  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.128589630126953  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3947410583496094  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1156015396118164  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4008054733276367  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1318392753601074  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3949637413024902  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.110049247741699  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3978805541992188  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1169281005859375  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3998327255249023  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.124499797821045  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.398862361907959  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.122345447540283  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3962674140930176  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1172776222229004  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3988642692565918  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.127197265625  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3940038681030273  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1101865768432617  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4000072479248047  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.12734317779541  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3999638557434082  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.120820999145508  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3770974725484848 |0.627535805106163 |0.025048434734344482 |0.00013796985149383545 |0.016570091247558594 |0.0015869140625 |
----------------------------------------------------------pseudo_mini_loss sum 8.66646957397461
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  134414519
Number of first layer input nodes during this epoch:  71037407
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.560391902923584  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5945191383361816
random selection method range initialization spend 0.012590885162353516
time for parepare:  0.3300938606262207
local_output_nid generation:  0.0035741329193115234
local_in_edges_tensor generation:  0.03232240676879883
mini_batch_src_global generation:  0.015525102615356445
r_  generation:  0.16366004943847656
local_output_nid generation:  0.0036706924438476562
local_in_edges_tensor generation:  0.004655599594116211
mini_batch_src_global generation:  0.016703128814697266
r_  generation:  0.1832265853881836
local_output_nid generation:  0.003664255142211914
local_in_edges_tensor generation:  0.004781246185302734
mini_batch_src_global generation:  0.01079869270324707
r_  generation:  0.1880326271057129
local_output_nid generation:  0.0036818981170654297
local_in_edges_tensor generation:  0.006205320358276367
mini_batch_src_global generation:  0.011547565460205078
r_  generation:  0.20121026039123535
local_output_nid generation:  0.003658294677734375
local_in_edges_tensor generation:  0.004694700241088867
mini_batch_src_global generation:  0.011762857437133789
r_  generation:  0.20683932304382324
local_output_nid generation:  0.0037047863006591797
local_in_edges_tensor generation:  0.004663228988647461
mini_batch_src_global generation:  0.014774322509765625
r_  generation:  0.21588969230651855
local_output_nid generation:  0.003676176071166992
local_in_edges_tensor generation:  0.0064923763275146484
mini_batch_src_global generation:  0.014318704605102539
r_  generation:  0.22232270240783691
local_output_nid generation:  0.0036950111389160156
local_in_edges_tensor generation:  0.004675149917602539
mini_batch_src_global generation:  0.014585733413696289
r_  generation:  0.2297959327697754
local_output_nid generation:  0.0036661624908447266
local_in_edges_tensor generation:  0.004698276519775391
mini_batch_src_global generation:  0.01659393310546875
r_  generation:  0.22898244857788086
local_output_nid generation:  0.0037093162536621094
local_in_edges_tensor generation:  0.00447535514831543
mini_batch_src_global generation:  0.015874385833740234
r_  generation:  0.23309111595153809
local_output_nid generation:  0.003682374954223633
local_in_edges_tensor generation:  0.00463557243347168
mini_batch_src_global generation:  0.01690959930419922
r_  generation:  0.2389223575592041
local_output_nid generation:  0.00482940673828125
local_in_edges_tensor generation:  0.004633665084838867
mini_batch_src_global generation:  0.017353296279907227
r_  generation:  0.24262714385986328
local_output_nid generation:  0.003694295883178711
local_in_edges_tensor generation:  0.005034685134887695
mini_batch_src_global generation:  0.017634868621826172
r_  generation:  0.2528197765350342
local_output_nid generation:  0.0037157535552978516
local_in_edges_tensor generation:  0.005049943923950195
mini_batch_src_global generation:  0.019238710403442383
r_  generation:  0.24609041213989258
local_output_nid generation:  0.0036826133728027344
local_in_edges_tensor generation:  0.005034446716308594
mini_batch_src_global generation:  0.018480777740478516
r_  generation:  0.24995899200439453
local_output_nid generation:  0.0036916732788085938
local_in_edges_tensor generation:  0.004657745361328125
mini_batch_src_global generation:  0.018923521041870117
r_  generation:  0.24619770050048828
local_output_nid generation:  0.0037047863006591797
local_in_edges_tensor generation:  0.004645824432373047
mini_batch_src_global generation:  0.019464731216430664
r_  generation:  0.24908828735351562
local_output_nid generation:  0.0036842823028564453
local_in_edges_tensor generation:  0.004676103591918945
mini_batch_src_global generation:  0.019764423370361328
r_  generation:  0.24981188774108887
local_output_nid generation:  0.0036911964416503906
local_in_edges_tensor generation:  0.004678249359130859
mini_batch_src_global generation:  0.019359588623046875
r_  generation:  0.2563910484313965
local_output_nid generation:  0.003690481185913086
local_in_edges_tensor generation:  0.005938053131103516
mini_batch_src_global generation:  0.01983332633972168
r_  generation:  0.24381184577941895
local_output_nid generation:  0.003696918487548828
local_in_edges_tensor generation:  0.004656553268432617
mini_batch_src_global generation:  0.01986551284790039
r_  generation:  0.24911999702453613
local_output_nid generation:  0.0036988258361816406
local_in_edges_tensor generation:  0.004628419876098633
mini_batch_src_global generation:  0.019979238510131836
r_  generation:  0.24748611450195312
local_output_nid generation:  0.0037031173706054688
local_in_edges_tensor generation:  0.00464177131652832
mini_batch_src_global generation:  0.020129680633544922
r_  generation:  0.24752330780029297
local_output_nid generation:  0.003701448440551758
local_in_edges_tensor generation:  0.0046885013580322266
mini_batch_src_global generation:  0.01995229721069336
r_  generation:  0.2488079071044922
local_output_nid generation:  0.0036869049072265625
local_in_edges_tensor generation:  0.004610300064086914
mini_batch_src_global generation:  0.02021956443786621
r_  generation:  0.2453751564025879
local_output_nid generation:  0.003674030303955078
local_in_edges_tensor generation:  0.0047833919525146484
mini_batch_src_global generation:  0.020087003707885742
r_  generation:  0.2470550537109375
local_output_nid generation:  0.003710508346557617
local_in_edges_tensor generation:  0.004666566848754883
mini_batch_src_global generation:  0.020032405853271484
r_  generation:  0.24973106384277344
local_output_nid generation:  0.003709554672241211
local_in_edges_tensor generation:  0.004643440246582031
mini_batch_src_global generation:  0.020081758499145508
r_  generation:  0.2479102611541748
local_output_nid generation:  0.003725290298461914
local_in_edges_tensor generation:  0.005820035934448242
mini_batch_src_global generation:  0.02004837989807129
r_  generation:  0.24908781051635742
local_output_nid generation:  0.0036988258361816406
local_in_edges_tensor generation:  0.005516529083251953
mini_batch_src_global generation:  0.02007460594177246
r_  generation:  0.2527024745941162
local_output_nid generation:  0.0037088394165039062
local_in_edges_tensor generation:  0.00471186637878418
mini_batch_src_global generation:  0.020547151565551758
r_  generation:  0.24910306930541992
local_output_nid generation:  0.0036661624908447266
local_in_edges_tensor generation:  0.00464630126953125
mini_batch_src_global generation:  0.019631147384643555
r_  generation:  0.24932241439819336
----------------------check_connections_block total spend ----------------------------- 10.20693325996399
generate_one_block  0.6169867515563965
generate_one_block  0.34659433364868164
generate_one_block  0.2840592861175537
generate_one_block  0.2685573101043701
generate_one_block  0.28056955337524414
generate_one_block  0.3110194206237793
generate_one_block  0.4501183032989502
generate_one_block  0.3739945888519287
generate_one_block  0.29317688941955566
generate_one_block  0.2763047218322754
generate_one_block  0.2869746685028076
generate_one_block  0.2625298500061035
generate_one_block  0.2566556930541992
generate_one_block  0.25966715812683105
generate_one_block  0.2630140781402588
generate_one_block  0.2603135108947754
generate_one_block  0.25760340690612793
generate_one_block  0.2633235454559326
generate_one_block  0.2632472515106201
generate_one_block  0.2590351104736328
generate_one_block  0.2645714282989502
generate_one_block  0.2575101852416992
generate_one_block  0.2574591636657715
generate_one_block  0.25987815856933594
generate_one_block  0.2664036750793457
generate_one_block  0.2751283645629883
generate_one_block  0.2610478401184082
generate_one_block  0.2596461772918701
generate_one_block  0.26032495498657227
generate_one_block  0.2621486186981201
generate_one_block  0.2629814147949219
generate_one_block  0.2576453685760498
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.2775959968566895
gen group dst list time:  0.3217747211456299
time for parepare:  0.4938070774078369
local_output_nid generation:  0.11293673515319824
local_in_edges_tensor generation:  0.5756838321685791
mini_batch_src_global generation:  0.5634257793426514
r_  generation:  6.6503026485443115
local_output_nid generation:  0.1281733512878418
local_in_edges_tensor generation:  0.599259614944458
mini_batch_src_global generation:  0.883037805557251
r_  generation:  6.62188720703125
local_output_nid generation:  0.12662363052368164
local_in_edges_tensor generation:  0.8304774761199951
mini_batch_src_global generation:  0.7272500991821289
r_  generation:  6.923403024673462
local_output_nid generation:  0.14893865585327148
local_in_edges_tensor generation:  0.4575612545013428
mini_batch_src_global generation:  0.7238881587982178
r_  generation:  6.9810097217559814
local_output_nid generation:  0.1096808910369873
local_in_edges_tensor generation:  0.6021625995635986
mini_batch_src_global generation:  0.7656636238098145
r_  generation:  7.148833990097046
local_output_nid generation:  0.13661694526672363
local_in_edges_tensor generation:  0.44600677490234375
mini_batch_src_global generation:  0.7380514144897461
r_  generation:  7.047707796096802
local_output_nid generation:  0.10816073417663574
local_in_edges_tensor generation:  0.57501220703125
mini_batch_src_global generation:  0.7891592979431152
r_  generation:  7.109884738922119
local_output_nid generation:  0.13638544082641602
local_in_edges_tensor generation:  0.5804390907287598
mini_batch_src_global generation:  0.7638611793518066
r_  generation:  7.184282541275024
local_output_nid generation:  0.12725615501403809
local_in_edges_tensor generation:  0.4499633312225342
mini_batch_src_global generation:  0.7650964260101318
r_  generation:  7.05385160446167
local_output_nid generation:  0.129058837890625
local_in_edges_tensor generation:  0.6011934280395508
mini_batch_src_global generation:  0.782712459564209
r_  generation:  7.164731979370117
local_output_nid generation:  0.13814830780029297
local_in_edges_tensor generation:  0.4345262050628662
mini_batch_src_global generation:  0.7399313449859619
r_  generation:  7.126906871795654
local_output_nid generation:  0.11113762855529785
local_in_edges_tensor generation:  1.2391242980957031
mini_batch_src_global generation:  0.7641787528991699
r_  generation:  7.094762563705444
local_output_nid generation:  0.12440371513366699
local_in_edges_tensor generation:  0.5775783061981201
mini_batch_src_global generation:  0.7778422832489014
r_  generation:  7.172269582748413
local_output_nid generation:  0.12420320510864258
local_in_edges_tensor generation:  0.442349910736084
mini_batch_src_global generation:  0.7649307250976562
r_  generation:  6.968777656555176
local_output_nid generation:  0.12823224067687988
local_in_edges_tensor generation:  0.592681884765625
mini_batch_src_global generation:  0.7915878295898438
r_  generation:  7.169106721878052
local_output_nid generation:  0.13692188262939453
local_in_edges_tensor generation:  0.43291592597961426
mini_batch_src_global generation:  0.7507448196411133
r_  generation:  7.13551926612854
local_output_nid generation:  0.10820913314819336
local_in_edges_tensor generation:  0.5636649131774902
mini_batch_src_global generation:  0.7807648181915283
r_  generation:  7.13982367515564
local_output_nid generation:  0.1464705467224121
local_in_edges_tensor generation:  0.5699892044067383
mini_batch_src_global generation:  0.7796440124511719
r_  generation:  7.110087633132935
local_output_nid generation:  0.10518836975097656
local_in_edges_tensor generation:  0.4453461170196533
mini_batch_src_global generation:  0.770700216293335
r_  generation:  7.070240497589111
local_output_nid generation:  0.12633991241455078
local_in_edges_tensor generation:  0.5882930755615234
mini_batch_src_global generation:  0.8040976524353027
r_  generation:  7.1993560791015625
local_output_nid generation:  0.14861750602722168
local_in_edges_tensor generation:  0.45213818550109863
mini_batch_src_global generation:  0.768587589263916
r_  generation:  7.627776145935059
local_output_nid generation:  0.13484597206115723
local_in_edges_tensor generation:  0.5737178325653076
mini_batch_src_global generation:  0.8402845859527588
r_  generation:  7.552921533584595
local_output_nid generation:  0.14723658561706543
local_in_edges_tensor generation:  0.5759608745574951
mini_batch_src_global generation:  0.7969517707824707
r_  generation:  7.327135801315308
local_output_nid generation:  0.11131477355957031
local_in_edges_tensor generation:  0.58213210105896
mini_batch_src_global generation:  0.8754305839538574
r_  generation:  7.259861946105957
local_output_nid generation:  0.1403038501739502
local_in_edges_tensor generation:  0.585085391998291
mini_batch_src_global generation:  0.8374388217926025
r_  generation:  7.533869981765747
local_output_nid generation:  0.11787724494934082
local_in_edges_tensor generation:  0.4453895092010498
mini_batch_src_global generation:  0.8917858600616455
r_  generation:  7.320395231246948
local_output_nid generation:  0.11539101600646973
local_in_edges_tensor generation:  0.610084056854248
mini_batch_src_global generation:  0.8854966163635254
r_  generation:  7.3955724239349365
local_output_nid generation:  0.13921427726745605
local_in_edges_tensor generation:  0.4591982364654541
mini_batch_src_global generation:  0.9093320369720459
r_  generation:  7.438971281051636
local_output_nid generation:  0.10523605346679688
local_in_edges_tensor generation:  0.6095271110534668
mini_batch_src_global generation:  0.9420814514160156
r_  generation:  7.49012565612793
local_output_nid generation:  0.14139246940612793
local_in_edges_tensor generation:  0.5907013416290283
mini_batch_src_global generation:  0.9140779972076416
r_  generation:  7.444575309753418
local_output_nid generation:  0.11593985557556152
local_in_edges_tensor generation:  0.4898035526275635
mini_batch_src_global generation:  0.911919355392456
r_  generation:  7.360491037368774
local_output_nid generation:  0.12665343284606934
local_in_edges_tensor generation:  0.633671760559082
mini_batch_src_global generation:  0.9052286148071289
r_  generation:  7.44821572303772
----------------------check_connections_block total spend ----------------------------- 317.7129325866699
generate_one_block  10.047243595123291
generate_one_block  10.144503831863403
generate_one_block  10.443488597869873
generate_one_block  10.887004375457764
generate_one_block  10.678494453430176
generate_one_block  11.255412340164185
generate_one_block  11.092143535614014
generate_one_block  10.977782964706421
generate_one_block  10.776559114456177
generate_one_block  11.098803043365479
generate_one_block  11.128121376037598
generate_one_block  11.003703832626343
generate_one_block  11.08230447769165
generate_one_block  11.144204139709473
generate_one_block  10.825010299682617
generate_one_block  11.487302780151367
generate_one_block  11.241453409194946
generate_one_block  11.167079210281372
generate_one_block  11.25797986984253
generate_one_block  11.151183128356934
generate_one_block  10.948247909545898
generate_one_block  11.218841075897217
generate_one_block  11.195086479187012
generate_one_block  11.169810771942139
generate_one_block  10.969641208648682
generate_one_block  11.131984233856201
generate_one_block  11.165053844451904
generate_one_block  11.1626455783844
generate_one_block  11.077572584152222
generate_one_block  11.370777368545532
generate_one_block  11.1586012840271
generate_one_block  11.171769142150879
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.8319599628448486
gen group dst list time:  2.019021987915039
time for parepare:  0.46761322021484375
local_output_nid generation:  0.5412290096282959
local_in_edges_tensor generation:  2.285841226577759
mini_batch_src_global generation:  2.1945714950561523
r_  generation:  27.48624897003174
local_output_nid generation:  0.6096446514129639
local_in_edges_tensor generation:  2.518740177154541
mini_batch_src_global generation:  3.351646900177002
r_  generation:  24.249289989471436
local_output_nid generation:  0.9644789695739746
local_in_edges_tensor generation:  2.0834505558013916
mini_batch_src_global generation:  2.5469181537628174
r_  generation:  23.09888219833374
local_output_nid generation:  0.7856888771057129
local_in_edges_tensor generation:  1.8016555309295654
mini_batch_src_global generation:  2.6238598823547363
r_  generation:  23.568220138549805
local_output_nid generation:  0.6606523990631104
local_in_edges_tensor generation:  1.7777092456817627
mini_batch_src_global generation:  2.670611619949341
r_  generation:  24.052698612213135
local_output_nid generation:  0.6285552978515625
local_in_edges_tensor generation:  1.7010321617126465
mini_batch_src_global generation:  2.7815263271331787
r_  generation:  23.356350898742676
local_output_nid generation:  0.6663153171539307
local_in_edges_tensor generation:  1.7327938079833984
mini_batch_src_global generation:  2.7163283824920654
r_  generation:  23.330914974212646
local_output_nid generation:  0.7003583908081055
local_in_edges_tensor generation:  1.698943853378296
mini_batch_src_global generation:  2.767899990081787
r_  generation:  23.01880431175232
local_output_nid generation:  0.7029852867126465
local_in_edges_tensor generation:  1.7237966060638428
mini_batch_src_global generation:  2.7920515537261963
r_  generation:  23.327412366867065
local_output_nid generation:  0.7210519313812256
local_in_edges_tensor generation:  1.7579843997955322
mini_batch_src_global generation:  2.6077210903167725
r_  generation:  23.454644441604614
local_output_nid generation:  0.7113001346588135
local_in_edges_tensor generation:  1.7310230731964111
mini_batch_src_global generation:  2.8055193424224854
r_  generation:  23.598625421524048
local_output_nid generation:  0.7241628170013428
local_in_edges_tensor generation:  1.889840841293335
mini_batch_src_global generation:  2.803447961807251
r_  generation:  23.293751001358032
local_output_nid generation:  0.7099945545196533
local_in_edges_tensor generation:  1.7277305126190186
mini_batch_src_global generation:  2.924471139907837
r_  generation:  23.526078462600708
local_output_nid generation:  0.7387335300445557
local_in_edges_tensor generation:  1.7534153461456299
mini_batch_src_global generation:  2.563467025756836
r_  generation:  23.5850670337677
local_output_nid generation:  0.727435827255249
local_in_edges_tensor generation:  1.7868602275848389
mini_batch_src_global generation:  2.556924819946289
r_  generation:  23.664702653884888
local_output_nid generation:  0.7586226463317871
local_in_edges_tensor generation:  1.7971022129058838
mini_batch_src_global generation:  2.638977289199829
r_  generation:  23.587839365005493
local_output_nid generation:  0.7480506896972656
local_in_edges_tensor generation:  1.7663242816925049
mini_batch_src_global generation:  2.634253740310669
r_  generation:  23.374579906463623
local_output_nid generation:  0.6974406242370605
local_in_edges_tensor generation:  1.7859604358673096
mini_batch_src_global generation:  2.6817033290863037
r_  generation:  23.373635053634644
local_output_nid generation:  0.7019565105438232
local_in_edges_tensor generation:  1.770381212234497
mini_batch_src_global generation:  2.727619171142578
r_  generation:  23.319503784179688
local_output_nid generation:  0.7033281326293945
local_in_edges_tensor generation:  1.7684319019317627
mini_batch_src_global generation:  2.7643508911132812
r_  generation:  23.448535680770874
local_output_nid generation:  0.7129895687103271
local_in_edges_tensor generation:  1.7683966159820557
mini_batch_src_global generation:  2.74517822265625
r_  generation:  23.450109481811523
local_output_nid generation:  0.6799778938293457
local_in_edges_tensor generation:  1.7441630363464355
mini_batch_src_global generation:  2.775886058807373
r_  generation:  23.51378870010376
local_output_nid generation:  0.7043843269348145
local_in_edges_tensor generation:  1.7551898956298828
mini_batch_src_global generation:  2.7282116413116455
r_  generation:  23.509207248687744
local_output_nid generation:  0.6826496124267578
local_in_edges_tensor generation:  1.7468101978302002
mini_batch_src_global generation:  2.7984628677368164
r_  generation:  23.367636919021606
local_output_nid generation:  0.7116172313690186
local_in_edges_tensor generation:  1.7485053539276123
mini_batch_src_global generation:  2.838900089263916
r_  generation:  23.495044469833374
local_output_nid generation:  0.6607730388641357
local_in_edges_tensor generation:  1.7499611377716064
mini_batch_src_global generation:  2.7925963401794434
r_  generation:  23.444786071777344
local_output_nid generation:  0.6620731353759766
local_in_edges_tensor generation:  1.7515954971313477
mini_batch_src_global generation:  2.706394910812378
r_  generation:  23.524187803268433
local_output_nid generation:  0.6401011943817139
local_in_edges_tensor generation:  1.7134253978729248
mini_batch_src_global generation:  2.765615224838257
r_  generation:  23.436006784439087
local_output_nid generation:  0.6550476551055908
local_in_edges_tensor generation:  1.823744535446167
mini_batch_src_global generation:  2.7519147396087646
r_  generation:  23.418944358825684
local_output_nid generation:  0.6354103088378906
local_in_edges_tensor generation:  1.8505747318267822
mini_batch_src_global generation:  2.817135810852051
r_  generation:  23.48519253730774
local_output_nid generation:  0.6491150856018066
local_in_edges_tensor generation:  1.8989324569702148
mini_batch_src_global generation:  2.786409616470337
r_  generation:  23.52935266494751
local_output_nid generation:  0.6314632892608643
local_in_edges_tensor generation:  1.8443353176116943
mini_batch_src_global generation:  2.8139915466308594
r_  generation:  23.45360493659973
----------------------check_connections_block total spend ----------------------------- 1059.890867471695
generate_one_block  34.530638217926025
generate_one_block  34.21954703330994
generate_one_block  32.25986909866333
generate_one_block  32.531413316726685
generate_one_block  32.38615822792053
generate_one_block  32.42613220214844
generate_one_block  32.37627696990967
generate_one_block  35.36899971961975
generate_one_block  32.2819402217865
generate_one_block  32.37465000152588
generate_one_block  32.4323251247406
generate_one_block  32.565753698349
generate_one_block  32.403449058532715
generate_one_block  32.28896927833557
generate_one_block  32.44002103805542
generate_one_block  32.63210988044739
generate_one_block  32.324300050735474
generate_one_block  32.568217754364014
generate_one_block  32.40742349624634
generate_one_block  32.2764253616333
generate_one_block  33.143638134002686
generate_one_block  32.285560846328735
generate_one_block  32.45602536201477
generate_one_block  32.525168895721436
generate_one_block  32.39342975616455
generate_one_block  32.481436014175415
generate_one_block  32.40467882156372
generate_one_block  32.526543378829956
generate_one_block  32.43655180931091
generate_one_block  32.509008169174194
generate_one_block  32.42452025413513
generate_one_block  32.599162101745605
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.560391902923584  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

connection checking time:  1377.6038000583649
block generation total time  1397.9101531505585
average batch blocks generation time:  43.68469228595495
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3979582786560059  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.120431423187256  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4000868797302246  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.127202033996582  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.394002914428711  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1110992431640625  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4011573791503906  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1283650398254395  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3952465057373047  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1154942512512207  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3978862762451172  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1179771423339844  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3958845138549805  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1185989379882812  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3958110809326172  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.119257926940918  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3971319198608398  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.121166229248047  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3948554992675781  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1084718704223633  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.399724006652832  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.12661075592041  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3988265991210938  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1218671798706055  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3999710083007812  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.124195098876953  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4001359939575195  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1236557960510254  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4004230499267578  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1323041915893555  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4005117416381836  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1302361488342285  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3955154418945312  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1158394813537598  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3957233428955078  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1127796173095703  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3953461647033691  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1190743446350098  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4006342887878418  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.123311996459961  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4035820960998535  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1366991996765137  GigaBytes
Max Memory Allocated: 4.571812629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3956298828125  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1131272315979004  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3999710083007812  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.124662399291992  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3981342315673828  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.122012138366699  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3987016677856445  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1269922256469727  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3954195976257324  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1142354011535645  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3959245681762695  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1151247024536133  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.396697998046875  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.116736888885498  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.395063877105713  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.10978364944458  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3999710083007812  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.128641128540039  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3945956230163574  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.110992431640625  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3940730094909668  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.107790470123291  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3148344084620476 |0.6665316596627235 |0.004765279591083527 |0.00015185773372650146 |0.01093466579914093 |0.0028667449951171875 |
----------------------------------------------------------pseudo_mini_loss sum 5.054346084594727
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  134404911
Number of first layer input nodes during this epoch:  71029057
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.549173355102539  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7252774238586426
random selection method range initialization spend 0.012957572937011719
time for parepare:  0.43175673484802246
local_output_nid generation:  0.003934144973754883
local_in_edges_tensor generation:  0.029450416564941406
mini_batch_src_global generation:  0.014215469360351562
r_  generation:  0.1703331470489502
local_output_nid generation:  0.0037572383880615234
local_in_edges_tensor generation:  0.012135744094848633
mini_batch_src_global generation:  0.01797962188720703
r_  generation:  0.2001173496246338
local_output_nid generation:  0.0037386417388916016
local_in_edges_tensor generation:  0.005919218063354492
mini_batch_src_global generation:  0.02322864532470703
r_  generation:  0.1956181526184082
local_output_nid generation:  0.0037453174591064453
local_in_edges_tensor generation:  0.007838249206542969
mini_batch_src_global generation:  0.012188434600830078
r_  generation:  0.21189403533935547
local_output_nid generation:  0.0037221908569335938
local_in_edges_tensor generation:  0.005591392517089844
mini_batch_src_global generation:  0.011811494827270508
r_  generation:  0.20859932899475098
local_output_nid generation:  0.0037300586700439453
local_in_edges_tensor generation:  0.011282682418823242
mini_batch_src_global generation:  0.0204160213470459
r_  generation:  0.2386157512664795
local_output_nid generation:  0.003741741180419922
local_in_edges_tensor generation:  0.007071495056152344
mini_batch_src_global generation:  0.014377832412719727
r_  generation:  0.22805547714233398
local_output_nid generation:  0.0037665367126464844
local_in_edges_tensor generation:  0.005754709243774414
mini_batch_src_global generation:  0.014934301376342773
r_  generation:  0.24217963218688965
local_output_nid generation:  0.0037322044372558594
local_in_edges_tensor generation:  0.005720376968383789
mini_batch_src_global generation:  0.015337944030761719
r_  generation:  0.23623418807983398
local_output_nid generation:  0.003747224807739258
local_in_edges_tensor generation:  0.007348060607910156
mini_batch_src_global generation:  0.016032934188842773
r_  generation:  0.24721145629882812
local_output_nid generation:  0.003750324249267578
local_in_edges_tensor generation:  0.0057985782623291016
mini_batch_src_global generation:  0.016767024993896484
r_  generation:  0.24582767486572266
local_output_nid generation:  0.003767728805541992
local_in_edges_tensor generation:  0.007046222686767578
mini_batch_src_global generation:  0.0176699161529541
r_  generation:  0.2578284740447998
local_output_nid generation:  0.0037810802459716797
local_in_edges_tensor generation:  0.005980730056762695
mini_batch_src_global generation:  0.018057823181152344
r_  generation:  0.24719882011413574
local_output_nid generation:  0.003780841827392578
local_in_edges_tensor generation:  0.005891084671020508
mini_batch_src_global generation:  0.018080949783325195
r_  generation:  0.25350236892700195
local_output_nid generation:  0.003817319869995117
local_in_edges_tensor generation:  0.006016969680786133
mini_batch_src_global generation:  0.01849651336669922
r_  generation:  0.2557833194732666
local_output_nid generation:  0.0037958621978759766
local_in_edges_tensor generation:  0.006049394607543945
mini_batch_src_global generation:  0.0190277099609375
r_  generation:  0.2537503242492676
local_output_nid generation:  0.0037713050842285156
local_in_edges_tensor generation:  0.006532192230224609
mini_batch_src_global generation:  0.020545244216918945
r_  generation:  0.25785350799560547
local_output_nid generation:  0.0037581920623779297
local_in_edges_tensor generation:  0.006482601165771484
mini_batch_src_global generation:  0.020258426666259766
r_  generation:  0.26049184799194336
local_output_nid generation:  0.003892183303833008
local_in_edges_tensor generation:  0.006345987319946289
mini_batch_src_global generation:  0.020739316940307617
r_  generation:  0.25594472885131836
local_output_nid generation:  0.0037708282470703125
local_in_edges_tensor generation:  0.006609439849853516
mini_batch_src_global generation:  0.01974654197692871
r_  generation:  0.2573823928833008
local_output_nid generation:  0.003737211227416992
local_in_edges_tensor generation:  0.005837678909301758
mini_batch_src_global generation:  0.0197298526763916
r_  generation:  0.2517874240875244
local_output_nid generation:  0.0038013458251953125
local_in_edges_tensor generation:  0.005614280700683594
mini_batch_src_global generation:  0.019862651824951172
r_  generation:  0.2610044479370117
local_output_nid generation:  0.0038194656372070312
local_in_edges_tensor generation:  0.0071659088134765625
mini_batch_src_global generation:  0.02841639518737793
r_  generation:  0.25577712059020996
local_output_nid generation:  0.008006811141967773
local_in_edges_tensor generation:  0.005690813064575195
mini_batch_src_global generation:  0.019805192947387695
r_  generation:  0.2578463554382324
local_output_nid generation:  0.0038650035858154297
local_in_edges_tensor generation:  0.0060846805572509766
mini_batch_src_global generation:  0.0206298828125
r_  generation:  0.25536322593688965
local_output_nid generation:  0.0037157535552978516
local_in_edges_tensor generation:  0.007284879684448242
mini_batch_src_global generation:  0.020296335220336914
r_  generation:  0.26309680938720703
local_output_nid generation:  0.003751039505004883
local_in_edges_tensor generation:  0.006809234619140625
mini_batch_src_global generation:  0.020235776901245117
r_  generation:  0.2610349655151367
local_output_nid generation:  0.0037550926208496094
local_in_edges_tensor generation:  0.0066645145416259766
mini_batch_src_global generation:  0.024001598358154297
r_  generation:  0.2635002136230469
local_output_nid generation:  0.003761768341064453
local_in_edges_tensor generation:  0.006576061248779297
mini_batch_src_global generation:  0.020498037338256836
r_  generation:  0.2574620246887207
local_output_nid generation:  0.003728628158569336
local_in_edges_tensor generation:  0.0071239471435546875
mini_batch_src_global generation:  0.020412921905517578
r_  generation:  0.27004313468933105
local_output_nid generation:  0.0037391185760498047
local_in_edges_tensor generation:  0.00649571418762207
mini_batch_src_global generation:  0.020117759704589844
r_  generation:  0.25916004180908203
local_output_nid generation:  0.0037088394165039062
local_in_edges_tensor generation:  0.00591278076171875
mini_batch_src_global generation:  0.02270197868347168
r_  generation:  0.26218104362487793
----------------------check_connections_block total spend ----------------------------- 10.739669799804688
generate_one_block  0.5694315433502197
generate_one_block  0.43129467964172363
generate_one_block  0.38323426246643066
generate_one_block  0.33126020431518555
generate_one_block  0.29114198684692383
generate_one_block  0.27617359161376953
generate_one_block  0.278090238571167
generate_one_block  0.2720804214477539
generate_one_block  0.27878451347351074
generate_one_block  0.2744755744934082
generate_one_block  0.2714884281158447
generate_one_block  0.27672410011291504
generate_one_block  0.28194212913513184
generate_one_block  0.2857086658477783
generate_one_block  0.2763993740081787
generate_one_block  0.2823631763458252
generate_one_block  0.2747921943664551
generate_one_block  0.28997802734375
generate_one_block  0.28402137756347656
generate_one_block  0.2711215019226074
generate_one_block  0.270003080368042
generate_one_block  0.26654791831970215
generate_one_block  0.27449846267700195
generate_one_block  0.26877331733703613
generate_one_block  0.27119970321655273
generate_one_block  0.2752563953399658
generate_one_block  0.2758462429046631
generate_one_block  0.27211952209472656
generate_one_block  0.2734808921813965
generate_one_block  0.27800846099853516
generate_one_block  0.291980504989624
generate_one_block  0.27814412117004395
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.710387945175171
gen group dst list time:  0.3659400939941406
time for parepare:  0.4607245922088623
local_output_nid generation:  0.10917973518371582
local_in_edges_tensor generation:  0.537755012512207
mini_batch_src_global generation:  0.551497220993042
r_  generation:  7.150521993637085
local_output_nid generation:  0.11059212684631348
local_in_edges_tensor generation:  0.4254128932952881
mini_batch_src_global generation:  0.690502405166626
r_  generation:  7.285130023956299
local_output_nid generation:  0.11296200752258301
local_in_edges_tensor generation:  0.5988187789916992
mini_batch_src_global generation:  0.727562427520752
r_  generation:  6.915751695632935
local_output_nid generation:  0.13272953033447266
local_in_edges_tensor generation:  0.44919419288635254
mini_batch_src_global generation:  0.7197921276092529
r_  generation:  6.77872633934021
local_output_nid generation:  0.10907196998596191
local_in_edges_tensor generation:  0.4328794479370117
mini_batch_src_global generation:  0.7371807098388672
r_  generation:  7.075578689575195
local_output_nid generation:  0.13775157928466797
local_in_edges_tensor generation:  0.7863750457763672
mini_batch_src_global generation:  0.7280302047729492
r_  generation:  6.872176170349121
local_output_nid generation:  0.10823750495910645
local_in_edges_tensor generation:  0.47025609016418457
mini_batch_src_global generation:  0.7324619293212891
r_  generation:  7.209168195724487
local_output_nid generation:  0.13771939277648926
local_in_edges_tensor generation:  0.5895829200744629
mini_batch_src_global generation:  0.735238790512085
r_  generation:  6.908849716186523
local_output_nid generation:  0.11368060111999512
local_in_edges_tensor generation:  0.43895816802978516
mini_batch_src_global generation:  0.7310843467712402
r_  generation:  7.245566129684448
local_output_nid generation:  0.1324138641357422
local_in_edges_tensor generation:  0.5754802227020264
mini_batch_src_global generation:  0.743861198425293
r_  generation:  7.065208196640015
local_output_nid generation:  0.11826133728027344
local_in_edges_tensor generation:  0.42945408821105957
mini_batch_src_global generation:  0.7383100986480713
r_  generation:  7.178169250488281
local_output_nid generation:  0.15128111839294434
local_in_edges_tensor generation:  1.2839391231536865
mini_batch_src_global generation:  0.7416467666625977
r_  generation:  7.057530403137207
local_output_nid generation:  0.11694574356079102
local_in_edges_tensor generation:  0.436779260635376
mini_batch_src_global generation:  0.7639961242675781
r_  generation:  7.133237600326538
local_output_nid generation:  0.10402059555053711
local_in_edges_tensor generation:  0.584622859954834
mini_batch_src_global generation:  0.809837818145752
r_  generation:  6.983579874038696
local_output_nid generation:  0.1268453598022461
local_in_edges_tensor generation:  0.44951605796813965
mini_batch_src_global generation:  0.7513735294342041
r_  generation:  7.019807815551758
local_output_nid generation:  0.10748004913330078
local_in_edges_tensor generation:  0.5728623867034912
mini_batch_src_global generation:  0.8305163383483887
r_  generation:  7.03805947303772
local_output_nid generation:  0.1274855136871338
local_in_edges_tensor generation:  0.457599401473999
mini_batch_src_global generation:  0.7729089260101318
r_  generation:  7.017862796783447
local_output_nid generation:  0.11096024513244629
local_in_edges_tensor generation:  0.42542362213134766
mini_batch_src_global generation:  0.7858037948608398
r_  generation:  7.2193567752838135
local_output_nid generation:  0.13797640800476074
local_in_edges_tensor generation:  0.5762591361999512
mini_batch_src_global generation:  0.7509889602661133
r_  generation:  7.036045074462891
local_output_nid generation:  0.11027765274047852
local_in_edges_tensor generation:  0.43120479583740234
mini_batch_src_global generation:  0.7873725891113281
r_  generation:  7.311800718307495
local_output_nid generation:  0.13930797576904297
local_in_edges_tensor generation:  0.5707764625549316
mini_batch_src_global generation:  0.7458028793334961
r_  generation:  7.070684194564819
local_output_nid generation:  0.11115145683288574
local_in_edges_tensor generation:  0.4321177005767822
mini_batch_src_global generation:  0.742642879486084
r_  generation:  7.305246829986572
local_output_nid generation:  0.13214802742004395
local_in_edges_tensor generation:  0.5728659629821777
mini_batch_src_global generation:  0.7601282596588135
r_  generation:  7.098991870880127
local_output_nid generation:  0.1266040802001953
local_in_edges_tensor generation:  0.4275951385498047
mini_batch_src_global generation:  0.7455146312713623
r_  generation:  7.153583288192749
local_output_nid generation:  0.12150192260742188
local_in_edges_tensor generation:  0.572606086730957
mini_batch_src_global generation:  0.8006854057312012
r_  generation:  7.022871494293213
local_output_nid generation:  0.12641406059265137
local_in_edges_tensor generation:  0.4330430030822754
mini_batch_src_global generation:  0.7494220733642578
r_  generation:  6.977640628814697
local_output_nid generation:  0.10886716842651367
local_in_edges_tensor generation:  0.5246729850769043
mini_batch_src_global generation:  0.8419187068939209
r_  generation:  7.208234071731567
local_output_nid generation:  0.14101958274841309
local_in_edges_tensor generation:  0.4926631450653076
mini_batch_src_global generation:  0.775601863861084
r_  generation:  7.066943168640137
local_output_nid generation:  0.1188356876373291
local_in_edges_tensor generation:  0.42249584197998047
mini_batch_src_global generation:  0.7963247299194336
r_  generation:  7.214053392410278
local_output_nid generation:  0.14193439483642578
local_in_edges_tensor generation:  0.5732729434967041
mini_batch_src_global generation:  0.7553825378417969
r_  generation:  7.092250108718872
local_output_nid generation:  0.10803866386413574
local_in_edges_tensor generation:  0.4326450824737549
mini_batch_src_global generation:  0.7820825576782227
r_  generation:  7.315338611602783
local_output_nid generation:  0.14014339447021484
local_in_edges_tensor generation:  0.5655763149261475
mini_batch_src_global generation:  0.7521302700042725
r_  generation:  7.037302732467651
----------------------check_connections_block total spend ----------------------------- 310.94616746902466
generate_one_block  10.296316385269165
generate_one_block  9.833390712738037
generate_one_block  9.625905990600586
generate_one_block  9.832443475723267
generate_one_block  9.6315598487854
generate_one_block  9.944175720214844
generate_one_block  9.600491285324097
generate_one_block  9.756576538085938
generate_one_block  9.639782190322876
generate_one_block  9.883237838745117
generate_one_block  9.602478742599487
generate_one_block  9.871189832687378
generate_one_block  9.578814029693604
generate_one_block  9.721672296524048
generate_one_block  9.607461214065552
generate_one_block  10.449330806732178
generate_one_block  9.696865320205688
generate_one_block  9.815539121627808
generate_one_block  9.590080738067627
generate_one_block  9.79089093208313
generate_one_block  9.54464340209961
generate_one_block  9.791114091873169
generate_one_block  9.620039224624634
generate_one_block  9.76694631576538
generate_one_block  9.564327955245972
generate_one_block  9.752589225769043
generate_one_block  9.682803392410278
generate_one_block  9.81763482093811
generate_one_block  9.744369506835938
generate_one_block  9.84525442123413
generate_one_block  9.579579591751099
generate_one_block  9.747308254241943
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4421350955963135
gen group dst list time:  1.9452197551727295
time for parepare:  0.491072416305542
local_output_nid generation:  0.6466097831726074
local_in_edges_tensor generation:  1.8621776103973389
mini_batch_src_global generation:  1.8205811977386475
r_  generation:  21.822513818740845
local_output_nid generation:  0.629549503326416
local_in_edges_tensor generation:  1.767719030380249
mini_batch_src_global generation:  2.531684398651123
r_  generation:  22.586692571640015
local_output_nid generation:  0.6714491844177246
local_in_edges_tensor generation:  2.0644309520721436
mini_batch_src_global generation:  2.5671563148498535
r_  generation:  22.91076374053955
local_output_nid generation:  0.6239621639251709
local_in_edges_tensor generation:  1.702528476715088
mini_batch_src_global generation:  2.8446290493011475
r_  generation:  22.562312364578247
local_output_nid generation:  0.6564910411834717
local_in_edges_tensor generation:  1.7117013931274414
mini_batch_src_global generation:  2.6157045364379883
r_  generation:  22.96884250640869
local_output_nid generation:  0.6279945373535156
local_in_edges_tensor generation:  1.7315056324005127
mini_batch_src_global generation:  2.752366542816162
r_  generation:  22.83122730255127
local_output_nid generation:  0.6147892475128174
local_in_edges_tensor generation:  1.9050204753875732
mini_batch_src_global generation:  2.883535146713257
r_  generation:  23.616763591766357
local_output_nid generation:  0.6395421028137207
local_in_edges_tensor generation:  1.795375108718872
mini_batch_src_global generation:  2.821702003479004
r_  generation:  23.705376386642456
local_output_nid generation:  0.6162714958190918
local_in_edges_tensor generation:  1.8063316345214844
mini_batch_src_global generation:  3.181048631668091
r_  generation:  23.873093843460083
local_output_nid generation:  0.6191446781158447
local_in_edges_tensor generation:  1.8351600170135498
mini_batch_src_global generation:  3.003336191177368
r_  generation:  23.558716535568237
local_output_nid generation:  0.6137924194335938
local_in_edges_tensor generation:  1.9060468673706055
mini_batch_src_global generation:  3.2735211849212646
r_  generation:  23.80725884437561
local_output_nid generation:  0.6262862682342529
local_in_edges_tensor generation:  2.005349636077881
mini_batch_src_global generation:  3.077530860900879
r_  generation:  23.912689447402954
local_output_nid generation:  0.6462593078613281
local_in_edges_tensor generation:  1.9068171977996826
mini_batch_src_global generation:  3.2730419635772705
r_  generation:  23.691347122192383
local_output_nid generation:  0.6314525604248047
local_in_edges_tensor generation:  2.061103105545044
mini_batch_src_global generation:  3.2566123008728027
r_  generation:  23.83310556411743
local_output_nid generation:  0.6525058746337891
local_in_edges_tensor generation:  1.9901678562164307
mini_batch_src_global generation:  3.302320718765259
r_  generation:  23.976610898971558
local_output_nid generation:  0.6483485698699951
local_in_edges_tensor generation:  2.201570987701416
mini_batch_src_global generation:  3.395014762878418
r_  generation:  23.944694757461548
local_output_nid generation:  0.6715023517608643
local_in_edges_tensor generation:  2.0129988193511963
mini_batch_src_global generation:  3.2560641765594482
r_  generation:  23.775187969207764
local_output_nid generation:  0.6379342079162598
local_in_edges_tensor generation:  2.142489433288574
mini_batch_src_global generation:  3.4220054149627686
r_  generation:  24.583810567855835
local_output_nid generation:  1.0022368431091309
local_in_edges_tensor generation:  2.1780476570129395
mini_batch_src_global generation:  2.9017295837402344
r_  generation:  26.42398166656494
local_output_nid generation:  0.8114159107208252
local_in_edges_tensor generation:  2.596859931945801
mini_batch_src_global generation:  2.6372859477996826
r_  generation:  23.267098903656006
local_output_nid generation:  0.6215274333953857
local_in_edges_tensor generation:  1.7928011417388916
mini_batch_src_global generation:  2.783613681793213
r_  generation:  23.02476716041565
local_output_nid generation:  0.7319388389587402
local_in_edges_tensor generation:  1.7890598773956299
mini_batch_src_global generation:  2.5328335762023926
r_  generation:  23.202510833740234
local_output_nid generation:  0.6751902103424072
local_in_edges_tensor generation:  1.8991115093231201
mini_batch_src_global generation:  2.7005503177642822
r_  generation:  23.092066287994385
local_output_nid generation:  0.7226564884185791
local_in_edges_tensor generation:  1.806734561920166
mini_batch_src_global generation:  2.5276808738708496
r_  generation:  23.185524463653564
local_output_nid generation:  0.6731445789337158
local_in_edges_tensor generation:  1.8620483875274658
mini_batch_src_global generation:  2.727869987487793
r_  generation:  23.05848503112793
local_output_nid generation:  0.6916038990020752
local_in_edges_tensor generation:  1.7895324230194092
mini_batch_src_global generation:  2.5142412185668945
r_  generation:  23.191813707351685
local_output_nid generation:  0.6776342391967773
local_in_edges_tensor generation:  1.9552829265594482
mini_batch_src_global generation:  2.6914010047912598
r_  generation:  23.18015480041504
local_output_nid generation:  0.684565544128418
local_in_edges_tensor generation:  1.8056645393371582
mini_batch_src_global generation:  2.5101757049560547
r_  generation:  23.15754222869873
local_output_nid generation:  0.7064743041992188
local_in_edges_tensor generation:  1.8328795433044434
mini_batch_src_global generation:  2.6078989505767822
r_  generation:  23.084331274032593
local_output_nid generation:  0.681882381439209
local_in_edges_tensor generation:  1.795851707458496
mini_batch_src_global generation:  2.6233575344085693
r_  generation:  23.253515005111694
local_output_nid generation:  0.7239208221435547
local_in_edges_tensor generation:  1.8236145973205566
mini_batch_src_global generation:  2.5891776084899902
r_  generation:  23.161505460739136
local_output_nid generation:  0.7027826309204102
local_in_edges_tensor generation:  1.7621400356292725
mini_batch_src_global generation:  2.7179126739501953
r_  generation:  23.20588517189026
----------------------check_connections_block total spend ----------------------------- 1060.8128454685211
generate_one_block  34.725146532058716
generate_one_block  33.33523225784302
generate_one_block  31.81812334060669
generate_one_block  32.03050374984741
generate_one_block  31.664931774139404
generate_one_block  31.733574390411377
generate_one_block  32.18125796318054
generate_one_block  35.65944695472717
generate_one_block  31.94541573524475
generate_one_block  31.92697024345398
generate_one_block  31.80014967918396
generate_one_block  32.13530254364014
generate_one_block  31.90590500831604
generate_one_block  31.832043170928955
generate_one_block  32.02409291267395
generate_one_block  32.823318004608154
generate_one_block  32.014907360076904
generate_one_block  32.04899287223816
generate_one_block  31.82407283782959
generate_one_block  31.576850414276123
generate_one_block  32.171584606170654
generate_one_block  31.715832710266113
generate_one_block  31.896331548690796
generate_one_block  31.83596682548523
generate_one_block  31.834033727645874
generate_one_block  32.033512592315674
generate_one_block  31.90574622154236
generate_one_block  31.871091842651367
generate_one_block  31.744596242904663
generate_one_block  31.784199714660645
generate_one_block  31.977524518966675
generate_one_block  31.81572651863098
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.549173355102539  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

connection checking time:  1371.7590129375458
block generation total time  1341.8171980381012
average batch blocks generation time:  41.93178743869066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3999581336975098  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.125577449798584  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3956146240234375  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.112783432006836  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3967533111572266  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.117072582244873  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.397970199584961  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.121253490447998  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.399989128112793  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.128760814666748  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3935565948486328  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.108213424682617  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3961305618286133  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.114326000213623  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3952207565307617  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1131210327148438  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4004192352294922  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.128655433654785  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.400456428527832  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1274328231811523  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3955230712890625  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1160197257995605  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4007482528686523  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.127897262573242  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4004769325256348  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1269187927246094  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3991622924804688  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1197237968444824  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4000797271728516  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1280107498168945  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4008450508117676  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1295013427734375  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.397186279296875  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.120332717895508  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3976492881774902  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1187376976013184  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.39603853225708  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1150808334350586  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3945517539978027  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1167192459106445  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3948025703430176  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1120543479919434  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3958663940429688  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.11807918548584  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4001755714416504  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.130993366241455  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4004693031311035  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1251683235168457  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3951044082641602  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.111673355102539  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3999710083007812  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1241860389709473  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4017267227172852  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1343636512756348  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3965706825256348  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1207737922668457  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4000663757324219  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.124617099761963  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.398768424987793  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.127199172973633  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.398561954498291  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.126100540161133  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3947649002075195  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.110833168029785  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38029833137989044 |0.8258091062307358 |0.003958120942115784 |0.0001442432403564453 |0.004009254276752472 |0.0012745857238769531 |
----------------------------------------------------------pseudo_mini_loss sum 3.6659724712371826
Total (block generation + training)time/epoch 2846.7678859233856
Training time/epoch 1647918120.0081522
Training time without block to device /epoch 1647918093.5822608
Training time without total dataloading part /epoch 0.2608463764190674
load block tensor time/epoch 12.169546604156494
block to device time/epoch 26.425891399383545
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  134433371
Number of first layer input nodes during this epoch:  71040718
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.551051139831543  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6677687168121338
random selection method range initialization spend 0.014040946960449219
time for parepare:  0.36852431297302246
local_output_nid generation:  0.004040718078613281
local_in_edges_tensor generation:  0.035729408264160156
mini_batch_src_global generation:  0.014891624450683594
r_  generation:  0.18900227546691895
local_output_nid generation:  0.00526881217956543
local_in_edges_tensor generation:  0.010355234146118164
mini_batch_src_global generation:  0.017450332641601562
r_  generation:  0.21464300155639648
local_output_nid generation:  0.005268573760986328
local_in_edges_tensor generation:  0.006983518600463867
mini_batch_src_global generation:  0.010806560516357422
r_  generation:  0.2143242359161377
local_output_nid generation:  0.005330324172973633
local_in_edges_tensor generation:  0.011420488357543945
mini_batch_src_global generation:  0.028744935989379883
r_  generation:  0.24320030212402344
local_output_nid generation:  0.004683256149291992
local_in_edges_tensor generation:  0.007443666458129883
mini_batch_src_global generation:  0.02989959716796875
r_  generation:  0.2546238899230957
local_output_nid generation:  0.004767894744873047
local_in_edges_tensor generation:  0.0065844058990478516
mini_batch_src_global generation:  0.016613006591796875
r_  generation:  0.2642076015472412
local_output_nid generation:  0.004457712173461914
local_in_edges_tensor generation:  0.007669210433959961
mini_batch_src_global generation:  0.018260955810546875
r_  generation:  0.27211976051330566
local_output_nid generation:  0.004447221755981445
local_in_edges_tensor generation:  0.006653785705566406
mini_batch_src_global generation:  0.019083499908447266
r_  generation:  0.2863790988922119
local_output_nid generation:  0.004317522048950195
local_in_edges_tensor generation:  0.006542205810546875
mini_batch_src_global generation:  0.020001888275146484
r_  generation:  0.29094386100769043
local_output_nid generation:  0.004327058792114258
local_in_edges_tensor generation:  0.006184816360473633
mini_batch_src_global generation:  0.02155590057373047
r_  generation:  0.29442834854125977
local_output_nid generation:  0.004293203353881836
local_in_edges_tensor generation:  0.0067102909088134766
mini_batch_src_global generation:  0.023389816284179688
r_  generation:  0.30125951766967773
local_output_nid generation:  0.004283428192138672
local_in_edges_tensor generation:  0.006513118743896484
mini_batch_src_global generation:  0.02437591552734375
r_  generation:  0.3143734931945801
local_output_nid generation:  0.0042688846588134766
local_in_edges_tensor generation:  0.0065157413482666016
mini_batch_src_global generation:  0.02512359619140625
r_  generation:  0.30683040618896484
local_output_nid generation:  0.00423431396484375
local_in_edges_tensor generation:  0.0065419673919677734
mini_batch_src_global generation:  0.02589273452758789
r_  generation:  0.31073570251464844
local_output_nid generation:  0.004239082336425781
local_in_edges_tensor generation:  0.006074190139770508
mini_batch_src_global generation:  0.03136610984802246
r_  generation:  0.3312668800354004
local_output_nid generation:  0.004220247268676758
local_in_edges_tensor generation:  0.00655817985534668
mini_batch_src_global generation:  0.037825822830200195
r_  generation:  0.3280360698699951
local_output_nid generation:  0.00422978401184082
local_in_edges_tensor generation:  0.006533622741699219
mini_batch_src_global generation:  0.027449846267700195
r_  generation:  0.3475329875946045
local_output_nid generation:  0.004240512847900391
local_in_edges_tensor generation:  0.006303071975708008
mini_batch_src_global generation:  0.028142690658569336
r_  generation:  0.31761693954467773
local_output_nid generation:  0.0042150020599365234
local_in_edges_tensor generation:  0.0053310394287109375
mini_batch_src_global generation:  0.027110576629638672
r_  generation:  0.3207423686981201
local_output_nid generation:  0.0042247772216796875
local_in_edges_tensor generation:  0.006400585174560547
mini_batch_src_global generation:  0.029515504837036133
r_  generation:  0.3139021396636963
local_output_nid generation:  0.0043108463287353516
local_in_edges_tensor generation:  0.006003379821777344
mini_batch_src_global generation:  0.02803325653076172
r_  generation:  0.3203613758087158
local_output_nid generation:  0.00424647331237793
local_in_edges_tensor generation:  0.006246805191040039
mini_batch_src_global generation:  0.02838873863220215
r_  generation:  0.32488560676574707
local_output_nid generation:  0.004250288009643555
local_in_edges_tensor generation:  0.005839347839355469
mini_batch_src_global generation:  0.028949499130249023
r_  generation:  0.33058881759643555
local_output_nid generation:  0.0042324066162109375
local_in_edges_tensor generation:  0.006102800369262695
mini_batch_src_global generation:  0.03915047645568848
r_  generation:  0.32781267166137695
local_output_nid generation:  0.004281282424926758
local_in_edges_tensor generation:  0.006288051605224609
mini_batch_src_global generation:  0.028677940368652344
r_  generation:  0.3396470546722412
local_output_nid generation:  0.004210948944091797
local_in_edges_tensor generation:  0.007094621658325195
mini_batch_src_global generation:  0.028226852416992188
r_  generation:  0.3203999996185303
local_output_nid generation:  0.004228830337524414
local_in_edges_tensor generation:  0.005100727081298828
mini_batch_src_global generation:  0.028797388076782227
r_  generation:  0.31978726387023926
local_output_nid generation:  0.004194974899291992
local_in_edges_tensor generation:  0.007386207580566406
mini_batch_src_global generation:  0.03739023208618164
r_  generation:  0.33055949211120605
local_output_nid generation:  0.010620594024658203
local_in_edges_tensor generation:  0.007321596145629883
mini_batch_src_global generation:  0.028691530227661133
r_  generation:  0.3472023010253906
local_output_nid generation:  0.0042688846588134766
local_in_edges_tensor generation:  0.00841069221496582
mini_batch_src_global generation:  0.028772354125976562
r_  generation:  0.3286590576171875
local_output_nid generation:  0.004180192947387695
local_in_edges_tensor generation:  0.01400303840637207
mini_batch_src_global generation:  0.029078960418701172
r_  generation:  0.3431529998779297
local_output_nid generation:  0.0041196346282958984
local_in_edges_tensor generation:  0.018829345703125
mini_batch_src_global generation:  0.029050350189208984
r_  generation:  0.2545332908630371
----------------------check_connections_block total spend ----------------------------- 13.210066318511963
generate_one_block  0.5826220512390137
generate_one_block  0.3321361541748047
generate_one_block  0.2718942165374756
generate_one_block  0.26941394805908203
generate_one_block  0.2689781188964844
generate_one_block  0.26047372817993164
generate_one_block  0.26052379608154297
generate_one_block  0.26374053955078125
generate_one_block  0.2731444835662842
generate_one_block  0.2667689323425293
generate_one_block  0.2618992328643799
generate_one_block  0.279144287109375
generate_one_block  0.27033400535583496
generate_one_block  0.2747182846069336
generate_one_block  0.28124189376831055
generate_one_block  0.27971696853637695
generate_one_block  0.2762789726257324
generate_one_block  0.2888941764831543
generate_one_block  0.2872123718261719
generate_one_block  0.2716503143310547
generate_one_block  0.27138233184814453
generate_one_block  0.2703549861907959
generate_one_block  0.2740004062652588
generate_one_block  0.27680325508117676
generate_one_block  0.2851276397705078
generate_one_block  0.27973031997680664
generate_one_block  0.2788503170013428
generate_one_block  0.28662896156311035
generate_one_block  0.29971766471862793
generate_one_block  0.2931528091430664
generate_one_block  0.3016338348388672
generate_one_block  0.27544260025024414
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.4155378341674805
gen group dst list time:  0.313873291015625
time for parepare:  0.46543383598327637
local_output_nid generation:  0.11440157890319824
local_in_edges_tensor generation:  0.6867685317993164
mini_batch_src_global generation:  0.563499927520752
r_  generation:  6.429825305938721
local_output_nid generation:  0.1327347755432129
local_in_edges_tensor generation:  0.40560293197631836
mini_batch_src_global generation:  0.6986536979675293
r_  generation:  6.739750862121582
local_output_nid generation:  0.11419820785522461
local_in_edges_tensor generation:  0.4063878059387207
mini_batch_src_global generation:  0.7240560054779053
r_  generation:  6.840465784072876
local_output_nid generation:  0.1393570899963379
local_in_edges_tensor generation:  0.5831472873687744
mini_batch_src_global generation:  0.7144579887390137
r_  generation:  6.8686254024505615
local_output_nid generation:  0.1111445426940918
local_in_edges_tensor generation:  0.4388744831085205
mini_batch_src_global generation:  0.7316718101501465
r_  generation:  7.133321285247803
local_output_nid generation:  0.13044095039367676
local_in_edges_tensor generation:  0.705845832824707
mini_batch_src_global generation:  0.7301993370056152
r_  generation:  7.0128560066223145
local_output_nid generation:  0.11714744567871094
local_in_edges_tensor generation:  0.4606204032897949
mini_batch_src_global generation:  0.771148681640625
r_  generation:  7.236541986465454
local_output_nid generation:  0.13167166709899902
local_in_edges_tensor generation:  0.5757591724395752
mini_batch_src_global generation:  0.7411017417907715
r_  generation:  7.05923056602478
local_output_nid generation:  0.1206057071685791
local_in_edges_tensor generation:  0.4449443817138672
mini_batch_src_global generation:  0.8217422962188721
r_  generation:  7.179493188858032
local_output_nid generation:  0.12793326377868652
local_in_edges_tensor generation:  0.5621128082275391
mini_batch_src_global generation:  0.7338299751281738
r_  generation:  6.930821657180786
local_output_nid generation:  0.11595463752746582
local_in_edges_tensor generation:  0.4425771236419678
mini_batch_src_global generation:  0.7444384098052979
r_  generation:  7.1604979038238525
local_output_nid generation:  0.1260814666748047
local_in_edges_tensor generation:  1.19581937789917
mini_batch_src_global generation:  0.7396547794342041
r_  generation:  7.047935724258423
local_output_nid generation:  0.11271333694458008
local_in_edges_tensor generation:  0.4314708709716797
mini_batch_src_global generation:  0.7878270149230957
r_  generation:  7.219538927078247
local_output_nid generation:  0.12760639190673828
local_in_edges_tensor generation:  0.5642175674438477
mini_batch_src_global generation:  0.7424831390380859
r_  generation:  6.976821422576904
local_output_nid generation:  0.12923622131347656
local_in_edges_tensor generation:  0.4309806823730469
mini_batch_src_global generation:  0.8896150588989258
r_  generation:  7.573979377746582
local_output_nid generation:  0.14197802543640137
local_in_edges_tensor generation:  0.5804424285888672
mini_batch_src_global generation:  0.7834789752960205
r_  generation:  7.1709699630737305
local_output_nid generation:  0.10771822929382324
local_in_edges_tensor generation:  0.4401743412017822
mini_batch_src_global generation:  0.8328075408935547
r_  generation:  7.213565826416016
local_output_nid generation:  0.13934946060180664
local_in_edges_tensor generation:  0.5885345935821533
mini_batch_src_global generation:  0.7455310821533203
r_  generation:  7.1530656814575195
local_output_nid generation:  0.1120455265045166
local_in_edges_tensor generation:  0.43056535720825195
mini_batch_src_global generation:  0.807659387588501
r_  generation:  7.157631158828735
local_output_nid generation:  0.13914251327514648
local_in_edges_tensor generation:  0.5745759010314941
mini_batch_src_global generation:  0.7521359920501709
r_  generation:  7.10601282119751
local_output_nid generation:  0.10677695274353027
local_in_edges_tensor generation:  0.43650174140930176
mini_batch_src_global generation:  0.7829258441925049
r_  generation:  7.226408004760742
local_output_nid generation:  0.1390829086303711
local_in_edges_tensor generation:  0.5742654800415039
mini_batch_src_global generation:  0.7493798732757568
r_  generation:  7.05814266204834
local_output_nid generation:  0.10670900344848633
local_in_edges_tensor generation:  0.4409818649291992
mini_batch_src_global generation:  0.7911627292633057
r_  generation:  7.235504865646362
local_output_nid generation:  0.12987446784973145
local_in_edges_tensor generation:  0.5742640495300293
mini_batch_src_global generation:  0.7569637298583984
r_  generation:  7.143563508987427
local_output_nid generation:  0.12002062797546387
local_in_edges_tensor generation:  0.43143725395202637
mini_batch_src_global generation:  0.8017096519470215
r_  generation:  7.292583227157593
local_output_nid generation:  0.13060450553894043
local_in_edges_tensor generation:  0.5746300220489502
mini_batch_src_global generation:  0.7555241584777832
r_  generation:  7.128208160400391
local_output_nid generation:  0.1182243824005127
local_in_edges_tensor generation:  0.4332592487335205
mini_batch_src_global generation:  0.7829844951629639
r_  generation:  7.254399538040161
local_output_nid generation:  0.1277618408203125
local_in_edges_tensor generation:  0.5718154907226562
mini_batch_src_global generation:  0.7548651695251465
r_  generation:  7.08985710144043
local_output_nid generation:  0.11998105049133301
local_in_edges_tensor generation:  0.4372551441192627
mini_batch_src_global generation:  0.7919356822967529
r_  generation:  7.363081932067871
local_output_nid generation:  0.12978363037109375
local_in_edges_tensor generation:  0.5742206573486328
mini_batch_src_global generation:  0.7656166553497314
r_  generation:  7.109098196029663
local_output_nid generation:  0.12002944946289062
local_in_edges_tensor generation:  0.4521455764770508
mini_batch_src_global generation:  0.7886350154876709
r_  generation:  7.2988646030426025
local_output_nid generation:  0.12863588333129883
local_in_edges_tensor generation:  0.5693488121032715
mini_batch_src_global generation:  0.7537639141082764
r_  generation:  7.000913143157959
----------------------check_connections_block total spend ----------------------------- 311.517719745636
generate_one_block  10.135016202926636
generate_one_block  9.912235021591187
generate_one_block  9.46718144416809
generate_one_block  9.942968130111694
generate_one_block  9.522189855575562
generate_one_block  10.210732460021973
generate_one_block  9.398514032363892
generate_one_block  10.174728155136108
generate_one_block  9.821454286575317
generate_one_block  9.611717700958252
generate_one_block  9.824876308441162
generate_one_block  9.571123600006104
generate_one_block  9.96116018295288
generate_one_block  9.425670623779297
generate_one_block  10.02999234199524
generate_one_block  9.488045454025269
generate_one_block  10.248406648635864
generate_one_block  9.913206815719604
generate_one_block  9.74652886390686
generate_one_block  9.936492919921875
generate_one_block  9.774482488632202
generate_one_block  10.197262525558472
generate_one_block  9.645472764968872
generate_one_block  10.301157474517822
generate_one_block  9.98368239402771
generate_one_block  10.138236999511719
generate_one_block  10.222082138061523
generate_one_block  10.014533281326294
generate_one_block  10.74482274055481
generate_one_block  9.93302297592163
generate_one_block  10.723535776138306
generate_one_block  10.24506139755249
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.7934608459472656
gen group dst list time:  2.0583698749542236
time for parepare:  0.4808931350708008
local_output_nid generation:  0.5734081268310547
local_in_edges_tensor generation:  2.321974515914917
mini_batch_src_global generation:  2.2209067344665527
r_  generation:  26.152779579162598
local_output_nid generation:  0.6402437686920166
local_in_edges_tensor generation:  2.3637988567352295
mini_batch_src_global generation:  3.226733922958374
r_  generation:  24.53619933128357
local_output_nid generation:  0.9202330112457275
local_in_edges_tensor generation:  2.195556163787842
mini_batch_src_global generation:  2.6670806407928467
r_  generation:  23.660593032836914
local_output_nid generation:  0.8971860408782959
local_in_edges_tensor generation:  2.005420207977295
mini_batch_src_global generation:  2.656078815460205
r_  generation:  22.883525371551514
local_output_nid generation:  0.6696109771728516
local_in_edges_tensor generation:  1.834242343902588
mini_batch_src_global generation:  2.565406322479248
r_  generation:  22.965704202651978
local_output_nid generation:  0.6460187435150146
local_in_edges_tensor generation:  1.7869224548339844
mini_batch_src_global generation:  2.5877890586853027
r_  generation:  23.13762903213501
local_output_nid generation:  0.6325368881225586
local_in_edges_tensor generation:  1.7782156467437744
mini_batch_src_global generation:  2.934980630874634
r_  generation:  22.95459246635437
local_output_nid generation:  0.6377239227294922
local_in_edges_tensor generation:  1.7581157684326172
mini_batch_src_global generation:  2.621732711791992
r_  generation:  22.750234127044678
local_output_nid generation:  0.7232656478881836
local_in_edges_tensor generation:  1.8328795433044434
mini_batch_src_global generation:  2.5316386222839355
r_  generation:  22.84296202659607
local_output_nid generation:  0.7089807987213135
local_in_edges_tensor generation:  1.7544243335723877
mini_batch_src_global generation:  2.626788854598999
r_  generation:  23.07485318183899
local_output_nid generation:  0.6876544952392578
local_in_edges_tensor generation:  1.7684180736541748
mini_batch_src_global generation:  2.9088165760040283
r_  generation:  22.98217463493347
local_output_nid generation:  0.6816561222076416
local_in_edges_tensor generation:  1.7586338520050049
mini_batch_src_global generation:  2.6227917671203613
r_  generation:  22.787458419799805
local_output_nid generation:  0.6916124820709229
local_in_edges_tensor generation:  1.8339259624481201
mini_batch_src_global generation:  2.485344409942627
r_  generation:  22.860084772109985
local_output_nid generation:  0.6724686622619629
local_in_edges_tensor generation:  1.7503974437713623
mini_batch_src_global generation:  2.635453462600708
r_  generation:  22.826143980026245
local_output_nid generation:  0.7009894847869873
local_in_edges_tensor generation:  1.859628438949585
mini_batch_src_global generation:  2.78117036819458
r_  generation:  23.110138654708862
local_output_nid generation:  0.69252610206604
local_in_edges_tensor generation:  1.7645866870880127
mini_batch_src_global generation:  2.755173683166504
r_  generation:  22.909600019454956
local_output_nid generation:  0.6816442012786865
local_in_edges_tensor generation:  1.7607121467590332
mini_batch_src_global generation:  2.4483606815338135
r_  generation:  22.972232818603516
local_output_nid generation:  0.7188231945037842
local_in_edges_tensor generation:  1.9139394760131836
mini_batch_src_global generation:  2.6110002994537354
r_  generation:  22.964475393295288
local_output_nid generation:  0.7026424407958984
local_in_edges_tensor generation:  1.837226152420044
mini_batch_src_global generation:  2.589956521987915
r_  generation:  22.91443943977356
local_output_nid generation:  0.6810543537139893
local_in_edges_tensor generation:  1.7624485492706299
mini_batch_src_global generation:  2.636922597885132
r_  generation:  23.072051763534546
local_output_nid generation:  0.6929192543029785
local_in_edges_tensor generation:  1.8691580295562744
mini_batch_src_global generation:  2.794916868209839
r_  generation:  23.222277879714966
local_output_nid generation:  0.6893515586853027
local_in_edges_tensor generation:  1.7706267833709717
mini_batch_src_global generation:  2.7857279777526855
r_  generation:  22.893102884292603
local_output_nid generation:  0.7036781311035156
local_in_edges_tensor generation:  1.7550601959228516
mini_batch_src_global generation:  2.6557464599609375
r_  generation:  22.933148860931396
local_output_nid generation:  0.710939884185791
local_in_edges_tensor generation:  1.9831418991088867
mini_batch_src_global generation:  2.6103267669677734
r_  generation:  23.045488834381104
local_output_nid generation:  0.729311466217041
local_in_edges_tensor generation:  1.829291820526123
mini_batch_src_global generation:  2.5415313243865967
r_  generation:  22.82988715171814
local_output_nid generation:  0.6644861698150635
local_in_edges_tensor generation:  1.7827723026275635
mini_batch_src_global generation:  2.630509614944458
r_  generation:  23.10166049003601
local_output_nid generation:  0.6927902698516846
local_in_edges_tensor generation:  1.8738572597503662
mini_batch_src_global generation:  2.771275281906128
r_  generation:  23.169856548309326
local_output_nid generation:  0.6671903133392334
local_in_edges_tensor generation:  1.8075129985809326
mini_batch_src_global generation:  2.565671443939209
r_  generation:  23.000842571258545
local_output_nid generation:  0.6507952213287354
local_in_edges_tensor generation:  1.9139397144317627
mini_batch_src_global generation:  2.6986687183380127
r_  generation:  22.965343236923218
local_output_nid generation:  0.6420178413391113
local_in_edges_tensor generation:  1.752897024154663
mini_batch_src_global generation:  2.603546380996704
r_  generation:  22.907299995422363
local_output_nid generation:  0.6356091499328613
local_in_edges_tensor generation:  1.8361220359802246
mini_batch_src_global generation:  2.5149881839752197
r_  generation:  23.03320622444153
local_output_nid generation:  0.6568336486816406
local_in_edges_tensor generation:  1.8232104778289795
mini_batch_src_global generation:  2.593012809753418
r_  generation:  23.18715786933899
----------------------check_connections_block total spend ----------------------------- 1042.1995491981506
generate_one_block  35.86560845375061
generate_one_block  33.20854187011719
generate_one_block  32.15077018737793
generate_one_block  32.40221858024597
generate_one_block  32.466411113739014
generate_one_block  32.431262493133545
generate_one_block  32.57177448272705
generate_one_block  35.662434816360474
generate_one_block  32.045085191726685
generate_one_block  32.20967745780945
generate_one_block  32.40122103691101
generate_one_block  32.26545691490173
generate_one_block  32.31604337692261
generate_one_block  32.50726509094238
generate_one_block  32.38995313644409
generate_one_block  32.131333112716675
generate_one_block  32.234060287475586
generate_one_block  32.36716890335083
generate_one_block  32.40507245063782
generate_one_block  32.62133526802063
generate_one_block  33.20124650001526
generate_one_block  32.48217749595642
generate_one_block  32.82512307167053
generate_one_block  32.753005504608154
generate_one_block  32.549922943115234
generate_one_block  32.757864475250244
generate_one_block  32.672343492507935
generate_one_block  32.77279567718506
generate_one_block  32.953500509262085
generate_one_block  32.85976719856262
generate_one_block  32.72830152511597
generate_one_block  32.82915496826172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.551051139831543  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

connection checking time:  1353.7172689437866
block generation total time  1366.3034915924072
average batch blocks generation time:  42.696984112262726
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4008054733276367  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.12746000289917  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3965911865234375  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1186904907226562  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3982129096984863  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1181278228759766  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3965229988098145  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.119032859802246  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3991436958312988  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1279115676879883  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4003920555114746  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1338605880737305  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.39957857131958  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.127096652984619  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3998537063598633  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.129563808441162  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4004807472229004  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1291794776916504  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.400167465209961  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1232290267944336  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3976244926452637  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.120497703552246  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3959708213806152  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1147336959838867  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3960323333740234  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.114758014678955  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3973712921142578  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.116529941558838  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3971457481384277  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1199111938476562  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.395003318786621  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1129150390625  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.397979736328125  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1214356422424316  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4006528854370117  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1299405097961426  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3966631889343262  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1153335571289062  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3986749649047852  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1241531372070312  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4010686874389648  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1322035789489746  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3976554870605469  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1193671226501465  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.400052547454834  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.123917579650879  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3979063034057617  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.121382713317871  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3963851928710938  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.115868091583252  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4011154174804688  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1269068717956543  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.399000644683838  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1217164993286133  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3960633277893066  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1158032417297363  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4000544548034668  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.126640796661377  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.398451328277588  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.122354507446289  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3963451385498047  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.117377758026123  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3962864875793457  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1147327423095703  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3129979595541954 |0.7325987741351128 |0.004529483616352081 |0.0001597180962562561 |0.007722154259681702 |0.0021147727966308594 |
----------------------------------------------------------pseudo_mini_loss sum 3.0863749980926514
Total (block generation + training)time/epoch 2848.5388654470444
Training time/epoch 1647920970.3184514
Training time without block to device /epoch 1647920946.8752906
Training time without total dataloading part /epoch 0.3992781639099121
load block tensor time/epoch 10.015934705734253
block to device time/epoch 23.44316077232361
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  134461985
Number of first layer input nodes during this epoch:  71043763
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.554795265197754  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7797379493713379
random selection method range initialization spend 0.015115499496459961
time for parepare:  0.427593469619751
local_output_nid generation:  0.003998279571533203
local_in_edges_tensor generation:  0.040946245193481445
mini_batch_src_global generation:  0.013921499252319336
r_  generation:  0.16441798210144043
local_output_nid generation:  0.0037658214569091797
local_in_edges_tensor generation:  0.013287544250488281
mini_batch_src_global generation:  0.01692056655883789
r_  generation:  0.18769454956054688
local_output_nid generation:  0.003751039505004883
local_in_edges_tensor generation:  0.011555910110473633
mini_batch_src_global generation:  0.021518707275390625
r_  generation:  0.2002718448638916
local_output_nid generation:  0.003777742385864258
local_in_edges_tensor generation:  0.005153656005859375
mini_batch_src_global generation:  0.011747360229492188
r_  generation:  0.20389938354492188
local_output_nid generation:  0.0037670135498046875
local_in_edges_tensor generation:  0.005287885665893555
mini_batch_src_global generation:  0.011689901351928711
r_  generation:  0.20730066299438477
local_output_nid generation:  0.003765106201171875
local_in_edges_tensor generation:  0.0050241947174072266
mini_batch_src_global generation:  0.013275861740112305
r_  generation:  0.21449565887451172
local_output_nid generation:  0.003770589828491211
local_in_edges_tensor generation:  0.007580280303955078
mini_batch_src_global generation:  0.014932870864868164
r_  generation:  0.224609375
local_output_nid generation:  0.003779888153076172
local_in_edges_tensor generation:  0.009313344955444336
mini_batch_src_global generation:  0.01543736457824707
r_  generation:  0.23035621643066406
local_output_nid generation:  0.01397252082824707
local_in_edges_tensor generation:  0.0053293704986572266
mini_batch_src_global generation:  0.01508951187133789
r_  generation:  0.23270559310913086
local_output_nid generation:  0.003777742385864258
local_in_edges_tensor generation:  0.0053558349609375
mini_batch_src_global generation:  0.025597572326660156
r_  generation:  0.23538422584533691
local_output_nid generation:  0.003749370574951172
local_in_edges_tensor generation:  0.005165576934814453
mini_batch_src_global generation:  0.01676201820373535
r_  generation:  0.23885226249694824
local_output_nid generation:  0.0037589073181152344
local_in_edges_tensor generation:  0.008199214935302734
mini_batch_src_global generation:  0.0183713436126709
r_  generation:  0.2428603172302246
local_output_nid generation:  0.0038747787475585938
local_in_edges_tensor generation:  0.005282163619995117
mini_batch_src_global generation:  0.02331376075744629
r_  generation:  0.252551794052124
local_output_nid generation:  0.003917217254638672
local_in_edges_tensor generation:  0.020396947860717773
mini_batch_src_global generation:  0.018406391143798828
r_  generation:  0.2614781856536865
local_output_nid generation:  0.003780841827392578
local_in_edges_tensor generation:  0.0051555633544921875
mini_batch_src_global generation:  0.018495798110961914
r_  generation:  0.2505953311920166
local_output_nid generation:  0.0037360191345214844
local_in_edges_tensor generation:  0.005117654800415039
mini_batch_src_global generation:  0.018910646438598633
r_  generation:  0.24703192710876465
local_output_nid generation:  0.003753185272216797
local_in_edges_tensor generation:  0.008543729782104492
mini_batch_src_global generation:  0.019089937210083008
r_  generation:  0.2525064945220947
local_output_nid generation:  0.003767728805541992
local_in_edges_tensor generation:  0.006613254547119141
mini_batch_src_global generation:  0.019229412078857422
r_  generation:  0.26723432540893555
local_output_nid generation:  0.003774404525756836
local_in_edges_tensor generation:  0.005808115005493164
mini_batch_src_global generation:  0.03137087821960449
r_  generation:  0.25634074211120605
local_output_nid generation:  0.003989458084106445
local_in_edges_tensor generation:  0.005982160568237305
mini_batch_src_global generation:  0.01958441734313965
r_  generation:  0.24660778045654297
local_output_nid generation:  0.003798961639404297
local_in_edges_tensor generation:  0.005301713943481445
mini_batch_src_global generation:  0.01918196678161621
r_  generation:  0.24833440780639648
local_output_nid generation:  0.004060506820678711
local_in_edges_tensor generation:  0.005979776382446289
mini_batch_src_global generation:  0.02037334442138672
r_  generation:  0.24787449836730957
local_output_nid generation:  0.003804922103881836
local_in_edges_tensor generation:  0.0059473514556884766
mini_batch_src_global generation:  0.020847320556640625
r_  generation:  0.25096797943115234
local_output_nid generation:  0.003782987594604492
local_in_edges_tensor generation:  0.006255626678466797
mini_batch_src_global generation:  0.019558191299438477
r_  generation:  0.24404430389404297
local_output_nid generation:  0.003798246383666992
local_in_edges_tensor generation:  0.006329774856567383
mini_batch_src_global generation:  0.020545005798339844
r_  generation:  0.26029133796691895
local_output_nid generation:  0.003814220428466797
local_in_edges_tensor generation:  0.006459236145019531
mini_batch_src_global generation:  0.01989269256591797
r_  generation:  0.2539536952972412
local_output_nid generation:  0.0037937164306640625
local_in_edges_tensor generation:  0.006358623504638672
mini_batch_src_global generation:  0.020212411880493164
r_  generation:  0.2504420280456543
local_output_nid generation:  0.0038046836853027344
local_in_edges_tensor generation:  0.009286880493164062
mini_batch_src_global generation:  0.019915103912353516
r_  generation:  0.2515299320220947
local_output_nid generation:  0.00731348991394043
local_in_edges_tensor generation:  0.006288766860961914
mini_batch_src_global generation:  0.021300554275512695
r_  generation:  0.2523012161254883
local_output_nid generation:  0.004400491714477539
local_in_edges_tensor generation:  0.006092548370361328
mini_batch_src_global generation:  0.02047109603881836
r_  generation:  0.24960875511169434
local_output_nid generation:  0.003856182098388672
local_in_edges_tensor generation:  0.006766796112060547
mini_batch_src_global generation:  0.020613908767700195
r_  generation:  0.2691640853881836
local_output_nid generation:  0.0037729740142822266
local_in_edges_tensor generation:  0.0054798126220703125
mini_batch_src_global generation:  0.019728660583496094
r_  generation:  0.2537209987640381
----------------------check_connections_block total spend ----------------------------- 10.633256912231445
generate_one_block  0.6012024879455566
generate_one_block  0.33928632736206055
generate_one_block  0.2868459224700928
generate_one_block  0.27678608894348145
generate_one_block  0.275040864944458
generate_one_block  0.26229238510131836
generate_one_block  0.2703416347503662
generate_one_block  0.2840745449066162
generate_one_block  0.2697615623474121
generate_one_block  0.2666168212890625
generate_one_block  0.26738786697387695
generate_one_block  0.2705953121185303
generate_one_block  0.27024316787719727
generate_one_block  0.2668602466583252
generate_one_block  0.26126885414123535
generate_one_block  0.26528048515319824
generate_one_block  0.26756882667541504
generate_one_block  0.26786375045776367
generate_one_block  0.2685258388519287
generate_one_block  0.2734072208404541
generate_one_block  0.26727294921875
generate_one_block  0.2657930850982666
generate_one_block  0.271561861038208
generate_one_block  0.26433539390563965
generate_one_block  0.26930737495422363
generate_one_block  0.2729060649871826
generate_one_block  0.27164793014526367
generate_one_block  0.2670323848724365
generate_one_block  0.28112316131591797
generate_one_block  0.27790188789367676
generate_one_block  0.26954102516174316
generate_one_block  0.27412939071655273
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8111884593963623
gen group dst list time:  0.3232293128967285
time for parepare:  0.5272824764251709
local_output_nid generation:  0.13564443588256836
local_in_edges_tensor generation:  0.5412626266479492
mini_batch_src_global generation:  0.5698909759521484
r_  generation:  6.98863959312439
local_output_nid generation:  0.17744159698486328
local_in_edges_tensor generation:  0.6016454696655273
mini_batch_src_global generation:  0.7068684101104736
r_  generation:  6.888625860214233
local_output_nid generation:  0.11615800857543945
local_in_edges_tensor generation:  0.42281603813171387
mini_batch_src_global generation:  0.6894457340240479
r_  generation:  7.088028192520142
local_output_nid generation:  0.13311123847961426
local_in_edges_tensor generation:  0.8252356052398682
mini_batch_src_global generation:  0.7033345699310303
r_  generation:  6.898151397705078
local_output_nid generation:  0.11713123321533203
local_in_edges_tensor generation:  0.49144887924194336
mini_batch_src_global generation:  0.8342094421386719
r_  generation:  7.571002006530762
local_output_nid generation:  0.14040637016296387
local_in_edges_tensor generation:  0.6178019046783447
mini_batch_src_global generation:  0.7745254039764404
r_  generation:  7.066349506378174
local_output_nid generation:  0.1101233959197998
local_in_edges_tensor generation:  0.4453701972961426
mini_batch_src_global generation:  0.7536535263061523
r_  generation:  7.301290512084961
local_output_nid generation:  0.14178919792175293
local_in_edges_tensor generation:  0.5965080261230469
mini_batch_src_global generation:  0.7439174652099609
r_  generation:  7.086073637008667
local_output_nid generation:  0.11066985130310059
local_in_edges_tensor generation:  0.44340991973876953
mini_batch_src_global generation:  0.7436654567718506
r_  generation:  7.350693225860596
local_output_nid generation:  0.14314699172973633
local_in_edges_tensor generation:  0.589982271194458
mini_batch_src_global generation:  0.7456817626953125
r_  generation:  7.073597192764282
local_output_nid generation:  0.10950851440429688
local_in_edges_tensor generation:  0.43684959411621094
mini_batch_src_global generation:  0.7500936985015869
r_  generation:  7.365358829498291
local_output_nid generation:  0.14315438270568848
local_in_edges_tensor generation:  1.2741565704345703
mini_batch_src_global generation:  0.7570209503173828
r_  generation:  7.18233323097229
local_output_nid generation:  0.10645437240600586
local_in_edges_tensor generation:  0.43976640701293945
mini_batch_src_global generation:  0.789797306060791
r_  generation:  7.327197551727295
local_output_nid generation:  0.1404581069946289
local_in_edges_tensor generation:  0.5804860591888428
mini_batch_src_global generation:  0.7596011161804199
r_  generation:  7.1144421100616455
local_output_nid generation:  0.10746455192565918
local_in_edges_tensor generation:  0.43558478355407715
mini_batch_src_global generation:  0.8481967449188232
r_  generation:  7.570605993270874
local_output_nid generation:  0.14285898208618164
local_in_edges_tensor generation:  0.5960695743560791
mini_batch_src_global generation:  0.7905449867248535
r_  generation:  7.203199625015259
local_output_nid generation:  0.11085319519042969
local_in_edges_tensor generation:  0.438157320022583
mini_batch_src_global generation:  0.8441948890686035
r_  generation:  7.436039686203003
local_output_nid generation:  0.13759684562683105
local_in_edges_tensor generation:  0.5940761566162109
mini_batch_src_global generation:  0.7530667781829834
r_  generation:  7.088681697845459
local_output_nid generation:  0.11073017120361328
local_in_edges_tensor generation:  0.4488692283630371
mini_batch_src_global generation:  0.8497240543365479
r_  generation:  7.416336536407471
local_output_nid generation:  0.1442415714263916
local_in_edges_tensor generation:  0.5891633033752441
mini_batch_src_global generation:  0.7655470371246338
r_  generation:  7.172322988510132
local_output_nid generation:  0.10851454734802246
local_in_edges_tensor generation:  0.43796634674072266
mini_batch_src_global generation:  0.792802095413208
r_  generation:  7.422380208969116
local_output_nid generation:  0.14171671867370605
local_in_edges_tensor generation:  0.5922119617462158
mini_batch_src_global generation:  0.7675056457519531
r_  generation:  7.148569583892822
local_output_nid generation:  0.1102609634399414
local_in_edges_tensor generation:  0.436887264251709
mini_batch_src_global generation:  0.8604710102081299
r_  generation:  7.342046022415161
local_output_nid generation:  0.14069271087646484
local_in_edges_tensor generation:  0.5902080535888672
mini_batch_src_global generation:  0.7613484859466553
r_  generation:  7.113934278488159
local_output_nid generation:  0.10849475860595703
local_in_edges_tensor generation:  0.46416354179382324
mini_batch_src_global generation:  0.7932238578796387
r_  generation:  7.340202569961548
local_output_nid generation:  0.14086532592773438
local_in_edges_tensor generation:  0.5882327556610107
mini_batch_src_global generation:  0.7618601322174072
r_  generation:  7.129089593887329
local_output_nid generation:  0.1117246150970459
local_in_edges_tensor generation:  0.4402172565460205
mini_batch_src_global generation:  0.75948166847229
r_  generation:  7.447066783905029
local_output_nid generation:  0.1383068561553955
local_in_edges_tensor generation:  0.5765540599822998
mini_batch_src_global generation:  0.7525880336761475
r_  generation:  7.1063642501831055
local_output_nid generation:  0.11073708534240723
local_in_edges_tensor generation:  0.4415171146392822
mini_batch_src_global generation:  0.7599401473999023
r_  generation:  7.429687976837158
local_output_nid generation:  0.1317610740661621
local_in_edges_tensor generation:  0.5814456939697266
mini_batch_src_global generation:  0.762178897857666
r_  generation:  7.161373615264893
local_output_nid generation:  0.12033581733703613
local_in_edges_tensor generation:  0.4401538372039795
mini_batch_src_global generation:  0.7691829204559326
r_  generation:  7.451151132583618
local_output_nid generation:  0.1311039924621582
local_in_edges_tensor generation:  0.5766451358795166
mini_batch_src_global generation:  0.7589197158813477
r_  generation:  7.081005096435547
----------------------check_connections_block total spend ----------------------------- 317.0423541069031
generate_one_block  10.21838092803955
generate_one_block  9.920575380325317
generate_one_block  9.665984869003296
generate_one_block  9.859920263290405
generate_one_block  9.600638628005981
generate_one_block  10.565672874450684
generate_one_block  9.597343683242798
generate_one_block  10.08763575553894
generate_one_block  9.543744325637817
generate_one_block  10.043770790100098
generate_one_block  9.865399599075317
generate_one_block  9.803914308547974
generate_one_block  10.000293254852295
generate_one_block  9.72020149230957
generate_one_block  9.762396812438965
generate_one_block  9.67942762374878
generate_one_block  9.846571445465088
generate_one_block  9.659876823425293
generate_one_block  9.92698335647583
generate_one_block  9.690145015716553
generate_one_block  10.017561435699463
generate_one_block  9.696521759033203
generate_one_block  9.833818435668945
generate_one_block  9.534324884414673
generate_one_block  9.906692266464233
generate_one_block  9.506597757339478
generate_one_block  9.902184963226318
generate_one_block  9.492161989212036
generate_one_block  10.031514167785645
generate_one_block  9.530327558517456
generate_one_block  10.008591890335083
generate_one_block  9.701719760894775
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.8492627143859863
gen group dst list time:  1.8486590385437012
time for parepare:  0.48873090744018555
local_output_nid generation:  0.624720573425293
local_in_edges_tensor generation:  1.7107317447662354
mini_batch_src_global generation:  1.8095932006835938
r_  generation:  22.218626737594604
local_output_nid generation:  0.6733860969543457
local_in_edges_tensor generation:  1.8254873752593994
mini_batch_src_global generation:  2.482252597808838
r_  generation:  22.37382221221924
local_output_nid generation:  0.6680994033813477
local_in_edges_tensor generation:  1.7459850311279297
mini_batch_src_global generation:  2.4826362133026123
r_  generation:  22.567206382751465
local_output_nid generation:  0.650397539138794
local_in_edges_tensor generation:  1.7441837787628174
mini_batch_src_global generation:  2.503166675567627
r_  generation:  22.912251472473145
local_output_nid generation:  0.645909309387207
local_in_edges_tensor generation:  1.6886274814605713
mini_batch_src_global generation:  2.6679139137268066
r_  generation:  22.877518892288208
local_output_nid generation:  0.6577036380767822
local_in_edges_tensor generation:  1.7605247497558594
mini_batch_src_global generation:  2.6139681339263916
r_  generation:  22.73673391342163
local_output_nid generation:  0.651003360748291
local_in_edges_tensor generation:  1.751286268234253
mini_batch_src_global generation:  2.4949593544006348
r_  generation:  22.966148376464844
local_output_nid generation:  0.6399240493774414
local_in_edges_tensor generation:  1.6960225105285645
mini_batch_src_global generation:  2.5534565448760986
r_  generation:  22.746043920516968
local_output_nid generation:  0.7006258964538574
local_in_edges_tensor generation:  1.7644031047821045
mini_batch_src_global generation:  2.605938196182251
r_  generation:  23.576111793518066
local_output_nid generation:  0.6357018947601318
local_in_edges_tensor generation:  1.7051336765289307
mini_batch_src_global generation:  2.8475351333618164
r_  generation:  23.649871349334717
local_output_nid generation:  0.6660826206207275
local_in_edges_tensor generation:  1.719928503036499
mini_batch_src_global generation:  2.7870640754699707
r_  generation:  24.550128698349
local_output_nid generation:  0.6516256332397461
local_in_edges_tensor generation:  1.7060084342956543
mini_batch_src_global generation:  3.0518558025360107
r_  generation:  24.37216329574585
local_output_nid generation:  0.6561794281005859
local_in_edges_tensor generation:  1.7691459655761719
mini_batch_src_global generation:  3.031249523162842
r_  generation:  24.28710103034973
local_output_nid generation:  0.6399478912353516
local_in_edges_tensor generation:  1.7281990051269531
mini_batch_src_global generation:  3.315101146697998
r_  generation:  23.799413204193115
local_output_nid generation:  0.6496920585632324
local_in_edges_tensor generation:  1.7893424034118652
mini_batch_src_global generation:  3.0277132987976074
r_  generation:  23.731732845306396
local_output_nid generation:  0.6468098163604736
local_in_edges_tensor generation:  1.7367677688598633
mini_batch_src_global generation:  3.293581247329712
r_  generation:  23.67639422416687
local_output_nid generation:  0.6598997116088867
local_in_edges_tensor generation:  1.8962130546569824
mini_batch_src_global generation:  3.111666202545166
r_  generation:  23.909682750701904
local_output_nid generation:  0.641319990158081
local_in_edges_tensor generation:  1.7674062252044678
mini_batch_src_global generation:  3.408412456512451
r_  generation:  23.489188194274902
local_output_nid generation:  0.6572942733764648
local_in_edges_tensor generation:  2.027799606323242
mini_batch_src_global generation:  3.1769652366638184
r_  generation:  25.992897033691406
local_output_nid generation:  0.6451385021209717
local_in_edges_tensor generation:  2.1305978298187256
mini_batch_src_global generation:  3.6330127716064453
r_  generation:  23.991364002227783
local_output_nid generation:  0.6727488040924072
local_in_edges_tensor generation:  2.085209369659424
mini_batch_src_global generation:  3.535881280899048
r_  generation:  26.26329016685486
local_output_nid generation:  0.7028353214263916
local_in_edges_tensor generation:  2.040501117706299
mini_batch_src_global generation:  2.929690361022949
r_  generation:  28.803218126296997
local_output_nid generation:  0.9764883518218994
local_in_edges_tensor generation:  2.9942708015441895
mini_batch_src_global generation:  2.9633326530456543
r_  generation:  25.072218418121338
local_output_nid generation:  0.847118616104126
local_in_edges_tensor generation:  1.886925458908081
mini_batch_src_global generation:  2.6368300914764404
r_  generation:  23.38700795173645
local_output_nid generation:  0.6647729873657227
local_in_edges_tensor generation:  1.780015468597412
mini_batch_src_global generation:  2.6125247478485107
r_  generation:  23.83578610420227
local_output_nid generation:  0.6509270668029785
local_in_edges_tensor generation:  1.7711975574493408
mini_batch_src_global generation:  2.6706738471984863
r_  generation:  23.32993173599243
local_output_nid generation:  0.6527693271636963
local_in_edges_tensor generation:  1.7801389694213867
mini_batch_src_global generation:  2.6253662109375
r_  generation:  23.930127143859863
local_output_nid generation:  0.6549215316772461
local_in_edges_tensor generation:  1.7533173561096191
mini_batch_src_global generation:  2.720323324203491
r_  generation:  23.240079879760742
local_output_nid generation:  0.7235414981842041
local_in_edges_tensor generation:  1.8157339096069336
mini_batch_src_global generation:  2.664320707321167
r_  generation:  23.568184852600098
local_output_nid generation:  0.6979303359985352
local_in_edges_tensor generation:  1.78165864944458
mini_batch_src_global generation:  2.79526424407959
r_  generation:  23.428959369659424
local_output_nid generation:  0.7249815464019775
local_in_edges_tensor generation:  1.8218317031860352
mini_batch_src_global generation:  2.6713218688964844
r_  generation:  23.563202142715454
local_output_nid generation:  0.6916770935058594
local_in_edges_tensor generation:  1.7906596660614014
mini_batch_src_global generation:  2.763298988342285
r_  generation:  23.227094173431396
----------------------check_connections_block total spend ----------------------------- 1076.1398487091064
generate_one_block  38.6575071811676
generate_one_block  34.12886309623718
generate_one_block  32.57079839706421
generate_one_block  32.923816204071045
generate_one_block  32.72939348220825
generate_one_block  32.751978397369385
generate_one_block  32.78072452545166
generate_one_block  32.659531116485596
generate_one_block  33.42084789276123
generate_one_block  32.73669791221619
generate_one_block  32.677257776260376
generate_one_block  32.49120259284973
generate_one_block  32.505430698394775
generate_one_block  32.40921187400818
generate_one_block  32.53281307220459
generate_one_block  32.711241722106934
generate_one_block  33.162142515182495
generate_one_block  32.43939471244812
generate_one_block  32.45545196533203
generate_one_block  32.56923294067383
generate_one_block  32.51136136054993
generate_one_block  32.57910227775574
generate_one_block  32.53783845901489
generate_one_block  32.63866424560547
generate_one_block  33.20856690406799
generate_one_block  32.60524535179138
generate_one_block  32.463122844696045
generate_one_block  32.360533475875854
generate_one_block  32.5997896194458
generate_one_block  33.524601459503174
generate_one_block  32.433793783187866
generate_one_block  32.21253991127014
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.554795265197754  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

connection checking time:  1393.1822028160095
block generation total time  1367.2095918655396
average batch blocks generation time:  42.72529974579811
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3986396789550781  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.124814987182617  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.394803524017334  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1149144172668457  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3946280479431152  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.111050605773926  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4002842903137207  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1237711906433105  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3955049514770508  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1137232780456543  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.396775245666504  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.116692066192627  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4003663063049316  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.129277229309082  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3955073356628418  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1145458221435547  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.400118350982666  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1283674240112305  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3989381790161133  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.119960308074951  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4001407623291016  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1270546913146973  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4007062911987305  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1299967765808105  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3991127014160156  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.126739025115967  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3968052864074707  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.119434356689453  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3955802917480469  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.111964225769043  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4006576538085938  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.127596378326416  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3967385292053223  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1179704666137695  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3958168029785156  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.114881992340088  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3992772102355957  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.129394054412842  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3996577262878418  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1276516914367676  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3985404968261719  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1238021850585938  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3994030952453613  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1242852210998535  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3959598541259766  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.11622953414917  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3965458869934082  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.11482572555542  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4002304077148438  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.128249168395996  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3946490287780762  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1171135902404785  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3957610130310059  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1167755126953125  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3943448066711426  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1084537506103516  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3958320617675781  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.118185043334961  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3990521430969238  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.127284049987793  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3994483947753906  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.126805305480957  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3940277099609375  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.10836124420166  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37973005324602127 |0.8385927006602287 |0.003996424376964569 |0.00015010684728622437 |0.003545016050338745 |0.0012710094451904297 |
----------------------------------------------------------pseudo_mini_loss sum 2.6656768321990967
Total (block generation + training)time/epoch 2864.4726457595825
Training time/epoch 1647923866.6590939
Training time without block to device /epoch 1647923839.8241274
Training time without total dataloading part /epoch 0.24740052223205566
load block tensor time/epoch 12.15136170387268
block to device time/epoch 26.83496642112732
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  134412033
Number of first layer input nodes during this epoch:  71028448
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.5491437911987305  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6595375537872314
random selection method range initialization spend 0.013109922409057617
time for parepare:  0.36777329444885254
local_output_nid generation:  0.0036127567291259766
local_in_edges_tensor generation:  0.03774619102478027
mini_batch_src_global generation:  0.014025449752807617
r_  generation:  0.17121076583862305
local_output_nid generation:  0.003786325454711914
local_in_edges_tensor generation:  0.008017778396606445
mini_batch_src_global generation:  0.016913890838623047
r_  generation:  0.1929454803466797
local_output_nid generation:  0.003716707229614258
local_in_edges_tensor generation:  0.007485628128051758
mini_batch_src_global generation:  0.011389493942260742
r_  generation:  0.1967029571533203
local_output_nid generation:  0.0037221908569335938
local_in_edges_tensor generation:  0.007927656173706055
mini_batch_src_global generation:  0.014810800552368164
r_  generation:  0.26758527755737305
local_output_nid generation:  0.005929708480834961
local_in_edges_tensor generation:  0.010378599166870117
mini_batch_src_global generation:  0.012717247009277344
r_  generation:  0.21549463272094727
local_output_nid generation:  0.005179643630981445
local_in_edges_tensor generation:  0.00514984130859375
mini_batch_src_global generation:  0.013470649719238281
r_  generation:  0.22070765495300293
local_output_nid generation:  0.0037202835083007812
local_in_edges_tensor generation:  0.005028963088989258
mini_batch_src_global generation:  0.014150381088256836
r_  generation:  0.22960853576660156
local_output_nid generation:  0.0037190914154052734
local_in_edges_tensor generation:  0.005254507064819336
mini_batch_src_global generation:  0.014444828033447266
r_  generation:  0.23231887817382812
local_output_nid generation:  0.0037364959716796875
local_in_edges_tensor generation:  0.005021810531616211
mini_batch_src_global generation:  0.014977455139160156
r_  generation:  0.23720288276672363
local_output_nid generation:  0.0054700374603271484
local_in_edges_tensor generation:  0.006834506988525391
mini_batch_src_global generation:  0.01577162742614746
r_  generation:  0.2409219741821289
local_output_nid generation:  0.003735065460205078
local_in_edges_tensor generation:  0.005711793899536133
mini_batch_src_global generation:  0.017830371856689453
r_  generation:  0.2464888095855713
local_output_nid generation:  0.003729104995727539
local_in_edges_tensor generation:  0.005715608596801758
mini_batch_src_global generation:  0.017414093017578125
r_  generation:  0.24596023559570312
local_output_nid generation:  0.003743886947631836
local_in_edges_tensor generation:  0.005079030990600586
mini_batch_src_global generation:  0.02008843421936035
r_  generation:  0.24981427192687988
local_output_nid generation:  0.0037086009979248047
local_in_edges_tensor generation:  0.0051152706146240234
mini_batch_src_global generation:  0.019889354705810547
r_  generation:  0.24726438522338867
local_output_nid generation:  0.003725767135620117
local_in_edges_tensor generation:  0.006403684616088867
mini_batch_src_global generation:  0.020360469818115234
r_  generation:  0.2483828067779541
local_output_nid generation:  0.0037758350372314453
local_in_edges_tensor generation:  0.005842447280883789
mini_batch_src_global generation:  0.02134251594543457
r_  generation:  0.2480921745300293
local_output_nid generation:  0.004849910736083984
local_in_edges_tensor generation:  0.008828401565551758
mini_batch_src_global generation:  0.019329071044921875
r_  generation:  0.2508354187011719
local_output_nid generation:  0.00480198860168457
local_in_edges_tensor generation:  0.005790233612060547
mini_batch_src_global generation:  0.01958012580871582
r_  generation:  0.2470088005065918
local_output_nid generation:  0.003794431686401367
local_in_edges_tensor generation:  0.006958723068237305
mini_batch_src_global generation:  0.019676685333251953
r_  generation:  0.2540924549102783
local_output_nid generation:  0.0037136077880859375
local_in_edges_tensor generation:  0.007448673248291016
mini_batch_src_global generation:  0.01974773406982422
r_  generation:  0.24451160430908203
local_output_nid generation:  0.0037326812744140625
local_in_edges_tensor generation:  0.0052721500396728516
mini_batch_src_global generation:  0.019588470458984375
r_  generation:  0.26406097412109375
local_output_nid generation:  0.0037682056427001953
local_in_edges_tensor generation:  0.006342172622680664
mini_batch_src_global generation:  0.019618749618530273
r_  generation:  0.2476487159729004
local_output_nid generation:  0.0037322044372558594
local_in_edges_tensor generation:  0.005578756332397461
mini_batch_src_global generation:  0.01983642578125
r_  generation:  0.259566068649292
local_output_nid generation:  0.003717184066772461
local_in_edges_tensor generation:  0.0056989192962646484
mini_batch_src_global generation:  0.019710540771484375
r_  generation:  0.25118112564086914
local_output_nid generation:  0.0037360191345214844
local_in_edges_tensor generation:  0.0056226253509521484
mini_batch_src_global generation:  0.020101547241210938
r_  generation:  0.2554199695587158
local_output_nid generation:  0.0037398338317871094
local_in_edges_tensor generation:  0.0057222843170166016
mini_batch_src_global generation:  0.01992034912109375
r_  generation:  0.25305795669555664
local_output_nid generation:  0.003916025161743164
local_in_edges_tensor generation:  0.005695819854736328
mini_batch_src_global generation:  0.020215272903442383
r_  generation:  0.2601652145385742
local_output_nid generation:  0.003735780715942383
local_in_edges_tensor generation:  0.0065424442291259766
mini_batch_src_global generation:  0.019876718521118164
r_  generation:  0.25281786918640137
local_output_nid generation:  0.0037643909454345703
local_in_edges_tensor generation:  0.005181074142456055
mini_batch_src_global generation:  0.020209550857543945
r_  generation:  0.2816154956817627
local_output_nid generation:  0.003750324249267578
local_in_edges_tensor generation:  0.006709098815917969
mini_batch_src_global generation:  0.02297067642211914
r_  generation:  0.27889394760131836
local_output_nid generation:  0.003736734390258789
local_in_edges_tensor generation:  0.01902914047241211
mini_batch_src_global generation:  0.02293848991394043
r_  generation:  0.29367494583129883
local_output_nid generation:  0.003725767135620117
local_in_edges_tensor generation:  0.00885915756225586
mini_batch_src_global generation:  0.02839827537536621
r_  generation:  0.2491140365600586
----------------------check_connections_block total spend ----------------------------- 10.683343648910522
generate_one_block  0.5975685119628906
generate_one_block  0.33944129943847656
generate_one_block  0.2861299514770508
generate_one_block  0.2798779010772705
generate_one_block  0.30142879486083984
generate_one_block  0.28841614723205566
generate_one_block  0.27443385124206543
generate_one_block  0.2714264392852783
generate_one_block  0.29047727584838867
generate_one_block  0.29732465744018555
generate_one_block  0.4468231201171875
generate_one_block  0.4257626533508301
generate_one_block  0.30233025550842285
generate_one_block  0.2881624698638916
generate_one_block  0.2802774906158447
generate_one_block  0.2936277389526367
generate_one_block  0.2717435359954834
generate_one_block  0.2750682830810547
generate_one_block  0.2860836982727051
generate_one_block  0.2659797668457031
generate_one_block  0.27143430709838867
generate_one_block  0.26918530464172363
generate_one_block  0.2640516757965088
generate_one_block  0.27087855339050293
generate_one_block  0.2664375305175781
generate_one_block  0.269193172454834
generate_one_block  0.2699301242828369
generate_one_block  0.26477575302124023
generate_one_block  0.2717571258544922
generate_one_block  0.2676539421081543
generate_one_block  0.26886820793151855
generate_one_block  0.26335740089416504
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.4253628253936768
gen group dst list time:  0.3031337261199951
time for parepare:  0.4923827648162842
local_output_nid generation:  0.12356877326965332
local_in_edges_tensor generation:  0.5823225975036621
mini_batch_src_global generation:  0.5867962837219238
r_  generation:  6.659733772277832
local_output_nid generation:  0.13436341285705566
local_in_edges_tensor generation:  0.5802693367004395
mini_batch_src_global generation:  0.7070813179016113
r_  generation:  6.690640449523926
local_output_nid generation:  0.12227272987365723
local_in_edges_tensor generation:  0.47211480140686035
mini_batch_src_global generation:  0.6885159015655518
r_  generation:  6.9928154945373535
local_output_nid generation:  0.14879107475280762
local_in_edges_tensor generation:  0.7475910186767578
mini_batch_src_global generation:  0.7333076000213623
r_  generation:  6.859302282333374
local_output_nid generation:  0.12874364852905273
local_in_edges_tensor generation:  0.49273157119750977
mini_batch_src_global generation:  0.762678861618042
r_  generation:  7.14930272102356
local_output_nid generation:  0.13970732688903809
local_in_edges_tensor generation:  0.6176726818084717
mini_batch_src_global generation:  0.7586565017700195
r_  generation:  6.907664775848389
local_output_nid generation:  0.12826108932495117
local_in_edges_tensor generation:  0.46596336364746094
mini_batch_src_global generation:  0.7805140018463135
r_  generation:  7.229906320571899
local_output_nid generation:  0.1235506534576416
local_in_edges_tensor generation:  0.6069786548614502
mini_batch_src_global generation:  0.7626564502716064
r_  generation:  6.8818511962890625
local_output_nid generation:  0.1232292652130127
local_in_edges_tensor generation:  0.45742130279541016
mini_batch_src_global generation:  0.7967278957366943
r_  generation:  7.222013473510742
local_output_nid generation:  0.11576104164123535
local_in_edges_tensor generation:  0.5823428630828857
mini_batch_src_global generation:  0.811795711517334
r_  generation:  6.904767036437988
local_output_nid generation:  0.13040637969970703
local_in_edges_tensor generation:  0.44617700576782227
mini_batch_src_global generation:  0.7940573692321777
r_  generation:  7.239407539367676
local_output_nid generation:  0.1108396053314209
local_in_edges_tensor generation:  1.3801352977752686
mini_batch_src_global generation:  0.756636381149292
r_  generation:  7.007366418838501
local_output_nid generation:  0.1232459545135498
local_in_edges_tensor generation:  0.44265294075012207
mini_batch_src_global generation:  0.8053123950958252
r_  generation:  7.2157204151153564
local_output_nid generation:  0.11901044845581055
local_in_edges_tensor generation:  0.5731275081634521
mini_batch_src_global generation:  0.8351409435272217
r_  generation:  6.942959785461426
local_output_nid generation:  0.12631750106811523
local_in_edges_tensor generation:  0.4410414695739746
mini_batch_src_global generation:  0.7912051677703857
r_  generation:  7.2288477420806885
local_output_nid generation:  0.11075425148010254
local_in_edges_tensor generation:  0.593008279800415
mini_batch_src_global generation:  0.864574670791626
r_  generation:  7.009071588516235
local_output_nid generation:  0.13083815574645996
local_in_edges_tensor generation:  0.4432988166809082
mini_batch_src_global generation:  0.7929141521453857
r_  generation:  7.222097635269165
local_output_nid generation:  0.11073708534240723
local_in_edges_tensor generation:  0.5891757011413574
mini_batch_src_global generation:  0.8441166877746582
r_  generation:  7.023354768753052
local_output_nid generation:  0.1307666301727295
local_in_edges_tensor generation:  0.4455852508544922
mini_batch_src_global generation:  0.7906398773193359
r_  generation:  7.266526937484741
local_output_nid generation:  0.10997247695922852
local_in_edges_tensor generation:  0.5856952667236328
mini_batch_src_global generation:  0.8457322120666504
r_  generation:  6.95694637298584
local_output_nid generation:  0.1283431053161621
local_in_edges_tensor generation:  0.44211912155151367
mini_batch_src_global generation:  0.7857916355133057
r_  generation:  7.2597832679748535
local_output_nid generation:  0.10806989669799805
local_in_edges_tensor generation:  0.5928480625152588
mini_batch_src_global generation:  0.8535244464874268
r_  generation:  7.019077777862549
local_output_nid generation:  0.12933826446533203
local_in_edges_tensor generation:  0.4427154064178467
mini_batch_src_global generation:  0.7894046306610107
r_  generation:  7.2275614738464355
local_output_nid generation:  0.10839438438415527
local_in_edges_tensor generation:  0.5915558338165283
mini_batch_src_global generation:  0.8364970684051514
r_  generation:  7.056929111480713
local_output_nid generation:  0.13562846183776855
local_in_edges_tensor generation:  0.44420647621154785
mini_batch_src_global generation:  0.8148863315582275
r_  generation:  7.307727336883545
local_output_nid generation:  0.11314225196838379
local_in_edges_tensor generation:  0.5800840854644775
mini_batch_src_global generation:  0.817457914352417
r_  generation:  6.983304977416992
local_output_nid generation:  0.13588738441467285
local_in_edges_tensor generation:  0.4471158981323242
mini_batch_src_global generation:  0.8178272247314453
r_  generation:  7.381604909896851
local_output_nid generation:  0.1067044734954834
local_in_edges_tensor generation:  0.5805037021636963
mini_batch_src_global generation:  0.8141040802001953
r_  generation:  6.995316505432129
local_output_nid generation:  0.13496017456054688
local_in_edges_tensor generation:  0.4669456481933594
mini_batch_src_global generation:  0.813269853591919
r_  generation:  7.372504711151123
local_output_nid generation:  0.10729289054870605
local_in_edges_tensor generation:  0.5802621841430664
mini_batch_src_global generation:  0.8121201992034912
r_  generation:  7.024941682815552
local_output_nid generation:  0.13606643676757812
local_in_edges_tensor generation:  0.46089935302734375
mini_batch_src_global generation:  0.8032126426696777
r_  generation:  7.35146689414978
local_output_nid generation:  0.10785055160522461
local_in_edges_tensor generation:  0.5744857788085938
mini_batch_src_global generation:  0.8022713661193848
r_  generation:  6.914841651916504
----------------------check_connections_block total spend ----------------------------- 312.79837346076965
generate_one_block  10.44123363494873
generate_one_block  9.87920594215393
generate_one_block  9.584136009216309
generate_one_block  9.979469776153564
generate_one_block  9.579203367233276
generate_one_block  10.062745094299316
generate_one_block  9.51127314567566
generate_one_block  9.880316019058228
generate_one_block  9.506067752838135
generate_one_block  9.984963655471802
generate_one_block  9.483590602874756
generate_one_block  10.109549045562744
generate_one_block  9.77820897102356
generate_one_block  9.664740324020386
generate_one_block  9.935233116149902
generate_one_block  9.932712078094482
generate_one_block  9.927341938018799
generate_one_block  9.659321069717407
generate_one_block  10.071037769317627
generate_one_block  9.514751672744751
generate_one_block  10.071869611740112
generate_one_block  9.554309844970703
generate_one_block  10.151828527450562
generate_one_block  9.925737619400024
generate_one_block  9.8101966381073
generate_one_block  9.908479928970337
generate_one_block  9.863179922103882
generate_one_block  10.008756160736084
generate_one_block  10.142941236495972
generate_one_block  10.097430229187012
generate_one_block  9.520105600357056
generate_one_block  10.084925174713135
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.634749174118042
gen group dst list time:  1.8416790962219238
time for parepare:  0.48810887336730957
local_output_nid generation:  0.5810227394104004
local_in_edges_tensor generation:  2.196396589279175
mini_batch_src_global generation:  2.373317003250122
r_  generation:  26.47324228286743
local_output_nid generation:  0.6540398597717285
local_in_edges_tensor generation:  2.373854637145996
mini_batch_src_global generation:  3.2496683597564697
r_  generation:  24.66907572746277
local_output_nid generation:  1.0068724155426025
local_in_edges_tensor generation:  2.1827895641326904
mini_batch_src_global generation:  2.912804365158081
r_  generation:  23.423590898513794
local_output_nid generation:  0.8574790954589844
local_in_edges_tensor generation:  2.006796360015869
mini_batch_src_global generation:  2.8366119861602783
r_  generation:  23.25169849395752
local_output_nid generation:  0.6647078990936279
local_in_edges_tensor generation:  1.7947378158569336
mini_batch_src_global generation:  2.8162498474121094
r_  generation:  23.163830995559692
local_output_nid generation:  0.674241304397583
local_in_edges_tensor generation:  1.7745921611785889
mini_batch_src_global generation:  2.6823694705963135
r_  generation:  23.154665231704712
local_output_nid generation:  0.6741793155670166
local_in_edges_tensor generation:  1.760084629058838
mini_batch_src_global generation:  2.526477098464966
r_  generation:  23.312143325805664
local_output_nid generation:  0.7458372116088867
local_in_edges_tensor generation:  1.8041186332702637
mini_batch_src_global generation:  2.665034770965576
r_  generation:  23.08509349822998
local_output_nid generation:  0.7041549682617188
local_in_edges_tensor generation:  1.8308897018432617
mini_batch_src_global generation:  2.544889450073242
r_  generation:  23.155120372772217
local_output_nid generation:  0.7212064266204834
local_in_edges_tensor generation:  1.9278740882873535
mini_batch_src_global generation:  2.622288227081299
r_  generation:  23.270819425582886
local_output_nid generation:  0.7298836708068848
local_in_edges_tensor generation:  1.840108871459961
mini_batch_src_global generation:  2.5889008045196533
r_  generation:  23.37501549720764
local_output_nid generation:  0.7071118354797363
local_in_edges_tensor generation:  1.920628547668457
mini_batch_src_global generation:  2.6620736122131348
r_  generation:  23.396419286727905
local_output_nid generation:  0.7200567722320557
local_in_edges_tensor generation:  1.8398945331573486
mini_batch_src_global generation:  2.604984760284424
r_  generation:  23.19380497932434
local_output_nid generation:  0.677870512008667
local_in_edges_tensor generation:  1.8504071235656738
mini_batch_src_global generation:  2.7308082580566406
r_  generation:  23.32500123977661
local_output_nid generation:  0.6959624290466309
local_in_edges_tensor generation:  1.8476381301879883
mini_batch_src_global generation:  2.635768175125122
r_  generation:  23.13234806060791
local_output_nid generation:  0.6964414119720459
local_in_edges_tensor generation:  1.8831584453582764
mini_batch_src_global generation:  2.70684552192688
r_  generation:  23.351358652114868
local_output_nid generation:  0.7187387943267822
local_in_edges_tensor generation:  1.8136651515960693
mini_batch_src_global generation:  2.6245925426483154
r_  generation:  23.141486883163452
local_output_nid generation:  0.7067716121673584
local_in_edges_tensor generation:  1.88234281539917
mini_batch_src_global generation:  2.674405574798584
r_  generation:  23.338613510131836
local_output_nid generation:  0.7216191291809082
local_in_edges_tensor generation:  1.8236730098724365
mini_batch_src_global generation:  2.6263303756713867
r_  generation:  23.25450301170349
local_output_nid generation:  0.7059645652770996
local_in_edges_tensor generation:  1.9021458625793457
mini_batch_src_global generation:  2.682086706161499
r_  generation:  23.325083255767822
local_output_nid generation:  0.730562686920166
local_in_edges_tensor generation:  1.8260166645050049
mini_batch_src_global generation:  2.646315813064575
r_  generation:  23.403172731399536
local_output_nid generation:  0.7272868156433105
local_in_edges_tensor generation:  1.921133279800415
mini_batch_src_global generation:  2.6501665115356445
r_  generation:  23.471681356430054
local_output_nid generation:  0.6856861114501953
local_in_edges_tensor generation:  1.8334407806396484
mini_batch_src_global generation:  2.5805227756500244
r_  generation:  23.48107123374939
local_output_nid generation:  0.6895699501037598
local_in_edges_tensor generation:  1.958066463470459
mini_batch_src_global generation:  2.647071123123169
r_  generation:  23.557013988494873
local_output_nid generation:  0.7311184406280518
local_in_edges_tensor generation:  1.8072586059570312
mini_batch_src_global generation:  2.563080072402954
r_  generation:  23.285085439682007
local_output_nid generation:  0.7320387363433838
local_in_edges_tensor generation:  1.9143295288085938
mini_batch_src_global generation:  2.6518237590789795
r_  generation:  23.425859689712524
local_output_nid generation:  0.7372879981994629
local_in_edges_tensor generation:  1.7782254219055176
mini_batch_src_global generation:  2.572092056274414
r_  generation:  23.704964876174927
local_output_nid generation:  0.7356991767883301
local_in_edges_tensor generation:  1.8108198642730713
mini_batch_src_global generation:  2.6745572090148926
r_  generation:  23.528170824050903
local_output_nid generation:  0.6701035499572754
local_in_edges_tensor generation:  1.7590363025665283
mini_batch_src_global generation:  2.6031224727630615
r_  generation:  23.47122621536255
local_output_nid generation:  0.7090256214141846
local_in_edges_tensor generation:  1.7698678970336914
mini_batch_src_global generation:  2.6630451679229736
r_  generation:  23.16721820831299
local_output_nid generation:  0.6727216243743896
local_in_edges_tensor generation:  1.7815277576446533
mini_batch_src_global generation:  2.7249503135681152
r_  generation:  23.57668137550354
local_output_nid generation:  0.6649036407470703
local_in_edges_tensor generation:  1.7745413780212402
mini_batch_src_global generation:  2.6639695167541504
r_  generation:  23.11656665802002
----------------------check_connections_block total spend ----------------------------- 1057.1120417118073
generate_one_block  35.11416244506836
generate_one_block  34.14659285545349
generate_one_block  32.499929666519165
generate_one_block  32.78854560852051
generate_one_block  32.6427903175354
generate_one_block  32.63990330696106
generate_one_block  33.01668834686279
generate_one_block  35.953054904937744
generate_one_block  32.64936184883118
generate_one_block  32.75277018547058
generate_one_block  32.74420189857483
generate_one_block  32.71596074104309
generate_one_block  32.76197171211243
generate_one_block  32.68788743019104
generate_one_block  32.56207585334778
generate_one_block  32.647926330566406
generate_one_block  32.53634977340698
generate_one_block  32.78519129753113
generate_one_block  32.8041934967041
generate_one_block  32.75326919555664
generate_one_block  33.63298153877258
generate_one_block  33.101511001586914
generate_one_block  33.03737187385559
generate_one_block  33.15728163719177
generate_one_block  33.119117736816406
generate_one_block  33.086448192596436
generate_one_block  33.33896803855896
generate_one_block  33.19530415534973
generate_one_block  32.855358600616455
generate_one_block  32.946446657180786
generate_one_block  33.08629655838013
generate_one_block  32.82360577583313
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 2.5491437911987305  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

connection checking time:  1369.910415172577
block generation total time  1374.2083804607391
average batch blocks generation time:  42.9440118893981
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3939337730407715  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.110408306121826  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3983325958251953  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.124779224395752  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3981313705444336  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.118824005126953  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.402172565460205  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1316776275634766  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3942317962646484  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.112757682800293  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3970904350280762  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.116713523864746  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4000372886657715  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1266798973083496  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3987822532653809  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.120393753051758  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.396451473236084  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1215009689331055  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.395981788635254  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.121288776397705  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4002799987792969  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.126736640930176  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3987689018249512  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.12607479095459  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4003791809082031  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1254262924194336  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3952035903930664  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.110969066619873  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3945846557617188  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1132516860961914  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3962697982788086  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1196627616882324  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3952031135559082  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1131839752197266  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3971824645996094  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.120689868927002  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3991856575012207  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.122729778289795  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3938212394714355  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1116108894348145  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4005823135375977  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1332483291625977  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4006047248840332  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1287097930908203  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3986129760742188  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1203856468200684  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4013171195983887  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1313552856445312  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.398991584777832  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1247687339782715  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4002900123596191  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.124309539794922  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.401413917541504  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1326379776000977  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.4004640579223633  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.125969886779785  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3954648971557617  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes
Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.112335205078125  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3963232040405273  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1170058250427246  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.400134563446045  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1297988891601562  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 1.3930025100708008  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9149169921875 GB
    Memory Allocated: 3.1060056686401367  GigaBytes
Max Memory Allocated: 4.576299667358398  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3148627430200577 |0.6645644977688789 |0.004374071955680847 |0.0001550614833831787 |0.0046946704387664795 |0.002805948257446289 |
----------------------------------------------------------pseudo_mini_loss sum 2.3664801120758057
Total (block generation + training)time/epoch 2866.141686499119
Training time/epoch 1647926737.8081539
Training time without block to device /epoch 1647926716.54209
Training time without total dataloading part /epoch 0.29796767234802246
load block tensor time/epoch 10.075607776641846
block to device time/epoch 21.266063928604126
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  134438372
Number of first layer input nodes during this epoch:  71036345
