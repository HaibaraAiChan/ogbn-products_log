main start at this time 1647826434.7351885
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6307120323181152
random selection method range initialization spend 0.014432430267333984
time for parepare:  0.36335134506225586
local_output_nid generation:  0.0256350040435791
local_in_edges_tensor generation:  0.10014104843139648
mini_batch_src_global generation:  0.10809946060180664
r_  generation:  1.5770249366760254
local_output_nid generation:  0.026124238967895508
local_in_edges_tensor generation:  0.06936120986938477
mini_batch_src_global generation:  0.1323864459991455
r_  generation:  1.7263212203979492
local_output_nid generation:  0.025860071182250977
local_in_edges_tensor generation:  0.0737612247467041
mini_batch_src_global generation:  0.11881470680236816
r_  generation:  1.7163746356964111
local_output_nid generation:  0.02635025978088379
local_in_edges_tensor generation:  0.06403207778930664
mini_batch_src_global generation:  0.12092232704162598
r_  generation:  1.8744239807128906
----------------------check_connections_block total spend ----------------------------- 9.160646677017212
generate_one_block  7.313648223876953
generate_one_block  2.154599189758301
generate_one_block  2.179149627685547
generate_one_block  2.111544370651245
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.6140801906585693
gen group dst list time:  0.1226658821105957
time for parepare:  0.458693265914917
local_output_nid generation:  0.33419203758239746
local_in_edges_tensor generation:  1.360713005065918
mini_batch_src_global generation:  1.6408004760742188
r_  generation:  19.717224836349487
local_output_nid generation:  0.33929896354675293
local_in_edges_tensor generation:  1.2423980236053467
mini_batch_src_global generation:  2.1320302486419678
r_  generation:  20.233365774154663
local_output_nid generation:  0.38871073722839355
local_in_edges_tensor generation:  1.4732561111450195
mini_batch_src_global generation:  2.0622830390930176
r_  generation:  20.922975778579712
local_output_nid generation:  0.3808889389038086
local_in_edges_tensor generation:  2.532485008239746
mini_batch_src_global generation:  2.135711669921875
r_  generation:  20.929155111312866
----------------------check_connections_block total spend ----------------------------- 112.78035068511963
generate_one_block  28.529626607894897
generate_one_block  28.656359434127808
generate_one_block  28.79028081893921
generate_one_block  28.64569854736328
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1979570388793945
gen group dst list time:  0.316967248916626
time for parepare:  0.47496867179870605
local_output_nid generation:  0.6624681949615479
local_in_edges_tensor generation:  1.573207139968872
mini_batch_src_global generation:  1.260148525238037
r_  generation:  18.03201961517334
local_output_nid generation:  0.748748779296875
local_in_edges_tensor generation:  1.521806240081787
mini_batch_src_global generation:  1.6815495491027832
r_  generation:  17.880751848220825
local_output_nid generation:  0.7474133968353271
local_in_edges_tensor generation:  1.5548923015594482
mini_batch_src_global generation:  1.6359117031097412
r_  generation:  18.017523050308228
local_output_nid generation:  0.7535912990570068
local_in_edges_tensor generation:  1.3839497566223145
mini_batch_src_global generation:  1.725419282913208
r_  generation:  18.208927392959595
----------------------check_connections_block total spend ----------------------------- 101.34826397895813
generate_one_block  23.52415108680725
generate_one_block  23.58674931526184
generate_one_block  23.543349266052246
generate_one_block  24.3814640045166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  214.12861466407776
block generation total time  209.65767908096313
average batch blocks generation time:  52.414419770240784
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6590576171875 GB
    Memory Allocated: 1.5655603408813477  GigaBytes
Max Memory Allocated: 1.5655603408813477  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3582763671875 GB
    Memory Allocated: 4.279029846191406  GigaBytes
Max Memory Allocated: 4.638180732727051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.4403076171875 GB
    Memory Allocated: 1.5761313438415527  GigaBytes
Max Memory Allocated: 5.349597930908203  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.4422607421875 GB
    Memory Allocated: 4.2857818603515625  GigaBytes
Max Memory Allocated: 5.349597930908203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2938232421875 GB
    Memory Allocated: 1.5776152610778809  GigaBytes
Max Memory Allocated: 5.359123706817627  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2938232421875 GB
    Memory Allocated: 4.289304733276367  GigaBytes
Max Memory Allocated: 5.359123706817627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2938232421875 GB
    Memory Allocated: 1.574659824371338  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2938232421875 GB
    Memory Allocated: 4.281437873840332  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.35697412490844727 |1.02812659740448 |0.22647136449813843 |0.00018453598022460938 |0.06491148471832275 |0.0037279129028320312 |
----------------------------------------------------------pseudo_mini_loss sum 8.765806198120117
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21804569
Number of first layer input nodes during this epoch:  9102939
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 13.2938232421875 GB
    Memory Allocated: 3.044142723083496  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6809816360473633
random selection method range initialization spend 0.0182497501373291
time for parepare:  0.4281275272369385
local_output_nid generation:  0.025873184204101562
local_in_edges_tensor generation:  0.13021349906921387
mini_batch_src_global generation:  0.1082456111907959
r_  generation:  1.7014482021331787
local_output_nid generation:  0.03687906265258789
local_in_edges_tensor generation:  0.15021300315856934
mini_batch_src_global generation:  0.14877009391784668
r_  generation:  1.8087964057922363
local_output_nid generation:  0.039700984954833984
local_in_edges_tensor generation:  0.07998776435852051
mini_batch_src_global generation:  0.11006569862365723
r_  generation:  1.7769267559051514
local_output_nid generation:  0.02759075164794922
local_in_edges_tensor generation:  0.057614803314208984
mini_batch_src_global generation:  0.14006853103637695
r_  generation:  1.9478626251220703
----------------------check_connections_block total spend ----------------------------- 9.891653060913086
generate_one_block  2.5918707847595215
generate_one_block  2.2095749378204346
generate_one_block  2.182720184326172
generate_one_block  2.4655251502990723
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3544058799743652
gen group dst list time:  0.1217648983001709
time for parepare:  0.43662595748901367
local_output_nid generation:  0.35375142097473145
local_in_edges_tensor generation:  1.4140677452087402
mini_batch_src_global generation:  1.7036774158477783
r_  generation:  20.411680459976196
local_output_nid generation:  0.3669874668121338
local_in_edges_tensor generation:  1.456287145614624
mini_batch_src_global generation:  2.1753242015838623
r_  generation:  20.509870767593384
local_output_nid generation:  0.3711113929748535
local_in_edges_tensor generation:  1.6878137588500977
mini_batch_src_global generation:  2.238006114959717
r_  generation:  20.644471645355225
local_output_nid generation:  0.3693704605102539
local_in_edges_tensor generation:  1.4169771671295166
mini_batch_src_global generation:  2.192751884460449
r_  generation:  20.682562589645386
----------------------check_connections_block total spend ----------------------------- 113.6649158000946
generate_one_block  28.569703340530396
generate_one_block  29.213685274124146
generate_one_block  28.46415686607361
generate_one_block  28.24419331550598
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.099742889404297
gen group dst list time:  0.3434572219848633
time for parepare:  0.5023424625396729
local_output_nid generation:  0.7009828090667725
local_in_edges_tensor generation:  1.5232186317443848
mini_batch_src_global generation:  1.2840158939361572
r_  generation:  17.48417043685913
local_output_nid generation:  0.7281198501586914
local_in_edges_tensor generation:  1.4502432346343994
mini_batch_src_global generation:  1.8256921768188477
r_  generation:  17.64079761505127
local_output_nid generation:  0.7384061813354492
local_in_edges_tensor generation:  1.3757550716400146
mini_batch_src_global generation:  1.6494367122650146
r_  generation:  17.961796283721924
local_output_nid generation:  0.7278769016265869
local_in_edges_tensor generation:  1.37347412109375
mini_batch_src_global generation:  1.6458709239959717
r_  generation:  18.326886892318726
----------------------check_connections_block total spend ----------------------------- 100.10523128509521
generate_one_block  23.634458303451538
generate_one_block  23.41831612586975
generate_one_block  23.31190299987793
generate_one_block  23.29642415046692
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.2938232421875 GB
    Memory Allocated: 3.044142723083496  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

connection checking time:  213.77014708518982
block generation total time  208.15284037590027
average batch blocks generation time:  52.03821009397507
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2938232421875 GB
    Memory Allocated: 1.577692985534668  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.2900919914245605  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5758514404296875  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.286129951477051  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5760669708251953  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.283465385437012  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5742006301879883  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.275363922119141  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.44518083333969116 |0.9364683628082275 |0.004322648048400879 |0.0001563429832458496 |0.0060617923736572266 |0.0026433467864990234 |
----------------------------------------------------------pseudo_mini_loss sum 5.100767612457275
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21804075
Number of first layer input nodes during this epoch:  9104422
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 3.0398240089416504  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6719264984130859
random selection method range initialization spend 0.011579036712646484
time for parepare:  0.34108400344848633
local_output_nid generation:  0.025109052658081055
local_in_edges_tensor generation:  0.07682228088378906
mini_batch_src_global generation:  0.10540103912353516
r_  generation:  1.5573060512542725
local_output_nid generation:  0.025736331939697266
local_in_edges_tensor generation:  0.0527651309967041
mini_batch_src_global generation:  0.13069772720336914
r_  generation:  1.667663335800171
local_output_nid generation:  0.025900602340698242
local_in_edges_tensor generation:  0.04837203025817871
mini_batch_src_global generation:  0.1087040901184082
r_  generation:  1.7112555503845215
local_output_nid generation:  0.025736570358276367
local_in_edges_tensor generation:  0.03947877883911133
mini_batch_src_global generation:  0.11986589431762695
r_  generation:  1.802863597869873
----------------------check_connections_block total spend ----------------------------- 8.890050888061523
generate_one_block  2.509404420852661
generate_one_block  2.0997581481933594
generate_one_block  2.1070494651794434
generate_one_block  2.121875286102295
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.2234573364257812
gen group dst list time:  0.1196753978729248
time for parepare:  0.40148448944091797
local_output_nid generation:  0.3494136333465576
local_in_edges_tensor generation:  1.4632630348205566
mini_batch_src_global generation:  1.6548569202423096
r_  generation:  19.952409505844116
local_output_nid generation:  0.380932092666626
local_in_edges_tensor generation:  1.6721103191375732
mini_batch_src_global generation:  2.3230676651000977
r_  generation:  20.11992573738098
local_output_nid generation:  0.35672426223754883
local_in_edges_tensor generation:  1.4617905616760254
mini_batch_src_global generation:  2.3220572471618652
r_  generation:  23.395045042037964
local_output_nid generation:  0.37578535079956055
local_in_edges_tensor generation:  1.4343054294586182
mini_batch_src_global generation:  2.3624393939971924
r_  generation:  20.729753971099854
----------------------check_connections_block total spend ----------------------------- 115.75454473495483
generate_one_block  28.463507890701294
generate_one_block  29.096976280212402
generate_one_block  28.345963954925537
generate_one_block  28.469106197357178
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2835142612457275
gen group dst list time:  0.3255119323730469
time for parepare:  0.4693722724914551
local_output_nid generation:  0.6832766532897949
local_in_edges_tensor generation:  1.4595589637756348
mini_batch_src_global generation:  1.3016674518585205
r_  generation:  17.544538021087646
local_output_nid generation:  0.7311267852783203
local_in_edges_tensor generation:  1.5854060649871826
mini_batch_src_global generation:  1.8548576831817627
r_  generation:  17.548931121826172
local_output_nid generation:  0.7096023559570312
local_in_edges_tensor generation:  1.4950289726257324
mini_batch_src_global generation:  1.7176649570465088
r_  generation:  17.724839448928833
local_output_nid generation:  0.7058851718902588
local_in_edges_tensor generation:  1.3788375854492188
mini_batch_src_global generation:  1.8688335418701172
r_  generation:  18.131282091140747
----------------------check_connections_block total spend ----------------------------- 100.38298153877258
generate_one_block  23.503052711486816
generate_one_block  23.35497784614563
generate_one_block  23.38368320465088
generate_one_block  23.480117321014404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 3.0398240089416504  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

connection checking time:  216.13752627372742
block generation total time  208.09738540649414
average batch blocks generation time:  52.024346351623535
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5744976997375488  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.278172492980957  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5795783996582031  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.291180610656738  GigaBytes
Max Memory Allocated: 5.364398956298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5750770568847656  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.28361177444458  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5751352310180664  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.286216735839844  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41414666175842285 |0.6402603983879089 |0.01801753044128418 |0.0001456141471862793 |0.022884130477905273 |0.001444101333618164 |
----------------------------------------------------------pseudo_mini_loss sum 3.6885900497436523
Total (block generation + training)time/epoch 472.2080879211426
Training time/epoch 1647827902.9266632
Training time without block to device /epoch 1647827900.3656216
Training time without total dataloading part /epoch 0.1656332015991211
load block tensor time/epoch 1.6565866470336914
block to device time/epoch 2.5610415935516357
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  21806006
Number of first layer input nodes during this epoch:  9103362
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 3.04496431350708  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5415263175964355
random selection method range initialization spend 0.012528419494628906
time for parepare:  0.360867977142334
local_output_nid generation:  0.028532028198242188
local_in_edges_tensor generation:  0.06952738761901855
mini_batch_src_global generation:  0.11098766326904297
r_  generation:  1.6693048477172852
local_output_nid generation:  0.031236648559570312
local_in_edges_tensor generation:  0.09380841255187988
mini_batch_src_global generation:  0.14309430122375488
r_  generation:  1.78782057762146
local_output_nid generation:  0.03158116340637207
local_in_edges_tensor generation:  0.041957855224609375
mini_batch_src_global generation:  0.1110389232635498
r_  generation:  1.7223834991455078
local_output_nid generation:  0.026775121688842773
local_in_edges_tensor generation:  0.036350250244140625
mini_batch_src_global generation:  0.1283855438232422
r_  generation:  1.8534824848175049
----------------------check_connections_block total spend ----------------------------- 9.352400541305542
generate_one_block  2.63511061668396
generate_one_block  2.530111074447632
generate_one_block  2.1331512928009033
generate_one_block  2.1376688480377197
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5585405826568604
gen group dst list time:  0.12565326690673828
time for parepare:  0.488447904586792
local_output_nid generation:  0.35999298095703125
local_in_edges_tensor generation:  1.4295320510864258
mini_batch_src_global generation:  1.6712844371795654
r_  generation:  20.339945316314697
local_output_nid generation:  0.38199496269226074
local_in_edges_tensor generation:  1.6750826835632324
mini_batch_src_global generation:  2.343266010284424
r_  generation:  20.14801526069641
local_output_nid generation:  0.3640892505645752
local_in_edges_tensor generation:  1.4711697101593018
mini_batch_src_global generation:  2.3129749298095703
r_  generation:  20.941193103790283
local_output_nid generation:  0.3767383098602295
local_in_edges_tensor generation:  1.4342432022094727
mini_batch_src_global generation:  2.3368165493011475
r_  generation:  20.451845169067383
----------------------check_connections_block total spend ----------------------------- 113.4675567150116
generate_one_block  28.735592126846313
generate_one_block  28.992905378341675
generate_one_block  28.506845474243164
generate_one_block  28.435802459716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.241741895675659
gen group dst list time:  0.32541990280151367
time for parepare:  0.46259045600891113
local_output_nid generation:  0.6790480613708496
local_in_edges_tensor generation:  1.539444923400879
mini_batch_src_global generation:  1.305192470550537
r_  generation:  17.598484754562378
local_output_nid generation:  0.7273461818695068
local_in_edges_tensor generation:  1.4246463775634766
mini_batch_src_global generation:  1.8079273700714111
r_  generation:  17.439786911010742
local_output_nid generation:  0.7263326644897461
local_in_edges_tensor generation:  1.5506727695465088
mini_batch_src_global generation:  1.8614275455474854
r_  generation:  17.672390699386597
local_output_nid generation:  0.7155334949493408
local_in_edges_tensor generation:  1.3583827018737793
mini_batch_src_global generation:  2.0384788513183594
r_  generation:  18.139030933380127
----------------------check_connections_block total spend ----------------------------- 100.42905616760254
generate_one_block  23.40058422088623
generate_one_block  23.42623019218445
generate_one_block  23.189406871795654
generate_one_block  23.359007835388184
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 3.04496431350708  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

connection checking time:  213.89661288261414
block generation total time  208.04637455940247
average batch blocks generation time:  52.01159363985062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5778017044067383  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.288637161254883  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5746469497680664  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.279343605041504  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5776591300964355  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.286666393280029  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5754623413085938  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.283265590667725  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.443928599357605 |0.7861921191215515 |0.004149496555328369 |0.00016063451766967773 |0.006096959114074707 |0.002727508544921875 |
----------------------------------------------------------pseudo_mini_loss sum 3.1104512214660645
Total (block generation + training)time/epoch 472.0538934469223
Training time/epoch 1647828374.8266928
Training time without block to device /epoch 1647828371.6819243
Training time without total dataloading part /epoch 0.04435586929321289
load block tensor time/epoch 1.77571439743042
block to device time/epoch 3.144768476486206
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  21806223
Number of first layer input nodes during this epoch:  9103808
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 3.0447354316711426  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6465518474578857
random selection method range initialization spend 0.012944221496582031
time for parepare:  0.3530247211456299
local_output_nid generation:  0.027802228927612305
local_in_edges_tensor generation:  0.07280874252319336
mini_batch_src_global generation:  0.10907149314880371
r_  generation:  1.5912153720855713
local_output_nid generation:  0.02968311309814453
local_in_edges_tensor generation:  0.09382176399230957
mini_batch_src_global generation:  0.1464223861694336
r_  generation:  1.811387538909912
local_output_nid generation:  0.030766963958740234
local_in_edges_tensor generation:  0.052870988845825195
mini_batch_src_global generation:  0.11098003387451172
r_  generation:  1.7303040027618408
local_output_nid generation:  0.026352882385253906
local_in_edges_tensor generation:  0.03739809989929199
mini_batch_src_global generation:  0.12232470512390137
r_  generation:  1.828580617904663
----------------------check_connections_block total spend ----------------------------- 9.280605554580688
generate_one_block  2.609851837158203
generate_one_block  2.569277048110962
generate_one_block  2.1218767166137695
generate_one_block  2.143541097640991
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3782384395599365
gen group dst list time:  0.1247868537902832
time for parepare:  0.4812886714935303
local_output_nid generation:  0.35280299186706543
local_in_edges_tensor generation:  1.6906206607818604
mini_batch_src_global generation:  1.659766674041748
r_  generation:  20.079233169555664
local_output_nid generation:  0.38046956062316895
local_in_edges_tensor generation:  1.4326410293579102
mini_batch_src_global generation:  2.3601973056793213
r_  generation:  20.188669681549072
local_output_nid generation:  0.38184022903442383
local_in_edges_tensor generation:  1.4914021492004395
mini_batch_src_global generation:  2.308483123779297
r_  generation:  20.392539739608765
local_output_nid generation:  0.3803853988647461
local_in_edges_tensor generation:  1.4212369918823242
mini_batch_src_global generation:  2.29683780670166
r_  generation:  20.439878940582275
----------------------check_connections_block total spend ----------------------------- 112.55308151245117
generate_one_block  28.43017601966858
generate_one_block  29.16411781311035
generate_one_block  28.529502391815186
generate_one_block  28.4315185546875
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.166733741760254
gen group dst list time:  0.3289957046508789
time for parepare:  0.44965696334838867
local_output_nid generation:  0.6766889095306396
local_in_edges_tensor generation:  1.4714951515197754
mini_batch_src_global generation:  1.2776341438293457
r_  generation:  17.553123950958252
local_output_nid generation:  0.7295188903808594
local_in_edges_tensor generation:  1.5060124397277832
mini_batch_src_global generation:  1.796541452407837
r_  generation:  17.30794405937195
local_output_nid generation:  0.7230727672576904
local_in_edges_tensor generation:  1.3895108699798584
mini_batch_src_global generation:  1.8103480339050293
r_  generation:  17.708411693572998
local_output_nid generation:  0.7228269577026367
local_in_edges_tensor generation:  1.3654825687408447
mini_batch_src_global generation:  1.8207597732543945
r_  generation:  17.716715812683105
----------------------check_connections_block total spend ----------------------------- 99.35240983963013
generate_one_block  23.317981719970703
generate_one_block  23.39810299873352
generate_one_block  23.090611219406128
generate_one_block  23.10976791381836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 3.0447354316711426  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

connection checking time:  211.9054913520813
block generation total time  207.47177863121033
average batch blocks generation time:  51.86794465780258
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5743803977966309  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.279885768890381  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5784378051757812  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.289220809936523  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5778241157531738  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.287360668182373  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5744662284851074  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes
Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.2813897132873535  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4480268359184265 |0.620737612247467 |0.00398629903793335 |0.00015431642532348633 |0.005957841873168945 |0.0012409687042236328 |
----------------------------------------------------------pseudo_mini_loss sum 2.680283308029175
Total (block generation + training)time/epoch 470.9563881556193
Training time/epoch 1647828843.5883627
Training time without block to device /epoch 1647828841.1054122
Training time without total dataloading part /epoch 0.04163479804992676
load block tensor time/epoch 1.792107343673706
block to device time/epoch 2.482950448989868
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  21806606
Number of first layer input nodes during this epoch:  9104201
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 3.0416259765625  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5249497890472412
random selection method range initialization spend 0.014632463455200195
time for parepare:  0.3539297580718994
local_output_nid generation:  0.02694392204284668
local_in_edges_tensor generation:  0.09607386589050293
mini_batch_src_global generation:  0.11068058013916016
r_  generation:  1.6698479652404785
local_output_nid generation:  0.03157401084899902
local_in_edges_tensor generation:  0.09737491607666016
mini_batch_src_global generation:  0.13798213005065918
r_  generation:  1.7971456050872803
local_output_nid generation:  0.028952598571777344
local_in_edges_tensor generation:  0.05254673957824707
mini_batch_src_global generation:  0.11047792434692383
r_  generation:  1.7302236557006836
local_output_nid generation:  0.02794623374938965
local_in_edges_tensor generation:  0.04749441146850586
mini_batch_src_global generation:  0.12489104270935059
r_  generation:  1.8536450862884521
----------------------check_connections_block total spend ----------------------------- 9.408913850784302
generate_one_block  2.658592939376831
generate_one_block  2.549363374710083
generate_one_block  2.138465166091919
generate_one_block  2.1511049270629883
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.591697931289673
gen group dst list time:  0.1263887882232666
time for parepare:  0.44855761528015137
local_output_nid generation:  0.3449108600616455
local_in_edges_tensor generation:  1.4567041397094727
mini_batch_src_global generation:  1.669605016708374
r_  generation:  20.3658709526062
local_output_nid generation:  0.3810153007507324
local_in_edges_tensor generation:  1.6160573959350586
mini_batch_src_global generation:  2.3410604000091553
r_  generation:  20.109111070632935
local_output_nid generation:  0.377932071685791
local_in_edges_tensor generation:  1.4673714637756348
mini_batch_src_global generation:  2.3367059230804443
r_  generation:  20.422788619995117
local_output_nid generation:  0.3717200756072998
local_in_edges_tensor generation:  1.4230117797851562
mini_batch_src_global generation:  2.2713100910186768
r_  generation:  20.40509533882141
----------------------check_connections_block total spend ----------------------------- 112.78983283042908
generate_one_block  28.584298372268677
generate_one_block  29.23050355911255
generate_one_block  28.508296728134155
generate_one_block  28.415632963180542
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2796177864074707
gen group dst list time:  0.3273918628692627
time for parepare:  0.46285176277160645
local_output_nid generation:  0.6767513751983643
local_in_edges_tensor generation:  1.6047494411468506
mini_batch_src_global generation:  1.44217848777771
r_  generation:  17.498146772384644
local_output_nid generation:  0.7385702133178711
local_in_edges_tensor generation:  1.5292444229125977
mini_batch_src_global generation:  1.7210237979888916
r_  generation:  17.55836534500122
local_output_nid generation:  0.7293088436126709
local_in_edges_tensor generation:  1.5574190616607666
mini_batch_src_global generation:  1.698866367340088
r_  generation:  18.65962243080139
local_output_nid generation:  0.7304942607879639
local_in_edges_tensor generation:  1.377497673034668
mini_batch_src_global generation:  1.7327849864959717
r_  generation:  17.844866514205933
----------------------check_connections_block total spend ----------------------------- 100.74846029281616
generate_one_block  23.21209454536438
generate_one_block  23.267213344573975
generate_one_block  23.377041339874268
generate_one_block  23.61007571220398
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 3.0416259765625  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

connection checking time:  213.53829312324524
block generation total time  208.20515656471252
average batch blocks generation time:  52.05128914117813
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5752019882202148  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.282377243041992  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5781126022338867  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.289177894592285  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5754365921020508  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.284215927124023  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 1.5744786262512207  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2957763671875 GB
    Memory Allocated: 4.279094219207764  GigaBytes
Max Memory Allocated: 5.367231845855713  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4204990267753601 |0.7328797578811646 |0.01948416233062744 |0.00015914440155029297 |0.022817492485046387 |0.0027837753295898438 |
----------------------------------------------------------pseudo_mini_loss sum 2.3842389583587646
Total (block generation + training)time/epoch 471.19322299957275
Training time/epoch 1647829315.492369
Training time without block to device /epoch 1647829312.56085
Training time without total dataloading part /epoch 0.17262697219848633
load block tensor time/epoch 1.6819961071014404
block to device time/epoch 2.931519031524658
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  21806429
Number of first layer input nodes during this epoch:  9104017
