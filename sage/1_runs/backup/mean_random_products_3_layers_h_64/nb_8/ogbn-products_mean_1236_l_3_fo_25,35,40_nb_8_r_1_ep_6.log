main start at this time 1647755005.569802
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.1756591796875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.38170361518859863
random selection method range initialization spend 0.014939546585083008
time for parepare:  0.278228759765625
local_output_nid generation:  0.012208223342895508
local_in_edges_tensor generation:  0.032976627349853516
mini_batch_src_global generation:  0.027074337005615234
r_  generation:  0.40999770164489746
local_output_nid generation:  0.013665199279785156
local_in_edges_tensor generation:  0.022240877151489258
mini_batch_src_global generation:  0.036742210388183594
r_  generation:  0.4668862819671631
local_output_nid generation:  0.013551712036132812
local_in_edges_tensor generation:  0.011977434158325195
mini_batch_src_global generation:  0.02619338035583496
r_  generation:  0.47786855697631836
local_output_nid generation:  0.01379084587097168
local_in_edges_tensor generation:  0.012100934982299805
mini_batch_src_global generation:  0.030147552490234375
r_  generation:  0.5289285182952881
local_output_nid generation:  0.013746976852416992
local_in_edges_tensor generation:  0.012230157852172852
mini_batch_src_global generation:  0.03262066841125488
r_  generation:  0.5524182319641113
local_output_nid generation:  0.013641357421875
local_in_edges_tensor generation:  0.01223611831665039
mini_batch_src_global generation:  0.036832332611083984
r_  generation:  0.572415828704834
local_output_nid generation:  0.013561248779296875
local_in_edges_tensor generation:  0.012529850006103516
mini_batch_src_global generation:  0.03784894943237305
r_  generation:  0.5828850269317627
local_output_nid generation:  0.01358795166015625
local_in_edges_tensor generation:  0.012300252914428711
mini_batch_src_global generation:  0.03886604309082031
r_  generation:  0.5758490562438965
----------------------check_connections_block total spend ----------------------------- 5.694936752319336
generate_one_block  5.68665885925293
generate_one_block  0.5937466621398926
generate_one_block  0.5934374332427979
generate_one_block  0.592972993850708
generate_one_block  0.5964226722717285
generate_one_block  0.5908286571502686
generate_one_block  0.5904207229614258
generate_one_block  0.5957374572753906
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.154087543487549
gen group dst list time:  0.12186884880065918
time for parepare:  0.4362483024597168
local_output_nid generation:  0.16289114952087402
local_in_edges_tensor generation:  0.5760276317596436
mini_batch_src_global generation:  0.5295677185058594
r_  generation:  7.09393048286438
local_output_nid generation:  0.18270540237426758
local_in_edges_tensor generation:  0.4452803134918213
mini_batch_src_global generation:  0.6706869602203369
r_  generation:  7.4912402629852295
local_output_nid generation:  0.17453408241271973
local_in_edges_tensor generation:  0.452406644821167
mini_batch_src_global generation:  0.6592800617218018
r_  generation:  9.956022500991821
local_output_nid generation:  0.180495023727417
local_in_edges_tensor generation:  0.6158838272094727
mini_batch_src_global generation:  0.7871768474578857
r_  generation:  8.20071530342102
local_output_nid generation:  0.20484542846679688
local_in_edges_tensor generation:  0.7742455005645752
mini_batch_src_global generation:  0.7935647964477539
r_  generation:  8.203968524932861
local_output_nid generation:  0.20395207405090332
local_in_edges_tensor generation:  0.5770959854125977
mini_batch_src_global generation:  0.7948670387268066
r_  generation:  7.93300461769104
local_output_nid generation:  0.20668292045593262
local_in_edges_tensor generation:  0.565565824508667
mini_batch_src_global generation:  0.7153348922729492
r_  generation:  7.875523090362549
local_output_nid generation:  0.18181419372558594
local_in_edges_tensor generation:  0.45054078102111816
mini_batch_src_global generation:  0.7303690910339355
r_  generation:  7.815485715866089
----------------------check_connections_block total spend ----------------------------- 86.74666905403137
generate_one_block  10.423041582107544
generate_one_block  10.118569135665894
generate_one_block  10.491516590118408
generate_one_block  9.906493902206421
generate_one_block  10.082372903823853
generate_one_block  9.80264925956726
generate_one_block  9.621171951293945
generate_one_block  10.04017424583435
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.062159776687622
gen group dst list time:  0.5017101764678955
time for parepare:  0.4735579490661621
local_output_nid generation:  0.5688931941986084
local_in_edges_tensor generation:  1.2415876388549805
mini_batch_src_global generation:  1.1078763008117676
r_  generation:  15.793729305267334
local_output_nid generation:  0.5796835422515869
local_in_edges_tensor generation:  1.1430761814117432
mini_batch_src_global generation:  1.4241855144500732
r_  generation:  16.066056728363037
local_output_nid generation:  0.6344797611236572
local_in_edges_tensor generation:  1.1130552291870117
mini_batch_src_global generation:  1.5797321796417236
r_  generation:  16.53631591796875
local_output_nid generation:  0.6328263282775879
local_in_edges_tensor generation:  1.2415401935577393
mini_batch_src_global generation:  1.4668409824371338
r_  generation:  16.42532467842102
local_output_nid generation:  0.601771354675293
local_in_edges_tensor generation:  1.2528011798858643
mini_batch_src_global generation:  1.5126097202301025
r_  generation:  16.317225217819214
local_output_nid generation:  0.6250758171081543
local_in_edges_tensor generation:  1.2354748249053955
mini_batch_src_global generation:  1.532623291015625
r_  generation:  16.21252202987671
local_output_nid generation:  0.6348774433135986
local_in_edges_tensor generation:  1.1173889636993408
mini_batch_src_global generation:  1.5302436351776123
r_  generation:  16.446518659591675
local_output_nid generation:  0.6410884857177734
local_in_edges_tensor generation:  1.227259874343872
mini_batch_src_global generation:  1.4565131664276123
r_  generation:  16.437056064605713
----------------------check_connections_block total spend ----------------------------- 179.59206557273865
generate_one_block  21.372931003570557
generate_one_block  21.905993700027466
generate_one_block  20.72000503540039
generate_one_block  21.133262872695923
generate_one_block  21.182838916778564
generate_one_block  21.24868679046631
generate_one_block  21.209919691085815
generate_one_block  21.323667287826538
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.1756591796875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  266.33873462677
block generation total time  250.58329486846924
average batch blocks generation time:  31.322911858558655
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4803466796875 GB
    Memory Allocated: 1.2219123840332031  GigaBytes
Max Memory Allocated: 1.2219123840332031  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2030029296875 GB
    Memory Allocated: 3.022480010986328  GigaBytes
Max Memory Allocated: 3.287212371826172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0057373046875 GB
    Memory Allocated: 1.2243390083312988  GigaBytes
Max Memory Allocated: 3.678516387939453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0057373046875 GB
    Memory Allocated: 3.015749931335449  GigaBytes
Max Memory Allocated: 3.678516387939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0057373046875 GB
    Memory Allocated: 1.226794719696045  GigaBytes
Max Memory Allocated: 3.678516387939453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0057373046875 GB
    Memory Allocated: 3.0223426818847656  GigaBytes
Max Memory Allocated: 3.678516387939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8221435546875 GB
    Memory Allocated: 1.2282462120056152  GigaBytes
Max Memory Allocated: 3.678516387939453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 3.0269274711608887  GigaBytes
Max Memory Allocated: 3.678516387939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.229292392730713  GigaBytes
Max Memory Allocated: 3.6835975646972656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0300135612487793  GigaBytes
Max Memory Allocated: 3.6835975646972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2269105911254883  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0244956016540527  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2260746955871582  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.020045757293701  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.226402759552002  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0221967697143555  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.34000372886657715 |0.5696306824684143 |0.10081639885902405 |0.00017395615577697754 |0.029277145862579346 |0.0015375614166259766 |
----------------------------------------------------------pseudo_mini_loss sum 8.823344230651855
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  35917007
Number of first layer input nodes during this epoch:  17480052
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 2.0684561729431152  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4541492462158203
random selection method range initialization spend 0.013018131256103516
time for parepare:  0.28218603134155273
local_output_nid generation:  0.012319326400756836
local_in_edges_tensor generation:  0.0818629264831543
mini_batch_src_global generation:  0.03027176856994629
r_  generation:  0.41042256355285645
local_output_nid generation:  0.013918876647949219
local_in_edges_tensor generation:  0.022020816802978516
mini_batch_src_global generation:  0.04145503044128418
r_  generation:  0.4875171184539795
local_output_nid generation:  0.013790369033813477
local_in_edges_tensor generation:  0.011733293533325195
mini_batch_src_global generation:  0.0305941104888916
r_  generation:  0.4944431781768799
local_output_nid generation:  0.013849973678588867
local_in_edges_tensor generation:  0.011660575866699219
mini_batch_src_global generation:  0.03246331214904785
r_  generation:  0.5369405746459961
local_output_nid generation:  0.013597726821899414
local_in_edges_tensor generation:  0.011646509170532227
mini_batch_src_global generation:  0.03755831718444824
r_  generation:  0.5654869079589844
local_output_nid generation:  0.013717174530029297
local_in_edges_tensor generation:  0.011643648147583008
mini_batch_src_global generation:  0.04136538505554199
r_  generation:  0.5892527103424072
local_output_nid generation:  0.01781439781188965
local_in_edges_tensor generation:  0.014873027801513672
mini_batch_src_global generation:  0.04390239715576172
r_  generation:  0.6131935119628906
local_output_nid generation:  0.013713598251342773
local_in_edges_tensor generation:  0.013010263442993164
mini_batch_src_global generation:  0.041713714599609375
r_  generation:  0.6022298336029053
----------------------check_connections_block total spend ----------------------------- 5.945919036865234
generate_one_block  1.0215730667114258
generate_one_block  0.8685183525085449
generate_one_block  0.7885797023773193
generate_one_block  0.6116776466369629
generate_one_block  0.6238458156585693
generate_one_block  0.625166654586792
generate_one_block  0.6081085205078125
generate_one_block  0.6230223178863525
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0676627159118652
gen group dst list time:  0.1299288272857666
time for parepare:  0.47156333923339844
local_output_nid generation:  0.1675891876220703
local_in_edges_tensor generation:  0.6268832683563232
mini_batch_src_global generation:  0.5437278747558594
r_  generation:  7.3028552532196045
local_output_nid generation:  0.2018885612487793
local_in_edges_tensor generation:  0.44344305992126465
mini_batch_src_global generation:  0.6732773780822754
r_  generation:  7.430262804031372
local_output_nid generation:  0.17323732376098633
local_in_edges_tensor generation:  0.6738100051879883
mini_batch_src_global generation:  0.7473747730255127
r_  generation:  7.610126495361328
local_output_nid generation:  0.20113015174865723
local_in_edges_tensor generation:  0.44701457023620605
mini_batch_src_global generation:  0.6858136653900146
r_  generation:  7.607367753982544
local_output_nid generation:  0.17315316200256348
local_in_edges_tensor generation:  0.5558359622955322
mini_batch_src_global generation:  0.716998815536499
r_  generation:  7.815331935882568
local_output_nid generation:  0.19971156120300293
local_in_edges_tensor generation:  0.4525730609893799
mini_batch_src_global generation:  0.716874361038208
r_  generation:  7.734646797180176
local_output_nid generation:  0.17194366455078125
local_in_edges_tensor generation:  0.5605065822601318
mini_batch_src_global generation:  0.7645218372344971
r_  generation:  7.847321033477783
local_output_nid generation:  0.19839191436767578
local_in_edges_tensor generation:  0.4438004493713379
mini_batch_src_global generation:  0.7143018245697021
r_  generation:  7.666154623031616
----------------------check_connections_block total spend ----------------------------- 82.66312289237976
generate_one_block  10.268529176712036
generate_one_block  10.142083406448364
generate_one_block  9.777812957763672
generate_one_block  10.137737274169922
generate_one_block  9.909640550613403
generate_one_block  10.081498384475708
generate_one_block  9.719645500183105
generate_one_block  10.082791328430176
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.213726758956909
gen group dst list time:  0.5210402011871338
time for parepare:  0.5176253318786621
local_output_nid generation:  0.6046221256256104
local_in_edges_tensor generation:  1.2764945030212402
mini_batch_src_global generation:  1.1235027313232422
r_  generation:  16.074130058288574
local_output_nid generation:  0.6365203857421875
local_in_edges_tensor generation:  1.2787940502166748
mini_batch_src_global generation:  1.6294605731964111
r_  generation:  16.716158866882324
local_output_nid generation:  0.6367011070251465
local_in_edges_tensor generation:  1.362156867980957
mini_batch_src_global generation:  1.600165605545044
r_  generation:  16.317977905273438
local_output_nid generation:  0.6276109218597412
local_in_edges_tensor generation:  1.2291128635406494
mini_batch_src_global generation:  1.4697191715240479
r_  generation:  16.449095964431763
local_output_nid generation:  0.6188712120056152
local_in_edges_tensor generation:  1.26043701171875
mini_batch_src_global generation:  1.4942758083343506
r_  generation:  16.362436056137085
local_output_nid generation:  0.5979773998260498
local_in_edges_tensor generation:  1.253568410873413
mini_batch_src_global generation:  1.5580463409423828
r_  generation:  16.473299980163574
local_output_nid generation:  0.6420116424560547
local_in_edges_tensor generation:  1.1619541645050049
mini_batch_src_global generation:  1.6206841468811035
r_  generation:  16.781496047973633
local_output_nid generation:  0.627598762512207
local_in_edges_tensor generation:  1.2292289733886719
mini_batch_src_global generation:  1.528611660003662
r_  generation:  16.61937379837036
----------------------check_connections_block total spend ----------------------------- 182.59358286857605
generate_one_block  21.763089895248413
generate_one_block  21.722973585128784
generate_one_block  21.915934801101685
generate_one_block  22.268709897994995
generate_one_block  21.645373582839966
generate_one_block  21.635680675506592
generate_one_block  21.652151823043823
generate_one_block  21.352309226989746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 2.0684561729431152  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

connection checking time:  265.2567057609558
block generation total time  254.0759620666504
average batch blocks generation time:  31.7594952583313
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.227407455444336  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0252761840820312  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2259488105773926  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0254297256469727  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.22698974609375  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0256519317626953  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2295031547546387  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0309925079345703  GigaBytes
Max Memory Allocated: 3.6863937377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.226670742034912  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.021958351135254  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2278504371643066  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0250039100646973  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2251415252685547  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.018655776977539  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.225389003753662  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0162320137023926  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36225181818008423 |0.4127112925052643 |0.007337749004364014 |0.00014731287956237793 |0.0041196346282958984 |0.0011892318725585938 |
----------------------------------------------------------pseudo_mini_loss sum 5.131719589233398
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  35923089
Number of first layer input nodes during this epoch:  17478534
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 2.064964771270752  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3211081027984619
random selection method range initialization spend 0.011010408401489258
time for parepare:  0.2778620719909668
local_output_nid generation:  0.01241755485534668
local_in_edges_tensor generation:  0.031154155731201172
mini_batch_src_global generation:  0.030614137649536133
r_  generation:  0.40968942642211914
local_output_nid generation:  0.013720035552978516
local_in_edges_tensor generation:  0.01571965217590332
mini_batch_src_global generation:  0.04024529457092285
r_  generation:  0.4677596092224121
local_output_nid generation:  0.01369929313659668
local_in_edges_tensor generation:  0.01430201530456543
mini_batch_src_global generation:  0.026430130004882812
r_  generation:  0.48424243927001953
local_output_nid generation:  0.013699769973754883
local_in_edges_tensor generation:  0.022853612899780273
mini_batch_src_global generation:  0.030220508575439453
r_  generation:  0.5260875225067139
local_output_nid generation:  0.013798236846923828
local_in_edges_tensor generation:  0.014766693115234375
mini_batch_src_global generation:  0.03383827209472656
r_  generation:  0.5525796413421631
local_output_nid generation:  0.013808012008666992
local_in_edges_tensor generation:  0.012409448623657227
mini_batch_src_global generation:  0.037096261978149414
r_  generation:  0.5733575820922852
local_output_nid generation:  0.013714790344238281
local_in_edges_tensor generation:  0.0139007568359375
mini_batch_src_global generation:  0.041303157806396484
r_  generation:  0.5831258296966553
local_output_nid generation:  0.013716459274291992
local_in_edges_tensor generation:  0.011649131774902344
mini_batch_src_global generation:  0.03946542739868164
r_  generation:  0.5847041606903076
----------------------check_connections_block total spend ----------------------------- 5.7474119663238525
generate_one_block  0.9645504951477051
generate_one_block  0.6095840930938721
generate_one_block  0.5972878932952881
generate_one_block  0.5911448001861572
generate_one_block  0.5946817398071289
generate_one_block  0.61110520362854
generate_one_block  0.5956652164459229
generate_one_block  0.5926988124847412
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9226799011230469
gen group dst list time:  0.12010908126831055
time for parepare:  0.4217350482940674
local_output_nid generation:  0.1715247631072998
local_in_edges_tensor generation:  0.5455965995788574
mini_batch_src_global generation:  0.5400650501251221
r_  generation:  7.044256925582886
local_output_nid generation:  0.1723489761352539
local_in_edges_tensor generation:  0.4501309394836426
mini_batch_src_global generation:  0.6840627193450928
r_  generation:  7.4461610317230225
local_output_nid generation:  0.1771409511566162
local_in_edges_tensor generation:  0.5797929763793945
mini_batch_src_global generation:  0.7382378578186035
r_  generation:  7.488698959350586
local_output_nid generation:  0.1727292537689209
local_in_edges_tensor generation:  0.4596216678619385
mini_batch_src_global generation:  0.7165348529815674
r_  generation:  7.675746202468872
local_output_nid generation:  0.18419885635375977
local_in_edges_tensor generation:  0.5755901336669922
mini_batch_src_global generation:  0.7118234634399414
r_  generation:  7.637031316757202
local_output_nid generation:  0.19612407684326172
local_in_edges_tensor generation:  0.45310091972351074
mini_batch_src_global generation:  0.724761962890625
r_  generation:  7.85567307472229
local_output_nid generation:  0.17820262908935547
local_in_edges_tensor generation:  0.5152902603149414
mini_batch_src_global generation:  0.7984530925750732
r_  generation:  7.83830189704895
local_output_nid generation:  0.19923639297485352
local_in_edges_tensor generation:  0.5102143287658691
mini_batch_src_global generation:  0.7248549461364746
r_  generation:  7.7622785568237305
----------------------check_connections_block total spend ----------------------------- 82.40419435501099
generate_one_block  10.27264666557312
generate_one_block  10.052717208862305
generate_one_block  9.818053007125854
generate_one_block  10.125524282455444
generate_one_block  10.034398555755615
generate_one_block  9.87170696258545
generate_one_block  10.024475336074829
generate_one_block  9.910655975341797
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.0940327644348145
gen group dst list time:  0.49889206886291504
time for parepare:  0.4507019519805908
local_output_nid generation:  0.5757460594177246
local_in_edges_tensor generation:  1.248518943786621
mini_batch_src_global generation:  1.1208980083465576
r_  generation:  15.750978946685791
local_output_nid generation:  0.5925440788269043
local_in_edges_tensor generation:  1.3366296291351318
mini_batch_src_global generation:  1.533893346786499
r_  generation:  16.12281608581543
local_output_nid generation:  0.6418890953063965
local_in_edges_tensor generation:  1.1390602588653564
mini_batch_src_global generation:  1.615800380706787
r_  generation:  16.393282651901245
local_output_nid generation:  0.6374185085296631
local_in_edges_tensor generation:  1.2661442756652832
mini_batch_src_global generation:  1.5270895957946777
r_  generation:  16.54646348953247
local_output_nid generation:  0.6267068386077881
local_in_edges_tensor generation:  1.2515623569488525
mini_batch_src_global generation:  1.4668731689453125
r_  generation:  16.56990098953247
local_output_nid generation:  0.6192216873168945
local_in_edges_tensor generation:  1.258169412612915
mini_batch_src_global generation:  1.4836864471435547
r_  generation:  16.499725818634033
local_output_nid generation:  0.6202425956726074
local_in_edges_tensor generation:  1.2645800113677979
mini_batch_src_global generation:  1.5326642990112305
r_  generation:  16.37235927581787
local_output_nid generation:  0.6151890754699707
local_in_edges_tensor generation:  1.257002353668213
mini_batch_src_global generation:  1.664747953414917
r_  generation:  16.30490493774414
----------------------check_connections_block total spend ----------------------------- 180.72855257987976
generate_one_block  21.207711935043335
generate_one_block  21.23845100402832
generate_one_block  21.089590072631836
generate_one_block  21.981409311294556
generate_one_block  21.07796335220337
generate_one_block  21.16198754310608
generate_one_block  21.275939464569092
generate_one_block  21.54376983642578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 2.064964771270752  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

connection checking time:  263.13274693489075
block generation total time  250.68700051307678
average batch blocks generation time:  31.335875064134598
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2259430885314941  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0206775665283203  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.226274013519287  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0205392837524414  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2273550033569336  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0261354446411133  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.230276107788086  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0333242416381836  GigaBytes
Max Memory Allocated: 3.6877989768981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2260794639587402  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0186610221862793  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2270970344543457  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.023695945739746  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.2270760536193848  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.0245070457458496  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 1.227121353149414  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 3.025240898132324  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38009947538375854 |0.35584649443626404 |0.008683115243911743 |0.00017660856246948242 |0.020324647426605225 |0.0015745162963867188 |
----------------------------------------------------------pseudo_mini_loss sum 3.726076602935791
Total (block generation + training)time/epoch 553.4938318729401
Training time/epoch 1647756726.7432425
Training time without block to device /epoch 1647756723.8964705
Training time without total dataloading part /epoch 0.23504948616027832
load block tensor time/epoch 3.0407958030700684
block to device time/epoch 2.8467719554901123
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  35928704
Number of first layer input nodes during this epoch:  17484566
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 2.0707755088806152  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3148772716522217
random selection method range initialization spend 0.01434469223022461
time for parepare:  0.2807455062866211
local_output_nid generation:  0.012510061264038086
local_in_edges_tensor generation:  0.03128480911254883
mini_batch_src_global generation:  0.04248309135437012
r_  generation:  0.42804837226867676
local_output_nid generation:  0.014187097549438477
local_in_edges_tensor generation:  0.017955303192138672
mini_batch_src_global generation:  0.04260659217834473
r_  generation:  0.4941742420196533
local_output_nid generation:  0.014141082763671875
local_in_edges_tensor generation:  0.012923479080200195
mini_batch_src_global generation:  0.03872942924499512
r_  generation:  0.5087244510650635
local_output_nid generation:  0.014189004898071289
local_in_edges_tensor generation:  0.01712322235107422
mini_batch_src_global generation:  0.03261089324951172
r_  generation:  0.5224611759185791
local_output_nid generation:  0.01400136947631836
local_in_edges_tensor generation:  0.011993169784545898
mini_batch_src_global generation:  0.035309791564941406
r_  generation:  0.549628496170044
local_output_nid generation:  0.014321565628051758
local_in_edges_tensor generation:  0.01230621337890625
mini_batch_src_global generation:  0.0565028190612793
r_  generation:  0.5797672271728516
local_output_nid generation:  0.01752185821533203
local_in_edges_tensor generation:  0.013115167617797852
mini_batch_src_global generation:  0.04077005386352539
r_  generation:  0.5927886962890625
local_output_nid generation:  0.01605367660522461
local_in_edges_tensor generation:  0.011895179748535156
mini_batch_src_global generation:  0.05401206016540527
r_  generation:  0.5879771709442139
----------------------check_connections_block total spend ----------------------------- 5.9603846073150635
generate_one_block  0.960608959197998
generate_one_block  0.6196491718292236
generate_one_block  0.5969455242156982
generate_one_block  0.6018891334533691
generate_one_block  0.6215231418609619
generate_one_block  0.6505115032196045
generate_one_block  0.6420092582702637
generate_one_block  0.9793267250061035
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.024045944213867
gen group dst list time:  0.12686491012573242
time for parepare:  0.4630000591278076
local_output_nid generation:  0.18103337287902832
local_in_edges_tensor generation:  0.4456789493560791
mini_batch_src_global generation:  0.5502502918243408
r_  generation:  7.260475158691406
local_output_nid generation:  0.18779373168945312
local_in_edges_tensor generation:  0.5462636947631836
mini_batch_src_global generation:  0.831244945526123
r_  generation:  7.353572130203247
local_output_nid generation:  0.1945652961730957
local_in_edges_tensor generation:  0.4351809024810791
mini_batch_src_global generation:  0.6757900714874268
r_  generation:  7.774025201797485
local_output_nid generation:  0.18273377418518066
local_in_edges_tensor generation:  0.5226356983184814
mini_batch_src_global generation:  0.7615702152252197
r_  generation:  7.616082191467285
local_output_nid generation:  0.18653321266174316
local_in_edges_tensor generation:  0.5097055435180664
mini_batch_src_global generation:  0.7157931327819824
r_  generation:  7.740262031555176
local_output_nid generation:  0.18645668029785156
local_in_edges_tensor generation:  0.45864009857177734
mini_batch_src_global generation:  0.7434499263763428
r_  generation:  8.063822031021118
local_output_nid generation:  0.19351649284362793
local_in_edges_tensor generation:  0.552067756652832
mini_batch_src_global generation:  0.7379143238067627
r_  generation:  7.609120845794678
local_output_nid generation:  0.19173860549926758
local_in_edges_tensor generation:  0.44910597801208496
mini_batch_src_global generation:  0.7103509902954102
r_  generation:  7.778914451599121
----------------------check_connections_block total spend ----------------------------- 82.59988594055176
generate_one_block  10.45792031288147
generate_one_block  10.112420082092285
generate_one_block  9.806883335113525
generate_one_block  10.124092817306519
generate_one_block  10.123168230056763
generate_one_block  9.884155750274658
generate_one_block  9.986150741577148
generate_one_block  9.740309476852417
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.0670325756073
gen group dst list time:  0.5089108943939209
time for parepare:  0.47515273094177246
local_output_nid generation:  0.5831530094146729
local_in_edges_tensor generation:  1.2477073669433594
mini_batch_src_global generation:  1.1301522254943848
r_  generation:  16.24762225151062
local_output_nid generation:  0.6338822841644287
local_in_edges_tensor generation:  1.325958013534546
mini_batch_src_global generation:  1.5134780406951904
r_  generation:  16.302454471588135
local_output_nid generation:  0.6142170429229736
local_in_edges_tensor generation:  1.267207384109497
mini_batch_src_global generation:  1.483267068862915
r_  generation:  16.115426063537598
local_output_nid generation:  0.6176114082336426
local_in_edges_tensor generation:  1.109842300415039
mini_batch_src_global generation:  1.6198151111602783
r_  generation:  16.148796796798706
local_output_nid generation:  0.6421585083007812
local_in_edges_tensor generation:  1.2516567707061768
mini_batch_src_global generation:  1.6309454441070557
r_  generation:  16.394551515579224
local_output_nid generation:  0.6401684284210205
local_in_edges_tensor generation:  1.2447469234466553
mini_batch_src_global generation:  1.4822652339935303
r_  generation:  16.691836833953857
local_output_nid generation:  0.6262538433074951
local_in_edges_tensor generation:  1.2428696155548096
mini_batch_src_global generation:  1.4759132862091064
r_  generation:  16.379125118255615
local_output_nid generation:  0.6049396991729736
local_in_edges_tensor generation:  1.1844172477722168
mini_batch_src_global generation:  1.625673532485962
r_  generation:  16.279331922531128
----------------------check_connections_block total spend ----------------------------- 181.11979579925537
generate_one_block  21.330719470977783
generate_one_block  21.390686750411987
generate_one_block  21.38272476196289
generate_one_block  22.153296947479248
generate_one_block  21.750909328460693
generate_one_block  21.557963371276855
generate_one_block  21.40911555290222
generate_one_block  21.08162808418274
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 2.0707755088806152  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

connection checking time:  263.71968173980713
block generation total time  252.2921450138092
average batch blocks generation time:  31.53651812672615
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 1.22670316696167  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 3.022674560546875  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 1.2281136512756348  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 3.0280656814575195  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 1.2267355918884277  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 3.02302885055542  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 1.2261734008789062  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 3.0218067169189453  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 1.2266874313354492  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 3.0240678787231445  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 1.229494571685791  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 3.031534194946289  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 1.2261409759521484  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 3.021664619445801  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 1.2273025512695312  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 3.0226926803588867  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3618227243423462 |0.4697890281677246 |0.0039133429527282715 |0.00014126300811767578 |0.004151105880737305 |0.001199960708618164 |
----------------------------------------------------------pseudo_mini_loss sum 3.1385018825531006
Total (block generation + training)time/epoch 555.642047047615
Training time/epoch 1647757284.5339396
Training time without block to device /epoch 1647757280.7756274
Training time without total dataloading part /epoch 0.06684565544128418
load block tensor time/epoch 2.8945817947387695
block to device time/epoch 3.758312225341797
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  35920405
Number of first layer input nodes during this epoch:  17477663
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.2498779296875 GB
    Memory Allocated: 2.0693588256835938  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.2597615718841553
random selection method range initialization spend 0.018944740295410156
time for parepare:  0.265974760055542
local_output_nid generation:  0.012507200241088867
local_in_edges_tensor generation:  0.04631686210632324
mini_batch_src_global generation:  0.03233790397644043
r_  generation:  0.4209134578704834
local_output_nid generation:  0.014914751052856445
local_in_edges_tensor generation:  0.01705622673034668
mini_batch_src_global generation:  0.04231667518615723
r_  generation:  0.4711010456085205
local_output_nid generation:  0.015861034393310547
local_in_edges_tensor generation:  0.03490114212036133
mini_batch_src_global generation:  0.029822349548339844
r_  generation:  0.4888038635253906
local_output_nid generation:  0.0138397216796875
local_in_edges_tensor generation:  0.01755070686340332
mini_batch_src_global generation:  0.03253936767578125
r_  generation:  0.5272974967956543
local_output_nid generation:  0.013775110244750977
local_in_edges_tensor generation:  0.012267112731933594
mini_batch_src_global generation:  0.036293745040893555
r_  generation:  0.5580551624298096
local_output_nid generation:  0.013864517211914062
local_in_edges_tensor generation:  0.011831998825073242
mini_batch_src_global generation:  0.0439908504486084
r_  generation:  0.5734522342681885
local_output_nid generation:  0.028234481811523438
local_in_edges_tensor generation:  0.013076305389404297
mini_batch_src_global generation:  0.040532827377319336
r_  generation:  0.599285364151001
local_output_nid generation:  0.01372218132019043
local_in_edges_tensor generation:  0.012880086898803711
mini_batch_src_global generation:  0.04204750061035156
r_  generation:  0.5960099697113037
----------------------check_connections_block total spend ----------------------------- 5.883890390396118
generate_one_block  0.9915151596069336
generate_one_block  0.7334275245666504
generate_one_block  0.8922514915466309
generate_one_block  0.6356596946716309
generate_one_block  0.6157128810882568
generate_one_block  0.6207451820373535
generate_one_block  0.6231536865234375
generate_one_block  0.6102423667907715
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.972804307937622
gen group dst list time:  0.12823033332824707
time for parepare:  0.4390373229980469
local_output_nid generation:  0.18147516250610352
local_in_edges_tensor generation:  0.5619726181030273
mini_batch_src_global generation:  0.5507676601409912
r_  generation:  7.339403390884399
local_output_nid generation:  0.20688915252685547
local_in_edges_tensor generation:  0.6440322399139404
mini_batch_src_global generation:  0.7251412868499756
r_  generation:  7.710747241973877
local_output_nid generation:  0.2020723819732666
local_in_edges_tensor generation:  0.5712571144104004
mini_batch_src_global generation:  0.6890518665313721
r_  generation:  7.537015914916992
local_output_nid generation:  0.19336533546447754
local_in_edges_tensor generation:  0.4530479907989502
mini_batch_src_global generation:  0.7308368682861328
r_  generation:  7.963081121444702
local_output_nid generation:  0.2009904384613037
local_in_edges_tensor generation:  0.5695593357086182
mini_batch_src_global generation:  0.7186341285705566
r_  generation:  7.695474624633789
local_output_nid generation:  0.18894290924072266
local_in_edges_tensor generation:  0.4545466899871826
mini_batch_src_global generation:  0.7266080379486084
r_  generation:  7.837238311767578
local_output_nid generation:  0.17766761779785156
local_in_edges_tensor generation:  0.5129482746124268
mini_batch_src_global generation:  0.7806470394134521
r_  generation:  7.829075336456299
local_output_nid generation:  0.1985461711883545
local_in_edges_tensor generation:  0.5088376998901367
mini_batch_src_global generation:  0.7256455421447754
r_  generation:  7.753673315048218
----------------------check_connections_block total spend ----------------------------- 83.78702116012573
generate_one_block  10.269960165023804
generate_one_block  10.093588829040527
generate_one_block  9.784903764724731
generate_one_block  9.899439811706543
generate_one_block  10.33848786354065
generate_one_block  9.818395376205444
generate_one_block  9.94896149635315
generate_one_block  9.948353052139282
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.229261636734009
gen group dst list time:  0.5337479114532471
time for parepare:  0.45635175704956055
local_output_nid generation:  0.5860092639923096
local_in_edges_tensor generation:  1.3791511058807373
mini_batch_src_global generation:  1.1138269901275635
r_  generation:  16.273996591567993
local_output_nid generation:  0.6464471817016602
local_in_edges_tensor generation:  1.3606534004211426
mini_batch_src_global generation:  1.5456914901733398
r_  generation:  16.689162015914917
local_output_nid generation:  0.6214373111724854
local_in_edges_tensor generation:  1.2754056453704834
mini_batch_src_global generation:  1.4935047626495361
r_  generation:  16.444122076034546
local_output_nid generation:  0.6056954860687256
local_in_edges_tensor generation:  1.1215593814849854
mini_batch_src_global generation:  1.6220037937164307
r_  generation:  16.0072021484375
local_output_nid generation:  0.6359899044036865
local_in_edges_tensor generation:  1.2520990371704102
mini_batch_src_global generation:  1.5917434692382812
r_  generation:  16.587732553482056
local_output_nid generation:  0.6334536075592041
local_in_edges_tensor generation:  1.2678742408752441
mini_batch_src_global generation:  1.4932951927185059
r_  generation:  16.772470951080322
local_output_nid generation:  0.6222000122070312
local_in_edges_tensor generation:  1.269563913345337
mini_batch_src_global generation:  1.5040709972381592
r_  generation:  16.33144497871399
local_output_nid generation:  0.6167583465576172
local_in_edges_tensor generation:  1.1987714767456055
mini_batch_src_global generation:  1.6229918003082275
r_  generation:  16.163246870040894
----------------------check_connections_block total spend ----------------------------- 181.98926973342896
generate_one_block  21.179897785186768
generate_one_block  20.984772205352783
generate_one_block  21.107275009155273
generate_one_block  21.98677635192871
generate_one_block  21.275556325912476
generate_one_block  21.14192485809326
generate_one_block  20.795700788497925
generate_one_block  21.227522611618042
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 2.0693588256835938  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

connection checking time:  265.7762908935547
block generation total time  249.80151629447937
average batch blocks generation time:  31.22518953680992
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 1.2248058319091797  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 3.020174980163574  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 1.226724624633789  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 3.0221776962280273  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 1.2292346954345703  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 3.028806209564209  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 1.2277164459228516  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 3.0264854431152344  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 1.227081298828125  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 3.0256481170654297  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 1.2264599800109863  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 3.0230283737182617  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 1.2263436317443848  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 3.0206141471862793  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 1.2292065620422363  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 3.0293831825256348  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36468440294265747 |0.3526555001735687 |0.0038270950317382812 |0.0001405179500579834 |0.00405275821685791 |0.0011754035949707031 |
----------------------------------------------------------pseudo_mini_loss sum 2.7017571926116943
Total (block generation + training)time/epoch 555.7498955726624
Training time/epoch 1647757840.499812
Training time without block to device /epoch 1647757837.678568
Training time without total dataloading part /epoch 0.0653383731842041
load block tensor time/epoch 2.9174752235412598
block to device time/epoch 2.82124400138855
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  35924533
Number of first layer input nodes during this epoch:  17479688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 2.074352741241455  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.2696046829223633
random selection method range initialization spend 0.016614437103271484
time for parepare:  0.2759227752685547
local_output_nid generation:  0.012634754180908203
local_in_edges_tensor generation:  0.034268856048583984
mini_batch_src_global generation:  0.036510467529296875
r_  generation:  0.4186370372772217
local_output_nid generation:  0.017733335494995117
local_in_edges_tensor generation:  0.026695728302001953
mini_batch_src_global generation:  0.04295086860656738
r_  generation:  0.4716031551361084
local_output_nid generation:  0.01399540901184082
local_in_edges_tensor generation:  0.026350736618041992
mini_batch_src_global generation:  0.030588388442993164
r_  generation:  0.4843168258666992
local_output_nid generation:  0.013746023178100586
local_in_edges_tensor generation:  0.013531208038330078
mini_batch_src_global generation:  0.033728599548339844
r_  generation:  0.5335659980773926
local_output_nid generation:  0.01407313346862793
local_in_edges_tensor generation:  0.012060165405273438
mini_batch_src_global generation:  0.03478550910949707
r_  generation:  0.5531818866729736
local_output_nid generation:  0.01406097412109375
local_in_edges_tensor generation:  0.012932538986206055
mini_batch_src_global generation:  0.04071617126464844
r_  generation:  0.5840764045715332
local_output_nid generation:  0.013879537582397461
local_in_edges_tensor generation:  0.011831283569335938
mini_batch_src_global generation:  0.05489683151245117
r_  generation:  0.5947701930999756
local_output_nid generation:  0.016795635223388672
local_in_edges_tensor generation:  0.013112545013427734
mini_batch_src_global generation:  0.04190492630004883
r_  generation:  0.6004245281219482
----------------------check_connections_block total spend ----------------------------- 5.8845131397247314
generate_one_block  1.0022780895233154
generate_one_block  0.7949380874633789
generate_one_block  0.8402523994445801
generate_one_block  0.6419923305511475
generate_one_block  0.6124405860900879
generate_one_block  0.6226146221160889
generate_one_block  0.6259374618530273
generate_one_block  0.6080186367034912
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.959418535232544
gen group dst list time:  0.13158345222473145
time for parepare:  0.44916486740112305
local_output_nid generation:  0.18370938301086426
local_in_edges_tensor generation:  0.46681880950927734
mini_batch_src_global generation:  0.5565640926361084
r_  generation:  7.387669563293457
local_output_nid generation:  0.21234703063964844
local_in_edges_tensor generation:  0.6471731662750244
mini_batch_src_global generation:  0.679999589920044
r_  generation:  7.6971330642700195
local_output_nid generation:  0.20084547996520996
local_in_edges_tensor generation:  0.550783634185791
mini_batch_src_global generation:  0.6835365295410156
r_  generation:  7.608180046081543
local_output_nid generation:  0.18956422805786133
local_in_edges_tensor generation:  0.4254481792449951
mini_batch_src_global generation:  0.7090437412261963
r_  generation:  7.879252910614014
local_output_nid generation:  0.1998283863067627
local_in_edges_tensor generation:  0.5679454803466797
mini_batch_src_global generation:  0.694176435470581
r_  generation:  7.645263433456421
local_output_nid generation:  0.1887204647064209
local_in_edges_tensor generation:  0.4594399929046631
mini_batch_src_global generation:  0.7253928184509277
r_  generation:  7.94118070602417
local_output_nid generation:  0.17887020111083984
local_in_edges_tensor generation:  0.5802545547485352
mini_batch_src_global generation:  0.7525796890258789
r_  generation:  7.72272253036499
local_output_nid generation:  0.19788384437561035
local_in_edges_tensor generation:  0.452437162399292
mini_batch_src_global generation:  0.7279417514801025
r_  generation:  7.756795644760132
----------------------check_connections_block total spend ----------------------------- 83.33066582679749
generate_one_block  10.311861276626587
generate_one_block  10.096312046051025
generate_one_block  9.821152925491333
generate_one_block  10.113528490066528
generate_one_block  9.950902223587036
generate_one_block  9.901400566101074
generate_one_block  10.146029949188232
generate_one_block  9.858046054840088
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1244804859161377
gen group dst list time:  0.537700891494751
time for parepare:  0.4707050323486328
local_output_nid generation:  0.6139018535614014
local_in_edges_tensor generation:  1.258155107498169
mini_batch_src_global generation:  1.1187090873718262
r_  generation:  15.951657056808472
local_output_nid generation:  0.6477727890014648
local_in_edges_tensor generation:  1.3499903678894043
mini_batch_src_global generation:  1.4595699310302734
r_  generation:  16.304527044296265
local_output_nid generation:  0.6350271701812744
local_in_edges_tensor generation:  1.27439284324646
mini_batch_src_global generation:  1.4818155765533447
r_  generation:  16.186583757400513
local_output_nid generation:  0.6305310726165771
local_in_edges_tensor generation:  1.112727165222168
mini_batch_src_global generation:  1.5709035396575928
r_  generation:  16.055262565612793
local_output_nid generation:  0.6521463394165039
local_in_edges_tensor generation:  1.272156000137329
mini_batch_src_global generation:  1.5917744636535645
r_  generation:  16.4168381690979
local_output_nid generation:  0.6398303508758545
local_in_edges_tensor generation:  1.2556748390197754
mini_batch_src_global generation:  1.4778344631195068
r_  generation:  16.602083683013916
local_output_nid generation:  0.671297550201416
local_in_edges_tensor generation:  1.253434419631958
mini_batch_src_global generation:  1.5008749961853027
r_  generation:  16.248319149017334
local_output_nid generation:  0.6136600971221924
local_in_edges_tensor generation:  1.1780827045440674
mini_batch_src_global generation:  1.6019093990325928
r_  generation:  16.036714792251587
----------------------check_connections_block total spend ----------------------------- 180.08450055122375
generate_one_block  21.232948064804077
generate_one_block  21.063419580459595
generate_one_block  21.349820137023926
generate_one_block  21.97525978088379
generate_one_block  21.38477349281311
generate_one_block  21.572551488876343
generate_one_block  22.367446422576904
generate_one_block  21.894676446914673
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 2.074352741241455  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

connection checking time:  263.41516637802124
block generation total time  253.04012894630432
average batch blocks generation time:  31.63001611828804
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 1.227726936340332  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 3.0260977745056152  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 1.2261009216308594  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 3.021969795227051  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 1.2295761108398438  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 3.033181667327881  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 1.2266225814819336  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes
Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 3.0232019424438477  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 1.2264623641967773  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 3.0209460258483887  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 1.229867935180664  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 3.0328989028930664  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 1.2272558212280273  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 3.02484130859375  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 1.2250261306762695  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1033935546875 GB
    Memory Allocated: 3.020998477935791  GigaBytes
Max Memory Allocated: 3.6906752586364746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3593445122241974 |0.41286879777908325 |0.006143629550933838 |0.00013372302055358887 |0.0038677752017974854 |0.0011827945709228516 |
----------------------------------------------------------pseudo_mini_loss sum 2.4028501510620117
Total (block generation + training)time/epoch 556.1294004321098
Training time/epoch 1647758397.7680244
Training time without block to device /epoch 1647758394.465074
Training time without total dataloading part /epoch 0.08234381675720215
load block tensor time/epoch 2.874756097793579
block to device time/epoch 3.302950382232666
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  35932688
Number of first layer input nodes during this epoch:  17483631
