main start at this time 1647899418.1053963
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6711893081665039
random selection method range initialization spend 0.01656198501586914
time for parepare:  0.3751027584075928
local_output_nid generation:  0.007085084915161133
local_in_edges_tensor generation:  0.03984975814819336
mini_batch_src_global generation:  0.026716232299804688
r_  generation:  0.35224318504333496
local_output_nid generation:  0.0073604583740234375
local_in_edges_tensor generation:  0.020967721939086914
mini_batch_src_global generation:  0.0334012508392334
r_  generation:  0.40587830543518066
local_output_nid generation:  0.007305145263671875
local_in_edges_tensor generation:  0.009462356567382812
mini_batch_src_global generation:  0.023332834243774414
r_  generation:  0.4141061305999756
local_output_nid generation:  0.0071337223052978516
local_in_edges_tensor generation:  0.009261369705200195
mini_batch_src_global generation:  0.025952577590942383
r_  generation:  0.45088982582092285
local_output_nid generation:  0.007070779800415039
local_in_edges_tensor generation:  0.009205341339111328
mini_batch_src_global generation:  0.028052091598510742
r_  generation:  0.4666433334350586
local_output_nid generation:  0.007169008255004883
local_in_edges_tensor generation:  0.009177207946777344
mini_batch_src_global generation:  0.030924081802368164
r_  generation:  0.4953646659851074
local_output_nid generation:  0.0072400569915771484
local_in_edges_tensor generation:  0.009384393692016602
mini_batch_src_global generation:  0.03224778175354004
r_  generation:  0.49685168266296387
local_output_nid generation:  0.0070950984954833984
local_in_edges_tensor generation:  0.009247541427612305
mini_batch_src_global generation:  0.03346610069274902
r_  generation:  0.5082418918609619
local_output_nid generation:  0.007269144058227539
local_in_edges_tensor generation:  0.009191513061523438
mini_batch_src_global generation:  0.034726858139038086
r_  generation:  0.5045068264007568
local_output_nid generation:  0.0072939395904541016
local_in_edges_tensor generation:  0.009240388870239258
mini_batch_src_global generation:  0.03600907325744629
r_  generation:  0.5209310054779053
local_output_nid generation:  0.0072345733642578125
local_in_edges_tensor generation:  0.009403705596923828
mini_batch_src_global generation:  0.03767538070678711
r_  generation:  0.5214629173278809
local_output_nid generation:  0.007281064987182617
local_in_edges_tensor generation:  0.009528160095214844
mini_batch_src_global generation:  0.03905129432678223
r_  generation:  0.5239477157592773
local_output_nid generation:  0.007068157196044922
local_in_edges_tensor generation:  0.009388446807861328
mini_batch_src_global generation:  0.04013705253601074
r_  generation:  0.5237038135528564
local_output_nid generation:  0.007245540618896484
local_in_edges_tensor generation:  0.009146928787231445
mini_batch_src_global generation:  0.04029107093811035
r_  generation:  0.5340719223022461
local_output_nid generation:  0.007254600524902344
local_in_edges_tensor generation:  0.009342193603515625
mini_batch_src_global generation:  0.04237556457519531
r_  generation:  0.5234212875366211
local_output_nid generation:  0.0070416927337646484
local_in_edges_tensor generation:  0.009313344955444336
mini_batch_src_global generation:  0.04151487350463867
r_  generation:  0.5274076461791992
----------------------check_connections_block total spend ----------------------------- 10.326148509979248
generate_one_block  5.610986948013306
generate_one_block  0.4925501346588135
generate_one_block  0.5157134532928467
generate_one_block  0.49758148193359375
generate_one_block  0.5040671825408936
generate_one_block  0.49961113929748535
generate_one_block  0.5031294822692871
generate_one_block  0.4975860118865967
generate_one_block  0.5006952285766602
generate_one_block  0.5043163299560547
generate_one_block  0.5138847827911377
generate_one_block  0.49990081787109375
generate_one_block  0.4973170757293701
generate_one_block  0.5011935234069824
generate_one_block  0.5033218860626221
generate_one_block  0.4990358352661133
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3265790939331055
gen group dst list time:  0.23169374465942383
time for parepare:  0.47574520111083984
local_output_nid generation:  0.16617274284362793
local_in_edges_tensor generation:  0.7658987045288086
mini_batch_src_global generation:  0.9045541286468506
r_  generation:  10.832161903381348
local_output_nid generation:  0.2004408836364746
local_in_edges_tensor generation:  0.8427743911743164
mini_batch_src_global generation:  1.2289459705352783
r_  generation:  10.582293033599854
local_output_nid generation:  0.18897008895874023
local_in_edges_tensor generation:  0.6715149879455566
mini_batch_src_global generation:  1.1571614742279053
r_  generation:  10.750564813613892
local_output_nid generation:  0.20287394523620605
local_in_edges_tensor generation:  1.0081603527069092
mini_batch_src_global generation:  1.1068918704986572
r_  generation:  10.866199970245361
local_output_nid generation:  0.17278766632080078
local_in_edges_tensor generation:  0.7550315856933594
mini_batch_src_global generation:  1.1410284042358398
r_  generation:  10.806371450424194
local_output_nid generation:  0.20230674743652344
local_in_edges_tensor generation:  0.7682032585144043
mini_batch_src_global generation:  1.19612717628479
r_  generation:  10.942867517471313
local_output_nid generation:  0.17049407958984375
local_in_edges_tensor generation:  0.8426148891448975
mini_batch_src_global generation:  1.1835362911224365
r_  generation:  10.814673900604248
local_output_nid generation:  0.1912555694580078
local_in_edges_tensor generation:  0.6645779609680176
mini_batch_src_global generation:  1.1992363929748535
r_  generation:  10.910207509994507
local_output_nid generation:  0.20037841796875
local_in_edges_tensor generation:  0.8341426849365234
mini_batch_src_global generation:  1.1456551551818848
r_  generation:  10.95447826385498
local_output_nid generation:  0.18289685249328613
local_in_edges_tensor generation:  0.6723253726959229
mini_batch_src_global generation:  1.2003965377807617
r_  generation:  10.883232831954956
local_output_nid generation:  0.20785188674926758
local_in_edges_tensor generation:  0.8318555355072021
mini_batch_src_global generation:  1.2316179275512695
r_  generation:  11.072834968566895
local_output_nid generation:  0.17084407806396484
local_in_edges_tensor generation:  0.8494524955749512
mini_batch_src_global generation:  1.1847548484802246
r_  generation:  10.917635202407837
local_output_nid generation:  0.18816757202148438
local_in_edges_tensor generation:  0.6624789237976074
mini_batch_src_global generation:  1.346299409866333
r_  generation:  11.390573740005493
local_output_nid generation:  0.20090889930725098
local_in_edges_tensor generation:  0.8656530380249023
mini_batch_src_global generation:  1.2961230278015137
r_  generation:  10.815086126327515
local_output_nid generation:  0.20069479942321777
local_in_edges_tensor generation:  0.8376662731170654
mini_batch_src_global generation:  1.2524809837341309
r_  generation:  11.013556480407715
local_output_nid generation:  0.1693737506866455
local_in_edges_tensor generation:  0.8408851623535156
mini_batch_src_global generation:  1.2143733501434326
r_  generation:  10.850383996963501
----------------------check_connections_block total spend ----------------------------- 238.88799929618835
generate_one_block  15.844271421432495
generate_one_block  15.177357196807861
generate_one_block  15.128120183944702
generate_one_block  14.753917694091797
generate_one_block  15.137219429016113
generate_one_block  15.270920753479004
generate_one_block  14.946276426315308
generate_one_block  15.274846315383911
generate_one_block  16.132580757141113
generate_one_block  15.176506996154785
generate_one_block  15.071285247802734
generate_one_block  14.767432928085327
generate_one_block  15.053650856018066
generate_one_block  15.085590839385986
generate_one_block  14.873771905899048
generate_one_block  14.966822385787964
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.731438159942627
gen group dst list time:  1.1245884895324707
time for parepare:  0.48857665061950684
local_output_nid generation:  0.6156408786773682
local_in_edges_tensor generation:  1.9041085243225098
mini_batch_src_global generation:  2.056311845779419
r_  generation:  23.971742868423462
local_output_nid generation:  0.6762151718139648
local_in_edges_tensor generation:  1.8529279232025146
mini_batch_src_global generation:  2.5812482833862305
r_  generation:  23.930766820907593
local_output_nid generation:  0.6689503192901611
local_in_edges_tensor generation:  2.077216148376465
mini_batch_src_global generation:  2.698085069656372
r_  generation:  24.004369497299194
local_output_nid generation:  0.6670036315917969
local_in_edges_tensor generation:  1.7913334369659424
mini_batch_src_global generation:  2.772169589996338
r_  generation:  24.322977304458618
local_output_nid generation:  0.6735484600067139
local_in_edges_tensor generation:  1.8220174312591553
mini_batch_src_global generation:  2.5932815074920654
r_  generation:  24.307972192764282
local_output_nid generation:  0.6773560047149658
local_in_edges_tensor generation:  3.3187074661254883
mini_batch_src_global generation:  2.488813638687134
r_  generation:  24.055130004882812
local_output_nid generation:  0.6768407821655273
local_in_edges_tensor generation:  1.9054920673370361
mini_batch_src_global generation:  2.828040361404419
r_  generation:  24.516040325164795
local_output_nid generation:  0.6858899593353271
local_in_edges_tensor generation:  1.8233020305633545
mini_batch_src_global generation:  2.6693265438079834
r_  generation:  24.29133915901184
local_output_nid generation:  0.6732652187347412
local_in_edges_tensor generation:  1.8244566917419434
mini_batch_src_global generation:  2.8743724822998047
r_  generation:  24.44295835494995
local_output_nid generation:  0.6849639415740967
local_in_edges_tensor generation:  1.8110311031341553
mini_batch_src_global generation:  2.6144773960113525
r_  generation:  24.293205499649048
local_output_nid generation:  0.6715860366821289
local_in_edges_tensor generation:  1.8260962963104248
mini_batch_src_global generation:  2.8729875087738037
r_  generation:  24.363689422607422
local_output_nid generation:  0.6751482486724854
local_in_edges_tensor generation:  1.8550715446472168
mini_batch_src_global generation:  2.843717575073242
r_  generation:  24.238189697265625
local_output_nid generation:  0.6792893409729004
local_in_edges_tensor generation:  1.8341948986053467
mini_batch_src_global generation:  2.656888008117676
r_  generation:  24.311758041381836
local_output_nid generation:  0.6771245002746582
local_in_edges_tensor generation:  1.8245337009429932
mini_batch_src_global generation:  2.832360029220581
r_  generation:  24.19125509262085
local_output_nid generation:  0.673973798751831
local_in_edges_tensor generation:  1.8099238872528076
mini_batch_src_global generation:  2.5873208045959473
r_  generation:  24.500185012817383
local_output_nid generation:  0.6800367832183838
local_in_edges_tensor generation:  1.8335342407226562
mini_batch_src_global generation:  2.8479249477386475
r_  generation:  24.47563123703003
----------------------check_connections_block total spend ----------------------------- 543.773355960846
generate_one_block  33.32302951812744
generate_one_block  33.31396794319153
generate_one_block  32.7884304523468
generate_one_block  33.0911066532135
generate_one_block  33.056387186050415
generate_one_block  33.2898051738739
generate_one_block  34.38351535797119
generate_one_block  33.693344831466675
generate_one_block  33.07231402397156
generate_one_block  33.06401705741882
generate_one_block  33.136069536209106
generate_one_block  32.94698214530945
generate_one_block  33.02622175216675
generate_one_block  33.18910193443298
generate_one_block  33.122833251953125
generate_one_block  33.66616177558899
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  782.6613552570343
block generation total time  774.8238599300385
average batch blocks generation time:  48.4264912456274
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6258544921875 GB
    Memory Allocated: 1.5171661376953125  GigaBytes
Max Memory Allocated: 1.5171661376953125  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5145263671875 GB
    Memory Allocated: 3.6176271438598633  GigaBytes
Max Memory Allocated: 4.105982780456543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 1.5235352516174316  GigaBytes
Max Memory Allocated: 5.022400856018066  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 3.6265196800231934  GigaBytes
Max Memory Allocated: 5.022400856018066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 1.518317699432373  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 3.6166977882385254  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 1.5157175064086914  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 3.6037755012512207  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 1.5191926956176758  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 3.617583751678467  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 1.520599365234375  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 3.6234302520751953  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 1.5226998329162598  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 3.628556728363037  GigaBytes
Max Memory Allocated: 5.031545162200928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 1.523453712463379  GigaBytes
Max Memory Allocated: 5.033607006072998  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 3.6267452239990234  GigaBytes
Max Memory Allocated: 5.033607006072998  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 1.521064281463623  GigaBytes
Max Memory Allocated: 5.033607006072998  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 3.620537757873535  GigaBytes
Max Memory Allocated: 5.033607006072998  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9246826171875 GB
    Memory Allocated: 1.5227022171020508  GigaBytes
Max Memory Allocated: 5.033607006072998  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9266357421875 GB
    Memory Allocated: 3.6330933570861816  GigaBytes
Max Memory Allocated: 5.033607006072998  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5213403701782227  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.62432861328125  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5193815231323242  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.618466854095459  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5199909210205078  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6185383796691895  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5189647674560547  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.618129253387451  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5189414024353027  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.616659164428711  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5228514671325684  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6256003379821777  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38873519003391266 |0.9001104533672333 |0.04755398631095886 |0.00014764070510864258 |0.04219923913478851 |0.0035161972045898438 |
----------------------------------------------------------pseudo_mini_loss sum 8.690607070922852
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  74217028
Number of first layer input nodes during this epoch:  36083043
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.9067888259887695  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6478323936462402
random selection method range initialization spend 0.013191938400268555
time for parepare:  0.3820838928222656
local_output_nid generation:  0.009042739868164062
local_in_edges_tensor generation:  0.09629082679748535
mini_batch_src_global generation:  0.02788567543029785
r_  generation:  0.3659806251525879
local_output_nid generation:  0.00728154182434082
local_in_edges_tensor generation:  0.008843421936035156
mini_batch_src_global generation:  0.03452301025390625
r_  generation:  0.41655683517456055
local_output_nid generation:  0.00742340087890625
local_in_edges_tensor generation:  0.00881052017211914
mini_batch_src_global generation:  0.023396015167236328
r_  generation:  0.4367339611053467
local_output_nid generation:  0.007508516311645508
local_in_edges_tensor generation:  0.008941650390625
mini_batch_src_global generation:  0.026075124740600586
r_  generation:  0.47589826583862305
local_output_nid generation:  0.0072171688079833984
local_in_edges_tensor generation:  0.008846759796142578
mini_batch_src_global generation:  0.02796792984008789
r_  generation:  0.4791114330291748
local_output_nid generation:  0.00734257698059082
local_in_edges_tensor generation:  0.008863687515258789
mini_batch_src_global generation:  0.031052350997924805
r_  generation:  0.5419542789459229
local_output_nid generation:  0.007402896881103516
local_in_edges_tensor generation:  0.00880289077758789
mini_batch_src_global generation:  0.03229856491088867
r_  generation:  0.530928373336792
local_output_nid generation:  0.008026838302612305
local_in_edges_tensor generation:  0.008887529373168945
mini_batch_src_global generation:  0.033435821533203125
r_  generation:  0.5300419330596924
local_output_nid generation:  0.007512569427490234
local_in_edges_tensor generation:  0.008807182312011719
mini_batch_src_global generation:  0.03462815284729004
r_  generation:  0.5515260696411133
local_output_nid generation:  0.008775949478149414
local_in_edges_tensor generation:  0.034583330154418945
mini_batch_src_global generation:  0.04136347770690918
r_  generation:  0.5374679565429688
local_output_nid generation:  0.008437395095825195
local_in_edges_tensor generation:  0.02319192886352539
mini_batch_src_global generation:  0.03792905807495117
r_  generation:  0.5208909511566162
local_output_nid generation:  0.007554531097412109
local_in_edges_tensor generation:  0.017040491104125977
mini_batch_src_global generation:  0.039426326751708984
r_  generation:  0.5300502777099609
local_output_nid generation:  0.00743556022644043
local_in_edges_tensor generation:  0.016432523727416992
mini_batch_src_global generation:  0.03975081443786621
r_  generation:  0.5307097434997559
local_output_nid generation:  0.0075266361236572266
local_in_edges_tensor generation:  0.011792421340942383
mini_batch_src_global generation:  0.041651248931884766
r_  generation:  0.5372867584228516
local_output_nid generation:  0.007420539855957031
local_in_edges_tensor generation:  0.010254621505737305
mini_batch_src_global generation:  0.041886091232299805
r_  generation:  0.5319724082946777
local_output_nid generation:  0.007380247116088867
local_in_edges_tensor generation:  0.010076522827148438
mini_batch_src_global generation:  0.05753302574157715
r_  generation:  0.554497480392456
----------------------check_connections_block total spend ----------------------------- 10.880430936813354
generate_one_block  0.9004931449890137
generate_one_block  0.5581037998199463
generate_one_block  0.5328719615936279
generate_one_block  0.5395824909210205
generate_one_block  0.5539815425872803
generate_one_block  0.6618497371673584
generate_one_block  0.6932766437530518
generate_one_block  0.5724260807037354
generate_one_block  0.5143585205078125
generate_one_block  0.5302281379699707
generate_one_block  0.5185732841491699
generate_one_block  0.5076873302459717
generate_one_block  0.5211269855499268
generate_one_block  0.5101199150085449
generate_one_block  0.514765739440918
generate_one_block  0.506446123123169
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3283283710479736
gen group dst list time:  0.28301453590393066
time for parepare:  0.5127248764038086
local_output_nid generation:  0.16779375076293945
local_in_edges_tensor generation:  0.8230109214782715
mini_batch_src_global generation:  0.8972864151000977
r_  generation:  10.415631532669067
local_output_nid generation:  0.19493484497070312
local_in_edges_tensor generation:  1.1343567371368408
mini_batch_src_global generation:  1.2303004264831543
r_  generation:  10.763256788253784
local_output_nid generation:  0.20531582832336426
local_in_edges_tensor generation:  0.8675179481506348
mini_batch_src_global generation:  1.1918680667877197
r_  generation:  10.830624103546143
local_output_nid generation:  0.1954059600830078
local_in_edges_tensor generation:  0.8513374328613281
mini_batch_src_global generation:  1.301384687423706
r_  generation:  10.924052238464355
local_output_nid generation:  0.1941666603088379
local_in_edges_tensor generation:  0.8745987415313721
mini_batch_src_global generation:  1.2913243770599365
r_  generation:  11.085676670074463
local_output_nid generation:  0.1941204071044922
local_in_edges_tensor generation:  0.8530566692352295
mini_batch_src_global generation:  1.3080048561096191
r_  generation:  11.040422201156616
local_output_nid generation:  0.1953585147857666
local_in_edges_tensor generation:  0.8702049255371094
mini_batch_src_global generation:  1.2978286743164062
r_  generation:  10.965085983276367
local_output_nid generation:  0.19466876983642578
local_in_edges_tensor generation:  0.8399074077606201
mini_batch_src_global generation:  1.3202881813049316
r_  generation:  11.003669500350952
local_output_nid generation:  0.19497013092041016
local_in_edges_tensor generation:  0.8472228050231934
mini_batch_src_global generation:  1.3238306045532227
r_  generation:  11.014584302902222
local_output_nid generation:  0.19401288032531738
local_in_edges_tensor generation:  0.857719898223877
mini_batch_src_global generation:  1.2653372287750244
r_  generation:  11.010006666183472
local_output_nid generation:  0.19681215286254883
local_in_edges_tensor generation:  0.8447539806365967
mini_batch_src_global generation:  1.3509845733642578
r_  generation:  11.434855222702026
local_output_nid generation:  0.2069544792175293
local_in_edges_tensor generation:  0.8596789836883545
mini_batch_src_global generation:  1.3189990520477295
r_  generation:  11.148837804794312
local_output_nid generation:  0.20382046699523926
local_in_edges_tensor generation:  0.8450591564178467
mini_batch_src_global generation:  1.2303509712219238
r_  generation:  11.151905298233032
local_output_nid generation:  0.189971923828125
local_in_edges_tensor generation:  0.8453707695007324
mini_batch_src_global generation:  1.2956807613372803
r_  generation:  11.077136039733887
local_output_nid generation:  0.20561933517456055
local_in_edges_tensor generation:  0.8559412956237793
mini_batch_src_global generation:  1.2270338535308838
r_  generation:  11.179900169372559
local_output_nid generation:  0.18950366973876953
local_in_edges_tensor generation:  0.8446700572967529
mini_batch_src_global generation:  1.290656566619873
r_  generation:  11.048882484436035
----------------------check_connections_block total spend ----------------------------- 243.42176961898804
generate_one_block  15.577523231506348
generate_one_block  16.17235779762268
generate_one_block  15.53993558883667
generate_one_block  15.608129978179932
generate_one_block  15.469921112060547
generate_one_block  15.685893774032593
generate_one_block  15.460642576217651
generate_one_block  15.581047058105469
generate_one_block  15.501578330993652
generate_one_block  15.855789422988892
generate_one_block  15.601259231567383
generate_one_block  15.511273384094238
generate_one_block  15.600218057632446
generate_one_block  15.462764024734497
generate_one_block  15.547854661941528
generate_one_block  15.43764042854309
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.764420509338379
gen group dst list time:  1.168302297592163
time for parepare:  0.5066874027252197
local_output_nid generation:  0.636448860168457
local_in_edges_tensor generation:  2.0464975833892822
mini_batch_src_global generation:  1.9405887126922607
r_  generation:  23.577916860580444
local_output_nid generation:  0.6717164516448975
local_in_edges_tensor generation:  1.9095189571380615
mini_batch_src_global generation:  2.8207881450653076
r_  generation:  24.249557971954346
local_output_nid generation:  0.6934142112731934
local_in_edges_tensor generation:  1.9171323776245117
mini_batch_src_global generation:  2.758141040802002
r_  generation:  24.386170625686646
local_output_nid generation:  0.6902549266815186
local_in_edges_tensor generation:  1.8040790557861328
mini_batch_src_global generation:  2.816960573196411
r_  generation:  24.380013465881348
local_output_nid generation:  0.6845982074737549
local_in_edges_tensor generation:  1.9625825881958008
mini_batch_src_global generation:  2.8349361419677734
r_  generation:  24.63394522666931
local_output_nid generation:  0.6850380897521973
local_in_edges_tensor generation:  1.8007383346557617
mini_batch_src_global generation:  2.881396532058716
r_  generation:  25.1465847492218
local_output_nid generation:  0.7095882892608643
local_in_edges_tensor generation:  1.853804111480713
mini_batch_src_global generation:  2.933417797088623
r_  generation:  25.093555212020874
local_output_nid generation:  0.6898002624511719
local_in_edges_tensor generation:  1.865957260131836
mini_batch_src_global generation:  2.813047170639038
r_  generation:  25.01739525794983
local_output_nid generation:  0.6807723045349121
local_in_edges_tensor generation:  1.8664460182189941
mini_batch_src_global generation:  2.7973906993865967
r_  generation:  24.9271821975708
local_output_nid generation:  0.6908760070800781
local_in_edges_tensor generation:  1.8220276832580566
mini_batch_src_global generation:  2.8694472312927246
r_  generation:  24.862221240997314
local_output_nid generation:  0.6930041313171387
local_in_edges_tensor generation:  1.8528125286102295
mini_batch_src_global generation:  2.8651318550109863
r_  generation:  25.130629777908325
local_output_nid generation:  0.689478874206543
local_in_edges_tensor generation:  1.9509708881378174
mini_batch_src_global generation:  2.8379266262054443
r_  generation:  24.903929233551025
local_output_nid generation:  0.6944408416748047
local_in_edges_tensor generation:  2.0177087783813477
mini_batch_src_global generation:  2.887665033340454
r_  generation:  25.13084626197815
local_output_nid generation:  0.6943378448486328
local_in_edges_tensor generation:  3.999216079711914
mini_batch_src_global generation:  2.5323429107666016
r_  generation:  24.91439700126648
local_output_nid generation:  0.6774501800537109
local_in_edges_tensor generation:  1.8353323936462402
mini_batch_src_global generation:  3.0376241207122803
r_  generation:  25.19608449935913
local_output_nid generation:  0.68306565284729
local_in_edges_tensor generation:  1.8292431831359863
mini_batch_src_global generation:  2.934931993484497
r_  generation:  24.918973207473755
----------------------check_connections_block total spend ----------------------------- 555.5678889751434
generate_one_block  33.898255586624146
generate_one_block  33.88175988197327
generate_one_block  33.71542811393738
generate_one_block  33.709901571273804
generate_one_block  34.03397035598755
generate_one_block  33.90143537521362
generate_one_block  34.4783992767334
generate_one_block  34.84033918380737
generate_one_block  33.980658292770386
generate_one_block  35.881653785705566
generate_one_block  36.71478223800659
generate_one_block  36.476057291030884
generate_one_block  37.04885220527649
generate_one_block  36.48373103141785
generate_one_block  36.67209792137146
generate_one_block  37.259350538253784
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.9067888259887695  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

connection checking time:  798.9896585941315
block generation total time  812.5905013084412
average batch blocks generation time:  50.78690633177757
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.522627353668213  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.627229690551758  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5227136611938477  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.627023696899414  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5189895629882812  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.618683338165283  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5216221809387207  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.625551700592041  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5189404487609863  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6156764030456543  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5228090286254883  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6245532035827637  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5223770141601562  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6228761672973633  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5237464904785156  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6327781677246094  GigaBytes
Max Memory Allocated: 5.035490036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5188016891479492  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6129817962646484  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5197739601135254  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6179332733154297  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5222177505493164  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6275339126586914  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.522383689880371  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6269726753234863  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5195322036743164  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6189846992492676  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5188326835632324  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.613015651702881  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.522240161895752  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.623994827270508  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5171608924865723  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.611699104309082  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41216468811035156 |1.08758045732975 |0.004608854651451111 |0.00014056265354156494 |0.01228003203868866 |0.0012459754943847656 |
----------------------------------------------------------pseudo_mini_loss sum 5.059910774230957
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  74221830
Number of first layer input nodes during this epoch:  36082442
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.895298480987549  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6528987884521484
random selection method range initialization spend 0.011295795440673828
time for parepare:  0.36751794815063477
local_output_nid generation:  0.007264614105224609
local_in_edges_tensor generation:  0.03266286849975586
mini_batch_src_global generation:  0.026575565338134766
r_  generation:  0.41078829765319824
local_output_nid generation:  0.0073702335357666016
local_in_edges_tensor generation:  0.013661384582519531
mini_batch_src_global generation:  0.03525853157043457
r_  generation:  0.425844669342041
local_output_nid generation:  0.00734257698059082
local_in_edges_tensor generation:  0.01235342025756836
mini_batch_src_global generation:  0.0234832763671875
r_  generation:  0.4373605251312256
local_output_nid generation:  0.007167339324951172
local_in_edges_tensor generation:  0.009793281555175781
mini_batch_src_global generation:  0.02640986442565918
r_  generation:  0.4641842842102051
local_output_nid generation:  0.00718235969543457
local_in_edges_tensor generation:  0.01003885269165039
mini_batch_src_global generation:  0.029686689376831055
r_  generation:  0.5139651298522949
local_output_nid generation:  0.007361888885498047
local_in_edges_tensor generation:  0.0087890625
mini_batch_src_global generation:  0.03213381767272949
r_  generation:  0.5103955268859863
local_output_nid generation:  0.007328510284423828
local_in_edges_tensor generation:  0.0089874267578125
mini_batch_src_global generation:  0.032691240310668945
r_  generation:  0.5201723575592041
local_output_nid generation:  0.007393836975097656
local_in_edges_tensor generation:  0.00999593734741211
mini_batch_src_global generation:  0.03568148612976074
r_  generation:  0.5294384956359863
local_output_nid generation:  0.007140398025512695
local_in_edges_tensor generation:  0.011437177658081055
mini_batch_src_global generation:  0.03586745262145996
r_  generation:  0.5412194728851318
local_output_nid generation:  0.0071833133697509766
local_in_edges_tensor generation:  0.009009599685668945
mini_batch_src_global generation:  0.03683328628540039
r_  generation:  0.5529947280883789
local_output_nid generation:  0.007245540618896484
local_in_edges_tensor generation:  0.008979082107543945
mini_batch_src_global generation:  0.03900718688964844
r_  generation:  0.5385787487030029
local_output_nid generation:  0.007166385650634766
local_in_edges_tensor generation:  0.008997678756713867
mini_batch_src_global generation:  0.040342092514038086
r_  generation:  0.5448465347290039
local_output_nid generation:  0.007783412933349609
local_in_edges_tensor generation:  0.008792400360107422
mini_batch_src_global generation:  0.04064798355102539
r_  generation:  0.5655801296234131
local_output_nid generation:  0.011146306991577148
local_in_edges_tensor generation:  0.00892019271850586
mini_batch_src_global generation:  0.043671607971191406
r_  generation:  0.5646688938140869
local_output_nid generation:  0.0073299407958984375
local_in_edges_tensor generation:  0.008980274200439453
mini_batch_src_global generation:  0.04744768142700195
r_  generation:  0.5707876682281494
local_output_nid generation:  0.007310152053833008
local_in_edges_tensor generation:  0.008948326110839844
mini_batch_src_global generation:  0.04782843589782715
r_  generation:  0.5587151050567627
----------------------check_connections_block total spend ----------------------------- 10.946982383728027
generate_one_block  0.8876645565032959
generate_one_block  0.5297772884368896
generate_one_block  0.523388147354126
generate_one_block  0.5203366279602051
generate_one_block  0.524794340133667
generate_one_block  0.5120091438293457
generate_one_block  0.5094568729400635
generate_one_block  0.5217795372009277
generate_one_block  0.5159728527069092
generate_one_block  0.5177223682403564
generate_one_block  0.5348918437957764
generate_one_block  0.5414421558380127
generate_one_block  0.5345771312713623
generate_one_block  0.5345027446746826
generate_one_block  0.5204648971557617
generate_one_block  0.5160636901855469
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3167240619659424
gen group dst list time:  0.23301935195922852
time for parepare:  0.46208953857421875
local_output_nid generation:  0.19112873077392578
local_in_edges_tensor generation:  0.8680932521820068
mini_batch_src_global generation:  0.9307599067687988
r_  generation:  10.38267469406128
local_output_nid generation:  0.20262455940246582
local_in_edges_tensor generation:  0.923903226852417
mini_batch_src_global generation:  1.132789134979248
r_  generation:  10.912723302841187
local_output_nid generation:  0.2083146572113037
local_in_edges_tensor generation:  1.024118185043335
mini_batch_src_global generation:  1.1086597442626953
r_  generation:  10.932369709014893
local_output_nid generation:  0.19748735427856445
local_in_edges_tensor generation:  0.844552755355835
mini_batch_src_global generation:  1.170579433441162
r_  generation:  10.73602294921875
local_output_nid generation:  0.19255518913269043
local_in_edges_tensor generation:  0.7676494121551514
mini_batch_src_global generation:  1.245725154876709
r_  generation:  11.154905080795288
local_output_nid generation:  0.21007657051086426
local_in_edges_tensor generation:  0.7556431293487549
mini_batch_src_global generation:  1.146106481552124
r_  generation:  11.239144563674927
local_output_nid generation:  0.19757080078125
local_in_edges_tensor generation:  0.8364319801330566
mini_batch_src_global generation:  1.1527228355407715
r_  generation:  10.875098466873169
local_output_nid generation:  0.18374943733215332
local_in_edges_tensor generation:  0.7582759857177734
mini_batch_src_global generation:  1.3000411987304688
r_  generation:  10.896923303604126
local_output_nid generation:  0.19988036155700684
local_in_edges_tensor generation:  0.7631375789642334
mini_batch_src_global generation:  1.2177579402923584
r_  generation:  11.353216171264648
local_output_nid generation:  0.20620155334472656
local_in_edges_tensor generation:  0.8528275489807129
mini_batch_src_global generation:  1.1714863777160645
r_  generation:  11.196477174758911
local_output_nid generation:  0.19452905654907227
local_in_edges_tensor generation:  0.8498518466949463
mini_batch_src_global generation:  1.1890788078308105
r_  generation:  11.017299175262451
local_output_nid generation:  0.18496489524841309
local_in_edges_tensor generation:  0.8550071716308594
mini_batch_src_global generation:  1.2833986282348633
r_  generation:  10.864071607589722
local_output_nid generation:  0.19731831550598145
local_in_edges_tensor generation:  0.6578013896942139
mini_batch_src_global generation:  1.2148191928863525
r_  generation:  11.122074842453003
local_output_nid generation:  0.21631264686584473
local_in_edges_tensor generation:  0.8590924739837646
mini_batch_src_global generation:  1.192356824874878
r_  generation:  11.309342384338379
local_output_nid generation:  0.2056715488433838
local_in_edges_tensor generation:  0.8408267498016357
mini_batch_src_global generation:  1.1765129566192627
r_  generation:  10.904719114303589
local_output_nid generation:  0.19347667694091797
local_in_edges_tensor generation:  0.7646095752716064
mini_batch_src_global generation:  1.22629976272583
r_  generation:  10.96770977973938
----------------------check_connections_block total spend ----------------------------- 241.23651599884033
generate_one_block  15.562442064285278
generate_one_block  16.17474341392517
generate_one_block  15.490885734558105
generate_one_block  15.283895492553711
generate_one_block  15.054289817810059
generate_one_block  15.565004587173462
generate_one_block  15.518978357315063
generate_one_block  15.417699098587036
generate_one_block  14.904475688934326
generate_one_block  15.700752019882202
generate_one_block  15.558634757995605
generate_one_block  15.482707977294922
generate_one_block  15.26036262512207
generate_one_block  14.99519157409668
generate_one_block  15.468156576156616
generate_one_block  15.554359674453735
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.410163164138794
gen group dst list time:  1.1477575302124023
time for parepare:  0.46730732917785645
local_output_nid generation:  0.6496779918670654
local_in_edges_tensor generation:  1.8253264427185059
mini_batch_src_global generation:  1.9342892169952393
r_  generation:  23.781080961227417
local_output_nid generation:  0.682112455368042
local_in_edges_tensor generation:  1.8636481761932373
mini_batch_src_global generation:  2.6007039546966553
r_  generation:  24.411338806152344
local_output_nid generation:  0.6990616321563721
local_in_edges_tensor generation:  2.0727546215057373
mini_batch_src_global generation:  2.7789125442504883
r_  generation:  24.479646921157837
local_output_nid generation:  0.6745824813842773
local_in_edges_tensor generation:  1.8361234664916992
mini_batch_src_global generation:  2.753849506378174
r_  generation:  24.913357496261597
local_output_nid generation:  0.6783909797668457
local_in_edges_tensor generation:  1.8603241443634033
mini_batch_src_global generation:  2.7089741230010986
r_  generation:  24.833584308624268
local_output_nid generation:  0.7104651927947998
local_in_edges_tensor generation:  1.8499765396118164
mini_batch_src_global generation:  2.786534309387207
r_  generation:  24.986904621124268
local_output_nid generation:  0.6812841892242432
local_in_edges_tensor generation:  1.8671457767486572
mini_batch_src_global generation:  2.6662871837615967
r_  generation:  24.909276723861694
local_output_nid generation:  0.693946123123169
local_in_edges_tensor generation:  1.8180818557739258
mini_batch_src_global generation:  2.985915184020996
r_  generation:  24.704530239105225
local_output_nid generation:  0.707491397857666
local_in_edges_tensor generation:  1.8174149990081787
mini_batch_src_global generation:  2.637678384780884
r_  generation:  24.857473373413086
local_output_nid generation:  0.6840229034423828
local_in_edges_tensor generation:  1.8311972618103027
mini_batch_src_global generation:  2.944366931915283
r_  generation:  24.633225440979004
local_output_nid generation:  0.696906566619873
local_in_edges_tensor generation:  1.8518774509429932
mini_batch_src_global generation:  2.8586790561676025
r_  generation:  24.910630464553833
local_output_nid generation:  0.6854054927825928
local_in_edges_tensor generation:  1.8225452899932861
mini_batch_src_global generation:  2.7534568309783936
r_  generation:  24.90548062324524
local_output_nid generation:  0.6851644515991211
local_in_edges_tensor generation:  1.9063525199890137
mini_batch_src_global generation:  2.9798104763031006
r_  generation:  24.910109519958496
local_output_nid generation:  0.6870388984680176
local_in_edges_tensor generation:  3.842971086502075
mini_batch_src_global generation:  2.57797908782959
r_  generation:  25.03090500831604
local_output_nid generation:  0.6900935173034668
local_in_edges_tensor generation:  1.8251063823699951
mini_batch_src_global generation:  2.7603373527526855
r_  generation:  24.904273748397827
local_output_nid generation:  0.6988914012908936
local_in_edges_tensor generation:  1.9712209701538086
mini_batch_src_global generation:  2.989110231399536
r_  generation:  24.68068242073059
----------------------check_connections_block total spend ----------------------------- 554.3533391952515
generate_one_block  33.784656047821045
generate_one_block  33.80254364013672
generate_one_block  33.611594676971436
generate_one_block  33.67795729637146
generate_one_block  33.82102847099304
generate_one_block  34.40888714790344
generate_one_block  34.06688594818115
generate_one_block  34.85545015335083
generate_one_block  36.10691738128662
generate_one_block  36.73192286491394
generate_one_block  36.94262886047363
generate_one_block  36.92844080924988
generate_one_block  36.88396906852722
generate_one_block  36.73093366622925
generate_one_block  36.65866661071777
generate_one_block  36.75724744796753
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.895298480987549  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

connection checking time:  795.5898551940918
block generation total time  812.762309551239
average batch blocks generation time:  50.79764434695244
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5186009407043457  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6129751205444336  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5190515518188477  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.616623878479004  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.517930507659912  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6149706840515137  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5182743072509766  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6136131286621094  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5271811485290527  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6319780349731445  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5218420028686523  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.626476764678955  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5215997695922852  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6227364540100098  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5246491432189941  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6316609382629395  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.520491600036621  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6225361824035645  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.51792573928833  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6131296157836914  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.517418384552002  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6117324829101562  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5216889381408691  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6258983612060547  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5187273025512695  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.614564895629883  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5259580612182617  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6336216926574707  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.521456241607666  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6246423721313477  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5191693305969238  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6195521354675293  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4175667315721512 |0.9055296927690506 |0.003978043794631958 |0.00014030933380126953 |0.004264265298843384 |0.0012745857238769531 |
----------------------------------------------------------pseudo_mini_loss sum 3.67177152633667
Total (block generation + training)time/epoch 1701.6986691951752
Training time/epoch 1647904526.5668683
Training time without block to device /epoch 1647904512.0783932
Training time without total dataloading part /epoch 0.13539648056030273
load block tensor time/epoch 6.681067705154419
block to device time/epoch 14.48847508430481
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  74209201
Number of first layer input nodes during this epoch:  36074643
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.90101957321167  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.661386251449585
random selection method range initialization spend 0.012601613998413086
time for parepare:  0.35408496856689453
local_output_nid generation:  0.007136344909667969
local_in_edges_tensor generation:  0.040307044982910156
mini_batch_src_global generation:  0.029609203338623047
r_  generation:  0.3667917251586914
local_output_nid generation:  0.009749889373779297
local_in_edges_tensor generation:  0.013955354690551758
mini_batch_src_global generation:  0.03522205352783203
r_  generation:  0.41370344161987305
local_output_nid generation:  0.00897526741027832
local_in_edges_tensor generation:  0.014375925064086914
mini_batch_src_global generation:  0.02341628074645996
r_  generation:  0.4268960952758789
local_output_nid generation:  0.008427143096923828
local_in_edges_tensor generation:  0.014117956161499023
mini_batch_src_global generation:  0.02744293212890625
r_  generation:  0.46259140968322754
local_output_nid generation:  0.008542299270629883
local_in_edges_tensor generation:  0.020357370376586914
mini_batch_src_global generation:  0.029371023178100586
r_  generation:  0.4756453037261963
local_output_nid generation:  0.007467746734619141
local_in_edges_tensor generation:  0.015887022018432617
mini_batch_src_global generation:  0.03126835823059082
r_  generation:  0.4973134994506836
local_output_nid generation:  0.0072154998779296875
local_in_edges_tensor generation:  0.013959646224975586
mini_batch_src_global generation:  0.03235578536987305
r_  generation:  0.5070798397064209
local_output_nid generation:  0.007451534271240234
local_in_edges_tensor generation:  0.011284589767456055
mini_batch_src_global generation:  0.0337066650390625
r_  generation:  0.5187408924102783
local_output_nid generation:  0.007405757904052734
local_in_edges_tensor generation:  0.013838052749633789
mini_batch_src_global generation:  0.03624558448791504
r_  generation:  0.5412240028381348
local_output_nid generation:  0.0075836181640625
local_in_edges_tensor generation:  0.009997367858886719
mini_batch_src_global generation:  0.04453277587890625
r_  generation:  0.5711495876312256
local_output_nid generation:  0.007447004318237305
local_in_edges_tensor generation:  0.009540796279907227
mini_batch_src_global generation:  0.03742814064025879
r_  generation:  0.5371353626251221
local_output_nid generation:  0.007498741149902344
local_in_edges_tensor generation:  0.009429693222045898
mini_batch_src_global generation:  0.05165839195251465
r_  generation:  0.5330905914306641
local_output_nid generation:  0.0074825286865234375
local_in_edges_tensor generation:  0.00937199592590332
mini_batch_src_global generation:  0.04040694236755371
r_  generation:  0.5610568523406982
local_output_nid generation:  0.008126497268676758
local_in_edges_tensor generation:  0.03013753890991211
mini_batch_src_global generation:  0.04204893112182617
r_  generation:  0.5490872859954834
local_output_nid generation:  0.007539987564086914
local_in_edges_tensor generation:  0.021908283233642578
mini_batch_src_global generation:  0.04646015167236328
r_  generation:  0.5657618045806885
local_output_nid generation:  0.007494688034057617
local_in_edges_tensor generation:  0.015511274337768555
mini_batch_src_global generation:  0.04371500015258789
r_  generation:  0.5349907875061035
----------------------check_connections_block total spend ----------------------------- 10.846001148223877
generate_one_block  0.8884482383728027
generate_one_block  0.5303878784179688
generate_one_block  0.5237946510314941
generate_one_block  0.5168843269348145
generate_one_block  0.5185937881469727
generate_one_block  0.5137627124786377
generate_one_block  0.5158729553222656
generate_one_block  0.5241889953613281
generate_one_block  0.5361015796661377
generate_one_block  0.511254072189331
generate_one_block  0.5144455432891846
generate_one_block  0.5272486209869385
generate_one_block  0.5477824211120605
generate_one_block  0.5353124141693115
generate_one_block  0.5370776653289795
generate_one_block  0.5180160999298096
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.7050254344940186
gen group dst list time:  0.26841235160827637
time for parepare:  0.46028757095336914
local_output_nid generation:  0.18181705474853516
local_in_edges_tensor generation:  0.8910214900970459
mini_batch_src_global generation:  0.9238216876983643
r_  generation:  10.292753458023071
local_output_nid generation:  0.20661139488220215
local_in_edges_tensor generation:  0.8414552211761475
mini_batch_src_global generation:  1.187180995941162
r_  generation:  10.577203512191772
local_output_nid generation:  0.2057209014892578
local_in_edges_tensor generation:  0.863107442855835
mini_batch_src_global generation:  1.1649863719940186
r_  generation:  10.844483375549316
local_output_nid generation:  0.1954185962677002
local_in_edges_tensor generation:  0.8804581165313721
mini_batch_src_global generation:  1.1867132186889648
r_  generation:  10.778053522109985
local_output_nid generation:  0.18039965629577637
local_in_edges_tensor generation:  0.6699936389923096
mini_batch_src_global generation:  1.2479031085968018
r_  generation:  10.924513101577759
local_output_nid generation:  0.209733247756958
local_in_edges_tensor generation:  0.8576538562774658
mini_batch_src_global generation:  1.153550386428833
r_  generation:  11.02411937713623
local_output_nid generation:  0.18394041061401367
local_in_edges_tensor generation:  0.8639464378356934
mini_batch_src_global generation:  1.201413869857788
r_  generation:  10.725237607955933
local_output_nid generation:  0.1996920108795166
local_in_edges_tensor generation:  0.6706373691558838
mini_batch_src_global generation:  1.2120890617370605
r_  generation:  10.978863716125488
local_output_nid generation:  0.2118074893951416
local_in_edges_tensor generation:  0.8649904727935791
mini_batch_src_global generation:  1.1647868156433105
r_  generation:  11.04506802558899
local_output_nid generation:  0.16994619369506836
local_in_edges_tensor generation:  0.8583037853240967
mini_batch_src_global generation:  1.3000221252441406
r_  generation:  10.790219068527222
local_output_nid generation:  0.19168353080749512
local_in_edges_tensor generation:  0.6654903888702393
mini_batch_src_global generation:  1.231910228729248
r_  generation:  11.052341938018799
local_output_nid generation:  0.19466400146484375
local_in_edges_tensor generation:  0.8438048362731934
mini_batch_src_global generation:  1.1974818706512451
r_  generation:  11.163052320480347
local_output_nid generation:  0.18094468116760254
local_in_edges_tensor generation:  0.844653844833374
mini_batch_src_global generation:  1.2500059604644775
r_  generation:  10.841177463531494
local_output_nid generation:  0.19095993041992188
local_in_edges_tensor generation:  0.696906328201294
mini_batch_src_global generation:  1.2333853244781494
r_  generation:  11.026184558868408
local_output_nid generation:  0.2097475528717041
local_in_edges_tensor generation:  0.8585419654846191
mini_batch_src_global generation:  1.1810803413391113
r_  generation:  11.065619230270386
local_output_nid generation:  0.1765580177307129
local_in_edges_tensor generation:  0.848952054977417
mini_batch_src_global generation:  1.3028748035430908
r_  generation:  10.84778356552124
----------------------check_connections_block total spend ----------------------------- 239.33435368537903
generate_one_block  15.275771617889404
generate_one_block  15.980178594589233
generate_one_block  15.702052354812622
generate_one_block  15.592774391174316
generate_one_block  15.371573448181152
generate_one_block  14.907082557678223
generate_one_block  15.272134065628052
generate_one_block  15.590334177017212
generate_one_block  15.723471641540527
generate_one_block  15.582298517227173
generate_one_block  15.299042463302612
generate_one_block  15.200992107391357
generate_one_block  15.507176876068115
generate_one_block  15.553847551345825
generate_one_block  15.499661684036255
generate_one_block  15.350674867630005
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4530839920043945
gen group dst list time:  1.1078102588653564
time for parepare:  0.45738863945007324
local_output_nid generation:  0.609227180480957
local_in_edges_tensor generation:  1.800800085067749
mini_batch_src_global generation:  1.8965566158294678
r_  generation:  23.474765300750732
local_output_nid generation:  0.6682910919189453
local_in_edges_tensor generation:  1.9038946628570557
mini_batch_src_global generation:  2.735661268234253
r_  generation:  24.39034676551819
local_output_nid generation:  0.6932129859924316
local_in_edges_tensor generation:  2.115520715713501
mini_batch_src_global generation:  2.8304145336151123
r_  generation:  24.33995532989502
local_output_nid generation:  0.6942613124847412
local_in_edges_tensor generation:  1.8197102546691895
mini_batch_src_global generation:  2.816848039627075
r_  generation:  24.465452194213867
local_output_nid generation:  0.6878707408905029
local_in_edges_tensor generation:  1.9777240753173828
mini_batch_src_global generation:  2.859546422958374
r_  generation:  24.52326512336731
local_output_nid generation:  0.6839590072631836
local_in_edges_tensor generation:  1.8402063846588135
mini_batch_src_global generation:  2.8284595012664795
r_  generation:  24.569743633270264
local_output_nid generation:  0.6819515228271484
local_in_edges_tensor generation:  2.0166940689086914
mini_batch_src_global generation:  2.8797643184661865
r_  generation:  24.64165186882019
local_output_nid generation:  0.6933815479278564
local_in_edges_tensor generation:  1.835618019104004
mini_batch_src_global generation:  2.9182703495025635
r_  generation:  24.616767406463623
local_output_nid generation:  0.7004106044769287
local_in_edges_tensor generation:  1.8451757431030273
mini_batch_src_global generation:  2.8985884189605713
r_  generation:  24.657399892807007
local_output_nid generation:  0.6823081970214844
local_in_edges_tensor generation:  1.9148764610290527
mini_batch_src_global generation:  2.797222375869751
r_  generation:  24.576605081558228
local_output_nid generation:  0.6717302799224854
local_in_edges_tensor generation:  1.8826398849487305
mini_batch_src_global generation:  2.7020833492279053
r_  generation:  24.604732275009155
local_output_nid generation:  0.7169888019561768
local_in_edges_tensor generation:  1.927060604095459
mini_batch_src_global generation:  2.7847931385040283
r_  generation:  24.48994016647339
local_output_nid generation:  0.6681392192840576
local_in_edges_tensor generation:  1.8725337982177734
mini_batch_src_global generation:  2.6951634883880615
r_  generation:  24.712461709976196
local_output_nid generation:  0.6817684173583984
local_in_edges_tensor generation:  3.9394021034240723
mini_batch_src_global generation:  2.648545026779175
r_  generation:  24.71560001373291
local_output_nid generation:  0.6698884963989258
local_in_edges_tensor generation:  1.833709716796875
mini_batch_src_global generation:  2.702685594558716
r_  generation:  24.80936026573181
local_output_nid generation:  0.6759374141693115
local_in_edges_tensor generation:  1.850879192352295
mini_batch_src_global generation:  2.893176555633545
r_  generation:  24.70374035835266
----------------------check_connections_block total spend ----------------------------- 551.4375019073486
generate_one_block  33.66740369796753
generate_one_block  33.65879249572754
generate_one_block  33.74644184112549
generate_one_block  33.436585664749146
generate_one_block  33.48079538345337
generate_one_block  33.60136032104492
generate_one_block  33.60882091522217
generate_one_block  34.1486120223999
generate_one_block  33.7565758228302
generate_one_block  33.53931903839111
generate_one_block  33.52404165267944
generate_one_block  33.46823453903198
generate_one_block  33.908148527145386
generate_one_block  34.01996874809265
generate_one_block  33.97465682029724
generate_one_block  33.921873569488525
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.90101957321167  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

connection checking time:  790.7718555927277
block generation total time  786.8706979751587
average batch blocks generation time:  49.17941862344742
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5241217613220215  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6292080879211426  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5230002403259277  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.623429298400879  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5227651596069336  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.630471706390381  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5245752334594727  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6321792602539062  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.521378517150879  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.626567840576172  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5183477401733398  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6144585609436035  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5221028327941895  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6202282905578613  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5202980041503906  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6176681518554688  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.522904396057129  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6277403831481934  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5187044143676758  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6156005859375  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5226597785949707  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6292800903320312  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5225954055786133  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6244983673095703  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5195136070251465  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.616323947906494  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.51800537109375  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.615163803100586  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5224847793579102  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.624734401702881  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5180959701538086  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6146631240844727  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.443168044090271 |0.9534696340560913 |0.003976806998252869 |0.00014044344425201416 |0.004245132207870483 |0.001253366470336914 |
----------------------------------------------------------pseudo_mini_loss sum 3.104227066040039
Total (block generation + training)time/epoch 1686.861545085907
Training time/epoch 1647906198.5916517
Training time without block to device /epoch 1647906183.3361375
Training time without total dataloading part /epoch 0.13505148887634277
load block tensor time/epoch 7.090688705444336
block to device time/epoch 15.255514144897461
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  74228451
Number of first layer input nodes during this epoch:  36082107
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.8968305587768555  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6438577175140381
random selection method range initialization spend 0.012644052505493164
time for parepare:  0.3679347038269043
local_output_nid generation:  0.007058858871459961
local_in_edges_tensor generation:  0.03384542465209961
mini_batch_src_global generation:  0.029650449752807617
r_  generation:  0.3594784736633301
local_output_nid generation:  0.007450103759765625
local_in_edges_tensor generation:  0.013520002365112305
mini_batch_src_global generation:  0.03389692306518555
r_  generation:  0.40723586082458496
local_output_nid generation:  0.00721287727355957
local_in_edges_tensor generation:  0.009969234466552734
mini_batch_src_global generation:  0.02340102195739746
r_  generation:  0.42354440689086914
local_output_nid generation:  0.007191896438598633
local_in_edges_tensor generation:  0.015343189239501953
mini_batch_src_global generation:  0.02758646011352539
r_  generation:  0.45455408096313477
local_output_nid generation:  0.007341146469116211
local_in_edges_tensor generation:  0.009021759033203125
mini_batch_src_global generation:  0.028274059295654297
r_  generation:  0.47190070152282715
local_output_nid generation:  0.007400035858154297
local_in_edges_tensor generation:  0.011227607727050781
mini_batch_src_global generation:  0.032627105712890625
r_  generation:  0.49598002433776855
local_output_nid generation:  0.007317066192626953
local_in_edges_tensor generation:  0.009955883026123047
mini_batch_src_global generation:  0.03327369689941406
r_  generation:  0.5057802200317383
local_output_nid generation:  0.0072650909423828125
local_in_edges_tensor generation:  0.010170459747314453
mini_batch_src_global generation:  0.03328871726989746
r_  generation:  0.5095412731170654
local_output_nid generation:  0.007302522659301758
local_in_edges_tensor generation:  0.010156869888305664
mini_batch_src_global generation:  0.034819602966308594
r_  generation:  0.5131227970123291
local_output_nid generation:  0.0073947906494140625
local_in_edges_tensor generation:  0.009183406829833984
mini_batch_src_global generation:  0.04176735877990723
r_  generation:  0.51894211769104
local_output_nid generation:  0.007162809371948242
local_in_edges_tensor generation:  0.009071111679077148
mini_batch_src_global generation:  0.0377957820892334
r_  generation:  0.5242140293121338
local_output_nid generation:  0.007361650466918945
local_in_edges_tensor generation:  0.009113550186157227
mini_batch_src_global generation:  0.03883552551269531
r_  generation:  0.540820837020874
local_output_nid generation:  0.0073430538177490234
local_in_edges_tensor generation:  0.010328054428100586
mini_batch_src_global generation:  0.04170823097229004
r_  generation:  0.5322082042694092
local_output_nid generation:  0.007485151290893555
local_in_edges_tensor generation:  0.008969306945800781
mini_batch_src_global generation:  0.04127979278564453
r_  generation:  0.5308413505554199
local_output_nid generation:  0.00754547119140625
local_in_edges_tensor generation:  0.009034156799316406
mini_batch_src_global generation:  0.04361081123352051
r_  generation:  0.5311942100524902
local_output_nid generation:  0.007172822952270508
local_in_edges_tensor generation:  0.010188579559326172
mini_batch_src_global generation:  0.045004844665527344
r_  generation:  0.532933235168457
----------------------check_connections_block total spend ----------------------------- 10.470180749893188
generate_one_block  0.8736319541931152
generate_one_block  0.5307087898254395
generate_one_block  0.5121726989746094
generate_one_block  0.5101819038391113
generate_one_block  0.5174100399017334
generate_one_block  0.5167288780212402
generate_one_block  0.5817420482635498
generate_one_block  0.646273136138916
generate_one_block  0.6336779594421387
generate_one_block  0.5816023349761963
generate_one_block  0.5168802738189697
generate_one_block  0.512263298034668
generate_one_block  0.5288538932800293
generate_one_block  0.5156452655792236
generate_one_block  0.5171506404876709
generate_one_block  0.5156364440917969
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3414714336395264
gen group dst list time:  0.25002336502075195
time for parepare:  0.4284555912017822
local_output_nid generation:  0.1784372329711914
local_in_edges_tensor generation:  0.8068153858184814
mini_batch_src_global generation:  0.8856124877929688
r_  generation:  10.566493511199951
local_output_nid generation:  0.2100238800048828
local_in_edges_tensor generation:  0.8527731895446777
mini_batch_src_global generation:  1.1367778778076172
r_  generation:  10.844236850738525
local_output_nid generation:  0.19728946685791016
local_in_edges_tensor generation:  1.046722412109375
mini_batch_src_global generation:  1.157970905303955
r_  generation:  10.623506546020508
local_output_nid generation:  0.1882944107055664
local_in_edges_tensor generation:  0.6774358749389648
mini_batch_src_global generation:  1.1825523376464844
r_  generation:  10.901082992553711
local_output_nid generation:  0.21117925643920898
local_in_edges_tensor generation:  0.8559131622314453
mini_batch_src_global generation:  1.1700046062469482
r_  generation:  11.041172742843628
local_output_nid generation:  0.19661760330200195
local_in_edges_tensor generation:  0.860497236251831
mini_batch_src_global generation:  1.195951223373413
r_  generation:  10.843312740325928
local_output_nid generation:  0.18515443801879883
local_in_edges_tensor generation:  0.7360384464263916
mini_batch_src_global generation:  1.2496750354766846
r_  generation:  11.093863725662231
local_output_nid generation:  0.20683717727661133
local_in_edges_tensor generation:  0.8025248050689697
mini_batch_src_global generation:  1.1440765857696533
r_  generation:  11.070622205734253
local_output_nid generation:  0.19710230827331543
local_in_edges_tensor generation:  0.8329529762268066
mini_batch_src_global generation:  1.174098014831543
r_  generation:  10.805701732635498
local_output_nid generation:  0.1865217685699463
local_in_edges_tensor generation:  0.7184083461761475
mini_batch_src_global generation:  1.2177882194519043
r_  generation:  11.13171100616455
local_output_nid generation:  0.21825432777404785
local_in_edges_tensor generation:  0.8145713806152344
mini_batch_src_global generation:  1.1626017093658447
r_  generation:  11.175652503967285
local_output_nid generation:  0.19471096992492676
local_in_edges_tensor generation:  0.844721794128418
mini_batch_src_global generation:  1.18849778175354
r_  generation:  10.938266515731812
local_output_nid generation:  0.18460702896118164
local_in_edges_tensor generation:  0.7589399814605713
mini_batch_src_global generation:  1.2553796768188477
r_  generation:  11.086867094039917
local_output_nid generation:  0.20370793342590332
local_in_edges_tensor generation:  0.7470061779022217
mini_batch_src_global generation:  1.1662061214447021
r_  generation:  11.195196151733398
local_output_nid generation:  0.1944293975830078
local_in_edges_tensor generation:  0.8471736907958984
mini_batch_src_global generation:  1.1683313846588135
r_  generation:  10.961800575256348
local_output_nid generation:  0.18396759033203125
local_in_edges_tensor generation:  0.7249248027801514
mini_batch_src_global generation:  1.2359216213226318
r_  generation:  11.071549415588379
----------------------check_connections_block total spend ----------------------------- 239.90799283981323
generate_one_block  15.619433403015137
generate_one_block  16.198737382888794
generate_one_block  15.556321382522583
generate_one_block  15.516922235488892
generate_one_block  14.943999290466309
generate_one_block  15.512686967849731
generate_one_block  15.687808752059937
generate_one_block  15.578304052352905
generate_one_block  15.41686487197876
generate_one_block  15.235095977783203
generate_one_block  15.427694082260132
generate_one_block  15.518870115280151
generate_one_block  15.635457515716553
generate_one_block  15.47186279296875
generate_one_block  15.521166801452637
generate_one_block  15.384672164916992
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3746893405914307
gen group dst list time:  1.1716625690460205
time for parepare:  0.4787628650665283
local_output_nid generation:  0.6582317352294922
local_in_edges_tensor generation:  1.9075589179992676
mini_batch_src_global generation:  1.8679530620574951
r_  generation:  23.393118143081665
local_output_nid generation:  0.7049119472503662
local_in_edges_tensor generation:  1.9253079891204834
mini_batch_src_global generation:  2.708256483078003
r_  generation:  24.07542872428894
local_output_nid generation:  0.7203996181488037
local_in_edges_tensor generation:  2.0698604583740234
mini_batch_src_global generation:  2.6172358989715576
r_  generation:  24.31656002998352
local_output_nid generation:  0.6889958381652832
local_in_edges_tensor generation:  1.8974242210388184
mini_batch_src_global generation:  2.829641580581665
r_  generation:  24.35489273071289
local_output_nid generation:  0.69317626953125
local_in_edges_tensor generation:  1.8338184356689453
mini_batch_src_global generation:  2.635664463043213
r_  generation:  24.6114342212677
local_output_nid generation:  0.6898143291473389
local_in_edges_tensor generation:  1.8232877254486084
mini_batch_src_global generation:  2.8768718242645264
r_  generation:  24.61229395866394
local_output_nid generation:  0.6834442615509033
local_in_edges_tensor generation:  1.8354785442352295
mini_batch_src_global generation:  2.657824754714966
r_  generation:  24.818395376205444
local_output_nid generation:  0.6745254993438721
local_in_edges_tensor generation:  1.8893074989318848
mini_batch_src_global generation:  2.873079299926758
r_  generation:  24.453202486038208
local_output_nid generation:  0.695415735244751
local_in_edges_tensor generation:  1.8581857681274414
mini_batch_src_global generation:  2.747478485107422
r_  generation:  24.538451194763184
local_output_nid generation:  0.6844642162322998
local_in_edges_tensor generation:  2.0069620609283447
mini_batch_src_global generation:  2.9467906951904297
r_  generation:  24.469518184661865
local_output_nid generation:  0.6980290412902832
local_in_edges_tensor generation:  1.863685131072998
mini_batch_src_global generation:  2.724153995513916
r_  generation:  24.63183307647705
local_output_nid generation:  0.6950340270996094
local_in_edges_tensor generation:  1.8194589614868164
mini_batch_src_global generation:  2.9660022258758545
r_  generation:  24.466737747192383
local_output_nid generation:  0.671550989151001
local_in_edges_tensor generation:  1.8741941452026367
mini_batch_src_global generation:  2.85261607170105
r_  generation:  24.687776565551758
local_output_nid generation:  0.675126314163208
local_in_edges_tensor generation:  4.050265550613403
mini_batch_src_global generation:  2.5250744819641113
r_  generation:  24.50836205482483
local_output_nid generation:  0.701655387878418
local_in_edges_tensor generation:  1.8535032272338867
mini_batch_src_global generation:  2.933979034423828
r_  generation:  25.09129524230957
local_output_nid generation:  0.6848454475402832
local_in_edges_tensor generation:  1.8714406490325928
mini_batch_src_global generation:  2.796008825302124
r_  generation:  24.90536069869995
----------------------check_connections_block total spend ----------------------------- 551.5033574104309
generate_one_block  33.78368544578552
generate_one_block  33.5361053943634
generate_one_block  33.82329869270325
generate_one_block  34.00244998931885
generate_one_block  34.08661890029907
generate_one_block  35.39839434623718
generate_one_block  34.00010967254639
generate_one_block  34.702189683914185
generate_one_block  33.96495723724365
generate_one_block  34.35999035835266
generate_one_block  34.37268853187561
generate_one_block  34.37566804885864
generate_one_block  34.452234745025635
generate_one_block  34.66101813316345
generate_one_block  37.22483968734741
generate_one_block  36.987770318984985
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.8968305587768555  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

connection checking time:  791.4113502502441
block generation total time  801.9579169750214
average batch blocks generation time:  50.122369810938835
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5179343223571777  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.61862850189209  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.518312931060791  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.614687442779541  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5190167427062988  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6142663955688477  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5236830711364746  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.626828193664551  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5230917930603027  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6271309852600098  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5240588188171387  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6279544830322266  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5227108001708984  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6298513412475586  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.519559383392334  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.618697166442871  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5189485549926758  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6139392852783203  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5227618217468262  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6272830963134766  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5226430892944336  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.628026008605957  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5208864212036133  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6178503036499023  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5195808410644531  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6169233322143555  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.51723051071167  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.613109588623047  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5220732688903809  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6252031326293945  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.52266263961792  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6262354850769043  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.42198656499385834 |1.2851914018392563 |0.004022508859634399 |0.00014226138591766357 |0.004242375493049622 |0.0012516975402832031 |
----------------------------------------------------------pseudo_mini_loss sum 2.6624743938446045
Total (block generation + training)time/epoch 1688.5638311704
Training time/epoch 1647907890.560435
Training time without block to device /epoch 1647907869.9973726
Training time without total dataloading part /epoch 0.13576602935791016
load block tensor time/epoch 6.751785039901733
block to device time/epoch 20.5630624294281
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  74219741
Number of first layer input nodes during this epoch:  36080197
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.907210350036621  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6245028972625732
random selection method range initialization spend 0.012912988662719727
time for parepare:  0.3976893424987793
local_output_nid generation:  0.008106231689453125
local_in_edges_tensor generation:  0.039034128189086914
mini_batch_src_global generation:  0.026666641235351562
r_  generation:  0.36367225646972656
local_output_nid generation:  0.008253097534179688
local_in_edges_tensor generation:  0.014559268951416016
mini_batch_src_global generation:  0.03765368461608887
r_  generation:  0.41173291206359863
local_output_nid generation:  0.008242130279541016
local_in_edges_tensor generation:  0.011748552322387695
mini_batch_src_global generation:  0.02483963966369629
r_  generation:  0.43033790588378906
local_output_nid generation:  0.008327722549438477
local_in_edges_tensor generation:  0.010008573532104492
mini_batch_src_global generation:  0.025982379913330078
r_  generation:  0.45701169967651367
local_output_nid generation:  0.009162425994873047
local_in_edges_tensor generation:  0.02804398536682129
mini_batch_src_global generation:  0.0281827449798584
r_  generation:  0.48427796363830566
local_output_nid generation:  0.012527704238891602
local_in_edges_tensor generation:  0.02137446403503418
mini_batch_src_global generation:  0.03339958190917969
r_  generation:  0.5109801292419434
local_output_nid generation:  0.008360147476196289
local_in_edges_tensor generation:  0.0203399658203125
mini_batch_src_global generation:  0.03333568572998047
r_  generation:  0.536097526550293
local_output_nid generation:  0.008108854293823242
local_in_edges_tensor generation:  0.013436079025268555
mini_batch_src_global generation:  0.033377647399902344
r_  generation:  0.5091342926025391
local_output_nid generation:  0.008353233337402344
local_in_edges_tensor generation:  0.01383352279663086
mini_batch_src_global generation:  0.0483090877532959
r_  generation:  0.5649750232696533
local_output_nid generation:  0.00806570053100586
local_in_edges_tensor generation:  0.010640859603881836
mini_batch_src_global generation:  0.04408526420593262
r_  generation:  0.5430529117584229
local_output_nid generation:  0.015920162200927734
local_in_edges_tensor generation:  0.010556459426879883
mini_batch_src_global generation:  0.037749290466308594
r_  generation:  0.5390524864196777
local_output_nid generation:  0.00839853286743164
local_in_edges_tensor generation:  0.012259244918823242
mini_batch_src_global generation:  0.03898954391479492
r_  generation:  0.5551841259002686
local_output_nid generation:  0.012733221054077148
local_in_edges_tensor generation:  0.016963958740234375
mini_batch_src_global generation:  0.03977513313293457
r_  generation:  0.5424995422363281
local_output_nid generation:  0.00838017463684082
local_in_edges_tensor generation:  0.010726451873779297
mini_batch_src_global generation:  0.0465083122253418
r_  generation:  0.5770308971405029
local_output_nid generation:  0.012740373611450195
local_in_edges_tensor generation:  0.009902715682983398
mini_batch_src_global generation:  0.04190707206726074
r_  generation:  0.5301096439361572
local_output_nid generation:  0.0074350833892822266
local_in_edges_tensor generation:  0.012990236282348633
mini_batch_src_global generation:  0.041994333267211914
r_  generation:  0.5321717262268066
----------------------check_connections_block total spend ----------------------------- 10.932771682739258
generate_one_block  0.8932843208312988
generate_one_block  0.5339655876159668
generate_one_block  0.5178835391998291
generate_one_block  0.5113768577575684
generate_one_block  0.524012565612793
generate_one_block  0.5145390033721924
generate_one_block  0.5258133411407471
generate_one_block  0.5559055805206299
generate_one_block  0.5247185230255127
generate_one_block  0.5104827880859375
generate_one_block  0.518669605255127
generate_one_block  0.5461654663085938
generate_one_block  0.5600240230560303
generate_one_block  0.5208401679992676
generate_one_block  0.53291916847229
generate_one_block  0.5278265476226807
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.441410541534424
gen group dst list time:  0.2593400478363037
time for parepare:  0.4614574909210205
local_output_nid generation:  0.21218013763427734
local_in_edges_tensor generation:  0.8364245891571045
mini_batch_src_global generation:  0.8907454013824463
r_  generation:  10.32035517692566
local_output_nid generation:  0.18425321578979492
local_in_edges_tensor generation:  0.7931942939758301
mini_batch_src_global generation:  1.2457022666931152
r_  generation:  10.577439069747925
local_output_nid generation:  0.19004344940185547
local_in_edges_tensor generation:  0.8170416355133057
mini_batch_src_global generation:  1.1767773628234863
r_  generation:  10.930384159088135
local_output_nid generation:  0.19432663917541504
local_in_edges_tensor generation:  0.8374736309051514
mini_batch_src_global generation:  1.1371688842773438
r_  generation:  10.872600793838501
local_output_nid generation:  0.18454289436340332
local_in_edges_tensor generation:  0.7657852172851562
mini_batch_src_global generation:  1.2393736839294434
r_  generation:  10.914785861968994
local_output_nid generation:  0.1936802864074707
local_in_edges_tensor generation:  0.7506110668182373
mini_batch_src_global generation:  1.2199287414550781
r_  generation:  11.16594910621643
local_output_nid generation:  0.19331789016723633
local_in_edges_tensor generation:  0.8340744972229004
mini_batch_src_global generation:  1.1915063858032227
r_  generation:  11.065181016921997
local_output_nid generation:  0.1934342384338379
local_in_edges_tensor generation:  0.8494265079498291
mini_batch_src_global generation:  1.3219459056854248
r_  generation:  10.919119119644165
local_output_nid generation:  0.19336843490600586
local_in_edges_tensor generation:  0.6638193130493164
mini_batch_src_global generation:  1.2415390014648438
r_  generation:  11.103017330169678
local_output_nid generation:  0.21587133407592773
local_in_edges_tensor generation:  0.8602497577667236
mini_batch_src_global generation:  1.154862642288208
r_  generation:  11.29754114151001
local_output_nid generation:  0.19706034660339355
local_in_edges_tensor generation:  0.8596768379211426
mini_batch_src_global generation:  1.1839590072631836
r_  generation:  11.175548076629639
local_output_nid generation:  0.18397140502929688
local_in_edges_tensor generation:  0.8050177097320557
mini_batch_src_global generation:  1.4053022861480713
r_  generation:  10.95415711402893
local_output_nid generation:  0.19893169403076172
local_in_edges_tensor generation:  0.723588228225708
mini_batch_src_global generation:  1.256124496459961
r_  generation:  11.120352029800415
local_output_nid generation:  0.20448899269104004
local_in_edges_tensor generation:  0.891364336013794
mini_batch_src_global generation:  1.1815388202667236
r_  generation:  11.3565092086792
local_output_nid generation:  0.20866060256958008
local_in_edges_tensor generation:  0.8473865985870361
mini_batch_src_global generation:  1.1927073001861572
r_  generation:  10.974365711212158
local_output_nid generation:  0.18323540687561035
local_in_edges_tensor generation:  0.7665510177612305
mini_batch_src_global generation:  1.2193121910095215
r_  generation:  11.01587986946106
----------------------check_connections_block total spend ----------------------------- 241.22338485717773
generate_one_block  15.532712459564209
generate_one_block  16.220815181732178
generate_one_block  15.623733758926392
generate_one_block  15.461988925933838
generate_one_block  15.48534369468689
generate_one_block  15.039132356643677
generate_one_block  15.300939083099365
generate_one_block  15.59267520904541
generate_one_block  15.615264177322388
generate_one_block  15.86909008026123
generate_one_block  15.585263729095459
generate_one_block  15.524638652801514
generate_one_block  15.026704788208008
generate_one_block  15.393409252166748
generate_one_block  15.424255847930908
generate_one_block  15.49564266204834
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.263789176940918
gen group dst list time:  1.1485917568206787
time for parepare:  0.4887406826019287
local_output_nid generation:  0.6455333232879639
local_in_edges_tensor generation:  2.068729877471924
mini_batch_src_global generation:  1.9057385921478271
r_  generation:  23.389761447906494
local_output_nid generation:  0.7067909240722656
local_in_edges_tensor generation:  1.9201993942260742
mini_batch_src_global generation:  2.7586913108825684
r_  generation:  24.120979070663452
local_output_nid generation:  0.6898601055145264
local_in_edges_tensor generation:  2.0675811767578125
mini_batch_src_global generation:  2.80041241645813
r_  generation:  24.25953197479248
local_output_nid generation:  0.6755938529968262
local_in_edges_tensor generation:  1.9022431373596191
mini_batch_src_global generation:  2.6122162342071533
r_  generation:  24.438942909240723
local_output_nid generation:  0.6930787563323975
local_in_edges_tensor generation:  1.9524550437927246
mini_batch_src_global generation:  2.868342876434326
r_  generation:  24.501625061035156
local_output_nid generation:  0.7076475620269775
local_in_edges_tensor generation:  1.8645343780517578
mini_batch_src_global generation:  2.770923376083374
r_  generation:  24.322325229644775
local_output_nid generation:  0.6716430187225342
local_in_edges_tensor generation:  1.911804437637329
mini_batch_src_global generation:  2.8697078227996826
r_  generation:  24.52141571044922
local_output_nid generation:  0.671623706817627
local_in_edges_tensor generation:  1.854804277420044
mini_batch_src_global generation:  2.681436061859131
r_  generation:  24.35083842277527
local_output_nid generation:  0.6805667877197266
local_in_edges_tensor generation:  1.8521051406860352
mini_batch_src_global generation:  2.8985416889190674
r_  generation:  24.555495262145996
local_output_nid generation:  0.6990253925323486
local_in_edges_tensor generation:  1.8838777542114258
mini_batch_src_global generation:  2.7528111934661865
r_  generation:  24.336272478103638
local_output_nid generation:  0.7151339054107666
local_in_edges_tensor generation:  1.8968989849090576
mini_batch_src_global generation:  2.9015276432037354
r_  generation:  24.527546882629395
local_output_nid generation:  0.6840534210205078
local_in_edges_tensor generation:  1.8584067821502686
mini_batch_src_global generation:  2.9201784133911133
r_  generation:  24.5505313873291
local_output_nid generation:  0.6784570217132568
local_in_edges_tensor generation:  1.9163787364959717
mini_batch_src_global generation:  2.817969799041748
r_  generation:  24.523653268814087
local_output_nid generation:  0.6760852336883545
local_in_edges_tensor generation:  4.056426763534546
mini_batch_src_global generation:  2.612595558166504
r_  generation:  24.660956382751465
local_output_nid generation:  0.6696174144744873
local_in_edges_tensor generation:  1.9393541812896729
mini_batch_src_global generation:  2.8142576217651367
r_  generation:  24.66079354286194
local_output_nid generation:  0.6736915111541748
local_in_edges_tensor generation:  1.856252908706665
mini_batch_src_global generation:  2.9713077545166016
r_  generation:  24.904789686203003
----------------------check_connections_block total spend ----------------------------- 549.8319947719574
generate_one_block  33.67403173446655
generate_one_block  33.455206871032715
generate_one_block  33.70848345756531
generate_one_block  33.919957399368286
generate_one_block  33.95605945587158
generate_one_block  34.44446802139282
generate_one_block  35.5906662940979
generate_one_block  36.580422163009644
generate_one_block  35.9460928440094
generate_one_block  35.96138024330139
generate_one_block  36.262856245040894
generate_one_block  36.52868175506592
generate_one_block  36.87752079963684
generate_one_block  36.864776611328125
generate_one_block  36.49419069290161
generate_one_block  36.6034619808197
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 2.907210350036621  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

connection checking time:  791.0553796291351
block generation total time  815.0598664283752
average batch blocks generation time: Using backend: pytorch
 50.94124165177345
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.519338607788086  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.619784355163574  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5260825157165527  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6300487518310547  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5179810523986816  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6150007247924805  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.522017002105713  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6226367950439453  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5224461555480957  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.629055976867676  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5226926803588867  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6302499771118164  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5208988189697266  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.616616725921631  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.520442008972168  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.621011257171631  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5186667442321777  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6160387992858887  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.518857479095459  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.617410182952881  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.522843837738037  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6317667961120605  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5247783660888672  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6281228065490723  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5197815895080566  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6208415031433105  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5235576629638672  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6280975341796875  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5183825492858887  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6136841773986816  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 1.5190510749816895  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9285888671875 GB
    Memory Allocated: 3.6176843643188477  GigaBytes
Max Memory Allocated: 5.03810453414917  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41526561975479126 |1.204567775130272 |0.004332065582275391 |0.00014926493167877197 |0.00424996018409729 |0.0011985301971435547 |
----------------------------------------------------------pseudo_mini_loss sum 2.369581699371338
Total (block generation + training)time/epoch 1692.6235166788101
Training time/epoch 1647909595.3633168
Training time without block to device /epoch 1647909576.0902324
Training time without total dataloading part /epoch 0.1408991813659668
load block tensor time/epoch 6.64424991607666
block to device time/epoch 19.27308440208435
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  74224344
Number of first layer input nodes during this epoch:  36078843
