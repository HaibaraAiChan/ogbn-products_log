main start at this time 1647834077.5736682
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.670276403427124
random selection method range initialization spend 0.014241218566894531
time for parepare:  0.39057397842407227
local_output_nid generation:  0.014380455017089844
local_in_edges_tensor generation:  0.05491471290588379
mini_batch_src_global generation:  0.027435779571533203
r_  generation:  0.3903493881225586
local_output_nid generation:  0.010487556457519531
local_in_edges_tensor generation:  0.018888235092163086
mini_batch_src_global generation:  0.033196210861206055
r_  generation:  0.4054293632507324
local_output_nid generation:  0.010566234588623047
local_in_edges_tensor generation:  0.03000617027282715
mini_batch_src_global generation:  0.02408599853515625
r_  generation:  0.4321260452270508
local_output_nid generation:  0.01700735092163086
local_in_edges_tensor generation:  0.035640716552734375
mini_batch_src_global generation:  0.026356220245361328
r_  generation:  0.4800698757171631
local_output_nid generation:  0.008914470672607422
local_in_edges_tensor generation:  0.030591487884521484
mini_batch_src_global generation:  0.028098106384277344
r_  generation:  0.4898848533630371
local_output_nid generation:  0.019452333450317383
local_in_edges_tensor generation:  0.018097639083862305
mini_batch_src_global generation:  0.031301021575927734
r_  generation:  0.4961247444152832
local_output_nid generation:  0.007579326629638672
local_in_edges_tensor generation:  0.015174627304077148
mini_batch_src_global generation:  0.03270578384399414
r_  generation:  0.506676197052002
local_output_nid generation:  0.007559299468994141
local_in_edges_tensor generation:  0.011983633041381836
mini_batch_src_global generation:  0.03357124328613281
r_  generation:  0.5324873924255371
local_output_nid generation:  0.0075495243072509766
local_in_edges_tensor generation:  0.01165008544921875
mini_batch_src_global generation:  0.035083770751953125
r_  generation:  0.5381762981414795
local_output_nid generation:  0.0075016021728515625
local_in_edges_tensor generation:  0.011950254440307617
mini_batch_src_global generation:  0.03928518295288086
r_  generation:  0.5268847942352295
local_output_nid generation:  0.007439136505126953
local_in_edges_tensor generation:  0.009385824203491211
mini_batch_src_global generation:  0.03813767433166504
r_  generation:  0.5325713157653809
local_output_nid generation:  0.007512807846069336
local_in_edges_tensor generation:  0.00891423225402832
mini_batch_src_global generation:  0.03903007507324219
r_  generation:  0.5434470176696777
local_output_nid generation:  0.007522106170654297
local_in_edges_tensor generation:  0.025928974151611328
mini_batch_src_global generation:  0.04273200035095215
r_  generation:  0.5657212734222412
local_output_nid generation:  0.010910749435424805
local_in_edges_tensor generation:  0.019675254821777344
mini_batch_src_global generation:  0.041115760803222656
r_  generation:  0.5327949523925781
local_output_nid generation:  0.007220268249511719
local_in_edges_tensor generation:  0.015141963958740234
mini_batch_src_global generation:  0.042618751525878906
r_  generation:  0.530996561050415
local_output_nid generation:  0.007147073745727539
local_in_edges_tensor generation:  0.012547492980957031
mini_batch_src_global generation:  0.04199838638305664
r_  generation:  0.5408840179443359
----------------------check_connections_block total spend ----------------------------- 10.893742084503174
generate_one_block  6.456833362579346
generate_one_block  0.5060732364654541
generate_one_block  0.5269761085510254
generate_one_block  0.5022635459899902
generate_one_block  0.5188171863555908
generate_one_block  0.5082263946533203
generate_one_block  0.5115861892700195
generate_one_block  0.4996933937072754
generate_one_block  0.5057055950164795
generate_one_block  0.5112957954406738
generate_one_block  0.5274782180786133
generate_one_block  0.5127410888671875
generate_one_block  0.5031869411468506
generate_one_block  0.5093111991882324
generate_one_block  0.5134274959564209
generate_one_block  0.5013766288757324
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.527275323867798
gen group dst list time:  0.26681947708129883
time for parepare:  0.4707682132720947
local_output_nid generation:  0.16954660415649414
local_in_edges_tensor generation:  0.8145191669464111
mini_batch_src_global generation:  0.8905653953552246
r_  generation:  10.583895921707153
local_output_nid generation:  0.21242928504943848
local_in_edges_tensor generation:  0.8668818473815918
mini_batch_src_global generation:  1.2167940139770508
r_  generation:  10.429922580718994
local_output_nid generation:  0.19813942909240723
local_in_edges_tensor generation:  0.9914307594299316
mini_batch_src_global generation:  1.2096757888793945
r_  generation:  11.157292604446411
local_output_nid generation:  0.21418309211730957
local_in_edges_tensor generation:  0.8631529808044434
mini_batch_src_global generation:  1.3002760410308838
r_  generation:  11.089712142944336
local_output_nid generation:  0.20642638206481934
local_in_edges_tensor generation:  0.8625280857086182
mini_batch_src_global generation:  1.2259273529052734
r_  generation:  10.784891366958618
local_output_nid generation:  0.20296764373779297
local_in_edges_tensor generation:  0.8375763893127441
mini_batch_src_global generation:  1.191291332244873
r_  generation:  10.906996488571167
local_output_nid generation:  0.17210626602172852
local_in_edges_tensor generation:  0.8350160121917725
mini_batch_src_global generation:  1.1719279289245605
r_  generation:  10.809339046478271
local_output_nid generation:  0.19088029861450195
local_in_edges_tensor generation:  0.6589884757995605
mini_batch_src_global generation:  1.20322585105896
r_  generation:  10.867337226867676
local_output_nid generation:  0.20158720016479492
local_in_edges_tensor generation:  0.8316876888275146
mini_batch_src_global generation:  1.1471056938171387
r_  generation:  10.906496047973633
local_output_nid generation:  0.17026042938232422
local_in_edges_tensor generation:  0.6642701625823975
mini_batch_src_global generation:  1.3829658031463623
r_  generation:  11.360579013824463
local_output_nid generation:  0.2041304111480713
local_in_edges_tensor generation:  0.8400583267211914
mini_batch_src_global generation:  1.3383848667144775
r_  generation:  11.014316082000732
local_output_nid generation:  0.20155549049377441
local_in_edges_tensor generation:  0.8427326679229736
mini_batch_src_global generation:  1.1898622512817383
r_  generation:  11.118481636047363
local_output_nid generation:  0.17144012451171875
local_in_edges_tensor generation:  0.8102207183837891
mini_batch_src_global generation:  1.1629047393798828
r_  generation:  10.734256029129028
local_output_nid generation:  0.19108247756958008
local_in_edges_tensor generation:  0.6902868747711182
mini_batch_src_global generation:  1.184049367904663
r_  generation:  11.021138668060303
local_output_nid generation:  0.18208980560302734
local_in_edges_tensor generation:  0.843451738357544
mini_batch_src_global generation:  1.1673638820648193
r_  generation:  10.777070045471191
local_output_nid generation:  0.1814899444580078
local_in_edges_tensor generation:  0.6636426448822021
mini_batch_src_global generation:  1.2139077186584473
r_  generation:  10.964264392852783
----------------------check_connections_block total spend ----------------------------- 239.30799078941345
generate_one_block  15.77331805229187
generate_one_block  15.144493579864502
generate_one_block  14.876566648483276
generate_one_block  15.07722020149231
generate_one_block  15.019662618637085
generate_one_block  14.942925214767456
generate_one_block  15.244841814041138
generate_one_block  14.805487632751465
generate_one_block  15.321371078491211
generate_one_block  15.283058643341064
generate_one_block  14.804463148117065
generate_one_block  15.141728162765503
generate_one_block  15.159913539886475
generate_one_block  14.91826868057251
generate_one_block  15.151167392730713
generate_one_block  15.201329708099365
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.176778554916382
gen group dst list time:  1.0886802673339844
time for parepare:  0.4756491184234619
local_output_nid generation:  0.6636943817138672
local_in_edges_tensor generation:  1.5782113075256348
mini_batch_src_global generation:  1.1805784702301025
r_  generation:  15.93432068824768
local_output_nid generation:  0.6621744632720947
local_in_edges_tensor generation:  1.4248182773590088
mini_batch_src_global generation:  1.6898741722106934
r_  generation:  15.693499088287354
local_output_nid generation:  0.6686019897460938
local_in_edges_tensor generation:  1.3205547332763672
mini_batch_src_global generation:  1.5809097290039062
r_  generation:  15.875494718551636
local_output_nid generation:  0.6419064998626709
local_in_edges_tensor generation:  1.292395830154419
mini_batch_src_global generation:  1.6654503345489502
r_  generation:  15.966005802154541
local_output_nid generation:  0.6724541187286377
local_in_edges_tensor generation:  1.291940450668335
mini_batch_src_global generation:  1.6731963157653809
r_  generation:  16.10760474205017
local_output_nid generation:  0.6398611068725586
local_in_edges_tensor generation:  2.650057315826416
mini_batch_src_global generation:  1.5081660747528076
r_  generation:  15.86510181427002
local_output_nid generation:  0.6677584648132324
local_in_edges_tensor generation:  1.3092899322509766
mini_batch_src_global generation:  1.7270267009735107
r_  generation:  16.199831008911133
local_output_nid generation:  0.6684746742248535
local_in_edges_tensor generation:  1.294050931930542
mini_batch_src_global generation:  1.6717846393585205
r_  generation:  15.966575622558594
local_output_nid generation:  0.657942533493042
local_in_edges_tensor generation:  1.3025548458099365
mini_batch_src_global generation:  1.7408254146575928
r_  generation:  16.225619316101074
local_output_nid generation:  0.6711685657501221
local_in_edges_tensor generation:  1.2914574146270752
mini_batch_src_global generation:  1.6950883865356445
r_  generation:  16.06279158592224
local_output_nid generation:  0.669468879699707
local_in_edges_tensor generation:  1.3268647193908691
mini_batch_src_global generation:  1.7732012271881104
r_  generation:  16.15064549446106
local_output_nid generation:  0.6488814353942871
local_in_edges_tensor generation:  1.3075227737426758
mini_batch_src_global generation:  1.7132000923156738
r_  generation:  16.015772819519043
local_output_nid generation:  0.6583840847015381
local_in_edges_tensor generation:  1.3213269710540771
mini_batch_src_global generation:  1.7092161178588867
r_  generation:  16.205295085906982
local_output_nid generation:  0.6540932655334473
local_in_edges_tensor generation:  1.313993215560913
mini_batch_src_global generation:  1.7198662757873535
r_  generation:  16.10804319381714
local_output_nid generation:  0.6690101623535156
local_in_edges_tensor generation:  1.2980806827545166
mini_batch_src_global generation:  1.6693966388702393
r_  generation:  16.198809146881104
local_output_nid generation:  0.6496429443359375
local_in_edges_tensor generation:  1.3148541450500488
mini_batch_src_global generation:  1.7217283248901367
r_  generation:  16.071271896362305
----------------------check_connections_block total spend ----------------------------- 364.5966246128082
generate_one_block  21.568018913269043
generate_one_block  21.465970754623413
generate_one_block  21.36504054069519
generate_one_block  21.383665800094604
generate_one_block  21.630343198776245
generate_one_block  21.13936424255371
generate_one_block  22.53456687927246
generate_one_block  21.6506929397583
generate_one_block  21.362974643707275
generate_one_block  21.42401361465454
generate_one_block  21.472029447555542
generate_one_block  21.51848602294922
generate_one_block  21.465656042099
generate_one_block  21.496283292770386
generate_one_block  21.39653182029724
generate_one_block  21.7283296585083
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  603.9046154022217
block generation total time  586.4677839279175
average batch blocks generation time:  36.65423649549484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4305419921875 GB
    Memory Allocated: 1.326106071472168  GigaBytes
Max Memory Allocated: 1.326106071472168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3074951171875 GB
    Memory Allocated: 3.249634265899658  GigaBytes
Max Memory Allocated: 3.4887452125549316  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3280868530273438  GigaBytes
Max Memory Allocated: 4.022306442260742  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.250246524810791  GigaBytes
Max Memory Allocated: 4.022306442260742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.3271121978759766  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.246570587158203  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.3247928619384766  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.2377829551696777  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.328275203704834  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.2457642555236816  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.3283605575561523  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.251221179962158  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 1.3297157287597656  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 3.255059242248535  GigaBytes
Max Memory Allocated: 4.023458480834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3281283378601074  GigaBytes
Max Memory Allocated: 4.027826309204102  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2494049072265625  GigaBytes
Max Memory Allocated: 4.027826309204102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.327906608581543  GigaBytes
Max Memory Allocated: 4.027826309204102  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.247511386871338  GigaBytes
Max Memory Allocated: 4.027826309204102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3308005332946777  GigaBytes
Max Memory Allocated: 4.027826309204102  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2604575157165527  GigaBytes
Max Memory Allocated: 4.027826309204102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3284845352172852  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.252399444580078  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.32861328125  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2508182525634766  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3281316757202148  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2487940788269043  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3274755477905273  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.247041702270508  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3282413482666016  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2505412101745605  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.32855224609375  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2518539428710938  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37480035424232483 |0.5745652318000793 |0.04855111241340637 |0.00014494359493255615 |0.026129737496376038 |0.003509998321533203 |
----------------------------------------------------------pseudo_mini_loss sum 8.733633041381836
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  73593622
Number of first layer input nodes during this epoch:  35463382
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.354736804962158  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7175471782684326
random selection method range initialization spend 0.014491558074951172
time for parepare:  0.36166930198669434
local_output_nid generation:  0.006922721862792969
local_in_edges_tensor generation:  0.03732466697692871
mini_batch_src_global generation:  0.02807784080505371
r_  generation:  0.35298967361450195
local_output_nid generation:  0.007117033004760742
local_in_edges_tensor generation:  0.01596832275390625
mini_batch_src_global generation:  0.0342564582824707
r_  generation:  0.4011518955230713
local_output_nid generation:  0.007074594497680664
local_in_edges_tensor generation:  0.008829116821289062
mini_batch_src_global generation:  0.023224830627441406
r_  generation:  0.4321253299713135
local_output_nid generation:  0.007128477096557617
local_in_edges_tensor generation:  0.009034156799316406
mini_batch_src_global generation:  0.025831222534179688
r_  generation:  0.4411766529083252
local_output_nid generation:  0.007086038589477539
local_in_edges_tensor generation:  0.008888006210327148
mini_batch_src_global generation:  0.03202199935913086
r_  generation:  0.4808685779571533
local_output_nid generation:  0.007136344909667969
local_in_edges_tensor generation:  0.008766651153564453
mini_batch_src_global generation:  0.03065204620361328
r_  generation:  0.4966270923614502
local_output_nid generation:  0.007086753845214844
local_in_edges_tensor generation:  0.008615255355834961
mini_batch_src_global generation:  0.031937599182128906
r_  generation:  0.49829888343811035
local_output_nid generation:  0.007093191146850586
local_in_edges_tensor generation:  0.008986234664916992
mini_batch_src_global generation:  0.03303670883178711
r_  generation:  0.5113999843597412
local_output_nid generation:  0.0070917606353759766
local_in_edges_tensor generation:  0.00904226303100586
mini_batch_src_global generation:  0.03478527069091797
r_  generation:  0.513848066329956
local_output_nid generation:  0.007754802703857422
local_in_edges_tensor generation:  0.017806529998779297
mini_batch_src_global generation:  0.03558754920959473
r_  generation:  0.5275058746337891
local_output_nid generation:  0.007167339324951172
local_in_edges_tensor generation:  0.014623403549194336
mini_batch_src_global generation:  0.037804365158081055
r_  generation:  0.5157926082611084
local_output_nid generation:  0.007147073745727539
local_in_edges_tensor generation:  0.012183904647827148
mini_batch_src_global generation:  0.038903236389160156
r_  generation:  0.5203557014465332
local_output_nid generation:  0.007174491882324219
local_in_edges_tensor generation:  0.011058568954467773
mini_batch_src_global generation:  0.04627251625061035
r_  generation:  0.5311117172241211
local_output_nid generation:  0.008252859115600586
local_in_edges_tensor generation:  0.009939908981323242
mini_batch_src_global generation:  0.04059743881225586
r_  generation:  0.5189158916473389
local_output_nid generation:  0.0070648193359375
local_in_edges_tensor generation:  0.00959324836730957
mini_batch_src_global generation:  0.04213237762451172
r_  generation:  0.5317018032073975
local_output_nid generation:  0.00706791877746582
local_in_edges_tensor generation:  0.009285211563110352
mini_batch_src_global generation:  0.04236125946044922
r_  generation:  0.5410540103912354
----------------------check_connections_block total spend ----------------------------- 10.459805488586426
generate_one_block  0.8550496101379395
generate_one_block  0.536909818649292
generate_one_block  0.502652645111084
generate_one_block  0.5070998668670654
generate_one_block  0.5133881568908691
generate_one_block  0.4976310729980469
generate_one_block  0.5008828639984131
generate_one_block  0.5075929164886475
generate_one_block  0.5002789497375488
generate_one_block  0.49939799308776855
generate_one_block  0.5100870132446289
generate_one_block  0.49489665031433105
generate_one_block  0.5041742324829102
generate_one_block  0.5123817920684814
generate_one_block  0.5097181797027588
generate_one_block  0.5056126117706299
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.438575029373169
gen group dst list time:  0.2490246295928955
time for parepare:  0.481891393661499
local_output_nid generation:  0.17089438438415527
local_in_edges_tensor generation:  0.7869706153869629
mini_batch_src_global generation:  0.9091582298278809
r_  generation:  10.535019636154175
local_output_nid generation:  0.214066743850708
local_in_edges_tensor generation:  0.8588912487030029
mini_batch_src_global generation:  1.1633851528167725
r_  generation:  11.15627670288086
local_output_nid generation:  0.20439410209655762
local_in_edges_tensor generation:  1.0350115299224854
mini_batch_src_global generation:  1.260725736618042
r_  generation:  10.820000410079956
local_output_nid generation:  0.20263457298278809
local_in_edges_tensor generation:  0.869037389755249
mini_batch_src_global generation:  1.18115234375
r_  generation:  11.02445650100708
local_output_nid generation:  0.20402956008911133
local_in_edges_tensor generation:  0.6699955463409424
mini_batch_src_global generation:  1.1374461650848389
r_  generation:  11.075347423553467
local_output_nid generation:  0.17340707778930664
local_in_edges_tensor generation:  0.849860668182373
mini_batch_src_global generation:  1.2417376041412354
r_  generation:  10.834032773971558
local_output_nid generation:  0.1931908130645752
local_in_edges_tensor generation:  0.8507261276245117
mini_batch_src_global generation:  1.305851697921753
r_  generation:  11.683218240737915
local_output_nid generation:  0.20505714416503906
local_in_edges_tensor generation:  0.857598066329956
mini_batch_src_global generation:  1.5936558246612549
r_  generation:  10.945416688919067
local_output_nid generation:  0.19500470161437988
local_in_edges_tensor generation:  0.8468313217163086
mini_batch_src_global generation:  1.22548246383667
r_  generation:  10.988700866699219
local_output_nid generation:  0.20993900299072266
local_in_edges_tensor generation:  0.6816425323486328
mini_batch_src_global generation:  1.2036266326904297
r_  generation:  11.247620582580566
local_output_nid generation:  0.20471668243408203
local_in_edges_tensor generation:  0.8467922210693359
mini_batch_src_global generation:  1.1725804805755615
r_  generation:  10.989056587219238
local_output_nid generation:  0.17877435684204102
local_in_edges_tensor generation:  0.853874921798706
mini_batch_src_global generation:  1.282261610031128
r_  generation:  10.940901517868042
local_output_nid generation:  0.20696210861206055
local_in_edges_tensor generation:  0.8553390502929688
mini_batch_src_global generation:  1.2178409099578857
r_  generation:  11.24473786354065
local_output_nid generation:  0.20420479774475098
local_in_edges_tensor generation:  0.6679236888885498
mini_batch_src_global generation:  1.1625897884368896
r_  generation:  11.013534784317017
local_output_nid generation:  0.17878293991088867
local_in_edges_tensor generation:  0.8796253204345703
mini_batch_src_global generation:  1.2656726837158203
r_  generation:  10.94339108467102
local_output_nid generation:  0.19515538215637207
local_in_edges_tensor generation:  0.8494973182678223
mini_batch_src_global generation:  1.166914939880371
r_  generation:  10.956212520599365
----------------------check_connections_block total spend ----------------------------- 242.5169699192047
generate_one_block  15.52176833152771
generate_one_block  16.011581897735596
generate_one_block  15.298735618591309
generate_one_block  15.444286346435547
generate_one_block  15.49325704574585
generate_one_block  15.440082550048828
generate_one_block  15.357302904129028
generate_one_block  15.420931816101074
generate_one_block  15.370517492294312
generate_one_block  15.693759679794312
generate_one_block  15.511340141296387
generate_one_block  15.41236400604248
generate_one_block  15.443091630935669
generate_one_block  15.246999502182007
generate_one_block  15.35375165939331
generate_one_block  15.575801372528076
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1737399101257324
gen group dst list time:  1.1357507705688477
time for parepare:  0.49234795570373535
local_output_nid generation:  0.6444175243377686
local_in_edges_tensor generation:  1.3738622665405273
mini_batch_src_global generation:  1.1729190349578857
r_  generation:  15.68959903717041
local_output_nid generation:  0.682218074798584
local_in_edges_tensor generation:  1.3754572868347168
mini_batch_src_global generation:  1.6472656726837158
r_  generation:  16.448650121688843
local_output_nid generation:  0.6948456764221191
local_in_edges_tensor generation:  1.5097382068634033
mini_batch_src_global generation:  1.5508785247802734
r_  generation:  16.13133454322815
local_output_nid generation:  0.6613209247589111
local_in_edges_tensor generation:  1.2964789867401123
mini_batch_src_global generation:  1.6110484600067139
r_  generation:  16.189109325408936
local_output_nid generation:  0.6740012168884277
local_in_edges_tensor generation:  1.2894647121429443
mini_batch_src_global generation:  1.5314197540283203
r_  generation:  16.40794348716736
local_output_nid generation:  0.661454439163208
local_in_edges_tensor generation:  1.2997589111328125
mini_batch_src_global generation:  1.6228821277618408
r_  generation:  16.416608333587646
local_output_nid generation:  0.6767396926879883
local_in_edges_tensor generation:  1.3020639419555664
mini_batch_src_global generation:  1.5696406364440918
r_  generation:  16.57426118850708
local_output_nid generation:  0.6781556606292725
local_in_edges_tensor generation:  1.3184258937835693
mini_batch_src_global generation:  1.5843069553375244
r_  generation:  16.45838189125061
local_output_nid generation:  0.687375545501709
local_in_edges_tensor generation:  1.3088297843933105
mini_batch_src_global generation:  1.5561091899871826
r_  generation:  16.644497394561768
local_output_nid generation:  0.6592621803283691
local_in_edges_tensor generation:  1.3367607593536377
mini_batch_src_global generation:  1.5730657577514648
r_  generation:  16.387782096862793
local_output_nid generation:  0.670936107635498
local_in_edges_tensor generation:  1.3257341384887695
mini_batch_src_global generation:  1.5662965774536133
r_  generation:  16.658281087875366
local_output_nid generation:  0.6663329601287842
local_in_edges_tensor generation:  1.3263087272644043
mini_batch_src_global generation:  1.5719177722930908
r_  generation:  16.42882800102234
local_output_nid generation:  0.6643853187561035
local_in_edges_tensor generation:  1.3310630321502686
mini_batch_src_global generation:  1.5542371273040771
r_  generation:  16.580721139907837
local_output_nid generation:  0.6534557342529297
local_in_edges_tensor generation:  3.0055434703826904
mini_batch_src_global generation:  1.5376434326171875
r_  generation:  16.266493320465088
local_output_nid generation:  0.6643819808959961
local_in_edges_tensor generation:  1.3170289993286133
mini_batch_src_global generation:  1.567969560623169
r_  generation:  16.454052448272705
local_output_nid generation:  0.652230978012085
local_in_edges_tensor generation:  1.3119730949401855
mini_batch_src_global generation:  1.5915703773498535
r_  generation:  16.26206922531128
----------------------check_connections_block total spend ----------------------------- 369.2901976108551
generate_one_block  22.080276489257812
generate_one_block  21.685858249664307
generate_one_block  21.691575527191162
generate_one_block  21.99538803100586
generate_one_block  21.680910348892212
generate_one_block  21.730462551116943
generate_one_block  21.750622749328613
generate_one_block  22.38298773765564
generate_one_block  21.66505527496338
generate_one_block  21.911548614501953
generate_one_block  21.745068311691284
generate_one_block  21.696810007095337
generate_one_block  21.782838344573975
generate_one_block  21.712948322296143
generate_one_block  21.709091901779175
generate_one_block  21.80524253845215
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.354736804962158  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

connection checking time:  611.8071675300598
block generation total time  596.6222569942474
average batch blocks generation time:  37.288891062140465
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.32881498336792  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2519278526306152  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.329084873199463  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.252021312713623  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3274784088134766  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.250265121459961  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3283333778381348  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.253610610961914  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3287639617919922  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2480883598327637  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3283805847167969  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2510805130004883  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3291821479797363  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2490530014038086  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.33024263381958  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.259279727935791  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3276996612548828  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2465271949768066  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3287124633789062  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.252223014831543  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3300600051879883  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2528862953186035  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3288688659667969  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2544450759887695  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3277263641357422  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2495784759521484  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.327226161956787  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2437691688537598  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3285598754882812  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2499070167541504  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3256988525390625  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2406058311462402  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37524281442165375 |0.46491050720214844 |0.0036907345056533813 |0.00013813376426696777 |0.013379395008087158 |0.0014960765838623047 |
----------------------------------------------------------pseudo_mini_loss sum 5.088729381561279
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  73597626
Number of first layer input nodes during this epoch:  35463274
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.347686290740967  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5729904174804688
random selection method range initialization spend 0.014353275299072266
time for parepare:  0.38580775260925293
local_output_nid generation:  0.006981611251831055
local_in_edges_tensor generation:  0.03385043144226074
mini_batch_src_global generation:  0.034973859786987305
r_  generation:  0.3715498447418213
local_output_nid generation:  0.0071582794189453125
local_in_edges_tensor generation:  0.018500804901123047
mini_batch_src_global generation:  0.0359346866607666
r_  generation:  0.4232914447784424
local_output_nid generation:  0.007091522216796875
local_in_edges_tensor generation:  0.012531757354736328
mini_batch_src_global generation:  0.0233457088470459
r_  generation:  0.4446108341217041
local_output_nid generation:  0.007486820220947266
local_in_edges_tensor generation:  0.010155916213989258
mini_batch_src_global generation:  0.026004552841186523
r_  generation:  0.463287353515625
local_output_nid generation:  0.007169961929321289
local_in_edges_tensor generation:  0.013886213302612305
mini_batch_src_global generation:  0.030768156051635742
r_  generation:  0.48885631561279297
local_output_nid generation:  0.007173061370849609
local_in_edges_tensor generation:  0.009148836135864258
mini_batch_src_global generation:  0.03154778480529785
r_  generation:  0.5268039703369141
local_output_nid generation:  0.007817745208740234
local_in_edges_tensor generation:  0.009202957153320312
mini_batch_src_global generation:  0.032235145568847656
r_  generation:  0.5184082984924316
local_output_nid generation:  0.007187843322753906
local_in_edges_tensor generation:  0.009279966354370117
mini_batch_src_global generation:  0.03872513771057129
r_  generation:  0.5515329837799072
local_output_nid generation:  0.011702299118041992
local_in_edges_tensor generation:  0.012504100799560547
mini_batch_src_global generation:  0.03622245788574219
r_  generation:  0.5433986186981201
local_output_nid generation:  0.00860452651977539
local_in_edges_tensor generation:  0.0105438232421875
mini_batch_src_global generation:  0.03650164604187012
r_  generation:  0.5224497318267822
local_output_nid generation:  0.007569789886474609
local_in_edges_tensor generation:  0.009638071060180664
mini_batch_src_global generation:  0.03899097442626953
r_  generation:  0.5324192047119141
local_output_nid generation:  0.007216930389404297
local_in_edges_tensor generation:  0.010272979736328125
mini_batch_src_global generation:  0.039255619049072266
r_  generation:  0.5344772338867188
local_output_nid generation:  0.007251739501953125
local_in_edges_tensor generation:  0.010884523391723633
mini_batch_src_global generation:  0.041936635971069336
r_  generation:  0.5289783477783203
local_output_nid generation:  0.007236957550048828
local_in_edges_tensor generation:  0.011184453964233398
mini_batch_src_global generation:  0.0444033145904541
r_  generation:  0.5401113033294678
local_output_nid generation:  0.007253408432006836
local_in_edges_tensor generation:  0.010684013366699219
mini_batch_src_global generation:  0.04299783706665039
r_  generation:  0.5370655059814453
local_output_nid generation:  0.007203340530395508
local_in_edges_tensor generation:  0.01958465576171875
mini_batch_src_global generation:  0.041841983795166016
r_  generation:  0.5438814163208008
----------------------check_connections_block total spend ----------------------------- 10.794944524765015
generate_one_block  0.8825132846832275
generate_one_block  0.5425336360931396
generate_one_block  0.5207254886627197
generate_one_block  0.527878999710083
generate_one_block  0.5348048210144043
generate_one_block  0.520831823348999
generate_one_block  0.5107920169830322
generate_one_block  0.536064624786377
generate_one_block  0.5223495960235596
generate_one_block  0.5169668197631836
generate_one_block  0.5290727615356445
generate_one_block  0.5229697227478027
generate_one_block  0.6674115657806396
generate_one_block  0.7458963394165039
generate_one_block  0.6172819137573242
generate_one_block  0.5260953903198242
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5028364658355713
gen group dst list time:  0.25844287872314453
time for parepare:  0.455794095993042
local_output_nid generation:  0.17912650108337402
local_in_edges_tensor generation:  0.7636246681213379
mini_batch_src_global generation:  0.9152371883392334
r_  generation:  10.474538564682007
local_output_nid generation:  0.20650458335876465
local_in_edges_tensor generation:  0.868304967880249
mini_batch_src_global generation:  1.1222290992736816
r_  generation:  10.823673486709595
local_output_nid generation:  0.19435739517211914
local_in_edges_tensor generation:  1.0128860473632812
mini_batch_src_global generation:  1.1192307472229004
r_  generation:  10.554211854934692
local_output_nid generation:  0.18133234977722168
local_in_edges_tensor generation:  0.8142869472503662
mini_batch_src_global generation:  1.3001251220703125
r_  generation:  10.542424440383911
local_output_nid generation:  0.1933581829071045
local_in_edges_tensor generation:  0.7442214488983154
mini_batch_src_global generation:  1.1552045345306396
r_  generation:  11.122205972671509
local_output_nid generation:  0.19822907447814941
local_in_edges_tensor generation:  0.8515348434448242
mini_batch_src_global generation:  1.1948461532592773
r_  generation:  10.69498324394226
local_output_nid generation:  0.18446874618530273
local_in_edges_tensor generation:  0.6690154075622559
mini_batch_src_global generation:  1.2389931678771973
r_  generation:  11.034231424331665
local_output_nid generation:  0.19709396362304688
local_in_edges_tensor generation:  0.8532869815826416
mini_batch_src_global generation:  1.1599128246307373
r_  generation:  10.858255386352539
local_output_nid generation:  0.18389010429382324
local_in_edges_tensor generation:  0.7823870182037354
mini_batch_src_global generation:  1.3130319118499756
r_  generation:  10.781179189682007
local_output_nid generation:  0.1950690746307373
local_in_edges_tensor generation:  0.7376067638397217
mini_batch_src_global generation:  1.1767516136169434
r_  generation:  11.18967866897583
local_output_nid generation:  0.1968703269958496
local_in_edges_tensor generation:  0.8434009552001953
mini_batch_src_global generation:  1.1651999950408936
r_  generation:  10.811783075332642
local_output_nid generation:  0.18624067306518555
local_in_edges_tensor generation:  0.6760482788085938
mini_batch_src_global generation:  1.2151670455932617
r_  generation:  11.044119358062744
local_output_nid generation:  0.2081155776977539
local_in_edges_tensor generation:  0.8601078987121582
mini_batch_src_global generation:  1.1631510257720947
r_  generation:  11.13554072380066
local_output_nid generation:  0.1971759796142578
local_in_edges_tensor generation:  0.8712007999420166
mini_batch_src_global generation:  1.2151775360107422
r_  generation:  10.834357261657715
local_output_nid generation:  0.18434548377990723
local_in_edges_tensor generation:  0.6689949035644531
mini_batch_src_global generation:  1.2179994583129883
r_  generation:  11.187349796295166
local_output_nid generation:  0.19741415977478027
local_in_edges_tensor generation:  0.8447761535644531
mini_batch_src_global generation:  1.1672096252441406
r_  generation:  10.938714027404785
----------------------check_connections_block total spend ----------------------------- 238.60482573509216
generate_one_block  15.405631065368652
generate_one_block  16.105632305145264
generate_one_block  15.349587678909302
generate_one_block  15.134353637695312
generate_one_block  15.259844303131104
generate_one_block  15.484471082687378
generate_one_block  15.190066814422607
generate_one_block  15.185123205184937
generate_one_block  15.5545334815979
generate_one_block  15.468315124511719
generate_one_block  14.96947693824768
generate_one_block  15.523776054382324
generate_one_block  15.174940586090088
generate_one_block  15.0926833152771
generate_one_block  15.566844940185547
generate_one_block  15.410152912139893
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2562103271484375
gen group dst list time:  1.1157219409942627
time for parepare:  0.4813411235809326
local_output_nid generation:  0.641456127166748
local_in_edges_tensor generation:  1.4008877277374268
mini_batch_src_global generation:  1.1682217121124268
r_  generation:  15.612703800201416
local_output_nid generation:  0.7049429416656494
local_in_edges_tensor generation:  1.365314245223999
mini_batch_src_global generation:  1.773758888244629
r_  generation:  15.533002376556396
local_output_nid generation:  0.6715378761291504
local_in_edges_tensor generation:  1.5096676349639893
mini_batch_src_global generation:  1.6767852306365967
r_  generation:  15.810951232910156
local_output_nid generation:  0.6636097431182861
local_in_edges_tensor generation:  1.305044174194336
mini_batch_src_global generation:  1.6776142120361328
r_  generation:  16.001194715499878
local_output_nid generation:  0.6802947521209717
local_in_edges_tensor generation:  1.2954061031341553
mini_batch_src_global generation:  1.5949711799621582
r_  generation:  16.17461323738098
local_output_nid generation:  0.6775636672973633
local_in_edges_tensor generation:  1.3060026168823242
mini_batch_src_global generation:  1.6065762042999268
r_  generation:  16.115835666656494
local_output_nid generation:  0.6910865306854248
local_in_edges_tensor generation:  1.2982182502746582
mini_batch_src_global generation:  1.5868322849273682
r_  generation:  16.318011045455933
local_output_nid generation:  0.6722111701965332
local_in_edges_tensor generation:  1.304065227508545
mini_batch_src_global generation:  1.5887336730957031
r_  generation:  16.181186199188232
local_output_nid generation:  0.6856164932250977
local_in_edges_tensor generation:  1.2878520488739014
mini_batch_src_global generation:  1.5806763172149658
r_  generation:  16.345667123794556
local_output_nid generation:  0.6755123138427734
local_in_edges_tensor generation:  1.2786924839019775
mini_batch_src_global generation:  1.567763090133667
r_  generation:  16.208799123764038
local_output_nid generation:  0.6731023788452148
local_in_edges_tensor generation:  1.2821698188781738
mini_batch_src_global generation:  1.562504529953003
r_  generation:  16.41233491897583
local_output_nid generation:  0.6848194599151611
local_in_edges_tensor generation:  1.2883141040802002
mini_batch_src_global generation:  1.576270341873169
r_  generation:  16.3297917842865
local_output_nid generation:  0.6809277534484863
local_in_edges_tensor generation:  1.2983243465423584
mini_batch_src_global generation:  1.6583397388458252
r_  generation:  16.72663927078247
local_output_nid generation:  0.6893994808197021
local_in_edges_tensor generation:  3.287250280380249
mini_batch_src_global generation:  1.5459644794464111
r_  generation:  16.42225193977356
local_output_nid generation:  0.6989965438842773
local_in_edges_tensor generation:  1.3038978576660156
mini_batch_src_global generation:  1.5936698913574219
r_  generation:  16.689635276794434
local_output_nid generation:  0.6856110095977783
local_in_edges_tensor generation:  1.3032007217407227
mini_batch_src_global generation:  1.578876256942749
r_  generation:  16.338624477386475
----------------------check_connections_block total spend ----------------------------- 366.072642326355
generate_one_block  21.78115487098694
generate_one_block  21.69724726676941
generate_one_block  21.60350513458252
generate_one_block  21.56423830986023
generate_one_block  21.611260890960693
generate_one_block  21.597841501235962
generate_one_block  21.93329095840454
generate_one_block  22.383260250091553
generate_one_block  21.805632829666138
generate_one_block  21.758023262023926
generate_one_block  21.799083948135376
generate_one_block  21.918962478637695
generate_one_block  21.838577270507812
generate_one_block  21.87835669517517
generate_one_block  21.84539031982422
generate_one_block  21.837040185928345
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.347686290740967  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

connection checking time:  604.6774680614471
block generation total time  594.7282996177673
average batch blocks generation time:  37.17051872611046
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3282995223999023  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2466020584106445  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3282194137573242  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2490487098693848  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3267264366149902  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2469382286071777  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3263750076293945  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2420334815979004  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3324894905090332  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.257783889770508  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3284168243408203  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2509632110595703  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.327824592590332  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.249002456665039  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3296804428100586  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.255189895629883  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3290929794311523  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2519240379333496  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3273835182189941  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.246119976043701  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3266000747680664  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2442612648010254  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328460693359375  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.255727767944336  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3275508880615234  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2459774017333984  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.33152437210083  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.263202667236328  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328291893005371  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.253965377807617  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3267650604248047  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2479958534240723  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3921312242746353 |0.6390709578990936 |0.0037759989500045776 |0.0001395195722579956 |0.0049138665199279785 |0.0017175674438476562 |
----------------------------------------------------------pseudo_mini_loss sum 3.6935338973999023
Total (block generation + training)time/epoch 1277.308244228363
Training time/epoch 1647837955.155508
Training time without block to device /epoch 1647837944.9303727
Training time without total dataloading part /epoch 0.14298772811889648
load block tensor time/epoch 6.274099588394165
block to device time/epoch 10.225135326385498
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  73597803
Number of first layer input nodes during this epoch:  35459387
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.3516154289245605  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7526476383209229
random selection method range initialization spend 0.014546632766723633
time for parepare:  0.3766608238220215
local_output_nid generation:  0.0071408748626708984
local_in_edges_tensor generation:  0.04303240776062012
mini_batch_src_global generation:  0.031039953231811523
r_  generation:  0.38540148735046387
local_output_nid generation:  0.007227420806884766
local_in_edges_tensor generation:  0.01435399055480957
mini_batch_src_global generation:  0.037508249282836914
r_  generation:  0.4107024669647217
local_output_nid generation:  0.010097503662109375
local_in_edges_tensor generation:  0.012166023254394531
mini_batch_src_global generation:  0.026354074478149414
r_  generation:  0.4503159523010254
local_output_nid generation:  0.0075724124908447266
local_in_edges_tensor generation:  0.011785268783569336
mini_batch_src_global generation:  0.026118040084838867
r_  generation:  0.4800755977630615
local_output_nid generation:  0.0071866512298583984
local_in_edges_tensor generation:  0.010729074478149414
mini_batch_src_global generation:  0.029031753540039062
r_  generation:  0.5067024230957031
local_output_nid generation:  0.008455276489257812
local_in_edges_tensor generation:  0.009613037109375
mini_batch_src_global generation:  0.0310513973236084
r_  generation:  0.5012226104736328
local_output_nid generation:  0.007230997085571289
local_in_edges_tensor generation:  0.010642051696777344
mini_batch_src_global generation:  0.03578019142150879
r_  generation:  0.5370323657989502
local_output_nid generation:  0.008026123046875
local_in_edges_tensor generation:  0.010552406311035156
mini_batch_src_global generation:  0.03499889373779297
r_  generation:  0.5248544216156006
local_output_nid generation:  0.007305145263671875
local_in_edges_tensor generation:  0.011579275131225586
mini_batch_src_global generation:  0.040799856185913086
r_  generation:  0.5386126041412354
local_output_nid generation:  0.007306098937988281
local_in_edges_tensor generation:  0.01451420783996582
mini_batch_src_global generation:  0.03666877746582031
r_  generation:  0.5372159481048584
local_output_nid generation:  0.00734400749206543
local_in_edges_tensor generation:  0.016999244689941406
mini_batch_src_global generation:  0.04175925254821777
r_  generation:  0.5466575622558594
local_output_nid generation:  0.008928537368774414
local_in_edges_tensor generation:  0.01529550552368164
mini_batch_src_global generation:  0.03962087631225586
r_  generation:  0.528130292892456
local_output_nid generation:  0.007338762283325195
local_in_edges_tensor generation:  0.014683961868286133
mini_batch_src_global generation:  0.041821956634521484
r_  generation:  0.5577421188354492
local_output_nid generation:  0.0073359012603759766
local_in_edges_tensor generation:  0.011341333389282227
mini_batch_src_global generation:  0.0406796932220459
r_  generation:  0.5293633937835693
local_output_nid generation:  0.0073392391204833984
local_in_edges_tensor generation:  0.011701822280883789
mini_batch_src_global generation:  0.04435086250305176
r_  generation:  0.5431027412414551
local_output_nid generation:  0.007261037826538086
local_in_edges_tensor generation:  0.010107755661010742
mini_batch_src_global generation:  0.04171156883239746
r_  generation:  0.5354843139648438
----------------------check_connections_block total spend ----------------------------- 10.915590047836304
generate_one_block  0.8904616832733154
generate_one_block  0.5333969593048096
generate_one_block  0.5287859439849854
generate_one_block  0.5220954418182373
generate_one_block  0.5216467380523682
generate_one_block  0.5148296356201172
generate_one_block  0.5313055515289307
generate_one_block  0.5370543003082275
generate_one_block  0.5272197723388672
generate_one_block  0.5263245105743408
generate_one_block  0.532219409942627
generate_one_block  0.518275260925293
generate_one_block  0.5308420658111572
generate_one_block  0.5315780639648438
generate_one_block  0.5270559787750244
generate_one_block  0.7031047344207764
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5188002586364746
gen group dst list time:  0.2522621154785156
time for parepare:  0.4452707767486572
local_output_nid generation:  0.18203258514404297
local_in_edges_tensor generation:  0.8122231960296631
mini_batch_src_global generation:  0.9082839488983154
r_  generation:  10.53705358505249
local_output_nid generation:  0.2081451416015625
local_in_edges_tensor generation:  0.8719940185546875
mini_batch_src_global generation:  1.1460132598876953
r_  generation:  10.876888513565063
local_output_nid generation:  0.19662261009216309
local_in_edges_tensor generation:  1.0357000827789307
mini_batch_src_global generation:  1.121356725692749
r_  generation:  10.760437726974487
local_output_nid generation:  0.18399882316589355
local_in_edges_tensor generation:  0.722419261932373
mini_batch_src_global generation:  1.1639201641082764
r_  generation:  10.893186330795288
local_output_nid generation:  0.20531463623046875
local_in_edges_tensor generation:  0.8261682987213135
mini_batch_src_global generation:  1.1453893184661865
r_  generation:  11.148365497589111
local_output_nid generation:  0.17237210273742676
local_in_edges_tensor generation:  0.862640380859375
mini_batch_src_global generation:  1.2306861877441406
r_  generation:  10.718369007110596
local_output_nid generation:  0.2037363052368164
local_in_edges_tensor generation:  0.669403076171875
mini_batch_src_global generation:  1.21822190284729
r_  generation:  11.012303113937378
local_output_nid generation:  0.19554424285888672
local_in_edges_tensor generation:  0.8456048965454102
mini_batch_src_global generation:  1.1649742126464844
r_  generation:  10.938858270645142
local_output_nid generation:  0.1867389678955078
local_in_edges_tensor generation:  0.7635986804962158
mini_batch_src_global generation:  1.2783634662628174
r_  generation:  10.993839025497437
local_output_nid generation:  0.20473504066467285
local_in_edges_tensor generation:  0.7529261112213135
mini_batch_src_global generation:  1.2134623527526855
r_  generation:  11.182905435562134
local_output_nid generation:  0.1765131950378418
local_in_edges_tensor generation:  0.8515844345092773
mini_batch_src_global generation:  1.2159292697906494
r_  generation:  10.782318353652954
local_output_nid generation:  0.19600605964660645
local_in_edges_tensor generation:  0.6795830726623535
mini_batch_src_global generation:  1.2252943515777588
r_  generation:  11.153064727783203
local_output_nid generation:  0.19625329971313477
local_in_edges_tensor generation:  0.8428306579589844
mini_batch_src_global generation:  1.1648190021514893
r_  generation:  10.960328340530396
local_output_nid generation:  0.19039440155029297
local_in_edges_tensor generation:  0.752406120300293
mini_batch_src_global generation:  1.2621963024139404
r_  generation:  10.759526252746582
local_output_nid generation:  0.19689631462097168
local_in_edges_tensor generation:  0.7605814933776855
mini_batch_src_global generation:  1.2288870811462402
r_  generation:  11.155488729476929
local_output_nid generation:  0.19403433799743652
local_in_edges_tensor generation:  0.8505115509033203
mini_batch_src_global generation:  1.1784746646881104
r_  generation:  10.888812780380249
----------------------check_connections_block total spend ----------------------------- 239.74020957946777
generate_one_block  15.23136568069458
generate_one_block  16.10381841659546
generate_one_block  15.495483875274658
generate_one_block  15.427765130996704
generate_one_block  14.92585039138794
generate_one_block  15.413312673568726
generate_one_block  15.261571168899536
generate_one_block  14.787617921829224
generate_one_block  15.658782482147217
generate_one_block  15.655102491378784
generate_one_block  15.342460632324219
generate_one_block  14.936542749404907
generate_one_block  15.600932121276855
generate_one_block  15.357888460159302
generate_one_block  15.108217716217041
generate_one_block  15.146419048309326
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.217904567718506
gen group dst list time:  1.0984516143798828
time for parepare:  0.5018336772918701
local_output_nid generation:  0.6630475521087646
local_in_edges_tensor generation:  1.4149117469787598
mini_batch_src_global generation:  1.1700117588043213
r_  generation:  15.535794973373413
local_output_nid generation:  0.6669397354125977
local_in_edges_tensor generation:  1.3511624336242676
mini_batch_src_global generation:  1.6672322750091553
r_  generation:  15.94368290901184
local_output_nid generation:  0.6769008636474609
local_in_edges_tensor generation:  1.4057176113128662
mini_batch_src_global generation:  1.5843758583068848
r_  generation:  15.897604942321777
local_output_nid generation:  0.6598501205444336
local_in_edges_tensor generation:  1.280928373336792
mini_batch_src_global generation:  1.7100143432617188
r_  generation:  15.908386468887329
local_output_nid generation:  0.6619296073913574
local_in_edges_tensor generation:  1.2373600006103516
mini_batch_src_global generation:  1.7320547103881836
r_  generation:  16.385941982269287
local_output_nid generation:  0.6638584136962891
local_in_edges_tensor generation:  1.3327746391296387
mini_batch_src_global generation:  1.747720718383789
r_  generation:  16.392674922943115
local_output_nid generation:  0.6684894561767578
local_in_edges_tensor generation:  1.307692050933838
mini_batch_src_global generation:  1.6259276866912842
r_  generation:  16.197672843933105
local_output_nid generation:  0.6623380184173584
local_in_edges_tensor generation:  1.2864582538604736
mini_batch_src_global generation:  1.7235708236694336
r_  generation:  16.141945123672485
local_output_nid generation:  0.6642868518829346
local_in_edges_tensor generation:  1.2908825874328613
mini_batch_src_global generation:  1.6460280418395996
r_  generation:  16.24207043647766
local_output_nid generation:  0.6618549823760986
local_in_edges_tensor generation:  1.287982702255249
mini_batch_src_global generation:  1.7348341941833496
r_  generation:  16.175323247909546
local_output_nid generation:  0.671661376953125
local_in_edges_tensor generation:  1.2898619174957275
mini_batch_src_global generation:  1.6592702865600586
r_  generation:  16.34609055519104
local_output_nid generation:  0.673778772354126
local_in_edges_tensor generation:  1.3038051128387451
mini_batch_src_global generation:  1.6394813060760498
r_  generation:  16.12255096435547
local_output_nid generation:  0.6783425807952881
local_in_edges_tensor generation:  1.2257747650146484
mini_batch_src_global generation:  1.8506789207458496
r_  generation:  16.481578588485718
local_output_nid generation:  0.6641190052032471
local_in_edges_tensor generation:  3.2558798789978027
mini_batch_src_global generation:  1.7118659019470215
r_  generation:  16.906902074813843
local_output_nid generation:  0.7173337936401367
local_in_edges_tensor generation:  1.314995527267456
mini_batch_src_global generation:  1.648496389389038
r_  generation:  16.453694820404053
local_output_nid generation:  0.7158708572387695
local_in_edges_tensor generation:  1.3223235607147217
mini_batch_src_global generation:  1.6015393733978271
r_  generation:  16.356680631637573
----------------------check_connections_block total spend ----------------------------- 368.0812804698944
generate_one_block  21.927032947540283
generate_one_block  22.196069955825806
generate_one_block  21.857990026474
generate_one_block  21.85180115699768
generate_one_block  21.8100643157959
generate_one_block  21.801572561264038
generate_one_block  21.844650983810425
generate_one_block  22.357068300247192
generate_one_block  21.919476985931396
generate_one_block  21.984192848205566
generate_one_block  22.05306625366211
generate_one_block  21.972198247909546
generate_one_block  21.831626176834106
generate_one_block  21.868325233459473
generate_one_block  22.173877954483032
generate_one_block  21.910354375839233
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.3516154289245605  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

connection checking time:  607.8214900493622
block generation total time  596.8124992847443
average batch blocks generation time:  37.300781205296516
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328658103942871  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.250986099243164  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328080654144287  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.24973726272583  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.329117774963379  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2576956748962402  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3312654495239258  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.256474018096924  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3278260231018066  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2519102096557617  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.327589988708496  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2468619346618652  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3274359703063965  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.245643138885498  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.329117774963379  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2500381469726562  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.331820011138916  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.258443832397461  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.329394817352295  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.249333381652832  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3296542167663574  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2561583518981934  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3291187286376953  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2536635398864746  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3287334442138672  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2487239837646484  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3275537490844727  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2473645210266113  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.329312801361084  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.252124309539795  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3273329734802246  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2455554008483887  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3947288990020752 |0.46467629075050354 |0.003726392984390259 |0.00013825297355651855 |0.004903629422187805 |0.0026557445526123047 |
----------------------------------------------------------pseudo_mini_loss sum 3.090024709701538
Total (block generation + training)time/epoch 1278.507268190384
Training time/epoch 1647839234.8621686
Training time without block to device /epoch 1647839227.427348
Training time without total dataloading part /epoch 0.14294815063476562
load block tensor time/epoch 6.315662384033203
block to device time/epoch 7.434820652008057
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  73615979
Number of first layer input nodes during this epoch:  35468367
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.3495335578918457  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5543689727783203
random selection method range initialization spend 0.014518260955810547
time for parepare:  0.376878023147583
local_output_nid generation:  0.007096290588378906
local_in_edges_tensor generation:  0.03653669357299805
mini_batch_src_global generation:  0.030274629592895508
r_  generation:  0.36831235885620117
local_output_nid generation:  0.00730443000793457
local_in_edges_tensor generation:  0.013794183731079102
mini_batch_src_global generation:  0.03498697280883789
r_  generation:  0.42302441596984863
local_output_nid generation:  0.007146120071411133
local_in_edges_tensor generation:  0.010047674179077148
mini_batch_src_global generation:  0.023401498794555664
r_  generation:  0.42880773544311523
local_output_nid generation:  0.007262229919433594
local_in_edges_tensor generation:  0.013808012008666992
mini_batch_src_global generation:  0.02755570411682129
r_  generation:  0.46862196922302246
local_output_nid generation:  0.00721430778503418
local_in_edges_tensor generation:  0.009230613708496094
mini_batch_src_global generation:  0.028296470642089844
r_  generation:  0.6651687622070312
local_output_nid generation:  0.0073282718658447266
local_in_edges_tensor generation:  0.00892496109008789
mini_batch_src_global generation:  0.03570818901062012
r_  generation:  0.5121524333953857
local_output_nid generation:  0.007156848907470703
local_in_edges_tensor generation:  0.01196742057800293
mini_batch_src_global generation:  0.03565168380737305
r_  generation:  0.5125775337219238
local_output_nid generation:  0.007165193557739258
local_in_edges_tensor generation:  0.009925603866577148
mini_batch_src_global generation:  0.03565835952758789
r_  generation:  0.5329580307006836
local_output_nid generation:  0.007250308990478516
local_in_edges_tensor generation:  0.008908748626708984
mini_batch_src_global generation:  0.037187814712524414
r_  generation:  0.5293850898742676
local_output_nid generation:  0.007155895233154297
local_in_edges_tensor generation:  0.012628793716430664
mini_batch_src_global generation:  0.0375363826751709
r_  generation:  0.529167890548706
local_output_nid generation:  0.007182121276855469
local_in_edges_tensor generation:  0.008964061737060547
mini_batch_src_global generation:  0.03815269470214844
r_  generation:  0.7263712882995605
local_output_nid generation:  0.008441686630249023
local_in_edges_tensor generation:  0.008830785751342773
mini_batch_src_global generation:  0.03958415985107422
r_  generation:  0.5549566745758057
local_output_nid generation:  0.007523775100708008
local_in_edges_tensor generation:  0.010260820388793945
mini_batch_src_global generation:  0.05113410949707031
r_  generation:  0.5398430824279785
local_output_nid generation:  0.00725555419921875
local_in_edges_tensor generation:  0.010046720504760742
mini_batch_src_global generation:  0.041193485260009766
r_  generation:  0.5492229461669922
local_output_nid generation:  0.007193326950073242
local_in_edges_tensor generation:  0.010508298873901367
mini_batch_src_global generation:  0.04313850402832031
r_  generation:  0.5596418380737305
local_output_nid generation:  0.00813746452331543
local_in_edges_tensor generation:  0.01103830337524414
mini_batch_src_global generation:  0.04260110855102539
r_  generation:  0.5562739372253418
----------------------check_connections_block total spend ----------------------------- 11.150952100753784
generate_one_block  0.9197635650634766
generate_one_block  0.5500714778900146
generate_one_block  0.517552375793457
generate_one_block  0.5174052715301514
generate_one_block  0.5400390625
generate_one_block  0.5174672603607178
generate_one_block  0.5189931392669678
generate_one_block  0.5126307010650635
generate_one_block  0.5221858024597168
generate_one_block  0.5226690769195557
generate_one_block  0.5188469886779785
generate_one_block  0.5109608173370361
generate_one_block  0.533336877822876
generate_one_block  0.5296792984008789
generate_one_block  0.5229029655456543
generate_one_block  0.5284774303436279
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.630411148071289
gen group dst list time:  0.24565911293029785
time for parepare:  0.46559596061706543
local_output_nid generation:  0.17809295654296875
local_in_edges_tensor generation:  0.9663703441619873
mini_batch_src_global generation:  0.9217145442962646
r_  generation:  10.270326137542725
local_output_nid generation:  0.19678997993469238
local_in_edges_tensor generation:  0.6742105484008789
mini_batch_src_global generation:  1.2087273597717285
r_  generation:  10.682616949081421
local_output_nid generation:  0.20281600952148438
local_in_edges_tensor generation:  0.9313228130340576
mini_batch_src_global generation:  1.1308841705322266
r_  generation:  10.682900428771973
local_output_nid generation:  0.17469310760498047
local_in_edges_tensor generation:  0.9559905529022217
mini_batch_src_global generation:  1.4099299907684326
r_  generation:  11.427390336990356
local_output_nid generation:  0.19507980346679688
local_in_edges_tensor generation:  0.7789132595062256
mini_batch_src_global generation:  1.7879149913787842
r_  generation:  11.084834814071655
local_output_nid generation:  0.2036588191986084
local_in_edges_tensor generation:  0.7787678241729736
mini_batch_src_global generation:  1.226294755935669
r_  generation:  11.174130201339722
local_output_nid generation:  0.19746875762939453
local_in_edges_tensor generation:  0.8513801097869873
mini_batch_src_global generation:  1.1746954917907715
r_  generation:  10.888288021087646
local_output_nid generation:  0.18243169784545898
local_in_edges_tensor generation:  0.6629512310028076
mini_batch_src_global generation:  1.2074286937713623
r_  generation:  11.010555982589722
local_output_nid generation:  0.20307111740112305
local_in_edges_tensor generation:  0.8566820621490479
mini_batch_src_global generation:  1.1705327033996582
r_  generation:  10.966419458389282
local_output_nid generation:  0.17304611206054688
local_in_edges_tensor generation:  0.8703212738037109
mini_batch_src_global generation:  1.3405015468597412
r_  generation:  10.842524766921997
local_output_nid generation:  0.2027149200439453
local_in_edges_tensor generation:  0.6762325763702393
mini_batch_src_global generation:  1.1971886157989502
r_  generation:  11.184690475463867
local_output_nid generation:  0.19528436660766602
local_in_edges_tensor generation:  0.8475091457366943
mini_batch_src_global generation:  1.1815874576568604
r_  generation:  10.848476886749268
local_output_nid generation:  0.18062424659729004
local_in_edges_tensor generation:  0.6627905368804932
mini_batch_src_global generation:  1.2468187808990479
r_  generation:  10.964154720306396
local_output_nid generation:  0.20658612251281738
local_in_edges_tensor generation:  0.854365348815918
mini_batch_src_global generation:  1.1774964332580566
r_  generation:  11.086930274963379
local_output_nid generation:  0.171677827835083
local_in_edges_tensor generation:  0.8846774101257324
mini_batch_src_global generation:  1.1953322887420654
r_  generation:  10.8226318359375
local_output_nid generation:  0.1977384090423584
local_in_edges_tensor generation:  0.666252851486206
mini_batch_src_global generation:  1.23158860206604
r_  generation:  11.157248973846436
----------------------check_connections_block total spend ----------------------------- 240.9847342967987
generate_one_block  15.63712215423584
generate_one_block  15.775109052658081
generate_one_block  14.882240533828735
generate_one_block  15.456162452697754
generate_one_block  15.323806524276733
generate_one_block  15.013004064559937
generate_one_block  15.564208269119263
generate_one_block  15.285213470458984
generate_one_block  14.938567399978638
generate_one_block  15.82162857055664
generate_one_block  15.42077088356018
generate_one_block  14.919195652008057
generate_one_block  15.54312014579773
generate_one_block  15.359924077987671
generate_one_block  14.91847825050354
generate_one_block  15.422847270965576
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2005887031555176
gen group dst list time:  1.06782865524292
time for parepare:  0.4599943161010742
local_output_nid generation:  0.6351773738861084
local_in_edges_tensor generation:  1.358093500137329
mini_batch_src_global generation:  1.1776492595672607
r_  generation:  15.5216224193573
local_output_nid generation:  0.6564068794250488
local_in_edges_tensor generation:  1.4790196418762207
mini_batch_src_global generation:  1.5176208019256592
r_  generation:  16.04766321182251
local_output_nid generation:  0.6739060878753662
local_in_edges_tensor generation:  1.2924764156341553
mini_batch_src_global generation:  1.5238542556762695
r_  generation:  16.217550039291382
local_output_nid generation:  0.6888086795806885
local_in_edges_tensor generation:  1.3062078952789307
mini_batch_src_global generation:  1.6112713813781738
r_  generation:  16.221387147903442
local_output_nid generation:  0.6642546653747559
local_in_edges_tensor generation:  1.3328697681427002
mini_batch_src_global generation:  1.6215052604675293
r_  generation:  16.253166913986206
local_output_nid generation:  0.6594111919403076
local_in_edges_tensor generation:  1.3029201030731201
mini_batch_src_global generation:  1.8067893981933594
r_  generation:  16.333410263061523
local_output_nid generation:  0.6681766510009766
local_in_edges_tensor generation:  1.3304593563079834
mini_batch_src_global generation:  1.6870293617248535
r_  generation:  16.36590337753296
local_output_nid generation:  0.6619212627410889
local_in_edges_tensor generation:  1.3042237758636475
mini_batch_src_global generation:  1.7998976707458496
r_  generation:  16.34925889968872
local_output_nid generation:  0.6706657409667969
local_in_edges_tensor generation:  1.351417064666748
mini_batch_src_global generation:  1.6425933837890625
r_  generation:  16.46648144721985
local_output_nid generation:  0.6650264263153076
local_in_edges_tensor generation:  1.3266608715057373
mini_batch_src_global generation:  1.7535085678100586
r_  generation:  16.35098886489868
local_output_nid generation:  0.6699764728546143
local_in_edges_tensor generation:  1.326357126235962
mini_batch_src_global generation:  1.6440675258636475
r_  generation:  16.514767169952393
local_output_nid generation:  0.6601250171661377
local_in_edges_tensor generation:  1.3121583461761475
mini_batch_src_global generation:  1.7652485370635986
r_  generation:  16.410030841827393
local_output_nid generation:  0.6694512367248535
local_in_edges_tensor generation:  1.3256185054779053
mini_batch_src_global generation:  1.645232915878296
r_  generation:  16.37978720664978
local_output_nid generation:  0.6591620445251465
local_in_edges_tensor generation:  3.3327443599700928
mini_batch_src_global generation:  1.5322253704071045
r_  generation:  16.4815194606781
local_output_nid generation:  0.6646146774291992
local_in_edges_tensor generation:  1.3156535625457764
mini_batch_src_global generation:  1.6314516067504883
r_  generation:  16.675405025482178
local_output_nid generation:  0.6655046939849854
local_in_edges_tensor generation:  1.342484951019287
mini_batch_src_global generation:  1.706735372543335
r_  generation:  16.376001358032227
----------------------check_connections_block total spend ----------------------------- 368.4180293083191
generate_one_block  21.97066617012024
generate_one_block  21.91386580467224
generate_one_block  21.871498823165894
generate_one_block  21.911243200302124
generate_one_block  21.987361192703247
generate_one_block  21.977994203567505
generate_one_block  21.960378170013428
generate_one_block  22.409285068511963
generate_one_block  21.933384656906128
generate_one_block  21.867357969284058
generate_one_block  21.835211753845215
generate_one_block  21.803923845291138
generate_one_block  21.82554602622986
generate_one_block  21.84227728843689
generate_one_block  21.908901691436768
generate_one_block  21.90838599205017
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.3495335578918457  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

connection checking time:  609.4027636051178
block generation total time  596.2086806297302
average batch blocks generation time:  37.26304253935814
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3272013664245605  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.251154899597168  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3271570205688477  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2459239959716797  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3283710479736328  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2454895973205566  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3289365768432617  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.250838279724121  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3289794921875  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.255399227142334  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3291354179382324  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2534427642822266  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3312406539916992  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2576847076416016  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328117847442627  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.249262809753418  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328136920928955  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.247781276702881  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3312559127807617  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.256338119506836  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328770637512207  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.251214027404785  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3283443450927734  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2484569549560547  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3283543586730957  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.249476432800293  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3282470703125  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2462167739868164  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3274188041687012  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2487902641296387  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3287739753723145  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.250983238220215  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3857267051935196 |0.6983193904161453 |0.003867417573928833 |0.0001417696475982666 |0.013344570994377136 |0.0014452934265136719 |
----------------------------------------------------------pseudo_mini_loss sum 2.683429718017578
Total (block generation + training)time/epoch 1280.458685874939
Training time/epoch 1647840519.2239754
Training time without block to device /epoch 1647840508.0508652
Training time without total dataloading part /epoch 0.27910542488098145
load block tensor time/epoch 6.1716272830963135
block to device time/epoch 11.173110246658325
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  73600348
Number of first layer input nodes during this epoch:  35463722
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.3543472290039062  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.75705885887146
random selection method range initialization spend 0.01143026351928711
time for parepare:  0.34755373001098633
local_output_nid generation:  0.007148027420043945
local_in_edges_tensor generation:  0.03406190872192383
mini_batch_src_global generation:  0.027876615524291992
r_  generation:  0.3721346855163574
local_output_nid generation:  0.007204532623291016
local_in_edges_tensor generation:  0.013982057571411133
mini_batch_src_global generation:  0.035128116607666016
r_  generation:  0.4073054790496826
local_output_nid generation:  0.007171154022216797
local_in_edges_tensor generation:  0.012712717056274414
mini_batch_src_global generation:  0.02332448959350586
r_  generation:  0.434145450592041
local_output_nid generation:  0.007258176803588867
local_in_edges_tensor generation:  0.009213685989379883
mini_batch_src_global generation:  0.02594590187072754
r_  generation:  0.45405006408691406
local_output_nid generation:  0.007192373275756836
local_in_edges_tensor generation:  0.011374711990356445
mini_batch_src_global generation:  0.02804875373840332
r_  generation:  0.483609676361084
local_output_nid generation:  0.007342338562011719
local_in_edges_tensor generation:  0.011560678482055664
mini_batch_src_global generation:  0.032300710678100586
r_  generation:  0.4925963878631592
local_output_nid generation:  0.0071544647216796875
local_in_edges_tensor generation:  0.013812065124511719
mini_batch_src_global generation:  0.032195091247558594
r_  generation:  0.51165771484375
local_output_nid generation:  0.007174015045166016
local_in_edges_tensor generation:  0.010458230972290039
mini_batch_src_global generation:  0.03318357467651367
r_  generation:  0.5086748600006104
local_output_nid generation:  0.008192777633666992
local_in_edges_tensor generation:  0.012876510620117188
mini_batch_src_global generation:  0.03459882736206055
r_  generation:  0.5206413269042969
local_output_nid generation:  0.007147789001464844
local_in_edges_tensor generation:  0.0189974308013916
mini_batch_src_global generation:  0.03586292266845703
r_  generation:  0.5187404155731201
local_output_nid generation:  0.0071675777435302734
local_in_edges_tensor generation:  0.01590871810913086
mini_batch_src_global generation:  0.038194894790649414
r_  generation:  0.5291061401367188
local_output_nid generation:  0.0071980953216552734
local_in_edges_tensor generation:  0.014505863189697266
mini_batch_src_global generation:  0.03920316696166992
r_  generation:  0.523991584777832
local_output_nid generation:  0.007172107696533203
local_in_edges_tensor generation:  0.012154102325439453
mini_batch_src_global generation:  0.03974795341491699
r_  generation:  0.546109676361084
local_output_nid generation:  0.007280588150024414
local_in_edges_tensor generation:  0.010416269302368164
mini_batch_src_global generation:  0.04072976112365723
r_  generation:  0.5419261455535889
local_output_nid generation:  0.007188320159912109
local_in_edges_tensor generation:  0.012337923049926758
mini_batch_src_global generation:  0.04221916198730469
r_  generation:  0.5562405586242676
local_output_nid generation:  0.007200956344604492
local_in_edges_tensor generation:  0.011910676956176758
mini_batch_src_global generation:  0.04327726364135742
r_  generation:  0.537853479385376
----------------------check_connections_block total spend ----------------------------- 10.592792749404907
generate_one_block  0.8840010166168213
generate_one_block  0.5441229343414307
generate_one_block  0.5188846588134766
generate_one_block  0.5705296993255615
generate_one_block  0.7005000114440918
generate_one_block  0.6660587787628174
generate_one_block  0.5261907577514648
generate_one_block  0.5279126167297363
generate_one_block  0.5189683437347412
generate_one_block  0.5442695617675781
generate_one_block  0.5151276588439941
generate_one_block  0.5163142681121826
generate_one_block  0.5317041873931885
generate_one_block  0.5116667747497559
generate_one_block  0.5159525871276855
generate_one_block  0.5129554271697998
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5557374954223633
gen group dst list time:  0.2643303871154785
time for parepare:  0.46509575843811035
local_output_nid generation:  0.18674278259277344
local_in_edges_tensor generation:  0.8309385776519775
mini_batch_src_global generation:  0.9230523109436035
r_  generation:  10.505159616470337
local_output_nid generation:  0.22444653511047363
local_in_edges_tensor generation:  0.9153480529785156
mini_batch_src_global generation:  1.1620471477508545
r_  generation:  10.931024074554443
local_output_nid generation:  0.2066326141357422
local_in_edges_tensor generation:  1.0289273262023926
mini_batch_src_global generation:  1.1300292015075684
r_  generation:  10.71831727027893
local_output_nid generation:  0.1721031665802002
local_in_edges_tensor generation:  0.8404006958007812
mini_batch_src_global generation:  1.314246416091919
r_  generation:  10.714475870132446
local_output_nid generation:  0.1955430507659912
local_in_edges_tensor generation:  0.7348980903625488
mini_batch_src_global generation:  1.16365385055542
r_  generation:  11.163734674453735
local_output_nid generation:  0.20652318000793457
local_in_edges_tensor generation:  0.862149715423584
mini_batch_src_global generation:  1.172149419784546
r_  generation:  10.951072692871094
local_output_nid generation:  0.18479418754577637
local_in_edges_tensor generation:  0.76936936378479
mini_batch_src_global generation:  1.2465541362762451
r_  generation:  10.991974830627441
local_output_nid generation:  0.20486783981323242
local_in_edges_tensor generation:  0.7767138481140137
mini_batch_src_global generation:  1.162755012512207
r_  generation:  11.182399988174438
local_output_nid generation:  0.17325091361999512
local_in_edges_tensor generation:  0.867516279220581
mini_batch_src_global generation:  1.265928030014038
r_  generation:  10.935878038406372
local_output_nid generation:  0.19829726219177246
local_in_edges_tensor generation:  0.8295364379882812
mini_batch_src_global generation:  1.4572620391845703
r_  generation:  11.010729789733887
local_output_nid generation:  0.19592905044555664
local_in_edges_tensor generation:  0.8129096031188965
mini_batch_src_global generation:  1.3149909973144531
r_  generation:  11.019111156463623
local_output_nid generation:  0.19568610191345215
local_in_edges_tensor generation:  0.7897224426269531
mini_batch_src_global generation:  1.2251324653625488
r_  generation:  11.284968137741089
local_output_nid generation:  0.2061164379119873
local_in_edges_tensor generation:  0.8532817363739014
mini_batch_src_global generation:  1.172302484512329
r_  generation:  11.008941173553467
local_output_nid generation:  0.18166875839233398
local_in_edges_tensor generation:  0.772721529006958
mini_batch_src_global generation:  1.2042040824890137
r_  generation:  11.174266576766968
local_output_nid generation:  0.2080833911895752
local_in_edges_tensor generation:  0.762174129486084
mini_batch_src_global generation:  1.1642205715179443
r_  generation:  11.133273601531982
local_output_nid generation:  0.18005704879760742
local_in_edges_tensor generation:  0.8721733093261719
mini_batch_src_global generation:  1.2511100769042969
r_  generation:  10.864994049072266
----------------------check_connections_block total spend ----------------------------- 241.77641010284424
generate_one_block  15.363470792770386
generate_one_block  16.22079300880432
generate_one_block  15.280928611755371
generate_one_block  14.745256662368774
generate_one_block  15.554149389266968
generate_one_block  15.473717451095581
generate_one_block  15.148224115371704
generate_one_block  14.993683576583862
generate_one_block  15.542959928512573
generate_one_block  15.571687459945679
generate_one_block  14.831530094146729
generate_one_block  15.509530067443848
generate_one_block  15.57573938369751
generate_one_block  15.494262933731079
generate_one_block  14.759512662887573
generate_one_block  15.537362575531006
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.220292568206787
gen group dst list time:  1.0761237144470215
time for parepare:  0.46836209297180176
local_output_nid generation:  0.651256799697876
local_in_edges_tensor generation:  1.4109060764312744
mini_batch_src_global generation:  1.174889087677002
r_  generation:  15.558394193649292
local_output_nid generation:  0.6743495464324951
local_in_edges_tensor generation:  1.441526174545288
mini_batch_src_global generation:  1.7385847568511963
r_  generation:  15.848287105560303
local_output_nid generation:  0.6630473136901855
local_in_edges_tensor generation:  1.308152675628662
mini_batch_src_global generation:  1.601466417312622
r_  generation:  15.900748014450073
local_output_nid generation:  0.6707127094268799
local_in_edges_tensor generation:  1.235868215560913
mini_batch_src_global generation:  1.6449501514434814
r_  generation:  16.02460503578186
local_output_nid generation:  0.6802647113800049
local_in_edges_tensor generation:  1.3091089725494385
mini_batch_src_global generation:  1.6877083778381348
r_  generation:  16.294466972351074
local_output_nid generation:  0.6843388080596924
local_in_edges_tensor generation:  1.3229341506958008
mini_batch_src_global generation:  1.6399672031402588
r_  generation:  16.161130905151367
local_output_nid generation:  0.6765735149383545
local_in_edges_tensor generation:  1.3057277202606201
mini_batch_src_global generation:  1.733152151107788
r_  generation:  16.323424339294434
local_output_nid generation:  0.6896684169769287
local_in_edges_tensor generation:  1.3317699432373047
mini_batch_src_global generation:  1.5801846981048584
r_  generation:  16.193899154663086
local_output_nid generation:  0.6888048648834229
local_in_edges_tensor generation:  1.3018226623535156
mini_batch_src_global generation:  1.730212926864624
r_  generation:  16.340258598327637
local_output_nid generation:  0.69278883934021
local_in_edges_tensor generation:  1.333308458328247
mini_batch_src_global generation:  1.5714163780212402
r_  generation:  16.25556707382202
local_output_nid generation:  0.7038838863372803
local_in_edges_tensor generation:  1.3345494270324707
mini_batch_src_global generation:  1.6687626838684082
r_  generation:  16.367679834365845
local_output_nid generation:  0.684638261795044
local_in_edges_tensor generation:  1.273172378540039
mini_batch_src_global generation:  1.636218786239624
r_  generation:  16.41029930114746
local_output_nid generation:  0.6859695911407471
local_in_edges_tensor generation:  1.3137261867523193
mini_batch_src_global generation:  1.647972822189331
r_  generation:  16.346733331680298
local_output_nid generation:  0.6835591793060303
local_in_edges_tensor generation:  3.0057268142700195
mini_batch_src_global generation:  1.5693387985229492
r_  generation:  16.37376880645752
local_output_nid generation:  0.6811771392822266
local_in_edges_tensor generation:  1.3026516437530518
mini_batch_src_global generation:  1.628788948059082
r_  generation:  16.371517419815063
local_output_nid generation:  0.6856677532196045
local_in_edges_tensor generation:  1.3082361221313477
mini_batch_src_global generation:  1.6099064350128174
r_  generation:  16.43561887741089
----------------------check_connections_block total spend ----------------------------- 366.63689661026
generate_one_block  21.764015674591064
generate_one_block  21.65969491004944
generate_one_block  21.63620114326477
generate_one_block  21.935040712356567
generate_one_block  21.60955286026001
generate_one_block  21.652267694473267
generate_one_block  21.69277024269104
generate_one_block  22.34973120689392
generate_one_block  21.684842109680176
generate_one_block  21.708117485046387
generate_one_block  21.7487473487854
generate_one_block  21.76363515853882
generate_one_block  21.717706203460693
generate_one_block  21.77121615409851
generate_one_block  21.66843056678772
generate_one_block  21.734943389892578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.3543472290039062  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

connection checking time:  608.4133067131042
block generation total time  593.6997215747833
average batch blocks generation time:  37.10623259842396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3287391662597656  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.251498222351074  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3325529098510742  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.257233142852783  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3270273208618164  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.24342679977417  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3277487754821777  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2484283447265625  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3283181190490723  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.254373073577881  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3293657302856445  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2562856674194336  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328012466430664  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2471485137939453  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3301730155944824  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2538323402404785  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328751564025879  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2493085861206055  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3277511596679688  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.248541831970215  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3301939964294434  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2578587532043457  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3294687271118164  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2553324699401855  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3283624649047852  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.249764919281006  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3295345306396484  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.256007194519043  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3282041549682617  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.248887062072754  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.327775478363037  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2473020553588867  GigaBytes
Max Memory Allocated: 4.032658100128174  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38394972681999207 |0.5179246664047241 |0.0037326812744140625 |0.00014546513557434082 |0.0133780837059021 |0.0026082992553710938 |
----------------------------------------------------------pseudo_mini_loss sum 2.3762528896331787
Total (block generation + training)time/epoch 1279.8937083482742
Training time/epoch 1647841797.4230692
Training time without block to device /epoch 1647841789.1362746
Training time without total dataloading part /epoch 0.27870798110961914
load block tensor time/epoch 6.143195629119873
block to device time/epoch 8.286794662475586
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  73613095
Number of first layer input nodes during this epoch: Using backend: pytorch
 35464378
