main start at this time 1647758401.3084946
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.42196130752563477
random selection method range initialization spend 0.018465280532836914
time for parepare:  0.2868220806121826
local_output_nid generation:  0.006432056427001953
local_in_edges_tensor generation:  0.02911829948425293
mini_batch_src_global generation:  0.019453048706054688
r_  generation:  0.1904294490814209
local_output_nid generation:  0.007167816162109375
local_in_edges_tensor generation:  0.007161855697631836
mini_batch_src_global generation:  0.018558263778686523
r_  generation:  0.20591950416564941
local_output_nid generation:  0.0071032047271728516
local_in_edges_tensor generation:  0.007742404937744141
mini_batch_src_global generation:  0.013692378997802734
r_  generation:  0.2221240997314453
local_output_nid generation:  0.007132291793823242
local_in_edges_tensor generation:  0.0064504146575927734
mini_batch_src_global generation:  0.013279199600219727
r_  generation:  0.2307875156402588
local_output_nid generation:  0.007108926773071289
local_in_edges_tensor generation:  0.013813018798828125
mini_batch_src_global generation:  0.01346898078918457
r_  generation:  0.2332162857055664
local_output_nid generation:  0.007138967514038086
local_in_edges_tensor generation:  0.009547233581542969
mini_batch_src_global generation:  0.01599740982055664
r_  generation:  0.25087428092956543
local_output_nid generation:  0.008086681365966797
local_in_edges_tensor generation:  0.029393434524536133
mini_batch_src_global generation:  0.016794204711914062
r_  generation:  0.28157591819763184
local_output_nid generation:  0.009638547897338867
local_in_edges_tensor generation:  0.009709596633911133
mini_batch_src_global generation:  0.017351388931274414
r_  generation:  0.2623708248138428
local_output_nid generation:  0.00715327262878418
local_in_edges_tensor generation:  0.007997751235961914
mini_batch_src_global generation:  0.017202377319335938
r_  generation:  0.2559680938720703
local_output_nid generation:  0.007196664810180664
local_in_edges_tensor generation:  0.006875753402709961
mini_batch_src_global generation:  0.018688440322875977
r_  generation:  0.2650566101074219
local_output_nid generation:  0.007174253463745117
local_in_edges_tensor generation:  0.006335735321044922
mini_batch_src_global generation:  0.019815683364868164
r_  generation:  0.2728292942047119
local_output_nid generation:  0.007122039794921875
local_in_edges_tensor generation:  0.006532430648803711
mini_batch_src_global generation:  0.020442962646484375
r_  generation:  0.27280712127685547
local_output_nid generation:  0.007214784622192383
local_in_edges_tensor generation:  0.006514310836791992
mini_batch_src_global generation:  0.02056717872619629
r_  generation:  0.26896238327026367
local_output_nid generation:  0.00716710090637207
local_in_edges_tensor generation:  0.006433010101318359
mini_batch_src_global generation:  0.02111029624938965
r_  generation:  0.26973390579223633
local_output_nid generation:  0.007154941558837891
local_in_edges_tensor generation:  0.00644373893737793
mini_batch_src_global generation:  0.02153158187866211
r_  generation:  0.2716500759124756
local_output_nid generation:  0.007119894027709961
local_in_edges_tensor generation:  0.006279945373535156
mini_batch_src_global generation:  0.021724939346313477
r_  generation:  0.2787020206451416
----------------------check_connections_block total spend ----------------------------- 5.690601825714111
generate_one_block  6.477755069732666
generate_one_block  0.32300639152526855
generate_one_block  0.2948319911956787
generate_one_block  0.27571868896484375
generate_one_block  0.2796053886413574
generate_one_block  0.3228602409362793
generate_one_block  0.28656625747680664
generate_one_block  0.3210608959197998
generate_one_block  0.33217549324035645
generate_one_block  0.30226778984069824
generate_one_block  0.29562854766845703
generate_one_block  0.2829265594482422
generate_one_block  0.28225183486938477
generate_one_block  0.2744007110595703
generate_one_block  0.28075528144836426
generate_one_block  0.273853063583374
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1013576984405518
gen group dst list time:  0.14930057525634766
time for parepare:  0.43771886825561523
local_output_nid generation:  0.10380411148071289
local_in_edges_tensor generation:  0.36733484268188477
mini_batch_src_global generation:  0.3332695960998535
r_  generation:  4.449392557144165
local_output_nid generation:  0.10741591453552246
local_in_edges_tensor generation:  0.2777059078216553
mini_batch_src_global generation:  0.42472147941589355
r_  generation:  4.736687660217285
local_output_nid generation:  0.10784411430358887
local_in_edges_tensor generation:  0.2746920585632324
mini_batch_src_global generation:  0.41558218002319336
r_  generation:  4.746212005615234
local_output_nid generation:  0.10706567764282227
local_in_edges_tensor generation:  0.27211737632751465
mini_batch_src_global generation:  0.4294295310974121
r_  generation:  4.842309236526489
local_output_nid generation:  0.13209939002990723
local_in_edges_tensor generation:  0.38179659843444824
mini_batch_src_global generation:  0.4597787857055664
r_  generation:  5.012885570526123
local_output_nid generation:  0.13034391403198242
local_in_edges_tensor generation:  0.2855713367462158
mini_batch_src_global generation:  0.45308828353881836
r_  generation:  5.038821220397949
local_output_nid generation:  0.11092829704284668
local_in_edges_tensor generation:  0.2823004722595215
mini_batch_src_global generation:  0.479259729385376
r_  generation:  5.1443774700164795
local_output_nid generation:  0.11071491241455078
local_in_edges_tensor generation:  0.36864686012268066
mini_batch_src_global generation:  0.4960286617279053
r_  generation:  5.106405258178711
local_output_nid generation:  0.13622260093688965
local_in_edges_tensor generation:  0.3584320545196533
mini_batch_src_global generation:  0.5075159072875977
r_  generation:  5.304161548614502
local_output_nid generation:  0.11419129371643066
local_in_edges_tensor generation:  0.2880854606628418
mini_batch_src_global generation:  0.489116907119751
r_  generation:  5.044884920120239
local_output_nid generation:  0.1263895034790039
local_in_edges_tensor generation:  0.28525328636169434
mini_batch_src_global generation:  0.47116613388061523
r_  generation:  5.032874584197998
local_output_nid generation:  0.11080121994018555
local_in_edges_tensor generation:  0.38422369956970215
mini_batch_src_global generation:  0.4730861186981201
r_  generation:  5.0913450717926025
local_output_nid generation:  0.13537025451660156
local_in_edges_tensor generation:  0.2890462875366211
mini_batch_src_global generation:  0.47300052642822266
r_  generation:  4.997976303100586
local_output_nid generation:  0.11375927925109863
local_in_edges_tensor generation:  0.2832307815551758
mini_batch_src_global generation:  0.49019694328308105
r_  generation:  5.144200801849365
local_output_nid generation:  0.10956835746765137
local_in_edges_tensor generation:  0.28545355796813965
mini_batch_src_global generation:  0.5076532363891602
r_  generation:  5.137106418609619
local_output_nid generation:  0.11784934997558594
local_in_edges_tensor generation:  0.3980600833892822
mini_batch_src_global generation:  0.4790923595428467
r_  generation:  5.2802674770355225
----------------------check_connections_block total spend ----------------------------- 108.02798748016357
generate_one_block  6.807398557662964
generate_one_block  6.156273603439331
generate_one_block  6.411967515945435
generate_one_block  6.0489301681518555
generate_one_block  6.058696031570435
generate_one_block  6.095925807952881
generate_one_block  6.27019476890564
generate_one_block  6.319073915481567
generate_one_block  6.289139270782471
generate_one_block  6.154799699783325
generate_one_block  6.423327207565308
generate_one_block  6.177490949630737
generate_one_block  6.088374376296997
generate_one_block  6.068291664123535
generate_one_block  6.36978006362915
generate_one_block  6.181347131729126
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1021687984466553
gen group dst list time:  0.8484032154083252
time for parepare:  0.4809305667877197
local_output_nid generation:  0.5148735046386719
local_in_edges_tensor generation:  1.2035315036773682
mini_batch_src_global generation:  1.0398118495941162
r_  generation:  14.163457870483398
local_output_nid generation:  0.5782549381256104
local_in_edges_tensor generation:  1.1873865127563477
mini_batch_src_global generation:  1.434312343597412
r_  generation:  14.24678111076355
local_output_nid generation:  0.5450267791748047
local_in_edges_tensor generation:  1.2827916145324707
mini_batch_src_global generation:  1.3992416858673096
r_  generation:  15.171583890914917
local_output_nid generation:  0.5635402202606201
local_in_edges_tensor generation:  1.0852596759796143
mini_batch_src_global generation:  1.3704872131347656
r_  generation:  14.304929971694946
local_output_nid generation:  0.5644142627716064
local_in_edges_tensor generation:  1.0852701663970947
mini_batch_src_global generation:  1.3439877033233643
r_  generation:  14.677529096603394
local_output_nid generation:  0.5628798007965088
local_in_edges_tensor generation:  2.2077748775482178
mini_batch_src_global generation:  1.3169021606445312
r_  generation:  15.058693885803223
local_output_nid generation:  0.5205667018890381
local_in_edges_tensor generation:  1.157332420349121
mini_batch_src_global generation:  1.3489246368408203
r_  generation:  14.734204053878784
local_output_nid generation:  0.5617835521697998
local_in_edges_tensor generation:  1.0868804454803467
mini_batch_src_global generation:  1.3635990619659424
r_  generation:  14.588969230651855
local_output_nid generation:  0.561133861541748
local_in_edges_tensor generation:  1.0849876403808594
mini_batch_src_global generation:  1.3351085186004639
r_  generation:  15.044246912002563
local_output_nid generation:  0.556396484375
local_in_edges_tensor generation:  1.1608436107635498
mini_batch_src_global generation:  1.3644466400146484
r_  generation:  14.797627210617065
local_output_nid generation:  0.5419032573699951
local_in_edges_tensor generation:  1.176496982574463
mini_batch_src_global generation:  1.3701441287994385
r_  generation:  14.486831665039062
local_output_nid generation:  0.5409793853759766
local_in_edges_tensor generation:  1.0876305103302002
mini_batch_src_global generation:  1.3671021461486816
r_  generation:  14.586288928985596
local_output_nid generation:  0.5641093254089355
local_in_edges_tensor generation:  1.081244707107544
mini_batch_src_global generation:  1.380967378616333
r_  generation:  14.683597564697266
local_output_nid generation:  0.5612413883209229
local_in_edges_tensor generation:  1.1479289531707764
mini_batch_src_global generation:  1.33148193359375
r_  generation:  14.64692735671997
local_output_nid generation:  0.5351865291595459
local_in_edges_tensor generation:  1.1599490642547607
mini_batch_src_global generation:  1.3693592548370361
r_  generation:  14.663719654083252
local_output_nid generation:  0.5427093505859375
local_in_edges_tensor generation:  1.0868220329284668
mini_batch_src_global generation:  1.3687703609466553
r_  generation:  14.639543294906616
----------------------check_connections_block total spend ----------------------------- 325.44904494285583
generate_one_block  19.508620738983154
generate_one_block  20.127705812454224
generate_one_block  19.24610137939453
generate_one_block  19.60147714614868
generate_one_block  18.89556097984314
generate_one_block  18.959534168243408
generate_one_block  19.94810438156128
generate_one_block  19.147522687911987
generate_one_block  19.41181492805481
generate_one_block  19.25067138671875
generate_one_block  19.28345251083374
generate_one_block  19.226714849472046
generate_one_block  19.0965313911438
generate_one_block  18.734009981155396
generate_one_block  19.05424404144287
generate_one_block  19.301944971084595
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  433.4770324230194
block generation total time  408.71502208709717
average batch blocks generation time:  25.544688880443573
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2401123046875 GB
    Memory Allocated: 1.1252565383911133  GigaBytes
Max Memory Allocated: 1.1252565383911133  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 2.5667896270751953  GigaBytes
Max Memory Allocated: 2.998607635498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 1.1278719902038574  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 2.5661916732788086  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 1.126070499420166  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 2.563199043273926  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 1.1251802444458008  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 2.5551280975341797  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 1.127274990081787  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 2.5605597496032715  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 1.127934455871582  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 2.568859577178955  GigaBytes
Max Memory Allocated: 3.2984142303466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4686279296875 GB
    Memory Allocated: 1.1290669441223145  GigaBytes
Max Memory Allocated: 3.301039218902588  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4686279296875 GB
    Memory Allocated: 2.570995807647705  GigaBytes
Max Memory Allocated: 3.301039218902588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.128340721130371  GigaBytes
Max Memory Allocated: 3.3054513931274414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.5672202110290527  GigaBytes
Max Memory Allocated: 3.3054513931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.1276121139526367  GigaBytes
Max Memory Allocated: 3.3054513931274414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 2.5667381286621094  GigaBytes
Max Memory Allocated: 3.3054513931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4705810546875 GB
    Memory Allocated: 1.130228042602539  GigaBytes
Max Memory Allocated: 3.3054513931274414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.573336124420166  GigaBytes
Max Memory Allocated: 3.3054513931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127457618713379  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.567500114440918  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1278700828552246  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.56862211227417  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.128415584564209  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5675816535949707  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1277422904968262  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.562973976135254  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1274499893188477  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5641980171203613  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1289572715759277  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5679731369018555  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.24692192673683167 |0.3987158387899399 |0.04501982033252716 |0.0001446753740310669 |0.025943785905838013 |0.0016431808471679688 |
----------------------------------------------------------pseudo_mini_loss sum 8.812421798706055
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64155025
Number of first layer input nodes during this epoch:  34054425
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.8152637481689453  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.403123140335083
random selection method range initialization spend 0.01640176773071289
time for parepare:  0.29695987701416016
local_output_nid generation:  0.006371021270751953
local_in_edges_tensor generation:  0.025194883346557617
mini_batch_src_global generation:  0.01678299903869629
r_  generation:  0.19114089012145996
local_output_nid generation:  0.00725102424621582
local_in_edges_tensor generation:  0.01073145866394043
mini_batch_src_global generation:  0.020905733108520508
r_  generation:  0.21442747116088867
local_output_nid generation:  0.0072574615478515625
local_in_edges_tensor generation:  0.006453752517700195
mini_batch_src_global generation:  0.01475834846496582
r_  generation:  0.22783207893371582
local_output_nid generation:  0.007314443588256836
local_in_edges_tensor generation:  0.006489276885986328
mini_batch_src_global generation:  0.015912532806396484
r_  generation:  0.23291468620300293
local_output_nid generation:  0.0072405338287353516
local_in_edges_tensor generation:  0.00641942024230957
mini_batch_src_global generation:  0.015907764434814453
r_  generation:  0.23775839805603027
local_output_nid generation:  0.007315397262573242
local_in_edges_tensor generation:  0.006420612335205078
mini_batch_src_global generation:  0.01605391502380371
r_  generation:  0.24747109413146973
local_output_nid generation:  0.007222652435302734
local_in_edges_tensor generation:  0.006372213363647461
mini_batch_src_global generation:  0.01680445671081543
r_  generation:  0.26093149185180664
local_output_nid generation:  0.007238149642944336
local_in_edges_tensor generation:  0.00638127326965332
mini_batch_src_global generation:  0.017326831817626953
r_  generation:  0.26647472381591797
local_output_nid generation:  0.0072634220123291016
local_in_edges_tensor generation:  0.0076596736907958984
mini_batch_src_global generation:  0.01749396324157715
r_  generation:  0.2637059688568115
local_output_nid generation:  0.007239341735839844
local_in_edges_tensor generation:  0.006432056427001953
mini_batch_src_global generation:  0.01856827735900879
r_  generation:  0.2710585594177246
local_output_nid generation:  0.0072667598724365234
local_in_edges_tensor generation:  0.006337404251098633
mini_batch_src_global generation:  0.020067453384399414
r_  generation:  0.2808835506439209
local_output_nid generation:  0.007272481918334961
local_in_edges_tensor generation:  0.006415843963623047
mini_batch_src_global generation:  0.021197795867919922
r_  generation:  0.27996277809143066
local_output_nid generation:  0.007272243499755859
local_in_edges_tensor generation:  0.006431102752685547
mini_batch_src_global generation:  0.020802736282348633
r_  generation:  0.27434468269348145
local_output_nid generation:  0.0072689056396484375
local_in_edges_tensor generation:  0.006455898284912109
mini_batch_src_global generation:  0.021212100982666016
r_  generation:  0.28002429008483887
local_output_nid generation:  0.008751153945922852
local_in_edges_tensor generation:  0.006490468978881836
mini_batch_src_global generation:  0.021526813507080078
r_  generation:  0.2851285934448242
local_output_nid generation:  0.007252693176269531
local_in_edges_tensor generation:  0.00640869140625
mini_batch_src_global generation:  0.021944761276245117
r_  generation:  0.2839531898498535
----------------------check_connections_block total spend ----------------------------- 5.737666606903076
generate_one_block  0.5946853160858154
generate_one_block  0.335402250289917
generate_one_block  0.29474592208862305
generate_one_block  0.29262685775756836
generate_one_block  0.36939287185668945
generate_one_block  0.48944711685180664
generate_one_block  0.37423086166381836
generate_one_block  0.31492066383361816
generate_one_block  0.296128511428833
generate_one_block  0.29019594192504883
generate_one_block  0.29592275619506836
generate_one_block  0.28748583793640137
generate_one_block  0.2834904193878174
generate_one_block  0.2779862880706787
generate_one_block  0.28560829162597656
generate_one_block  0.27846717834472656
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.969125747680664
gen group dst list time:  0.15496230125427246
time for parepare:  0.4631774425506592
local_output_nid generation:  0.10688495635986328
local_in_edges_tensor generation:  0.38384461402893066
mini_batch_src_global generation:  0.34001994132995605
r_  generation:  4.798755407333374
local_output_nid generation:  0.1401820182800293
local_in_edges_tensor generation:  0.47063398361206055
mini_batch_src_global generation:  0.43605899810791016
r_  generation:  4.885937690734863
local_output_nid generation:  0.11421608924865723
local_in_edges_tensor generation:  0.39544677734375
mini_batch_src_global generation:  0.46901488304138184
r_  generation:  4.939143896102905
local_output_nid generation:  0.1281745433807373
local_in_edges_tensor generation:  0.28978514671325684
mini_batch_src_global generation:  0.4329512119293213
r_  generation:  5.0552051067352295
local_output_nid generation:  0.11603736877441406
local_in_edges_tensor generation:  0.39265012741088867
mini_batch_src_global generation:  0.4794151782989502
r_  generation:  5.190157175064087
local_output_nid generation:  0.1487865447998047
local_in_edges_tensor generation:  0.2876014709472656
mini_batch_src_global generation:  0.46154189109802246
r_  generation:  5.078864336013794
local_output_nid generation:  0.11206674575805664
local_in_edges_tensor generation:  0.39209699630737305
mini_batch_src_global generation:  0.46616435050964355
r_  generation:  5.160447835922241
local_output_nid generation:  0.11172771453857422
local_in_edges_tensor generation:  0.3052523136138916
mini_batch_src_global generation:  0.4743077754974365
r_  generation:  5.166611433029175
local_output_nid generation:  0.13995361328125
local_in_edges_tensor generation:  0.28159070014953613
mini_batch_src_global generation:  0.4701707363128662
r_  generation:  5.121578216552734
local_output_nid generation:  0.11280274391174316
local_in_edges_tensor generation:  0.3931121826171875
mini_batch_src_global generation:  0.49832820892333984
r_  generation:  5.356834888458252
local_output_nid generation:  0.1389148235321045
local_in_edges_tensor generation:  0.3004145622253418
mini_batch_src_global generation:  0.494617223739624
r_  generation:  5.32107138633728
local_output_nid generation:  0.1126248836517334
local_in_edges_tensor generation:  0.39468836784362793
mini_batch_src_global generation:  0.4918949604034424
r_  generation:  5.86390233039856
local_output_nid generation:  0.11131715774536133
local_in_edges_tensor generation:  0.30214738845825195
mini_batch_src_global generation:  0.5095810890197754
r_  generation:  5.186200141906738
local_output_nid generation:  0.13017940521240234
local_in_edges_tensor generation:  0.30654311180114746
mini_batch_src_global generation:  0.47792768478393555
r_  generation:  5.162473201751709
local_output_nid generation:  0.11024975776672363
local_in_edges_tensor generation:  0.392242431640625
mini_batch_src_global generation:  0.49936866760253906
r_  generation:  5.275288105010986
local_output_nid generation:  0.13778924942016602
local_in_edges_tensor generation:  0.29540514945983887
mini_batch_src_global generation:  0.4767007827758789
r_  generation:  5.177762746810913
----------------------check_connections_block total spend ----------------------------- 111.53015160560608
generate_one_block  6.6248085498809814
generate_one_block  7.04465126991272
generate_one_block  6.546391487121582
generate_one_block  6.802393436431885
generate_one_block  6.615009784698486
generate_one_block  6.327746391296387
generate_one_block  6.346593141555786
generate_one_block  6.638279914855957
generate_one_block  6.272680759429932
generate_one_block  6.791244268417358
generate_one_block  6.34382700920105
generate_one_block  6.503417491912842
generate_one_block  6.831774711608887
generate_one_block  6.21880316734314
generate_one_block  6.60739278793335
generate_one_block  6.208678245544434
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.237499952316284
gen group dst list time:  0.8680529594421387
time for parepare:  0.4864950180053711
local_output_nid generation:  0.49668192863464355
local_in_edges_tensor generation:  1.1356520652770996
mini_batch_src_global generation:  0.9997091293334961
r_  generation:  14.247726440429688
local_output_nid generation:  0.5455882549285889
local_in_edges_tensor generation:  1.1282613277435303
mini_batch_src_global generation:  1.322429895401001
r_  generation:  14.521317720413208
local_output_nid generation:  0.5546228885650635
local_in_edges_tensor generation:  1.1055080890655518
mini_batch_src_global generation:  1.3698208332061768
r_  generation:  14.73711085319519
local_output_nid generation:  0.5593361854553223
local_in_edges_tensor generation:  1.102910041809082
mini_batch_src_global generation:  1.388202428817749
r_  generation:  14.70977258682251
local_output_nid generation:  0.5635790824890137
local_in_edges_tensor generation:  1.1322908401489258
mini_batch_src_global generation:  1.344904899597168
r_  generation:  14.698597192764282
local_output_nid generation:  0.535693883895874
local_in_edges_tensor generation:  1.131288766860962
mini_batch_src_global generation:  1.3441390991210938
r_  generation:  14.908310890197754
local_output_nid generation:  0.5498991012573242
local_in_edges_tensor generation:  1.1476528644561768
mini_batch_src_global generation:  1.3667926788330078
r_  generation:  14.742447137832642
local_output_nid generation:  0.5571162700653076
local_in_edges_tensor generation:  1.0794711112976074
mini_batch_src_global generation:  1.4262030124664307
r_  generation:  14.676176309585571
local_output_nid generation:  0.5632479190826416
local_in_edges_tensor generation:  1.0850512981414795
mini_batch_src_global generation:  1.5256733894348145
r_  generation:  14.71406626701355
local_output_nid generation:  0.564605712890625
local_in_edges_tensor generation:  1.133399486541748
mini_batch_src_global generation:  1.3199238777160645
r_  generation:  14.866249561309814
local_output_nid generation:  0.550297737121582
local_in_edges_tensor generation:  1.1527118682861328
mini_batch_src_global generation:  1.3349108695983887
r_  generation:  14.825947761535645
local_output_nid generation:  0.5417799949645996
local_in_edges_tensor generation:  1.1439154148101807
mini_batch_src_global generation:  1.3877837657928467
r_  generation:  14.736212015151978
local_output_nid generation:  0.5506558418273926
local_in_edges_tensor generation:  1.1430981159210205
mini_batch_src_global generation:  1.38649582862854
r_  generation:  14.634167909622192
local_output_nid generation:  0.5575463771820068
local_in_edges_tensor generation:  2.555746078491211
mini_batch_src_global generation:  1.3635194301605225
r_  generation:  14.46765661239624
local_output_nid generation:  0.5754284858703613
local_in_edges_tensor generation:  1.0835919380187988
mini_batch_src_global generation:  1.3902087211608887
r_  generation:  14.81017017364502
local_output_nid generation:  0.5572905540466309
local_in_edges_tensor generation:  1.1532158851623535
mini_batch_src_global generation:  1.3278155326843262
r_  generation:  14.756717443466187
----------------------check_connections_block total spend ----------------------------- 326.24920558929443
generate_one_block  19.429412841796875
generate_one_block  19.275477170944214
generate_one_block  19.3744375705719
generate_one_block  19.823700189590454
generate_one_block  19.388036489486694
generate_one_block  19.545042037963867
generate_one_block  19.616193294525146
generate_one_block  19.861868143081665
generate_one_block  19.32910394668579
generate_one_block  19.54957342147827
generate_one_block  19.289150714874268
generate_one_block  19.388505935668945
generate_one_block  19.266633987426758
generate_one_block  19.275174856185913
generate_one_block  19.2693190574646
generate_one_block  19.180694818496704
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.8152637481689453  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

connection checking time:  437.7793571949005
block generation total time  415.58601689338684
average batch blocks generation time:  25.974126055836678
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.128014087677002  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.567185878753662  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5665712356567383  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127492904663086  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5639467239379883  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1265645027160645  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.567549705505371  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1272029876708984  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.56223201751709  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1280641555786133  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5674595832824707  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.128502368927002  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5667614936828613  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1299309730529785  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.574769973754883  GigaBytes
Max Memory Allocated: 3.307040214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5621747970581055  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1277928352355957  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5674924850463867  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1284399032592773  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.569580078125  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1298871040344238  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.569718360900879  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.126255989074707  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.56284236907959  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.126969337463379  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5612826347351074  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.568173408508301  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1270408630371094  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5607261657714844  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2545721083879471 |0.2535146027803421 |0.004599899053573608 |0.00015057623386383057 |0.004031077027320862 |0.0020341873168945312 |
----------------------------------------------------------pseudo_mini_loss sum 5.142570495605469
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64141582
Number of first layer input nodes during this epoch:  34045478
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.811490535736084  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.31319308280944824
random selection method range initialization spend 0.012699127197265625
time for parepare:  0.29144930839538574
local_output_nid generation:  0.006405353546142578
local_in_edges_tensor generation:  0.02886033058166504
mini_batch_src_global generation:  0.015857934951782227
r_  generation:  0.1908864974975586
local_output_nid generation:  0.0072100162506103516
local_in_edges_tensor generation:  0.008968591690063477
mini_batch_src_global generation:  0.0200650691986084
r_  generation:  0.21489524841308594
local_output_nid generation:  0.007173061370849609
local_in_edges_tensor generation:  0.0068891048431396484
mini_batch_src_global generation:  0.012458086013793945
r_  generation:  0.2240149974822998
local_output_nid generation:  0.00722956657409668
local_in_edges_tensor generation:  0.006961345672607422
mini_batch_src_global generation:  0.013287782669067383
r_  generation:  0.2376418113708496
local_output_nid generation:  0.007147789001464844
local_in_edges_tensor generation:  0.008273601531982422
mini_batch_src_global generation:  0.014228343963623047
r_  generation:  0.2416977882385254
local_output_nid generation:  0.007174015045166016
local_in_edges_tensor generation:  0.006332874298095703
mini_batch_src_global generation:  0.016132116317749023
r_  generation:  0.2536306381225586
local_output_nid generation:  0.007138967514038086
local_in_edges_tensor generation:  0.007727384567260742
mini_batch_src_global generation:  0.01699066162109375
r_  generation:  0.26520514488220215
local_output_nid generation:  0.007224082946777344
local_in_edges_tensor generation:  0.00637054443359375
mini_batch_src_global generation:  0.01747870445251465
r_  generation:  0.2662210464477539
local_output_nid generation:  0.007198810577392578
local_in_edges_tensor generation:  0.007560253143310547
mini_batch_src_global generation:  0.0186617374420166
r_  generation:  0.27022242546081543
local_output_nid generation:  0.007166147232055664
local_in_edges_tensor generation:  0.006318807601928711
mini_batch_src_global generation:  0.018622875213623047
r_  generation:  0.28047990798950195
local_output_nid generation:  0.007169961929321289
local_in_edges_tensor generation:  0.006261348724365234
mini_batch_src_global generation:  0.020073413848876953
r_  generation:  0.28253698348999023
local_output_nid generation:  0.007188320159912109
local_in_edges_tensor generation:  0.00854039192199707
mini_batch_src_global generation:  0.020314455032348633
r_  generation:  0.2847557067871094
local_output_nid generation:  0.0071032047271728516
local_in_edges_tensor generation:  0.00692439079284668
mini_batch_src_global generation:  0.020871639251708984
r_  generation:  0.27886366844177246
local_output_nid generation:  0.0074765682220458984
local_in_edges_tensor generation:  0.006400108337402344
mini_batch_src_global generation:  0.021989822387695312
r_  generation:  0.2785074710845947
local_output_nid generation:  0.007250785827636719
local_in_edges_tensor generation:  0.006391763687133789
mini_batch_src_global generation:  0.021776914596557617
r_  generation:  0.27882981300354004
local_output_nid generation:  0.007180690765380859
local_in_edges_tensor generation:  0.00766754150390625
mini_batch_src_global generation:  0.021927595138549805
r_  generation:  0.2798144817352295
----------------------check_connections_block total spend ----------------------------- 5.766225099563599
generate_one_block  0.6114151477813721
generate_one_block  0.34519481658935547
generate_one_block  0.3028733730316162
generate_one_block  0.29033899307250977
generate_one_block  0.30515313148498535
generate_one_block  0.4428086280822754
generate_one_block  0.47980284690856934
generate_one_block  0.33040452003479004
generate_one_block  0.30620670318603516
generate_one_block  0.2870364189147949
generate_one_block  0.2883453369140625
generate_one_block  0.29552149772644043
generate_one_block  0.2930490970611572
generate_one_block  0.28833508491516113
generate_one_block  0.287717342376709
generate_one_block  0.28847408294677734
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0460259914398193
gen group dst list time:  0.15197014808654785
time for parepare:  0.41559720039367676
local_output_nid generation:  0.11350822448730469
local_in_edges_tensor generation:  0.32848310470581055
mini_batch_src_global generation:  0.3385922908782959
r_  generation:  4.584405422210693
local_output_nid generation:  0.1219334602355957
local_in_edges_tensor generation:  0.4916391372680664
mini_batch_src_global generation:  0.5181419849395752
r_  generation:  4.641660451889038
local_output_nid generation:  0.1327667236328125
local_in_edges_tensor generation:  0.2891557216644287
mini_batch_src_global generation:  0.43442511558532715
r_  generation:  4.972620010375977
local_output_nid generation:  0.13076496124267578
local_in_edges_tensor generation:  0.3971104621887207
mini_batch_src_global generation:  0.4186527729034424
r_  generation:  4.783677816390991
local_output_nid generation:  0.12102055549621582
local_in_edges_tensor generation:  0.2910177707672119
mini_batch_src_global generation:  0.4653477668762207
r_  generation:  4.949952602386475
local_output_nid generation:  0.11172199249267578
local_in_edges_tensor generation:  0.28806138038635254
mini_batch_src_global generation:  0.46091675758361816
r_  generation:  5.052448272705078
local_output_nid generation:  0.11365604400634766
local_in_edges_tensor generation:  0.40234827995300293
mini_batch_src_global generation:  0.49298620223999023
r_  generation:  4.990677118301392
local_output_nid generation:  0.13120031356811523
local_in_edges_tensor generation:  0.29287052154541016
mini_batch_src_global generation:  0.4673287868499756
r_  generation:  4.9515745639801025
local_output_nid generation:  0.12105154991149902
local_in_edges_tensor generation:  0.28822779655456543
mini_batch_src_global generation:  0.477337121963501
r_  generation:  5.02157998085022
local_output_nid generation:  0.11155223846435547
local_in_edges_tensor generation:  0.3423304557800293
mini_batch_src_global generation:  0.4857158660888672
r_  generation:  5.129988193511963
local_output_nid generation:  0.12955951690673828
local_in_edges_tensor generation:  0.34975671768188477
mini_batch_src_global generation:  0.4709954261779785
r_  generation:  5.016089200973511
local_output_nid generation:  0.12145042419433594
local_in_edges_tensor generation:  0.28749632835388184
mini_batch_src_global generation:  0.4766833782196045
r_  generation:  5.014481782913208
local_output_nid generation:  0.11127448081970215
local_in_edges_tensor generation:  0.28989648818969727
mini_batch_src_global generation:  0.4959728717803955
r_  generation:  5.196383953094482
local_output_nid generation:  0.1113729476928711
local_in_edges_tensor generation:  0.39159488677978516
mini_batch_src_global generation:  0.4826681613922119
r_  generation:  4.972470760345459
local_output_nid generation:  0.12032842636108398
local_in_edges_tensor generation:  0.2935953140258789
mini_batch_src_global generation:  0.5148887634277344
r_  generation:  5.100066900253296
local_output_nid generation:  0.12267017364501953
local_in_edges_tensor generation:  0.2833106517791748
mini_batch_src_global generation:  0.4779994487762451
r_  generation:  5.166912794113159
----------------------check_connections_block total spend ----------------------------- 107.78931164741516
generate_one_block  6.672129154205322
generate_one_block  6.782104253768921
generate_one_block  6.1824939250946045
generate_one_block  6.238341569900513
generate_one_block  6.613883018493652
generate_one_block  6.144643783569336
generate_one_block  6.227042198181152
generate_one_block  6.317852973937988
generate_one_block  6.599181413650513
generate_one_block  6.320624113082886
generate_one_block  6.265473365783691
generate_one_block  6.384779691696167
generate_one_block  6.45646071434021
generate_one_block  6.213414192199707
generate_one_block  6.257919549942017
generate_one_block  6.587285995483398
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.0712263584136963
gen group dst list time:  0.8751316070556641
time for parepare:  0.48828125
local_output_nid generation:  0.5389461517333984
local_in_edges_tensor generation:  1.1626160144805908
mini_batch_src_global generation:  1.0416514873504639
r_  generation:  14.290485382080078
local_output_nid generation:  0.5754525661468506
local_in_edges_tensor generation:  1.2333669662475586
mini_batch_src_global generation:  1.3523402214050293
r_  generation:  14.593207836151123
local_output_nid generation:  0.5448446273803711
local_in_edges_tensor generation:  1.1125802993774414
mini_batch_src_global generation:  1.4285914897918701
r_  generation:  14.154742956161499
local_output_nid generation:  0.5500504970550537
local_in_edges_tensor generation:  1.0560791492462158
mini_batch_src_global generation:  1.4473159313201904
r_  generation:  14.26482629776001
local_output_nid generation:  0.5715949535369873
local_in_edges_tensor generation:  1.1692192554473877
mini_batch_src_global generation:  1.3712294101715088
r_  generation:  14.5796639919281
local_output_nid generation:  0.5674939155578613
local_in_edges_tensor generation:  1.1391329765319824
mini_batch_src_global generation:  1.323174238204956
r_  generation:  14.715739488601685
local_output_nid generation:  0.5567505359649658
local_in_edges_tensor generation:  1.147817611694336
mini_batch_src_global generation:  1.3343994617462158
r_  generation:  14.45321249961853
local_output_nid generation:  0.5424778461456299
local_in_edges_tensor generation:  1.0951786041259766
mini_batch_src_global generation:  1.4780454635620117
r_  generation:  14.30039119720459
local_output_nid generation:  0.5508513450622559
local_in_edges_tensor generation:  1.087493658065796
mini_batch_src_global generation:  1.4945833683013916
r_  generation:  14.633992910385132
local_output_nid generation:  0.5806879997253418
local_in_edges_tensor generation:  1.1393532752990723
mini_batch_src_global generation:  1.3770489692687988
r_  generation:  14.583891868591309
local_output_nid generation:  0.6436614990234375
local_in_edges_tensor generation:  1.1581299304962158
mini_batch_src_global generation:  1.3922812938690186
r_  generation:  14.780989646911621
local_output_nid generation:  0.567427396774292
local_in_edges_tensor generation:  1.1621592044830322
mini_batch_src_global generation:  1.3494391441345215
r_  generation:  14.614635705947876
local_output_nid generation:  0.5543239116668701
local_in_edges_tensor generation:  1.1446125507354736
mini_batch_src_global generation:  1.4041190147399902
r_  generation:  14.485844850540161
local_output_nid generation:  0.5724072456359863
local_in_edges_tensor generation:  2.6183173656463623
mini_batch_src_global generation:  1.4142332077026367
r_  generation:  14.446051597595215
local_output_nid generation:  0.5784788131713867
local_in_edges_tensor generation:  1.1581826210021973
mini_batch_src_global generation:  1.4762248992919922
r_  generation:  14.859631776809692
local_output_nid generation:  0.5835440158843994
local_in_edges_tensor generation:  1.1523292064666748
mini_batch_src_global generation:  1.333491325378418
r_  generation:  14.839738130569458
----------------------check_connections_block total spend ----------------------------- 324.36456418037415
generate_one_block  19.469639539718628
generate_one_block  19.220474243164062
generate_one_block  18.904544830322266
generate_one_block  18.729498624801636
generate_one_block  19.066115140914917
generate_one_block  19.07491183280945
generate_one_block  19.22706365585327
generate_one_block  19.833529233932495
generate_one_block  19.366090297698975
generate_one_block  19.08641505241394
generate_one_block  18.734347820281982
generate_one_block  19.143832206726074
generate_one_block  19.197829008102417
generate_one_block  19.18442416191101
generate_one_block  19.416017770767212
generate_one_block  19.298500299453735
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.811490535736084  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

connection checking time:  432.1538758277893
block generation total time  409.21686363220215
average batch blocks generation time:  25.576053977012634
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1276445388793945  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5632500648498535  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1269469261169434  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.563323974609375  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1283960342407227  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5672154426574707  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1265325546264648  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5595431327819824  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1292295455932617  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.568714141845703  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.128054141998291  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5686426162719727  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1299238204956055  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5690174102783203  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1294975280761719  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5698513984680176  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.564182758331299  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1262521743774414  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5595765113830566  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5645670890808105  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1302385330200195  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.572066307067871  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1277685165405273  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.563237190246582  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1282882690429688  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5690932273864746  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1287040710449219  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5700807571411133  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1261029243469238  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5619349479675293  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.24950934946537018 |0.30234406888484955 |0.0038002878427505493 |0.0001356750726699829 |0.0038345158100128174 |0.001245260238647461 |
----------------------------------------------------------pseudo_mini_loss sum 3.722620725631714
Total (block generation + training)time/epoch 889.960587978363
Training time/epoch 1647761137.5969644
Training time without block to device /epoch 1647761132.7594593
Training time without total dataloading part /epoch 0.12557291984558105
load block tensor time/epoch 3.992149591445923
block to device time/epoch 4.837505102157593
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  64148671
Number of first layer input nodes during this epoch:  34048908
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.8106298446655273  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.2960398197174072
random selection method range initialization spend 0.013712406158447266
time for parepare:  0.2827494144439697
local_output_nid generation:  0.006342411041259766
local_in_edges_tensor generation:  0.024508953094482422
mini_batch_src_global generation:  0.018170833587646484
r_  generation:  0.18700146675109863
local_output_nid generation:  0.0072405338287353516
local_in_edges_tensor generation:  0.008718252182006836
mini_batch_src_global generation:  0.02158951759338379
r_  generation:  0.21506977081298828
local_output_nid generation:  0.007161140441894531
local_in_edges_tensor generation:  0.00829935073852539
mini_batch_src_global generation:  0.01477670669555664
r_  generation:  0.22066378593444824
local_output_nid generation:  0.007261991500854492
local_in_edges_tensor generation:  0.006838560104370117
mini_batch_src_global generation:  0.015774011611938477
r_  generation:  0.23395323753356934
local_output_nid generation:  0.007108211517333984
local_in_edges_tensor generation:  0.0063860416412353516
mini_batch_src_global generation:  0.01592087745666504
r_  generation:  0.23813748359680176
local_output_nid generation:  0.007479429244995117
local_in_edges_tensor generation:  0.006430625915527344
mini_batch_src_global generation:  0.01868915557861328
r_  generation:  0.2506215572357178
local_output_nid generation:  0.007164955139160156
local_in_edges_tensor generation:  0.00630497932434082
mini_batch_src_global generation:  0.019388437271118164
r_  generation:  0.25754261016845703
local_output_nid generation:  0.007157087326049805
local_in_edges_tensor generation:  0.006309986114501953
mini_batch_src_global generation:  0.020981311798095703
r_  generation:  0.26671338081359863
local_output_nid generation:  0.007157802581787109
local_in_edges_tensor generation:  0.0062427520751953125
mini_batch_src_global generation:  0.019945859909057617
r_  generation:  0.2670121192932129
local_output_nid generation:  0.007132768630981445
local_in_edges_tensor generation:  0.006411552429199219
mini_batch_src_global generation:  0.021084308624267578
r_  generation:  0.26996493339538574
local_output_nid generation:  0.007174968719482422
local_in_edges_tensor generation:  0.0068624019622802734
mini_batch_src_global generation:  0.02245044708251953
r_  generation:  0.27277326583862305
local_output_nid generation:  0.007128477096557617
local_in_edges_tensor generation:  0.006860971450805664
mini_batch_src_global generation:  0.022740602493286133
r_  generation:  0.2770402431488037
local_output_nid generation:  0.007165431976318359
local_in_edges_tensor generation:  0.006872653961181641
mini_batch_src_global generation:  0.023115873336791992
r_  generation:  0.27135467529296875
local_output_nid generation:  0.007127523422241211
local_in_edges_tensor generation:  0.008150815963745117
mini_batch_src_global generation:  0.02339625358581543
r_  generation:  0.2772996425628662
local_output_nid generation:  0.007154703140258789
local_in_edges_tensor generation:  0.006914854049682617
mini_batch_src_global generation:  0.024216890335083008
r_  generation:  0.27466487884521484
local_output_nid generation:  0.007119417190551758
local_in_edges_tensor generation:  0.006821155548095703
mini_batch_src_global generation:  0.02477407455444336
r_  generation:  0.2755107879638672
----------------------check_connections_block total spend ----------------------------- 5.689589738845825
generate_one_block  0.6029086112976074
generate_one_block  0.3335764408111572
generate_one_block  0.29970526695251465
generate_one_block  0.2852745056152344
generate_one_block  0.28936171531677246
generate_one_block  0.2828643321990967
generate_one_block  0.28188276290893555
generate_one_block  0.28408122062683105
generate_one_block  0.2903411388397217
generate_one_block  0.2805509567260742
generate_one_block  0.287431001663208
generate_one_block  0.28406357765197754
generate_one_block  0.29193878173828125
generate_one_block  0.2832672595977783
generate_one_block  0.2883872985839844
generate_one_block  0.2828333377838135
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.969820261001587
gen group dst list time:  0.1676924228668213
time for parepare:  0.44783806800842285
local_output_nid generation:  0.11278223991394043
local_in_edges_tensor generation:  0.4175081253051758
mini_batch_src_global generation:  0.35938572883605957
r_  generation:  4.572522401809692
local_output_nid generation:  0.1415553092956543
local_in_edges_tensor generation:  0.28375768661499023
mini_batch_src_global generation:  0.4381422996520996
r_  generation:  4.657696723937988
local_output_nid generation:  0.11254334449768066
local_in_edges_tensor generation:  0.30607008934020996
mini_batch_src_global generation:  0.4385337829589844
r_  generation:  5.004165172576904
local_output_nid generation:  0.1398606300354004
local_in_edges_tensor generation:  0.4715704917907715
mini_batch_src_global generation:  0.4480109214782715
r_  generation:  4.847148180007935
local_output_nid generation:  0.11241292953491211
local_in_edges_tensor generation:  0.3021199703216553
mini_batch_src_global generation:  0.4564962387084961
r_  generation:  4.948645353317261
local_output_nid generation:  0.11194324493408203
local_in_edges_tensor generation:  0.2957627773284912
mini_batch_src_global generation:  0.4708688259124756
r_  generation:  4.97081446647644
local_output_nid generation:  0.11123013496398926
local_in_edges_tensor generation:  0.3680534362792969
mini_batch_src_global generation:  0.49431633949279785
r_  generation:  5.035609722137451
local_output_nid generation:  0.14069056510925293
local_in_edges_tensor generation:  0.31742334365844727
mini_batch_src_global generation:  0.4701273441314697
r_  generation:  4.908346176147461
local_output_nid generation:  0.1117544174194336
local_in_edges_tensor generation:  0.2922508716583252
mini_batch_src_global generation:  0.47745704650878906
r_  generation:  5.025796890258789
local_output_nid generation:  0.11141824722290039
local_in_edges_tensor generation:  0.28475141525268555
mini_batch_src_global generation:  0.4918055534362793
r_  generation:  5.063670873641968
local_output_nid generation:  0.11170482635498047
local_in_edges_tensor generation:  0.40986084938049316
mini_batch_src_global generation:  0.5175247192382812
r_  generation:  5.049504041671753
local_output_nid generation:  0.13958525657653809
local_in_edges_tensor generation:  0.2941868305206299
mini_batch_src_global generation:  0.48039865493774414
r_  generation:  5.012462854385376
local_output_nid generation:  0.11345863342285156
local_in_edges_tensor generation:  0.2852747440338135
mini_batch_src_global generation:  0.48382139205932617
r_  generation:  5.066524982452393
local_output_nid generation:  0.1116337776184082
local_in_edges_tensor generation:  0.28690338134765625
mini_batch_src_global generation:  0.4899742603302002
r_  generation:  5.191113471984863
local_output_nid generation:  0.13960480690002441
local_in_edges_tensor generation:  0.3957667350769043
mini_batch_src_global generation:  0.48264527320861816
r_  generation:  5.0115556716918945
local_output_nid generation:  0.111541748046875
local_in_edges_tensor generation:  0.2927889823913574
mini_batch_src_global generation:  0.47657322883605957
r_  generation:  4.999942779541016
----------------------check_connections_block total spend ----------------------------- 107.73498749732971
generate_one_block  6.705385208129883
generate_one_block  6.768800735473633
generate_one_block  6.336523532867432
generate_one_block  6.300347566604614
generate_one_block  6.262563943862915
generate_one_block  6.55027174949646
generate_one_block  6.120310068130493
generate_one_block  6.176908731460571
generate_one_block  6.286288022994995
generate_one_block  6.673219919204712
generate_one_block  6.159793376922607
generate_one_block  6.26332426071167
generate_one_block  6.255039691925049
generate_one_block  6.534084796905518
generate_one_block  6.188927888870239
generate_one_block  6.2185447216033936
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1109464168548584
gen group dst list time:  0.887894868850708
time for parepare:  0.4925541877746582
local_output_nid generation:  0.5417401790618896
local_in_edges_tensor generation:  1.236992597579956
mini_batch_src_global generation:  1.0237188339233398
r_  generation:  14.232088327407837
local_output_nid generation:  0.5850348472595215
local_in_edges_tensor generation:  1.2722296714782715
mini_batch_src_global generation:  1.4803593158721924
r_  generation:  14.218000888824463
local_output_nid generation:  0.563373327255249
local_in_edges_tensor generation:  1.1584186553955078
mini_batch_src_global generation:  1.4372279644012451
r_  generation:  14.56131649017334
local_output_nid generation:  0.5746183395385742
local_in_edges_tensor generation:  1.0825684070587158
mini_batch_src_global generation:  1.3310821056365967
r_  generation:  14.588390350341797
local_output_nid generation:  0.5340595245361328
local_in_edges_tensor generation:  1.1085243225097656
mini_batch_src_global generation:  1.4631216526031494
r_  generation:  14.829166889190674
local_output_nid generation:  0.5704519748687744
local_in_edges_tensor generation:  1.1679720878601074
mini_batch_src_global generation:  1.5465087890625
r_  generation:  14.480712413787842
local_output_nid generation:  0.5612080097198486
local_in_edges_tensor generation:  1.1036884784698486
mini_batch_src_global generation:  1.4156312942504883
r_  generation:  14.727536678314209
local_output_nid generation:  0.5695054531097412
local_in_edges_tensor generation:  1.114473819732666
mini_batch_src_global generation:  1.3533313274383545
r_  generation:  15.13287091255188
local_output_nid generation:  0.5368936061859131
local_in_edges_tensor generation:  1.168807029724121
mini_batch_src_global generation:  1.3885698318481445
r_  generation:  14.480983018875122
local_output_nid generation:  0.5745565891265869
local_in_edges_tensor generation:  1.138847827911377
mini_batch_src_global generation:  1.375826358795166
r_  generation:  14.751955509185791
local_output_nid generation:  0.5885946750640869
local_in_edges_tensor generation:  1.100421667098999
mini_batch_src_global generation:  1.421295166015625
r_  generation:  15.032365798950195
local_output_nid generation:  0.5702462196350098
local_in_edges_tensor generation:  1.1904029846191406
mini_batch_src_global generation:  1.3923237323760986
r_  generation:  14.676696062088013
local_output_nid generation:  0.5554463863372803
local_in_edges_tensor generation:  1.0942232608795166
mini_batch_src_global generation:  1.4480531215667725
r_  generation:  14.831944465637207
local_output_nid generation:  0.5767433643341064
local_in_edges_tensor generation:  2.6008899211883545
mini_batch_src_global generation:  1.3615081310272217
r_  generation:  14.91161298751831
local_output_nid generation:  0.5436034202575684
local_in_edges_tensor generation:  1.162623643875122
mini_batch_src_global generation:  1.3639941215515137
r_  generation:  14.869190692901611
local_output_nid generation:  0.5509843826293945
local_in_edges_tensor generation:  1.1054551601409912
mini_batch_src_global generation:  1.3595685958862305
r_  generation:  14.557114124298096
----------------------check_connections_block total spend ----------------------------- 327.553316116333
generate_one_block  19.495594024658203
generate_one_block  19.455247163772583
generate_one_block  19.720043420791626
generate_one_block  19.558226823806763
generate_one_block  19.454460859298706
generate_one_block  18.88312530517578
generate_one_block  19.396809577941895
generate_one_block  19.66630244255066
generate_one_block  19.288830280303955
generate_one_block  19.3554105758667
generate_one_block  19.551995754241943
generate_one_block  19.424277544021606
generate_one_block  19.356239318847656
generate_one_block  18.93873906135559
generate_one_block  19.430382251739502
generate_one_block  19.376736640930176
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.8106298446655273  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

connection checking time:  435.2883036136627
block generation total time  412.15275526046753
average batch blocks generation time:  25.75954720377922
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1276798248291016  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5664477348327637  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1282663345336914  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5676259994506836  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1286406517028809  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.570831775665283  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1280059814453125  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5696029663085938  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1289072036743164  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5698418617248535  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.563601016998291  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.12841796875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5624585151672363  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1278514862060547  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.562643051147461  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1286892890930176  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5700716972351074  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1276741027832031  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5666985511779785  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.129255771636963  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.571992874145508  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1278810501098633  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5685434341430664  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1269359588623047  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5633459091186523  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5633106231689453  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1288719177246094  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.569413661956787  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1276545524597168  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.55940580368042  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2525978237390518 |0.3119466304779053 |0.003933221101760864 |0.00013998150825500488 |0.0039399415254592896 |0.0012133121490478516 |
----------------------------------------------------------pseudo_mini_loss sum 3.1386914253234863
Total (block generation + training)time/epoch 893.0977091789246
Training time/epoch 1647762033.8321557
Training time without block to device /epoch 1647762028.8410096
Training time without total dataloading part /epoch 0.1294236183166504
load block tensor time/epoch 4.041565179824829
block to device time/epoch 4.991146087646484
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  64148879
Number of first layer input nodes during this epoch:  34048283
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.812793254852295  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.29541659355163574
random selection method range initialization spend 0.015253543853759766
time for parepare:  0.28325486183166504
local_output_nid generation:  0.006546497344970703
local_in_edges_tensor generation:  0.031136512756347656
mini_batch_src_global generation:  0.017875194549560547
r_  generation:  0.19293618202209473
local_output_nid generation:  0.0072460174560546875
local_in_edges_tensor generation:  0.008906126022338867
mini_batch_src_global generation:  0.02247166633605957
r_  generation:  0.21580219268798828
local_output_nid generation:  0.007273197174072266
local_in_edges_tensor generation:  0.006834506988525391
mini_batch_src_global generation:  0.014893293380737305
r_  generation:  0.2244582176208496
local_output_nid generation:  0.0072803497314453125
local_in_edges_tensor generation:  0.006938457489013672
mini_batch_src_global generation:  0.01663970947265625
r_  generation:  0.235015869140625
local_output_nid generation:  0.007244586944580078
local_in_edges_tensor generation:  0.00641179084777832
mini_batch_src_global generation:  0.015912771224975586
r_  generation:  0.2428591251373291
local_output_nid generation:  0.007332324981689453
local_in_edges_tensor generation:  0.007652759552001953
mini_batch_src_global generation:  0.01682734489440918
r_  generation:  0.2524864673614502
local_output_nid generation:  0.007300853729248047
local_in_edges_tensor generation:  0.006479024887084961
mini_batch_src_global generation:  0.017046689987182617
r_  generation:  0.26097893714904785
local_output_nid generation:  0.007263898849487305
local_in_edges_tensor generation:  0.0064220428466796875
mini_batch_src_global generation:  0.01735663414001465
r_  generation:  0.26540207862854004
local_output_nid generation:  0.0072629451751708984
local_in_edges_tensor generation:  0.007642030715942383
mini_batch_src_global generation:  0.017467975616455078
r_  generation:  0.2651975154876709
local_output_nid generation:  0.0072231292724609375
local_in_edges_tensor generation:  0.007073163986206055
mini_batch_src_global generation:  0.01865839958190918
r_  generation:  0.2720370292663574
local_output_nid generation:  0.007241725921630859
local_in_edges_tensor generation:  0.0069386959075927734
mini_batch_src_global generation:  0.02002239227294922
r_  generation:  0.2782163619995117
local_output_nid generation:  0.00729060173034668
local_in_edges_tensor generation:  0.006411314010620117
mini_batch_src_global generation:  0.020212650299072266
r_  generation:  0.27581787109375
local_output_nid generation:  0.007277727127075195
local_in_edges_tensor generation:  0.007036685943603516
mini_batch_src_global generation:  0.02145075798034668
r_  generation:  0.2761247158050537
local_output_nid generation:  0.007268667221069336
local_in_edges_tensor generation:  0.006281614303588867
mini_batch_src_global generation:  0.020933151245117188
r_  generation:  0.2788887023925781
local_output_nid generation:  0.007288217544555664
local_in_edges_tensor generation:  0.007054328918457031
mini_batch_src_global generation:  0.02566981315612793
r_  generation:  0.28111720085144043
local_output_nid generation:  0.0073626041412353516
local_in_edges_tensor generation:  0.006564617156982422
mini_batch_src_global generation:  0.022182464599609375
r_  generation:  0.2825024127960205
----------------------check_connections_block total spend ----------------------------- 5.741083860397339
generate_one_block  0.5908064842224121
generate_one_block  0.3324308395385742
generate_one_block  0.29907822608947754
generate_one_block  0.28870224952697754
generate_one_block  0.2927570343017578
generate_one_block  0.28762388229370117
generate_one_block  0.2854878902435303
generate_one_block  0.2857780456542969
generate_one_block  0.2863173484802246
generate_one_block  0.2883884906768799
generate_one_block  0.286715030670166
generate_one_block  0.28544187545776367
generate_one_block  0.2912933826446533
generate_one_block  0.2859835624694824
generate_one_block  0.2911083698272705
generate_one_block  0.2835104465484619
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9204981327056885
gen group dst list time:  0.16735291481018066
time for parepare:  0.4268369674682617
local_output_nid generation:  0.1168673038482666
local_in_edges_tensor generation:  0.35617733001708984
mini_batch_src_global generation:  0.3547072410583496
r_  generation:  4.79564356803894
local_output_nid generation:  0.11940407752990723
local_in_edges_tensor generation:  0.4805014133453369
mini_batch_src_global generation:  0.46260666847229004
r_  generation:  4.778574228286743
local_output_nid generation:  0.13906240463256836
local_in_edges_tensor generation:  0.30390024185180664
mini_batch_src_global generation:  0.4319193363189697
r_  generation:  5.001111030578613
local_output_nid generation:  0.11388325691223145
local_in_edges_tensor generation:  0.3904566764831543
mini_batch_src_global generation:  0.500324010848999
r_  generation:  5.061826944351196
local_output_nid generation:  0.13335251808166504
local_in_edges_tensor generation:  0.299302339553833
mini_batch_src_global generation:  0.44771456718444824
r_  generation:  5.06536340713501
local_output_nid generation:  0.12445402145385742
local_in_edges_tensor generation:  0.28781723976135254
mini_batch_src_global generation:  0.47425270080566406
r_  generation:  5.128667116165161
local_output_nid generation:  0.11409425735473633
local_in_edges_tensor generation:  0.34534192085266113
mini_batch_src_global generation:  0.4755229949951172
r_  generation:  5.282989025115967
local_output_nid generation:  0.13680362701416016
local_in_edges_tensor generation:  0.348299503326416
mini_batch_src_global generation:  0.4737818241119385
r_  generation:  5.0409605503082275
local_output_nid generation:  0.12199735641479492
local_in_edges_tensor generation:  0.2966141700744629
mini_batch_src_global generation:  0.47483205795288086
r_  generation:  5.140819787979126
local_output_nid generation:  0.11353731155395508
local_in_edges_tensor generation:  0.28514790534973145
mini_batch_src_global generation:  0.47393321990966797
r_  generation:  5.344481468200684
local_output_nid generation:  0.1273188591003418
local_in_edges_tensor generation:  0.40291786193847656
mini_batch_src_global generation:  0.5011477470397949
r_  generation:  5.141226530075073
local_output_nid generation:  0.12249517440795898
local_in_edges_tensor generation:  0.29479432106018066
mini_batch_src_global generation:  0.4782447814941406
r_  generation:  5.160246133804321
local_output_nid generation:  0.12177753448486328
local_in_edges_tensor generation:  0.29460883140563965
mini_batch_src_global generation:  0.4854300022125244
r_  generation:  5.145719289779663
local_output_nid generation:  0.11299443244934082
local_in_edges_tensor generation:  0.39741969108581543
mini_batch_src_global generation:  0.527400016784668
r_  generation:  5.18352484703064
local_output_nid generation:  0.1326603889465332
local_in_edges_tensor generation:  0.2980227470397949
mini_batch_src_global generation:  0.4819333553314209
r_  generation:  5.100572109222412
local_output_nid generation:  0.12107038497924805
local_in_edges_tensor generation:  0.2903895378112793
mini_batch_src_global generation:  0.4834167957305908
r_  generation:  5.129751920700073
----------------------check_connections_block total spend ----------------------------- 110.1570930480957
generate_one_block  6.715156078338623
generate_one_block  6.896885871887207
generate_one_block  6.208528280258179
generate_one_block  6.285245418548584
generate_one_block  6.33851170539856
generate_one_block  6.620115518569946
generate_one_block  6.241902112960815
generate_one_block  6.255017280578613
generate_one_block  6.322213649749756
generate_one_block  6.70417594909668
generate_one_block  6.242422342300415
generate_one_block  6.296989917755127
generate_one_block  6.403928518295288
generate_one_block  6.451297044754028
generate_one_block  6.237170696258545
generate_one_block  6.29235053062439
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1001780033111572
gen group dst list time:  0.8582961559295654
time for parepare:  0.4596421718597412
local_output_nid generation:  0.5187466144561768
local_in_edges_tensor generation:  1.1666808128356934
mini_batch_src_global generation:  1.0241978168487549
r_  generation:  14.195887804031372
local_output_nid generation:  0.5773847103118896
local_in_edges_tensor generation:  1.1591241359710693
mini_batch_src_global generation:  1.4454505443572998
r_  generation:  14.111110925674438
local_output_nid generation:  0.5839636325836182
local_in_edges_tensor generation:  1.1468050479888916
mini_batch_src_global generation:  1.6436259746551514
r_  generation:  14.864007711410522
local_output_nid generation:  0.5766191482543945
local_in_edges_tensor generation:  1.2731988430023193
mini_batch_src_global generation:  1.5526659488677979
r_  generation:  14.499771356582642
local_output_nid generation:  0.5611021518707275
local_in_edges_tensor generation:  1.1030948162078857
mini_batch_src_global generation:  1.4714882373809814
r_  generation:  14.630349159240723
local_output_nid generation:  0.5785801410675049
local_in_edges_tensor generation:  1.09214186668396
mini_batch_src_global generation:  1.3489110469818115
r_  generation:  14.829065799713135
local_output_nid generation:  0.5408744812011719
local_in_edges_tensor generation:  1.1724085807800293
mini_batch_src_global generation:  1.3623528480529785
r_  generation:  14.559485912322998
local_output_nid generation:  0.5593726634979248
local_in_edges_tensor generation:  1.094273567199707
mini_batch_src_global generation:  1.4470980167388916
r_  generation:  14.451476573944092
local_output_nid generation:  0.5716934204101562
local_in_edges_tensor generation:  1.1161539554595947
mini_batch_src_global generation:  1.4046378135681152
r_  generation:  14.736276626586914
local_output_nid generation:  0.5684106349945068
local_in_edges_tensor generation:  1.1706302165985107
mini_batch_src_global generation:  1.3870978355407715
r_  generation:  16.13511896133423
local_output_nid generation:  0.5893921852111816
local_in_edges_tensor generation:  1.1918931007385254
mini_batch_src_global generation:  1.5106377601623535
r_  generation:  14.82126235961914
local_output_nid generation:  0.5788967609405518
local_in_edges_tensor generation:  1.1762924194335938
mini_batch_src_global generation:  1.355417013168335
r_  generation:  15.201960802078247
local_output_nid generation:  0.5602762699127197
local_in_edges_tensor generation:  1.1616857051849365
mini_batch_src_global generation:  1.345642328262329
r_  generation:  14.799614906311035
local_output_nid generation:  0.543402910232544
local_in_edges_tensor generation:  2.714148759841919
mini_batch_src_global generation:  1.3994696140289307
r_  generation:  14.627560377120972
local_output_nid generation:  0.5875594615936279
local_in_edges_tensor generation:  1.0920729637145996
mini_batch_src_global generation:  1.4944980144500732
r_  generation:  14.934372901916504
local_output_nid generation:  0.5805013179779053
local_in_edges_tensor generation:  1.1562540531158447
mini_batch_src_global generation:  1.3458061218261719
r_  generation:  15.195813655853271
----------------------check_connections_block total spend ----------------------------- 329.91724729537964
generate_one_block  19.564600944519043
generate_one_block  19.749887943267822
generate_one_block  20.199172496795654
generate_one_block  19.81603741645813
generate_one_block  19.611711025238037
generate_one_block  18.962846517562866
generate_one_block  19.371147394180298
generate_one_block  20.14847493171692
generate_one_block  19.346937656402588
generate_one_block  19.500529289245605
generate_one_block  19.664000988006592
generate_one_block  19.453283309936523
generate_one_block  19.46976399421692
generate_one_block  19.609541177749634
generate_one_block  19.346657752990723
generate_one_block  19.608673095703125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.812793254852295  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

connection checking time:  440.07434034347534
block generation total time  415.93517684936523
average batch blocks generation time:  25.995948553085327
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.126363754272461  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.566751480102539  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1278319358825684  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.56292724609375  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127556324005127  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5631232261657715  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1287789344787598  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5686583518981934  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1306953430175781  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.569827079772949  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1283297538757324  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.568554401397705  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.129671573638916  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5718164443969727  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1280713081359863  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.567657947540283  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1262645721435547  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5618410110473633  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1288270950317383  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.570467472076416  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1287388801574707  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5694174766540527  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1280498504638672  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.563976764678955  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1276631355285645  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5662989616394043  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1272335052490234  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.560851573944092  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1280755996704102  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5678534507751465  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1276545524597168  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.563568592071533  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2579759955406189 |0.37541697919368744 |0.00392383337020874 |0.000142022967338562 |0.003934383392333984 |0.001216888427734375 |
----------------------------------------------------------pseudo_mini_loss sum 2.6981279850006104
Total (block generation + training)time/epoch 897.3021748860677
Training time/epoch 1647762939.54367
Training time without block to device /epoch 1647762933.5369983
Training time without total dataloading part /epoch 0.12922072410583496
load block tensor time/epoch 4.127615928649902
block to device time/epoch 6.006671667098999
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  64155771
Number of first layer input nodes during this epoch:  34055038
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.8123526573181152  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32416629791259766
random selection method range initialization spend 0.01221776008605957
time for parepare:  0.2981102466583252
local_output_nid generation:  0.006476879119873047
local_in_edges_tensor generation:  0.029767513275146484
mini_batch_src_global generation:  0.018034696578979492
r_  generation:  0.18952059745788574
local_output_nid generation:  0.007221698760986328
local_in_edges_tensor generation:  0.008903980255126953
mini_batch_src_global generation:  0.021610021591186523
r_  generation:  0.21632719039916992
local_output_nid generation:  0.007213115692138672
local_in_edges_tensor generation:  0.0069789886474609375
mini_batch_src_global generation:  0.015717267990112305
r_  generation:  0.22806477546691895
local_output_nid generation:  0.007553815841674805
local_in_edges_tensor generation:  0.00652313232421875
mini_batch_src_global generation:  0.029760360717773438
r_  generation:  0.23522353172302246
local_output_nid generation:  0.00722050666809082
local_in_edges_tensor generation:  0.0064961910247802734
mini_batch_src_global generation:  0.015924453735351562
r_  generation:  0.24352288246154785
local_output_nid generation:  0.007231712341308594
local_in_edges_tensor generation:  0.006351947784423828
mini_batch_src_global generation:  0.018582582473754883
r_  generation:  0.25827836990356445
local_output_nid generation:  0.007415056228637695
local_in_edges_tensor generation:  0.007077455520629883
mini_batch_src_global generation:  0.01955270767211914
r_  generation:  0.2639451026916504
local_output_nid generation:  0.00724339485168457
local_in_edges_tensor generation:  0.007002592086791992
mini_batch_src_global generation:  0.019931554794311523
r_  generation:  0.2682366371154785
local_output_nid generation:  0.007224321365356445
local_in_edges_tensor generation:  0.008091926574707031
mini_batch_src_global generation:  0.019936323165893555
r_  generation:  0.26889634132385254
local_output_nid generation:  0.00721430778503418
local_in_edges_tensor generation:  0.008434534072875977
mini_batch_src_global generation:  0.021363258361816406
r_  generation:  0.27456188201904297
local_output_nid generation:  0.007267475128173828
local_in_edges_tensor generation:  0.007138252258300781
mini_batch_src_global generation:  0.022678136825561523
r_  generation:  0.27854490280151367
local_output_nid generation:  0.007213592529296875
local_in_edges_tensor generation:  0.007056474685668945
mini_batch_src_global generation:  0.023085832595825195
r_  generation:  0.284590482711792
local_output_nid generation:  0.007253885269165039
local_in_edges_tensor generation:  0.007673025131225586
mini_batch_src_global generation:  0.023410320281982422
r_  generation:  0.27527666091918945
local_output_nid generation:  0.007200717926025391
local_in_edges_tensor generation:  0.0069391727447509766
mini_batch_src_global generation:  0.023530244827270508
r_  generation:  0.28409838676452637
local_output_nid generation:  0.008889913558959961
local_in_edges_tensor generation:  0.007062673568725586
mini_batch_src_global generation:  0.024469852447509766
r_  generation:  0.28469109535217285
local_output_nid generation:  0.007202863693237305
local_in_edges_tensor generation:  0.006883859634399414
mini_batch_src_global generation:  0.024985790252685547
r_  generation:  0.28443431854248047
----------------------check_connections_block total spend ----------------------------- 5.833409547805786
generate_one_block  0.6302993297576904
generate_one_block  0.3444952964782715
generate_one_block  0.31201601028442383
generate_one_block  0.3011050224304199
generate_one_block  0.3097531795501709
generate_one_block  0.3036820888519287
generate_one_block  0.29474759101867676
generate_one_block  0.29935503005981445
generate_one_block  0.2956507205963135
generate_one_block  0.31055164337158203
generate_one_block  0.5169134140014648
generate_one_block  0.42377233505249023
generate_one_block  0.33333778381347656
generate_one_block  0.3091733455657959
generate_one_block  0.30025291442871094
generate_one_block  0.29573869705200195
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.082037925720215
gen group dst list time:  0.15137219429016113
time for parepare:  0.4360013008117676
local_output_nid generation:  0.11249661445617676
local_in_edges_tensor generation:  0.40742015838623047
mini_batch_src_global generation:  0.3536815643310547
r_  generation:  4.763500213623047
local_output_nid generation:  0.11768245697021484
local_in_edges_tensor generation:  0.547804594039917
mini_batch_src_global generation:  0.5115413665771484
r_  generation:  4.792363405227661
local_output_nid generation:  0.14008283615112305
local_in_edges_tensor generation:  0.3056795597076416
mini_batch_src_global generation:  0.42970848083496094
r_  generation:  5.007314205169678
local_output_nid generation:  0.11168670654296875
local_in_edges_tensor generation:  0.40001726150512695
mini_batch_src_global generation:  0.524993896484375
r_  generation:  4.990370750427246
local_output_nid generation:  0.13064885139465332
local_in_edges_tensor generation:  0.3022027015686035
mini_batch_src_global generation:  0.4631528854370117
r_  generation:  5.048111438751221
local_output_nid generation:  0.11281442642211914
local_in_edges_tensor generation:  0.2879936695098877
mini_batch_src_global generation:  0.46970605850219727
r_  generation:  5.157366991043091
local_output_nid generation:  0.11855196952819824
local_in_edges_tensor generation:  0.34598779678344727
mini_batch_src_global generation:  0.5070016384124756
r_  generation:  5.198570728302002
local_output_nid generation:  0.1416487693786621
local_in_edges_tensor generation:  0.3577113151550293
mini_batch_src_global generation:  0.47302746772766113
r_  generation:  5.228198528289795
local_output_nid generation:  0.11264729499816895
local_in_edges_tensor generation:  0.2983517646789551
mini_batch_src_global generation:  0.4871830940246582
r_  generation:  5.1744396686553955
local_output_nid generation:  0.11217856407165527
local_in_edges_tensor generation:  0.2865769863128662
mini_batch_src_global generation:  0.48684144020080566
r_  generation:  5.276257514953613
local_output_nid generation:  0.11222386360168457
local_in_edges_tensor generation:  0.4050300121307373
mini_batch_src_global generation:  0.5094077587127686
r_  generation:  5.1220386028289795
local_output_nid generation:  0.13245463371276855
local_in_edges_tensor generation:  0.2981283664703369
mini_batch_src_global generation:  0.48060059547424316
r_  generation:  5.1699230670928955
local_output_nid generation:  0.11280226707458496
local_in_edges_tensor generation:  0.2896854877471924
mini_batch_src_global generation:  0.48955869674682617
r_  generation:  5.218468189239502
local_output_nid generation:  0.11190462112426758
local_in_edges_tensor generation:  0.4027688503265381
mini_batch_src_global generation:  0.5314192771911621
r_  generation:  5.205492734909058
local_output_nid generation:  0.1409766674041748
local_in_edges_tensor generation:  0.29581260681152344
mini_batch_src_global generation:  0.4858555793762207
r_  generation:  5.1443095207214355
local_output_nid generation:  0.11154413223266602
local_in_edges_tensor generation:  0.290647029876709
mini_batch_src_global generation:  0.4818093776702881
r_  generation:  5.156832218170166
----------------------check_connections_block total spend ----------------------------- 110.70754337310791
generate_one_block  6.792215824127197
generate_one_block  6.947758674621582
generate_one_block  6.184296131134033
generate_one_block  6.309929370880127
generate_one_block  6.323026418685913
generate_one_block  6.608483791351318
generate_one_block  6.223668813705444
generate_one_block  6.340184211730957
generate_one_block  6.37771201133728
generate_one_block  6.596541404724121
generate_one_block  6.255428791046143
generate_one_block  6.299343824386597
generate_one_block  6.587590217590332
generate_one_block  6.2077367305755615
generate_one_block  6.228622674942017
generate_one_block  6.326838254928589
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3286478519439697
gen group dst list time:  0.8680276870727539
time for parepare:  0.49190592765808105
local_output_nid generation:  0.5333998203277588
local_in_edges_tensor generation:  1.2767562866210938
mini_batch_src_global generation:  1.0999255180358887
r_  generation:  14.841384887695312
local_output_nid generation:  0.5750195980072021
local_in_edges_tensor generation:  1.2216463088989258
mini_batch_src_global generation:  1.4252138137817383
r_  generation:  14.221412658691406
local_output_nid generation:  0.5304696559906006
local_in_edges_tensor generation:  1.1713624000549316
mini_batch_src_global generation:  1.4284069538116455
r_  generation:  14.607906818389893
local_output_nid generation:  0.568171501159668
local_in_edges_tensor generation:  1.1597211360931396
mini_batch_src_global generation:  1.3389244079589844
r_  generation:  14.948063850402832
local_output_nid generation:  0.5341188907623291
local_in_edges_tensor generation:  1.1714231967926025
mini_batch_src_global generation:  1.3489577770233154
r_  generation:  14.46102523803711
local_output_nid generation:  0.5231006145477295
local_in_edges_tensor generation:  1.0873420238494873
mini_batch_src_global generation:  1.3701987266540527
r_  generation:  14.506341457366943
local_output_nid generation:  0.5548491477966309
local_in_edges_tensor generation:  1.0836188793182373
mini_batch_src_global generation:  1.3939292430877686
r_  generation:  14.703146934509277
local_output_nid generation:  0.5617043972015381
local_in_edges_tensor generation:  1.143587589263916
mini_batch_src_global generation:  1.3683090209960938
r_  generation:  14.535295724868774
local_output_nid generation:  0.5112748146057129
local_in_edges_tensor generation:  1.1006321907043457
mini_batch_src_global generation:  1.4503941535949707
r_  generation:  14.578038692474365
local_output_nid generation:  0.5761194229125977
local_in_edges_tensor generation:  1.097564697265625
mini_batch_src_global generation:  1.3946533203125
r_  generation:  14.5633544921875
local_output_nid generation:  0.5554478168487549
local_in_edges_tensor generation:  1.1544976234436035
mini_batch_src_global generation:  1.3415179252624512
r_  generation:  14.8298659324646
local_output_nid generation:  0.5340135097503662
local_in_edges_tensor generation:  1.185107946395874
mini_batch_src_global generation:  1.3813979625701904
r_  generation:  14.39198637008667
local_output_nid generation:  0.5328826904296875
local_in_edges_tensor generation:  1.0825114250183105
mini_batch_src_global generation:  1.485755443572998
r_  generation:  14.43708348274231
local_output_nid generation:  0.5617694854736328
local_in_edges_tensor generation:  2.636540174484253
mini_batch_src_global generation:  1.340742588043213
r_  generation:  14.680587530136108
local_output_nid generation:  0.5481970310211182
local_in_edges_tensor generation:  1.1527934074401855
mini_batch_src_global generation:  1.3942041397094727
r_  generation:  14.674235820770264
local_output_nid generation:  0.5267233848571777
local_in_edges_tensor generation:  1.1708810329437256
mini_batch_src_global generation:  1.4046504497528076
r_  generation:  14.509385347366333
----------------------check_connections_block total spend ----------------------------- 325.2705292701721
generate_one_block  19.22282314300537
generate_one_block  19.169538021087646
generate_one_block  19.018988370895386
generate_one_block  19.070411443710327
generate_one_block  19.295161247253418
generate_one_block  19.355836629867554
generate_one_block  19.376650094985962
generate_one_block  19.745694875717163
generate_one_block  19.11326003074646
generate_one_block  19.48344659805298
generate_one_block  19.266378164291382
generate_one_block  19.20054793357849
generate_one_block  19.19065761566162
generate_one_block  19.23241901397705
generate_one_block  19.0966477394104
generate_one_block  19.36074709892273
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.8123526573181152  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

connection checking time:  435.97807264328003
block generation total time  410.80858516693115
average batch blocks generation time:  25.675536572933197
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1276297569274902  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.568253993988037  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1283016204833984  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5662918090820312  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1262226104736328  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.561868667602539  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1281356811523438  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5670833587646484  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1287274360656738  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5708727836608887  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.128715991973877  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5693893432617188  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5633444786071777  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1272430419921875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5678324699401855  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.563660144805908  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1270346641540527  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.563291072845459  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1298627853393555  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.570864200592041  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.128422737121582  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.5682787895202637  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1276779174804688  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.564263343811035  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1298761367797852  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.572817802429199  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.127655029296875  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.564492702484131  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 1.1274380683898926  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4725341796875 GB
    Memory Allocated: 2.564849853515625  GigaBytes
Max Memory Allocated: 3.3093161582946777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.24991869926452637 |0.3109843581914902 |0.004323869943618774 |0.00014770030975341797 |0.0038403719663619995 |0.0013070106506347656 |
----------------------------------------------------------pseudo_mini_loss sum 2.397995948791504
Total (block generation + training)time/epoch 897.2409926056862
Training time/epoch 1647763836.601411
Training time without block to device /epoch 1647763831.6256614Using backend: pytorch

Training time without total dataloading part /epoch 0.13429808616638184
load block tensor time/epoch 3.998699188232422
block to device time/epoch 4.975749731063843
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  64167803
Number of first layer input nodes during this epoch:  34055182
