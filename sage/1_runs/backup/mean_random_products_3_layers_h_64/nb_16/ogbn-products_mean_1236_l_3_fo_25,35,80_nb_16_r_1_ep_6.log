main start at this time 1647794917.8152738
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5884735584259033
random selection method range initialization spend 0.016727685928344727
time for parepare:  0.374788761138916
local_output_nid generation:  0.007142305374145508
local_in_edges_tensor generation:  0.03908705711364746
mini_batch_src_global generation:  0.026086091995239258
r_  generation:  0.36687421798706055
local_output_nid generation:  0.007290363311767578
local_in_edges_tensor generation:  0.018694639205932617
mini_batch_src_global generation:  0.03366279602050781
r_  generation:  0.414992094039917
local_output_nid generation:  0.0072934627532958984
local_in_edges_tensor generation:  0.012091636657714844
mini_batch_src_global generation:  0.026479721069335938
r_  generation:  0.43140697479248047
local_output_nid generation:  0.0072727203369140625
local_in_edges_tensor generation:  0.010666131973266602
mini_batch_src_global generation:  0.0259549617767334
r_  generation:  0.46612024307250977
local_output_nid generation:  0.007316112518310547
local_in_edges_tensor generation:  0.009279727935791016
mini_batch_src_global generation:  0.028157711029052734
r_  generation:  0.47162914276123047
local_output_nid generation:  0.007275104522705078
local_in_edges_tensor generation:  0.009317398071289062
mini_batch_src_global generation:  0.03165602684020996
r_  generation:  0.5024251937866211
local_output_nid generation:  0.007193088531494141
local_in_edges_tensor generation:  0.009505748748779297
mini_batch_src_global generation:  0.03251051902770996
r_  generation:  0.5108661651611328
local_output_nid generation:  0.0073130130767822266
local_in_edges_tensor generation:  0.009595870971679688
mini_batch_src_global generation:  0.03370213508605957
r_  generation:  0.5166647434234619
local_output_nid generation:  0.007272958755493164
local_in_edges_tensor generation:  0.009634017944335938
mini_batch_src_global generation:  0.034844160079956055
r_  generation:  0.516639232635498
local_output_nid generation:  0.00724482536315918
local_in_edges_tensor generation:  0.009264707565307617
mini_batch_src_global generation:  0.03597426414489746
r_  generation:  0.5216081142425537
local_output_nid generation:  0.0071904659271240234
local_in_edges_tensor generation:  0.009428977966308594
mini_batch_src_global generation:  0.037996768951416016
r_  generation:  0.5211408138275146
local_output_nid generation:  0.007251262664794922
local_in_edges_tensor generation:  0.009464025497436523
mini_batch_src_global generation:  0.039826393127441406
r_  generation:  0.5302839279174805
local_output_nid generation:  0.007237672805786133
local_in_edges_tensor generation:  0.009511232376098633
mini_batch_src_global generation:  0.040495872497558594
r_  generation:  0.5330216884613037
local_output_nid generation:  0.007235050201416016
local_in_edges_tensor generation:  0.009123563766479492
mini_batch_src_global generation:  0.0416254997253418
r_  generation:  0.5371570587158203
local_output_nid generation:  0.007210493087768555
local_in_edges_tensor generation:  0.009397029876708984
mini_batch_src_global generation:  0.042095184326171875
r_  generation:  0.5307841300964355
local_output_nid generation:  0.007253170013427734
local_in_edges_tensor generation:  0.009506464004516602
mini_batch_src_global generation:  0.04291105270385742
r_  generation:  0.5316781997680664
----------------------check_connections_block total spend ----------------------------- 10.500714540481567
generate_one_block  5.767741441726685
generate_one_block  0.5051572322845459
generate_one_block  0.5248947143554688
generate_one_block  0.5086390972137451
generate_one_block  0.5103144645690918
generate_one_block  0.5123424530029297
generate_one_block  0.512331485748291
generate_one_block  0.5104508399963379
generate_one_block  0.5109009742736816
generate_one_block  0.5103576183319092
generate_one_block  0.5241281986236572
generate_one_block  0.5171709060668945
generate_one_block  0.5046603679656982
generate_one_block  0.5107378959655762
generate_one_block  0.508782148361206
generate_one_block  0.50996994972229
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.3335914611816406
gen group dst list time:  0.2334423065185547
time for parepare:  0.4582364559173584
local_output_nid generation:  0.1625382900238037
local_in_edges_tensor generation:  0.5679225921630859
mini_batch_src_global generation:  0.5260415077209473
r_  generation:  6.900540113449097
local_output_nid generation:  0.20322370529174805
local_in_edges_tensor generation:  0.5695135593414307
mini_batch_src_global generation:  0.6694750785827637
r_  generation:  7.028211832046509
local_output_nid generation:  0.2055511474609375
local_in_edges_tensor generation:  0.6581721305847168
mini_batch_src_global generation:  0.6509134769439697
r_  generation:  6.9324586391448975
local_output_nid generation:  0.1701526641845703
local_in_edges_tensor generation:  0.4406259059906006
mini_batch_src_global generation:  0.6741859912872314
r_  generation:  6.967957258224487
local_output_nid generation:  0.18250203132629395
local_in_edges_tensor generation:  0.5708115100860596
mini_batch_src_global generation:  0.6901888847351074
r_  generation:  6.955903768539429
local_output_nid generation:  0.18761777877807617
local_in_edges_tensor generation:  0.4427933692932129
mini_batch_src_global generation:  0.7315678596496582
r_  generation:  7.124621629714966
local_output_nid generation:  0.17318105697631836
local_in_edges_tensor generation:  0.5641648769378662
mini_batch_src_global generation:  0.701286792755127
r_  generation:  7.076779842376709
local_output_nid generation:  0.2053389549255371
local_in_edges_tensor generation:  0.44199085235595703
mini_batch_src_global generation:  0.6971654891967773
r_  generation:  7.119817733764648
local_output_nid generation:  0.1753244400024414
local_in_edges_tensor generation:  0.4363877773284912
mini_batch_src_global generation:  0.7102110385894775
r_  generation:  7.1125404834747314
local_output_nid generation:  0.18493127822875977
local_in_edges_tensor generation:  0.5718357563018799
mini_batch_src_global generation:  0.6915013790130615
r_  generation:  7.047374725341797
local_output_nid generation:  0.18343687057495117
local_in_edges_tensor generation:  0.4456155300140381
mini_batch_src_global generation:  0.7320058345794678
r_  generation:  7.187476634979248
local_output_nid generation:  0.1771998405456543
local_in_edges_tensor generation:  0.5538649559020996
mini_batch_src_global generation:  0.7024145126342773
r_  generation:  7.076975107192993
local_output_nid generation:  0.2044534683227539
local_in_edges_tensor generation:  0.44670629501342773
mini_batch_src_global generation:  0.7026822566986084
r_  generation:  7.0178914070129395
local_output_nid generation:  0.16967248916625977
local_in_edges_tensor generation:  0.43601441383361816
mini_batch_src_global generation:  0.7177560329437256
r_  generation:  7.034160852432251
local_output_nid generation:  0.18018794059753418
local_in_edges_tensor generation:  0.554725170135498
mini_batch_src_global generation:  0.6901524066925049
r_  generation:  7.097952365875244
local_output_nid generation:  0.18314552307128906
local_in_edges_tensor generation:  0.4340479373931885
mini_batch_src_global generation:  0.7218565940856934
r_  generation:  7.061571836471558
----------------------check_connections_block total spend ----------------------------- 154.4528501033783
generate_one_block  9.937275409698486
generate_one_block  9.304080247879028
generate_one_block  8.989887237548828
generate_one_block  9.006161451339722
generate_one_block  9.187238693237305
generate_one_block  9.076074600219727
generate_one_block  9.236459493637085
generate_one_block  9.060348749160767
generate_one_block  9.138938903808594
generate_one_block  9.359808206558228
generate_one_block  8.99122428894043
generate_one_block  9.06196117401123
generate_one_block  9.257671356201172
generate_one_block  8.93902587890625
generate_one_block  9.288773775100708
generate_one_block  9.058581113815308
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.0508365631103516
gen group dst list time:  1.0047545433044434
time for parepare:  0.5041577816009521
local_output_nid generation:  0.6037294864654541
local_in_edges_tensor generation:  1.2905008792877197
mini_batch_src_global generation:  1.101259469985962
r_  generation:  14.877991676330566
local_output_nid generation:  0.6341195106506348
local_in_edges_tensor generation:  1.3081042766571045
mini_batch_src_global generation:  1.5684611797332764
r_  generation:  15.043278455734253
local_output_nid generation:  0.6283247470855713
local_in_edges_tensor generation:  1.226876974105835
mini_batch_src_global generation:  1.5210750102996826
r_  generation:  15.132492542266846
local_output_nid generation:  0.6243960857391357
local_in_edges_tensor generation:  1.2179808616638184
mini_batch_src_global generation:  1.6778788566589355
r_  generation:  15.594778060913086
local_output_nid generation:  0.637700080871582
local_in_edges_tensor generation:  1.2426962852478027
mini_batch_src_global generation:  1.6356093883514404
r_  generation:  15.351275444030762
local_output_nid generation:  0.6276416778564453
local_in_edges_tensor generation:  2.459408760070801
mini_batch_src_global generation:  1.4507331848144531
r_  generation:  15.279214143753052
local_output_nid generation:  0.6242780685424805
local_in_edges_tensor generation:  1.23042631149292
mini_batch_src_global generation:  1.5593016147613525
r_  generation:  15.395323514938354
local_output_nid generation:  0.6365089416503906
local_in_edges_tensor generation:  1.2167575359344482
mini_batch_src_global generation:  1.4297010898590088
r_  generation:  15.581965446472168
local_output_nid generation:  0.6037290096282959
local_in_edges_tensor generation:  1.2417452335357666
mini_batch_src_global generation:  1.4679107666015625
r_  generation:  15.424291133880615
local_output_nid generation:  0.5925590991973877
local_in_edges_tensor generation:  1.1045053005218506
mini_batch_src_global generation:  1.552779197692871
r_  generation:  15.225076675415039
local_output_nid generation:  0.6268293857574463
local_in_edges_tensor generation:  1.2276153564453125
mini_batch_src_global generation:  1.5966134071350098
r_  generation:  15.386624097824097
local_output_nid generation:  0.6195042133331299
local_in_edges_tensor generation:  1.2362663745880127
mini_batch_src_global generation:  1.5003674030303955
r_  generation:  15.419055461883545
local_output_nid generation:  0.6227822303771973
local_in_edges_tensor generation:  1.233410358428955
mini_batch_src_global generation:  1.4887797832489014
r_  generation:  15.543212175369263
local_output_nid generation:  0.6328728199005127
local_in_edges_tensor generation:  1.2305123805999756
mini_batch_src_global generation:  1.5062453746795654
r_  generation:  16.170672178268433
local_output_nid generation:  0.5902249813079834
local_in_edges_tensor generation:  1.1626777648925781
mini_batch_src_global generation:  1.5261375904083252
r_  generation:  15.442788362503052
local_output_nid generation:  0.6110334396362305
local_in_edges_tensor generation:  1.1840198040008545
mini_batch_src_global generation:  1.5941216945648193
r_  generation:  15.419680833816528
----------------------check_connections_block total spend ----------------------------- 345.9934468269348
generate_one_block  21.11148977279663
generate_one_block  21.730260610580444
generate_one_block  21.007663011550903
generate_one_block  20.521257162094116
generate_one_block  20.498415231704712
generate_one_block  20.61890459060669
generate_one_block  21.55055260658264
generate_one_block  20.644264698028564
generate_one_block  20.548272132873535
generate_one_block  20.687553882598877
generate_one_block  20.586915254592896
generate_one_block  20.65961456298828
generate_one_block  20.582788705825806
generate_one_block  20.567411422729492
generate_one_block  20.662579774856567
generate_one_block  21.157937049865723
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  500.4462969303131
block generation total time  480.02939105033875
average batch blocks generation time:  30.00183694064617
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 1.2062315940856934  GigaBytes
Max Memory Allocated: 1.2062315940856934  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9569091796875 GB
    Memory Allocated: 2.9405031204223633  GigaBytes
Max Memory Allocated: 3.227015495300293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 1.2096447944641113  GigaBytes
Max Memory Allocated: 3.6047115325927734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 2.941272735595703  GigaBytes
Max Memory Allocated: 3.6047115325927734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 1.2074666023254395  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 2.938727378845215  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 1.204409122467041  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 2.9267520904541016  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 1.2078404426574707  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 2.9348301887512207  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 1.2084250450134277  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 2.9425883293151855  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 1.2087554931640625  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 2.943722724914551  GigaBytes
Max Memory Allocated: 3.6059608459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 1.2099361419677734  GigaBytes
Max Memory Allocated: 3.6070914268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 2.94339656829834  GigaBytes
Max Memory Allocated: 3.6070914268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 1.2058658599853516  GigaBytes
Max Memory Allocated: 3.607409954071045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 2.935018539428711  GigaBytes
Max Memory Allocated: 3.607409954071045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4725341796875 GB
    Memory Allocated: 1.2110958099365234  GigaBytes
Max Memory Allocated: 3.607409954071045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9501986503601074  GigaBytes
Max Memory Allocated: 3.607409954071045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.209031105041504  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9436941146850586  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2082180976867676  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9416308403015137  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2099313735961914  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9421515464782715  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2068071365356445  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.934319496154785  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2092127799987793  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9397330284118652  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2103099822998047  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.942391872406006  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.26383236050605774 |0.462065652012825 |0.04752787947654724 |0.00014385581016540527 |0.035738930106163025 |0.0016245841979980469 |
----------------------------------------------------------pseudo_mini_loss sum 8.789155006408691
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  70333471
Number of first layer input nodes during this epoch:  34749766
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.0265159606933594  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7471773624420166
random selection method range initialization spend 0.012334346771240234
time for parepare:  0.3737185001373291
local_output_nid generation:  0.00867915153503418
local_in_edges_tensor generation:  0.032900333404541016
mini_batch_src_global generation:  0.026021718978881836
r_  generation:  0.35747361183166504
local_output_nid generation:  0.007722616195678711
local_in_edges_tensor generation:  0.018438339233398438
mini_batch_src_global generation:  0.033663034439086914
r_  generation:  0.4037342071533203
local_output_nid generation:  0.007290363311767578
local_in_edges_tensor generation:  0.008881807327270508
mini_batch_src_global generation:  0.02337026596069336
r_  generation:  0.43083667755126953
local_output_nid generation:  0.007336616516113281
local_in_edges_tensor generation:  0.009037017822265625
mini_batch_src_global generation:  0.026081562042236328
r_  generation:  0.45505356788635254
local_output_nid generation:  0.0073699951171875
local_in_edges_tensor generation:  0.009104490280151367
mini_batch_src_global generation:  0.0299227237701416
r_  generation:  0.48061490058898926
local_output_nid generation:  0.007539510726928711
local_in_edges_tensor generation:  0.008877992630004883
mini_batch_src_global generation:  0.031017780303955078
r_  generation:  0.5018181800842285
local_output_nid generation:  0.00733637809753418
local_in_edges_tensor generation:  0.008993864059448242
mini_batch_src_global generation:  0.03469705581665039
r_  generation:  0.5036110877990723
local_output_nid generation:  0.007359027862548828
local_in_edges_tensor generation:  0.008982419967651367
mini_batch_src_global generation:  0.03352761268615723
r_  generation:  0.5154905319213867
local_output_nid generation:  0.008775949478149414
local_in_edges_tensor generation:  0.008978605270385742
mini_batch_src_global generation:  0.03503990173339844
r_  generation:  0.5234975814819336
local_output_nid generation:  0.007474184036254883
local_in_edges_tensor generation:  0.009241104125976562
mini_batch_src_global generation:  0.03695392608642578
r_  generation:  0.5237874984741211
local_output_nid generation:  0.007367372512817383
local_in_edges_tensor generation:  0.010251283645629883
mini_batch_src_global generation:  0.03777718544006348
r_  generation:  0.5225961208343506
local_output_nid generation:  0.00737452507019043
local_in_edges_tensor generation:  0.008866071701049805
mini_batch_src_global generation:  0.03928256034851074
r_  generation:  0.5337364673614502
local_output_nid generation:  0.0073757171630859375
local_in_edges_tensor generation:  0.01194906234741211
mini_batch_src_global generation:  0.040927886962890625
r_  generation:  0.5517961978912354
local_output_nid generation:  0.0073909759521484375
local_in_edges_tensor generation:  0.011650800704956055
mini_batch_src_global generation:  0.042296409606933594
r_  generation:  0.5495152473449707
local_output_nid generation:  0.0073223114013671875
local_in_edges_tensor generation:  0.010230779647827148
mini_batch_src_global generation:  0.0451052188873291
r_  generation:  0.5444869995117188
local_output_nid generation:  0.007275581359863281
local_in_edges_tensor generation:  0.008793115615844727
mini_batch_src_global generation:  0.04223895072937012
r_  generation:  0.5706117153167725
----------------------check_connections_block total spend ----------------------------- 10.60910153388977
generate_one_block  0.909496545791626
generate_one_block  0.5455787181854248
generate_one_block  0.5187973976135254
generate_one_block  0.5484249591827393
generate_one_block  0.7247035503387451
generate_one_block  0.6754207611083984
generate_one_block  0.5464165210723877
generate_one_block  0.5198042392730713
generate_one_block  0.5094950199127197
generate_one_block  0.5240175724029541
generate_one_block  0.5285589694976807
generate_one_block  0.5113613605499268
generate_one_block  0.5238504409790039
generate_one_block  0.5110840797424316
generate_one_block  0.5318419933319092
generate_one_block  0.5185754299163818
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1517975330352783
gen group dst list time:  0.24451565742492676
time for parepare:  0.4713423252105713
local_output_nid generation:  0.1698169708251953
local_in_edges_tensor generation:  0.54256272315979
mini_batch_src_global generation:  0.5131790637969971
r_  generation:  6.518667221069336
local_output_nid generation:  0.18215727806091309
local_in_edges_tensor generation:  0.6203882694244385
mini_batch_src_global generation:  0.7259764671325684
r_  generation:  6.7820823192596436
local_output_nid generation:  0.20762276649475098
local_in_edges_tensor generation:  0.44477033615112305
mini_batch_src_global generation:  0.6405467987060547
r_  generation:  6.795572280883789
local_output_nid generation:  0.17931199073791504
local_in_edges_tensor generation:  0.4972190856933594
mini_batch_src_global generation:  0.7014548778533936
r_  generation:  7.137100458145142
local_output_nid generation:  0.19071221351623535
local_in_edges_tensor generation:  0.5115039348602295
mini_batch_src_global generation:  0.7088241577148438
r_  generation:  6.995485067367554
local_output_nid generation:  0.19464993476867676
local_in_edges_tensor generation:  0.5082530975341797
mini_batch_src_global generation:  0.7233803272247314
r_  generation:  7.2801196575164795
local_output_nid generation:  0.18413543701171875
local_in_edges_tensor generation:  0.5041017532348633
mini_batch_src_global generation:  0.6978640556335449
r_  generation:  7.08255934715271
local_output_nid generation:  0.18635940551757812
local_in_edges_tensor generation:  0.511911153793335
mini_batch_src_global generation:  0.7217211723327637
r_  generation:  7.323182821273804
local_output_nid generation:  0.18454790115356445
local_in_edges_tensor generation:  0.5070366859436035
mini_batch_src_global generation:  0.6988182067871094
r_  generation:  7.0501227378845215
local_output_nid generation:  0.18634629249572754
local_in_edges_tensor generation:  0.5153982639312744
mini_batch_src_global generation:  0.725762128829956
r_  generation:  7.324066162109375
local_output_nid generation:  0.1864302158355713
local_in_edges_tensor generation:  0.5102870464324951
mini_batch_src_global generation:  0.7126789093017578
r_  generation:  7.136643409729004
local_output_nid generation:  0.18811607360839844
local_in_edges_tensor generation:  0.5062944889068604
mini_batch_src_global generation:  0.7287726402282715
r_  generation:  7.305491209030151
local_output_nid generation:  0.18605899810791016
local_in_edges_tensor generation:  0.5136973857879639
mini_batch_src_global generation:  0.7126040458679199
r_  generation:  7.163187503814697
local_output_nid generation:  0.18519163131713867
local_in_edges_tensor generation:  0.5126440525054932
mini_batch_src_global generation:  0.7271015644073486
r_  generation:  7.2950098514556885
local_output_nid generation:  0.2040247917175293
local_in_edges_tensor generation:  0.5136616230010986
mini_batch_src_global generation:  0.7167465686798096
r_  generation:  7.127020597457886
local_output_nid generation:  0.196150541305542
local_in_edges_tensor generation:  0.4999997615814209
mini_batch_src_global generation:  0.7213237285614014
r_  generation:  7.2808678150177
----------------------check_connections_block total spend ----------------------------- 155.5971336364746
generate_one_block  9.59683871269226
generate_one_block  9.796695232391357
generate_one_block  9.57744312286377
generate_one_block  9.22635555267334
generate_one_block  9.562151432037354
generate_one_block  9.308748245239258
generate_one_block  9.527120351791382
generate_one_block  9.250426769256592
generate_one_block  9.601317167282104
generate_one_block  9.285905122756958
generate_one_block  9.573501586914062
generate_one_block  9.446996450424194
generate_one_block  9.356420040130615
generate_one_block  9.347055673599243
generate_one_block  9.361461877822876
generate_one_block  9.392691850662231
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2888121604919434
gen group dst list time:  1.0382614135742188
time for parepare:  0.495556116104126
local_output_nid generation:  0.584263801574707
local_in_edges_tensor generation:  1.2749357223510742
mini_batch_src_global generation:  1.0943138599395752
r_  generation:  14.958061456680298
local_output_nid generation:  0.6358916759490967
local_in_edges_tensor generation:  1.2535278797149658
mini_batch_src_global generation:  1.4880623817443848
r_  generation:  14.882041215896606
local_output_nid generation:  0.6221675872802734
local_in_edges_tensor generation:  1.197218894958496
mini_batch_src_global generation:  1.6667101383209229
r_  generation:  15.212050676345825
local_output_nid generation:  0.6297333240509033
local_in_edges_tensor generation:  1.2046244144439697
mini_batch_src_global generation:  1.547346830368042
r_  generation:  15.296345949172974
local_output_nid generation:  0.6302366256713867
local_in_edges_tensor generation:  1.2225220203399658
mini_batch_src_global generation:  1.6167192459106445
r_  generation:  15.428542375564575
local_output_nid generation:  0.6305475234985352
local_in_edges_tensor generation:  1.2183423042297363
mini_batch_src_global generation:  1.5955569744110107
r_  generation:  15.411926984786987
local_output_nid generation:  0.6304631233215332
local_in_edges_tensor generation:  1.233811616897583
mini_batch_src_global generation:  1.529571771621704
r_  generation:  15.415307521820068
local_output_nid generation:  0.635385274887085
local_in_edges_tensor generation:  1.2204334735870361
mini_batch_src_global generation:  1.5634450912475586
r_  generation:  15.55584454536438
local_output_nid generation:  0.6292450428009033
local_in_edges_tensor generation:  1.213360071182251
mini_batch_src_global generation:  1.5859572887420654
r_  generation:  15.812434196472168
local_output_nid generation:  0.6430635452270508
local_in_edges_tensor generation:  1.2240827083587646
mini_batch_src_global generation:  1.5146887302398682
r_  generation:  15.384400844573975
local_output_nid generation:  0.6316797733306885
local_in_edges_tensor generation:  1.2309718132019043
mini_batch_src_global generation:  1.4981071949005127
r_  generation:  15.51187515258789
local_output_nid generation:  0.6262645721435547
local_in_edges_tensor generation:  1.2283656597137451
mini_batch_src_global generation:  1.5231831073760986
r_  generation:  15.844782829284668
local_output_nid generation:  0.6478304862976074
local_in_edges_tensor generation:  1.2180581092834473
mini_batch_src_global generation:  1.4905805587768555
r_  generation:  15.548910140991211
local_output_nid generation:  0.6284511089324951
local_in_edges_tensor generation:  2.779670238494873
mini_batch_src_global generation:  1.4843556880950928
r_  generation:  15.449079751968384
local_output_nid generation:  0.6232690811157227
local_in_edges_tensor generation:  1.2097313404083252
mini_batch_src_global generation:  1.4494965076446533
r_  generation:  15.53808045387268
local_output_nid generation:  0.6033265590667725
local_in_edges_tensor generation:  1.2575767040252686
mini_batch_src_global generation:  1.456155776977539
r_  generation:  15.571873188018799
----------------------check_connections_block total spend ----------------------------- 347.23145937919617
generate_one_block  20.793023824691772
generate_one_block  20.65045928955078
generate_one_block  20.651076078414917
generate_one_block  21.110461711883545
generate_one_block  20.726768732070923
generate_one_block  20.818490743637085
generate_one_block  20.728747367858887
generate_one_block  21.278214693069458
generate_one_block  20.701340913772583
generate_one_block  20.668851613998413
generate_one_block  20.729456186294556
generate_one_block  20.800979614257812
generate_one_block  20.698103666305542
generate_one_block  20.7545428276062
generate_one_block  20.833157539367676
generate_one_block  20.616185188293457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.0265159606933594  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

connection checking time:  502.8285930156708
block generation total time  483.7709891796112
average batch blocks generation time:  30.2356868237257
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.210148811340332  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.943131446838379  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2097396850585938  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.940770149230957  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2084932327270508  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9385433197021484  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2078242301940918  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.942790985107422  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2079129219055176  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.936370849609375  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2105379104614258  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9432125091552734  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2067632675170898  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9374818801879883  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2106990814208984  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9480528831481934  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2069673538208008  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.93288516998291  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.209000587463379  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9429268836975098  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2109580039978027  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.941863536834717  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2111930847167969  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9453864097595215  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2077717781066895  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.937349319458008  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.206230640411377  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9336538314819336  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2085437774658203  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9383902549743652  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2054567337036133  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9293389320373535  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2729760557413101 |0.30135276913642883 |0.0038192570209503174 |0.00013779103755950928 |0.004056990146636963 |0.0015490055084228516 |
----------------------------------------------------------pseudo_mini_loss sum 5.12384557723999
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  70317538
Number of first layer input nodes during this epoch:  34748687
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.018110752105713  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.650031566619873
random selection method range initialization spend 0.013416528701782227
time for parepare:  0.34892821311950684
local_output_nid generation:  0.0070264339447021484
local_in_edges_tensor generation:  0.033913612365722656
mini_batch_src_global generation:  0.029066801071166992
r_  generation:  0.378680944442749
local_output_nid generation:  0.007335186004638672
local_in_edges_tensor generation:  0.015459537506103516
mini_batch_src_global generation:  0.03648209571838379
r_  generation:  0.41758084297180176
local_output_nid generation:  0.007470607757568359
local_in_edges_tensor generation:  0.011512041091918945
mini_batch_src_global generation:  0.02347874641418457
r_  generation:  0.4294002056121826
local_output_nid generation:  0.007354021072387695
local_in_edges_tensor generation:  0.010519266128540039
mini_batch_src_global generation:  0.02602100372314453
r_  generation:  0.45488762855529785
local_output_nid generation:  0.007308244705200195
local_in_edges_tensor generation:  0.011539697647094727
mini_batch_src_global generation:  0.029708147048950195
r_  generation:  0.478557825088501
local_output_nid generation:  0.00728607177734375
local_in_edges_tensor generation:  0.00927734375
mini_batch_src_global generation:  0.03159952163696289
r_  generation:  0.506962776184082
local_output_nid generation:  0.0074310302734375
local_in_edges_tensor generation:  0.01168060302734375
mini_batch_src_global generation:  0.03391551971435547
r_  generation:  0.5165085792541504
local_output_nid generation:  0.00764775276184082
local_in_edges_tensor generation:  0.010606527328491211
mini_batch_src_global generation:  0.035146474838256836
r_  generation:  0.5245974063873291
local_output_nid generation:  0.007413387298583984
local_in_edges_tensor generation:  0.014139175415039062
mini_batch_src_global generation:  0.03536415100097656
r_  generation:  0.5443551540374756
local_output_nid generation:  0.007740020751953125
local_in_edges_tensor generation:  0.010492563247680664
mini_batch_src_global generation:  0.04026007652282715
r_  generation:  0.538116455078125
local_output_nid generation:  0.007409811019897461
local_in_edges_tensor generation:  0.00921320915222168
mini_batch_src_global generation:  0.03809499740600586
r_  generation:  0.5528197288513184
local_output_nid generation:  0.007336139678955078
local_in_edges_tensor generation:  0.009265422821044922
mini_batch_src_global generation:  0.040460824966430664
r_  generation:  0.5332865715026855
local_output_nid generation:  0.007823705673217773
local_in_edges_tensor generation:  0.009606599807739258
mini_batch_src_global generation:  0.040253400802612305
r_  generation:  0.5294947624206543
local_output_nid generation:  0.007392168045043945
local_in_edges_tensor generation:  0.010579586029052734
mini_batch_src_global generation:  0.043282508850097656
r_  generation:  0.5423667430877686
local_output_nid generation:  0.007450103759765625
local_in_edges_tensor generation:  0.009330511093139648
mini_batch_src_global generation:  0.042199134826660156
r_  generation:  0.5363650321960449
local_output_nid generation:  0.007342100143432617
local_in_edges_tensor generation:  0.010371208190917969
mini_batch_src_global generation:  0.044077396392822266
r_  generation:  0.5335500240325928
----------------------check_connections_block total spend ----------------------------- 10.721655368804932
generate_one_block  0.8930723667144775
generate_one_block  0.5498597621917725
generate_one_block  0.5185346603393555
generate_one_block  0.5179998874664307
generate_one_block  0.5253610610961914
generate_one_block  0.5160937309265137
generate_one_block  0.5266146659851074
generate_one_block  0.5248737335205078
generate_one_block  0.5345983505249023
generate_one_block  0.5209379196166992
generate_one_block  0.518557071685791
generate_one_block  0.5317192077636719
generate_one_block  0.5333597660064697
generate_one_block  0.537604570388794
generate_one_block  0.5265169143676758
generate_one_block  0.5395991802215576
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2114078998565674
gen group dst list time:  0.24402904510498047
time for parepare:  0.4813883304595947
local_output_nid generation:  0.1903972625732422
local_in_edges_tensor generation:  0.5119783878326416
mini_batch_src_global generation:  0.5172843933105469
r_  generation:  6.441914081573486
local_output_nid generation:  0.19019699096679688
local_in_edges_tensor generation:  0.4548323154449463
mini_batch_src_global generation:  0.6485404968261719
r_  generation:  6.964498519897461
local_output_nid generation:  0.19691181182861328
local_in_edges_tensor generation:  0.7171862125396729
mini_batch_src_global generation:  0.6662411689758301
r_  generation:  6.772121906280518
local_output_nid generation:  0.18323636054992676
local_in_edges_tensor generation:  0.44837188720703125
mini_batch_src_global generation:  0.6523094177246094
r_  generation:  6.915148019790649
local_output_nid generation:  0.1758129596710205
local_in_edges_tensor generation:  0.5730443000793457
mini_batch_src_global generation:  0.7647128105163574
r_  generation:  7.099362373352051
local_output_nid generation:  0.2074429988861084
local_in_edges_tensor generation:  0.44124865531921387
mini_batch_src_global generation:  0.6917746067047119
r_  generation:  6.9937756061553955
local_output_nid generation:  0.1743147373199463
local_in_edges_tensor generation:  0.45311498641967773
mini_batch_src_global generation:  0.6975274085998535
r_  generation:  7.210324048995972
local_output_nid generation:  0.20019006729125977
local_in_edges_tensor generation:  0.5698938369750977
mini_batch_src_global generation:  0.6999471187591553
r_  generation:  6.947720766067505
local_output_nid generation:  0.19026708602905273
local_in_edges_tensor generation:  0.4449896812438965
mini_batch_src_global generation:  0.7061128616333008
r_  generation:  7.023218154907227
local_output_nid generation:  0.17461633682250977
local_in_edges_tensor generation:  0.5100715160369873
mini_batch_src_global generation:  0.7221596240997314
r_  generation:  7.178343057632446
local_output_nid generation:  0.19690561294555664
local_in_edges_tensor generation:  0.4998011589050293
mini_batch_src_global generation:  0.7012624740600586
r_  generation:  7.058109521865845
local_output_nid generation:  0.18528985977172852
local_in_edges_tensor generation:  0.44310784339904785
mini_batch_src_global generation:  0.7092604637145996
r_  generation:  7.276245832443237
local_output_nid generation:  0.19409728050231934
local_in_edges_tensor generation:  0.5752215385437012
mini_batch_src_global generation:  0.7247276306152344
r_  generation:  6.981863975524902
local_output_nid generation:  0.19600462913513184
local_in_edges_tensor generation:  0.44664454460144043
mini_batch_src_global generation:  0.7165224552154541
r_  generation:  7.141965866088867
local_output_nid generation:  0.17498397827148438
local_in_edges_tensor generation:  0.44642114639282227
mini_batch_src_global generation:  0.7326939105987549
r_  generation:  7.21905517578125
local_output_nid generation:  0.19831109046936035
local_in_edges_tensor generation:  0.5559241771697998
mini_batch_src_global generation:  0.7039237022399902
r_  generation:  7.015706777572632
----------------------check_connections_block total spend ----------------------------- 153.90925073623657
generate_one_block  9.68435549736023
generate_one_block  9.960736274719238
generate_one_block  9.152421474456787
generate_one_block  9.150534868240356
generate_one_block  9.556055784225464
generate_one_block  9.242297172546387
generate_one_block  9.193109035491943
generate_one_block  9.362383842468262
generate_one_block  9.248722553253174
generate_one_block  9.610234022140503
generate_one_block  9.116807699203491
generate_one_block  9.206305742263794
generate_one_block  9.329997062683105
generate_one_block  9.234700202941895
generate_one_block  9.456754207611084
generate_one_block  9.082069158554077
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1225898265838623
gen group dst list time:  0.9858486652374268
time for parepare:  0.4596548080444336
local_output_nid generation:  0.5715193748474121
local_in_edges_tensor generation:  1.3066775798797607
mini_batch_src_global generation:  1.0967950820922852
r_  generation:  14.42304277420044
local_output_nid generation:  0.6085352897644043
local_in_edges_tensor generation:  1.0941240787506104
mini_batch_src_global generation:  1.469437599182129
r_  generation:  15.082097053527832
local_output_nid generation:  0.6232702732086182
local_in_edges_tensor generation:  1.282996654510498
mini_batch_src_global generation:  1.42326021194458
r_  generation:  15.345835208892822
local_output_nid generation:  0.6259868144989014
local_in_edges_tensor generation:  1.229043960571289
mini_batch_src_global generation:  1.4439167976379395
r_  generation:  15.228075742721558
local_output_nid generation:  0.5988826751708984
local_in_edges_tensor generation:  1.2380383014678955
mini_batch_src_global generation:  1.5636112689971924
r_  generation:  15.182034254074097
local_output_nid generation:  0.6096487045288086
local_in_edges_tensor generation:  1.0942139625549316
mini_batch_src_global generation:  1.6399526596069336
r_  generation:  15.18916630744934
local_output_nid generation:  0.6334526538848877
local_in_edges_tensor generation:  1.2297165393829346
mini_batch_src_global generation:  1.5725078582763672
r_  generation:  15.359619617462158
local_output_nid generation:  0.6442844867706299
local_in_edges_tensor generation:  1.22645902633667
mini_batch_src_global generation:  1.4432024955749512
r_  generation:  15.51141095161438
local_output_nid generation:  0.6192893981933594
local_in_edges_tensor generation:  1.2196123600006104
mini_batch_src_global generation:  1.4447169303894043
r_  generation:  15.345136404037476
local_output_nid generation:  0.6004014015197754
local_in_edges_tensor generation:  1.1571166515350342
mini_batch_src_global generation:  1.5479779243469238
r_  generation:  15.112107992172241
local_output_nid generation:  0.6150143146514893
local_in_edges_tensor generation:  1.165389060974121
mini_batch_src_global generation:  1.5837538242340088
r_  generation:  15.35666561126709
local_output_nid generation:  0.6412992477416992
local_in_edges_tensor generation:  1.2568988800048828
mini_batch_src_global generation:  1.5081684589385986
r_  generation:  15.559773921966553
local_output_nid generation:  0.6256294250488281
local_in_edges_tensor generation:  1.236985206604004
mini_batch_src_global generation:  1.4522457122802734
r_  generation:  15.601372003555298
local_output_nid generation:  0.6187560558319092
local_in_edges_tensor generation:  2.8209421634674072
mini_batch_src_global generation:  1.4366748332977295
r_  generation:  15.645771026611328
local_output_nid generation:  0.6081206798553467
local_in_edges_tensor generation:  1.2301404476165771
mini_batch_src_global generation:  1.5085601806640625
r_  generation:  15.325134515762329
local_output_nid generation:  0.6102805137634277
local_in_edges_tensor generation:  1.0943114757537842
mini_batch_src_global generation:  1.6045763492584229
r_  generation:  15.285142183303833
----------------------check_connections_block total spend ----------------------------- 342.8234941959381
generate_one_block  20.593565702438354
generate_one_block  20.455320835113525
generate_one_block  20.399402856826782
generate_one_block  20.45691227912903
generate_one_block  20.562800645828247
generate_one_block  20.549005270004272
generate_one_block  20.607781171798706
generate_one_block  21.10693597793579
generate_one_block  20.619462490081787
generate_one_block  20.6549551486969
generate_one_block  20.67153024673462
generate_one_block  20.827791929244995
generate_one_block  20.829214572906494
generate_one_block  20.768616676330566
generate_one_block  20.77401375770569
generate_one_block  20.741443395614624
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.018110752105713  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

connection checking time:  496.7327449321747
block generation total time  480.20623755455017
average batch blocks generation time:  30.012889847159386
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2059006690979004  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.934058666229248  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2081007957458496  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.936955451965332  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2063665390014648  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9379167556762695  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2057275772094727  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.931093215942383  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2103195190429688  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.946150779724121  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2093992233276367  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.941817283630371  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2078261375427246  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9377455711364746  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.210413932800293  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9453277587890625  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2089409828186035  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9380645751953125  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2087974548339844  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9385933876037598  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2058663368225098  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.933194160461426  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2108612060546875  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9450035095214844  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2063255310058594  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9329118728637695  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2101898193359375  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9483494758605957  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2092523574829102  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9442996978759766  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2084293365478516  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9426116943359375  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.26974403858184814 |0.30190691351890564 |0.004334762692451477 |0.00013253092765808105 |0.004068031907081604 |0.0011739730834960938 |
----------------------------------------------------------pseudo_mini_loss sum 3.706103801727295
Total (block generation + training)time/epoch 1039.1622126102448
Training time/epoch 1647798099.7941792
Training time without block to device /epoch 1647798094.9636686
Training time without total dataloading part /epoch 0.1377391815185547
load block tensor time/epoch 4.31590461730957
block to device time/epoch 4.83051061630249
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  70325843
Number of first layer input nodes during this epoch:  34743121
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.0253243446350098  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6468791961669922
random selection method range initialization spend 0.013586282730102539
time for parepare:  0.37897610664367676
local_output_nid generation:  0.007266044616699219
local_in_edges_tensor generation:  0.03719520568847656
mini_batch_src_global generation:  0.027922868728637695
r_  generation:  0.37021470069885254
local_output_nid generation:  0.01018524169921875
local_in_edges_tensor generation:  0.014084577560424805
mini_batch_src_global generation:  0.035264015197753906
r_  generation:  0.4322021007537842
local_output_nid generation:  0.007325887680053711
local_in_edges_tensor generation:  0.00919198989868164
mini_batch_src_global generation:  0.023556947708129883
r_  generation:  0.43572092056274414
local_output_nid generation:  0.007524251937866211
local_in_edges_tensor generation:  0.010713577270507812
mini_batch_src_global generation:  0.027199506759643555
r_  generation:  0.47306036949157715
local_output_nid generation:  0.01135873794555664
local_in_edges_tensor generation:  0.009639739990234375
mini_batch_src_global generation:  0.02824687957763672
r_  generation:  0.4877197742462158
local_output_nid generation:  0.0075991153717041016
local_in_edges_tensor generation:  0.011479616165161133
mini_batch_src_global generation:  0.03544282913208008
r_  generation:  0.5230190753936768
local_output_nid generation:  0.007877111434936523
local_in_edges_tensor generation:  0.00925755500793457
mini_batch_src_global generation:  0.03561592102050781
r_  generation:  0.5216822624206543
local_output_nid generation:  0.00742340087890625
local_in_edges_tensor generation:  0.026477336883544922
mini_batch_src_global generation:  0.03515887260437012
r_  generation:  0.5261797904968262
local_output_nid generation:  0.007403850555419922
local_in_edges_tensor generation:  0.01792287826538086
mini_batch_src_global generation:  0.03546905517578125
r_  generation:  0.546161413192749
local_output_nid generation:  0.008970975875854492
local_in_edges_tensor generation:  0.01611328125
mini_batch_src_global generation:  0.03653883934020996
r_  generation:  0.5230095386505127
local_output_nid generation:  0.007460117340087891
local_in_edges_tensor generation:  0.01196599006652832
mini_batch_src_global generation:  0.0378115177154541
r_  generation:  0.5378801822662354
local_output_nid generation:  0.007402896881103516
local_in_edges_tensor generation:  0.01375889778137207
mini_batch_src_global generation:  0.0393829345703125
r_  generation:  0.5371620655059814
local_output_nid generation:  0.0075168609619140625
local_in_edges_tensor generation:  0.011322736740112305
mini_batch_src_global generation:  0.040105581283569336
r_  generation:  0.539696216583252
local_output_nid generation:  0.007433414459228516
local_in_edges_tensor generation:  0.011374711990356445
mini_batch_src_global generation:  0.04125046730041504
r_  generation:  0.538184642791748
local_output_nid generation:  0.007418155670166016
local_in_edges_tensor generation:  0.01255488395690918
mini_batch_src_global generation:  0.04209494590759277
r_  generation:  0.5398805141448975
local_output_nid generation:  0.00745701789855957
local_in_edges_tensor generation:  0.010427236557006836
mini_batch_src_global generation:  0.04250192642211914
r_  generation:  0.532177209854126
----------------------check_connections_block total spend ----------------------------- 10.811017036437988
generate_one_block  0.8988029956817627
generate_one_block  0.5403256416320801
generate_one_block  0.5215969085693359
generate_one_block  0.5352373123168945
generate_one_block  0.5478296279907227
generate_one_block  0.5274405479431152
generate_one_block  0.5290603637695312
generate_one_block  0.5231504440307617
generate_one_block  0.5501565933227539
generate_one_block  0.5260884761810303
generate_one_block  0.532418966293335
generate_one_block  0.6195828914642334
generate_one_block  0.7534315586090088
generate_one_block  0.6246130466461182
generate_one_block  0.5246589183807373
generate_one_block  0.5192139148712158
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.181246519088745
gen group dst list time:  0.2456815242767334
time for parepare:  0.44550657272338867
local_output_nid generation:  0.18122148513793945
local_in_edges_tensor generation:  0.6820566654205322
mini_batch_src_global generation:  0.5293514728546143
r_  generation:  6.742422819137573
local_output_nid generation:  0.21512341499328613
local_in_edges_tensor generation:  0.5123641490936279
mini_batch_src_global generation:  0.6724512577056885
r_  generation:  6.782133340835571
local_output_nid generation:  0.18856024742126465
local_in_edges_tensor generation:  0.512183427810669
mini_batch_src_global generation:  0.7349841594696045
r_  generation:  6.908572673797607
local_output_nid generation:  0.20083165168762207
local_in_edges_tensor generation:  0.49828624725341797
mini_batch_src_global generation:  0.6711654663085938
r_  generation:  6.856245279312134
local_output_nid generation:  0.19107770919799805
local_in_edges_tensor generation:  0.5054597854614258
mini_batch_src_global generation:  0.6957199573516846
r_  generation:  7.02910852432251
local_output_nid generation:  0.17420482635498047
local_in_edges_tensor generation:  0.5033252239227295
mini_batch_src_global generation:  0.7397880554199219
r_  generation:  6.91340446472168
local_output_nid generation:  0.18648815155029297
local_in_edges_tensor generation:  0.472484827041626
mini_batch_src_global generation:  0.6929464340209961
r_  generation:  6.971508502960205
local_output_nid generation:  0.19017958641052246
local_in_edges_tensor generation:  0.46633028984069824
mini_batch_src_global generation:  0.7478458881378174
r_  generation:  7.0577192306518555
local_output_nid generation:  0.18991541862487793
local_in_edges_tensor generation:  0.5102474689483643
mini_batch_src_global generation:  0.7398152351379395
r_  generation:  6.956389904022217
local_output_nid generation:  0.18467211723327637
local_in_edges_tensor generation:  0.4995541572570801
mini_batch_src_global generation:  0.7043771743774414
r_  generation:  7.036470651626587
local_output_nid generation:  0.1845238208770752
local_in_edges_tensor generation:  0.448256254196167
mini_batch_src_global generation:  0.7754511833190918
r_  generation:  7.1425840854644775
local_output_nid generation:  0.19849562644958496
local_in_edges_tensor generation:  0.5098624229431152
mini_batch_src_global generation:  0.7083542346954346
r_  generation:  7.019033193588257
local_output_nid generation:  0.18487811088562012
local_in_edges_tensor generation:  0.5003397464752197
mini_batch_src_global generation:  0.7263662815093994
r_  generation:  7.101123571395874
local_output_nid generation:  0.18051648139953613
local_in_edges_tensor generation:  0.48853182792663574
mini_batch_src_global generation:  0.7193958759307861
r_  generation:  7.070973634719849
local_output_nid generation:  0.19993090629577637
local_in_edges_tensor generation:  0.44557929039001465
mini_batch_src_global generation:  0.703693151473999
r_  generation:  6.98466420173645
local_output_nid generation:  0.1985917091369629
local_in_edges_tensor generation:  0.4983212947845459
mini_batch_src_global generation:  0.7281551361083984
r_  generation:  7.084749460220337
----------------------check_connections_block total spend ----------------------------- 153.59922242164612
generate_one_block  9.57495379447937
generate_one_block  9.971884489059448
generate_one_block  9.314563989639282
generate_one_block  9.522836446762085
generate_one_block  9.119946002960205
generate_one_block  9.123620748519897
generate_one_block  9.440964698791504
generate_one_block  9.239582300186157
generate_one_block  9.529965877532959
generate_one_block  9.26548433303833
generate_one_block  9.283365726470947
generate_one_block  9.50888466835022
generate_one_block  9.271196365356445
generate_one_block  9.23131537437439
generate_one_block  9.41776728630066
generate_one_block  9.216262578964233
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.0726542472839355
gen group dst list time:  0.9941794872283936
time for parepare:  0.47850489616394043
local_output_nid generation:  0.579857587814331
local_in_edges_tensor generation:  1.2892265319824219
mini_batch_src_global generation:  1.1516163349151611
r_  generation:  14.98498272895813
local_output_nid generation:  0.6329164505004883
local_in_edges_tensor generation:  1.3274011611938477
mini_batch_src_global generation:  1.598573923110962
r_  generation:  14.943840265274048
local_output_nid generation:  0.6121177673339844
local_in_edges_tensor generation:  1.2479143142700195
mini_batch_src_global generation:  1.5504939556121826
r_  generation:  15.411393404006958
local_output_nid generation:  0.6295244693756104
local_in_edges_tensor generation:  1.226651906967163
mini_batch_src_global generation:  1.5582458972930908
r_  generation:  15.89920973777771
local_output_nid generation:  0.6079981327056885
local_in_edges_tensor generation:  1.2622003555297852
mini_batch_src_global generation:  1.4758851528167725
r_  generation:  15.396389722824097
local_output_nid generation:  0.6161379814147949
local_in_edges_tensor generation:  1.0963711738586426
mini_batch_src_global generation:  1.511152982711792
r_  generation:  15.306554079055786
local_output_nid generation:  0.6417925357818604
local_in_edges_tensor generation:  1.2509286403656006
mini_batch_src_global generation:  1.5598118305206299
r_  generation:  15.530200719833374
local_output_nid generation:  0.625807523727417
local_in_edges_tensor generation:  1.2085604667663574
mini_batch_src_global generation:  1.452294111251831
r_  generation:  15.506819009780884
local_output_nid generation:  0.6177027225494385
local_in_edges_tensor generation:  1.2560937404632568
mini_batch_src_global generation:  1.477494478225708
r_  generation:  15.295712947845459
local_output_nid generation:  0.6465961933135986
local_in_edges_tensor generation:  1.102588176727295
mini_batch_src_global generation:  1.562006950378418
r_  generation:  15.249854326248169
local_output_nid generation:  0.6323845386505127
local_in_edges_tensor generation:  1.2262420654296875
mini_batch_src_global generation:  1.559584379196167
r_  generation:  15.630115509033203
local_output_nid generation:  0.6329946517944336
local_in_edges_tensor generation:  1.2296857833862305
mini_batch_src_global generation:  1.4729547500610352
r_  generation:  15.523061752319336
local_output_nid generation:  0.6178507804870605
local_in_edges_tensor generation:  1.2362709045410156
mini_batch_src_global generation:  1.525071620941162
r_  generation:  15.35210394859314
local_output_nid generation:  0.6258392333984375
local_in_edges_tensor generation:  2.7349438667297363
mini_batch_src_global generation:  1.5028417110443115
r_  generation:  15.193087577819824
local_output_nid generation:  0.637819766998291
local_in_edges_tensor generation:  1.2454032897949219
mini_batch_src_global generation:  1.5816009044647217
r_  generation:  15.505610704421997
local_output_nid generation:  0.6193838119506836
local_in_edges_tensor generation:  1.2338247299194336
mini_batch_src_global generation:  1.457550287246704
r_  generation:  15.466050386428833
----------------------check_connections_block total spend ----------------------------- 345.7312858104706
generate_one_block  20.80454421043396
generate_one_block  20.829246282577515
generate_one_block  20.847604274749756
generate_one_block  20.879582405090332
generate_one_block  20.77106285095215
generate_one_block  20.71098780632019
generate_one_block  20.717949390411377
generate_one_block  20.850233554840088
generate_one_block  20.50515627861023
generate_one_block  20.581236600875854
generate_one_block  20.64639687538147
generate_one_block  21.1454336643219
generate_one_block  20.556062698364258
generate_one_block  21.022752046585083
generate_one_block  21.010958194732666
generate_one_block  21.102952003479004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.0253243446350098  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

connection checking time:  499.3305082321167
block generation total time  483.01475381851196
average batch blocks generation time:  30.188422113656998
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2089743614196777  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9427413940429688  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2095832824707031  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9403185844421387  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2097797393798828  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9464778900146484  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.208841323852539  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9429659843444824  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2081518173217773  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9425268173217773  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2072944641113281  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.933443069458008  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2071499824523926  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.932589530944824  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2081327438354492  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9348316192626953  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2088747024536133  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.94492769241333  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2071328163146973  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.935061454772949  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.210515022277832  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9452943801879883  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.208895206451416  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9427008628845215  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2087249755859375  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9377360343933105  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2068300247192383  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9348411560058594  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2098212242126465  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9425268173217773  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2061381340026855  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9315733909606934  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2749752998352051 |0.3105906993150711 |0.003930792212486267 |0.00013637542724609375 |0.004063427448272705 |0.0031714439392089844 |
----------------------------------------------------------pseudo_mini_loss sum 3.111639976501465
Total (block generation + training)time/epoch 1042.2915041446686
Training time/epoch 1647799145.2153554
Training time without block to device /epoch 1647799140.2459042
Training time without total dataloading part /epoch 0.13326096534729004
load block tensor time/epoch 4.399604797363281
block to device time/epoch 4.969451189041138
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  70326785
Number of first layer input nodes during this epoch:  34748555
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.0186896324157715  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6330199241638184
random selection method range initialization spend 0.012507438659667969
time for parepare:  0.36393237113952637
local_output_nid generation:  0.007124900817871094
local_in_edges_tensor generation:  0.034229278564453125
mini_batch_src_global generation:  0.027883529663085938
r_  generation:  0.36405301094055176
local_output_nid generation:  0.007502317428588867
local_in_edges_tensor generation:  0.013781070709228516
mini_batch_src_global generation:  0.03487563133239746
r_  generation:  0.40982627868652344
local_output_nid generation:  0.007321357727050781
local_in_edges_tensor generation:  0.010260343551635742
mini_batch_src_global generation:  0.023479223251342773
r_  generation:  0.42604756355285645
local_output_nid generation:  0.007321834564208984
local_in_edges_tensor generation:  0.013915300369262695
mini_batch_src_global generation:  0.027529001235961914
r_  generation:  0.4551537036895752
local_output_nid generation:  0.007299661636352539
local_in_edges_tensor generation:  0.009353876113891602
mini_batch_src_global generation:  0.028408050537109375
r_  generation:  0.47452473640441895
local_output_nid generation:  0.007404327392578125
local_in_edges_tensor generation:  0.009246826171875
mini_batch_src_global generation:  0.032975196838378906
r_  generation:  0.49787449836730957
local_output_nid generation:  0.0073089599609375
local_in_edges_tensor generation:  0.00887298583984375
mini_batch_src_global generation:  0.035910606384277344
r_  generation:  0.5060348510742188
local_output_nid generation:  0.007309913635253906
local_in_edges_tensor generation:  0.00927281379699707
mini_batch_src_global generation:  0.03348898887634277
r_  generation:  0.5095582008361816
local_output_nid generation:  0.007376432418823242
local_in_edges_tensor generation:  0.009111642837524414
mini_batch_src_global generation:  0.03620409965515137
r_  generation:  0.5146036148071289
local_output_nid generation:  0.009371280670166016
local_in_edges_tensor generation:  0.011537313461303711
mini_batch_src_global generation:  0.03766584396362305
r_  generation:  0.5198287963867188
local_output_nid generation:  0.007294654846191406
local_in_edges_tensor generation:  0.010358095169067383
mini_batch_src_global generation:  0.038245439529418945
r_  generation:  0.522371768951416
local_output_nid generation:  0.007287502288818359
local_in_edges_tensor generation:  0.010350465774536133
mini_batch_src_global generation:  0.03907942771911621
r_  generation:  0.538585901260376
local_output_nid generation:  0.0073320865631103516
local_in_edges_tensor generation:  0.00922393798828125
mini_batch_src_global generation:  0.04142165184020996
r_  generation:  0.5376315116882324
local_output_nid generation:  0.007464408874511719
local_in_edges_tensor generation:  0.011702775955200195
mini_batch_src_global generation:  0.04100608825683594
r_  generation:  0.5397799015045166
local_output_nid generation:  0.0073089599609375
local_in_edges_tensor generation:  0.010365486145019531
mini_batch_src_global generation:  0.04432487487792969
r_  generation:  0.5343828201293945
local_output_nid generation:  0.007542133331298828
local_in_edges_tensor generation:  0.010401010513305664
mini_batch_src_global generation:  0.04224085807800293
r_  generation:  0.533951997756958
----------------------check_connections_block total spend ----------------------------- 10.532192945480347
generate_one_block  0.8796827793121338
generate_one_block  0.5368471145629883
generate_one_block  0.5186958312988281
generate_one_block  0.5215089321136475
generate_one_block  0.523134708404541
generate_one_block  0.5258548259735107
generate_one_block  0.5205042362213135
generate_one_block  0.5153238773345947
generate_one_block  0.5248055458068848
generate_one_block  0.5226857662200928
generate_one_block  0.5257663726806641
generate_one_block  0.5145382881164551
generate_one_block  0.5301964282989502
generate_one_block  0.5233004093170166
generate_one_block  0.5313990116119385
generate_one_block  0.5226349830627441
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1084868907928467
gen group dst list time:  0.2411046028137207
time for parepare:  0.42401671409606934
local_output_nid generation:  0.1851344108581543
local_in_edges_tensor generation:  0.5354311466217041
mini_batch_src_global generation:  0.5525269508361816
r_  generation:  6.539331674575806
local_output_nid generation:  0.19216632843017578
local_in_edges_tensor generation:  0.43648695945739746
mini_batch_src_global generation:  0.6484098434448242
r_  generation:  6.7467687129974365
local_output_nid generation:  0.19052767753601074
local_in_edges_tensor generation:  0.6839492321014404
mini_batch_src_global generation:  0.7507274150848389
r_  generation:  6.896807909011841
local_output_nid generation:  0.1871960163116455
local_in_edges_tensor generation:  0.44788479804992676
mini_batch_src_global generation:  0.6759738922119141
r_  generation:  6.976963043212891
local_output_nid generation:  0.188218355178833
local_in_edges_tensor generation:  0.44446849822998047
mini_batch_src_global generation:  0.6903393268585205
r_  generation:  7.206145286560059
local_output_nid generation:  0.19940185546875
local_in_edges_tensor generation:  0.5827991962432861
mini_batch_src_global generation:  0.6936094760894775
r_  generation:  6.96556282043457
local_output_nid generation:  0.18553757667541504
local_in_edges_tensor generation:  0.4484734535217285
mini_batch_src_global generation:  0.7067289352416992
r_  generation:  7.032742023468018
local_output_nid generation:  0.17982125282287598
local_in_edges_tensor generation:  0.5706698894500732
mini_batch_src_global generation:  0.7913081645965576
r_  generation:  6.8959925174713135
local_output_nid generation:  0.1875760555267334
local_in_edges_tensor generation:  0.44732236862182617
mini_batch_src_global generation:  0.7217767238616943
r_  generation:  7.074722528457642
local_output_nid generation:  0.18554377555847168
local_in_edges_tensor generation:  0.43845534324645996
mini_batch_src_global generation:  0.7360458374023438
r_  generation:  7.3048484325408936
local_output_nid generation:  0.19873642921447754
local_in_edges_tensor generation:  0.5697677135467529
mini_batch_src_global generation:  0.7218801975250244
r_  generation:  7.084725618362427
local_output_nid generation:  0.18549346923828125
local_in_edges_tensor generation:  0.4476277828216553
mini_batch_src_global generation:  0.7204320430755615
r_  generation:  7.143826961517334
local_output_nid generation:  0.178175687789917
local_in_edges_tensor generation:  0.5712711811065674
mini_batch_src_global generation:  0.801335334777832
r_  generation:  7.2134644985198975
local_output_nid generation:  0.20033717155456543
local_in_edges_tensor generation:  0.44040441513061523
mini_batch_src_global generation:  0.7056899070739746
r_  generation:  7.107659101486206
local_output_nid generation:  0.18476462364196777
local_in_edges_tensor generation:  0.4398672580718994
mini_batch_src_global generation:  0.7118606567382812
r_  generation:  7.354405403137207
local_output_nid generation:  0.20290899276733398
local_in_edges_tensor generation:  0.5632328987121582
mini_batch_src_global generation:  0.7117996215820312
r_  generation:  7.030306577682495
----------------------check_connections_block total spend ----------------------------- 154.74772834777832
generate_one_block  9.711154222488403
generate_one_block  9.555082559585571
generate_one_block  9.52791690826416
generate_one_block  9.342375993728638
generate_one_block  9.53421688079834
generate_one_block  9.285521984100342
generate_one_block  9.187482357025146
generate_one_block  9.538650751113892
generate_one_block  9.324211359024048
generate_one_block  9.755498886108398
generate_one_block  9.281484603881836
generate_one_block  9.15280032157898
generate_one_block  9.569573640823364
generate_one_block  9.326943159103394
generate_one_block  9.580025911331177
generate_one_block  9.32929015159607
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.24082612991333
gen group dst list time:  1.0034489631652832
time for parepare:  0.4519829750061035
local_output_nid generation:  0.584862470626831
local_in_edges_tensor generation:  1.2199881076812744
mini_batch_src_global generation:  1.096369743347168
r_  generation:  14.622859954833984
local_output_nid generation:  0.5895724296569824
local_in_edges_tensor generation:  1.2345585823059082
mini_batch_src_global generation:  1.5709292888641357
r_  generation:  14.760946989059448
local_output_nid generation:  0.6308033466339111
local_in_edges_tensor generation:  1.10550856590271
mini_batch_src_global generation:  1.5294427871704102
r_  generation:  15.307709693908691
local_output_nid generation:  0.6163949966430664
local_in_edges_tensor generation:  1.289668321609497
mini_batch_src_global generation:  1.4698855876922607
r_  generation:  15.38310170173645
local_output_nid generation:  0.6363935470581055
local_in_edges_tensor generation:  1.2186048030853271
mini_batch_src_global generation:  1.4476072788238525
r_  generation:  15.480551958084106
local_output_nid generation:  0.5965149402618408
local_in_edges_tensor generation:  1.2235043048858643
mini_batch_src_global generation:  1.6738970279693604
r_  generation:  15.220127820968628
local_output_nid generation:  0.6162564754486084
local_in_edges_tensor generation:  1.0884430408477783
mini_batch_src_global generation:  1.6266005039215088
r_  generation:  15.427936315536499
local_output_nid generation:  0.626593828201294
local_in_edges_tensor generation:  1.2388331890106201
mini_batch_src_global generation:  1.5532736778259277
r_  generation:  15.1656334400177
local_output_nid generation:  0.6343748569488525
local_in_edges_tensor generation:  1.2204256057739258
mini_batch_src_global generation:  1.5628387928009033
r_  generation:  15.470751523971558
local_output_nid generation:  0.6272358894348145
local_in_edges_tensor generation:  1.2200489044189453
mini_batch_src_global generation:  1.4792280197143555
r_  generation:  15.519011735916138
local_output_nid generation:  0.6177206039428711
local_in_edges_tensor generation:  1.2147066593170166
mini_batch_src_global generation:  1.4562585353851318
r_  generation:  15.728262662887573
local_output_nid generation:  0.6170611381530762
local_in_edges_tensor generation:  1.2325129508972168
mini_batch_src_global generation:  1.5319387912750244
r_  generation:  15.33785080909729
local_output_nid generation:  0.6168677806854248
local_in_edges_tensor generation:  1.2328407764434814
mini_batch_src_global generation:  1.5397429466247559
r_  generation:  15.264022827148438
local_output_nid generation:  0.6015081405639648
local_in_edges_tensor generation:  2.7829110622406006
mini_batch_src_global generation:  1.5726070404052734
r_  generation:  15.1687912940979
local_output_nid generation:  0.6269385814666748
local_in_edges_tensor generation:  1.2261161804199219
mini_batch_src_global generation:  1.643306016921997
r_  generation:  15.432754516601562
local_output_nid generation:  0.644155740737915
local_in_edges_tensor generation:  1.216909408569336
mini_batch_src_global generation:  1.527573823928833
r_  generation:  15.294781684875488
----------------------check_connections_block total spend ----------------------------- 344.0579254627228
generate_one_block  20.660879135131836
generate_one_block  20.519368171691895
generate_one_block  20.48949432373047
generate_one_block  20.661927223205566
generate_one_block  20.631765604019165
generate_one_block  20.687795877456665
generate_one_block  20.65724515914917
generate_one_block  21.102505683898926
generate_one_block  20.651010274887085
generate_one_block  20.602052927017212
generate_one_block  20.90071439743042
generate_one_block  20.43627643585205
generate_one_block  20.649219512939453
generate_one_block  20.52680730819702
generate_one_block  20.583146810531616
generate_one_block  20.839579105377197
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.0186896324157715  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

connection checking time:  498.8056538105011
block generation total time  481.6020176410675
average batch blocks generation time:  30.10012610256672
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2079153060913086  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9411206245422363  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2053956985473633  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9316749572753906  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2060399055480957  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9335083961486816  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2085647583007812  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.939877986907959  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2105283737182617  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.945253372192383  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2091460227966309  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.942220687866211  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2086658477783203  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9432759284973145  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2068052291870117  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9388389587402344  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2081151008605957  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.93650484085083  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2081851959228516  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.944396495819092  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2091546058654785  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.940250873565674  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2097039222717285  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.937399387359619  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2065720558166504  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9355454444885254  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2054753303527832  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9306020736694336  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2086143493652344  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9419636726379395  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.208700180053711  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9403810501098633  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.27154433727264404 |0.35812216997146606 |0.0038152337074279785 |0.0001347362995147705 |0.004061713814735413 |0.0011889934539794922 |
----------------------------------------------------------pseudo_mini_loss sum 2.6820790767669678
Total (block generation + training)time/epoch 1042.5798683961232
Training time/epoch 1647800188.3722484
Training time without block to device /epoch 1647800182.6422937
Training time without total dataloading part /epoch 0.12937593460083008
load block tensor time/epoch 4.344709396362305
block to device time/epoch 5.729954719543457
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  70311306
Number of first layer input nodes during this epoch:  34740222
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.0252532958984375  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6202993392944336
random selection method range initialization spend 0.012417316436767578
time for parepare:  0.380340576171875
local_output_nid generation:  0.00852823257446289
local_in_edges_tensor generation:  0.04359698295593262
mini_batch_src_global generation:  0.028033018112182617
r_  generation:  0.3636300563812256
local_output_nid generation:  0.007369279861450195
local_in_edges_tensor generation:  0.013867855072021484
mini_batch_src_global generation:  0.037566423416137695
r_  generation:  0.41256093978881836
local_output_nid generation:  0.007282733917236328
local_in_edges_tensor generation:  0.010150671005249023
mini_batch_src_global generation:  0.02457261085510254
r_  generation:  0.4287850856781006
local_output_nid generation:  0.0075342655181884766
local_in_edges_tensor generation:  0.010272741317749023
mini_batch_src_global generation:  0.026134490966796875
r_  generation:  0.454770565032959
local_output_nid generation:  0.007376194000244141
local_in_edges_tensor generation:  0.010378837585449219
mini_batch_src_global generation:  0.028178691864013672
r_  generation:  0.49282336235046387
local_output_nid generation:  0.007447242736816406
local_in_edges_tensor generation:  0.011829137802124023
mini_batch_src_global generation:  0.044356584548950195
r_  generation:  0.4983224868774414
local_output_nid generation:  0.010349512100219727
local_in_edges_tensor generation:  0.013946533203125
mini_batch_src_global generation:  0.03373837471008301
r_  generation:  0.5131134986877441
local_output_nid generation:  0.0074825286865234375
local_in_edges_tensor generation:  0.009341716766357422
mini_batch_src_global generation:  0.03375124931335449
r_  generation:  0.5265066623687744
local_output_nid generation:  0.007362842559814453
local_in_edges_tensor generation:  0.011813879013061523
mini_batch_src_global generation:  0.03502297401428223
r_  generation:  0.5276932716369629
local_output_nid generation:  0.007327556610107422
local_in_edges_tensor generation:  0.009144067764282227
mini_batch_src_global generation:  0.03990793228149414
r_  generation:  0.5377211570739746
local_output_nid generation:  0.007623910903930664
local_in_edges_tensor generation:  0.009572982788085938
mini_batch_src_global generation:  0.04188060760498047
r_  generation:  0.5467894077301025
local_output_nid generation:  0.007562875747680664
local_in_edges_tensor generation:  0.02446126937866211
mini_batch_src_global generation:  0.03914499282836914
r_  generation:  0.5571415424346924
local_output_nid generation:  0.011155843734741211
local_in_edges_tensor generation:  0.01766347885131836
mini_batch_src_global generation:  0.040175676345825195
r_  generation:  0.5451750755310059
local_output_nid generation:  0.0074808597564697266
local_in_edges_tensor generation:  0.016773700714111328
mini_batch_src_global generation:  0.04114723205566406
r_  generation:  0.5558714866638184
local_output_nid generation:  0.007500648498535156
local_in_edges_tensor generation:  0.012286663055419922
mini_batch_src_global generation:  0.04760336875915527
r_  generation:  0.5571951866149902
local_output_nid generation:  0.007364988327026367
local_in_edges_tensor generation:  0.013176679611206055
mini_batch_src_global generation:  0.04533672332763672
r_  generation:  0.5377037525177002
----------------------check_connections_block total spend ----------------------------- 10.846780776977539
generate_one_block  0.8997056484222412
generate_one_block  0.5393595695495605
generate_one_block  0.5223207473754883
generate_one_block  0.5190489292144775
generate_one_block  0.5264866352081299
generate_one_block  0.5211691856384277
generate_one_block  0.5181500911712646
generate_one_block  0.5228638648986816
generate_one_block  0.5238509178161621
generate_one_block  0.5214076042175293
generate_one_block  0.5203919410705566
generate_one_block  0.5255978107452393
generate_one_block  0.5359668731689453
generate_one_block  0.5207786560058594
generate_one_block  0.5211994647979736
generate_one_block  0.5406851768493652
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.207242965698242
gen group dst list time:  0.24862170219421387
time for parepare:  0.4557301998138428
local_output_nid generation:  0.18464398384094238
local_in_edges_tensor generation:  0.5668690204620361
mini_batch_src_global generation:  0.5419862270355225
r_  generation:  6.609091520309448
local_output_nid generation:  0.2204434871673584
local_in_edges_tensor generation:  0.5798830986022949
mini_batch_src_global generation:  0.6596536636352539
r_  generation:  6.938188314437866
local_output_nid generation:  0.190826416015625
local_in_edges_tensor generation:  0.6579327583312988
mini_batch_src_global generation:  0.702305793762207
r_  generation:  6.732327461242676
local_output_nid generation:  0.1881861686706543
local_in_edges_tensor generation:  0.4439575672149658
mini_batch_src_global generation:  0.6672275066375732
r_  generation:  6.911552429199219
local_output_nid generation:  0.1878046989440918
local_in_edges_tensor generation:  0.45812153816223145
mini_batch_src_global generation:  0.7696199417114258
r_  generation:  7.148126840591431
local_output_nid generation:  0.2082686424255371
local_in_edges_tensor generation:  0.5678229331970215
mini_batch_src_global generation:  0.6998341083526611
r_  generation:  6.993504285812378
local_output_nid generation:  0.18779277801513672
local_in_edges_tensor generation:  0.4598531723022461
mini_batch_src_global generation:  0.7329397201538086
r_  generation:  7.105549097061157
local_output_nid generation:  0.18163752555847168
local_in_edges_tensor generation:  0.5548334121704102
mini_batch_src_global generation:  0.7280740737915039
r_  generation:  7.039921760559082
local_output_nid generation:  0.1995699405670166
local_in_edges_tensor generation:  0.4612569808959961
mini_batch_src_global generation:  0.70639967918396
r_  generation:  7.013152599334717
local_output_nid generation:  0.19761443138122559
local_in_edges_tensor generation:  0.4370443820953369
mini_batch_src_global generation:  0.7364838123321533
r_  generation:  7.225460529327393
local_output_nid generation:  0.20939087867736816
local_in_edges_tensor generation:  0.5819590091705322
mini_batch_src_global generation:  0.7142107486724854
r_  generation:  7.005176782608032
local_output_nid generation:  0.19227933883666992
local_in_edges_tensor generation:  0.43996667861938477
mini_batch_src_global generation:  0.7200803756713867
r_  generation:  7.1551573276519775
local_output_nid generation:  0.18070006370544434
local_in_edges_tensor generation:  0.508735179901123
mini_batch_src_global generation:  0.7470231056213379
r_  generation:  7.131985902786255
local_output_nid generation:  0.2008068561553955
local_in_edges_tensor generation:  0.5009162425994873
mini_batch_src_global generation:  0.7130458354949951
r_  generation:  7.069483518600464
local_output_nid generation:  0.18594884872436523
local_in_edges_tensor generation:  0.4435000419616699
mini_batch_src_global generation:  0.7474684715270996
r_  generation:  7.175067186355591
local_output_nid generation:  0.17673921585083008
local_in_edges_tensor generation:  0.5820722579956055
mini_batch_src_global generation:  0.7860467433929443
r_  generation:  6.981876373291016
----------------------check_connections_block total spend ----------------------------- 154.73974204063416
generate_one_block  9.764059782028198
generate_one_block  9.710860252380371
generate_one_block  9.571048259735107
generate_one_block  9.285898208618164
generate_one_block  9.525579690933228
generate_one_block  9.355157136917114
generate_one_block  9.552722930908203
generate_one_block  9.30501651763916
generate_one_block  9.296348094940186
generate_one_block  9.7040433883667
generate_one_block  9.346529960632324
generate_one_block  9.803884029388428
generate_one_block  9.38269305229187
generate_one_block  9.237428188323975
generate_one_block  9.48043441772461
generate_one_block  9.285497665405273
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1298816204071045
gen group dst list time:  1.0021510124206543
time for parepare:  0.4761195182800293
local_output_nid generation:  0.5870285034179688
local_in_edges_tensor generation:  1.2991714477539062
mini_batch_src_global generation:  1.1917724609375
r_  generation:  15.017636060714722
local_output_nid generation:  0.6362898349761963
local_in_edges_tensor generation:  1.4068443775177002
mini_batch_src_global generation:  1.7199182510375977
r_  generation:  14.974665403366089
local_output_nid generation:  0.6174294948577881
local_in_edges_tensor generation:  1.1173927783966064
mini_batch_src_global generation:  1.6001784801483154
r_  generation:  15.285551071166992
local_output_nid generation:  0.6395158767700195
local_in_edges_tensor generation:  1.2414429187774658
mini_batch_src_global generation:  1.5187554359436035
r_  generation:  15.615862607955933
local_output_nid generation:  0.6299920082092285
local_in_edges_tensor generation:  1.2385809421539307
mini_batch_src_global generation:  1.4560081958770752
r_  generation:  15.33466386795044
local_output_nid generation:  0.6064190864562988
local_in_edges_tensor generation:  1.1107640266418457
mini_batch_src_global generation:  1.5810799598693848
r_  generation:  15.278088331222534
local_output_nid generation:  0.632056713104248
local_in_edges_tensor generation:  1.2566587924957275
mini_batch_src_global generation:  1.65779709815979
r_  generation:  15.362035036087036
local_output_nid generation:  0.645331621170044
local_in_edges_tensor generation:  1.2356598377227783
mini_batch_src_global generation:  1.4580159187316895
r_  generation:  15.554298639297485
local_output_nid generation:  0.619091272354126
local_in_edges_tensor generation:  1.243528127670288
mini_batch_src_global generation:  1.4910411834716797
r_  generation:  15.288195133209229
local_output_nid generation:  0.6131868362426758
local_in_edges_tensor generation:  1.1030030250549316
mini_batch_src_global generation:  1.5234508514404297
r_  generation:  15.23967719078064
local_output_nid generation:  0.6519770622253418
local_in_edges_tensor generation:  1.2438600063323975
mini_batch_src_global generation:  1.571096420288086
r_  generation:  15.453373432159424
local_output_nid generation:  0.6165423393249512
local_in_edges_tensor generation:  1.2646069526672363
mini_batch_src_global generation:  1.4710547924041748
r_  generation:  15.643850803375244
local_output_nid generation:  0.6028876304626465
local_in_edges_tensor generation:  1.26896071434021
mini_batch_src_global generation:  1.4824559688568115
r_  generation:  15.317831993103027
local_output_nid generation:  0.6125888824462891
local_in_edges_tensor generation:  2.7282564640045166
mini_batch_src_global generation:  1.5257093906402588
r_  generation:  15.369317770004272
local_output_nid generation:  0.6332857608795166
local_in_edges_tensor generation:  1.2475523948669434
mini_batch_src_global generation:  1.5904154777526855
r_  generation:  15.345000982284546
local_output_nid generation:  0.6364147663116455
local_in_edges_tensor generation:  1.2568113803863525
mini_batch_src_global generation:  1.522620677947998
r_  generation:  15.733393669128418
----------------------check_connections_block total spend ----------------------------- 346.39568161964417
generate_one_block  21.00640368461609
generate_one_block  20.73249912261963
generate_one_block  20.3148934841156
generate_one_block  20.8601815700531
generate_one_block  20.7843279838562
generate_one_block  20.868814706802368
generate_one_block  20.782562732696533
generate_one_block  21.34305238723755
generate_one_block  20.83011555671692
generate_one_block  20.910277605056763
generate_one_block  20.983717918395996
generate_one_block  20.925684213638306
generate_one_block  20.853142499923706
generate_one_block  20.916396141052246
generate_one_block  20.913530826568604
generate_one_block  20.711138010025024
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.0252532958984375  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

connection checking time:  501.1354236602783
block generation total time  485.34394001960754
average batch blocks generation time:  30.33399625122547
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.209101676940918  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9388556480407715  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2111940383911133  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9437289237976074  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2073569297790527  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.934669017791748  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2066712379455566  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9357619285583496  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2097830772399902  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9453606605529785  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2093191146850586  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.944194793701172  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.209150791168213  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.935868740081787  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2089977264404297  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.940944194793701  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2083969116210938  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9362077713012695  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.208242416381836  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.937742233276367  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2104053497314453  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.946256160736084  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2109122276306152  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.94392728805542  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.209686279296875  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.941936492919922  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2106266021728516  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.945404529571533  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2081832885742188  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9362058639526367  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 1.2065091133117676  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2947998046875 GB
    Memory Allocated: 2.9370908737182617  GigaBytes
Max Memory Allocated: 3.6148924827575684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.27712906897068024 |0.3202773928642273 |0.003877684473991394 |0.00014643371105194092 |0.004113391041755676 |0.0014495849609375 |
----------------------------------------------------------pseudo_mini_loss sum 2.392237663269043
Total (block generation + training)time/epoch 1044.3050938248634
Training time/epoch 1647801237.8533094
Training time without block to device /epoch 1647801232.728871
Training time without total dataloading part /epoch 0.13164973258972168
load block tensor time/epoch 4.434065103530884
block to device time/epoch 5.124438285827637
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  70338407
Number of first layer input nodes during this epoch: Using backend: pytorch
 34748105
