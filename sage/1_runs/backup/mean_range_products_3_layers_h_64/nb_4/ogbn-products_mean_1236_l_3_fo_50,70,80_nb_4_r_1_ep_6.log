main start at this time 1648124544.398369
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5777387619018555
range selection method range initialization spend 0.02864241600036621
time for parepare:  0.36458301544189453
local_output_nid generation:  0.013206958770751953
local_in_edges_tensor generation:  0.07553720474243164
mini_batch_src_global generation:  0.1036374568939209
r_  generation:  1.5672008991241455
local_output_nid generation:  0.013718843460083008
local_in_edges_tensor generation:  0.055805206298828125
mini_batch_src_global generation:  0.13478541374206543
r_  generation:  1.6592440605163574
local_output_nid generation:  0.013570308685302734
local_in_edges_tensor generation:  0.039490461349487305
mini_batch_src_global generation:  0.10787463188171387
r_  generation:  1.7282822132110596
local_output_nid generation:  0.013689756393432617
local_in_edges_tensor generation:  0.04727053642272949
mini_batch_src_global generation:  0.11683106422424316
r_  generation:  1.8502111434936523
----------------------check_connections_block total spend ----------------------------- 8.859176397323608
generate_one_block  7.076385021209717
generate_one_block  2.115800142288208
generate_one_block  2.1034042835235596
generate_one_block  2.093869209289551
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3943123817443848
gen group dst list time:  0.11681890487670898
time for parepare:  0.44133472442626953
local_output_nid generation:  0.19144916534423828
local_in_edges_tensor generation:  1.067807674407959
mini_batch_src_global generation:  1.6291944980621338
r_  generation:  20.3006329536438
local_output_nid generation:  0.3409426212310791
local_in_edges_tensor generation:  1.3988466262817383
mini_batch_src_global generation:  2.1524062156677246
r_  generation:  20.451796770095825
local_output_nid generation:  0.352048397064209
local_in_edges_tensor generation:  1.7020387649536133
mini_batch_src_global generation:  2.054131031036377
r_  generation:  20.538803100585938
local_output_nid generation:  0.36009979248046875
local_in_edges_tensor generation:  2.3380208015441895
mini_batch_src_global generation:  2.04620361328125
r_  generation:  20.810781478881836
----------------------check_connections_block total spend ----------------------------- 112.09798526763916
generate_one_block  28.298105716705322
generate_one_block  28.07015323638916
generate_one_block  28.09961223602295
generate_one_block  28.067606449127197
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.295987606048584
gen group dst list time:  0.31638407707214355
time for parepare:  0.4795961380004883
local_output_nid generation:  0.4476950168609619
local_in_edges_tensor generation:  1.5875146389007568
mini_batch_src_global generation:  2.026163101196289
r_  generation:  26.26299738883972
local_output_nid generation:  0.6872987747192383
local_in_edges_tensor generation:  2.08542537689209
mini_batch_src_global generation:  2.905510663986206
r_  generation:  26.37734365463257
local_output_nid generation:  0.7241063117980957
local_in_edges_tensor generation:  1.8791403770446777
mini_batch_src_global generation:  2.9769134521484375
r_  generation:  27.099305629730225
local_output_nid generation:  0.7354395389556885
local_in_edges_tensor generation:  1.9085607528686523
mini_batch_src_global generation:  2.9423060417175293
r_  generation:  26.672107219696045
----------------------check_connections_block total spend ----------------------------- 146.97377467155457
generate_one_block  35.365614891052246
generate_one_block  35.22826623916626
generate_one_block  35.0667679309845
generate_one_block  36.92356038093567
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  259.0717599391937
block generation total time  255.1196870803833
average batch blocks generation time:  63.779921770095825
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8485107421875 GB
    Memory Allocated: 1.753647804260254  GigaBytes
Max Memory Allocated: 1.753647804260254  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.9871826171875 GB
    Memory Allocated: 4.652029514312744  GigaBytes
Max Memory Allocated: 5.01170539855957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7117919921875 GB
    Memory Allocated: 1.7645435333251953  GigaBytes
Max Memory Allocated: 5.841701984405518  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2176513671875 GB
    Memory Allocated: 4.653928279876709  GigaBytes
Max Memory Allocated: 5.841701984405518  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0731201171875 GB
    Memory Allocated: 1.763291358947754  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0731201171875 GB
    Memory Allocated: 4.654995918273926  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0731201171875 GB
    Memory Allocated: 1.7631869316101074  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0731201171875 GB
    Memory Allocated: 4.649229049682617  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40213364362716675 |1.2441409826278687 |0.19046205282211304 |0.0001793503761291504 |0.09490472078323364 |0.001783132553100586 |
----------------------------------------------------------pseudo_mini_loss sum 8.676854133605957
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21876442
Number of first layer input nodes during this epoch:  9172563
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.0731201171875 GB
    Memory Allocated: 3.595036506652832  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6973700523376465
range selection method range initialization spend 0.027776479721069336
time for parepare:  0.3695657253265381
local_output_nid generation:  0.012976884841918945
local_in_edges_tensor generation:  0.08380460739135742
mini_batch_src_global generation:  0.11212325096130371
r_  generation:  1.9439733028411865
local_output_nid generation:  0.013547420501708984
local_in_edges_tensor generation:  0.058638811111450195
mini_batch_src_global generation:  0.145613431930542
r_  generation:  1.7477381229400635
local_output_nid generation:  0.01374197006225586
local_in_edges_tensor generation:  0.0698702335357666
mini_batch_src_global generation:  0.13053011894226074
r_  generation:  1.7550606727600098
local_output_nid generation:  0.014694690704345703
local_in_edges_tensor generation:  0.05745363235473633
mini_batch_src_global generation:  0.12354636192321777
r_  generation:  1.9783987998962402
----------------------check_connections_block total spend ----------------------------- 9.70536756515503
generate_one_block  2.5646839141845703
generate_one_block  2.1398377418518066
generate_one_block  2.1846718788146973
generate_one_block  2.167327880859375
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.44938063621521
gen group dst list time:  0.12673544883728027
time for parepare:  0.43901872634887695
local_output_nid generation:  0.18687129020690918
local_in_edges_tensor generation:  1.1130809783935547
mini_batch_src_global generation:  1.630319356918335
r_  generation:  20.160780906677246
local_output_nid generation:  0.3567540645599365
local_in_edges_tensor generation:  1.4064891338348389
mini_batch_src_global generation:  2.263547420501709
r_  generation:  20.468916177749634
local_output_nid generation:  0.3684558868408203
local_in_edges_tensor generation:  1.6526203155517578
mini_batch_src_global generation:  2.0634102821350098
r_  generation:  20.822946071624756
local_output_nid generation:  0.378692626953125
local_in_edges_tensor generation:  1.425285816192627
mini_batch_src_global generation:  2.2068769931793213
r_  generation:  20.83887553215027
----------------------check_connections_block total spend ----------------------------- 112.13169622421265
generate_one_block  28.497387409210205
generate_one_block  29.22874879837036
generate_one_block  28.46767830848694
generate_one_block  28.310953617095947
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2334487438201904
gen group dst list time:  0.32616639137268066
time for parepare:  0.4817800521850586
local_output_nid generation:  0.4495575428009033
local_in_edges_tensor generation:  1.6240410804748535
mini_batch_src_global generation:  2.0454657077789307
r_  generation:  26.353296041488647
local_output_nid generation:  0.6834778785705566
local_in_edges_tensor generation:  2.1347875595092773
mini_batch_src_global generation:  2.9955549240112305
r_  generation:  26.164108276367188
local_output_nid generation:  0.7230024337768555
local_in_edges_tensor generation:  1.894211769104004
mini_batch_src_global generation:  2.9079997539520264
r_  generation:  26.74291157722473
local_output_nid generation:  0.710465669631958
local_in_edges_tensor generation:  1.9071409702301025
mini_batch_src_global generation:  2.757620096206665
r_  generation:  26.776198863983154
----------------------check_connections_block total spend ----------------------------- 146.6275351047516
generate_one_block  35.66348886489868
generate_one_block  35.382320404052734
generate_one_block  35.420963287353516
generate_one_block  35.46245074272156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.0731201171875 GB
    Memory Allocated: 3.595036506652832  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

connection checking time:  258.75923132896423
block generation total time  256.43399143218994
average batch blocks generation time:  64.10849785804749
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0731201171875 GB
    Memory Allocated: 1.7629361152648926  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.6522979736328125  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7632694244384766  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.649429798126221  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.765542984008789  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.657138824462891  GigaBytes
Max Memory Allocated: 5.84623908996582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7628107070922852  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.650206089019775  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4834114909172058 |1.151919662952423 |0.004113554954528809 |0.00014156103134155273 |0.0051506757736206055 |0.002841472625732422 |
----------------------------------------------------------pseudo_mini_loss sum 5.067840576171875
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21873636
Number of first layer input nodes during this epoch:  9174236
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 3.5939297676086426  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6474897861480713
range selection method range initialization spend 0.0306854248046875
time for parepare:  0.36491847038269043
local_output_nid generation:  0.013336420059204102
local_in_edges_tensor generation:  0.06419157981872559
mini_batch_src_global generation:  0.1055448055267334
r_  generation:  1.5904324054718018
local_output_nid generation:  0.013758182525634766
local_in_edges_tensor generation:  0.04958081245422363
mini_batch_src_global generation:  0.13535118103027344
r_  generation:  1.674436330795288
local_output_nid generation:  0.013471603393554688
local_in_edges_tensor generation:  0.019541025161743164
mini_batch_src_global generation:  0.11762595176696777
r_  generation:  1.737729787826538
local_output_nid generation:  0.013609886169433594
local_in_edges_tensor generation:  0.01955890655517578
mini_batch_src_global generation:  0.12355327606201172
r_  generation:  1.88285231590271
----------------------check_connections_block total spend ----------------------------- 8.937494277954102
generate_one_block  2.5025954246520996
generate_one_block  2.0984437465667725
generate_one_block  2.1284852027893066
generate_one_block  2.090359926223755
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3502161502838135
gen group dst list time:  0.12411642074584961
time for parepare:  0.44757580757141113
local_output_nid generation:  0.18149566650390625
local_in_edges_tensor generation:  1.1153273582458496
mini_batch_src_global generation:  1.6188759803771973
r_  generation:  19.59726905822754
local_output_nid generation:  0.3405575752258301
local_in_edges_tensor generation:  1.5190227031707764
mini_batch_src_global generation:  2.059774875640869
r_  generation:  20.292699575424194
local_output_nid generation:  0.3670804500579834
local_in_edges_tensor generation:  1.4125783443450928
mini_batch_src_global generation:  2.0587611198425293
r_  generation:  20.573312759399414
local_output_nid generation:  0.3871598243713379
local_in_edges_tensor generation:  1.4306650161743164
mini_batch_src_global generation:  2.0931921005249023
r_  generation:  20.72720742225647
----------------------check_connections_block total spend ----------------------------- 110.60912013053894
generate_one_block  28.29171323776245
generate_one_block  28.729130268096924
generate_one_block  28.044350147247314
generate_one_block  28.39598798751831
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.342801094055176
gen group dst list time:  0.346513032913208
time for parepare:  0.46509528160095215
local_output_nid generation:  0.46358609199523926
local_in_edges_tensor generation:  1.5971474647521973
mini_batch_src_global generation:  2.034431219100952
r_  generation:  26.245018482208252
local_output_nid generation:  0.6759817600250244
local_in_edges_tensor generation:  2.0871667861938477
mini_batch_src_global generation:  2.824326276779175
r_  generation:  26.207688331604004
local_output_nid generation:  0.7065231800079346
local_in_edges_tensor generation:  1.913989782333374
mini_batch_src_global generation:  3.0292580127716064
r_  generation:  26.669084787368774
local_output_nid generation:  0.7284955978393555
local_in_edges_tensor generation:  1.907684564590454
mini_batch_src_global generation:  2.7576639652252197
r_  generation:  26.727810382843018
----------------------check_connections_block total spend ----------------------------- 145.97572994232178
generate_one_block  35.21678161621094
generate_one_block  35.19413661956787
generate_one_block  35.32707953453064
generate_one_block  35.46211862564087
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 3.5939297676086426  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

connection checking time:  256.5848500728607
block generation total time  254.66129803657532
average batch blocks generation time:  63.66532450914383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7625088691711426  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.650688648223877  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7623443603515625  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.651602745056152  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7640380859375  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.6513590812683105  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.767582893371582  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.661245822906494  GigaBytes
Max Memory Allocated: 5.84895133972168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4755252003669739 |0.9265450835227966 |0.006389439105987549 |0.00013834238052368164 |0.05507892370223999 |0.0026788711547851562 |
----------------------------------------------------------pseudo_mini_loss sum 3.679323196411133
Total (block generation + training)time/epoch 566.0573256015778
Training time/epoch 1648126298.5246918
Training time without block to device /epoch 1648126294.8185115
Training time without total dataloading part /epoch 0.24910569190979004
load block tensor time/epoch 1.9021008014678955
block to device time/epoch 3.7061803340911865
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  21874906
Number of first layer input nodes during this epoch:  9172419
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 3.6031107902526855  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5587804317474365
range selection method range initialization spend 0.029307842254638672
time for parepare:  0.3614671230316162
local_output_nid generation:  0.013056278228759766
local_in_edges_tensor generation:  0.05872988700866699
mini_batch_src_global generation:  0.10847067832946777
r_  generation:  1.637047290802002
local_output_nid generation:  0.013601064682006836
local_in_edges_tensor generation:  0.03733062744140625
mini_batch_src_global generation:  0.13567090034484863
r_  generation:  1.8115670680999756
local_output_nid generation:  0.014383792877197266
local_in_edges_tensor generation:  0.019728660583496094
mini_batch_src_global generation:  0.10822010040283203
r_  generation:  1.7631287574768066
local_output_nid generation:  0.014525413513183594
local_in_edges_tensor generation:  0.019864320755004883
mini_batch_src_global generation:  0.12677907943725586
r_  generation:  1.8566491603851318
----------------------check_connections_block total spend ----------------------------- 9.12961196899414
generate_one_block  2.604989528656006
generate_one_block  2.561690330505371
generate_one_block  2.1325418949127197
generate_one_block  2.127941370010376
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.534083604812622
gen group dst list time:  0.1290736198425293
time for parepare:  0.4537925720214844
local_output_nid generation:  0.2061457633972168
local_in_edges_tensor generation:  1.2111914157867432
mini_batch_src_global generation:  1.680701732635498
r_  generation:  20.155336380004883
local_output_nid generation:  0.35193896293640137
local_in_edges_tensor generation:  1.550598382949829
mini_batch_src_global generation:  2.1641135215759277
r_  generation:  20.35222625732422
local_output_nid generation:  0.37744641304016113
local_in_edges_tensor generation:  1.4267830848693848
mini_batch_src_global generation:  2.284105062484741
r_  generation:  20.541768550872803
local_output_nid generation:  0.3886103630065918
local_in_edges_tensor generation:  1.4362502098083496
mini_batch_src_global generation:  2.321507692337036
r_  generation:  20.55866312980652
----------------------check_connections_block total spend ----------------------------- 111.81505227088928
generate_one_block  28.655604362487793
generate_one_block  28.84737467765808
generate_one_block  28.183884382247925
generate_one_block  28.21858286857605
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4004671573638916
gen group dst list time:  0.32500386238098145
time for parepare:  0.4651060104370117
local_output_nid generation:  0.44967007637023926
local_in_edges_tensor generation:  1.7070014476776123
mini_batch_src_global generation:  2.0674922466278076
r_  generation:  25.993701934814453
local_output_nid generation:  0.6856851577758789
local_in_edges_tensor generation:  1.9334383010864258
mini_batch_src_global generation:  2.9549877643585205
r_  generation:  26.352957248687744
local_output_nid generation:  0.7111637592315674
local_in_edges_tensor generation:  2.1987428665161133
mini_batch_src_global generation:  2.819791078567505
r_  generation:  26.53414821624756
local_output_nid generation:  0.7220048904418945
local_in_edges_tensor generation:  1.9444410800933838
mini_batch_src_global generation:  2.9461677074432373
r_  generation:  26.397686004638672
----------------------check_connections_block total spend ----------------------------- 145.88587045669556
generate_one_block  35.24371027946472
generate_one_block  35.25005078315735
generate_one_block  34.949270248413086
generate_one_block  35.09811544418335
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 3.6031107902526855  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

connection checking time:  257.70092272758484
block generation total time  254.44659304618835
average batch blocks generation time:  63.61164826154709
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7667808532714844  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.658746242523193  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.762265682220459  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.650338172912598  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7623085975646973  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.648974895477295  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7628240585327148  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.650841236114502  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.472795307636261 |1.197493851184845 |0.0038458704948425293 |0.00014078617095947266 |0.005048573017120361 |0.002595186233520508 |
----------------------------------------------------------pseudo_mini_loss sum 3.0840163230895996
Total (block generation + training)time/epoch 567.1444430351257
Training time/epoch 1648126866.7566447
Training time without block to device /epoch 1648126861.9666693
Training time without total dataloading part /epoch 0.03873610496520996
load block tensor time/epoch 1.891181230545044
block to device time/epoch 4.78997540473938
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  21873065
Number of first layer input nodes during this epoch:  9171996
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 3.5947675704956055  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6601250171661377
range selection method range initialization spend 0.02791571617126465
time for parepare:  0.35649633407592773
local_output_nid generation:  0.013145923614501953
local_in_edges_tensor generation:  0.05856895446777344
mini_batch_src_global generation:  0.10602021217346191
r_  generation:  1.6157188415527344
local_output_nid generation:  0.01380610466003418
local_in_edges_tensor generation:  0.037328243255615234
mini_batch_src_global generation:  0.1345221996307373
r_  generation:  1.7048563957214355
local_output_nid generation:  0.01340937614440918
local_in_edges_tensor generation:  0.024794578552246094
mini_batch_src_global generation:  0.11405515670776367
r_  generation:  1.739208459854126
local_output_nid generation:  0.013602972030639648
local_in_edges_tensor generation:  0.04139375686645508
mini_batch_src_global generation:  0.12065243721008301
r_  generation:  1.8720533847808838
----------------------check_connections_block total spend ----------------------------- 8.989815473556519
generate_one_block  2.525439739227295
generate_one_block  2.118431806564331
generate_one_block  2.1280715465545654
generate_one_block  2.105226755142212
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3575849533081055
gen group dst list time:  0.11721396446228027
time for parepare:  0.4487943649291992
local_output_nid generation:  0.19331955909729004
local_in_edges_tensor generation:  1.1777124404907227
mini_batch_src_global generation:  1.6284456253051758
r_  generation:  19.89807963371277
local_output_nid generation:  0.3509390354156494
local_in_edges_tensor generation:  1.5519287586212158
mini_batch_src_global generation:  2.153650999069214
r_  generation:  20.318308353424072
local_output_nid generation:  0.38149547576904297
local_in_edges_tensor generation:  1.4610161781311035
mini_batch_src_global generation:  2.2360944747924805
r_  generation:  20.854716300964355
local_output_nid generation:  0.3876638412475586
local_in_edges_tensor generation:  1.454965353012085
mini_batch_src_global generation:  2.1874358654022217
r_  generation:  20.81572699546814
----------------------check_connections_block total spend ----------------------------- 111.65031480789185
generate_one_block  28.28429126739502
generate_one_block  29.07373332977295
generate_one_block  28.45928716659546
generate_one_block  28.305880546569824
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4002721309661865
gen group dst list time:  0.34117746353149414
time for parepare:  0.4975264072418213
local_output_nid generation:  0.48715853691101074
local_in_edges_tensor generation:  1.7009758949279785
mini_batch_src_global generation:  1.9827961921691895
r_  generation:  25.93287682533264
local_output_nid generation:  0.686272382736206
local_in_edges_tensor generation:  1.8975036144256592
mini_batch_src_global generation:  2.800307512283325
r_  generation:  25.970115184783936
local_output_nid generation:  0.7157042026519775
local_in_edges_tensor generation:  1.898179054260254
mini_batch_src_global generation:  2.789673328399658
r_  generation:  26.30873680114746
local_output_nid generation:  0.724468469619751
local_in_edges_tensor generation:  1.8831403255462646
mini_batch_src_global generation:  3.0533227920532227
r_  generation:  26.46102213859558
----------------------check_connections_block total spend ----------------------------- 144.50547409057617
generate_one_block  35.18749713897705
generate_one_block  35.21560096740723
generate_one_block  35.12850785255432
generate_one_block  34.872334003448486
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 3.5947675704956055  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

connection checking time:  256.155788898468
block generation total time  254.52713227272034
average batch blocks generation time:  63.631783068180084
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.76206636428833  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.648313999176025  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7635650634765625  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.653000831604004  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7649250030517578  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.656538963317871  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7627105712890625  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes
Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.650921821594238  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4777591824531555 |1.1620771288871765 |0.004104673862457275 |0.00015211105346679688 |0.005152702331542969 |0.0013632774353027344 |
----------------------------------------------------------pseudo_mini_loss sum 2.6568727493286133
Total (block generation + training)time/epoch 566.9361461003622
Training time/epoch 1648127433.276468
Training time without block to device /epoch 1648127428.6281595
Training time without total dataloading part /epoch 0.0390012264251709
load block tensor time/epoch 1.911036729812622
block to device time/epoch 4.648308515548706
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  21874893
Number of first layer input nodes during this epoch:  9173170
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 3.593568801879883  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6730878353118896
range selection method range initialization spend 0.02758193016052246
time for parepare:  0.3726463317871094
local_output_nid generation:  0.01532125473022461
local_in_edges_tensor generation:  0.06122303009033203
mini_batch_src_global generation:  0.10944581031799316
r_  generation:  1.6317777633666992
local_output_nid generation:  0.028347015380859375
local_in_edges_tensor generation:  0.04465651512145996
mini_batch_src_global generation:  0.1375274658203125
r_  generation:  1.8215827941894531
local_output_nid generation:  0.016553401947021484
local_in_edges_tensor generation:  0.04243016242980957
mini_batch_src_global generation:  0.11022138595581055
r_  generation:  1.7364578247070312
local_output_nid generation:  0.016399860382080078
local_in_edges_tensor generation:  0.03706789016723633
mini_batch_src_global generation:  0.12694215774536133
r_  generation:  1.8387537002563477
----------------------check_connections_block total spend ----------------------------- 9.205723762512207
generate_one_block  2.59987735748291
generate_one_block  2.410994291305542
generate_one_block  2.271091938018799
generate_one_block  2.1261467933654785
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3595967292785645
gen group dst list time:  0.13179922103881836
time for parepare:  0.46957921981811523
local_output_nid generation:  0.21409201622009277
local_in_edges_tensor generation:  1.1177210807800293
mini_batch_src_global generation:  1.8155162334442139
r_  generation:  20.145509481430054
local_output_nid generation:  0.3509957790374756
local_in_edges_tensor generation:  1.6508066654205322
mini_batch_src_global generation:  2.4076931476593018
r_  generation:  20.15759539604187
local_output_nid generation:  0.367717981338501
local_in_edges_tensor generation:  1.511915683746338
mini_batch_src_global generation:  2.2848284244537354
r_  generation:  20.44525694847107
local_output_nid generation:  0.38828611373901367
local_in_edges_tensor generation:  1.4478299617767334
mini_batch_src_global generation:  2.325620174407959
r_  generation:  20.649632930755615
----------------------check_connections_block total spend ----------------------------- 112.15836977958679
generate_one_block  28.612374782562256
generate_one_block  28.928584337234497
generate_one_block  28.085028886795044
generate_one_block  28.377469301223755
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.476919412612915
gen group dst list time:  0.3282806873321533
time for parepare:  0.46698546409606934
local_output_nid generation:  0.4676082134246826
local_in_edges_tensor generation:  1.6450083255767822
mini_batch_src_global generation:  2.085832357406616
r_  generation:  26.184728860855103
local_output_nid generation:  0.7073004245758057
local_in_edges_tensor generation:  1.9174997806549072
mini_batch_src_global generation:  2.9171998500823975
r_  generation:  26.170839309692383
local_output_nid generation:  0.730562686920166
local_in_edges_tensor generation:  2.1776604652404785
mini_batch_src_global generation:  2.751188039779663
r_  generation:  26.66271209716797
local_output_nid generation:  0.7525620460510254
local_in_edges_tensor generation:  1.9145467281341553
mini_batch_src_global generation:  3.0584144592285156
r_  generation:  26.32193922996521
----------------------check_connections_block total spend ----------------------------- 146.00472164154053
generate_one_block  35.22511315345764
generate_one_block  35.166964530944824
generate_one_block  34.862550497055054
generate_one_block  35.04812455177307
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 3.593568801879883  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

connection checking time:  258.1630914211273
block generation total time  254.30621004104614
average batch blocks generation time:  63.576552510261536
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7616500854492188  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.647209167480469  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7648625373840332  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.655383110046387  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.763291358947754  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.651103496551514  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 1.7641253471374512  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0750732421875 GB
    Memory Allocated: 4.652836799621582  GigaBytes
Max Memory Allocated: 5.851835250854492  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4902002811431885 |1.1344922184944153 |0.004052162170410156 |0.00014799833297729492 |0.005131661891937256 |0.001191854476928711 |
----------------------------------------------------------pseudo_mini_loss sum 2.3653008937835693
Total (block generation + training)time/epoch 567.4719722867012
Training time/epoch 1648128002.3561924
Training time without block to device /epoch 1648127997.8182235
Training time without total dataloading part /epoch 0.03851914405822754
load block tensor time/epoch 1.960801124572754
block to device time/epoch 4.537968873977661
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  21869186
Number of first layer input nodes during this epoch:  9171408
