main start at this time 1648009668.4241352
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6430742740631104
range selection method range initialization spend 0.028834104537963867
time for parepare:  0.37027931213378906
local_output_nid generation:  0.00666046142578125
local_in_edges_tensor generation:  0.04697251319885254
mini_batch_src_global generation:  0.0493769645690918
r_  generation:  0.8035600185394287
local_output_nid generation:  0.007222890853881836
local_in_edges_tensor generation:  0.02279210090637207
mini_batch_src_global generation:  0.06495189666748047
r_  generation:  0.859821081161499
local_output_nid generation:  0.007014751434326172
local_in_edges_tensor generation:  0.019395112991333008
mini_batch_src_global generation:  0.04857206344604492
r_  generation:  0.8945052623748779
local_output_nid generation:  0.007233142852783203
local_in_edges_tensor generation:  0.015987157821655273
mini_batch_src_global generation:  0.057537078857421875
r_  generation:  0.9776382446289062
local_output_nid generation:  0.00708460807800293
local_in_edges_tensor generation:  0.011309623718261719
mini_batch_src_global generation:  0.06350564956665039
r_  generation:  1.032022476196289
local_output_nid generation:  0.007004261016845703
local_in_edges_tensor generation:  0.012378692626953125
mini_batch_src_global generation:  0.07022261619567871
r_  generation:  1.0894787311553955
local_output_nid generation:  0.007058858871459961
local_in_edges_tensor generation:  0.02237725257873535
mini_batch_src_global generation:  0.0749506950378418
r_  generation:  1.0650050640106201
local_output_nid generation:  0.00713038444519043
local_in_edges_tensor generation:  0.016898155212402344
mini_batch_src_global generation:  0.0743868350982666
r_  generation:  1.066901445388794
----------------------check_connections_block total spend ----------------------------- 10.058895349502563
generate_one_block  6.17678427696228
generate_one_block  1.0650665760040283
generate_one_block  1.0188546180725098
generate_one_block  1.0800375938415527
generate_one_block  1.066087007522583
generate_one_block  1.020482063293457
generate_one_block  1.0619893074035645
generate_one_block  1.0602576732635498
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.246913433074951
gen group dst list time:  0.16652774810791016
time for parepare:  0.4449625015258789
local_output_nid generation:  0.13904356956481934
local_in_edges_tensor generation:  0.6138105392456055
mini_batch_src_global generation:  0.7397418022155762
r_  generation:  9.476196527481079
local_output_nid generation:  0.21186447143554688
local_in_edges_tensor generation:  0.5916361808776855
mini_batch_src_global generation:  0.9494826793670654
r_  generation:  9.688679456710815
local_output_nid generation:  0.2541372776031494
local_in_edges_tensor generation:  0.7693126201629639
mini_batch_src_global generation:  0.9424176216125488
r_  generation:  9.843088150024414
local_output_nid generation:  0.2413194179534912
local_in_edges_tensor generation:  0.6557326316833496
mini_batch_src_global generation:  0.956758975982666
r_  generation:  9.952508926391602
local_output_nid generation:  0.2526216506958008
local_in_edges_tensor generation:  0.6522693634033203
mini_batch_src_global generation:  1.0315964221954346
r_  generation:  10.175412654876709
local_output_nid generation:  0.25477170944213867
local_in_edges_tensor generation:  0.6903431415557861
mini_batch_src_global generation:  0.9811155796051025
r_  generation:  10.200325727462769
local_output_nid generation:  0.2817239761352539
local_in_edges_tensor generation:  0.7589542865753174
mini_batch_src_global generation:  0.9912772178649902
r_  generation:  10.17745304107666
local_output_nid generation:  0.2656831741333008
local_in_edges_tensor generation:  0.6628942489624023
mini_batch_src_global generation:  1.0485398769378662
r_  generation:  10.107510805130005
----------------------check_connections_block total spend ----------------------------- 108.53678607940674
generate_one_block  13.756112337112427
generate_one_block  13.67581844329834
generate_one_block  13.796074628829956
generate_one_block  13.695974111557007
generate_one_block  13.322850227355957
generate_one_block  13.689374685287476
generate_one_block  13.274588584899902
generate_one_block  13.647933721542358
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.387864351272583
gen group dst list time:  0.6021435260772705
time for parepare:  0.47486209869384766
local_output_nid generation:  0.47087645530700684
local_in_edges_tensor generation:  1.1296238899230957
mini_batch_src_global generation:  1.166992425918579
r_  generation:  16.25203037261963
local_output_nid generation:  0.6432390213012695
local_in_edges_tensor generation:  1.3044052124023438
mini_batch_src_global generation:  1.6531274318695068
r_  generation:  16.37901210784912
local_output_nid generation:  0.666923999786377
local_in_edges_tensor generation:  1.472761631011963
mini_batch_src_global generation:  1.5168650150299072
r_  generation:  16.717639684677124
local_output_nid generation:  0.6660513877868652
local_in_edges_tensor generation:  1.2617881298065186
mini_batch_src_global generation:  1.6611649990081787
r_  generation:  16.39024305343628
local_output_nid generation:  0.6865394115447998
local_in_edges_tensor generation:  1.2632710933685303
mini_batch_src_global generation:  1.613476037979126
r_  generation:  16.621805667877197
local_output_nid generation:  0.69842529296875
local_in_edges_tensor generation:  1.2520205974578857
mini_batch_src_global generation:  1.62492036819458
r_  generation:  16.539977550506592
local_output_nid generation:  0.7035641670227051
local_in_edges_tensor generation:  1.3180453777313232
mini_batch_src_global generation:  1.6405327320098877
r_  generation:  16.62578248977661
local_output_nid generation:  0.7017271518707275
local_in_edges_tensor generation:  1.3205950260162354
mini_batch_src_global generation:  1.5886006355285645
r_  generation:  16.555466413497925
----------------------check_connections_block total spend ----------------------------- 184.33164501190186
generate_one_block  21.95068860054016
generate_one_block  22.82482385635376
generate_one_block  21.660661220550537
generate_one_block  21.670965433120728
generate_one_block  21.769050121307373
generate_one_block  21.7544002532959
generate_one_block  21.745169162750244
generate_one_block  21.82543182373047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  292.8684310913086
block generation total time  284.0599172115326
average batch blocks generation time:  35.507489651441574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4031982421875 GB
    Memory Allocated: 1.3040308952331543  GigaBytes
Max Memory Allocated: 1.3040308952331543  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3172607421875 GB
    Memory Allocated: 3.424923896789551  GigaBytes
Max Memory Allocated: 3.5888376235961914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3089046478271484  GigaBytes
Max Memory Allocated: 3.9674572944641113  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4274134635925293  GigaBytes
Max Memory Allocated: 3.9674572944641113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.308969497680664  GigaBytes
Max Memory Allocated: 3.9736170768737793  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4245009422302246  GigaBytes
Max Memory Allocated: 3.9736170768737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.307429313659668  GigaBytes
Max Memory Allocated: 3.9736170768737793  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4207000732421875  GigaBytes
Max Memory Allocated: 3.9736170768737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3109149932861328  GigaBytes
Max Memory Allocated: 3.9736170768737793  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.431623935699463  GigaBytes
Max Memory Allocated: 3.9736170768737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3095860481262207  GigaBytes
Max Memory Allocated: 3.9738926887512207  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4292030334472656  GigaBytes
Max Memory Allocated: 3.9738926887512207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3102655410766602  GigaBytes
Max Memory Allocated: 3.9738926887512207  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.428450107574463  GigaBytes
Max Memory Allocated: 3.9738926887512207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3055834770202637  GigaBytes
Max Memory Allocated: 3.9748082160949707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4154419898986816  GigaBytes
Max Memory Allocated: 3.9748082160949707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3650159239768982 |0.6775374710559845 |0.09316515922546387 |0.00015687942504882812 |0.05274021625518799 |0.0019714832305908203 |
----------------------------------------------------------pseudo_mini_loss sum 8.766780853271484
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  39024903
Number of first layer input nodes during this epoch:  17719458
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 2.28769588470459  GigaBytes
Max Memory Allocated: 3.9748082160949707  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7068901062011719
range selection method range initialization spend 0.026392459869384766
time for parepare:  0.3644084930419922
local_output_nid generation:  0.006668567657470703
local_in_edges_tensor generation:  0.04429149627685547
mini_batch_src_global generation:  0.05449819564819336
r_  generation:  0.7950618267059326
local_output_nid generation:  0.0072383880615234375
local_in_edges_tensor generation:  0.026183605194091797
mini_batch_src_global generation:  0.06531381607055664
r_  generation:  0.8572769165039062
local_output_nid generation:  0.00701451301574707
local_in_edges_tensor generation:  0.019475698471069336
mini_batch_src_global generation:  0.04877352714538574
r_  generation:  0.9024863243103027
local_output_nid generation:  0.007304191589355469
local_in_edges_tensor generation:  0.01939845085144043
mini_batch_src_global generation:  0.057056427001953125
r_  generation:  0.9723913669586182
local_output_nid generation:  0.007060050964355469
local_in_edges_tensor generation:  0.014681577682495117
mini_batch_src_global generation:  0.06445693969726562
r_  generation:  1.017289638519287
local_output_nid generation:  0.007040977478027344
local_in_edges_tensor generation:  0.01470804214477539
mini_batch_src_global generation:  0.07418990135192871
r_  generation:  1.052414894104004
local_output_nid generation:  0.007042407989501953
local_in_edges_tensor generation:  0.014479875564575195
mini_batch_src_global generation:  0.07204413414001465
r_  generation:  1.070403814315796
local_output_nid generation:  0.007180213928222656
local_in_edges_tensor generation:  0.014909029006958008
mini_batch_src_global generation:  0.08101844787597656
r_  generation:  1.0857341289520264
----------------------check_connections_block total spend ----------------------------- 10.04141116142273
generate_one_block  1.4347798824310303
generate_one_block  1.0561108589172363
generate_one_block  1.038693904876709
generate_one_block  1.0161969661712646
generate_one_block  1.0274381637573242
generate_one_block  1.0511894226074219
generate_one_block  1.13301420211792
generate_one_block  1.1758625507354736
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.3208889961242676
gen group dst list time:  0.18561434745788574
time for parepare:  0.49010777473449707
local_output_nid generation:  0.1506659984588623
local_in_edges_tensor generation:  0.6137170791625977
mini_batch_src_global generation:  0.7680239677429199
r_  generation:  10.037333011627197
local_output_nid generation:  0.2962934970855713
local_in_edges_tensor generation:  0.7029592990875244
mini_batch_src_global generation:  0.9839954376220703
r_  generation:  9.98214054107666
local_output_nid generation:  0.25682592391967773
local_in_edges_tensor generation:  0.7948441505432129
mini_batch_src_global generation:  0.9979243278503418
r_  generation:  10.041793584823608
local_output_nid generation:  0.2831759452819824
local_in_edges_tensor generation:  0.7565231323242188
mini_batch_src_global generation:  1.0141828060150146
r_  generation:  10.298108577728271
local_output_nid generation:  0.2836291790008545
local_in_edges_tensor generation:  0.7073907852172852
mini_batch_src_global generation:  0.9776947498321533
r_  generation:  10.334173679351807
local_output_nid generation:  0.260650634765625
local_in_edges_tensor generation:  0.717174768447876
mini_batch_src_global generation:  1.1055705547332764
r_  generation:  11.27335500717163
local_output_nid generation:  0.2942647933959961
local_in_edges_tensor generation:  0.8099384307861328
mini_batch_src_global generation:  1.0899348258972168
r_  generation:  10.583400249481201
local_output_nid generation:  0.28726840019226074
local_in_edges_tensor generation:  0.7817959785461426
mini_batch_src_global generation:  1.0420377254486084
r_  generation:  10.099215745925903
----------------------check_connections_block total spend ----------------------------- 113.44743323326111
generate_one_block  13.905824661254883
generate_one_block  13.892208576202393
generate_one_block  13.779799222946167
generate_one_block  13.362563371658325
generate_one_block  14.053070068359375
generate_one_block  13.94149899482727
generate_one_block  13.854515314102173
generate_one_block  13.269219636917114
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.208191156387329
gen group dst list time:  0.6009628772735596
time for parepare:  0.4980628490447998
local_output_nid generation:  0.48761463165283203
local_in_edges_tensor generation:  1.3188750743865967
mini_batch_src_global generation:  1.1947696208953857
r_  generation:  16.546216011047363
local_output_nid generation:  0.6372528076171875
local_in_edges_tensor generation:  1.362029790878296
mini_batch_src_global generation:  1.7086939811706543
r_  generation:  16.706071376800537
local_output_nid generation:  0.6786339282989502
local_in_edges_tensor generation:  1.389883279800415
mini_batch_src_global generation:  1.6431591510772705
r_  generation:  16.52700662612915
local_output_nid generation:  0.6887710094451904
local_in_edges_tensor generation:  1.2860140800476074
mini_batch_src_global generation:  1.586362600326538
r_  generation:  16.57038688659668
local_output_nid generation:  0.6931345462799072
local_in_edges_tensor generation:  1.302264928817749
mini_batch_src_global generation:  1.5865452289581299
r_  generation:  16.701650619506836
local_output_nid generation:  0.7035892009735107
local_in_edges_tensor generation:  1.3036470413208008
mini_batch_src_global generation:  1.6228597164154053
r_  generation:  16.815426349639893
local_output_nid generation:  0.704716682434082
local_in_edges_tensor generation:  1.3037478923797607
mini_batch_src_global generation:  1.5238797664642334
r_  generation:  17.498398780822754
local_output_nid generation:  0.7011775970458984
local_in_edges_tensor generation:  1.307084560394287
mini_batch_src_global generation:  1.5802545547485352
r_  generation:  16.914146423339844
----------------------check_connections_block total spend ----------------------------- 187.46568775177002
generate_one_block  22.140563011169434
generate_one_block  22.25844144821167
generate_one_block  22.223847150802612
generate_one_block  22.804999589920044
generate_one_block  21.864718437194824
generate_one_block  22.092180252075195
generate_one_block  22.07258677482605
generate_one_block  22.082050561904907
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 2.28769588470459  GigaBytes
Max Memory Allocated: 3.9748082160949707  GigaBytes

connection checking time:  300.9131209850311
block generation total time  287.59808707237244
average batch blocks generation time:  35.949760884046555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.306513786315918  GigaBytes
Max Memory Allocated: 3.9748082160949707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4201431274414062  GigaBytes
Max Memory Allocated: 3.9748082160949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3131799697875977  GigaBytes
Max Memory Allocated: 3.9748082160949707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.434807777404785  GigaBytes
Max Memory Allocated: 3.9748082160949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3075098991394043  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.415893077850342  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3085503578186035  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4267687797546387  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3129901885986328  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4302730560302734  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3100485801696777  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.430624485015869  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.308657169342041  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.423495292663574  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3083748817443848  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4245076179504395  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3896082937717438 |0.4221373498439789 |0.006284862756729126 |0.00014069676399230957 |0.005146682262420654 |0.0028028488159179688 |
----------------------------------------------------------pseudo_mini_loss sum 5.101820945739746
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  39025657
Number of first layer input nodes during this epoch:  17722081
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 2.290073871612549  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5531811714172363
range selection method range initialization spend 0.027304649353027344
time for parepare:  0.3369748592376709
local_output_nid generation:  0.006761312484741211
local_in_edges_tensor generation:  0.04465293884277344
mini_batch_src_global generation:  0.06155657768249512
r_  generation:  0.7830331325531006
local_output_nid generation:  0.007224321365356445
local_in_edges_tensor generation:  0.01905083656311035
mini_batch_src_global generation:  0.06813812255859375
r_  generation:  0.8627152442932129
local_output_nid generation:  0.0070629119873046875
local_in_edges_tensor generation:  0.012322187423706055
mini_batch_src_global generation:  0.06084084510803223
r_  generation:  0.8919785022735596
local_output_nid generation:  0.007477998733520508
local_in_edges_tensor generation:  0.012652873992919922
mini_batch_src_global generation:  0.05721783638000488
r_  generation:  0.9607305526733398
local_output_nid generation:  0.0072021484375
local_in_edges_tensor generation:  0.012543201446533203
mini_batch_src_global generation:  0.06763410568237305
r_  generation:  1.0009510517120361
local_output_nid generation:  0.007226467132568359
local_in_edges_tensor generation:  0.012386560440063477
mini_batch_src_global generation:  0.07057452201843262
r_  generation:  1.0417509078979492
local_output_nid generation:  0.00722813606262207
local_in_edges_tensor generation:  0.010629653930664062
mini_batch_src_global generation:  0.07237720489501953
r_  generation:  1.0495755672454834
local_output_nid generation:  0.007180690765380859
local_in_edges_tensor generation:  0.014889240264892578
mini_batch_src_global generation:  0.0740194320678711
r_  generation:  1.0560555458068848
----------------------check_connections_block total spend ----------------------------- 9.930158138275146
generate_one_block  1.4022653102874756
generate_one_block  1.0235791206359863
generate_one_block  1.0213568210601807
generate_one_block  1.0241308212280273
generate_one_block  1.0140721797943115
generate_one_block  1.0395779609680176
generate_one_block  1.0198113918304443
generate_one_block  1.014115571975708
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1461386680603027
gen group dst list time:  0.1855776309967041
time for parepare:  0.44222283363342285
local_output_nid generation:  0.1689770221710205
local_in_edges_tensor generation:  0.7566440105438232
mini_batch_src_global generation:  0.806323766708374
r_  generation:  9.680658340454102
local_output_nid generation:  0.27969813346862793
local_in_edges_tensor generation:  0.795922040939331
mini_batch_src_global generation:  1.1392815113067627
r_  generation:  9.738784551620483
local_output_nid generation:  0.30168938636779785
local_in_edges_tensor generation:  0.650503396987915
mini_batch_src_global generation:  0.9717874526977539
r_  generation:  10.242333889007568
local_output_nid generation:  0.28092241287231445
local_in_edges_tensor generation:  0.8121974468231201
mini_batch_src_global generation:  0.9729886054992676
r_  generation:  9.93427848815918
local_output_nid generation:  0.2698824405670166
local_in_edges_tensor generation:  0.6482157707214355
mini_batch_src_global generation:  1.1110916137695312
r_  generation:  10.180992364883423
local_output_nid generation:  0.28810691833496094
local_in_edges_tensor generation:  0.8006772994995117
mini_batch_src_global generation:  0.9951484203338623
r_  generation:  10.187233209609985
local_output_nid generation:  0.2785003185272217
local_in_edges_tensor generation:  0.6496400833129883
mini_batch_src_global generation:  1.0836181640625
r_  generation:  10.192995548248291
local_output_nid generation:  0.2922220230102539
local_in_edges_tensor generation:  0.7895338535308838
mini_batch_src_global generation:  0.9917678833007812
r_  generation:  10.25530743598938
----------------------check_connections_block total spend ----------------------------- 110.82891345024109
generate_one_block  13.939880609512329
generate_one_block  13.781431198120117
generate_one_block  13.679524183273315
generate_one_block  13.38334059715271
generate_one_block  13.94341778755188
generate_one_block  13.508779525756836
generate_one_block  13.76092267036438
generate_one_block  13.350605010986328
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.081099510192871
gen group dst list time:  0.6057009696960449
time for parepare:  0.4562337398529053
local_output_nid generation:  0.48692846298217773
local_in_edges_tensor generation:  1.205366849899292
mini_batch_src_global generation:  1.2122032642364502
r_  generation:  16.04207444190979
local_output_nid generation:  0.6348311901092529
local_in_edges_tensor generation:  1.3180537223815918
mini_batch_src_global generation:  1.5272822380065918
r_  generation:  16.72286295890808
local_output_nid generation:  0.658332347869873
local_in_edges_tensor generation:  1.2705504894256592
mini_batch_src_global generation:  1.503763198852539
r_  generation:  16.59856128692627
local_output_nid generation:  0.6451282501220703
local_in_edges_tensor generation:  1.2983527183532715
mini_batch_src_global generation:  1.6110141277313232
r_  generation:  16.32557773590088
local_output_nid generation:  0.6738908290863037
local_in_edges_tensor generation:  1.1734447479248047
mini_batch_src_global generation:  1.6593232154846191
r_  generation:  16.348820447921753
local_output_nid generation:  0.6745474338531494
local_in_edges_tensor generation:  1.3152801990509033
mini_batch_src_global generation:  1.7289597988128662
r_  generation:  16.3934428691864
local_output_nid generation:  0.7043211460113525
local_in_edges_tensor generation:  1.3152940273284912
mini_batch_src_global generation:  1.7171759605407715
r_  generation:  16.946903705596924
local_output_nid generation:  0.7064714431762695
local_in_edges_tensor generation:  1.3226923942565918
mini_batch_src_global generation:  1.5989768505096436
r_  generation:  16.614872694015503
----------------------check_connections_block total spend ----------------------------- 183.5742998123169
generate_one_block  21.86248469352722
generate_one_block  21.850061893463135
generate_one_block  21.988091707229614
generate_one_block  22.530540704727173
generate_one_block  21.79717707633972
generate_one_block  21.897569179534912
generate_one_block  21.86585545539856
generate_one_block  21.95934748649597
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 2.290073871612549  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

connection checking time:  294.403213262558
block generation total time  285.0990297794342
average batch blocks generation time:  35.637378722429276
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3071918487548828  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4220519065856934  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3063263893127441  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4192328453063965  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3090400695800781  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.428356647491455  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3056349754333496  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.416952610015869  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 1.3057355880737305  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3778076171875 GB
    Memory Allocated: 3.4166364669799805  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2059326171875 GB
    Memory Allocated: 1.312638282775879  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2059326171875 GB
    Memory Allocated: 3.4334588050842285  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2059326171875 GB
    Memory Allocated: 1.312455177307129  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2059326171875 GB
    Memory Allocated: 3.432847499847412  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2059326171875 GB
    Memory Allocated: 1.3102679252624512  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.430180549621582  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38009536266326904 |0.42633455991744995 |0.006325125694274902 |0.0001424252986907959 |0.023496508598327637 |0.0013043880462646484 |
----------------------------------------------------------pseudo_mini_loss sum 3.7149224281311035
Total (block generation + training)time/epoch 630.3386461734772
Training time/epoch 1648011618.5221844
Training time without block to device /epoch 1648011615.111508
Training time without total dataloading part /epoch 0.24101686477661133
load block tensor time/epoch 3.0407629013061523
block to device time/epoch 3.4106764793395996
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  39025441
Number of first layer input nodes during this epoch:  17720703
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 2.2960009574890137  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4906888008117676
range selection method range initialization spend 0.026279449462890625
time for parepare:  0.3539419174194336
local_output_nid generation:  0.006995677947998047
local_in_edges_tensor generation:  0.038446903228759766
mini_batch_src_global generation:  0.05427837371826172
r_  generation:  0.8118488788604736
local_output_nid generation:  0.007563591003417969
local_in_edges_tensor generation:  0.01960897445678711
mini_batch_src_global generation:  0.07023286819458008
r_  generation:  0.8717913627624512
local_output_nid generation:  0.007283687591552734
local_in_edges_tensor generation:  0.01454925537109375
mini_batch_src_global generation:  0.0508120059967041
r_  generation:  0.9012537002563477
local_output_nid generation:  0.0074481964111328125
local_in_edges_tensor generation:  0.014648914337158203
mini_batch_src_global generation:  0.05845212936401367
r_  generation:  0.9934542179107666
local_output_nid generation:  0.007417440414428711
local_in_edges_tensor generation:  0.019080638885498047
mini_batch_src_global generation:  0.06548738479614258
r_  generation:  1.056276559829712
local_output_nid generation:  0.007569074630737305
local_in_edges_tensor generation:  0.014321327209472656
mini_batch_src_global generation:  0.07394981384277344
r_  generation:  1.1199281215667725
local_output_nid generation:  0.007561206817626953
local_in_edges_tensor generation:  0.014350652694702148
mini_batch_src_global generation:  0.07706379890441895
r_  generation:  1.094102144241333
local_output_nid generation:  0.007745265960693359
local_in_edges_tensor generation:  0.01480722427368164
mini_batch_src_global generation:  0.07333660125732422
r_  generation:  1.0705242156982422
----------------------check_connections_block total spend ----------------------------- 10.244277954101562
generate_one_block  1.4119274616241455
generate_one_block  1.0402138233184814
generate_one_block  1.030107021331787
generate_one_block  1.0438623428344727
generate_one_block  1.0485155582427979
generate_one_block  1.0733869075775146
generate_one_block  1.1411681175231934
generate_one_block  1.3372607231140137
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2751898765563965
gen group dst list time:  0.19433331489562988
time for parepare:  0.44629526138305664
local_output_nid generation:  0.15482306480407715
local_in_edges_tensor generation:  0.6223421096801758
mini_batch_src_global generation:  0.7685515880584717
r_  generation:  9.837368965148926
local_output_nid generation:  0.24700570106506348
local_in_edges_tensor generation:  0.7873761653900146
mini_batch_src_global generation:  1.0128154754638672
r_  generation:  10.145895957946777
local_output_nid generation:  0.265674352645874
local_in_edges_tensor generation:  0.7152271270751953
mini_batch_src_global generation:  0.9588437080383301
r_  generation:  10.015181064605713
local_output_nid generation:  0.24980974197387695
local_in_edges_tensor generation:  0.7479712963104248
mini_batch_src_global generation:  1.0566112995147705
r_  generation:  9.991701126098633
local_output_nid generation:  0.27115893363952637
local_in_edges_tensor generation:  0.6929893493652344
mini_batch_src_global generation:  0.9878056049346924
r_  generation:  10.28750205039978
local_output_nid generation:  0.26056957244873047
local_in_edges_tensor generation:  0.8019134998321533
mini_batch_src_global generation:  1.1101100444793701
r_  generation:  10.081586122512817
local_output_nid generation:  0.2830677032470703
local_in_edges_tensor generation:  0.6830415725708008
mini_batch_src_global generation:  1.0382189750671387
r_  generation:  10.263375043869019
local_output_nid generation:  0.26033544540405273
local_in_edges_tensor generation:  0.8093206882476807
mini_batch_src_global generation:  1.0923726558685303
r_  generation:  10.018860340118408
----------------------check_connections_block total spend ----------------------------- 110.81430649757385
generate_one_block  13.975020170211792
generate_one_block  13.769310712814331
generate_one_block  13.387372732162476
generate_one_block  13.714467525482178
generate_one_block  13.737679958343506
generate_one_block  13.715150356292725
generate_one_block  13.442520141601562
generate_one_block  13.691161155700684
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1573195457458496
gen group dst list time:  0.5852963924407959
time for parepare:  0.4744727611541748
local_output_nid generation:  0.4919102191925049
local_in_edges_tensor generation:  1.1968069076538086
mini_batch_src_global generation:  1.1767003536224365
r_  generation:  16.18502402305603
local_output_nid generation:  0.6529989242553711
local_in_edges_tensor generation:  1.3427317142486572
mini_batch_src_global generation:  1.520461082458496
r_  generation:  16.534557104110718
local_output_nid generation:  0.6489124298095703
local_in_edges_tensor generation:  1.2890822887420654
mini_batch_src_global generation:  1.5009965896606445
r_  generation:  16.325106620788574
local_output_nid generation:  0.6490135192871094
local_in_edges_tensor generation:  1.2224960327148438
mini_batch_src_global generation:  1.7049334049224854
r_  generation:  16.372884035110474
local_output_nid generation:  0.6904349327087402
local_in_edges_tensor generation:  1.3107130527496338
mini_batch_src_global generation:  1.61564302444458
r_  generation:  16.6340594291687
local_output_nid generation:  0.7024338245391846
local_in_edges_tensor generation:  1.2405667304992676
mini_batch_src_global generation:  1.6071085929870605
r_  generation:  16.64115810394287
local_output_nid generation:  0.6842136383056641
local_in_edges_tensor generation:  1.3088178634643555
mini_batch_src_global generation:  1.5299434661865234
r_  generation:  16.787960290908813
local_output_nid generation:  0.6859781742095947
local_in_edges_tensor generation:  1.3530399799346924
mini_batch_src_global generation:  1.5868251323699951
r_  generation:  16.475286722183228
----------------------check_connections_block total spend ----------------------------- 183.29199624061584
generate_one_block  22.1385178565979
generate_one_block  22.00646138191223
generate_one_block  21.666781663894653
generate_one_block  22.5676486492157
generate_one_block  21.90890622138977
generate_one_block  21.948429107666016
generate_one_block  22.001776695251465
generate_one_block  21.978658437728882
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 2.2960009574890137  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

connection checking time:  294.1063027381897
block generation total time  285.64986276626587
average batch blocks generation time:  35.706232845783234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.30576753616333  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4178481101989746  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3127532005310059  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4351983070373535  GigaBytes
Max Memory Allocated: 3.979005813598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3078861236572266  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.425262451171875  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3102521896362305  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.429780960083008  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3067784309387207  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4210619926452637  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3078432083129883  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.424112319946289  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.313164234161377  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.434384822845459  GigaBytes
Max Memory Allocated: 3.9804325103759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.307814121246338  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4211888313293457  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38769060373306274 |0.5521560311317444 |0.003876328468322754 |0.00014269351959228516 |0.023597806692123413 |0.002614259719848633 |
----------------------------------------------------------pseudo_mini_loss sum 3.109611988067627
Total (block generation + training)time/epoch 631.530641913414
Training time/epoch 1648012251.245278
Training time without block to device /epoch 1648012246.8280296
Training time without total dataloading part /epoch 0.22354888916015625
load block tensor time/epoch 3.101524829864502
block to device time/epoch 4.417248249053955
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  39034573
Number of first layer input nodes during this epoch:  17724069
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 2.290538787841797  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6462609767913818
range selection method range initialization spend 0.03225564956665039
time for parepare:  0.36786794662475586
local_output_nid generation:  0.006963968276977539
local_in_edges_tensor generation:  0.04250359535217285
mini_batch_src_global generation:  0.05628156661987305
r_  generation:  0.8269081115722656
local_output_nid generation:  0.007295846939086914
local_in_edges_tensor generation:  0.017220497131347656
mini_batch_src_global generation:  0.07749414443969727
r_  generation:  0.902116060256958
local_output_nid generation:  0.0071027278900146484
local_in_edges_tensor generation:  0.012775659561157227
mini_batch_src_global generation:  0.04927349090576172
r_  generation:  0.9239771366119385
local_output_nid generation:  0.007586479187011719
local_in_edges_tensor generation:  0.012589454650878906
mini_batch_src_global generation:  0.05704689025878906
r_  generation:  0.9686484336853027
local_output_nid generation:  0.00751185417175293
local_in_edges_tensor generation:  0.013103485107421875
mini_batch_src_global generation:  0.0641331672668457
r_  generation:  1.008730173110962
local_output_nid generation:  0.00745391845703125
local_in_edges_tensor generation:  0.013041019439697266
mini_batch_src_global generation:  0.07003450393676758
r_  generation:  1.0487127304077148
local_output_nid generation:  0.007464170455932617
local_in_edges_tensor generation:  0.012547016143798828
mini_batch_src_global generation:  0.07234311103820801
r_  generation:  1.0766336917877197
local_output_nid generation:  0.007526397705078125
local_in_edges_tensor generation:  0.016843795776367188
mini_batch_src_global generation:  0.07610893249511719
r_  generation:  1.065006971359253
----------------------check_connections_block total spend ----------------------------- 10.143419027328491
generate_one_block  1.4316251277923584
generate_one_block  1.0584535598754883
generate_one_block  1.021918535232544
generate_one_block  1.0460901260375977
generate_one_block  1.2574810981750488
generate_one_block  1.238004207611084
generate_one_block  1.032369613647461
generate_one_block  1.0158393383026123
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.224484920501709
gen group dst list time:  0.19601798057556152
time for parepare:  0.48488473892211914
local_output_nid generation:  0.16621637344360352
local_in_edges_tensor generation:  0.6409893035888672
mini_batch_src_global generation:  0.7834978103637695
r_  generation:  9.902100563049316
local_output_nid generation:  0.24583649635314941
local_in_edges_tensor generation:  0.8571908473968506
mini_batch_src_global generation:  1.1011505126953125
r_  generation:  9.6975679397583
local_output_nid generation:  0.26682043075561523
local_in_edges_tensor generation:  0.6346800327301025
mini_batch_src_global generation:  0.9671692848205566
r_  generation:  10.191481828689575
local_output_nid generation:  0.26837825775146484
local_in_edges_tensor generation:  0.7661576271057129
mini_batch_src_global generation:  0.9797637462615967
r_  generation:  9.97391653060913
local_output_nid generation:  0.26506638526916504
local_in_edges_tensor generation:  0.646345853805542
mini_batch_src_global generation:  1.0329813957214355
r_  generation:  10.338580131530762
local_output_nid generation:  0.27751874923706055
local_in_edges_tensor generation:  0.7770464420318604
mini_batch_src_global generation:  0.9976301193237305
r_  generation:  10.14039134979248
local_output_nid generation:  0.2716667652130127
local_in_edges_tensor generation:  0.6654214859008789
mini_batch_src_global generation:  1.2279949188232422
r_  generation:  10.595486640930176
local_output_nid generation:  0.2933928966522217
local_in_edges_tensor generation:  0.8213479518890381
mini_batch_src_global generation:  1.0981559753417969
r_  generation:  10.063073635101318
----------------------check_connections_block total spend ----------------------------- 111.58371543884277
generate_one_block  13.901831865310669
generate_one_block  13.73592472076416
generate_one_block  13.252768516540527
generate_one_block  13.877548456192017
generate_one_block  13.853254556655884
generate_one_block  13.56277585029602
generate_one_block  13.713679552078247
generate_one_block  13.44567608833313
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1357011795043945
gen group dst list time:  0.5674633979797363
time for parepare:  0.46465492248535156
local_output_nid generation:  0.482698917388916
local_in_edges_tensor generation:  1.1929502487182617
mini_batch_src_global generation:  1.3332374095916748
r_  generation:  16.50040864944458
local_output_nid generation:  0.6525671482086182
local_in_edges_tensor generation:  1.3988873958587646
mini_batch_src_global generation:  1.5663957595825195
r_  generation:  16.400386810302734
local_output_nid generation:  0.6679208278656006
local_in_edges_tensor generation:  1.3047757148742676
mini_batch_src_global generation:  1.5444133281707764
r_  generation:  16.410382986068726
local_output_nid generation:  0.661480188369751
local_in_edges_tensor generation:  1.2366340160369873
mini_batch_src_global generation:  1.8688158988952637
r_  generation:  16.809312105178833
local_output_nid generation:  0.7007701396942139
local_in_edges_tensor generation:  1.3089406490325928
mini_batch_src_global generation:  1.5390291213989258
r_  generation:  16.884488105773926
local_output_nid generation:  0.7006933689117432
local_in_edges_tensor generation:  1.3011951446533203
mini_batch_src_global generation:  1.5483620166778564
r_  generation:  16.7460355758667
local_output_nid generation:  0.7067630290985107
local_in_edges_tensor generation:  1.3238375186920166
mini_batch_src_global generation:  1.564601182937622
r_  generation:  16.653093338012695
local_output_nid generation:  0.6898901462554932
local_in_edges_tensor generation:  1.250269889831543
mini_batch_src_global generation:  1.7609326839447021
r_  generation:  16.406237840652466
----------------------check_connections_block total spend ----------------------------- 184.8870759010315
generate_one_block  21.890681505203247
generate_one_block  21.931592226028442
generate_one_block  21.740949392318726
generate_one_block  22.501471757888794
generate_one_block  21.740984678268433
generate_one_block  21.809123754501343
generate_one_block  21.77763819694519
generate_one_block  21.737452268600464
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 2.290538787841797  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

connection checking time:  296.47079133987427
block generation total time  284.4733533859253
average batch blocks generation time:  35.55916917324066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3087959289550781  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4239230155944824  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3079628944396973  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4190011024475098  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3106837272644043  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.429311752319336  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3104867935180664  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4267945289611816  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3102149963378906  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4290356636047363  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.310251235961914  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.430108070373535  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3124656677246094  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4350266456604004  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3057680130004883  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.416196823120117  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39047911763191223 |0.42346081137657166 |0.0037774741649627686 |0.0001411139965057373 |0.00577092170715332 |0.0026547908782958984 |
----------------------------------------------------------pseudo_mini_loss sum 2.6833174228668213
Total (block generation + training)time/epoch 632.0030515193939
Training time/epoch 1648012884.1934013
Training time without block to device /epoch 1648012880.8057148
Training time without total dataloading part /epoch 0.08017086982727051
load block tensor time/epoch 3.123832941055298
block to device time/epoch 3.3876864910125732
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  39025453
Number of first layer input nodes during this epoch:  17720623
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 2.286442279815674  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6446433067321777
range selection method range initialization spend 0.026098966598510742
time for parepare:  0.3359048366546631
local_output_nid generation:  0.006842851638793945
local_in_edges_tensor generation:  0.03618001937866211
mini_batch_src_global generation:  0.05408883094787598
r_  generation:  0.771143913269043
local_output_nid generation:  0.007452487945556641
local_in_edges_tensor generation:  0.018563508987426758
mini_batch_src_global generation:  0.07028436660766602
r_  generation:  0.8506286144256592
local_output_nid generation:  0.0072438716888427734
local_in_edges_tensor generation:  0.016401290893554688
mini_batch_src_global generation:  0.04883217811584473
r_  generation:  0.8769965171813965
local_output_nid generation:  0.0072574615478515625
local_in_edges_tensor generation:  0.014775753021240234
mini_batch_src_global generation:  0.05684471130371094
r_  generation:  0.9450585842132568
local_output_nid generation:  0.007495880126953125
local_in_edges_tensor generation:  0.014361143112182617
mini_batch_src_global generation:  0.06590461730957031
r_  generation:  0.9869964122772217
local_output_nid generation:  0.007231950759887695
local_in_edges_tensor generation:  0.014121532440185547
mini_batch_src_global generation:  0.07014608383178711
r_  generation:  1.0243134498596191
local_output_nid generation:  0.007231473922729492
local_in_edges_tensor generation:  0.014268875122070312
mini_batch_src_global generation:  0.07154726982116699
r_  generation:  1.0361239910125732
local_output_nid generation:  0.007167339324951172
local_in_edges_tensor generation:  0.012423515319824219
mini_batch_src_global generation:  0.07352161407470703
r_  generation:  1.0370867252349854
----------------------check_connections_block total spend ----------------------------- 9.773565769195557
generate_one_block  1.3675529956817627
generate_one_block  1.003950595855713
generate_one_block  1.0088021755218506
generate_one_block  1.0043857097625732
generate_one_block  1.0111463069915771
generate_one_block  1.0275464057922363
generate_one_block  1.0050289630889893
generate_one_block  1.0042667388916016
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.084299325942993
gen group dst list time:  0.17803049087524414
time for parepare:  0.42399024963378906
local_output_nid generation:  0.15540242195129395
local_in_edges_tensor generation:  0.6038265228271484
mini_batch_src_global generation:  0.7795803546905518
r_  generation:  9.709911346435547
local_output_nid generation:  0.2607998847961426
local_in_edges_tensor generation:  0.7318780422210693
mini_batch_src_global generation:  1.0059330463409424
r_  generation:  10.03621530532837
local_output_nid generation:  0.2667067050933838
local_in_edges_tensor generation:  0.8661696910858154
mini_batch_src_global generation:  1.0656721591949463
r_  generation:  10.810765504837036
local_output_nid generation:  0.28493618965148926
local_in_edges_tensor generation:  0.8329041004180908
mini_batch_src_global generation:  1.477325677871704
r_  generation:  9.968901634216309
local_output_nid generation:  0.2759582996368408
local_in_edges_tensor generation:  0.7177472114562988
mini_batch_src_global generation:  0.9927101135253906
r_  generation:  10.303119421005249
local_output_nid generation:  0.2761232852935791
local_in_edges_tensor generation:  0.8108642101287842
mini_batch_src_global generation:  1.0541608333587646
r_  generation:  10.08621335029602
local_output_nid generation:  0.2860908508300781
local_in_edges_tensor generation:  0.6656894683837891
mini_batch_src_global generation:  1.0417149066925049
r_  generation:  10.34107232093811
local_output_nid generation:  0.26758837699890137
local_in_edges_tensor generation:  0.8309037685394287
mini_batch_src_global generation:  1.0403497219085693
r_  generation:  10.049348592758179
----------------------check_connections_block total spend ----------------------------- 112.68715262413025
generate_one_block  14.049383878707886
generate_one_block  13.641451597213745
generate_one_block  13.404625177383423
generate_one_block  13.861775398254395
generate_one_block  13.618402481079102
generate_one_block  13.92639708518982
generate_one_block  13.665133953094482
generate_one_block  13.59034252166748
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.148719072341919
gen group dst list time:  0.5592386722564697
time for parepare:  0.4415097236633301
local_output_nid generation:  0.4724910259246826
local_in_edges_tensor generation:  1.1542549133300781
mini_batch_src_global generation:  1.1633973121643066
r_  generation:  15.830597877502441
local_output_nid generation:  0.6075775623321533
local_in_edges_tensor generation:  1.2888846397399902
mini_batch_src_global generation:  1.8063039779663086
r_  generation:  17.532174348831177
local_output_nid generation:  0.6831755638122559
local_in_edges_tensor generation:  1.491325855255127
mini_batch_src_global generation:  1.6182324886322021
r_  generation:  17.0545973777771
local_output_nid generation:  0.6797971725463867
local_in_edges_tensor generation:  1.2956123352050781
mini_batch_src_global generation:  1.574061632156372
r_  generation:  16.633422374725342
local_output_nid generation:  0.680473804473877
local_in_edges_tensor generation:  1.3185844421386719
mini_batch_src_global generation:  1.5951952934265137
r_  generation:  16.545349836349487
local_output_nid generation:  0.6851935386657715
local_in_edges_tensor generation:  1.3111400604248047
mini_batch_src_global generation:  1.7001798152923584
r_  generation:  16.482046127319336
local_output_nid generation:  0.6920044422149658
local_in_edges_tensor generation:  1.2436327934265137
mini_batch_src_global generation:  1.6880598068237305
r_  generation:  16.782411098480225
local_output_nid generation:  0.7239501476287842
local_in_edges_tensor generation:  1.3208842277526855
mini_batch_src_global generation:  1.5998764038085938
r_  generation:  16.488829135894775
----------------------check_connections_block total spend ----------------------------- 185.8947548866272
generate_one_block  21.932636260986328
generate_one_block  21.91508460044861
generate_one_block  21.793418645858765
generate_one_block  22.614776611328125
generate_one_block  21.681788682937622
generate_one_block  21.792018175125122
generate_one_block  22.05376672744751
generate_one_block  22.201966762542725
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 2.286442279815674  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

connection checking time:  298.58190751075745
block generation total time  285.74296855926514
average batch blocks generation time:  35.71787106990814
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3079733848571777  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4246697425842285  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3055195808410645  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4156813621520996  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3091130256652832  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.428041458129883  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.309783935546875  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes
Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.427919387817383  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3107991218566895  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4293971061706543  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3063368797302246  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.421827793121338  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.3111095428466797  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4321250915527344  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 1.308558464050293  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2078857421875 GB
    Memory Allocated: 3.4261326789855957  GigaBytes
Max Memory Allocated: 3.980832576751709  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39125606417655945 |0.4945583939552307 |0.004083544015884399 |0.00014472007751464844 |0.005833685398101807 |0.002624988555908203 |
----------------------------------------------------------pseudo_mini_loss sum 2.3928990364074707
Total (block generation + training)time/epoch 632.8741955757141
Training time/epoch 1648013519.6813586
Training time without block to device /epoch 1648013515.7248914
Training time without total dataloading part /epoch 0.08312058448791504
load block tensor time/epoch 3.1300485134124756
block to device time/epoch 3.9564671516418457
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  39027519
Number of first layer input nodes during this epoch:  17722099
