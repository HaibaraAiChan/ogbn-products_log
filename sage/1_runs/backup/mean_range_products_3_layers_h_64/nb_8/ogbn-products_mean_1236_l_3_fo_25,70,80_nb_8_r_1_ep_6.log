main start at this time 1648064328.691854
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7943005561828613
range selection method range initialization spend 0.028996944427490234
time for parepare:  0.37706708908081055
local_output_nid generation:  0.0068569183349609375
local_in_edges_tensor generation:  0.04813694953918457
mini_batch_src_global generation:  0.052991628646850586
r_  generation:  0.8050007820129395
local_output_nid generation:  0.007092714309692383
local_in_edges_tensor generation:  0.02330493927001953
mini_batch_src_global generation:  0.06447601318359375
r_  generation:  0.8521714210510254
local_output_nid generation:  0.007086038589477539
local_in_edges_tensor generation:  0.014426469802856445
mini_batch_src_global generation:  0.04814743995666504
r_  generation:  0.89815354347229
local_output_nid generation:  0.007100820541381836
local_in_edges_tensor generation:  0.0175931453704834
mini_batch_src_global generation:  0.05612778663635254
r_  generation:  0.9729185104370117
local_output_nid generation:  0.007007598876953125
local_in_edges_tensor generation:  0.011186838150024414
mini_batch_src_global generation:  0.06212782859802246
r_  generation:  1.007138967514038
local_output_nid generation:  0.006960153579711914
local_in_edges_tensor generation:  0.014900684356689453
mini_batch_src_global generation:  0.06881117820739746
r_  generation:  1.042323112487793
local_output_nid generation:  0.0070302486419677734
local_in_edges_tensor generation:  0.01999640464782715
mini_batch_src_global generation:  0.0702354907989502
r_  generation:  1.070852518081665
local_output_nid generation:  0.006982564926147461
local_in_edges_tensor generation:  0.010358333587646484
mini_batch_src_global generation:  0.07195711135864258
r_  generation:  1.0624024868011475
----------------------check_connections_block total spend ----------------------------- 9.94087839126587
generate_one_block  6.204369783401489
generate_one_block  1.0085139274597168
generate_one_block  1.049210786819458
generate_one_block  1.0096640586853027
generate_one_block  1.0178475379943848
generate_one_block  1.0017664432525635
generate_one_block  1.0070624351501465
generate_one_block  1.0004305839538574
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.834998846054077
gen group dst list time:  0.17497897148132324
time for parepare:  0.4440577030181885
local_output_nid generation:  0.14865660667419434
local_in_edges_tensor generation:  0.8992705345153809
mini_batch_src_global generation:  1.244765043258667
r_  generation:  15.011668682098389
local_output_nid generation:  0.20839691162109375
local_in_edges_tensor generation:  0.9043688774108887
mini_batch_src_global generation:  1.5909490585327148
r_  generation:  15.059401988983154
local_output_nid generation:  0.22937607765197754
local_in_edges_tensor generation:  1.4625897407531738
mini_batch_src_global generation:  1.5970377922058105
r_  generation:  15.615497589111328
local_output_nid generation:  0.2646327018737793
local_in_edges_tensor generation:  0.9232652187347412
mini_batch_src_global generation:  1.6718835830688477
r_  generation:  15.719206809997559
local_output_nid generation:  0.27820706367492676
local_in_edges_tensor generation:  1.1341798305511475
mini_batch_src_global generation:  1.7611582279205322
r_  generation:  15.907970428466797
local_output_nid generation:  0.28204846382141113
local_in_edges_tensor generation:  1.1444909572601318
mini_batch_src_global generation:  1.6007411479949951
r_  generation:  16.01279067993164
local_output_nid generation:  0.2552330493927002
local_in_edges_tensor generation:  0.9622802734375
mini_batch_src_global generation:  1.658402919769287
r_  generation:  15.885462522506714
local_output_nid generation:  0.2905294895172119
local_in_edges_tensor generation:  1.1645464897155762
mini_batch_src_global generation:  1.7204349040985107
r_  generation:  15.756229400634766
----------------------check_connections_block total spend ----------------------------- 169.55901455879211
generate_one_block  21.602097272872925
generate_one_block  21.62100625038147
generate_one_block  22.26687216758728
generate_one_block  21.607943296432495
generate_one_block  21.654136419296265
generate_one_block  21.612953186035156
generate_one_block  21.542250394821167
generate_one_block  21.550859689712524
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.129159450531006
gen group dst list time:  0.5972559452056885
time for parepare:  0.5089714527130127
local_output_nid generation:  0.51894211769104
local_in_edges_tensor generation:  1.3340907096862793
mini_batch_src_global generation:  1.244037389755249
r_  generation:  16.905131578445435
local_output_nid generation:  0.6709244251251221
local_in_edges_tensor generation:  1.3616447448730469
mini_batch_src_global generation:  1.6633715629577637
r_  generation:  16.87425446510315
local_output_nid generation:  0.6707851886749268
local_in_edges_tensor generation:  1.5011141300201416
mini_batch_src_global generation:  1.5709376335144043
r_  generation:  17.15270233154297
local_output_nid generation:  0.6978154182434082
local_in_edges_tensor generation:  1.3372046947479248
mini_batch_src_global generation:  1.6374549865722656
r_  generation:  16.984093189239502
local_output_nid generation:  0.6913487911224365
local_in_edges_tensor generation:  1.2940146923065186
mini_batch_src_global generation:  1.7053594589233398
r_  generation:  17.33060622215271
local_output_nid generation:  0.6926937103271484
local_in_edges_tensor generation:  1.4023261070251465
mini_batch_src_global generation:  1.6936290264129639
r_  generation:  17.147188186645508
local_output_nid generation:  0.6908400058746338
local_in_edges_tensor generation:  1.2526493072509766
mini_batch_src_global generation:  1.7320997714996338
r_  generation:  17.35805583000183
local_output_nid generation:  0.7166836261749268
local_in_edges_tensor generation:  1.3590505123138428
mini_batch_src_global generation:  1.7664949893951416
r_  generation:  17.096253156661987
----------------------check_connections_block total spend ----------------------------- 191.37061643600464
generate_one_block  22.532419204711914
generate_one_block  23.37254309654236
generate_one_block  22.379689931869507
generate_one_block  22.32429075241089
generate_one_block  22.18076229095459
generate_one_block  22.272777557373047
generate_one_block  22.240771770477295
generate_one_block  22.251210927963257
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  360.92963099479675
block generation total time  353.01258420944214
average batch blocks generation time:  44.12657302618027
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5496826171875 GB
    Memory Allocated: 1.4493169784545898  GigaBytes
Max Memory Allocated: 1.4493169784545898  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6336669921875 GB
    Memory Allocated: 3.773210048675537  GigaBytes
Max Memory Allocated: 4.091207504272461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4422607421875 GB
    Memory Allocated: 1.4534177780151367  GigaBytes
Max Memory Allocated: 4.617429733276367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4422607421875 GB
    Memory Allocated: 3.7695069313049316  GigaBytes
Max Memory Allocated: 4.617429733276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9227294921875 GB
    Memory Allocated: 1.4554367065429688  GigaBytes
Max Memory Allocated: 4.617429733276367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9227294921875 GB
    Memory Allocated: 3.773824691772461  GigaBytes
Max Memory Allocated: 4.617429733276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9227294921875 GB
    Memory Allocated: 1.4544329643249512  GigaBytes
Max Memory Allocated: 4.617915153503418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9227294921875 GB
    Memory Allocated: 3.7705307006835938  GigaBytes
Max Memory Allocated: 4.617915153503418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9246826171875 GB
    Memory Allocated: 1.4557313919067383  GigaBytes
Max Memory Allocated: 4.617915153503418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.776977062225342  GigaBytes
Max Memory Allocated: 4.617915153503418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4549412727355957  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.773355484008789  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4540619850158691  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.769526958465576  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.452237606048584  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.762605667114258  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36841443181037903 |0.8633604049682617 |0.09532752633094788 |0.00015589594841003418 |0.08173304796218872 |0.0017046928405761719 |
----------------------------------------------------------pseudo_mini_loss sum 8.735483169555664
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  40321139
Number of first layer input nodes during this epoch:  18016520
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 2.699488639831543  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.729219913482666
range selection method range initialization spend 0.026984214782714844
time for parepare:  0.3733839988708496
local_output_nid generation:  0.0066525936126708984
local_in_edges_tensor generation:  0.04544425010681152
mini_batch_src_global generation:  0.05772542953491211
r_  generation:  0.8185255527496338
local_output_nid generation:  0.007294416427612305
local_in_edges_tensor generation:  0.025923967361450195
mini_batch_src_global generation:  0.07454323768615723
r_  generation:  0.9046099185943604
local_output_nid generation:  0.007142782211303711
local_in_edges_tensor generation:  0.016036033630371094
mini_batch_src_global generation:  0.05544853210449219
r_  generation:  0.9644715785980225
local_output_nid generation:  0.0074460506439208984
local_in_edges_tensor generation:  0.02227020263671875
mini_batch_src_global generation:  0.08048009872436523
r_  generation:  1.0543508529663086
local_output_nid generation:  0.007490634918212891
local_in_edges_tensor generation:  0.030190467834472656
mini_batch_src_global generation:  0.06766533851623535
r_  generation:  1.0613701343536377
local_output_nid generation:  0.007627725601196289
local_in_edges_tensor generation:  0.030109167098999023
mini_batch_src_global generation:  0.06914520263671875
r_  generation:  1.0829126834869385
local_output_nid generation:  0.007703065872192383
local_in_edges_tensor generation:  0.025357961654663086
mini_batch_src_global generation:  0.07151174545288086
r_  generation:  1.1210973262786865
local_output_nid generation:  0.0076825618743896484
local_in_edges_tensor generation:  0.03748893737792969
mini_batch_src_global generation:  0.07785272598266602
r_  generation:  1.1375329494476318
----------------------check_connections_block total spend ----------------------------- 10.62958836555481
generate_one_block  1.4389944076538086
generate_one_block  1.0413539409637451
generate_one_block  1.0245013236999512
generate_one_block  1.0375385284423828
generate_one_block  1.064359188079834
generate_one_block  1.0709290504455566
generate_one_block  1.0372650623321533
generate_one_block  1.0453505516052246
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.550185203552246
gen group dst list time:  0.19519686698913574
time for parepare:  0.4693734645843506
local_output_nid generation:  0.14926719665527344
local_in_edges_tensor generation:  0.9249942302703857
mini_batch_src_global generation:  1.2497174739837646
r_  generation:  15.224039793014526
local_output_nid generation:  0.2520713806152344
local_in_edges_tensor generation:  1.0472805500030518
mini_batch_src_global generation:  1.629847526550293
r_  generation:  15.47830867767334
local_output_nid generation:  0.26104116439819336
local_in_edges_tensor generation:  1.1006746292114258
mini_batch_src_global generation:  1.630037546157837
r_  generation:  15.631062030792236
local_output_nid generation:  0.2724466323852539
local_in_edges_tensor generation:  1.1025562286376953
mini_batch_src_global generation:  1.6000924110412598
r_  generation:  15.75425672531128
local_output_nid generation:  0.2738206386566162
local_in_edges_tensor generation:  1.128035306930542
mini_batch_src_global generation:  1.6089918613433838
r_  generation:  15.837160348892212
local_output_nid generation:  0.2544841766357422
local_in_edges_tensor generation:  1.1232802867889404
mini_batch_src_global generation:  1.7438502311706543
r_  generation:  15.809551000595093
local_output_nid generation:  0.28070855140686035
local_in_edges_tensor generation:  1.1477797031402588
mini_batch_src_global generation:  1.6869184970855713
r_  generation:  15.814028263092041
local_output_nid generation:  0.2750875949859619
local_in_edges_tensor generation:  1.1321535110473633
mini_batch_src_global generation:  1.7053000926971436
r_  generation:  15.631879568099976
----------------------check_connections_block total spend ----------------------------- 170.3271985054016
generate_one_block  21.830349922180176
generate_one_block  21.7875337600708
generate_one_block  21.66830539703369
generate_one_block  21.88086223602295
generate_one_block  22.179331064224243
generate_one_block  21.8258159160614
generate_one_block  21.76343297958374
generate_one_block  21.79493737220764
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1667964458465576
gen group dst list time:  0.6112310886383057
time for parepare:  0.4838700294494629
local_output_nid generation:  0.48218417167663574
local_in_edges_tensor generation:  1.1761698722839355
mini_batch_src_global generation:  1.2781968116760254
r_  generation:  17.246631383895874
local_output_nid generation:  0.6559720039367676
local_in_edges_tensor generation:  1.318544626235962
mini_batch_src_global generation:  1.6924386024475098
r_  generation:  16.933478832244873
local_output_nid generation:  0.6888425350189209
local_in_edges_tensor generation:  1.4363584518432617
mini_batch_src_global generation:  1.685729742050171
r_  generation:  17.632965564727783
local_output_nid generation:  0.7014327049255371
local_in_edges_tensor generation:  1.344536542892456
mini_batch_src_global generation:  1.7304422855377197
r_  generation:  17.28668737411499
local_output_nid generation:  0.7094674110412598
local_in_edges_tensor generation:  1.3446846008300781
mini_batch_src_global generation:  1.6784420013427734
r_  generation:  17.57222867012024
local_output_nid generation:  0.7129411697387695
local_in_edges_tensor generation:  1.3653817176818848
mini_batch_src_global generation:  1.6804227828979492
r_  generation:  17.5509135723114
local_output_nid generation:  0.7279775142669678
local_in_edges_tensor generation:  1.3706984519958496
mini_batch_src_global generation:  1.6282827854156494
r_  generation:  17.888472318649292
local_output_nid generation:  0.7105832099914551
local_in_edges_tensor generation:  1.35933256149292
mini_batch_src_global generation:  1.6216330528259277
r_  generation:  17.543448209762573
----------------------check_connections_block total spend ----------------------------- 194.50498461723328
generate_one_block  22.90002989768982
generate_one_block  22.931827068328857
generate_one_block  22.58332395553589
generate_one_block  23.382203578948975
generate_one_block  22.73221755027771
generate_one_block  22.659621000289917
generate_one_block  22.670244216918945
generate_one_block  22.813690185546875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 2.699488639831543  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

connection checking time:  364.8321831226349
block generation total time  357.40372610092163
average batch blocks generation time:  44.675465762615204
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4544110298156738  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7717204093933105  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4558191299438477  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.776533603668213  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.453505516052246  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.763791561126709  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4544134140014648  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.771757125854492  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4558758735656738  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7749361991882324  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4545507431030273  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7744617462158203  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4551191329956055  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7706031799316406  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4537453651428223  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7679457664489746  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4151529371738434 |0.7909223437309265 |0.0063880980014801025 |0.00014123320579528809 |0.005011528730392456 |0.0012581348419189453 |
----------------------------------------------------------pseudo_mini_loss sum 5.083588123321533
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  40324635
Number of first layer input nodes during this epoch:  18018330
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 2.7009973526000977  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7183723449707031
range selection method range initialization spend 0.02902531623840332
time for parepare:  0.38219523429870605
local_output_nid generation:  0.00724029541015625
local_in_edges_tensor generation:  0.04724884033203125
mini_batch_src_global generation:  0.05933046340942383
r_  generation:  0.798992395401001
local_output_nid generation:  0.00732111930847168
local_in_edges_tensor generation:  0.017415285110473633
mini_batch_src_global generation:  0.0689249038696289
r_  generation:  0.8711776733398438
local_output_nid generation:  0.007290363311767578
local_in_edges_tensor generation:  0.01283407211303711
mini_batch_src_global generation:  0.051111698150634766
r_  generation:  0.8996825218200684
local_output_nid generation:  0.0071353912353515625
local_in_edges_tensor generation:  0.012233734130859375
mini_batch_src_global generation:  0.05829334259033203
r_  generation:  0.9774582386016846
local_output_nid generation:  0.007111787796020508
local_in_edges_tensor generation:  0.01233673095703125
mini_batch_src_global generation:  0.06532669067382812
r_  generation:  1.0187361240386963
local_output_nid generation:  0.007399559020996094
local_in_edges_tensor generation:  0.019701719284057617
mini_batch_src_global generation:  0.07325911521911621
r_  generation:  1.0654888153076172
local_output_nid generation:  0.007221698760986328
local_in_edges_tensor generation:  0.015190601348876953
mini_batch_src_global generation:  0.07496285438537598
r_  generation:  1.0876617431640625
local_output_nid generation:  0.00720977783203125
local_in_edges_tensor generation:  0.012958288192749023
mini_batch_src_global generation:  0.07467150688171387
r_  generation:  1.0898430347442627
----------------------check_connections_block total spend ----------------------------- 10.130534172058105
generate_one_block  1.4514756202697754
generate_one_block  1.2381720542907715
generate_one_block  1.0508887767791748
generate_one_block  1.1410751342773438
generate_one_block  1.1552152633666992
generate_one_block  1.0664095878601074
generate_one_block  1.019805669784546
generate_one_block  1.0283939838409424
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3705873489379883
gen group dst list time:  0.18646907806396484
time for parepare:  0.4637875556945801
local_output_nid generation:  0.15503740310668945
local_in_edges_tensor generation:  0.9427580833435059
mini_batch_src_global generation:  1.3065896034240723
r_  generation:  15.537508487701416
local_output_nid generation:  0.2413640022277832
local_in_edges_tensor generation:  1.1799516677856445
mini_batch_src_global generation:  1.6680378913879395
r_  generation:  15.609647989273071
local_output_nid generation:  0.2656979560852051
local_in_edges_tensor generation:  1.1207611560821533
mini_batch_src_global generation:  1.6464178562164307
r_  generation:  15.572827577590942
local_output_nid generation:  0.25817298889160156
local_in_edges_tensor generation:  1.0671350955963135
mini_batch_src_global generation:  1.7421586513519287
r_  generation:  15.527585506439209
local_output_nid generation:  0.2709527015686035
local_in_edges_tensor generation:  1.0975301265716553
mini_batch_src_global generation:  1.8135457038879395
r_  generation:  15.768368244171143
local_output_nid generation:  0.28594470024108887
local_in_edges_tensor generation:  1.1681220531463623
mini_batch_src_global generation:  1.6362521648406982
r_  generation:  15.965776681900024
local_output_nid generation:  0.2903594970703125
local_in_edges_tensor generation:  1.1716334819793701
mini_batch_src_global generation:  1.6256320476531982
r_  generation:  16.03032875061035
local_output_nid generation:  0.2952125072479248
local_in_edges_tensor generation:  1.1730930805206299
mini_batch_src_global generation:  1.6684415340423584
r_  generation:  15.83916449546814
----------------------check_connections_block total spend ----------------------------- 171.5512421131134
generate_one_block  21.948018074035645
generate_one_block  21.916788339614868
generate_one_block  21.606505155563354
generate_one_block  21.705034732818604
generate_one_block  22.191365003585815
generate_one_block  22.13284945487976
generate_one_block  21.90940546989441
generate_one_block  22.00519108772278
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.196446657180786
gen group dst list time:  0.6057500839233398
time for parepare:  0.4866631031036377
local_output_nid generation:  0.5468811988830566
local_in_edges_tensor generation:  1.228055715560913
mini_batch_src_global generation:  1.2296199798583984
r_  generation:  17.21718430519104
local_output_nid generation:  0.6723973751068115
local_in_edges_tensor generation:  1.3161776065826416
mini_batch_src_global generation:  1.6331593990325928
r_  generation:  16.973395824432373
local_output_nid generation:  0.6966009140014648
local_in_edges_tensor generation:  1.4783093929290771
mini_batch_src_global generation:  1.6087331771850586
r_  generation:  17.541748762130737
local_output_nid generation:  0.6957662105560303
local_in_edges_tensor generation:  1.3149173259735107
mini_batch_src_global generation:  1.6438353061676025
r_  generation:  16.968563079833984
local_output_nid generation:  0.7104299068450928
local_in_edges_tensor generation:  1.316593885421753
mini_batch_src_global generation:  1.5941295623779297
r_  generation:  17.222105979919434
local_output_nid generation:  0.7050402164459229
local_in_edges_tensor generation:  1.3335466384887695
mini_batch_src_global generation:  1.6303462982177734
r_  generation:  17.11024785041809
local_output_nid generation:  0.7084755897521973
local_in_edges_tensor generation:  1.3553836345672607
mini_batch_src_global generation:  1.6240293979644775
r_  generation:  17.275124549865723
local_output_nid generation:  0.694976806640625
local_in_edges_tensor generation:  1.3617796897888184
mini_batch_src_global generation:  1.7156498432159424
r_  generation:  17.127262830734253
----------------------check_connections_block total spend ----------------------------- 191.50843405723572
generate_one_block  22.80185317993164
generate_one_block  22.483035802841187
generate_one_block  22.518203020095825
generate_one_block  23.069309949874878
generate_one_block  22.529351711273193
generate_one_block  22.520142793655396
generate_one_block  22.583296298980713
generate_one_block  22.84203839302063
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 2.7009973526000977  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

connection checking time:  363.0596761703491
block generation total time  356.7623884677887
average batch blocks generation time:  44.59529855847359
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4538121223449707  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7720236778259277  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4549989700317383  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7704129219055176  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.454174518585205  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7734851837158203  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4531378746032715  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7651538848876953  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 1.4529309272766113  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8914794921875 GB
    Memory Allocated: 3.7642784118652344  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4562363624572754  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7768592834472656  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4555845260620117  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7743782997131348  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4556727409362793  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.775376319885254  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4006846845149994 |0.5239868760108948 |0.0062713623046875 |0.00013723969459533691 |0.024129807949066162 |0.0025789737701416016 |
----------------------------------------------------------pseudo_mini_loss sum 3.6813008785247803
Total (block generation + training)time/epoch 778.7945396900177
Training time/epoch 1648066713.80047
Training time without block to device /epoch 1648066709.608575
Training time without total dataloading part /epoch 0.2468862533569336
load block tensor time/epoch 3.205477476119995
block to device time/epoch 4.191895008087158
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  40323349
Number of first layer input nodes during this epoch:  18017068
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 2.7076334953308105  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6862614154815674
range selection method range initialization spend 0.02647566795349121
time for parepare:  0.3634004592895508
local_output_nid generation:  0.006828784942626953
local_in_edges_tensor generation:  0.03632640838623047
mini_batch_src_global generation:  0.0610964298248291
r_  generation:  0.7984049320220947
local_output_nid generation:  0.007376909255981445
local_in_edges_tensor generation:  0.019196510314941406
mini_batch_src_global generation:  0.0700063705444336
r_  generation:  0.8699502944946289
local_output_nid generation:  0.007390260696411133
local_in_edges_tensor generation:  0.012215137481689453
mini_batch_src_global generation:  0.05168342590332031
r_  generation:  0.8935935497283936
local_output_nid generation:  0.0074918270111083984
local_in_edges_tensor generation:  0.012497425079345703
mini_batch_src_global generation:  0.05907630920410156
r_  generation:  0.970768928527832
local_output_nid generation:  0.007293701171875
local_in_edges_tensor generation:  0.014901876449584961
mini_batch_src_global generation:  0.06508207321166992
r_  generation:  1.0168540477752686
local_output_nid generation:  0.007446765899658203
local_in_edges_tensor generation:  0.019155025482177734
mini_batch_src_global generation:  0.0710601806640625
r_  generation:  1.0690762996673584
local_output_nid generation:  0.007802009582519531
local_in_edges_tensor generation:  0.01688528060913086
mini_batch_src_global generation:  0.0714719295501709
r_  generation:  1.0820932388305664
local_output_nid generation:  0.007695436477661133
local_in_edges_tensor generation:  0.019167184829711914
mini_batch_src_global generation:  0.07631087303161621
r_  generation:  1.1003594398498535
----------------------check_connections_block total spend ----------------------------- 10.116147756576538
generate_one_block  1.443741798400879
generate_one_block  1.2490661144256592
generate_one_block  1.0495057106018066
generate_one_block  1.2366867065429688
generate_one_block  1.0250067710876465
generate_one_block  1.041893482208252
generate_one_block  1.0225367546081543
generate_one_block  1.0208449363708496
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.439283847808838
gen group dst list time:  0.20734119415283203
time for parepare:  0.4773721694946289
local_output_nid generation:  0.15692710876464844
local_in_edges_tensor generation:  0.9225265979766846
mini_batch_src_global generation:  1.3026173114776611
r_  generation:  15.349839448928833
local_output_nid generation:  0.24600434303283691
local_in_edges_tensor generation:  1.064025640487671
mini_batch_src_global generation:  1.663025140762329
r_  generation:  15.677196741104126
local_output_nid generation:  0.25177621841430664
local_in_edges_tensor generation:  1.3140172958374023
mini_batch_src_global generation:  1.6927669048309326
r_  generation:  15.279343843460083
local_output_nid generation:  0.27345871925354004
local_in_edges_tensor generation:  1.0530662536621094
mini_batch_src_global generation:  1.7251734733581543
r_  generation:  15.584567070007324
local_output_nid generation:  0.27970004081726074
local_in_edges_tensor generation:  1.0697541236877441
mini_batch_src_global generation:  1.6809537410736084
r_  generation:  15.81747579574585
local_output_nid generation:  0.2797110080718994
local_in_edges_tensor generation:  1.156470537185669
mini_batch_src_global generation:  1.6289551258087158
r_  generation:  15.994879961013794
local_output_nid generation:  0.28936100006103516
local_in_edges_tensor generation:  1.1775197982788086
mini_batch_src_global generation:  1.6722970008850098
r_  generation:  15.539677143096924
local_output_nid generation:  0.2741696834564209
local_in_edges_tensor generation:  1.063105821609497
mini_batch_src_global generation:  1.779932975769043
r_  generation:  15.594923496246338
----------------------check_connections_block total spend ----------------------------- 170.62961554527283
generate_one_block  22.153727054595947
generate_one_block  21.901039600372314
generate_one_block  21.98601484298706
generate_one_block  21.80666422843933
generate_one_block  22.45540761947632
generate_one_block  22.028393268585205
generate_one_block  21.906212329864502
generate_one_block  21.86470675468445
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2141778469085693
gen group dst list time:  0.6087446212768555
time for parepare:  0.5075855255126953
local_output_nid generation:  0.5217969417572021
local_in_edges_tensor generation:  1.186605453491211
mini_batch_src_global generation:  1.2203357219696045
r_  generation:  16.687845706939697
local_output_nid generation:  0.668473482131958
local_in_edges_tensor generation:  1.3677527904510498
mini_batch_src_global generation:  1.6501460075378418
r_  generation:  16.918280839920044
local_output_nid generation:  0.6856696605682373
local_in_edges_tensor generation:  1.3343265056610107
mini_batch_src_global generation:  1.556131362915039
r_  generation:  17.16246771812439
local_output_nid generation:  0.7061281204223633
local_in_edges_tensor generation:  1.3189473152160645
mini_batch_src_global generation:  1.6056897640228271
r_  generation:  17.200335264205933
local_output_nid generation:  0.6861765384674072
local_in_edges_tensor generation:  1.3784441947937012
mini_batch_src_global generation:  1.6157712936401367
r_  generation:  17.110612392425537
local_output_nid generation:  0.7029290199279785
local_in_edges_tensor generation:  1.3566563129425049
mini_batch_src_global generation:  1.8563201427459717
r_  generation:  17.114850759506226
local_output_nid generation:  0.7061440944671631
local_in_edges_tensor generation:  1.3516535758972168
mini_batch_src_global generation:  1.7297978401184082
r_  generation:  17.25882649421692
local_output_nid generation:  0.7082958221435547
local_in_edges_tensor generation:  1.3157026767730713
mini_batch_src_global generation:  1.8000450134277344
r_  generation:  17.118348836898804
----------------------check_connections_block total spend ----------------------------- 190.73538255691528
generate_one_block  22.789291858673096
generate_one_block  22.73706555366516
generate_one_block  22.670947074890137
generate_one_block  23.449853658676147
generate_one_block  22.748496532440186
generate_one_block  22.780975103378296
generate_one_block  22.87573742866516
generate_one_block  22.705520629882812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 2.7076334953308105  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

connection checking time:  361.3649981021881
block generation total time  358.8600535392761
average batch blocks generation time:  44.857506692409515
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4527287483215332  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7653088569641113  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4566173553466797  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.777589797973633  GigaBytes
Max Memory Allocated: 4.621994495391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4543304443359375  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7721681594848633  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4551820755004883  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7732906341552734  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4535846710205078  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.770443916320801  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.454416275024414  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.772031784057617  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4558773040771484  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7755002975463867  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4538464546203613  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.766392230987549  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.42011427879333496 |0.664439469575882 |0.0038943588733673096 |0.0001436471939086914 |0.005093008279800415 |0.0013778209686279297 |
----------------------------------------------------------pseudo_mini_loss sum 3.1042511463165283
Total (block generation + training)time/epoch 779.5511301755905
Training time/epoch 1648067494.1085007
Training time without block to device /epoch 1648067488.792985
Training time without total dataloading part /epoch 0.07442593574523926
load block tensor time/epoch 3.3609142303466797
block to device time/epoch 5.315515756607056
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  40323466
Number of first layer input nodes during this epoch:  18017350
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 2.7017316818237305  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6427497863769531
range selection method range initialization spend 0.026380062103271484
time for parepare:  0.3731856346130371
local_output_nid generation:  0.006996870040893555
local_in_edges_tensor generation:  0.03974556922912598
mini_batch_src_global generation:  0.055845022201538086
r_  generation:  0.7963497638702393
local_output_nid generation:  0.007194995880126953
local_in_edges_tensor generation:  0.019037961959838867
mini_batch_src_global generation:  0.06905317306518555
r_  generation:  0.8831577301025391
local_output_nid generation:  0.0071010589599609375
local_in_edges_tensor generation:  0.012496471405029297
mini_batch_src_global generation:  0.05016469955444336
r_  generation:  0.8993029594421387
local_output_nid generation:  0.0071942806243896484
local_in_edges_tensor generation:  0.012265205383300781
mini_batch_src_global generation:  0.06080436706542969
r_  generation:  0.9977552890777588
local_output_nid generation:  0.007157564163208008
local_in_edges_tensor generation:  0.012192010879516602
mini_batch_src_global generation:  0.0675806999206543
r_  generation:  1.0410068035125732
local_output_nid generation:  0.007239580154418945
local_in_edges_tensor generation:  0.012320280075073242
mini_batch_src_global generation:  0.0726175308227539
r_  generation:  1.1026251316070557
local_output_nid generation:  0.007230520248413086
local_in_edges_tensor generation:  0.016705989837646484
mini_batch_src_global generation:  0.07114243507385254
r_  generation:  1.107792615890503
local_output_nid generation:  0.0074460506439208984
local_in_edges_tensor generation:  0.010520219802856445
mini_batch_src_global generation:  0.07272005081176758
r_  generation:  1.0631377696990967
----------------------check_connections_block total spend ----------------------------- 10.200052976608276
generate_one_block  1.4218692779541016
generate_one_block  1.0325305461883545
generate_one_block  1.0301578044891357
generate_one_block  1.0318140983581543
generate_one_block  1.034642219543457
generate_one_block  1.0755252838134766
generate_one_block  1.0335144996643066
generate_one_block  1.0358915328979492
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.338665723800659
gen group dst list time:  0.18011856079101562
time for parepare:  0.4731478691101074
local_output_nid generation:  0.15639472007751465
local_in_edges_tensor generation:  0.9404101371765137
mini_batch_src_global generation:  1.2875213623046875
r_  generation:  15.528138160705566
local_output_nid generation:  0.2555274963378906
local_in_edges_tensor generation:  1.0848453044891357
mini_batch_src_global generation:  1.7462942600250244
r_  generation:  15.998311042785645
local_output_nid generation:  0.2676973342895508
local_in_edges_tensor generation:  1.378812551498413
mini_batch_src_global generation:  1.6900410652160645
r_  generation:  15.548430919647217
local_output_nid generation:  0.26308536529541016
local_in_edges_tensor generation:  1.1841628551483154
mini_batch_src_global generation:  1.8256919384002686
r_  generation:  15.666263580322266
local_output_nid generation:  0.27276182174682617
local_in_edges_tensor generation:  0.958742618560791
mini_batch_src_global generation:  1.986495018005371
r_  generation:  16.190470218658447
local_output_nid generation:  0.2884535789489746
local_in_edges_tensor generation:  1.150090217590332
mini_batch_src_global generation:  1.6895074844360352
r_  generation:  15.914546489715576
local_output_nid generation:  0.2893517017364502
local_in_edges_tensor generation:  1.1940789222717285
mini_batch_src_global generation:  1.6803991794586182
r_  generation:  15.651746034622192
local_output_nid generation:  0.2755279541015625
local_in_edges_tensor generation:  1.0620949268341064
mini_batch_src_global generation:  1.7726976871490479
r_  generation:  15.549398183822632
----------------------check_connections_block total spend ----------------------------- 172.91725182533264
generate_one_block  22.015636920928955
generate_one_block  21.799033403396606
generate_one_block  21.89137887954712
generate_one_block  21.85698676109314
generate_one_block  22.121923208236694
generate_one_block  21.919963359832764
generate_one_block  22.004499912261963
generate_one_block  22.09501552581787
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2377569675445557
gen group dst list time:  0.6268548965454102
time for parepare:  0.45450925827026367
local_output_nid generation:  0.5237259864807129
local_in_edges_tensor generation:  1.181398868560791
mini_batch_src_global generation:  1.2144477367401123
r_  generation:  16.67830753326416
local_output_nid generation:  0.664757251739502
local_in_edges_tensor generation:  1.328331708908081
mini_batch_src_global generation:  1.6699988842010498
r_  generation:  17.354984283447266
local_output_nid generation:  0.707679271697998
local_in_edges_tensor generation:  1.4862687587738037
mini_batch_src_global generation:  1.6215112209320068
r_  generation:  17.318368673324585
local_output_nid generation:  0.709749698638916
local_in_edges_tensor generation:  1.335944414138794
mini_batch_src_global generation:  1.6068034172058105
r_  generation:  17.25032877922058
local_output_nid generation:  0.7135839462280273
local_in_edges_tensor generation:  1.3582046031951904
mini_batch_src_global generation:  1.6360142230987549
r_  generation:  17.502980709075928
local_output_nid generation:  0.7249500751495361
local_in_edges_tensor generation:  1.3667066097259521
mini_batch_src_global generation:  1.6510093212127686
r_  generation:  17.349510192871094
local_output_nid generation:  0.695636510848999
local_in_edges_tensor generation:  1.3934721946716309
mini_batch_src_global generation:  1.6649448871612549
r_  generation:  17.447673320770264
local_output_nid generation:  0.7245688438415527
local_in_edges_tensor generation:  1.396131992340088
mini_batch_src_global generation:  1.7467598915100098
r_  generation:  17.24760413169861
----------------------check_connections_block total spend ----------------------------- 192.32274794578552
generate_one_block  22.862494468688965
generate_one_block  22.66829562187195
generate_one_block  22.71232581138611
generate_one_block  23.36380100250244
generate_one_block  22.672003030776978
generate_one_block  22.657887935638428
generate_one_block  22.701571702957153
generate_one_block  22.64825177192688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 2.7017316818237305  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

connection checking time:  365.23999977111816
block generation total time  357.991069316864
average batch blocks generation time:  44.748883664608
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4529895782470703  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7691683769226074  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4536876678466797  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7658910751342773  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4555907249450684  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7713847160339355  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4550342559814453  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.77297306060791  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4549055099487305  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7724733352661133  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4552154541015625  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7742056846618652  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4560012817382812  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7768168449401855  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.452812671661377  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7653732299804688  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41076719760894775 |0.6961395442485809 |0.006492435932159424 |0.00014260411262512207 |0.00497475266456604 |0.0022034645080566406 |
----------------------------------------------------------pseudo_mini_loss sum 2.6815950870513916
Total (block generation + training)time/epoch 780.6282279491425
Training time/epoch 1648068276.8913279
Training time without block to device /epoch 1648068271.3222115
Training time without total dataloading part /epoch 0.09508180618286133
load block tensor time/epoch 3.286137580871582
block to device time/epoch 5.5691163539886475
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  40321924
Number of first layer input nodes during this epoch:  18017704
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 2.7010364532470703  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6505820751190186
range selection method range initialization spend 0.02621173858642578
time for parepare:  0.3931396007537842
local_output_nid generation:  0.007245540618896484
local_in_edges_tensor generation:  0.04012918472290039
mini_batch_src_global generation:  0.05830955505371094
r_  generation:  0.8065471649169922
local_output_nid generation:  0.0077593326568603516
local_in_edges_tensor generation:  0.018070697784423828
mini_batch_src_global generation:  0.06804776191711426
r_  generation:  0.9023962020874023
local_output_nid generation:  0.007663249969482422
local_in_edges_tensor generation:  0.012236595153808594
mini_batch_src_global generation:  0.048857927322387695
r_  generation:  0.9318666458129883
local_output_nid generation:  0.007665157318115234
local_in_edges_tensor generation:  0.012146711349487305
mini_batch_src_global generation:  0.056563377380371094
r_  generation:  0.9973659515380859
local_output_nid generation:  0.007767915725708008
local_in_edges_tensor generation:  0.013232707977294922
mini_batch_src_global generation:  0.06318306922912598
r_  generation:  1.0270075798034668
local_output_nid generation:  0.008005380630493164
local_in_edges_tensor generation:  0.012794971466064453
mini_batch_src_global generation:  0.06936120986938477
r_  generation:  1.0517337322235107
local_output_nid generation:  0.00800943374633789
local_in_edges_tensor generation:  0.012500524520874023
mini_batch_src_global generation:  0.0739443302154541
r_  generation:  1.0693776607513428
local_output_nid generation:  0.00795888900756836
local_in_edges_tensor generation:  0.023592472076416016
mini_batch_src_global generation:  0.07290291786193848
r_  generation:  1.0837194919586182
----------------------check_connections_block total spend ----------------------------- 10.244351387023926
generate_one_block  1.460036277770996
generate_one_block  1.0418691635131836
generate_one_block  1.1804869174957275
generate_one_block  1.2865653038024902
generate_one_block  1.0301673412322998
generate_one_block  1.0446105003356934
generate_one_block  1.0172176361083984
generate_one_block  1.013190507888794
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3636062145233154
gen group dst list time:  0.1868290901184082
time for parepare:  0.45011258125305176
local_output_nid generation:  0.15709733963012695
local_in_edges_tensor generation:  0.9341328144073486
mini_batch_src_global generation:  1.3763298988342285
r_  generation:  15.42362117767334
local_output_nid generation:  0.2481393814086914
local_in_edges_tensor generation:  1.1749413013458252
mini_batch_src_global generation:  1.706117868423462
r_  generation:  16.027454137802124
local_output_nid generation:  0.2703206539154053
local_in_edges_tensor generation:  1.102468490600586
mini_batch_src_global generation:  1.7022967338562012
r_  generation:  15.602706670761108
local_output_nid generation:  0.26099085807800293
local_in_edges_tensor generation:  1.196040153503418
mini_batch_src_global generation:  1.8152058124542236
r_  generation:  15.547455310821533
local_output_nid generation:  0.27600646018981934
local_in_edges_tensor generation:  0.9692344665527344
mini_batch_src_global generation:  1.851212978363037
r_  generation:  15.816574573516846
local_output_nid generation:  0.2871665954589844
local_in_edges_tensor generation:  1.2002184391021729
mini_batch_src_global generation:  1.7235751152038574
r_  generation:  15.942466735839844
local_output_nid generation:  0.28150177001953125
local_in_edges_tensor generation:  1.1579549312591553
mini_batch_src_global generation:  1.6408164501190186
r_  generation:  15.941560745239258
local_output_nid generation:  0.2685389518737793
local_in_edges_tensor generation:  1.1643331050872803
mini_batch_src_global generation:  1.8128132820129395
r_  generation:  15.72662615776062
----------------------check_connections_block total spend ----------------------------- 172.55204463005066
generate_one_block  21.86989688873291
generate_one_block  21.945764541625977
generate_one_block  21.91363549232483
generate_one_block  21.89315104484558
generate_one_block  22.19682478904724
generate_one_block  22.036864280700684
generate_one_block  22.062339067459106
generate_one_block  21.854966163635254
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.235088586807251
gen group dst list time:  0.615297794342041
time for parepare:  0.48337888717651367
local_output_nid generation:  0.5111160278320312
local_in_edges_tensor generation:  1.2119765281677246
mini_batch_src_global generation:  1.2213525772094727
r_  generation:  16.794886589050293
local_output_nid generation:  0.6491386890411377
local_in_edges_tensor generation:  1.3496546745300293
mini_batch_src_global generation:  1.6059682369232178
r_  generation:  17.1612811088562
local_output_nid generation:  0.6840417385101318
local_in_edges_tensor generation:  1.4811010360717773
mini_batch_src_global generation:  1.5633094310760498
r_  generation:  17.350586891174316
local_output_nid generation:  0.6909840106964111
local_in_edges_tensor generation:  1.3440477848052979
mini_batch_src_global generation:  1.6135258674621582
r_  generation:  17.28263759613037
local_output_nid generation:  0.7003581523895264
local_in_edges_tensor generation:  1.3473536968231201
mini_batch_src_global generation:  1.6081080436706543
r_  generation:  17.57220721244812
local_output_nid generation:  0.7004320621490479
local_in_edges_tensor generation:  1.3552656173706055
mini_batch_src_global generation:  1.650303602218628
r_  generation:  17.40874171257019
local_output_nid generation:  0.6986362934112549
local_in_edges_tensor generation:  1.3850464820861816
mini_batch_src_global generation:  1.6578636169433594
r_  generation:  17.44284987449646
local_output_nid generation:  0.7095842361450195
local_in_edges_tensor generation:  1.3773152828216553
mini_batch_src_global generation:  1.7928833961486816
r_  generation:  17.356260538101196
----------------------check_connections_block total spend ----------------------------- 192.26448965072632
generate_one_block  22.838735818862915
generate_one_block  22.669138193130493
generate_one_block  22.74954104423523
generate_one_block  23.65639901161194
generate_one_block  22.717733144760132
generate_one_block  22.68963313102722
generate_one_block  22.59683656692505
generate_one_block  22.629443168640137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 2.7010364532470703  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

connection checking time:  364.816534280777
block generation total time  358.3209023475647
average batch blocks generation time:  44.79011279344559
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4548330307006836  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.7724766731262207  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.452291488647461  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.763767719268799  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4542655944824219  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.772310733795166  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4557666778564453  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.774517059326172  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.455183982849121  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.773174285888672  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.453404426574707  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.769524097442627  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4555425643920898  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.774387836456299  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 1.4544386863708496  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7332763671875 GB
    Memory Allocated: 3.772461414337158  GigaBytes
Max Memory Allocated: 4.625339984893799  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4152025580406189 |0.581434041261673 |0.003738105297088623 |0.00014072656631469727 |0.004935353994369507 |0.0028264522552490234 |
----------------------------------------------------------pseudo_mini_loss sum 2.3745408058166504
Total (block generation + training)time/epoch 781.0726709365845
Training time/epoch 1648069059.2976665
Training time without block to device /epoch 1648069054.6461942
Training time without total dataloading part /epoch 0.07333993911743164
load block tensor time/epoch 3.321620464324951
block to device time/epoch 4.651472330093384
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  40325115
Number of first layer input nodes during this epoch:  18018294
