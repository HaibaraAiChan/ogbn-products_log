main start at this time 1648128006.1881936
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6481826305389404
range selection method range initialization spend 0.028972387313842773
time for parepare:  0.3649725914001465
local_output_nid generation:  0.006742000579833984
local_in_edges_tensor generation:  0.04454994201660156
mini_batch_src_global generation:  0.052965641021728516
r_  generation:  0.7890307903289795
local_output_nid generation:  0.007145881652832031
local_in_edges_tensor generation:  0.026798248291015625
mini_batch_src_global generation:  0.06473803520202637
r_  generation:  0.850916862487793
local_output_nid generation:  0.007035732269287109
local_in_edges_tensor generation:  0.015313148498535156
mini_batch_src_global generation:  0.04869484901428223
r_  generation:  0.8899316787719727
local_output_nid generation:  0.007277488708496094
local_in_edges_tensor generation:  0.02403736114501953
mini_batch_src_global generation:  0.05600261688232422
r_  generation:  0.9667739868164062
local_output_nid generation:  0.007042646408081055
local_in_edges_tensor generation:  0.010411500930786133
mini_batch_src_global generation:  0.06177544593811035
r_  generation:  1.0073084831237793
local_output_nid generation:  0.006987810134887695
local_in_edges_tensor generation:  0.015095233917236328
mini_batch_src_global generation:  0.06844091415405273
r_  generation:  1.0380077362060547
local_output_nid generation:  0.007096052169799805
local_in_edges_tensor generation:  0.01933431625366211
mini_batch_src_global generation:  0.07063007354736328
r_  generation:  1.0571558475494385
local_output_nid generation:  0.006963491439819336
local_in_edges_tensor generation:  0.012345552444458008
mini_batch_src_global generation:  0.07243871688842773
r_  generation:  1.0647788047790527
----------------------check_connections_block total spend ----------------------------- 9.886267900466919
generate_one_block  6.081677436828613
generate_one_block  1.0003106594085693
generate_one_block  1.0135917663574219
generate_one_block  1.0174686908721924
generate_one_block  1.010568618774414
generate_one_block  1.0049338340759277
generate_one_block  1.0038528442382812
generate_one_block  1.0054523944854736
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.903010129928589
gen group dst list time:  0.17645645141601562
time for parepare:  0.44118785858154297
local_output_nid generation:  0.13573789596557617
local_in_edges_tensor generation:  0.9019877910614014
mini_batch_src_global generation:  1.2453546524047852
r_  generation:  14.695154666900635
local_output_nid generation:  0.23363900184631348
local_in_edges_tensor generation:  0.8992271423339844
mini_batch_src_global generation:  1.5826382637023926
r_  generation:  15.299707174301147
local_output_nid generation:  0.23655009269714355
local_in_edges_tensor generation:  0.9481856822967529
mini_batch_src_global generation:  1.5973942279815674
r_  generation:  15.220880270004272
local_output_nid generation:  0.25660228729248047
local_in_edges_tensor generation:  1.4824059009552002
mini_batch_src_global generation:  1.7099604606628418
r_  generation:  15.67230486869812
local_output_nid generation:  0.27969932556152344
local_in_edges_tensor generation:  0.9457905292510986
mini_batch_src_global generation:  1.664663314819336
r_  generation:  15.86531686782837
local_output_nid generation:  0.2841978073120117
local_in_edges_tensor generation:  1.161834716796875
mini_batch_src_global generation:  1.7095518112182617
r_  generation:  15.6723473072052
local_output_nid generation:  0.2850921154022217
local_in_edges_tensor generation:  1.1573407649993896
mini_batch_src_global generation:  1.7557940483093262
r_  generation:  15.798894166946411
local_output_nid generation:  0.2865478992462158
local_in_edges_tensor generation:  1.1456925868988037
mini_batch_src_global generation:  1.6327064037322998
r_  generation:  15.78095293045044
----------------------check_connections_block total spend ----------------------------- 168.68352150917053
generate_one_block  21.678151845932007
generate_one_block  21.718735933303833
generate_one_block  22.216213703155518
generate_one_block  21.523195505142212
generate_one_block  21.72809386253357
generate_one_block  21.787254810333252
generate_one_block  21.76536750793457
generate_one_block  21.72588276863098
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.287978410720825
gen group dst list time:  0.6147565841674805
time for parepare:  0.49796414375305176
local_output_nid generation:  0.5360233783721924
local_in_edges_tensor generation:  2.039418935775757
mini_batch_src_global generation:  1.9977185726165771
r_  generation:  25.79662823677063
local_output_nid generation:  0.6687791347503662
local_in_edges_tensor generation:  1.9208204746246338
mini_batch_src_global generation:  2.8712666034698486
r_  generation:  26.132178783416748
local_output_nid generation:  0.705716609954834
local_in_edges_tensor generation:  2.1726233959198
mini_batch_src_global generation:  2.646843910217285
r_  generation:  26.09364128112793
local_output_nid generation:  0.7063877582550049
local_in_edges_tensor generation:  1.8793764114379883
mini_batch_src_global generation:  2.743985891342163
r_  generation:  25.682956218719482
local_output_nid generation:  0.7252254486083984
local_in_edges_tensor generation:  1.9564712047576904
mini_batch_src_global generation:  2.841048240661621
r_  generation:  25.866350412368774
local_output_nid generation:  0.734473705291748
local_in_edges_tensor generation:  1.906630277633667
mini_batch_src_global generation:  2.730355739593506
r_  generation:  25.62608814239502
local_output_nid generation:  0.7206437587738037
local_in_edges_tensor generation:  1.9067037105560303
mini_batch_src_global generation:  2.9077541828155518
r_  generation:  26.06807017326355
local_output_nid generation:  0.7298390865325928
local_in_edges_tensor generation:  1.9397449493408203
mini_batch_src_global generation:  2.731175661087036
r_  generation:  25.723082304000854
----------------------check_connections_block total spend ----------------------------- 286.9643225669861
generate_one_block  34.46252179145813
generate_one_block  35.468183279037476
generate_one_block  34.459017515182495
generate_one_block  34.335933446884155
generate_one_block  33.99503183364868
generate_one_block  34.282050132751465
generate_one_block  35.102997064590454
generate_one_block  34.10996961593628
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  455.6478440761566
block generation total time  450.3586006164551
average batch blocks generation time:  56.294825077056885
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7430419921875 GB
    Memory Allocated: 1.638679027557373  GigaBytes
Max Memory Allocated: 1.638679027557373  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.7430419921875 GB
    Memory Allocated: 4.142721176147461  GigaBytes
Max Memory Allocated: 4.459749221801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5438232421875 GB
    Memory Allocated: 1.6446819305419922  GigaBytes
Max Memory Allocated: 5.451448917388916  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5457763671875 GB
    Memory Allocated: 4.142180919647217  GigaBytes
Max Memory Allocated: 5.451448917388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5477294921875 GB
    Memory Allocated: 1.644394874572754  GigaBytes
Max Memory Allocated: 5.458231449127197  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5477294921875 GB
    Memory Allocated: 4.143949031829834  GigaBytes
Max Memory Allocated: 5.458231449127197  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5477294921875 GB
    Memory Allocated: 1.645644187927246  GigaBytes
Max Memory Allocated: 5.458231449127197  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5477294921875 GB
    Memory Allocated: 4.142199516296387  GigaBytes
Max Memory Allocated: 5.458231449127197  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5477294921875 GB
    Memory Allocated: 1.6450567245483398  GigaBytes
Max Memory Allocated: 5.458231449127197  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.146806240081787  GigaBytes
Max Memory Allocated: 5.458231449127197  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 1.6445088386535645  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.143505096435547  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 1.6450567245483398  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.141382694244385  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 1.6417665481567383  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.133334159851074  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4137731194496155 |1.1176144182682037 |0.09371209144592285 |0.00017023086547851562 |0.06138128042221069 |0.003623485565185547 |
----------------------------------------------------------pseudo_mini_loss sum 8.670462608337402
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  40524183
Number of first layer input nodes during this epoch:  18221093
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 3.250835418701172  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7309055328369141
range selection method range initialization spend 0.02703690528869629
time for parepare:  0.36852455139160156
local_output_nid generation:  0.006628990173339844
local_in_edges_tensor generation:  0.039086341857910156
mini_batch_src_global generation:  0.049967050552368164
r_  generation:  0.8203864097595215
local_output_nid generation:  0.007180929183959961
local_in_edges_tensor generation:  0.025214433670043945
mini_batch_src_global generation:  0.06575345993041992
r_  generation:  0.8907365798950195
local_output_nid generation:  0.007078409194946289
local_in_edges_tensor generation:  0.019854307174682617
mini_batch_src_global generation:  0.04842209815979004
r_  generation:  0.933150053024292
local_output_nid generation:  0.007355690002441406
local_in_edges_tensor generation:  0.02244424819946289
mini_batch_src_global generation:  0.05800127983093262
r_  generation:  0.9961686134338379
local_output_nid generation:  0.007091045379638672
local_in_edges_tensor generation:  0.024631738662719727
mini_batch_src_global generation:  0.06724786758422852
r_  generation:  1.05045747756958
local_output_nid generation:  0.0074117183685302734
local_in_edges_tensor generation:  0.02444744110107422
mini_batch_src_global generation:  0.07327723503112793
r_  generation:  1.1143815517425537
local_output_nid generation:  0.0071604251861572266
local_in_edges_tensor generation:  0.024689674377441406
mini_batch_src_global generation:  0.07122230529785156
r_  generation:  1.0685946941375732
local_output_nid generation:  0.007598161697387695
local_in_edges_tensor generation:  0.01994609832763672
mini_batch_src_global generation:  0.07222414016723633
r_  generation:  1.0799036026000977
----------------------check_connections_block total spend ----------------------------- 10.327054977416992
generate_one_block  1.4190266132354736
generate_one_block  1.0339622497558594
generate_one_block  1.0096557140350342
generate_one_block  1.0631844997406006
generate_one_block  1.1014766693115234
generate_one_block  1.1117587089538574
generate_one_block  1.435086727142334
generate_one_block  1.0447371006011963
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.6392717361450195
gen group dst list time:  0.20264697074890137
time for parepare:  0.4982578754425049
local_output_nid generation:  0.1487898826599121
local_in_edges_tensor generation:  0.9316606521606445
mini_batch_src_global generation:  1.3116793632507324
r_  generation:  15.87164306640625
local_output_nid generation:  0.23812198638916016
local_in_edges_tensor generation:  1.0527739524841309
mini_batch_src_global generation:  1.6698815822601318
r_  generation:  16.062912702560425
local_output_nid generation:  0.2611219882965088
local_in_edges_tensor generation:  1.1740045547485352
mini_batch_src_global generation:  1.8058462142944336
r_  generation:  16.09477138519287
local_output_nid generation:  0.261385440826416
local_in_edges_tensor generation:  1.1567423343658447
mini_batch_src_global generation:  1.798297643661499
r_  generation:  16.35425043106079
local_output_nid generation:  0.27726173400878906
local_in_edges_tensor generation:  1.1491281986236572
mini_batch_src_global generation:  1.6491272449493408
r_  generation:  16.43924307823181
local_output_nid generation:  0.28103137016296387
local_in_edges_tensor generation:  1.151275873184204
mini_batch_src_global generation:  1.6542727947235107
r_  generation:  16.304668188095093
local_output_nid generation:  0.2929079532623291
local_in_edges_tensor generation:  1.1480414867401123
mini_batch_src_global generation:  1.6322553157806396
r_  generation:  16.24946093559265
local_output_nid generation:  0.29993247985839844
local_in_edges_tensor generation:  1.147024154663086
mini_batch_src_global generation:  1.728518009185791
r_  generation:  16.083683490753174
----------------------check_connections_block total spend ----------------------------- 175.27939915657043
generate_one_block  22.171364307403564
generate_one_block  21.989100456237793
generate_one_block  21.905174255371094
generate_one_block  21.98904776573181
generate_one_block  22.22075629234314
generate_one_block  22.112157344818115
generate_one_block  21.957404851913452
generate_one_block  22.008538246154785
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4488115310668945
gen group dst list time:  0.6187970638275146
time for parepare:  0.4868128299713135
local_output_nid generation:  0.4881253242492676
local_in_edges_tensor generation:  1.7469913959503174
mini_batch_src_global generation:  2.0346338748931885
r_  generation:  25.63951587677002
local_output_nid generation:  0.67814040184021
local_in_edges_tensor generation:  1.9593095779418945
mini_batch_src_global generation:  2.733804702758789
r_  generation:  25.66128921508789
local_output_nid generation:  0.6955974102020264
local_in_edges_tensor generation:  2.031147003173828
mini_batch_src_global generation:  2.7718958854675293
r_  generation:  25.958135843276978
local_output_nid generation:  0.7074592113494873
local_in_edges_tensor generation:  1.8651609420776367
mini_batch_src_global generation:  2.7782390117645264
r_  generation:  26.713787078857422
local_output_nid generation:  0.7155463695526123
local_in_edges_tensor generation:  1.899444341659546
mini_batch_src_global generation:  2.7204864025115967
r_  generation:  26.535932779312134
local_output_nid generation:  0.7318997383117676
local_in_edges_tensor generation:  1.9044163227081299
mini_batch_src_global generation:  2.8334567546844482
r_  generation:  26.790974140167236
local_output_nid generation:  0.7203390598297119
local_in_edges_tensor generation:  1.9208123683929443
mini_batch_src_global generation:  2.786621332168579
r_  generation:  26.901865243911743
local_output_nid generation:  0.7704226970672607
local_in_edges_tensor generation:  1.893766164779663
mini_batch_src_global generation:  2.8490633964538574
r_  generation:  26.320512056350708
----------------------check_connections_block total spend ----------------------------- 290.6136267185211
generate_one_block  34.70545482635498
generate_one_block  34.85697150230408
generate_one_block  34.61030554771423
generate_one_block  35.64858436584473
generate_one_block  34.882035970687866
generate_one_block  34.97570538520813
generate_one_block  34.86682724952698
generate_one_block  34.877928733825684
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 3.250835418701172  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

connection checking time:  465.89302587509155
block generation total time  455.77735710144043
average batch blocks generation time:  56.972169637680054
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 1.6438360214233398  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.137753009796143  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 1.6447257995605469  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.144711017608643  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 1.643930435180664  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.135322570800781  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 1.6448774337768555  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.143050193786621  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 1.6473140716552734  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.146760940551758  GigaBytes
Max Memory Allocated: 5.459214687347412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 1.6451592445373535  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5125732421875 GB
    Memory Allocated: 4.146838188171387  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 1.6464271545410156  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 4.144659042358398  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 1.643587589263916  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 4.1394782066345215  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4317081868648529 |0.9857112765312195 |0.005060940980911255 |0.00013586878776550293 |0.02604842185974121 |0.0029282569885253906 |
----------------------------------------------------------pseudo_mini_loss sum 5.0583600997924805
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  40531542
Number of first layer input nodes during this epoch:  18223847
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 3.253932476043701  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6410291194915771
range selection method range initialization spend 0.025219440460205078
time for parepare:  0.33650660514831543
local_output_nid generation:  0.006650209426879883
local_in_edges_tensor generation:  0.04165816307067871
mini_batch_src_global generation:  0.06772947311401367
r_  generation:  0.9302353858947754
local_output_nid generation:  0.007108211517333984
local_in_edges_tensor generation:  0.019291162490844727
mini_batch_src_global generation:  0.11506438255310059
r_  generation:  0.9123539924621582
local_output_nid generation:  0.0074732303619384766
local_in_edges_tensor generation:  0.013776063919067383
mini_batch_src_global generation:  0.05383753776550293
r_  generation:  0.9034271240234375
local_output_nid generation:  0.007413625717163086
local_in_edges_tensor generation:  0.012446880340576172
mini_batch_src_global generation:  0.06027531623840332
r_  generation:  0.9793882369995117
local_output_nid generation:  0.007384061813354492
local_in_edges_tensor generation:  0.01025843620300293
mini_batch_src_global generation:  0.06777548789978027
r_  generation:  1.0310547351837158
local_output_nid generation:  0.007351398468017578
local_in_edges_tensor generation:  0.01753711700439453
mini_batch_src_global generation:  0.07065796852111816
r_  generation:  1.0685362815856934
local_output_nid generation:  0.00757288932800293
local_in_edges_tensor generation:  0.01913928985595703
mini_batch_src_global generation:  0.07439827919006348
r_  generation:  1.0733094215393066
local_output_nid generation:  0.0076029300689697266
local_in_edges_tensor generation:  0.017048358917236328
mini_batch_src_global generation:  0.07326722145080566
r_  generation:  1.0756604671478271
----------------------check_connections_block total spend ----------------------------- 10.325083255767822
generate_one_block  1.4269006252288818
generate_one_block  1.0634288787841797
generate_one_block  1.0387694835662842
generate_one_block  1.0253310203552246
generate_one_block  1.2282178401947021
generate_one_block  1.2461047172546387
generate_one_block  1.0576651096343994
generate_one_block  1.0219542980194092
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3621666431427
gen group dst list time:  0.19510197639465332
time for parepare:  0.4536764621734619
local_output_nid generation:  0.15598225593566895
local_in_edges_tensor generation:  0.9442839622497559
mini_batch_src_global generation:  1.329077959060669
r_  generation:  15.856087923049927
local_output_nid generation:  0.24279356002807617
local_in_edges_tensor generation:  1.0836293697357178
mini_batch_src_global generation:  1.705779790878296
r_  generation:  16.440019369125366
local_output_nid generation:  0.26554298400878906
local_in_edges_tensor generation:  1.3763585090637207
mini_batch_src_global generation:  1.6699399948120117
r_  generation:  16.18801736831665
local_output_nid generation:  0.2776675224304199
local_in_edges_tensor generation:  1.137848138809204
mini_batch_src_global generation:  1.6653919219970703
r_  generation:  16.24307608604431
local_output_nid generation:  0.28534412384033203
local_in_edges_tensor generation:  1.1506991386413574
mini_batch_src_global generation:  1.7527689933776855
r_  generation:  17.70592951774597
local_output_nid generation:  0.29357051849365234
local_in_edges_tensor generation:  1.1519126892089844
mini_batch_src_global generation:  1.9929206371307373
r_  generation:  16.12426781654358
local_output_nid generation:  0.292269229888916
local_in_edges_tensor generation:  1.1684753894805908
mini_batch_src_global generation:  1.6483335494995117
r_  generation:  16.11965012550354
local_output_nid generation:  0.286099910736084
local_in_edges_tensor generation:  1.159933090209961
mini_batch_src_global generation:  1.684936285018921
r_  generation:  16.117482900619507
----------------------check_connections_block total spend ----------------------------- 177.49699425697327
generate_one_block  22.449387073516846
generate_one_block  22.034409046173096
generate_one_block  22.051417112350464
generate_one_block  22.016310930252075
generate_one_block  22.28129482269287
generate_one_block  22.051433324813843
generate_one_block  22.094787120819092
generate_one_block  21.95262050628662
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4691288471221924
gen group dst list time:  0.6133100986480713
time for parepare:  0.48293352127075195
local_output_nid generation:  0.5094330310821533
local_in_edges_tensor generation:  1.679262638092041
mini_batch_src_global generation:  2.0301365852355957
r_  generation:  25.4618923664093
local_output_nid generation:  0.6735002994537354
local_in_edges_tensor generation:  1.9045991897583008
mini_batch_src_global generation:  2.9027416706085205
r_  generation:  25.50400137901306
local_output_nid generation:  0.7023022174835205
local_in_edges_tensor generation:  2.1521966457366943
mini_batch_src_global generation:  2.901021718978882
r_  generation:  25.91087555885315
local_output_nid generation:  0.7379381656646729
local_in_edges_tensor generation:  1.8874320983886719
mini_batch_src_global generation:  2.823105812072754
r_  generation:  25.801206350326538
local_output_nid generation:  0.7383570671081543
local_in_edges_tensor generation:  1.8862762451171875
mini_batch_src_global generation:  2.9395742416381836
r_  generation:  26.101785898208618
local_output_nid generation:  0.7332284450531006
local_in_edges_tensor generation:  1.8889997005462646
mini_batch_src_global generation:  2.75935435295105
r_  generation:  25.983434200286865
local_output_nid generation:  0.7242496013641357
local_in_edges_tensor generation:  1.894657850265503
mini_batch_src_global generation:  3.006854295730591
r_  generation:  26.2550151348114
local_output_nid generation:  0.7327601909637451
local_in_edges_tensor generation:  1.9017581939697266
mini_batch_src_global generation:  2.761202335357666
r_  generation:  26.040786027908325
----------------------check_connections_block total spend ----------------------------- 286.96216559410095
generate_one_block  34.77340817451477
generate_one_block  34.61587929725647
generate_one_block  34.70434904098511
generate_one_block  35.26977753639221
generate_one_block  34.45250844955444
generate_one_block  34.76104688644409
generate_one_block  34.74354410171509
generate_one_block  34.81040573120117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 3.253932476043701  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

connection checking time:  464.4591598510742
block generation total time  455.06257915496826
average batch blocks generation time:  56.88282239437103
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 1.6456971168518066  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 4.141876697540283  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 1.6434326171875  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 4.14071798324585  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 1.6448869705200195  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 4.142947673797607  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 1.642106533050537  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 4.134849548339844  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 1.6436562538146973  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3621826171875 GB
    Memory Allocated: 4.1365461349487305  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6471061706542969  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.147038459777832  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6469249725341797  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.146416187286377  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6459908485412598  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.1456122398376465  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.47575071454048157 |0.9631010890007019 |0.005137115716934204 |0.0001468658447265625 |0.026074379682540894 |0.002664804458618164 |
----------------------------------------------------------pseudo_mini_loss sum 3.6554555892944336
Total (block generation + training)time/epoch 989.814902305603
Training time/epoch 1648131010.9310186
Training time without block to device /epoch 1648131003.2262099
Training time without total dataloading part /epoch 0.25353169441223145
load block tensor time/epoch 3.8060057163238525
block to device time/epoch 7.704808712005615
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  40528785
Number of first layer input nodes during this epoch:  18221965
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 3.2585883140563965  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6807622909545898
range selection method range initialization spend 0.035703182220458984
time for parepare:  0.3495213985443115
local_output_nid generation:  0.0071258544921875
local_in_edges_tensor generation:  0.04030728340148926
mini_batch_src_global generation:  0.05764198303222656
r_  generation:  0.8141536712646484
local_output_nid generation:  0.007311820983886719
local_in_edges_tensor generation:  0.019486427307128906
mini_batch_src_global generation:  0.0715630054473877
r_  generation:  0.9190990924835205
local_output_nid generation:  0.011580228805541992
local_in_edges_tensor generation:  0.012231826782226562
mini_batch_src_global generation:  0.0490720272064209
r_  generation:  0.9575376510620117
local_output_nid generation:  0.007698535919189453
local_in_edges_tensor generation:  0.012358665466308594
mini_batch_src_global generation:  0.058156490325927734
r_  generation:  0.9788963794708252
local_output_nid generation:  0.0075836181640625
local_in_edges_tensor generation:  0.012713432312011719
mini_batch_src_global generation:  0.06337952613830566
r_  generation:  1.016103982925415
local_output_nid generation:  0.007711648941040039
local_in_edges_tensor generation:  0.014268875122070312
mini_batch_src_global generation:  0.07165408134460449
r_  generation:  1.0658276081085205
local_output_nid generation:  0.008302688598632812
local_in_edges_tensor generation:  0.014491796493530273
mini_batch_src_global generation:  0.07106208801269531
r_  generation:  1.0768811702728271
local_output_nid generation:  0.007677316665649414
local_in_edges_tensor generation:  0.01696300506591797
mini_batch_src_global generation:  0.07287049293518066
r_  generation:  1.0837879180908203
----------------------check_connections_block total spend ----------------------------- 10.221457719802856
generate_one_block  1.4519586563110352
generate_one_block  1.057527780532837
generate_one_block  1.1610374450683594
generate_one_block  1.313244342803955
generate_one_block  1.038252830505371
generate_one_block  1.0389173030853271
generate_one_block  1.0160033702850342
generate_one_block  1.0052778720855713
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.4640512466430664
gen group dst list time:  0.19600582122802734
time for parepare:  0.4721794128417969
local_output_nid generation:  0.16532325744628906
local_in_edges_tensor generation:  0.9252355098724365
mini_batch_src_global generation:  1.3159198760986328
r_  generation:  15.223905324935913
local_output_nid generation:  0.24471163749694824
local_in_edges_tensor generation:  1.1853275299072266
mini_batch_src_global generation:  1.6841099262237549
r_  generation:  15.548319101333618
local_output_nid generation:  0.26178717613220215
local_in_edges_tensor generation:  1.0949087142944336
mini_batch_src_global generation:  1.6766843795776367
r_  generation:  15.33780550956726
local_output_nid generation:  0.2651340961456299
local_in_edges_tensor generation:  1.0309078693389893
mini_batch_src_global generation:  1.793189525604248
r_  generation:  15.360687971115112
local_output_nid generation:  0.2714657783508301
local_in_edges_tensor generation:  1.133545160293579
mini_batch_src_global generation:  1.8874809741973877
r_  generation:  15.67660927772522
local_output_nid generation:  0.2848353385925293
local_in_edges_tensor generation:  1.153723955154419
mini_batch_src_global generation:  1.6917178630828857
r_  generation:  15.803508520126343
local_output_nid generation:  0.2988622188568115
local_in_edges_tensor generation:  1.0785996913909912
mini_batch_src_global generation:  1.7068817615509033
r_  generation:  15.810024976730347
local_output_nid generation:  0.29228639602661133
local_in_edges_tensor generation:  1.1358041763305664
mini_batch_src_global generation:  1.7701225280761719
r_  generation:  15.83897852897644
----------------------check_connections_block total spend ----------------------------- 170.8070285320282
generate_one_block  21.76493549346924
generate_one_block  21.754382371902466
generate_one_block  21.728450775146484
generate_one_block  21.7274272441864
generate_one_block  21.953574657440186
generate_one_block  21.814704418182373
generate_one_block  21.888850688934326
generate_one_block  21.82778263092041
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2955822944641113
gen group dst list time:  0.6016817092895508
time for parepare:  0.45441150665283203
local_output_nid generation:  0.5215837955474854
local_in_edges_tensor generation:  1.683211326599121
mini_batch_src_global generation:  2.045030355453491
r_  generation:  25.26957392692566
local_output_nid generation:  0.6757698059082031
local_in_edges_tensor generation:  1.860084056854248
mini_batch_src_global generation:  3.0805282592773438
r_  generation:  25.51535987854004
local_output_nid generation:  0.7005398273468018
local_in_edges_tensor generation:  2.1761698722839355
mini_batch_src_global generation:  2.7921855449676514
r_  generation:  25.749742031097412
local_output_nid generation:  0.7154943943023682
local_in_edges_tensor generation:  1.8935058116912842
mini_batch_src_global generation:  3.019219398498535
r_  generation:  25.918567180633545
local_output_nid generation:  0.7348325252532959
local_in_edges_tensor generation:  1.9476499557495117
mini_batch_src_global generation:  2.9419209957122803
r_  generation:  26.321158409118652
local_output_nid generation:  0.7420730590820312
local_in_edges_tensor generation:  1.913158655166626
mini_batch_src_global generation:  2.775733470916748
r_  generation:  26.138324737548828
local_output_nid generation:  0.7262082099914551
local_in_edges_tensor generation:  1.9346559047698975
mini_batch_src_global generation:  3.0209295749664307
r_  generation:  26.43037223815918
local_output_nid generation:  0.7391512393951416
local_in_edges_tensor generation:  1.9219980239868164
mini_batch_src_global generation:  2.821148157119751
r_  generation:  26.652883291244507
----------------------check_connections_block total spend ----------------------------- 288.59010553359985
generate_one_block  34.702935218811035
generate_one_block  34.798115730285645
generate_one_block  34.50428628921509
generate_one_block  35.433584451675415
generate_one_block  34.58521819114685
generate_one_block  34.59368705749512
generate_one_block  34.63651728630066
generate_one_block  34.67972755432129
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 3.2585883140563965  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

connection checking time:  459.39713406562805
block generation total time  452.394180059433
average batch blocks generation time:  56.54927250742912
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.642775535583496  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.136005401611328  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.647801399230957  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.1522040367126465  GigaBytes
Max Memory Allocated: 5.461437702178955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.643714427947998  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.141692161560059  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.644601821899414  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.143007755279541  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6435227394104004  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.138357639312744  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.643970012664795  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.141053199768066  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6454381942749023  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.147083282470703  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6445307731628418  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.1367878913879395  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.442756325006485 |1.0535964667797089 |0.003924727439880371 |0.00014516711235046387 |0.005922108888626099 |0.001390695571899414 |
----------------------------------------------------------pseudo_mini_loss sum 3.086043119430542
Total (block generation + training)time/epoch 986.1986755132675
Training time/epoch 1648131993.5138109
Training time without block to device /epoch 1648131985.0850391
Training time without total dataloading part /epoch 0.08132672309875488
load block tensor time/epoch 3.54205060005188
block to device time/epoch 8.428771734237671
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  40530016
Number of first layer input nodes during this epoch:  18222217
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 3.2530016899108887  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6183962821960449
range selection method range initialization spend 0.030975818634033203
time for parepare:  0.352292537689209
local_output_nid generation:  0.006923198699951172
local_in_edges_tensor generation:  0.03739166259765625
mini_batch_src_global generation:  0.058287858963012695
r_  generation:  0.803563117980957
local_output_nid generation:  0.0074748992919921875
local_in_edges_tensor generation:  0.020854711532592773
mini_batch_src_global generation:  0.07016849517822266
r_  generation:  0.9429993629455566
local_output_nid generation:  0.0071659088134765625
local_in_edges_tensor generation:  0.02109050750732422
mini_batch_src_global generation:  0.06025505065917969
r_  generation:  0.9071648120880127
local_output_nid generation:  0.007507801055908203
local_in_edges_tensor generation:  0.016789674758911133
mini_batch_src_global generation:  0.058902740478515625
r_  generation:  1.0278728008270264
local_output_nid generation:  0.007426023483276367
local_in_edges_tensor generation:  0.020653724670410156
mini_batch_src_global generation:  0.06296682357788086
r_  generation:  1.092756986618042
local_output_nid generation:  0.0075664520263671875
local_in_edges_tensor generation:  0.014729976654052734
mini_batch_src_global generation:  0.0689542293548584
r_  generation:  1.0738513469696045
local_output_nid generation:  0.007810831069946289
local_in_edges_tensor generation:  0.014489412307739258
mini_batch_src_global generation:  0.07480931282043457
r_  generation:  1.0699763298034668
local_output_nid generation:  0.007626056671142578
local_in_edges_tensor generation:  0.023767471313476562
mini_batch_src_global generation:  0.0763857364654541
r_  generation:  1.0721561908721924
----------------------check_connections_block total spend ----------------------------- 10.347214698791504
generate_one_block  1.4346964359283447
generate_one_block  1.07364821434021
generate_one_block  1.0373528003692627
generate_one_block  1.0398154258728027
generate_one_block  1.3262815475463867
generate_one_block  1.1529510021209717
generate_one_block  1.0370452404022217
generate_one_block  1.0106744766235352
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.337784767150879
gen group dst list time:  0.1915569305419922
time for parepare:  0.4543924331665039
local_output_nid generation:  0.1493542194366455
local_in_edges_tensor generation:  0.9294190406799316
mini_batch_src_global generation:  1.3509154319763184
r_  generation:  15.905155181884766
local_output_nid generation:  0.24202203750610352
local_in_edges_tensor generation:  1.0876264572143555
mini_batch_src_global generation:  1.7172589302062988
r_  generation:  15.50141716003418
local_output_nid generation:  0.26081299781799316
local_in_edges_tensor generation:  1.1177828311920166
mini_batch_src_global generation:  1.709657907485962
r_  generation:  15.926859855651855
local_output_nid generation:  0.27395057678222656
local_in_edges_tensor generation:  1.1402852535247803
mini_batch_src_global generation:  1.9090673923492432
r_  generation:  15.718823671340942
local_output_nid generation:  0.27483463287353516
local_in_edges_tensor generation:  1.1443569660186768
mini_batch_src_global generation:  1.949465274810791
r_  generation:  16.115665435791016
local_output_nid generation:  0.27868032455444336
local_in_edges_tensor generation:  1.1678130626678467
mini_batch_src_global generation:  1.921818494796753
r_  generation:  15.765881776809692
local_output_nid generation:  0.2797703742980957
local_in_edges_tensor generation:  1.1618080139160156
mini_batch_src_global generation:  1.9401612281799316
r_  generation:  16.21141767501831
local_output_nid generation:  0.292921781539917
local_in_edges_tensor generation:  1.1113603115081787
mini_batch_src_global generation:  1.6886343955993652
r_  generation:  15.968846082687378
----------------------check_connections_block total spend ----------------------------- 174.16537070274353
generate_one_block  21.96237587928772
generate_one_block  21.988053560256958
generate_one_block  22.07966423034668
generate_one_block  22.13043785095215
generate_one_block  22.411646842956543
generate_one_block  22.191906929016113
generate_one_block  22.170679569244385
generate_one_block  22.072875022888184
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.19712495803833
gen group dst list time:  0.6356182098388672
time for parepare:  0.4803640842437744
local_output_nid generation:  0.5136620998382568
local_in_edges_tensor generation:  1.852475881576538
mini_batch_src_global generation:  2.003124237060547
r_  generation:  25.694978713989258
local_output_nid generation:  0.673377275466919
local_in_edges_tensor generation:  1.9822683334350586
mini_batch_src_global generation:  2.887171506881714
r_  generation:  25.406145572662354
local_output_nid generation:  0.7192151546478271
local_in_edges_tensor generation:  1.9017412662506104
mini_batch_src_global generation:  2.958017110824585
r_  generation:  26.424784421920776
local_output_nid generation:  0.7040631771087646
local_in_edges_tensor generation:  1.8674793243408203
mini_batch_src_global generation:  2.7593350410461426
r_  generation:  26.270567893981934
local_output_nid generation:  0.7129776477813721
local_in_edges_tensor generation:  1.8998157978057861
mini_batch_src_global generation:  2.9769837856292725
r_  generation:  26.881267309188843
local_output_nid generation:  0.7212915420532227
local_in_edges_tensor generation:  1.9512202739715576
mini_batch_src_global generation:  2.8755569458007812
r_  generation:  26.43561553955078
local_output_nid generation:  0.7282702922821045
local_in_edges_tensor generation:  1.9303629398345947
mini_batch_src_global generation:  2.8151440620422363
r_  generation:  26.897706508636475
local_output_nid generation:  0.745105504989624
local_in_edges_tensor generation:  2.002983808517456
mini_batch_src_global generation:  2.953068494796753
r_  generation:  25.863870859146118
----------------------check_connections_block total spend ----------------------------- 289.7496712207794
generate_one_block  34.800644874572754
generate_one_block  34.691044330596924
generate_one_block  34.539286613464355
generate_one_block  35.362905502319336
generate_one_block  34.55464792251587
generate_one_block  34.71947693824768
generate_one_block  34.72668766975403
generate_one_block  34.685893535614014
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 3.2530016899108887  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

connection checking time:  463.91504192352295
block generation total time  455.0882272720337
average batch blocks generation time:  56.88602840900421
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6430301666259766  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.139047622680664  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6448602676391602  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.138427734375  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6454973220825195  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.14299201965332  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6465330123901367  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.1457014083862305  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.646407127380371  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.144408226013184  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6460580825805664  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.146620273590088  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6460661888122559  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.147891521453857  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6431431770324707  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.134737968444824  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4549853503704071 |0.8149147033691406 |0.004126608371734619 |0.00014859437942504883 |0.005972027778625488 |0.0026090145111083984 |
----------------------------------------------------------pseudo_mini_loss sum 2.6694672107696533
Total (block generation + training)time/epoch 986.8441678682963
Training time/epoch 1648132981.6493144
Training time without block to device /epoch 1648132975.1299968
Training time without total dataloading part /epoch 0.08458685874938965
load block tensor time/epoch 3.639882802963257
block to device time/epoch 6.519317626953125
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  40531339
Number of first layer input nodes during this epoch:  18224311
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 3.2504849433898926  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6526031494140625
range selection method range initialization spend 0.025614500045776367
time for parepare:  0.36126255989074707
local_output_nid generation:  0.006786823272705078
local_in_edges_tensor generation:  0.03964424133300781
mini_batch_src_global generation:  0.056847333908081055
r_  generation:  0.7840096950531006
local_output_nid generation:  0.007153511047363281
local_in_edges_tensor generation:  0.0191802978515625
mini_batch_src_global generation:  0.06838202476501465
r_  generation:  0.8642208576202393
local_output_nid generation:  0.007134437561035156
local_in_edges_tensor generation:  0.012485265731811523
mini_batch_src_global generation:  0.049015045166015625
r_  generation:  0.8930325508117676
local_output_nid generation:  0.007162809371948242
local_in_edges_tensor generation:  0.012385129928588867
mini_batch_src_global generation:  0.05637860298156738
r_  generation:  0.9613113403320312
local_output_nid generation:  0.008569478988647461
local_in_edges_tensor generation:  0.01309061050415039
mini_batch_src_global generation:  0.06251931190490723
r_  generation:  1.0078608989715576
local_output_nid generation:  0.0071887969970703125
local_in_edges_tensor generation:  0.012242555618286133
mini_batch_src_global generation:  0.06943249702453613
r_  generation:  1.0504834651947021
local_output_nid generation:  0.007167816162109375
local_in_edges_tensor generation:  0.012347936630249023
mini_batch_src_global generation:  0.07559847831726074
r_  generation:  1.0552849769592285
local_output_nid generation:  0.007187366485595703
local_in_edges_tensor generation:  0.0121002197265625
mini_batch_src_global generation:  0.08322405815124512
r_  generation:  1.0595486164093018
----------------------check_connections_block total spend ----------------------------- 9.932129859924316
generate_one_block  1.3937797546386719
generate_one_block  1.0197911262512207
generate_one_block  1.0199873447418213
generate_one_block  1.0126540660858154
generate_one_block  1.0177977085113525
generate_one_block  1.0344903469085693
generate_one_block  1.0245463848114014
generate_one_block  1.0161995887756348
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.32631778717041
gen group dst list time:  0.18506765365600586
time for parepare:  0.42623186111450195
local_output_nid generation:  0.150848388671875
local_in_edges_tensor generation:  0.8703567981719971
mini_batch_src_global generation:  1.276724100112915
r_  generation:  14.857808828353882
local_output_nid generation:  0.2378993034362793
local_in_edges_tensor generation:  0.9884810447692871
mini_batch_src_global generation:  1.6060504913330078
r_  generation:  16.18612790107727
local_output_nid generation:  0.2660961151123047
local_in_edges_tensor generation:  1.240365982055664
mini_batch_src_global generation:  1.6923630237579346
r_  generation:  15.563472986221313
local_output_nid generation:  0.2671995162963867
local_in_edges_tensor generation:  1.159412145614624
mini_batch_src_global generation:  1.8486659526824951
r_  generation:  15.797143697738647
local_output_nid generation:  0.2761678695678711
local_in_edges_tensor generation:  1.098799467086792
mini_batch_src_global generation:  1.820826768875122
r_  generation:  15.981577634811401
local_output_nid generation:  0.2892589569091797
local_in_edges_tensor generation:  1.1577823162078857
mini_batch_src_global generation:  1.704444408416748
r_  generation:  16.158767223358154
local_output_nid generation:  0.29125118255615234
local_in_edges_tensor generation:  1.1846730709075928
mini_batch_src_global generation:  1.733872890472412
r_  generation:  16.114731550216675
local_output_nid generation:  0.28565192222595215
local_in_edges_tensor generation:  1.1733927726745605
mini_batch_src_global generation:  1.655419111251831
r_  generation:  16.26370120048523
----------------------check_connections_block total spend ----------------------------- 172.80752968788147
generate_one_block  22.123565435409546
generate_one_block  21.888668060302734
generate_one_block  22.017584800720215
generate_one_block  21.981459617614746
generate_one_block  22.174668312072754
generate_one_block  21.888850450515747
generate_one_block  21.928504943847656
generate_one_block  21.92821478843689
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3141722679138184
gen group dst list time:  0.6267261505126953
time for parepare:  0.4814181327819824
local_output_nid generation:  0.5389952659606934
local_in_edges_tensor generation:  1.7355446815490723
mini_batch_src_global generation:  2.0290143489837646
r_  generation:  25.287823915481567
local_output_nid generation:  0.660977840423584
local_in_edges_tensor generation:  1.8574624061584473
mini_batch_src_global generation:  3.05326247215271
r_  generation:  25.497153759002686
local_output_nid generation:  0.6919898986816406
local_in_edges_tensor generation:  2.079267978668213
mini_batch_src_global generation:  3.075615882873535
r_  generation:  26.309277772903442
local_output_nid generation:  0.7149193286895752
local_in_edges_tensor generation:  1.963289737701416
mini_batch_src_global generation:  2.93428373336792
r_  generation:  25.838585376739502
local_output_nid generation:  0.7205474376678467
local_in_edges_tensor generation:  1.8800570964813232
mini_batch_src_global generation:  2.6762287616729736
r_  generation:  26.087836503982544
local_output_nid generation:  0.7155771255493164
local_in_edges_tensor generation:  1.9297370910644531
mini_batch_src_global generation:  3.166660785675049
r_  generation:  26.38593554496765
local_output_nid generation:  0.7227084636688232
local_in_edges_tensor generation:  1.9795424938201904
mini_batch_src_global generation:  3.003786325454712
r_  generation:  26.25540804862976
local_output_nid generation:  0.727400541305542
local_in_edges_tensor generation:  1.9407784938812256
mini_batch_src_global generation:  2.861820936203003
r_  generation:  26.433531284332275
----------------------check_connections_block total spend ----------------------------- 289.6403524875641
generate_one_block  34.801586389541626
generate_one_block  34.59017205238342
generate_one_block  34.61660695075989
generate_one_block  35.367528438568115
generate_one_block  34.478874921798706
generate_one_block  34.72844099998474
generate_one_block  34.54967975616455
generate_one_block  34.63239502906799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 3.2504849433898926  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

connection checking time:  462.44788217544556
block generation total time  453.69680094718933
average batch blocks generation time:  56.712100118398666
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6450448036193848  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.142000198364258  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6422991752624512  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.133605003356934  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6442480087280273  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.144779205322266  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6458992958068848  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.1452317237854  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6445965766906738  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes
Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.143113613128662  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6433730125427246  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.1404128074646  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6463727951049805  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.145012378692627  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 1.6450581550598145  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2137451171875 GB
    Memory Allocated: 4.1435322761535645  GigaBytes
Max Memory Allocated: 5.46472692489624  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.45042315125465393 |1.0033255219459534 |0.003917187452316284 |0.00014549493789672852 |0.005964457988739014 |0.0026845932006835938 |
----------------------------------------------------------pseudo_mini_loss sum 2.3725836277008057
Total (block generation + training)time/epoch 986.3651170134544
Training time/epoch 1648133966.577528
Training time without block to device /epoch 1648133958.5509238
Training time without total dataloading part /epoch 0.0829017162322998
load block tensor time/epoch 3.6033852100372314
block to device time/epoch 8.026604175567627
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  40526358
Number of first layer input nodes during this epoch:  18220883
