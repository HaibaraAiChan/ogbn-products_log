main start at this time 1647955173.1718276
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3246726989746094
range selection method range initialization spend 0.02969980239868164
time for parepare:  0.27833986282348633
local_output_nid generation:  0.0031938552856445312
local_in_edges_tensor generation:  0.02123856544494629
mini_batch_src_global generation:  0.014062643051147461
r_  generation:  0.18885111808776855
local_output_nid generation:  0.003748655319213867
local_in_edges_tensor generation:  0.0035936832427978516
mini_batch_src_global generation:  0.01911449432373047
r_  generation:  0.20727324485778809
local_output_nid generation:  0.0036706924438476562
local_in_edges_tensor generation:  0.00394892692565918
mini_batch_src_global generation:  0.013370037078857422
r_  generation:  0.21706390380859375
local_output_nid generation:  0.0037271976470947266
local_in_edges_tensor generation:  0.0037059783935546875
mini_batch_src_global generation:  0.013610363006591797
r_  generation:  0.22687339782714844
local_output_nid generation:  0.0036919116973876953
local_in_edges_tensor generation:  0.0034818649291992188
mini_batch_src_global generation:  0.013532161712646484
r_  generation:  0.2321302890777588
local_output_nid generation:  0.0037431716918945312
local_in_edges_tensor generation:  0.0047452449798583984
mini_batch_src_global generation:  0.01612997055053711
r_  generation:  0.24915099143981934
local_output_nid generation:  0.0036749839782714844
local_in_edges_tensor generation:  0.0033464431762695312
mini_batch_src_global generation:  0.01686692237854004
r_  generation:  0.2626821994781494
local_output_nid generation:  0.0036773681640625
local_in_edges_tensor generation:  0.0036439895629882812
mini_batch_src_global generation:  0.01717996597290039
r_  generation:  0.25932788848876953
local_output_nid generation:  0.003667593002319336
local_in_edges_tensor generation:  0.0034704208374023438
mini_batch_src_global generation:  0.016978740692138672
r_  generation:  0.2596285343170166
local_output_nid generation:  0.003656148910522461
local_in_edges_tensor generation:  0.003473997116088867
mini_batch_src_global generation:  0.01824212074279785
r_  generation:  0.2640812397003174
local_output_nid generation:  0.0036885738372802734
local_in_edges_tensor generation:  0.003625154495239258
mini_batch_src_global generation:  0.019699573516845703
r_  generation:  0.27329015731811523
local_output_nid generation:  0.0036857128143310547
local_in_edges_tensor generation:  0.0034279823303222656
mini_batch_src_global generation:  0.02022576332092285
r_  generation:  0.27538418769836426
local_output_nid generation:  0.0036673545837402344
local_in_edges_tensor generation:  0.003662586212158203
mini_batch_src_global generation:  0.02049112319946289
r_  generation:  0.27022480964660645
local_output_nid generation:  0.0037031173706054688
local_in_edges_tensor generation:  0.0034415721893310547
mini_batch_src_global generation:  0.02097344398498535
r_  generation:  0.27587223052978516
local_output_nid generation:  0.003676176071166992
local_in_edges_tensor generation:  0.003681182861328125
mini_batch_src_global generation:  0.021373271942138672
r_  generation:  0.27016258239746094
local_output_nid generation:  0.003677845001220703
local_in_edges_tensor generation:  0.0036394596099853516
mini_batch_src_global generation:  0.021301984786987305
r_  generation:  0.2699429988861084
----------------------check_connections_block total spend ----------------------------- 5.4336838722229
generate_one_block  5.451400518417358
generate_one_block  0.31225013732910156
generate_one_block  0.2904491424560547
generate_one_block  0.27668142318725586
generate_one_block  0.2744460105895996
generate_one_block  0.27529120445251465
generate_one_block  0.27719998359680176
generate_one_block  0.3155672550201416
generate_one_block  0.2860739231109619
generate_one_block  0.2793574333190918
generate_one_block  0.28067922592163086
generate_one_block  0.2765183448791504
generate_one_block  0.2797732353210449
generate_one_block  0.31899070739746094
generate_one_block  0.28304338455200195
generate_one_block  0.2741577625274658
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.081611394882202
gen group dst list time:  0.14815974235534668
time for parepare:  0.4529385566711426
local_output_nid generation:  0.07048320770263672
local_in_edges_tensor generation:  0.34223175048828125
mini_batch_src_global generation:  0.3565797805786133
r_  generation:  4.631788015365601
local_output_nid generation:  0.10049080848693848
local_in_edges_tensor generation:  0.4112248420715332
mini_batch_src_global generation:  0.46396303176879883
r_  generation:  4.761938095092773
local_output_nid generation:  0.1046152114868164
local_in_edges_tensor generation:  0.3320152759552002
mini_batch_src_global generation:  0.44594502449035645
r_  generation:  4.769613027572632
local_output_nid generation:  0.11597514152526855
local_in_edges_tensor generation:  0.3560824394226074
mini_batch_src_global generation:  0.43831682205200195
r_  generation:  4.9200780391693115
local_output_nid generation:  0.1024312973022461
local_in_edges_tensor generation:  0.27802467346191406
mini_batch_src_global generation:  0.47850775718688965
r_  generation:  4.918565511703491
local_output_nid generation:  0.1236121654510498
local_in_edges_tensor generation:  0.37255144119262695
mini_batch_src_global generation:  0.4564375877380371
r_  generation:  4.9187774658203125
local_output_nid generation:  0.11144733428955078
local_in_edges_tensor generation:  0.2876863479614258
mini_batch_src_global generation:  0.4658188819885254
r_  generation:  5.017931699752808
local_output_nid generation:  0.10778069496154785
local_in_edges_tensor generation:  0.28565192222595215
mini_batch_src_global generation:  0.4868123531341553
r_  generation:  4.924405097961426
local_output_nid generation:  0.13134264945983887
local_in_edges_tensor generation:  0.4187490940093994
mini_batch_src_global generation:  0.46645569801330566
r_  generation:  4.93015456199646
local_output_nid generation:  0.11498761177062988
local_in_edges_tensor generation:  0.29587674140930176
mini_batch_src_global generation:  0.4881143569946289
r_  generation:  5.150496959686279
local_output_nid generation:  0.11096835136413574
local_in_edges_tensor generation:  0.3023521900177002
mini_batch_src_global generation:  0.4770781993865967
r_  generation:  5.012061595916748
local_output_nid generation:  0.13476061820983887
local_in_edges_tensor generation:  0.3913257122039795
mini_batch_src_global generation:  0.4776017665863037
r_  generation:  4.947566986083984
local_output_nid generation:  0.11240029335021973
local_in_edges_tensor generation:  0.2990880012512207
mini_batch_src_global generation:  0.49529147148132324
r_  generation:  5.041162729263306
local_output_nid generation:  0.11253166198730469
local_in_edges_tensor generation:  0.2901473045349121
mini_batch_src_global generation:  0.49520421028137207
r_  generation:  5.003113269805908
local_output_nid generation:  0.13746953010559082
local_in_edges_tensor generation:  0.4187302589416504
mini_batch_src_global generation:  0.48673582077026367
r_  generation:  4.955582618713379
local_output_nid generation:  0.11363863945007324
local_in_edges_tensor generation:  0.3020665645599365
mini_batch_src_global generation:  0.4818081855773926
r_  generation:  5.044595718383789
----------------------check_connections_block total spend ----------------------------- 107.29973363876343
generate_one_block  6.769397735595703
generate_one_block  6.429591417312622
generate_one_block  6.079007387161255
generate_one_block  6.109135389328003
generate_one_block  6.0272886753082275
generate_one_block  6.45142126083374
generate_one_block  6.036343812942505
generate_one_block  6.07227349281311
generate_one_block  6.2031409740448
generate_one_block  6.426921606063843
generate_one_block  6.100711107254028
generate_one_block  6.061252117156982
generate_one_block  6.265878200531006
generate_one_block  6.23687219619751
generate_one_block  6.014871835708618
generate_one_block  6.056450128555298
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3217849731445312
gen group dst list time:  0.879542350769043
time for parepare:  0.4817688465118408
local_output_nid generation:  0.43941283226013184
local_in_edges_tensor generation:  1.174051284790039
mini_batch_src_global generation:  1.0421922206878662
r_  generation:  14.482255935668945
local_output_nid generation:  0.5235857963562012
local_in_edges_tensor generation:  1.1818888187408447
mini_batch_src_global generation:  1.4016335010528564
r_  generation:  14.197755813598633
local_output_nid generation:  0.520341157913208
local_in_edges_tensor generation:  1.134544849395752
mini_batch_src_global generation:  1.3555774688720703
r_  generation:  14.268163919448853
local_output_nid generation:  0.5212924480438232
local_in_edges_tensor generation:  1.065997838973999
mini_batch_src_global generation:  1.379411220550537
r_  generation:  14.352783203125
local_output_nid generation:  0.55124831199646
local_in_edges_tensor generation:  1.0482254028320312
mini_batch_src_global generation:  1.460810899734497
r_  generation:  14.47651982307434
local_output_nid generation:  0.5600717067718506
local_in_edges_tensor generation:  2.1552889347076416
mini_batch_src_global generation:  1.3205087184906006
r_  generation:  14.571985244750977
local_output_nid generation:  0.5217258930206299
local_in_edges_tensor generation:  1.1271169185638428
mini_batch_src_global generation:  1.3628315925598145
r_  generation:  14.365499258041382
local_output_nid generation:  0.5630955696105957
local_in_edges_tensor generation:  1.0114707946777344
mini_batch_src_global generation:  1.3770267963409424
r_  generation:  14.218735456466675
local_output_nid generation:  0.567791223526001
local_in_edges_tensor generation:  1.13309645652771
mini_batch_src_global generation:  1.3891427516937256
r_  generation:  14.602369785308838
local_output_nid generation:  0.5694067478179932
local_in_edges_tensor generation:  1.1333508491516113
mini_batch_src_global generation:  1.3493297100067139
r_  generation:  14.440706491470337
local_output_nid generation:  0.5296440124511719
local_in_edges_tensor generation:  1.150521993637085
mini_batch_src_global generation:  1.3797791004180908
r_  generation:  14.315140724182129
local_output_nid generation:  0.5497603416442871
local_in_edges_tensor generation:  1.0100314617156982
mini_batch_src_global generation:  1.375471830368042
r_  generation:  14.308701992034912
local_output_nid generation:  0.5708224773406982
local_in_edges_tensor generation:  1.137779712677002
mini_batch_src_global generation:  1.332707405090332
r_  generation:  14.449791431427002
local_output_nid generation:  0.5409324169158936
local_in_edges_tensor generation:  1.1512603759765625
mini_batch_src_global generation:  1.3633673191070557
r_  generation:  14.398393630981445
local_output_nid generation:  0.5422089099884033
local_in_edges_tensor generation:  1.0901894569396973
mini_batch_src_global generation:  1.380218744277954
r_  generation:  14.437525033950806
local_output_nid generation:  0.5641958713531494
local_in_edges_tensor generation:  1.0886061191558838
mini_batch_src_global generation:  1.3972480297088623
r_  generation:  14.233032703399658
----------------------check_connections_block total spend ----------------------------- 320.18142914772034
generate_one_block  19.007677793502808
generate_one_block  18.925772428512573
generate_one_block  18.92763352394104
generate_one_block  19.06789255142212
generate_one_block  19.056840419769287
generate_one_block  19.04582405090332
generate_one_block  19.755632162094116
generate_one_block  19.012702703475952
generate_one_block  19.023046493530273
generate_one_block  18.958005666732788
generate_one_block  18.996842861175537
generate_one_block  19.008193731307983
generate_one_block  18.94794797897339
generate_one_block  19.010164499282837
generate_one_block  18.94499158859253
generate_one_block  19.290196180343628
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  427.48116278648376
block generation total time  404.31992197036743
average batch blocks generation time:  25.269995123147964
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2293701171875 GB
    Memory Allocated: 1.1236271858215332  GigaBytes
Max Memory Allocated: 1.1236271858215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6063232421875 GB
    Memory Allocated: 2.561124324798584  GigaBytes
Max Memory Allocated: 2.991574764251709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5242919921875 GB
    Memory Allocated: 1.1280136108398438  GigaBytes
Max Memory Allocated: 3.292119026184082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8953857421875 GB
    Memory Allocated: 2.570793628692627  GigaBytes
Max Memory Allocated: 3.292119026184082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 1.128246784210205  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 2.566636085510254  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 1.1276988983154297  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 2.5670533180236816  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 1.127889633178711  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 2.5682029724121094  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 1.1275463104248047  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 2.567318916320801  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 1.1275634765625  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 2.564117908477783  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 1.128586769104004  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6903076171875 GB
    Memory Allocated: 2.560598373413086  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 1.1301169395446777  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 2.5720748901367188  GigaBytes
Max Memory Allocated: 3.30228328704834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 1.1273107528686523  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 2.565671920776367  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 1.1281967163085938  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 2.5665969848632812  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 1.127668857574463  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 2.565661907196045  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 1.1272497177124023  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 2.563587188720703  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4871826171875 GB
    Memory Allocated: 1.1308531761169434  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.57108736038208  GigaBytes
Max Memory Allocated: 3.304238796234131  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.127028465270996  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.56307315826416  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.127467155456543  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5618515014648438  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3319108337163925 |0.46527665853500366 |0.043554097414016724 |0.00014156103134155273 |0.03830483555793762 |0.0022652149200439453 |
----------------------------------------------------------pseudo_mini_loss sum 8.826183319091797
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64147260
Number of first layer input nodes during this epoch:  34051009
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.8106279373168945  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.43689560890197754
range selection method range initialization spend 0.0278933048248291
time for parepare:  0.28586530685424805
local_output_nid generation:  0.003031492233276367
local_in_edges_tensor generation:  0.02531886100769043
mini_batch_src_global generation:  0.014234304428100586
r_  generation:  0.18652772903442383
local_output_nid generation:  0.003717660903930664
local_in_edges_tensor generation:  0.0034914016723632812
mini_batch_src_global generation:  0.01877880096435547
r_  generation:  0.20783400535583496
local_output_nid generation:  0.0036706924438476562
local_in_edges_tensor generation:  0.0034246444702148438
mini_batch_src_global generation:  0.01234579086303711
r_  generation:  0.29000210762023926
local_output_nid generation:  0.005301237106323242
local_in_edges_tensor generation:  0.004341602325439453
mini_batch_src_global generation:  0.014071464538574219
r_  generation:  0.23493742942810059
local_output_nid generation:  0.003686189651489258
local_in_edges_tensor generation:  0.00643610954284668
mini_batch_src_global generation:  0.015533208847045898
r_  generation:  0.2515382766723633
local_output_nid generation:  0.0037157535552978516
local_in_edges_tensor generation:  0.004247903823852539
mini_batch_src_global generation:  0.015892505645751953
r_  generation:  0.25088047981262207
local_output_nid generation:  0.0036258697509765625
local_in_edges_tensor generation:  0.0035343170166015625
mini_batch_src_global generation:  0.017112255096435547
r_  generation:  0.2604813575744629
local_output_nid generation:  0.0037088394165039062
local_in_edges_tensor generation:  0.003560304641723633
mini_batch_src_global generation:  0.017395734786987305
r_  generation:  0.26206278800964355
local_output_nid generation:  0.0036618709564208984
local_in_edges_tensor generation:  0.0034618377685546875
mini_batch_src_global generation:  0.017447471618652344
r_  generation:  0.26394224166870117
local_output_nid generation:  0.003705263137817383
local_in_edges_tensor generation:  0.003444671630859375
mini_batch_src_global generation:  0.018261194229125977
r_  generation:  0.26862049102783203
local_output_nid generation:  0.0036840438842773438
local_in_edges_tensor generation:  0.0035812854766845703
mini_batch_src_global generation:  0.020054101943969727
r_  generation:  0.28630518913269043
local_output_nid generation:  0.003693819046020508
local_in_edges_tensor generation:  0.0158083438873291
mini_batch_src_global generation:  0.020209312438964844
r_  generation:  0.3132965564727783
local_output_nid generation:  0.003815174102783203
local_in_edges_tensor generation:  0.0040967464447021484
mini_batch_src_global generation:  0.020717859268188477
r_  generation:  0.27469348907470703
local_output_nid generation:  0.003811359405517578
local_in_edges_tensor generation:  0.004195451736450195
mini_batch_src_global generation:  0.02063274383544922
r_  generation:  0.2896547317504883
local_output_nid generation:  0.003816843032836914
local_in_edges_tensor generation:  0.004109621047973633
mini_batch_src_global generation:  0.021116971969604492
r_  generation:  0.2827775478363037
local_output_nid generation:  0.003762960433959961
local_in_edges_tensor generation:  0.00867462158203125
mini_batch_src_global generation:  0.021698951721191406
r_  generation:  0.2850916385650635
----------------------check_connections_block total spend ----------------------------- 5.7232666015625
generate_one_block  0.6112935543060303
generate_one_block  0.32575058937072754
generate_one_block  0.2930757999420166
generate_one_block  0.29732394218444824
generate_one_block  0.28722333908081055
generate_one_block  0.27942991256713867
generate_one_block  0.27701640129089355
generate_one_block  0.2776792049407959
generate_one_block  0.27710819244384766
generate_one_block  0.27674126625061035
generate_one_block  0.28154611587524414
generate_one_block  0.27945804595947266
generate_one_block  0.2848677635192871
generate_one_block  0.27990198135375977
generate_one_block  0.2992134094238281
generate_one_block  0.2848072052001953
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2007896900177
gen group dst list time:  0.17752456665039062
time for parepare:  0.4724090099334717
local_output_nid generation:  0.07199883460998535
local_in_edges_tensor generation:  0.3486754894256592
mini_batch_src_global generation:  0.3511166572570801
r_  generation:  4.512847185134888
local_output_nid generation:  0.09357285499572754
local_in_edges_tensor generation:  0.31618356704711914
mini_batch_src_global generation:  0.44083738327026367
r_  generation:  4.93316388130188
local_output_nid generation:  0.1082310676574707
local_in_edges_tensor generation:  0.2793691158294678
mini_batch_src_global generation:  0.41376614570617676
r_  generation:  4.798013925552368
local_output_nid generation:  0.10883617401123047
local_in_edges_tensor generation:  0.42937231063842773
mini_batch_src_global generation:  0.45598602294921875
r_  generation:  5.028567790985107
local_output_nid generation:  0.10828065872192383
local_in_edges_tensor generation:  0.2900350093841553
mini_batch_src_global generation:  0.4969635009765625
r_  generation:  4.952677011489868
local_output_nid generation:  0.11254191398620605
local_in_edges_tensor generation:  0.3326754570007324
mini_batch_src_global generation:  0.4604048728942871
r_  generation:  5.103118181228638
local_output_nid generation:  0.10713672637939453
local_in_edges_tensor generation:  0.38265228271484375
mini_batch_src_global generation:  0.4919776916503906
r_  generation:  5.004808187484741
local_output_nid generation:  0.12923598289489746
local_in_edges_tensor generation:  0.3246614933013916
mini_batch_src_global generation:  0.47046661376953125
r_  generation:  5.069182872772217
local_output_nid generation:  0.10930848121643066
local_in_edges_tensor generation:  0.35855746269226074
mini_batch_src_global generation:  0.4900221824645996
r_  generation:  5.0849385261535645
local_output_nid generation:  0.1330585479736328
local_in_edges_tensor generation:  0.3007979393005371
mini_batch_src_global generation:  0.4754672050476074
r_  generation:  5.047422885894775
local_output_nid generation:  0.11985278129577637
local_in_edges_tensor generation:  0.39713168144226074
mini_batch_src_global generation:  0.5271604061126709
r_  generation:  5.244104623794556
local_output_nid generation:  0.13837528228759766
local_in_edges_tensor generation:  0.2961997985839844
mini_batch_src_global generation:  0.47774696350097656
r_  generation:  5.089609146118164
local_output_nid generation:  0.1126558780670166
local_in_edges_tensor generation:  0.4083104133605957
mini_batch_src_global generation:  0.48517394065856934
r_  generation:  5.177006959915161
local_output_nid generation:  0.11779046058654785
local_in_edges_tensor generation:  0.2961878776550293
mini_batch_src_global generation:  0.5193028450012207
r_  generation:  5.11182713508606
local_output_nid generation:  0.1397716999053955
local_in_edges_tensor generation:  0.2962162494659424
mini_batch_src_global generation:  0.47812700271606445
r_  generation:  5.044527053833008
local_output_nid generation:  0.1159663200378418
local_in_edges_tensor generation:  0.41461849212646484
mini_batch_src_global generation:  0.5046403408050537
r_  generation:  5.21666693687439
----------------------check_connections_block total spend ----------------------------- 109.22105526924133
generate_one_block  6.561819791793823
generate_one_block  6.527789354324341
generate_one_block  6.239573955535889
generate_one_block  6.511598348617554
generate_one_block  6.196933746337891
generate_one_block  6.548609733581543
generate_one_block  6.332666397094727
generate_one_block  6.696699380874634
generate_one_block  6.553362846374512
generate_one_block  6.282002687454224
generate_one_block  6.5112059116363525
generate_one_block  6.2302374839782715
generate_one_block  6.388129949569702
generate_one_block  6.302789688110352
generate_one_block  6.162506103515625
generate_one_block  6.504214286804199
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.371621608734131
gen group dst list time:  0.9139370918273926
time for parepare:  0.4872550964355469
local_output_nid generation:  0.4553101062774658
local_in_edges_tensor generation:  1.1882832050323486
mini_batch_src_global generation:  1.0234079360961914
r_  generation:  14.102368354797363
local_output_nid generation:  0.5355596542358398
local_in_edges_tensor generation:  1.1800620555877686
mini_batch_src_global generation:  1.4146924018859863
r_  generation:  14.055898427963257
local_output_nid generation:  0.5568218231201172
local_in_edges_tensor generation:  1.2961881160736084
mini_batch_src_global generation:  1.4731857776641846
r_  generation:  14.386634349822998
local_output_nid generation:  0.5605373382568359
local_in_edges_tensor generation:  1.1194887161254883
mini_batch_src_global generation:  1.3071329593658447
r_  generation:  14.61072564125061
local_output_nid generation:  0.5484471321105957
local_in_edges_tensor generation:  1.155043363571167
mini_batch_src_global generation:  1.3251807689666748
r_  generation:  14.71010684967041
local_output_nid generation:  0.553302526473999
local_in_edges_tensor generation:  1.1352486610412598
mini_batch_src_global generation:  1.3966796398162842
r_  generation:  14.833407878875732
local_output_nid generation:  0.5844674110412598
local_in_edges_tensor generation:  1.1398324966430664
mini_batch_src_global generation:  1.6550734043121338
r_  generation:  15.119889497756958
local_output_nid generation:  0.5771455764770508
local_in_edges_tensor generation:  1.1455063819885254
mini_batch_src_global generation:  1.3446381092071533
r_  generation:  14.559141635894775
local_output_nid generation:  0.5770699977874756
local_in_edges_tensor generation:  1.1418282985687256
mini_batch_src_global generation:  1.3133575916290283
r_  generation:  14.476162672042847
local_output_nid generation:  0.5471699237823486
local_in_edges_tensor generation:  1.1405658721923828
mini_batch_src_global generation:  1.330265998840332
r_  generation:  14.509794473648071
local_output_nid generation:  0.5502729415893555
local_in_edges_tensor generation:  1.141002893447876
mini_batch_src_global generation:  1.3766906261444092
r_  generation:  14.4668869972229
local_output_nid generation:  0.5678725242614746
local_in_edges_tensor generation:  1.0738065242767334
mini_batch_src_global generation:  1.4263038635253906
r_  generation:  14.341762065887451
local_output_nid generation:  0.5709836483001709
local_in_edges_tensor generation:  1.0916669368743896
mini_batch_src_global generation:  1.4333224296569824
r_  generation:  14.403073072433472
local_output_nid generation:  0.5740342140197754
local_in_edges_tensor generation:  2.6777005195617676
mini_batch_src_global generation:  1.3298721313476562
r_  generation:  14.121196031570435
local_output_nid generation:  0.5789918899536133
local_in_edges_tensor generation:  1.1491508483886719
mini_batch_src_global generation:  1.4712026119232178
r_  generation:  14.410700559616089
local_output_nid generation:  0.5708606243133545
local_in_edges_tensor generation:  1.144233226776123
mini_batch_src_global generation:  1.3291912078857422
r_  generation:  14.603492975234985
----------------------check_connections_block total spend ----------------------------- 323.7913649082184
generate_one_block  19.109721422195435
generate_one_block  19.181217432022095
generate_one_block  18.81496238708496
generate_one_block  19.23703908920288
generate_one_block  19.205672025680542
generate_one_block  19.14704942703247
generate_one_block  19.187628269195557
generate_one_block  19.607177734375
generate_one_block  19.12917733192444
generate_one_block  19.282010078430176
generate_one_block  19.173322200775146
generate_one_block  19.108702421188354
generate_one_block  19.131998300552368
generate_one_block  19.149120569229126
generate_one_block  19.390713691711426
generate_one_block  19.211660623550415
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.8106279373168945  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

connection checking time:  433.0124201774597
block generation total time  409.617312669754
average batch blocks generation time:  25.601082041859627
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1262121200561523  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5610594749450684  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1278448104858398  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5679702758789062  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1282072067260742  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.568605422973633  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1284832954406738  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5696043968200684  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1275615692138672  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.564431667327881  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.562633991241455  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1274633407592773  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.56620454788208  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1280779838562012  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5685763359069824  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1277146339416504  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.564121723175049  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.129518985748291  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.572220802307129  GigaBytes
Max Memory Allocated: 3.3051042556762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1286015510559082  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.569983959197998  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1275005340576172  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5675973892211914  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1287188529968262  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5698652267456055  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1259455680847168  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.561124801635742  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.12852144241333  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5675106048583984  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.128554344177246  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5666399002075195  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.33239151537418365 |0.28671225905418396 |0.004100874066352844 |0.00013215839862823486 |0.004823356866836548 |0.00279998779296875 |
----------------------------------------------------------pseudo_mini_loss sum 5.146344184875488
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64166070
Number of first layer input nodes during this epoch:  34055419
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.815049648284912  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32779693603515625
range selection method range initialization spend 0.02713298797607422
time for parepare:  0.2822551727294922
local_output_nid generation:  0.0031616687774658203
local_in_edges_tensor generation:  0.02136993408203125
mini_batch_src_global generation:  0.016579389572143555
r_  generation:  0.2452247142791748
local_output_nid generation:  0.003844022750854492
local_in_edges_tensor generation:  0.005867958068847656
mini_batch_src_global generation:  0.019718170166015625
r_  generation:  0.21152901649475098
local_output_nid generation:  0.003692626953125
local_in_edges_tensor generation:  0.004558563232421875
mini_batch_src_global generation:  0.013476133346557617
r_  generation:  0.23472094535827637
local_output_nid generation:  0.003737211227416992
local_in_edges_tensor generation:  0.0034551620483398438
mini_batch_src_global generation:  0.013626813888549805
r_  generation:  0.23816323280334473
local_output_nid generation:  0.0036928653717041016
local_in_edges_tensor generation:  0.005969047546386719
mini_batch_src_global generation:  0.013768434524536133
r_  generation:  0.2504696846008301
local_output_nid generation:  0.00374603271484375
local_in_edges_tensor generation:  0.004532814025878906
mini_batch_src_global generation:  0.028609752655029297
r_  generation:  0.2633488178253174
local_output_nid generation:  0.003683328628540039
local_in_edges_tensor generation:  0.0034880638122558594
mini_batch_src_global generation:  0.017426013946533203
r_  generation:  0.27422118186950684
local_output_nid generation:  0.003784656524658203
local_in_edges_tensor generation:  0.003605365753173828
mini_batch_src_global generation:  0.018902301788330078
r_  generation:  0.2779552936553955
local_output_nid generation:  0.0037004947662353516
local_in_edges_tensor generation:  0.004078865051269531
mini_batch_src_global generation:  0.01927947998046875
r_  generation:  0.2788205146789551
local_output_nid generation:  0.003740072250366211
local_in_edges_tensor generation:  0.003430604934692383
mini_batch_src_global generation:  0.020657777786254883
r_  generation:  0.28597497940063477
local_output_nid generation:  0.003715991973876953
local_in_edges_tensor generation:  0.0034401416778564453
mini_batch_src_global generation:  0.020824909210205078
r_  generation:  0.2899627685546875
local_output_nid generation:  0.0037202835083007812
local_in_edges_tensor generation:  0.003459930419921875
mini_batch_src_global generation:  0.02268195152282715
r_  generation:  0.2961905002593994
local_output_nid generation:  0.003700733184814453
local_in_edges_tensor generation:  0.0041429996490478516
mini_batch_src_global generation:  0.02235865592956543
r_  generation:  0.2921020984649658
local_output_nid generation:  0.0037415027618408203
local_in_edges_tensor generation:  0.0035321712493896484
mini_batch_src_global generation:  0.02345132827758789
r_  generation:  0.30005621910095215
local_output_nid generation:  0.0038492679595947266
local_in_edges_tensor generation:  0.0040929317474365234
mini_batch_src_global generation:  0.02260279655456543
r_  generation:  0.29211902618408203
local_output_nid generation:  0.003838062286376953
local_in_edges_tensor generation:  0.003500699996948242
mini_batch_src_global generation:  0.023350238800048828
r_  generation:  0.29221296310424805
----------------------check_connections_block total spend ----------------------------- 5.873633146286011
generate_one_block  0.6032505035400391
generate_one_block  0.340531587600708
generate_one_block  0.3021392822265625
generate_one_block  0.2920863628387451
generate_one_block  0.2957463264465332
generate_one_block  0.2837207317352295
generate_one_block  0.35963988304138184
generate_one_block  0.4931631088256836
generate_one_block  0.3655984401702881
generate_one_block  0.3099558353424072
generate_one_block  0.30126309394836426
generate_one_block  0.2953495979309082
generate_one_block  0.29459428787231445
generate_one_block  0.29163646697998047
generate_one_block  0.28887391090393066
generate_one_block  0.27941465377807617
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0645487308502197
gen group dst list time:  0.14932632446289062
time for parepare:  0.41712379455566406
local_output_nid generation:  0.07384824752807617
local_in_edges_tensor generation:  0.2680652141571045
mini_batch_src_global generation:  0.3333117961883545
r_  generation:  4.6145782470703125
local_output_nid generation:  0.09726214408874512
local_in_edges_tensor generation:  0.3545854091644287
mini_batch_src_global generation:  0.4394841194152832
r_  generation:  4.69268536567688
local_output_nid generation:  0.11166501045227051
local_in_edges_tensor generation:  0.2558929920196533
mini_batch_src_global generation:  0.41416358947753906
r_  generation:  4.921361446380615
local_output_nid generation:  0.13024306297302246
local_in_edges_tensor generation:  0.32779550552368164
mini_batch_src_global generation:  0.4499039649963379
r_  generation:  4.807062864303589
local_output_nid generation:  0.10945534706115723
local_in_edges_tensor generation:  0.2815737724304199
mini_batch_src_global generation:  0.44561171531677246
r_  generation:  4.899393081665039
local_output_nid generation:  0.1161201000213623
local_in_edges_tensor generation:  0.24704813957214355
mini_batch_src_global generation:  0.4684128761291504
r_  generation:  5.009552955627441
local_output_nid generation:  0.1121978759765625
local_in_edges_tensor generation:  0.3999600410461426
mini_batch_src_global generation:  0.5280556678771973
r_  generation:  4.911156177520752
local_output_nid generation:  0.12027931213378906
local_in_edges_tensor generation:  0.27387094497680664
mini_batch_src_global generation:  0.46854162216186523
r_  generation:  4.943193674087524
local_output_nid generation:  0.12323880195617676
local_in_edges_tensor generation:  0.28946447372436523
mini_batch_src_global generation:  0.46920228004455566
r_  generation:  4.96950626373291
local_output_nid generation:  0.11516165733337402
local_in_edges_tensor generation:  0.3579697608947754
mini_batch_src_global generation:  0.49601006507873535
r_  generation:  5.168537616729736
local_output_nid generation:  0.13340044021606445
local_in_edges_tensor generation:  0.33593010902404785
mini_batch_src_global generation:  0.47728419303894043
r_  generation:  4.989608287811279
local_output_nid generation:  0.12549996376037598
local_in_edges_tensor generation:  0.2978222370147705
mini_batch_src_global generation:  0.4822375774383545
r_  generation:  5.019503831863403
local_output_nid generation:  0.11837959289550781
local_in_edges_tensor generation:  0.29260897636413574
mini_batch_src_global generation:  0.5013258457183838
r_  generation:  5.1649391651153564
local_output_nid generation:  0.1365056037902832
local_in_edges_tensor generation:  0.40715551376342773
mini_batch_src_global generation:  0.4808952808380127
r_  generation:  4.991020917892456
local_output_nid generation:  0.11898183822631836
local_in_edges_tensor generation:  0.3001277446746826
mini_batch_src_global generation:  0.4841139316558838
r_  generation:  5.00826621055603
local_output_nid generation:  0.12613821029663086
local_in_edges_tensor generation:  0.2926766872406006
mini_batch_src_global generation:  0.48378705978393555
r_  generation:  5.056921005249023
----------------------check_connections_block total spend ----------------------------- 107.05279922485352
generate_one_block  6.742192983627319
generate_one_block  6.773763179779053
generate_one_block  6.126161336898804
generate_one_block  6.238683223724365
generate_one_block  6.516812324523926
generate_one_block  6.167901992797852
generate_one_block  6.105306386947632
generate_one_block  6.232701778411865
generate_one_block  6.552610635757446
generate_one_block  6.240194082260132
generate_one_block  6.220752716064453
generate_one_block  6.27122163772583
generate_one_block  6.552484750747681
generate_one_block  6.167388200759888
generate_one_block  6.275173187255859
generate_one_block  6.372138738632202
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.270655393600464
gen group dst list time:  0.8649387359619141
time for parepare:  0.4729607105255127
local_output_nid generation:  0.4624919891357422
local_in_edges_tensor generation:  1.0960707664489746
mini_batch_src_global generation:  1.0297486782073975
r_  generation:  14.170754671096802
local_output_nid generation:  0.5365262031555176
local_in_edges_tensor generation:  1.3118224143981934
mini_batch_src_global generation:  1.4533116817474365
r_  generation:  14.07080364227295
local_output_nid generation:  0.538754940032959
local_in_edges_tensor generation:  1.0513513088226318
mini_batch_src_global generation:  1.3958261013031006
r_  generation:  14.261586904525757
local_output_nid generation:  0.5491530895233154
local_in_edges_tensor generation:  1.1119208335876465
mini_batch_src_global generation:  1.3984005451202393
r_  generation:  14.324105501174927
local_output_nid generation:  0.5646402835845947
local_in_edges_tensor generation:  1.0805175304412842
mini_batch_src_global generation:  1.3291285037994385
r_  generation:  14.674242496490479
local_output_nid generation:  0.5592038631439209
local_in_edges_tensor generation:  1.1276335716247559
mini_batch_src_global generation:  1.3388962745666504
r_  generation:  14.571423768997192
local_output_nid generation:  0.5445904731750488
local_in_edges_tensor generation:  1.1598081588745117
mini_batch_src_global generation:  1.4018442630767822
r_  generation:  14.342119932174683
local_output_nid generation:  0.56813645362854
local_in_edges_tensor generation:  1.0856599807739258
mini_batch_src_global generation:  1.4706699848175049
r_  generation:  14.323814392089844
local_output_nid generation:  0.5852484703063965
local_in_edges_tensor generation:  1.08424711227417
mini_batch_src_global generation:  1.5700807571411133
r_  generation:  14.963688373565674
local_output_nid generation:  0.5927712917327881
local_in_edges_tensor generation:  1.18853759765625
mini_batch_src_global generation:  1.4820411205291748
r_  generation:  14.652390956878662
local_output_nid generation:  0.583930492401123
local_in_edges_tensor generation:  1.1679649353027344
mini_batch_src_global generation:  1.4413280487060547
r_  generation:  14.42646336555481
local_output_nid generation:  0.5804684162139893
local_in_edges_tensor generation:  1.0953466892242432
mini_batch_src_global generation:  1.4745914936065674
r_  generation:  14.320705652236938
local_output_nid generation:  0.5971224308013916
local_in_edges_tensor generation:  1.0898048877716064
mini_batch_src_global generation:  1.4253573417663574
r_  generation:  14.58345913887024
local_output_nid generation:  0.5882997512817383
local_in_edges_tensor generation:  2.56720232963562
mini_batch_src_global generation:  1.336604356765747
r_  generation:  14.755595922470093
local_output_nid generation:  0.5896503925323486
local_in_edges_tensor generation:  1.1535470485687256
mini_batch_src_global generation:  1.343367338180542
r_  generation:  14.579593658447266
local_output_nid generation:  0.5687122344970703
local_in_edges_tensor generation:  1.094921588897705
mini_batch_src_global generation:  1.47529935836792
r_  generation:  14.275089025497437
----------------------check_connections_block total spend ----------------------------- 323.1711673736572
generate_one_block  19.26490807533264
generate_one_block  19.19360899925232
generate_one_block  19.29442024230957
generate_one_block  19.406609058380127
generate_one_block  19.474867582321167
generate_one_block  19.444613933563232
generate_one_block  18.915034532546997
generate_one_block  19.243284463882446
generate_one_block  19.123202323913574
generate_one_block  19.223113775253296
generate_one_block  19.356455326080322
generate_one_block  19.406830549240112
generate_one_block  19.302436351776123
generate_one_block  18.858622789382935
generate_one_block  19.284921646118164
generate_one_block  19.098201990127563
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.815049648284912  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

connection checking time:  430.22396659851074
block generation total time  409.4466187953949
average batch blocks generation time:  25.59041367471218
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1285295486450195  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5689802169799805  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1268596649169922  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5626068115234375  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.128514289855957  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.569152355194092  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1283011436462402  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5659642219543457  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1276931762695312  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.568060874938965  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1287035942077637  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.568814754486084  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.125807762145996  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5591893196105957  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1278557777404785  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.564121723175049  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1256089210510254  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5595908164978027  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1282987594604492  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.565394401550293  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.130518913269043  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.571232795715332  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1287693977355957  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5678892135620117  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1291108131408691  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5692453384399414  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1283831596374512  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.570225715637207  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1308403015136719  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5764403343200684  GigaBytes
Max Memory Allocated: 3.306248188018799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1292896270751953  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5704503059387207  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3333839327096939 |0.35992661118507385 |0.004208281636238098 |0.00013370811939239502 |0.010776668787002563 |0.0028553009033203125 |
----------------------------------------------------------pseudo_mini_loss sum 3.7312281131744385
Total (block generation + training)time/epoch 891.5103371143341
Training time/epoch 1647957890.8626604
Training time without block to device /epoch 1647957885.1038346
Training time without total dataloading part /epoch 0.24475383758544922
load block tensor time/epoch 5.3341429233551025
block to device time/epoch 5.758825778961182
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  64172700
Number of first layer input nodes during this epoch:  34057371
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.8154301643371582  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.31197214126586914
range selection method range initialization spend 0.036530256271362305
time for parepare:  0.30658435821533203
local_output_nid generation:  0.0032613277435302734
local_in_edges_tensor generation:  0.021577119827270508
mini_batch_src_global generation:  0.015562295913696289
r_  generation:  0.1885676383972168
local_output_nid generation:  0.0039293766021728516
local_in_edges_tensor generation:  0.004738569259643555
mini_batch_src_global generation:  0.018975019454956055
r_  generation:  0.21179485321044922
local_output_nid generation:  0.003856182098388672
local_in_edges_tensor generation:  0.0034580230712890625
mini_batch_src_global generation:  0.012333869934082031
r_  generation:  0.2214493751525879
local_output_nid generation:  0.0038444995880126953
local_in_edges_tensor generation:  0.0034952163696289062
mini_batch_src_global generation:  0.0130767822265625
r_  generation:  0.31046032905578613
local_output_nid generation:  0.007768392562866211
local_in_edges_tensor generation:  0.007959127426147461
mini_batch_src_global generation:  0.017174482345581055
r_  generation:  0.23957419395446777
local_output_nid generation:  0.003969907760620117
local_in_edges_tensor generation:  0.003594636917114258
mini_batch_src_global generation:  0.0157928466796875
r_  generation:  0.25207090377807617
local_output_nid generation:  0.005507707595825195
local_in_edges_tensor generation:  0.004037380218505859
mini_batch_src_global generation:  0.016579389572143555
r_  generation:  0.2614619731903076
local_output_nid generation:  0.003847360610961914
local_in_edges_tensor generation:  0.004030942916870117
mini_batch_src_global generation:  0.01713252067565918
r_  generation:  0.2660858631134033
local_output_nid generation:  0.00394439697265625
local_in_edges_tensor generation:  0.0040130615234375
mini_batch_src_global generation:  0.0171661376953125
r_  generation:  0.26660799980163574
local_output_nid generation:  0.0038564205169677734
local_in_edges_tensor generation:  0.004038095474243164
mini_batch_src_global generation:  0.019187450408935547
r_  generation:  0.2650260925292969
local_output_nid generation:  0.0038640499114990234
local_in_edges_tensor generation:  0.004036426544189453
mini_batch_src_global generation:  0.019745826721191406
r_  generation:  0.27649354934692383
local_output_nid generation:  0.003811359405517578
local_in_edges_tensor generation:  0.004664897918701172
mini_batch_src_global generation:  0.019960403442382812
r_  generation:  0.2771468162536621
local_output_nid generation:  0.003989458084106445
local_in_edges_tensor generation:  0.003538370132446289
mini_batch_src_global generation:  0.02065587043762207
r_  generation:  0.2730114459991455
local_output_nid generation:  0.003916263580322266
local_in_edges_tensor generation:  0.004145145416259766
mini_batch_src_global generation:  0.020711183547973633
r_  generation:  0.27445363998413086
local_output_nid generation:  0.005866289138793945
local_in_edges_tensor generation:  0.00402069091796875
mini_batch_src_global generation:  0.021881818771362305
r_  generation:  0.2828044891357422
local_output_nid generation:  0.004052877426147461
local_in_edges_tensor generation:  0.004197835922241211
mini_batch_src_global generation:  0.021652936935424805
r_  generation:  0.274519681930542
----------------------check_connections_block total spend ----------------------------- 5.664820432662964
generate_one_block  0.5945687294006348
generate_one_block  0.34645891189575195
generate_one_block  0.3048868179321289
generate_one_block  0.3027503490447998
generate_one_block  0.29802656173706055
generate_one_block  0.2926337718963623
generate_one_block  0.2938213348388672
generate_one_block  0.289639949798584
generate_one_block  0.30695247650146484
generate_one_block  0.4666616916656494
generate_one_block  0.46227288246154785
generate_one_block  0.32700252532958984
generate_one_block  0.29444146156311035
generate_one_block  0.28867483139038086
generate_one_block  0.2986130714416504
generate_one_block  0.28900575637817383
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.125004768371582
gen group dst list time:  0.15659809112548828
time for parepare:  0.44319772720336914
local_output_nid generation:  0.07817602157592773
local_in_edges_tensor generation:  0.32786083221435547
mini_batch_src_global generation:  0.346343994140625
r_  generation:  4.666268348693848
local_output_nid generation:  0.0937812328338623
local_in_edges_tensor generation:  0.43617987632751465
mini_batch_src_global generation:  0.47579503059387207
r_  generation:  4.632483720779419
local_output_nid generation:  0.10715055465698242
local_in_edges_tensor generation:  0.2870166301727295
mini_batch_src_global generation:  0.4281141757965088
r_  generation:  5.0044801235198975
local_output_nid generation:  0.1333296298980713
local_in_edges_tensor generation:  0.36347174644470215
mini_batch_src_global generation:  0.45465850830078125
r_  generation:  4.820780992507935
local_output_nid generation:  0.10706615447998047
local_in_edges_tensor generation:  0.2832980155944824
mini_batch_src_global generation:  0.45618295669555664
r_  generation:  4.930195093154907
local_output_nid generation:  0.1107640266418457
local_in_edges_tensor generation:  0.2936971187591553
mini_batch_src_global generation:  0.5568115711212158
r_  generation:  5.626487731933594
local_output_nid generation:  0.13219118118286133
local_in_edges_tensor generation:  0.3959376811981201
mini_batch_src_global generation:  0.47258758544921875
r_  generation:  5.099414587020874
local_output_nid generation:  0.1224222183227539
local_in_edges_tensor generation:  0.3915865421295166
mini_batch_src_global generation:  0.5783684253692627
r_  generation:  4.937954902648926
local_output_nid generation:  0.12868428230285645
local_in_edges_tensor generation:  0.30460643768310547
mini_batch_src_global generation:  0.47323179244995117
r_  generation:  4.93799090385437
local_output_nid generation:  0.11552596092224121
local_in_edges_tensor generation:  0.2959716320037842
mini_batch_src_global generation:  0.48223137855529785
r_  generation:  5.028881311416626
local_output_nid generation:  0.11561870574951172
local_in_edges_tensor generation:  0.4003002643585205
mini_batch_src_global generation:  0.5348625183105469
r_  generation:  5.114878416061401
local_output_nid generation:  0.14025425910949707
local_in_edges_tensor generation:  0.2958202362060547
mini_batch_src_global generation:  0.4785165786743164
r_  generation:  4.9741997718811035
local_output_nid generation:  0.11686873435974121
local_in_edges_tensor generation:  0.2924675941467285
mini_batch_src_global generation:  0.48015332221984863
r_  generation:  5.063978910446167
local_output_nid generation:  0.12816524505615234
local_in_edges_tensor generation:  0.29953789710998535
mini_batch_src_global generation:  0.4938240051269531
r_  generation:  5.1925318241119385
local_output_nid generation:  0.14660406112670898
local_in_edges_tensor generation:  0.4249913692474365
mini_batch_src_global generation:  0.4795711040496826
r_  generation:  4.978710889816284
local_output_nid generation:  0.11883330345153809
local_in_edges_tensor generation:  0.30608415603637695
mini_batch_src_global generation:  0.4816269874572754
r_  generation:  4.9952685832977295
----------------------check_connections_block total spend ----------------------------- 108.83225202560425
generate_one_block  6.699786424636841
generate_one_block  6.827239274978638
generate_one_block  6.230883836746216
generate_one_block  6.240471839904785
generate_one_block  6.24187707901001
generate_one_block  6.567826271057129
generate_one_block  6.146685600280762
generate_one_block  6.209521293640137
generate_one_block  6.252715587615967
generate_one_block  6.62804913520813
generate_one_block  6.165367841720581
generate_one_block  6.181483745574951
generate_one_block  6.254597187042236
generate_one_block  6.534403085708618
generate_one_block  6.188473224639893
generate_one_block  6.247692584991455
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2938878536224365
gen group dst list time:  0.8791306018829346
time for parepare:  0.4684581756591797
local_output_nid generation:  0.4581296443939209
local_in_edges_tensor generation:  1.106226921081543
mini_batch_src_global generation:  1.0260133743286133
r_  generation:  14.082703113555908
local_output_nid generation:  0.5524387359619141
local_in_edges_tensor generation:  1.1234140396118164
mini_batch_src_global generation:  1.5361685752868652
r_  generation:  15.19773268699646
local_output_nid generation:  0.5439014434814453
local_in_edges_tensor generation:  1.3124096393585205
mini_batch_src_global generation:  1.3807966709136963
r_  generation:  14.519388198852539
local_output_nid generation:  0.5300614833831787
local_in_edges_tensor generation:  1.1491725444793701
mini_batch_src_global generation:  1.4385614395141602
r_  generation:  14.170722961425781
local_output_nid generation:  0.5653200149536133
local_in_edges_tensor generation:  0.9991836547851562
mini_batch_src_global generation:  1.3757057189941406
r_  generation:  14.441983461380005
local_output_nid generation:  0.5541179180145264
local_in_edges_tensor generation:  1.1479904651641846
mini_batch_src_global generation:  1.3478243350982666
r_  generation:  14.30344820022583
local_output_nid generation:  0.5466616153717041
local_in_edges_tensor generation:  1.1441311836242676
mini_batch_src_global generation:  1.431948184967041
r_  generation:  14.457535743713379
local_output_nid generation:  0.575676679611206
local_in_edges_tensor generation:  1.0096304416656494
mini_batch_src_global generation:  1.3482134342193604
r_  generation:  14.533137559890747
local_output_nid generation:  0.5436041355133057
local_in_edges_tensor generation:  1.161388874053955
mini_batch_src_global generation:  1.359471082687378
r_  generation:  14.210165977478027
local_output_nid generation:  0.5504755973815918
local_in_edges_tensor generation:  1.1545379161834717
mini_batch_src_global generation:  1.396606683731079
r_  generation:  14.204997301101685
local_output_nid generation:  0.5726394653320312
local_in_edges_tensor generation:  1.0121982097625732
mini_batch_src_global generation:  1.4219465255737305
r_  generation:  14.452690839767456
local_output_nid generation:  0.5554032325744629
local_in_edges_tensor generation:  1.1850783824920654
mini_batch_src_global generation:  1.3570942878723145
r_  generation:  14.275629043579102
local_output_nid generation:  0.5495808124542236
local_in_edges_tensor generation:  1.1567182540893555
mini_batch_src_global generation:  1.436525583267212
r_  generation:  14.36350417137146
local_output_nid generation:  0.5776541233062744
local_in_edges_tensor generation:  2.4999091625213623
mini_batch_src_global generation:  1.3295984268188477
r_  generation:  14.540040254592896
local_output_nid generation:  0.5851833820343018
local_in_edges_tensor generation:  1.1524784564971924
mini_batch_src_global generation:  1.3240199089050293
r_  generation:  14.416250705718994
local_output_nid generation:  0.5350053310394287
local_in_edges_tensor generation:  1.163285255432129
mini_batch_src_global generation:  1.400118350982666
r_  generation:  14.218413829803467
----------------------check_connections_block total spend ----------------------------- 321.4469425678253
generate_one_block  19.231494188308716
generate_one_block  19.134617805480957
generate_one_block  19.200819969177246
generate_one_block  19.416653633117676
generate_one_block  19.227559089660645
generate_one_block  18.74473261833191
generate_one_block  19.221957683563232
generate_one_block  19.57438564300537
generate_one_block  19.136064767837524
generate_one_block  19.146711826324463
generate_one_block  19.061482191085815
generate_one_block  18.966246128082275
generate_one_block  18.982863187789917
generate_one_block  19.08161950111389
generate_one_block  19.18443775177002
generate_one_block  19.17904043197632
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.8154301643371582  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

connection checking time:  430.27919459342957
block generation total time  408.1077604293823
average batch blocks generation time:  25.506735026836395
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1277484893798828  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.566132068634033  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1273565292358398  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.563314437866211  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.130760669708252  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.570950984954834  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1308212280273438  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5761513710021973  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.128519058227539  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.567925453186035  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1280665397644043  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5651321411132812  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.129143238067627  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.569718360900879  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1277198791503906  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.56613826751709  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1273794174194336  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5632753372192383  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1275091171264648  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5647478103637695  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1278266906738281  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5642189979553223  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.127377986907959  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5616140365600586  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1303586959838867  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.573185443878174  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1286239624023438  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.569611072540283  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.127751350402832  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.565769672393799  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1272544860839844  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.562026023864746  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3350346088409424 |0.2950346916913986 |0.004110172390937805 |0.00013138353824615479 |0.005028232932090759 |0.0026395320892333984 |
----------------------------------------------------------pseudo_mini_loss sum 3.13157320022583
Total (block generation + training)time/epoch 890.5922420024872
Training time/epoch 1647958780.5371304
Training time without block to device /epoch 1647958775.8165753
Training time without total dataloading part /epoch 0.1509561538696289
load block tensor time/epoch 5.360553741455078
block to device time/epoch 4.720555067062378
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  64173587
Number of first layer input nodes during this epoch:  34063921
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.810617446899414  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.28857946395874023
range selection method range initialization spend 0.02792501449584961
time for parepare:  0.2802903652191162
local_output_nid generation:  0.0031409263610839844
local_in_edges_tensor generation:  0.021112442016601562
mini_batch_src_global generation:  0.015729188919067383
r_  generation:  0.19431328773498535
local_output_nid generation:  0.0037424564361572266
local_in_edges_tensor generation:  0.006020069122314453
mini_batch_src_global generation:  0.019173622131347656
r_  generation:  0.2090151309967041
local_output_nid generation:  0.0037038326263427734
local_in_edges_tensor generation:  0.004533529281616211
mini_batch_src_global generation:  0.012233257293701172
r_  generation:  0.22217845916748047
local_output_nid generation:  0.003721952438354492
local_in_edges_tensor generation:  0.003603219985961914
mini_batch_src_global generation:  0.013933420181274414
r_  generation:  0.23005175590515137
local_output_nid generation:  0.003688812255859375
local_in_edges_tensor generation:  0.0052869319915771484
mini_batch_src_global generation:  0.013288259506225586
r_  generation:  0.32677292823791504
local_output_nid generation:  0.004716634750366211
local_in_edges_tensor generation:  0.004415035247802734
mini_batch_src_global generation:  0.019744157791137695
r_  generation:  0.336834192276001
local_output_nid generation:  0.0042018890380859375
local_in_edges_tensor generation:  0.004298210144042969
mini_batch_src_global generation:  0.019497156143188477
r_  generation:  0.26311206817626953
local_output_nid generation:  0.003904581069946289
local_in_edges_tensor generation:  0.0037183761596679688
mini_batch_src_global generation:  0.019849538803100586
r_  generation:  0.26361608505249023
local_output_nid generation:  0.0038063526153564453
local_in_edges_tensor generation:  0.005158185958862305
mini_batch_src_global generation:  0.020595312118530273
r_  generation:  0.2698209285736084
local_output_nid generation:  0.0037963390350341797
local_in_edges_tensor generation:  0.0041997432708740234
mini_batch_src_global generation:  0.021851301193237305
r_  generation:  0.27278947830200195
local_output_nid generation:  0.003923177719116211
local_in_edges_tensor generation:  0.0048351287841796875
mini_batch_src_global generation:  0.022258996963500977
r_  generation:  0.27814149856567383
local_output_nid generation:  0.003790616989135742
local_in_edges_tensor generation:  0.00415349006652832
mini_batch_src_global generation:  0.022475004196166992
r_  generation:  0.278400182723999
local_output_nid generation:  0.0037572383880615234
local_in_edges_tensor generation:  0.00420069694519043
mini_batch_src_global generation:  0.022960662841796875
r_  generation:  0.2762589454650879
local_output_nid generation:  0.0037856101989746094
local_in_edges_tensor generation:  0.0051670074462890625
mini_batch_src_global generation:  0.02056598663330078
r_  generation:  0.2788982391357422
local_output_nid generation:  0.003756999969482422
local_in_edges_tensor generation:  0.004742860794067383
mini_batch_src_global generation:  0.02104949951171875
r_  generation:  0.2803676128387451
local_output_nid generation:  0.0038089752197265625
local_in_edges_tensor generation:  0.004725217819213867
mini_batch_src_global generation:  0.02278614044189453
r_  generation:  0.2818949222564697
----------------------check_connections_block total spend ----------------------------- 5.784585237503052
generate_one_block  0.6172833442687988
generate_one_block  0.35935306549072266
generate_one_block  0.3023560047149658
generate_one_block  0.2909524440765381
generate_one_block  0.296938419342041
generate_one_block  0.2980480194091797
generate_one_block  0.29404568672180176
generate_one_block  0.30437135696411133
generate_one_block  0.36950135231018066
generate_one_block  0.4992070198059082
generate_one_block  0.3938617706298828
generate_one_block  0.3087639808654785
generate_one_block  0.2987222671508789
generate_one_block  0.30150294303894043
generate_one_block  0.28762245178222656
generate_one_block  0.2903144359588623
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.127760648727417
gen group dst list time:  0.16564273834228516
time for parepare:  0.4472029209136963
local_output_nid generation:  0.08143877983093262
local_in_edges_tensor generation:  0.2651362419128418
mini_batch_src_global generation:  0.35498666763305664
r_  generation:  4.664257049560547
local_output_nid generation:  0.10010790824890137
local_in_edges_tensor generation:  0.4135704040527344
mini_batch_src_global generation:  0.4543576240539551
r_  generation:  4.658610820770264
local_output_nid generation:  0.1047677993774414
local_in_edges_tensor generation:  0.2944033145904541
mini_batch_src_global generation:  0.43488478660583496
r_  generation:  4.960178852081299
local_output_nid generation:  0.11401963233947754
local_in_edges_tensor generation:  0.35276222229003906
mini_batch_src_global generation:  0.45392370223999023
r_  generation:  4.768152236938477
local_output_nid generation:  0.10778689384460449
local_in_edges_tensor generation:  0.2881581783294678
mini_batch_src_global generation:  0.4570043087005615
r_  generation:  4.895441770553589
local_output_nid generation:  0.11602616310119629
local_in_edges_tensor generation:  0.28887009620666504
mini_batch_src_global generation:  0.4758007526397705
r_  generation:  4.938947677612305
local_output_nid generation:  0.11190962791442871
local_in_edges_tensor generation:  0.40039896965026855
mini_batch_src_global generation:  0.4920074939727783
r_  generation:  5.070104360580444
local_output_nid generation:  0.12819576263427734
local_in_edges_tensor generation:  0.2933990955352783
mini_batch_src_global generation:  0.47284579277038574
r_  generation:  4.935617446899414
local_output_nid generation:  0.12622928619384766
local_in_edges_tensor generation:  0.29419517517089844
mini_batch_src_global generation:  0.4811985492706299
r_  generation:  4.93695855140686
local_output_nid generation:  0.11627817153930664
local_in_edges_tensor generation:  0.2950618267059326
mini_batch_src_global generation:  0.5641767978668213
r_  generation:  5.383486270904541
local_output_nid generation:  0.1405491828918457
local_in_edges_tensor generation:  0.4354281425476074
mini_batch_src_global generation:  0.5007045269012451
r_  generation:  5.088985443115234
local_output_nid generation:  0.12418341636657715
local_in_edges_tensor generation:  0.4171154499053955
mini_batch_src_global generation:  0.6112701892852783
r_  generation:  5.004501581192017
local_output_nid generation:  0.12622380256652832
local_in_edges_tensor generation:  0.3025951385498047
mini_batch_src_global generation:  0.47934532165527344
r_  generation:  4.999274969100952
local_output_nid generation:  0.1346132755279541
local_in_edges_tensor generation:  0.29264354705810547
mini_batch_src_global generation:  0.48403406143188477
r_  generation:  4.977368593215942
local_output_nid generation:  0.13143134117126465
local_in_edges_tensor generation:  0.3552408218383789
mini_batch_src_global generation:  0.49904870986938477
r_  generation:  5.130310773849487
local_output_nid generation:  0.13859772682189941
local_in_edges_tensor generation:  0.3549032211303711
mini_batch_src_global generation:  0.48177599906921387
r_  generation:  5.00089955329895
----------------------check_connections_block total spend ----------------------------- 108.38600277900696
generate_one_block  6.567692756652832
generate_one_block  6.541731357574463
generate_one_block  6.517297029495239
generate_one_block  6.119257211685181
generate_one_block  6.170818328857422
generate_one_block  6.291097164154053
generate_one_block  6.552158355712891
generate_one_block  6.16058349609375
generate_one_block  6.14270281791687
generate_one_block  6.407109975814819
generate_one_block  6.546176433563232
generate_one_block  6.175811290740967
generate_one_block  6.252109050750732
generate_one_block  6.337793350219727
generate_one_block  6.34068489074707
generate_one_block  6.216010808944702
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.286771297454834
gen group dst list time:  0.9089987277984619
time for parepare:  0.47426843643188477
local_output_nid generation:  0.47313499450683594
local_in_edges_tensor generation:  1.1215870380401611
mini_batch_src_global generation:  1.026982069015503
r_  generation:  13.96879768371582
local_output_nid generation:  0.5474026203155518
local_in_edges_tensor generation:  1.1157231330871582
mini_batch_src_global generation:  1.3317501544952393
r_  generation:  14.066288471221924
local_output_nid generation:  0.5272743701934814
local_in_edges_tensor generation:  1.2363629341125488
mini_batch_src_global generation:  1.3932900428771973
r_  generation:  14.194955348968506
local_output_nid generation:  0.5443782806396484
local_in_edges_tensor generation:  1.0610997676849365
mini_batch_src_global generation:  1.3758330345153809
r_  generation:  14.28984546661377
local_output_nid generation:  0.5716707706451416
local_in_edges_tensor generation:  1.1263694763183594
mini_batch_src_global generation:  1.430403470993042
r_  generation:  15.491052150726318
local_output_nid generation:  0.5757884979248047
local_in_edges_tensor generation:  1.1433169841766357
mini_batch_src_global generation:  2.1044270992279053
r_  generation:  14.211400508880615
local_output_nid generation:  0.5616145133972168
local_in_edges_tensor generation:  1.0669753551483154
mini_batch_src_global generation:  1.5021567344665527
r_  generation:  14.629842758178711
local_output_nid generation:  0.5752792358398438
local_in_edges_tensor generation:  1.1378555297851562
mini_batch_src_global generation:  1.3238246440887451
r_  generation:  14.63177752494812
local_output_nid generation:  0.57100510597229
local_in_edges_tensor generation:  1.131995439529419
mini_batch_src_global generation:  1.3225927352905273
r_  generation:  14.27419114112854
local_output_nid generation:  0.5503206253051758
local_in_edges_tensor generation:  1.0141093730926514
mini_batch_src_global generation:  1.4172358512878418
r_  generation:  14.27143144607544
local_output_nid generation:  0.5886414051055908
local_in_edges_tensor generation:  1.155064344406128
mini_batch_src_global generation:  1.3979499340057373
r_  generation:  14.697723388671875
local_output_nid generation:  0.5731821060180664
local_in_edges_tensor generation:  1.1464207172393799
mini_batch_src_global generation:  1.3397347927093506
r_  generation:  14.536931037902832
local_output_nid generation:  0.5648257732391357
local_in_edges_tensor generation:  1.1490731239318848
mini_batch_src_global generation:  1.4148023128509521
r_  generation:  14.353841304779053
local_output_nid generation:  0.5745511054992676
local_in_edges_tensor generation:  2.5177161693573
mini_batch_src_global generation:  1.3666577339172363
r_  generation:  14.533735275268555
local_output_nid generation:  0.5869626998901367
local_in_edges_tensor generation:  1.1621732711791992
mini_batch_src_global generation:  1.4691221714019775
r_  generation:  14.715303659439087
local_output_nid generation:  0.5759072303771973
local_in_edges_tensor generation:  1.149698257446289
mini_batch_src_global generation:  1.3380088806152344
r_  generation:  14.718506097793579
----------------------check_connections_block total spend ----------------------------- 323.8576443195343
generate_one_block  19.320658206939697
generate_one_block  18.804859399795532
generate_one_block  19.146955728530884
generate_one_block  19.107133388519287
generate_one_block  19.185625314712524
generate_one_block  19.32083511352539
generate_one_block  19.425703048706055
generate_one_block  19.749229192733765
generate_one_block  19.229095220565796
generate_one_block  18.83562207221985
generate_one_block  19.325757026672363
generate_one_block  19.290783643722534
generate_one_block  19.125616550445557
generate_one_block  19.26268720626831
generate_one_block  19.018232822418213
generate_one_block  19.09873676300049
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.810617446899414  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

connection checking time:  432.24364709854126
block generation total time  408.5865650177002
average batch blocks generation time:  25.536660313606262
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1261043548583984  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5586795806884766  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1277570724487305  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5683460235595703  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1279263496398926  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.563502788543701  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1272096633911133  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5618715286254883  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.129133701324463  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.568451404571533  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.128316879272461  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5670528411865234  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1286444664001465  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5686678886413574  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1277928352355957  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5643086433410645  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.126145362854004  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.558748245239258  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1283211708068848  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5693016052246094  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1305255889892578  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.571566104888916  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.128220558166504  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.569575786590576  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1265616416931152  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5617904663085938  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1295065879821777  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.570216178894043  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1271991729736328  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.560311794281006  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.126375675201416  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.566415309906006  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3362053334712982 |0.3515647053718567 |0.003719925880432129 |0.00013494491577148438 |0.004787862300872803 |0.0014989376068115234 |
----------------------------------------------------------pseudo_mini_loss sum 2.7037532329559326
Total (block generation + training)time/epoch 891.2515437602997
Training time/epoch 1647959673.10759
Training time without block to device /epoch 1647959667.4825547
Training time without total dataloading part /epoch 0.13978266716003418
load block tensor time/epoch 5.3792853355407715
block to device time/epoch 5.625035285949707
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  64140383
Number of first layer input nodes during this epoch:  34044751
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.812563419342041  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.31336545944213867
range selection method range initialization spend 0.027704715728759766
time for parepare:  0.30353212356567383
local_output_nid generation:  0.003386259078979492
local_in_edges_tensor generation:  0.021667957305908203
mini_batch_src_global generation:  0.01566028594970703
r_  generation:  0.19318413734436035
local_output_nid generation:  0.0039196014404296875
local_in_edges_tensor generation:  0.005824089050292969
mini_batch_src_global generation:  0.020194530487060547
r_  generation:  0.21304607391357422
local_output_nid generation:  0.005143404006958008
local_in_edges_tensor generation:  0.0034656524658203125
mini_batch_src_global generation:  0.012243509292602539
r_  generation:  0.22346067428588867
local_output_nid generation:  0.0039370059967041016
local_in_edges_tensor generation:  0.003615856170654297
mini_batch_src_global generation:  0.01319575309753418
r_  generation:  0.23252391815185547
local_output_nid generation:  0.003871917724609375
local_in_edges_tensor generation:  0.00412440299987793
mini_batch_src_global generation:  0.013292551040649414
r_  generation:  0.23827362060546875
local_output_nid generation:  0.003941059112548828
local_in_edges_tensor generation:  0.0040934085845947266
mini_batch_src_global generation:  0.016444921493530273
r_  generation:  0.2494816780090332
local_output_nid generation:  0.003906965255737305
local_in_edges_tensor generation:  0.003534078598022461
mini_batch_src_global generation:  0.01666426658630371
r_  generation:  0.25856733322143555
local_output_nid generation:  0.003938913345336914
local_in_edges_tensor generation:  0.004037380218505859
mini_batch_src_global generation:  0.01787543296813965
r_  generation:  0.26280760765075684
local_output_nid generation:  0.00393223762512207
local_in_edges_tensor generation:  0.0041370391845703125
mini_batch_src_global generation:  0.017317533493041992
r_  generation:  0.26517701148986816
local_output_nid generation:  0.0039556026458740234
local_in_edges_tensor generation:  0.0042498111724853516
mini_batch_src_global generation:  0.018415212631225586
r_  generation:  0.27256345748901367
local_output_nid generation:  0.003948688507080078
local_in_edges_tensor generation:  0.004163265228271484
mini_batch_src_global generation:  0.01974940299987793
r_  generation:  0.2758345603942871
local_output_nid generation:  0.003913164138793945
local_in_edges_tensor generation:  0.0044269561767578125
mini_batch_src_global generation:  0.020269155502319336
r_  generation:  0.27783918380737305
local_output_nid generation:  0.003896951675415039
local_in_edges_tensor generation:  0.0045468807220458984
mini_batch_src_global generation:  0.020716190338134766
r_  generation:  0.27796030044555664
local_output_nid generation:  0.0038611888885498047
local_in_edges_tensor generation:  0.004076719284057617
mini_batch_src_global generation:  0.020595550537109375
r_  generation:  0.2792093753814697
local_output_nid generation:  0.003796100616455078
local_in_edges_tensor generation:  0.0035202503204345703
mini_batch_src_global generation:  0.021177053451538086
r_  generation:  0.2752103805541992
local_output_nid generation:  0.003728151321411133
local_in_edges_tensor generation:  0.004051923751831055
mini_batch_src_global generation:  0.021706819534301758
r_  generation:  0.27365875244140625
----------------------check_connections_block total spend ----------------------------- 5.563504695892334
generate_one_block  0.5943374633789062
generate_one_block  0.35435056686401367
generate_one_block  0.2930138111114502
generate_one_block  0.28988003730773926
generate_one_block  0.290285587310791
generate_one_block  0.2870368957519531
generate_one_block  0.2908971309661865
generate_one_block  0.28882741928100586
generate_one_block  0.2817344665527344
generate_one_block  0.2855195999145508
generate_one_block  0.2968158721923828
generate_one_block  0.29316067695617676
generate_one_block  0.29250669479370117
generate_one_block  0.28289008140563965
generate_one_block  0.2857844829559326
generate_one_block  0.2927384376525879
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1606743335723877
gen group dst list time:  0.15518689155578613
time for parepare:  0.4362316131591797
local_output_nid generation:  0.07340312004089355
local_in_edges_tensor generation:  0.2819101810455322
mini_batch_src_global generation:  0.3494560718536377
r_  generation:  4.4177446365356445
local_output_nid generation:  0.09386038780212402
local_in_edges_tensor generation:  0.2558276653289795
mini_batch_src_global generation:  0.4255373477935791
r_  generation:  4.712999105453491
local_output_nid generation:  0.10652685165405273
local_in_edges_tensor generation:  0.21241307258605957
mini_batch_src_global generation:  0.4324064254760742
r_  generation:  4.960379123687744
local_output_nid generation:  0.11266970634460449
local_in_edges_tensor generation:  0.474198579788208
mini_batch_src_global generation:  0.4353790283203125
r_  generation:  4.8097734451293945
local_output_nid generation:  0.1123664379119873
local_in_edges_tensor generation:  0.30439138412475586
mini_batch_src_global generation:  0.45879340171813965
r_  generation:  4.9297637939453125
local_output_nid generation:  0.10935735702514648
local_in_edges_tensor generation:  0.295637845993042
mini_batch_src_global generation:  0.46936893463134766
r_  generation:  5.087400436401367
local_output_nid generation:  0.11149883270263672
local_in_edges_tensor generation:  0.40802526473999023
mini_batch_src_global generation:  0.5171236991882324
r_  generation:  4.900607109069824
local_output_nid generation:  0.11972427368164062
local_in_edges_tensor generation:  0.3041117191314697
mini_batch_src_global generation:  0.47254085540771484
r_  generation:  4.940014839172363
local_output_nid generation:  0.12192392349243164
local_in_edges_tensor generation:  0.2917952537536621
mini_batch_src_global generation:  0.48195695877075195
r_  generation:  4.9576756954193115
local_output_nid generation:  0.11881017684936523
local_in_edges_tensor generation:  0.4036858081817627
mini_batch_src_global generation:  0.4904062747955322
r_  generation:  5.0433080196380615
local_output_nid generation:  0.1336195468902588
local_in_edges_tensor generation:  0.3035900592803955
mini_batch_src_global generation:  0.47641921043395996
r_  generation:  4.987306833267212
local_output_nid generation:  0.12381649017333984
local_in_edges_tensor generation:  0.2934553623199463
mini_batch_src_global generation:  0.47821807861328125
r_  generation:  5.025256395339966
local_output_nid generation:  0.1166384220123291
local_in_edges_tensor generation:  0.30458688735961914
mini_batch_src_global generation:  0.49795079231262207
r_  generation:  5.184841632843018
local_output_nid generation:  0.13499808311462402
local_in_edges_tensor generation:  0.39398670196533203
mini_batch_src_global generation:  0.4815058708190918
r_  generation:  4.991887092590332
local_output_nid generation:  0.12569499015808105
local_in_edges_tensor generation:  0.2991001605987549
mini_batch_src_global generation:  0.4806046485900879
r_  generation:  5.0340094566345215
local_output_nid generation:  0.1178121566772461
local_in_edges_tensor generation:  0.29469847679138184
mini_batch_src_global generation:  0.4882090091705322
r_  generation:  5.519825220108032
----------------------check_connections_block total spend ----------------------------- 107.61930799484253
generate_one_block  6.638417720794678
generate_one_block  6.583174228668213
generate_one_block  6.443517208099365
generate_one_block  6.209330081939697
generate_one_block  6.24376106262207
generate_one_block  6.569138765335083
generate_one_block  6.125387191772461
generate_one_block  6.222008466720581
generate_one_block  6.323102235794067
generate_one_block  6.5352394580841064
generate_one_block  6.148072004318237
generate_one_block  6.2486183643341064
generate_one_block  6.563840866088867
generate_one_block  6.127695322036743
generate_one_block  6.148023366928101
generate_one_block  6.272701263427734
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.285498857498169
gen group dst list time:  0.8593754768371582
time for parepare:  0.4504721164703369
local_output_nid generation:  0.4521963596343994
local_in_edges_tensor generation:  1.0586786270141602
mini_batch_src_global generation:  1.0726444721221924
r_  generation:  13.95603609085083
local_output_nid generation:  0.5298914909362793
local_in_edges_tensor generation:  1.1149320602416992
mini_batch_src_global generation:  1.448002815246582
r_  generation:  13.940168142318726
local_output_nid generation:  0.5496044158935547
local_in_edges_tensor generation:  1.2404921054840088
mini_batch_src_global generation:  1.4536278247833252
r_  generation:  14.250015497207642
local_output_nid generation:  0.5323646068572998
local_in_edges_tensor generation:  1.1057682037353516
mini_batch_src_global generation:  1.307359218597412
r_  generation:  14.256851196289062
local_output_nid generation:  0.5305018424987793
local_in_edges_tensor generation:  1.1387364864349365
mini_batch_src_global generation:  1.3972458839416504
r_  generation:  14.186829090118408
local_output_nid generation:  0.5414378643035889
local_in_edges_tensor generation:  1.0147655010223389
mini_batch_src_global generation:  1.3722736835479736
r_  generation:  14.24476432800293
local_output_nid generation:  0.5591254234313965
local_in_edges_tensor generation:  1.1382677555084229
mini_batch_src_global generation:  1.3203520774841309
r_  generation:  14.476499319076538
local_output_nid generation:  0.5269970893859863
local_in_edges_tensor generation:  1.1464366912841797
mini_batch_src_global generation:  1.4232110977172852
r_  generation:  14.251073598861694
local_output_nid generation:  0.5477283000946045
local_in_edges_tensor generation:  1.0127460956573486
mini_batch_src_global generation:  1.4234025478363037
r_  generation:  14.397899627685547
local_output_nid generation:  0.5692381858825684
local_in_edges_tensor generation:  1.1458394527435303
mini_batch_src_global generation:  1.3477556705474854
r_  generation:  14.437609910964966
local_output_nid generation:  0.532630443572998
local_in_edges_tensor generation:  1.1738660335540771
mini_batch_src_global generation:  1.3582518100738525
r_  generation:  14.239341259002686
local_output_nid generation:  0.5515968799591064
local_in_edges_tensor generation:  1.0168609619140625
mini_batch_src_global generation:  1.3740816116333008
r_  generation:  14.22442626953125
local_output_nid generation:  0.5752789974212646
local_in_edges_tensor generation:  1.1421785354614258
mini_batch_src_global generation:  1.4251339435577393
r_  generation:  14.479617357254028
local_output_nid generation:  0.5443150997161865
local_in_edges_tensor generation:  2.6030094623565674
mini_batch_src_global generation:  1.3149116039276123
r_  generation:  14.307417869567871
local_output_nid generation:  0.5336527824401855
local_in_edges_tensor generation:  1.0247509479522705
mini_batch_src_global generation:  1.4151618480682373
r_  generation:  14.239819288253784
local_output_nid generation:  0.5958480834960938
local_in_edges_tensor generation:  1.1734204292297363
mini_batch_src_global generation:  1.366511344909668
r_  generation:  14.359101057052612
----------------------check_connections_block total spend ----------------------------- 318.6313445568085
generate_one_block  19.270882606506348
generate_one_block  19.233534812927246
generate_one_block  18.683311223983765
generate_one_block  19.029069900512695
generate_one_block  19.07331871986389
generate_one_block  19.057172060012817
generate_one_block  19.010448455810547
generate_one_block  19.64500904083252
generate_one_block  19.225192308425903
generate_one_block  19.393167972564697
generate_one_block  18.659780979156494
generate_one_block  19.089635610580444
generate_one_block  19.14149832725525
generate_one_block  19.063952922821045
generate_one_block  19.00662875175476
generate_one_block  19.081992626190186
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.812563419342041  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

connection checking time:  426.250652551651
block generation total time  407.0666239261627
average batch blocks generation time:  25.44166399538517
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1275978088378906  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5601563453674316  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.130270004272461  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.571345806121826  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1274051666259766  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5617856979370117  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.12677001953125  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5632076263427734  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.127751350402832  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5665769577026367  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1283845901489258  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.569851875305176  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1279215812683105  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5673828125  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1306114196777344  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5740833282470703  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1282262802124023  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.568450927734375  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.13014554977417  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.570512294769287  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1265368461608887  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5641121864318848  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1282110214233398  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.565295696258545  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1306204795837402  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.570829391479492  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.126145362854004  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5607852935791016  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1263608932495117  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.560093879699707  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 1.1284279823303223  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4891357421875 GB
    Memory Allocated: 2.5684871673583984  GigaBytes
Max Memory Allocated: 3.309821128845215  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.33094440400600433 |0.3405527323484421 |0.0037051737308502197 |0.00014294683933258057 |0.004895195364952087 |0.0012202262878417969 |
----------------------------------------------------------pseudo_mini_loss sum 2.398164749145508
Total (block generation + training)time/epoch 889.517321407795
Training time/epoch 1647960557.422546
Training time without block to device /epoch 1647960551.9737022
Training time without total dataloading part /epoch 0.14111328125
load block tensor time/epoch 5.295110464096069
block to device time/epoch 5.448843717575073
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  64156091
Number of first layer input nodes during this epoch:  34052831Using backend: pytorch

