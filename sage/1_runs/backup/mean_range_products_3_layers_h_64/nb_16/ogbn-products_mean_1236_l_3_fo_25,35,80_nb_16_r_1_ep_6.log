main start at this time 1648013523.7530463
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6044683456420898
range selection method range initialization spend 0.029148340225219727
time for parepare:  0.35912466049194336
local_output_nid generation:  0.0034630298614501953
local_in_edges_tensor generation:  0.029125690460205078
mini_batch_src_global generation:  0.024802446365356445
r_  generation:  0.35855793952941895
local_output_nid generation:  0.0037088394165039062
local_in_edges_tensor generation:  0.011741399765014648
mini_batch_src_global generation:  0.03277277946472168
r_  generation:  0.40490078926086426
local_output_nid generation:  0.003648996353149414
local_in_edges_tensor generation:  0.005532979965209961
mini_batch_src_global generation:  0.022983312606811523
r_  generation:  0.415266752243042
local_output_nid generation:  0.003726959228515625
local_in_edges_tensor generation:  0.0055692195892333984
mini_batch_src_global generation:  0.025534391403198242
r_  generation:  0.4496784210205078
local_output_nid generation:  0.0036988258361816406
local_in_edges_tensor generation:  0.00557708740234375
mini_batch_src_global generation:  0.02706599235534668
r_  generation:  0.47127628326416016
local_output_nid generation:  0.003658771514892578
local_in_edges_tensor generation:  0.005530357360839844
mini_batch_src_global generation:  0.030914306640625
r_  generation:  0.48482275009155273
local_output_nid generation:  0.0036449432373046875
local_in_edges_tensor generation:  0.005417585372924805
mini_batch_src_global generation:  0.03188276290893555
r_  generation:  0.4921596050262451
local_output_nid generation:  0.0036242008209228516
local_in_edges_tensor generation:  0.00517725944519043
mini_batch_src_global generation:  0.03327465057373047
r_  generation:  0.5081722736358643
local_output_nid generation:  0.003642559051513672
local_in_edges_tensor generation:  0.0052301883697509766
mini_batch_src_global generation:  0.03437638282775879
r_  generation:  0.5068771839141846
local_output_nid generation:  0.003620147705078125
local_in_edges_tensor generation:  0.0055887699127197266
mini_batch_src_global generation:  0.03593134880065918
r_  generation:  0.5069563388824463
local_output_nid generation:  0.003680706024169922
local_in_edges_tensor generation:  0.00541377067565918
mini_batch_src_global generation:  0.03705549240112305
r_  generation:  0.5097706317901611
local_output_nid generation:  0.0036468505859375
local_in_edges_tensor generation:  0.005225419998168945
mini_batch_src_global generation:  0.037917137145996094
r_  generation:  0.5183489322662354
local_output_nid generation:  0.003666400909423828
local_in_edges_tensor generation:  0.005518674850463867
mini_batch_src_global generation:  0.03822684288024902
r_  generation:  0.5165269374847412
local_output_nid generation:  0.003661632537841797
local_in_edges_tensor generation:  0.0054721832275390625
mini_batch_src_global generation:  0.0397951602935791
r_  generation:  0.5215866565704346
local_output_nid generation:  0.003627300262451172
local_in_edges_tensor generation:  0.00548100471496582
mini_batch_src_global generation:  0.041300058364868164
r_  generation:  0.5291495323181152
local_output_nid generation:  0.0036394596099853516
local_in_edges_tensor generation:  0.005283832550048828
mini_batch_src_global generation:  0.04032707214355469
r_  generation:  0.5306925773620605
----------------------check_connections_block total spend ----------------------------- 10.094584465026855
generate_one_block  5.585533142089844
generate_one_block  0.50103759765625
generate_one_block  0.5099906921386719
generate_one_block  0.5014841556549072
generate_one_block  0.4978468418121338
generate_one_block  0.5056121349334717
generate_one_block  0.5024855136871338
generate_one_block  0.500006914138794
generate_one_block  0.5002186298370361
generate_one_block  0.49909520149230957
generate_one_block  0.5111508369445801
generate_one_block  0.49974870681762695
generate_one_block  0.504202127456665
generate_one_block  0.4993007183074951
generate_one_block  0.4999210834503174
generate_one_block  0.4984581470489502
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.364851713180542
gen group dst list time:  0.23408174514770508
time for parepare:  0.446765661239624
local_output_nid generation:  0.09820270538330078
local_in_edges_tensor generation:  0.44225502014160156
mini_batch_src_global generation:  0.5094187259674072
r_  generation:  6.281795501708984
local_output_nid generation:  0.13155627250671387
local_in_edges_tensor generation:  0.3807365894317627
mini_batch_src_global generation:  0.6702532768249512
r_  generation:  6.492907762527466
local_output_nid generation:  0.1631333827972412
local_in_edges_tensor generation:  0.40766382217407227
mini_batch_src_global generation:  0.6337876319885254
r_  generation:  6.732464075088501
local_output_nid generation:  0.15860247611999512
local_in_edges_tensor generation:  0.42443013191223145
mini_batch_src_global generation:  0.7052929401397705
r_  generation:  6.811393737792969
local_output_nid generation:  0.1613612174987793
local_in_edges_tensor generation:  0.4268193244934082
mini_batch_src_global generation:  0.6753113269805908
r_  generation:  6.839157581329346
local_output_nid generation:  0.16471338272094727
local_in_edges_tensor generation:  0.4670853614807129
mini_batch_src_global generation:  0.6808156967163086
r_  generation:  6.98748517036438
local_output_nid generation:  0.19194769859313965
local_in_edges_tensor generation:  0.5361802577972412
mini_batch_src_global generation:  0.6819009780883789
r_  generation:  6.915364742279053
local_output_nid generation:  0.16933917999267578
local_in_edges_tensor generation:  0.4620077610015869
mini_batch_src_global generation:  0.7167308330535889
r_  generation:  6.967069625854492
local_output_nid generation:  0.17084026336669922
local_in_edges_tensor generation:  0.7296507358551025
mini_batch_src_global generation:  0.6900005340576172
r_  generation:  6.978430271148682
local_output_nid generation:  0.1985173225402832
local_in_edges_tensor generation:  0.4641897678375244
mini_batch_src_global generation:  0.6869606971740723
r_  generation:  7.014041900634766
local_output_nid generation:  0.17203426361083984
local_in_edges_tensor generation:  0.4525618553161621
mini_batch_src_global generation:  0.6970334053039551
r_  generation:  7.017796993255615
local_output_nid generation:  0.17978358268737793
local_in_edges_tensor generation:  0.5767881870269775
mini_batch_src_global generation:  0.7139427661895752
r_  generation:  6.909947156906128
local_output_nid generation:  0.18194341659545898
local_in_edges_tensor generation:  0.44637060165405273
mini_batch_src_global generation:  0.7173223495483398
r_  generation:  7.008092403411865
local_output_nid generation:  0.17290973663330078
local_in_edges_tensor generation:  0.45114922523498535
mini_batch_src_global generation:  0.6952085494995117
r_  generation:  6.9725871086120605
local_output_nid generation:  0.20203948020935059
local_in_edges_tensor generation:  0.5777590274810791
mini_batch_src_global generation:  0.687617301940918
r_  generation:  6.922914505004883
local_output_nid generation:  0.17377066612243652
local_in_edges_tensor generation:  0.4513394832611084
mini_batch_src_global generation:  0.7295479774475098
r_  generation:  6.988407850265503
----------------------check_connections_block total spend ----------------------------- 150.38030457496643
generate_one_block  9.80220913887024
generate_one_block  8.948087692260742
generate_one_block  9.292410612106323
generate_one_block  8.948936462402344
generate_one_block  8.891249656677246
generate_one_block  9.290067195892334
generate_one_block  8.97665524482727
generate_one_block  8.998493194580078
generate_one_block  9.382035732269287
generate_one_block  8.936585426330566
generate_one_block  9.300552606582642
generate_one_block  8.943071603775024
generate_one_block  8.927090644836426
generate_one_block  9.258527517318726
generate_one_block  8.903147459030151
generate_one_block  9.280799388885498
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2098846435546875
gen group dst list time:  1.0079965591430664
time for parepare:  0.4890007972717285
local_output_nid generation:  0.4649653434753418
local_in_edges_tensor generation:  1.1163311004638672
mini_batch_src_global generation:  1.1211013793945312
r_  generation:  14.813578605651855
local_output_nid generation:  0.5651364326477051
local_in_edges_tensor generation:  1.2750227451324463
mini_batch_src_global generation:  1.5474402904510498
r_  generation:  14.716343402862549
local_output_nid generation:  0.5900940895080566
local_in_edges_tensor generation:  1.217937707901001
mini_batch_src_global generation:  1.4980823993682861
r_  generation:  14.860426187515259
local_output_nid generation:  0.598046064376831
local_in_edges_tensor generation:  1.1694977283477783
mini_batch_src_global generation:  1.5173301696777344
r_  generation:  14.893505811691284
local_output_nid generation:  0.599193811416626
local_in_edges_tensor generation:  1.207362413406372
mini_batch_src_global generation:  1.4982728958129883
r_  generation:  15.315247535705566
local_output_nid generation:  0.611879825592041
local_in_edges_tensor generation:  2.299832344055176
mini_batch_src_global generation:  1.4551231861114502
r_  generation:  15.393108129501343
local_output_nid generation:  0.5749266147613525
local_in_edges_tensor generation:  1.2139828205108643
mini_batch_src_global generation:  1.4367876052856445
r_  generation:  15.03313946723938
local_output_nid generation:  0.5831952095031738
local_in_edges_tensor generation:  1.0947489738464355
mini_batch_src_global generation:  1.5401523113250732
r_  generation:  14.935383558273315
local_output_nid generation:  0.6136982440948486
local_in_edges_tensor generation:  1.222050428390503
mini_batch_src_global generation:  1.5743114948272705
r_  generation:  15.253422737121582
local_output_nid generation:  0.6235325336456299
local_in_edges_tensor generation:  1.21730375289917
mini_batch_src_global generation:  1.4181063175201416
r_  generation:  15.35435175895691
local_output_nid generation:  0.5890285968780518
local_in_edges_tensor generation:  1.2343361377716064
mini_batch_src_global generation:  1.4493834972381592
r_  generation:  15.149760723114014
local_output_nid generation:  0.5835800170898438
local_in_edges_tensor generation:  1.1026504039764404
mini_batch_src_global generation:  1.605027198791504
r_  generation:  14.971512794494629
local_output_nid generation:  0.6182236671447754
local_in_edges_tensor generation:  1.2351579666137695
mini_batch_src_global generation:  1.565141201019287
r_  generation:  15.172613620758057
local_output_nid generation:  0.6233799457550049
local_in_edges_tensor generation:  1.2313027381896973
mini_batch_src_global generation:  1.4859850406646729
r_  generation:  15.333006858825684
local_output_nid generation:  0.6199731826782227
local_in_edges_tensor generation:  1.2241806983947754
mini_batch_src_global generation:  1.4240546226501465
r_  generation:  15.319833993911743
local_output_nid generation:  0.5700275897979736
local_in_edges_tensor generation:  1.251976490020752
mini_batch_src_global generation:  1.5049810409545898
r_  generation:  15.247072458267212
----------------------check_connections_block total spend ----------------------------- 339.1665663719177
generate_one_block  20.427631616592407
generate_one_block  20.348888874053955
generate_one_block  20.151453256607056
generate_one_block  20.2232449054718
generate_one_block  20.248425006866455
generate_one_block  20.342857599258423
generate_one_block  21.1500461101532
generate_one_block  20.362128496170044
generate_one_block  20.35665798187256
generate_one_block  20.342516899108887
generate_one_block  20.291634798049927
generate_one_block  20.408581495285034
generate_one_block  20.25655221939087
generate_one_block  20.34680461883545
generate_one_block  20.291980028152466
generate_one_block  20.581455945968628
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  489.54687094688416
block generation total time  472.21077942848206
average batch blocks generation time:  29.51317371428013
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3074951171875 GB
    Memory Allocated: 1.2057666778564453  GigaBytes
Max Memory Allocated: 1.2057666778564453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9461669921875 GB
    Memory Allocated: 2.9382810592651367  GigaBytes
Max Memory Allocated: 3.222095489501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8680419921875 GB
    Memory Allocated: 1.2092828750610352  GigaBytes
Max Memory Allocated: 3.60090970993042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8680419921875 GB
    Memory Allocated: 2.942671298980713  GigaBytes
Max Memory Allocated: 3.60090970993042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.2100763320922852  GigaBytes
Max Memory Allocated: 3.606778621673584  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.942702293395996  GigaBytes
Max Memory Allocated: 3.606778621673584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.2082409858703613  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.936999797821045  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.2088284492492676  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.941209316253662  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.2094664573669434  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.9421095848083496  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.208193302154541  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.9383530616760254  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.207961082458496  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.937119960784912  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.2108993530273438  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.9451498985290527  GigaBytes
Max Memory Allocated: 3.607905387878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.2091922760009766  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.938291072845459  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.2081875801086426  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.9394049644470215  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.2061309814453125  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.937722682952881  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.206601619720459  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 2.934180736541748  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6805419921875 GB
    Memory Allocated: 1.2112503051757812  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.943234920501709  GigaBytes
Max Memory Allocated: 3.6085853576660156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.206003189086914  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9351139068603516  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2060546875  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9346237182617188  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2800953686237335 |0.46814529597759247 |0.04657579958438873 |0.0001452118158340454 |0.03039945662021637 |0.001817464828491211 |
----------------------------------------------------------pseudo_mini_loss sum 8.777536392211914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  70329718
Number of first layer input nodes during this epoch:  34747276
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.0212631225585938  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6869757175445557
range selection method range initialization spend 0.025392770767211914
time for parepare:  0.38515162467956543
local_output_nid generation:  0.0034630298614501953
local_in_edges_tensor generation:  0.034618377685546875
mini_batch_src_global generation:  0.025698423385620117
r_  generation:  0.36545515060424805
local_output_nid generation:  0.003765583038330078
local_in_edges_tensor generation:  0.012104988098144531
mini_batch_src_global generation:  0.03668689727783203
r_  generation:  0.4144163131713867
local_output_nid generation:  0.003687620162963867
local_in_edges_tensor generation:  0.005364418029785156
mini_batch_src_global generation:  0.02314305305480957
r_  generation:  0.42954421043395996
local_output_nid generation:  0.0037178993225097656
local_in_edges_tensor generation:  0.005318164825439453
mini_batch_src_global generation:  0.02563786506652832
r_  generation:  0.4509553909301758
local_output_nid generation:  0.0036745071411132812
local_in_edges_tensor generation:  0.005466938018798828
mini_batch_src_global generation:  0.027955055236816406
r_  generation:  0.5002472400665283
local_output_nid generation:  0.0037419795989990234
local_in_edges_tensor generation:  0.005187273025512695
mini_batch_src_global generation:  0.030771255493164062
r_  generation:  0.5118703842163086
local_output_nid generation:  0.007040739059448242
local_in_edges_tensor generation:  0.012893915176391602
mini_batch_src_global generation:  0.032349586486816406
r_  generation:  0.5313699245452881
local_output_nid generation:  0.0039212703704833984
local_in_edges_tensor generation:  0.007576465606689453
mini_batch_src_global generation:  0.03578901290893555
r_  generation:  0.5303750038146973
local_output_nid generation:  0.0037758350372314453
local_in_edges_tensor generation:  0.012845277786254883
mini_batch_src_global generation:  0.03725934028625488
r_  generation:  0.544731855392456
local_output_nid generation:  0.0039484500885009766
local_in_edges_tensor generation:  0.013175487518310547
mini_batch_src_global generation:  0.038703203201293945
r_  generation:  0.5179798603057861
local_output_nid generation:  0.003962278366088867
local_in_edges_tensor generation:  0.007586002349853516
mini_batch_src_global generation:  0.039620161056518555
r_  generation:  0.5257372856140137
local_output_nid generation:  0.004018306732177734
local_in_edges_tensor generation:  0.007572174072265625
mini_batch_src_global generation:  0.042618751525878906
r_  generation:  0.530590295791626
local_output_nid generation:  0.003957509994506836
local_in_edges_tensor generation:  0.007521867752075195
mini_batch_src_global generation:  0.0421750545501709
r_  generation:  0.5269913673400879
local_output_nid generation:  0.004160642623901367
local_in_edges_tensor generation:  0.007391214370727539
mini_batch_src_global generation:  0.04414868354797363
r_  generation:  0.5270631313323975
local_output_nid generation:  0.0040090084075927734
local_in_edges_tensor generation:  0.010162830352783203
mini_batch_src_global generation:  0.04376959800720215
r_  generation:  0.5548090934753418
local_output_nid generation:  0.003979682922363281
local_in_edges_tensor generation:  0.018617868423461914
mini_batch_src_global generation:  0.046602725982666016
r_  generation:  0.5485556125640869
----------------------check_connections_block total spend ----------------------------- 10.603153228759766
generate_one_block  0.9157207012176514
generate_one_block  0.546614408493042
generate_one_block  0.6497116088867188
generate_one_block  0.568166971206665
generate_one_block  0.6985924243927002
generate_one_block  0.5546021461486816
generate_one_block  0.51849365234375
generate_one_block  0.5212340354919434
generate_one_block  0.5137641429901123
generate_one_block  0.5088045597076416
generate_one_block  0.5104572772979736
generate_one_block  0.5098185539245605
generate_one_block  0.5246789455413818
generate_one_block  0.5046746730804443
generate_one_block  0.5044040679931641
generate_one_block  0.5140745639801025
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.21925687789917
gen group dst list time:  0.2553122043609619
time for parepare:  0.4642632007598877
local_output_nid generation:  0.1042938232421875
local_in_edges_tensor generation:  0.5103535652160645
mini_batch_src_global generation:  0.5246644020080566
r_  generation:  6.425383806228638
local_output_nid generation:  0.14491581916809082
local_in_edges_tensor generation:  0.46489381790161133
mini_batch_src_global generation:  0.6438381671905518
r_  generation:  6.576667308807373
local_output_nid generation:  0.1675252914428711
local_in_edges_tensor generation:  0.4171454906463623
mini_batch_src_global generation:  0.6350996494293213
r_  generation:  6.744300603866577
local_output_nid generation:  0.1651291847229004
local_in_edges_tensor generation:  0.5819153785705566
mini_batch_src_global generation:  0.6608600616455078
r_  generation:  6.964559555053711
local_output_nid generation:  0.1934044361114502
local_in_edges_tensor generation:  0.4200272560119629
mini_batch_src_global generation:  0.6652827262878418
r_  generation:  6.903459310531616
local_output_nid generation:  0.17156338691711426
local_in_edges_tensor generation:  0.5559284687042236
mini_batch_src_global generation:  0.6909706592559814
r_  generation:  6.9454028606414795
local_output_nid generation:  0.20063161849975586
local_in_edges_tensor generation:  0.429837703704834
mini_batch_src_global generation:  0.6803016662597656
r_  generation:  6.935138463973999
local_output_nid generation:  0.1848163604736328
local_in_edges_tensor generation:  0.54754638671875
mini_batch_src_global generation:  0.7015993595123291
r_  generation:  6.96765398979187
local_output_nid generation:  0.21180510520935059
local_in_edges_tensor generation:  0.43799376487731934
mini_batch_src_global generation:  0.7130401134490967
r_  generation:  6.968478202819824
local_output_nid generation:  0.17975950241088867
local_in_edges_tensor generation:  0.5651979446411133
mini_batch_src_global generation:  0.7085354328155518
r_  generation:  6.989660263061523
local_output_nid generation:  0.21402263641357422
local_in_edges_tensor generation:  0.4492373466491699
mini_batch_src_global generation:  0.7198574542999268
r_  generation:  7.00296688079834
local_output_nid generation:  0.18314361572265625
local_in_edges_tensor generation:  0.5698981285095215
mini_batch_src_global generation:  0.7395262718200684
r_  generation:  7.007693529129028
local_output_nid generation:  0.21651196479797363
local_in_edges_tensor generation:  0.44293951988220215
mini_batch_src_global generation:  0.7172961235046387
r_  generation:  6.99512505531311
local_output_nid generation:  0.18286991119384766
local_in_edges_tensor generation:  0.5630180835723877
mini_batch_src_global generation:  0.7642860412597656
r_  generation:  6.964849948883057
local_output_nid generation:  0.21593737602233887
local_in_edges_tensor generation:  0.4408571720123291
mini_batch_src_global generation:  0.713137149810791
r_  generation:  6.980032682418823
local_output_nid generation:  0.18384456634521484
local_in_edges_tensor generation:  0.5644185543060303
mini_batch_src_global generation:  0.7474105358123779
r_  generation:  6.991052150726318
----------------------check_connections_block total spend ----------------------------- 151.85918045043945
generate_one_block  9.441106081008911
generate_one_block  9.866368293762207
generate_one_block  9.064664840698242
generate_one_block  9.388925552368164
generate_one_block  9.093496799468994
generate_one_block  9.390396356582642
generate_one_block  8.968943119049072
generate_one_block  9.38844919204712
generate_one_block  8.994942426681519
generate_one_block  9.55868148803711
generate_one_block  9.041052341461182
generate_one_block  9.419202089309692
generate_one_block  9.017930030822754
generate_one_block  9.408046245574951
generate_one_block  8.966901540756226
generate_one_block  9.379876136779785
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1037957668304443
gen group dst list time:  1.052135705947876
time for parepare:  0.48464226722717285
local_output_nid generation:  0.4734330177307129
local_in_edges_tensor generation:  1.1219782829284668
mini_batch_src_global generation:  1.1060307025909424
r_  generation:  15.205527067184448
local_output_nid generation:  0.5750870704650879
local_in_edges_tensor generation:  1.2044601440429688
mini_batch_src_global generation:  1.3861570358276367
r_  generation:  15.355124950408936
local_output_nid generation:  0.6078529357910156
local_in_edges_tensor generation:  1.3427934646606445
mini_batch_src_global generation:  1.3941690921783447
r_  generation:  15.4673011302948
local_output_nid generation:  0.6142754554748535
local_in_edges_tensor generation:  1.206554889678955
mini_batch_src_global generation:  1.41487455368042
r_  generation:  15.437424182891846
local_output_nid generation:  0.5989334583282471
local_in_edges_tensor generation:  1.2326691150665283
mini_batch_src_global generation:  1.4461421966552734
r_  generation:  15.489034414291382
local_output_nid generation:  0.6040329933166504
local_in_edges_tensor generation:  1.2085964679718018
mini_batch_src_global generation:  1.4882681369781494
r_  generation:  15.500341176986694
local_output_nid generation:  0.6188302040100098
local_in_edges_tensor generation:  1.2102856636047363
mini_batch_src_global generation:  1.4808757305145264
r_  generation:  15.54480242729187
local_output_nid generation:  0.6150994300842285
local_in_edges_tensor generation:  1.2229406833648682
mini_batch_src_global generation:  1.4817297458648682
r_  generation:  15.529755592346191
local_output_nid generation:  0.6257781982421875
local_in_edges_tensor generation:  1.2295048236846924
mini_batch_src_global generation:  1.441129207611084
r_  generation:  15.536120176315308
local_output_nid generation:  0.6224234104156494
local_in_edges_tensor generation:  1.2292766571044922
mini_batch_src_global generation:  1.4747669696807861
r_  generation:  15.557779550552368
local_output_nid generation:  0.6415214538574219
local_in_edges_tensor generation:  1.2421889305114746
mini_batch_src_global generation:  1.4603052139282227
r_  generation:  15.591830015182495
local_output_nid generation:  0.6159601211547852
local_in_edges_tensor generation:  1.2371101379394531
mini_batch_src_global generation:  1.5469145774841309
r_  generation:  15.477829694747925
local_output_nid generation:  0.6379725933074951
local_in_edges_tensor generation:  1.1828749179840088
mini_batch_src_global generation:  1.5331182479858398
r_  generation:  15.525121688842773
local_output_nid generation:  0.6242680549621582
local_in_edges_tensor generation:  2.932018995285034
mini_batch_src_global generation:  1.4551584720611572
r_  generation:  15.309659481048584
local_output_nid generation:  0.6447951793670654
local_in_edges_tensor generation:  1.180959701538086
mini_batch_src_global generation:  1.571962594985962
r_  generation:  15.60399603843689
local_output_nid generation:  0.6353945732116699
local_in_edges_tensor generation:  1.2639009952545166
mini_batch_src_global generation:  1.494985580444336
r_  generation:  15.364257097244263
----------------------check_connections_block total spend ----------------------------- 346.3340229988098
generate_one_block  20.95485830307007
generate_one_block  20.82226252555847
generate_one_block  20.88737964630127
generate_one_block  20.902018070220947
generate_one_block  20.835697889328003
generate_one_block  20.79636859893799
generate_one_block  20.78594422340393
generate_one_block  21.24976873397827
generate_one_block  20.77610969543457
generate_one_block  20.86650538444519
generate_one_block  20.803860902786255
generate_one_block  20.74678111076355
generate_one_block  20.7861065864563
generate_one_block  20.72191882133484
generate_one_block  21.061246395111084
generate_one_block  20.88733148574829
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.0212631225585938  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

connection checking time:  498.19320344924927
block generation total time  482.2731409072876
average batch blocks generation time:  30.142071306705475
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2092556953430176  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.939788818359375  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2083725929260254  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.940782070159912  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.208857536315918  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.943281650543213  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2093019485473633  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.942385673522949  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2096118927001953  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9375152587890625  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2065424919128418  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9326629638671875  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2091398239135742  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.93941068649292  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2096266746520996  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9413628578186035  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2098088264465332  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.939484119415283  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2103686332702637  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9433159828186035  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2087740898132324  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9436254501342773  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2082014083862305  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.938868522644043  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2101964950561523  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9436635971069336  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2083015441894531  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9358901977539062  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2073473930358887  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9384994506835938  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2080693244934082  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9384942054748535  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2810109406709671 |0.3064216822385788 |0.0037600696086883545 |0.00013794004917144775 |0.004892945289611816 |0.002598285675048828 |
----------------------------------------------------------pseudo_mini_loss sum 5.109989643096924
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  70326610
Number of first layer input nodes during this epoch:  34745928
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.0229592323303223  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6364893913269043
range selection method range initialization spend 0.025934219360351562
time for parepare:  0.35367488861083984
local_output_nid generation:  0.003535032272338867
local_in_edges_tensor generation:  0.02701258659362793
mini_batch_src_global generation:  0.027779579162597656
r_  generation:  0.36823248863220215
local_output_nid generation:  0.003756284713745117
local_in_edges_tensor generation:  0.009731292724609375
mini_batch_src_global generation:  0.03512263298034668
r_  generation:  0.40351152420043945
local_output_nid generation:  0.0037212371826171875
local_in_edges_tensor generation:  0.009377479553222656
mini_batch_src_global generation:  0.024484872817993164
r_  generation:  0.4237353801727295
local_output_nid generation:  0.003783702850341797
local_in_edges_tensor generation:  0.006571769714355469
mini_batch_src_global generation:  0.027028322219848633
r_  generation:  0.44870758056640625
local_output_nid generation:  0.003770112991333008
local_in_edges_tensor generation:  0.005530834197998047
mini_batch_src_global generation:  0.028192758560180664
r_  generation:  0.4721653461456299
local_output_nid generation:  0.0037834644317626953
local_in_edges_tensor generation:  0.005458354949951172
mini_batch_src_global generation:  0.032773494720458984
r_  generation:  0.4925816059112549
local_output_nid generation:  0.0037047863006591797
local_in_edges_tensor generation:  0.0054972171783447266
mini_batch_src_global generation:  0.03241109848022461
r_  generation:  0.5034229755401611
local_output_nid generation:  0.0037391185760498047
local_in_edges_tensor generation:  0.006531953811645508
mini_batch_src_global generation:  0.03348088264465332
r_  generation:  0.5076479911804199
local_output_nid generation:  0.003734588623046875
local_in_edges_tensor generation:  0.006679534912109375
mini_batch_src_global generation:  0.0363614559173584
r_  generation:  0.5133929252624512
local_output_nid generation:  0.003719806671142578
local_in_edges_tensor generation:  0.006638526916503906
mini_batch_src_global generation:  0.03622579574584961
r_  generation:  0.5143377780914307
local_output_nid generation:  0.003720521926879883
local_in_edges_tensor generation:  0.0066585540771484375
mini_batch_src_global generation:  0.03742694854736328
r_  generation:  0.5228853225708008
local_output_nid generation:  0.003765583038330078
local_in_edges_tensor generation:  0.006639719009399414
mini_batch_src_global generation:  0.03915810585021973
r_  generation:  0.5275650024414062
local_output_nid generation:  0.003718137741088867
local_in_edges_tensor generation:  0.007467508316040039
mini_batch_src_global generation:  0.04011726379394531
r_  generation:  0.5267016887664795
local_output_nid generation:  0.003743410110473633
local_in_edges_tensor generation:  0.0056498050689697266
mini_batch_src_global generation:  0.0413053035736084
r_  generation:  0.5338633060455322
local_output_nid generation:  0.003728151321411133
local_in_edges_tensor generation:  0.005523681640625
mini_batch_src_global generation:  0.04267168045043945
r_  generation:  0.5327436923980713
local_output_nid generation:  0.0037436485290527344
local_in_edges_tensor generation:  0.005450010299682617
mini_batch_src_global generation:  0.0471644401550293
r_  generation:  0.530595064163208
----------------------check_connections_block total spend ----------------------------- 10.277807235717773
generate_one_block  0.8779950141906738
generate_one_block  0.533423900604248
generate_one_block  0.5147302150726318
generate_one_block  0.5181121826171875
generate_one_block  0.5160396099090576
generate_one_block  0.5190472602844238
generate_one_block  0.5152592658996582
generate_one_block  0.5125327110290527
generate_one_block  0.5150384902954102
generate_one_block  0.5194153785705566
generate_one_block  0.5127060413360596
generate_one_block  0.5224804878234863
generate_one_block  0.5223994255065918
generate_one_block  0.511552095413208
generate_one_block  0.5110430717468262
generate_one_block  0.5074183940887451
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1405131816864014
gen group dst list time:  0.2371535301208496
time for parepare:  0.4203481674194336
local_output_nid generation:  0.1171107292175293
local_in_edges_tensor generation:  0.3915431499481201
mini_batch_src_global generation:  0.5479466915130615
r_  generation:  6.6262712478637695
local_output_nid generation:  0.1585249900817871
local_in_edges_tensor generation:  0.5993998050689697
mini_batch_src_global generation:  0.6480281352996826
r_  generation:  6.658888816833496
local_output_nid generation:  0.16648054122924805
local_in_edges_tensor generation:  0.49508094787597656
mini_batch_src_global generation:  0.7012851238250732
r_  generation:  6.865619421005249
local_output_nid generation:  0.18107080459594727
local_in_edges_tensor generation:  0.49196672439575195
mini_batch_src_global generation:  0.6497287750244141
r_  generation:  6.830492734909058
local_output_nid generation:  0.18091654777526855
local_in_edges_tensor generation:  0.4439122676849365
mini_batch_src_global generation:  0.6858763694763184
r_  generation:  7.107352256774902
local_output_nid generation:  0.18926453590393066
local_in_edges_tensor generation:  0.5460431575775146
mini_batch_src_global generation:  0.7025611400604248
r_  generation:  6.857226133346558
local_output_nid generation:  0.18154215812683105
local_in_edges_tensor generation:  0.44090986251831055
mini_batch_src_global generation:  0.6987240314483643
r_  generation:  6.963176488876343
local_output_nid generation:  0.1758558750152588
local_in_edges_tensor generation:  0.5069944858551025
mini_batch_src_global generation:  0.7480659484863281
r_  generation:  7.025917053222656
local_output_nid generation:  0.1983933448791504
local_in_edges_tensor generation:  0.49915647506713867
mini_batch_src_global generation:  0.6936709880828857
r_  generation:  6.948801040649414
local_output_nid generation:  0.1910874843597412
local_in_edges_tensor generation:  0.45102882385253906
mini_batch_src_global generation:  0.6994867324829102
r_  generation:  7.2282233238220215
local_output_nid generation:  0.21129417419433594
local_in_edges_tensor generation:  0.5734810829162598
mini_batch_src_global generation:  0.7003226280212402
r_  generation:  6.979158163070679
local_output_nid generation:  0.1931288242340088
local_in_edges_tensor generation:  0.453981876373291
mini_batch_src_global generation:  0.7057602405548096
r_  generation:  7.034005880355835
local_output_nid generation:  0.1835765838623047
local_in_edges_tensor generation:  0.5222234725952148
mini_batch_src_global generation:  0.7380709648132324
r_  generation:  7.138312816619873
local_output_nid generation:  0.20683622360229492
local_in_edges_tensor generation:  0.514214277267456
mini_batch_src_global generation:  0.7013964653015137
r_  generation:  7.0029895305633545
local_output_nid generation:  0.20193791389465332
local_in_edges_tensor generation:  0.45929861068725586
mini_batch_src_global generation:  0.702233076095581
r_  generation:  7.1594016551971436
local_output_nid generation:  0.18446731567382812
local_in_edges_tensor generation:  0.5942738056182861
mini_batch_src_global generation:  0.7509164810180664
r_  generation:  6.892240047454834
----------------------check_connections_block total spend ----------------------------- 153.07332825660706
generate_one_block  9.553694486618042
generate_one_block  9.543155193328857
generate_one_block  9.430084705352783
generate_one_block  9.16942811012268
generate_one_block  9.1731858253479
generate_one_block  9.298882007598877
generate_one_block  9.146107196807861
generate_one_block  9.411223649978638
generate_one_block  9.04912805557251
generate_one_block  9.259865045547485
generate_one_block  9.44551944732666
generate_one_block  9.222551345825195
generate_one_block  9.128382921218872
generate_one_block  9.405089616775513
generate_one_block  9.265146255493164
generate_one_block  9.393288850784302
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2433910369873047
gen group dst list time:  1.031559944152832
time for parepare:  0.4668691158294678
local_output_nid generation:  0.4788949489593506
local_in_edges_tensor generation:  1.3831093311309814
mini_batch_src_global generation:  1.1257119178771973
r_  generation:  14.861448049545288
local_output_nid generation:  0.6005730628967285
local_in_edges_tensor generation:  1.1865959167480469
mini_batch_src_global generation:  1.4900357723236084
r_  generation:  15.080777168273926
local_output_nid generation:  0.5802419185638428
local_in_edges_tensor generation:  1.2632272243499756
mini_batch_src_global generation:  1.4955775737762451
r_  generation:  15.127066373825073
local_output_nid generation:  0.6034986972808838
local_in_edges_tensor generation:  1.090942621231079
mini_batch_src_global generation:  1.6254167556762695
r_  generation:  15.057239055633545
local_output_nid generation:  0.6262304782867432
local_in_edges_tensor generation:  1.2119226455688477
mini_batch_src_global generation:  1.7664790153503418
r_  generation:  15.609707832336426
local_output_nid generation:  0.6163806915283203
local_in_edges_tensor generation:  1.2572333812713623
mini_batch_src_global generation:  1.556934118270874
r_  generation:  15.300831317901611
local_output_nid generation:  0.6075699329376221
local_in_edges_tensor generation:  1.2304816246032715
mini_batch_src_global generation:  1.51165771484375
r_  generation:  15.157593488693237
local_output_nid generation:  0.6150598526000977
local_in_edges_tensor generation:  1.0991530418395996
mini_batch_src_global generation:  1.643021821975708
r_  generation:  15.147905111312866
local_output_nid generation:  0.6313838958740234
local_in_edges_tensor generation:  1.2304189205169678
mini_batch_src_global generation:  1.5726499557495117
r_  generation:  15.253840208053589
local_output_nid generation:  0.6356446743011475
local_in_edges_tensor generation:  1.235417366027832
mini_batch_src_global generation:  1.4322829246520996
r_  generation:  15.447293758392334
local_output_nid generation:  0.623234748840332
local_in_edges_tensor generation:  1.2200186252593994
mini_batch_src_global generation:  1.4266679286956787
r_  generation:  15.479321479797363
local_output_nid generation:  0.6147899627685547
local_in_edges_tensor generation:  1.2264981269836426
mini_batch_src_global generation:  1.548017978668213
r_  generation:  16.552507162094116
local_output_nid generation:  0.6402294635772705
local_in_edges_tensor generation:  1.2593698501586914
mini_batch_src_global generation:  1.5972604751586914
r_  generation:  15.249182939529419
local_output_nid generation:  0.6465716361999512
local_in_edges_tensor generation:  2.8878016471862793
mini_batch_src_global generation:  1.5181083679199219
r_  generation:  15.062668561935425
local_output_nid generation:  0.6508538722991943
local_in_edges_tensor generation:  1.2533645629882812
mini_batch_src_global generation:  1.6523830890655518
r_  generation:  15.388280868530273
local_output_nid generation:  0.6380300521850586
local_in_edges_tensor generation:  1.2591166496276855
mini_batch_src_global generation:  1.4375600814819336
r_  generation:  15.565008163452148
----------------------check_connections_block total spend ----------------------------- 344.6051366329193
generate_one_block  20.77440357208252
generate_one_block  20.610482454299927
generate_one_block  20.455034017562866
generate_one_block  19.86888551712036
generate_one_block  20.36087703704834
generate_one_block  20.556825399398804
generate_one_block  20.522343397140503
generate_one_block  21.010523319244385
generate_one_block  20.737229585647583
generate_one_block  20.784731149673462
generate_one_block  20.68322730064392
generate_one_block  20.045562982559204
generate_one_block  20.388779878616333
generate_one_block  20.45900273323059
generate_one_block  20.462923526763916
generate_one_block  20.613622188568115
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.0229592323303223  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

connection checking time:  497.67846488952637
block generation total time  477.22918677330017
average batch blocks generation time:  29.82682417333126
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2092456817626953  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.944453239440918  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2085394859313965  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9358725547790527  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.209902286529541  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.942202091217041  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2068934440612793  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.935760974884033  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2086482048034668  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9427247047424316  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2109241485595703  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.941967010498047  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2070536613464355  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.933022975921631  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2062792778015137  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.934945583343506  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2051424980163574  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9323554039001465  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 1.2092580795288086  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0926513671875 GB
    Memory Allocated: 2.9387431144714355  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2103791236877441  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.944399833679199  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.208683967590332  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.940478801727295  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2109503746032715  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9426393508911133  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2097768783569336  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.944852352142334  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2108535766601562  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9498672485351562  GigaBytes
Max Memory Allocated: 3.6104164123535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2083353996276855  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.940371036529541  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2887839525938034 |0.38209155201911926 |0.004978552460670471 |0.0001370459794998169 |0.011953145265579224 |0.0013637542724609375 |
----------------------------------------------------------pseudo_mini_loss sum 3.707930564880371
Total (block generation + training)time/epoch 1038.2387068271637
Training time/epoch 1648016679.7698953
Training time without block to device /epoch 1648016673.6564305
Training time without total dataloading part /epoch 0.2744636535644531
load block tensor time/epoch 4.6205432415008545
block to device time/epoch 6.113464832305908
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  70341799
Number of first layer input nodes during this epoch:  34748334
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.024125099182129  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6561465263366699
range selection method range initialization spend 0.026035547256469727
time for parepare:  0.3437366485595703
local_output_nid generation:  0.0035665035247802734
local_in_edges_tensor generation:  0.029958248138427734
mini_batch_src_global generation:  0.02951216697692871
r_  generation:  0.36458325386047363
local_output_nid generation:  0.0038063526153564453
local_in_edges_tensor generation:  0.009671449661254883
mini_batch_src_global generation:  0.03787493705749512
r_  generation:  0.4121057987213135
local_output_nid generation:  0.0037603378295898438
local_in_edges_tensor generation:  0.005484104156494141
mini_batch_src_global generation:  0.023232698440551758
r_  generation:  0.4261505603790283
local_output_nid generation:  0.0038166046142578125
local_in_edges_tensor generation:  0.006689310073852539
mini_batch_src_global generation:  0.027363300323486328
r_  generation:  0.4583861827850342
local_output_nid generation:  0.0038309097290039062
local_in_edges_tensor generation:  0.006719112396240234
mini_batch_src_global generation:  0.027991533279418945
r_  generation:  0.48029422760009766
local_output_nid generation:  0.0038187503814697266
local_in_edges_tensor generation:  0.005358457565307617
mini_batch_src_global generation:  0.031249284744262695
r_  generation:  0.49850916862487793
local_output_nid generation:  0.0038030147552490234
local_in_edges_tensor generation:  0.00660252571105957
mini_batch_src_global generation:  0.03542351722717285
r_  generation:  0.5110776424407959
local_output_nid generation:  0.0038695335388183594
local_in_edges_tensor generation:  0.006522655487060547
mini_batch_src_global generation:  0.033513784408569336
r_  generation:  0.5079634189605713
local_output_nid generation:  0.0038084983825683594
local_in_edges_tensor generation:  0.006624460220336914
mini_batch_src_global generation:  0.036240577697753906
r_  generation:  0.5276885032653809
local_output_nid generation:  0.0037686824798583984
local_in_edges_tensor generation:  0.008354663848876953
mini_batch_src_global generation:  0.03602743148803711
r_  generation:  0.5394654273986816
local_output_nid generation:  0.003812074661254883
local_in_edges_tensor generation:  0.006477832794189453
mini_batch_src_global generation:  0.03774237632751465
r_  generation:  0.5311756134033203
local_output_nid generation:  0.0037832260131835938
local_in_edges_tensor generation:  0.005606412887573242
mini_batch_src_global generation:  0.03937530517578125
r_  generation:  0.5375628471374512
local_output_nid generation:  0.003826618194580078
local_in_edges_tensor generation:  0.006551027297973633
mini_batch_src_global generation:  0.04317355155944824
r_  generation:  0.5562126636505127
local_output_nid generation:  0.003954887390136719
local_in_edges_tensor generation:  0.006618022918701172
mini_batch_src_global generation:  0.04147458076477051
r_  generation:  0.5521988868713379
local_output_nid generation:  0.003968954086303711
local_in_edges_tensor generation:  0.005514383316040039
mini_batch_src_global generation:  0.05744147300720215
r_  generation:  0.5373363494873047
local_output_nid generation:  0.003956794738769531
local_in_edges_tensor generation:  0.005395174026489258
mini_batch_src_global generation:  0.043309926986694336
r_  generation:  0.5529203414916992
----------------------check_connections_block total spend ----------------------------- 10.48369574546814
generate_one_block  0.9010121822357178
generate_one_block  0.5370218753814697
generate_one_block  0.5149462223052979
generate_one_block  0.5157303810119629
generate_one_block  0.5176715850830078
generate_one_block  0.5113098621368408
generate_one_block  0.5166764259338379
generate_one_block  0.5137264728546143
generate_one_block  0.5119984149932861
generate_one_block  0.5191988945007324
generate_one_block  0.510260820388794
generate_one_block  0.5095369815826416
generate_one_block  0.5220417976379395
generate_one_block  0.519385814666748
generate_one_block  0.5128476619720459
generate_one_block  0.5115447044372559
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2348897457122803
gen group dst list time:  0.2516045570373535
time for parepare:  0.45409154891967773
local_output_nid generation:  0.12029457092285156
local_in_edges_tensor generation:  0.48656129837036133
mini_batch_src_global generation:  0.5427894592285156
r_  generation:  6.718551397323608
local_output_nid generation:  0.15840482711791992
local_in_edges_tensor generation:  0.5395457744598389
mini_batch_src_global generation:  0.6665346622467041
r_  generation:  6.809619426727295
local_output_nid generation:  0.1710827350616455
local_in_edges_tensor generation:  0.5404367446899414
mini_batch_src_global generation:  0.7005195617675781
r_  generation:  6.690459966659546
local_output_nid generation:  0.1817305088043213
local_in_edges_tensor generation:  0.4329090118408203
mini_batch_src_global generation:  0.6768655776977539
r_  generation:  6.84091591835022
local_output_nid generation:  0.17139863967895508
local_in_edges_tensor generation:  0.4446067810058594
mini_batch_src_global generation:  0.753610372543335
r_  generation:  7.120280504226685
local_output_nid generation:  0.19330286979675293
local_in_edges_tensor generation:  0.5835492610931396
mini_batch_src_global generation:  0.6931314468383789
r_  generation:  6.8767547607421875
local_output_nid generation:  0.1894054412841797
local_in_edges_tensor generation:  0.43801331520080566
mini_batch_src_global generation:  0.706683874130249
r_  generation:  7.045909643173218
local_output_nid generation:  0.17929768562316895
local_in_edges_tensor generation:  0.5595145225524902
mini_batch_src_global generation:  0.782987117767334
r_  generation:  6.8633506298065186
local_output_nid generation:  0.18776917457580566
local_in_edges_tensor generation:  0.43622350692749023
mini_batch_src_global generation:  0.6960363388061523
r_  generation:  6.934935808181763
local_output_nid generation:  0.18822526931762695
local_in_edges_tensor generation:  0.4399912357330322
mini_batch_src_global generation:  0.7367696762084961
r_  generation:  7.141136884689331
local_output_nid generation:  0.20190811157226562
local_in_edges_tensor generation:  0.5859091281890869
mini_batch_src_global generation:  0.702507495880127
r_  generation:  6.938985586166382
local_output_nid generation:  0.19068312644958496
local_in_edges_tensor generation:  0.44165587425231934
mini_batch_src_global generation:  0.7290146350860596
r_  generation:  7.0767388343811035
local_output_nid generation:  0.17987298965454102
local_in_edges_tensor generation:  0.531409740447998
mini_batch_src_global generation:  0.7260167598724365
r_  generation:  7.063997507095337
local_output_nid generation:  0.20357894897460938
local_in_edges_tensor generation:  0.4837372303009033
mini_batch_src_global generation:  0.6990928649902344
r_  generation:  6.971447229385376
local_output_nid generation:  0.19260454177856445
local_in_edges_tensor generation:  0.44562244415283203
mini_batch_src_global generation:  0.7334966659545898
r_  generation:  7.156438112258911
local_output_nid generation:  0.2041304111480713
local_in_edges_tensor generation:  0.5722219944000244
mini_batch_src_global generation:  0.7023019790649414
r_  generation:  6.893176078796387
----------------------check_connections_block total spend ----------------------------- 152.90046668052673
generate_one_block  9.559920310974121
generate_one_block  9.49748945236206
generate_one_block  9.51000452041626
generate_one_block  9.191816568374634
generate_one_block  9.365933179855347
generate_one_block  9.105126142501831
generate_one_block  9.025673627853394
generate_one_block  9.48087739944458
generate_one_block  9.158531427383423
generate_one_block  9.540254592895508
generate_one_block  9.139451503753662
generate_one_block  9.09354019165039
generate_one_block  9.523576498031616
generate_one_block  9.153090000152588
generate_one_block  9.372820377349854
generate_one_block  9.099296808242798
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.174884796142578
gen group dst list time:  0.9915189743041992
time for parepare:  0.4550752639770508
local_output_nid generation:  0.46643638610839844
local_in_edges_tensor generation:  1.137209415435791
mini_batch_src_global generation:  1.0925235748291016
r_  generation:  14.43650484085083
local_output_nid generation:  0.5588161945343018
local_in_edges_tensor generation:  1.1433100700378418
mini_batch_src_global generation:  1.4654295444488525
r_  generation:  14.751991033554077
local_output_nid generation:  0.5932564735412598
local_in_edges_tensor generation:  1.1516046524047852
mini_batch_src_global generation:  1.4840717315673828
r_  generation:  15.321897745132446
local_output_nid generation:  0.5962026119232178
local_in_edges_tensor generation:  1.3946731090545654
mini_batch_src_global generation:  1.43259596824646
r_  generation:  15.352630138397217
local_output_nid generation:  0.5924661159515381
local_in_edges_tensor generation:  1.2128896713256836
mini_batch_src_global generation:  1.4611551761627197
r_  generation:  15.245784521102905
local_output_nid generation:  0.5987594127655029
local_in_edges_tensor generation:  1.1490464210510254
mini_batch_src_global generation:  1.4972267150878906
r_  generation:  15.034292936325073
local_output_nid generation:  0.6256635189056396
local_in_edges_tensor generation:  1.165785789489746
mini_batch_src_global generation:  1.5718724727630615
r_  generation:  15.406478643417358
local_output_nid generation:  0.6058197021484375
local_in_edges_tensor generation:  1.227893590927124
mini_batch_src_global generation:  1.45975661277771
r_  generation:  15.494843244552612
local_output_nid generation:  0.6092410087585449
local_in_edges_tensor generation:  1.222959041595459
mini_batch_src_global generation:  1.4509990215301514
r_  generation:  15.287906408309937
local_output_nid generation:  0.6103992462158203
local_in_edges_tensor generation:  1.2154273986816406
mini_batch_src_global generation:  1.5239744186401367
r_  generation:  15.118198871612549
local_output_nid generation:  0.6295759677886963
local_in_edges_tensor generation:  1.0923807621002197
mini_batch_src_global generation:  1.630056381225586
r_  generation:  15.328808069229126
local_output_nid generation:  0.6230382919311523
local_in_edges_tensor generation:  1.2287259101867676
mini_batch_src_global generation:  1.4742591381072998
r_  generation:  15.34737753868103
local_output_nid generation:  0.6121842861175537
local_in_edges_tensor generation:  1.2215044498443604
mini_batch_src_global generation:  1.422104835510254
r_  generation:  15.399491548538208
local_output_nid generation:  0.5968818664550781
local_in_edges_tensor generation:  2.849362373352051
mini_batch_src_global generation:  1.4641642570495605
r_  generation:  15.245857000350952
local_output_nid generation:  0.6014404296875
local_in_edges_tensor generation:  1.2403604984283447
mini_batch_src_global generation:  1.4949119091033936
r_  generation:  15.30940318107605
local_output_nid generation:  0.643012285232544
local_in_edges_tensor generation:  1.089956283569336
mini_batch_src_global generation:  1.5141913890838623
r_  generation:  15.087600469589233
----------------------check_connections_block total spend ----------------------------- 340.2616181373596
generate_one_block  20.50904655456543
generate_one_block  20.37583899497986
generate_one_block  20.418083667755127
generate_one_block  20.658883810043335
generate_one_block  20.50836753845215
generate_one_block  20.46719717979431
generate_one_block  20.11967706680298
generate_one_block  20.92156958580017
generate_one_block  20.46037769317627
generate_one_block  20.421714782714844
generate_one_block  20.40114951133728
generate_one_block  20.446537733078003
generate_one_block  20.537062406539917
generate_one_block  20.506957054138184
generate_one_block  20.44315481185913
generate_one_block  20.59795570373535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.024125099182129  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

connection checking time:  493.16208481788635
block generation total time  476.6109766960144
average batch blocks generation time:  29.7881860435009
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.208508014678955  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9378104209899902  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2072696685791016  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.934950828552246  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.210263729095459  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.944582939147949  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2107925415039062  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.949911117553711  GigaBytes
Max Memory Allocated: 3.6152877807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2094712257385254  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.941904067993164  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.20819091796875  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.937154769897461  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2098298072814941  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.942378520965576  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2084417343139648  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9382643699645996  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.208479404449463  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9364066123962402  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2082138061523438  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9379143714904785  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2083802223205566  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9407763481140137  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2059965133666992  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9323930740356445  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2104644775390625  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.947889804840088  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.209367275238037  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.941580295562744  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2077889442443848  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9367146492004395  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2083277702331543  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9377503395080566  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2935255616903305 |0.3946287930011749 |0.004163876175880432 |0.00014954805374145508 |0.005366295576095581 |0.0012378692626953125 |
----------------------------------------------------------pseudo_mini_loss sum 3.116820812225342
Total (block generation + training)time/epoch 1035.8659846782684
Training time/epoch 1648017713.2636123
Training time without block to device /epoch 1648017706.9495516
Training time without total dataloading part /epoch 0.1561133861541748
load block tensor time/epoch 4.696408987045288
block to device time/epoch 6.314060688018799
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  70334808
Number of first layer input nodes during this epoch:  34743330
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.0239686965942383  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6701259613037109
range selection method range initialization spend 0.027743816375732422
time for parepare:  0.3832693099975586
local_output_nid generation:  0.0036385059356689453
local_in_edges_tensor generation:  0.03320121765136719
mini_batch_src_global generation:  0.027803421020507812
r_  generation:  0.3662106990814209
local_output_nid generation:  0.0037822723388671875
local_in_edges_tensor generation:  0.00965428352355957
mini_batch_src_global generation:  0.03502655029296875
r_  generation:  0.4130396842956543
local_output_nid generation:  0.003674030303955078
local_in_edges_tensor generation:  0.010700464248657227
mini_batch_src_global generation:  0.02465224266052246
r_  generation:  0.4268374443054199
local_output_nid generation:  0.003929853439331055
local_in_edges_tensor generation:  0.010991334915161133
mini_batch_src_global generation:  0.027182579040527344
r_  generation:  0.45147037506103516
local_output_nid generation:  0.003705739974975586
local_in_edges_tensor generation:  0.006377696990966797
mini_batch_src_global generation:  0.029231786727905273
r_  generation:  0.4736747741699219
local_output_nid generation:  0.0037806034088134766
local_in_edges_tensor generation:  0.010588884353637695
mini_batch_src_global generation:  0.030970096588134766
r_  generation:  0.5016882419586182
local_output_nid generation:  0.003744840621948242
local_in_edges_tensor generation:  0.007453203201293945
mini_batch_src_global generation:  0.0340723991394043
r_  generation:  0.5376334190368652
local_output_nid generation:  0.003767251968383789
local_in_edges_tensor generation:  0.007474422454833984
mini_batch_src_global generation:  0.033304691314697266
r_  generation:  0.5228257179260254
local_output_nid generation:  0.0038404464721679688
local_in_edges_tensor generation:  0.012123584747314453
mini_batch_src_global generation:  0.036707162857055664
r_  generation:  0.5263159275054932
local_output_nid generation:  0.0038824081420898438
local_in_edges_tensor generation:  0.006649971008300781
mini_batch_src_global generation:  0.03594517707824707
r_  generation:  0.5357639789581299
local_output_nid generation:  0.0039026737213134766
local_in_edges_tensor generation:  0.006379365921020508
mini_batch_src_global generation:  0.038762807846069336
r_  generation:  0.5472204685211182
local_output_nid generation:  0.003902435302734375
local_in_edges_tensor generation:  0.006583452224731445
mini_batch_src_global generation:  0.042725563049316406
r_  generation:  0.5320343971252441
local_output_nid generation:  0.0039217472076416016
local_in_edges_tensor generation:  0.007724285125732422
mini_batch_src_global generation:  0.04089927673339844
r_  generation:  0.5566692352294922
local_output_nid generation:  0.0039520263671875
local_in_edges_tensor generation:  0.006455898284912109
mini_batch_src_global generation:  0.05059933662414551
r_  generation:  0.5317254066467285
local_output_nid generation:  0.0040264129638671875
local_in_edges_tensor generation:  0.007944583892822266
mini_batch_src_global generation:  0.042082786560058594
r_  generation:  0.5294923782348633
local_output_nid generation:  0.0039522647857666016
local_in_edges_tensor generation:  0.006438732147216797
mini_batch_src_global generation:  0.04236125946044922
r_  generation:  0.5305743217468262
----------------------check_connections_block total spend ----------------------------- 10.574025392532349
generate_one_block  0.8922138214111328
generate_one_block  0.5465314388275146
generate_one_block  0.5215449333190918
generate_one_block  0.5122952461242676
generate_one_block  0.5159425735473633
generate_one_block  0.5083835124969482
generate_one_block  0.525031328201294
generate_one_block  0.5281929969787598
generate_one_block  0.5189225673675537
generate_one_block  0.5252935886383057
generate_one_block  0.5329282283782959
generate_one_block  0.531524658203125
generate_one_block  0.5384824275970459
generate_one_block  0.5181796550750732
generate_one_block  0.5176219940185547
generate_one_block  0.5456089973449707
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.240797519683838
gen group dst list time:  0.24572110176086426
time for parepare:  0.47049546241760254
local_output_nid generation:  0.12344670295715332
local_in_edges_tensor generation:  0.4354889392852783
mini_batch_src_global generation:  0.5331571102142334
r_  generation:  6.393325090408325
local_output_nid generation:  0.15669679641723633
local_in_edges_tensor generation:  0.3999669551849365
mini_batch_src_global generation:  0.6612658500671387
r_  generation:  6.940723657608032
local_output_nid generation:  0.18333673477172852
local_in_edges_tensor generation:  0.6171262264251709
mini_batch_src_global generation:  0.6540863513946533
r_  generation:  6.675691366195679
local_output_nid generation:  0.17550420761108398
local_in_edges_tensor generation:  0.4690372943878174
mini_batch_src_global generation:  0.667583703994751
r_  generation:  6.870312929153442
local_output_nid generation:  0.17765569686889648
local_in_edges_tensor generation:  0.4993722438812256
mini_batch_src_global generation:  0.7233457565307617
r_  generation:  6.977778673171997
local_output_nid generation:  0.19157624244689941
local_in_edges_tensor generation:  0.49787044525146484
mini_batch_src_global generation:  0.684516191482544
r_  generation:  6.920242071151733
local_output_nid generation:  0.1840355396270752
local_in_edges_tensor generation:  0.4502592086791992
mini_batch_src_global generation:  0.6979005336761475
r_  generation:  7.201438665390015
local_output_nid generation:  0.20007896423339844
local_in_edges_tensor generation:  0.569340705871582
mini_batch_src_global generation:  0.7006828784942627
r_  generation:  6.9089484214782715
local_output_nid generation:  0.18895745277404785
local_in_edges_tensor generation:  0.46368837356567383
mini_batch_src_global generation:  0.6951873302459717
r_  generation:  6.946955442428589
local_output_nid generation:  0.1801438331604004
local_in_edges_tensor generation:  0.527073860168457
mini_batch_src_global generation:  0.7533538341522217
r_  generation:  7.081315517425537
local_output_nid generation:  0.2008056640625
local_in_edges_tensor generation:  0.5133652687072754
mini_batch_src_global generation:  0.6958127021789551
r_  generation:  6.977788925170898
local_output_nid generation:  0.19218802452087402
local_in_edges_tensor generation:  0.46260499954223633
mini_batch_src_global generation:  0.705101728439331
r_  generation:  7.226606369018555
local_output_nid generation:  0.20284008979797363
local_in_edges_tensor generation:  0.5871915817260742
mini_batch_src_global generation:  0.7014391422271729
r_  generation:  6.926377058029175
local_output_nid generation:  0.19566774368286133
local_in_edges_tensor generation:  0.46822357177734375
mini_batch_src_global generation:  0.7028522491455078
r_  generation:  7.014887571334839
local_output_nid generation:  0.18031930923461914
local_in_edges_tensor generation:  0.5264663696289062
mini_batch_src_global generation:  0.743851900100708
r_  generation:  7.08669376373291
local_output_nid generation:  0.20543742179870605
local_in_edges_tensor generation:  0.5283463001251221
mini_batch_src_global generation:  0.7011725902557373
r_  generation:  6.99406361579895
----------------------check_connections_block total spend ----------------------------- 152.76684856414795
generate_one_block  9.65672254562378
generate_one_block  9.920552968978882
generate_one_block  9.071809768676758
generate_one_block  9.025310039520264
generate_one_block  9.394157886505127
generate_one_block  9.173988819122314
generate_one_block  9.400177717208862
generate_one_block  9.15233588218689
generate_one_block  9.049686431884766
generate_one_block  9.618512868881226
generate_one_block  9.25232720375061
generate_one_block  9.420184135437012
generate_one_block  9.174472332000732
generate_one_block  9.09071683883667
generate_one_block  9.35596776008606
generate_one_block  9.204455614089966
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.118642807006836
gen group dst list time:  0.9817650318145752
time for parepare:  0.4731409549713135
local_output_nid generation:  0.49775195121765137
local_in_edges_tensor generation:  1.1364471912384033
mini_batch_src_global generation:  1.1528010368347168
r_  generation:  14.849112749099731
local_output_nid generation:  0.5924654006958008
local_in_edges_tensor generation:  1.2940285205841064
mini_batch_src_global generation:  1.6218516826629639
r_  generation:  14.753094911575317
local_output_nid generation:  0.5869588851928711
local_in_edges_tensor generation:  1.0670745372772217
mini_batch_src_global generation:  1.5550439357757568
r_  generation:  15.177647590637207
local_output_nid generation:  0.6222507953643799
local_in_edges_tensor generation:  1.1941444873809814
mini_batch_src_global generation:  1.4792437553405762
r_  generation:  15.293981313705444
local_output_nid generation:  0.6075959205627441
local_in_edges_tensor generation:  1.2009084224700928
mini_batch_src_global generation:  1.4306716918945312
r_  generation:  15.377767324447632
local_output_nid generation:  0.6124675273895264
local_in_edges_tensor generation:  1.236285924911499
mini_batch_src_global generation:  1.5119671821594238
r_  generation:  15.081873893737793
local_output_nid generation:  0.6233508586883545
local_in_edges_tensor generation:  1.1653566360473633
mini_batch_src_global generation:  1.6010591983795166
r_  generation:  15.161678314208984
local_output_nid generation:  0.6281776428222656
local_in_edges_tensor generation:  1.1605582237243652
mini_batch_src_global generation:  1.6074090003967285
r_  generation:  15.188331842422485
local_output_nid generation:  0.6389882564544678
local_in_edges_tensor generation:  1.2264363765716553
mini_batch_src_global generation:  1.5703692436218262
r_  generation:  15.288012742996216
local_output_nid generation:  0.63511061668396
local_in_edges_tensor generation:  1.2423357963562012
mini_batch_src_global generation:  1.4438860416412354
r_  generation:  15.51426100730896
local_output_nid generation:  0.6233878135681152
local_in_edges_tensor generation:  1.2307980060577393
mini_batch_src_global generation:  1.4383461475372314
r_  generation:  15.508890151977539
local_output_nid generation:  0.6302061080932617
local_in_edges_tensor generation:  1.2365806102752686
mini_batch_src_global generation:  1.5081608295440674
r_  generation:  15.262014865875244
local_output_nid generation:  0.6213674545288086
local_in_edges_tensor generation:  1.2514309883117676
mini_batch_src_global generation:  1.59969162940979
r_  generation:  15.112905740737915
local_output_nid generation:  0.6259000301361084
local_in_edges_tensor generation:  2.77801513671875
mini_batch_src_global generation:  1.5080506801605225
r_  generation:  15.075955390930176
local_output_nid generation:  0.6360304355621338
local_in_edges_tensor generation:  1.2305917739868164
mini_batch_src_global generation:  1.5594062805175781
r_  generation:  15.326650857925415
local_output_nid generation:  0.6471254825592041
local_in_edges_tensor generation:  1.2283508777618408
mini_batch_src_global generation:  1.5935204029083252
r_  generation:  15.48311734199524
----------------------check_connections_block total spend ----------------------------- 342.6051437854767
generate_one_block  20.577176809310913
generate_one_block  20.730449438095093
generate_one_block  20.327643632888794
generate_one_block  20.426608562469482
generate_one_block  20.514513731002808
generate_one_block  20.482892990112305
generate_one_block  20.514662504196167
generate_one_block  20.952139139175415
generate_one_block  20.45400857925415
generate_one_block  20.569418907165527
generate_one_block  20.59052062034607
generate_one_block  20.605666637420654
generate_one_block  20.537593364715576
generate_one_block  20.64414882659912
generate_one_block  20.53734850883484
generate_one_block  20.665786743164062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.0239686965942383  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

connection checking time:  495.37199234962463
block generation total time  478.0919578075409
average batch blocks generation time:  29.880747362971306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.206986904144287  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.934030532836914  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2092385292053223  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9435129165649414  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2100458145141602  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.941250801086426  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2064051628112793  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9340333938598633  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2087225914001465  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9413490295410156  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.206873893737793  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9316887855529785  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2095990180969238  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.942361831665039  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2091212272644043  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9407567977905273  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2066540718078613  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9325451850891113  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2101869583129883  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9451098442077637  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2105116844177246  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9465746879577637  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2095980644226074  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.942288398742676  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2084455490112305  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.938929557800293  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2117033004760742  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9480295181274414  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2055864334106445  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.931032180786133  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2077407836914062  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.938938617706299  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.28896762430667877 |0.3777116686105728 |0.0038078725337982178 |0.000138208270072937 |0.005756258964538574 |0.0026979446411132812 |
----------------------------------------------------------pseudo_mini_loss sum 2.692842721939087
Total (block generation + training)time/epoch 1036.4723070462544
Training time/epoch 1648018750.9489357
Training time without block to device /epoch 1648018744.905549
Training time without total dataloading part /epoch 0.15793538093566895
load block tensor time/epoch 4.62348198890686
block to device time/epoch 6.043386697769165
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  70326609
Number of first layer input nodes during this epoch:  34744611
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.0232057571411133  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6438202857971191
range selection method range initialization spend 0.02509617805480957
time for parepare:  0.3497035503387451
local_output_nid generation:  0.0035622119903564453
local_in_edges_tensor generation:  0.031188488006591797
mini_batch_src_global generation:  0.029520273208618164
r_  generation:  0.3595161437988281
local_output_nid generation:  0.0037794113159179688
local_in_edges_tensor generation:  0.00956273078918457
mini_batch_src_global generation:  0.038019418716430664
r_  generation:  0.40769362449645996
local_output_nid generation:  0.003717660903930664
local_in_edges_tensor generation:  0.009851455688476562
mini_batch_src_global generation:  0.02706599235534668
r_  generation:  0.4206070899963379
local_output_nid generation:  0.0038144588470458984
local_in_edges_tensor generation:  0.008391141891479492
mini_batch_src_global generation:  0.029704570770263672
r_  generation:  0.448976993560791
local_output_nid generation:  0.003740549087524414
local_in_edges_tensor generation:  0.0053424835205078125
mini_batch_src_global generation:  0.028035879135131836
r_  generation:  0.4682197570800781
local_output_nid generation:  0.0037894248962402344
local_in_edges_tensor generation:  0.0053768157958984375
mini_batch_src_global generation:  0.030768632888793945
r_  generation:  0.48971056938171387
local_output_nid generation:  0.0037386417388916016
local_in_edges_tensor generation:  0.0055391788482666016
mini_batch_src_global generation:  0.0318295955657959
r_  generation:  0.49694228172302246
local_output_nid generation:  0.0037555694580078125
local_in_edges_tensor generation:  0.005422115325927734
mini_batch_src_global generation:  0.033005714416503906
r_  generation:  0.5033116340637207
local_output_nid generation:  0.0037391185760498047
local_in_edges_tensor generation:  0.009969949722290039
mini_batch_src_global generation:  0.03598618507385254
r_  generation:  0.5079314708709717
local_output_nid generation:  0.0037462711334228516
local_in_edges_tensor generation:  0.005463123321533203
mini_batch_src_global generation:  0.03619265556335449
r_  generation:  0.5125248432159424
local_output_nid generation:  0.003781557083129883
local_in_edges_tensor generation:  0.007968664169311523
mini_batch_src_global generation:  0.03878450393676758
r_  generation:  0.5226330757141113
local_output_nid generation:  0.003865480422973633
local_in_edges_tensor generation:  0.007882833480834961
mini_batch_src_global generation:  0.038861751556396484
r_  generation:  0.5220284461975098
local_output_nid generation:  0.0037381649017333984
local_in_edges_tensor generation:  0.005527019500732422
mini_batch_src_global generation:  0.04005599021911621
r_  generation:  0.5237529277801514
local_output_nid generation:  0.003735780715942383
local_in_edges_tensor generation:  0.006581306457519531
mini_batch_src_global generation:  0.04035377502441406
r_  generation:  0.5276472568511963
local_output_nid generation:  0.0037059783935546875
local_in_edges_tensor generation:  0.005734920501708984
mini_batch_src_global generation:  0.04191780090332031
r_  generation:  0.5275540351867676
local_output_nid generation:  0.003751039505004883
local_in_edges_tensor generation:  0.00651097297668457
mini_batch_src_global generation:  0.042472124099731445
r_  generation:  0.5241210460662842
----------------------check_connections_block total spend ----------------------------- 10.212036609649658
generate_one_block  0.872046947479248
generate_one_block  0.5281562805175781
generate_one_block  0.5096116065979004
generate_one_block  0.5388152599334717
generate_one_block  0.5165715217590332
generate_one_block  0.5119762420654297
generate_one_block  0.507709264755249
generate_one_block  0.5144422054290771
generate_one_block  0.5151925086975098
generate_one_block  0.5176210403442383
generate_one_block  0.5149993896484375
generate_one_block  0.5119366645812988
generate_one_block  0.5254061222076416
generate_one_block  0.511028528213501
generate_one_block  0.5137059688568115
generate_one_block  0.5136139392852783
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1533396244049072
gen group dst list time:  0.26334667205810547
time for parepare:  0.42725491523742676
local_output_nid generation:  0.11557841300964355
local_in_edges_tensor generation:  0.5213525295257568
mini_batch_src_global generation:  0.5354161262512207
r_  generation:  6.438478946685791
local_output_nid generation:  0.1693098545074463
local_in_edges_tensor generation:  0.4150655269622803
mini_batch_src_global generation:  0.6673734188079834
r_  generation:  6.763026475906372
local_output_nid generation:  0.19405674934387207
local_in_edges_tensor generation:  0.5023431777954102
mini_batch_src_global generation:  0.7026617527008057
r_  generation:  6.83357572555542
local_output_nid generation:  0.20339584350585938
local_in_edges_tensor generation:  0.5021746158599854
mini_batch_src_global generation:  0.668067455291748
r_  generation:  6.906667470932007
local_output_nid generation:  0.19856619834899902
local_in_edges_tensor generation:  0.4392566680908203
mini_batch_src_global generation:  0.7530591487884521
r_  generation:  7.034676551818848
local_output_nid generation:  0.1935124397277832
local_in_edges_tensor generation:  0.5613229274749756
mini_batch_src_global generation:  0.7443499565124512
r_  generation:  6.862433910369873
local_output_nid generation:  0.21376442909240723
local_in_edges_tensor generation:  0.43164753913879395
mini_batch_src_global generation:  0.7018649578094482
r_  generation:  6.9063215255737305
local_output_nid generation:  0.19996118545532227
local_in_edges_tensor generation:  0.4452707767486572
mini_batch_src_global generation:  0.722010612487793
r_  generation:  7.098463535308838
local_output_nid generation:  0.215559720993042
local_in_edges_tensor generation:  0.5562405586242676
mini_batch_src_global generation:  0.6947698593139648
r_  generation:  6.862382888793945
local_output_nid generation:  0.21373271942138672
local_in_edges_tensor generation:  0.44772815704345703
mini_batch_src_global generation:  0.7164485454559326
r_  generation:  7.030888557434082
local_output_nid generation:  0.19967055320739746
local_in_edges_tensor generation:  0.5728714466094971
mini_batch_src_global generation:  0.7821054458618164
r_  generation:  6.934602499008179
local_output_nid generation:  0.21904516220092773
local_in_edges_tensor generation:  0.4467172622680664
mini_batch_src_global generation:  0.7092158794403076
r_  generation:  6.967496633529663
local_output_nid generation:  0.19948649406433105
local_in_edges_tensor generation:  0.4485931396484375
mini_batch_src_global generation:  0.7308013439178467
r_  generation:  7.129243850708008
local_output_nid generation:  0.20613932609558105
local_in_edges_tensor generation:  0.5861034393310547
mini_batch_src_global generation:  0.7000164985656738
r_  generation:  6.902054071426392
local_output_nid generation:  0.1968693733215332
local_in_edges_tensor generation:  0.44274282455444336
mini_batch_src_global generation:  0.7074658870697021
r_  generation:  7.025521993637085
local_output_nid generation:  0.18598532676696777
local_in_edges_tensor generation:  0.5521376132965088
mini_batch_src_global generation:  0.7285182476043701
r_  generation:  6.976278305053711
----------------------check_connections_block total spend ----------------------------- 152.572749376297
generate_one_block  9.441950798034668
generate_one_block  9.664921998977661
generate_one_block  9.353683471679688
generate_one_block  9.124858140945435
generate_one_block  9.066233396530151
generate_one_block  9.435540676116943
generate_one_block  9.17640209197998
generate_one_block  9.428922891616821
generate_one_block  9.065215349197388
generate_one_block  9.266608715057373
generate_one_block  9.389780759811401
generate_one_block  9.148186683654785
generate_one_block  9.419244050979614
generate_one_block  9.146754503250122
generate_one_block  9.036649703979492
generate_one_block  9.419379949569702
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1559531688690186
gen group dst list time:  1.0375282764434814
time for parepare:  0.480485200881958
local_output_nid generation:  0.47000765800476074
local_in_edges_tensor generation:  1.2549147605895996
mini_batch_src_global generation:  1.128119707107544
r_  generation:  14.755180358886719
local_output_nid generation:  0.5739550590515137
local_in_edges_tensor generation:  1.2815487384796143
mini_batch_src_global generation:  1.476090669631958
r_  generation:  14.784216403961182
local_output_nid generation:  0.5659284591674805
local_in_edges_tensor generation:  1.0676329135894775
mini_batch_src_global generation:  1.541689157485962
r_  generation:  14.898316144943237
local_output_nid generation:  0.6029367446899414
local_in_edges_tensor generation:  1.2219481468200684
mini_batch_src_global generation:  1.521317720413208
r_  generation:  14.90459680557251
local_output_nid generation:  0.614952564239502
local_in_edges_tensor generation:  1.2181024551391602
mini_batch_src_global generation:  1.4963090419769287
r_  generation:  15.268045902252197
local_output_nid generation:  0.5930910110473633
local_in_edges_tensor generation:  1.2123355865478516
mini_batch_src_global generation:  1.4595508575439453
r_  generation:  15.303461074829102
local_output_nid generation:  0.5807709693908691
local_in_edges_tensor generation:  1.2174701690673828
mini_batch_src_global generation:  1.4815702438354492
r_  generation:  15.115240812301636
local_output_nid generation:  0.6084895133972168
local_in_edges_tensor generation:  1.0817954540252686
mini_batch_src_global generation:  1.5743255615234375
r_  generation:  15.122022151947021
local_output_nid generation:  0.6269650459289551
local_in_edges_tensor generation:  1.2400906085968018
mini_batch_src_global generation:  1.5217323303222656
r_  generation:  15.34849762916565
local_output_nid generation:  0.604555606842041
local_in_edges_tensor generation:  1.2365825176239014
mini_batch_src_global generation:  1.4261348247528076
r_  generation:  15.390403270721436
local_output_nid generation:  0.6069066524505615
local_in_edges_tensor generation:  1.2385601997375488
mini_batch_src_global generation:  1.4652814865112305
r_  generation:  15.202318668365479
local_output_nid generation:  0.6018030643463135
local_in_edges_tensor generation:  1.0885252952575684
mini_batch_src_global generation:  1.5962929725646973
r_  generation:  15.126927375793457
local_output_nid generation:  0.6473407745361328
local_in_edges_tensor generation:  1.2259681224822998
mini_batch_src_global generation:  1.5272207260131836
r_  generation:  15.425369262695312
local_output_nid generation:  0.6230535507202148
local_in_edges_tensor generation:  2.7139716148376465
mini_batch_src_global generation:  1.4468262195587158
r_  generation:  15.273492813110352
local_output_nid generation:  0.6141552925109863
local_in_edges_tensor generation:  1.2265629768371582
mini_batch_src_global generation:  1.436530351638794
r_  generation:  15.124302387237549
local_output_nid generation:  0.5913290977478027
local_in_edges_tensor generation:  1.0963826179504395
mini_batch_src_global generation:  1.5706241130828857
r_  generation:  15.124335050582886
----------------------check_connections_block total spend ----------------------------- 339.571270942688
generate_one_block  20.54781699180603
generate_one_block  20.496665716171265
generate_one_block  20.549488306045532
generate_one_block  20.400171518325806
generate_one_block  20.48029637336731
generate_one_block  20.574486255645752
generate_one_block  20.533313751220703
generate_one_block  20.996043920516968
generate_one_block  20.53028106689453
generate_one_block  20.59353017807007
generate_one_block  20.54313015937805
generate_one_block  20.555914402008057
generate_one_block  20.56749987602234
generate_one_block  20.48595142364502
generate_one_block  20.737833738327026
generate_one_block  20.571078062057495
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.0232057571411133  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

connection checking time:  492.144020318985
block generation total time  477.7478349208832
average batch blocks generation time:  29.8592396825552
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.206242561340332  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.931948184967041  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2101316452026367  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.943532943725586  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2072930335998535  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9346652030944824  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2083625793457031  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9365696907043457  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2091107368469238  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.940277576446533  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2096538543701172  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.944430351257324  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2062292098999023  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.933839797973633  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2104911804199219  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9462313652038574  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2090449333190918  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.941844940185547  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2112069129943848  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9452786445617676  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2083663940429688  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.940098762512207  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2086167335510254  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9417243003845215  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2112407684326172  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9462900161743164  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2089614868164062  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.937079906463623  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2083892822265625  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.935274124145508  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 1.2089390754699707  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9051513671875 GB
    Memory Allocated: 2.9430885314941406  GigaBytes
Max Memory Allocated: 3.615480422973633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2830899655818939 |0.3727700710296631 |0.0038113445043563843 |0.00014664232730865479 |0.005761727690696716 |0.0011987686157226562 |
----------------------------------------------------------pseudo_mini_loss sum 2.384028673171997
Total (block generation + training)time/epoch 1035.5810094475746
Training time/epoch 1648019783.8562944
Training time without block to device /epoch 1648019777.8919733
Training time without total dataloading part /epoch 0.15671420097351074
load block tensor time/epoch 4.529439449310303
block to device time/epoch 5.964321136474609
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  70332502
Number of first layer input nodes during this epoch: Using backend: pytorch
 34745447
