main start at this time 1648133970.991154
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6831846237182617
range selection method range initialization spend 0.029555320739746094
time for parepare:  0.36488986015319824
local_output_nid generation:  0.0034415721893310547
local_in_edges_tensor generation:  0.03470468521118164
mini_batch_src_global generation:  0.024974584579467773
r_  generation:  0.36247968673706055
local_output_nid generation:  0.003690481185913086
local_in_edges_tensor generation:  0.011907339096069336
mini_batch_src_global generation:  0.036193132400512695
r_  generation:  0.4059939384460449
local_output_nid generation:  0.0036368370056152344
local_in_edges_tensor generation:  0.005593776702880859
mini_batch_src_global generation:  0.023099422454833984
r_  generation:  0.4127023220062256
local_output_nid generation:  0.0037086009979248047
local_in_edges_tensor generation:  0.005179166793823242
mini_batch_src_global generation:  0.02508234977722168
r_  generation:  0.4616525173187256
local_output_nid generation:  0.0036373138427734375
local_in_edges_tensor generation:  0.005128383636474609
mini_batch_src_global generation:  0.02722620964050293
r_  generation:  0.46790313720703125
local_output_nid generation:  0.003726959228515625
local_in_edges_tensor generation:  0.005048990249633789
mini_batch_src_global generation:  0.03040337562561035
r_  generation:  0.49537229537963867
local_output_nid generation:  0.0036191940307617188
local_in_edges_tensor generation:  0.005197286605834961
mini_batch_src_global generation:  0.03162860870361328
r_  generation:  0.49347448348999023
local_output_nid generation:  0.003641366958618164
local_in_edges_tensor generation:  0.0054128170013427734
mini_batch_src_global generation:  0.032358646392822266
r_  generation:  0.5032908916473389
local_output_nid generation:  0.0036361217498779297
local_in_edges_tensor generation:  0.005093812942504883
mini_batch_src_global generation:  0.0337677001953125
r_  generation:  0.5143158435821533
local_output_nid generation:  0.0036475658416748047
local_in_edges_tensor generation:  0.005105733871459961
mini_batch_src_global generation:  0.03491401672363281
r_  generation:  0.509432315826416
local_output_nid generation:  0.003639698028564453
local_in_edges_tensor generation:  0.0053746700286865234
mini_batch_src_global generation:  0.03707170486450195
r_  generation:  0.5144979953765869
local_output_nid generation:  0.003665447235107422
local_in_edges_tensor generation:  0.00544428825378418
mini_batch_src_global generation:  0.03813457489013672
r_  generation:  0.5242583751678467
local_output_nid generation:  0.0037071704864501953
local_in_edges_tensor generation:  0.005242586135864258
mini_batch_src_global generation:  0.038908958435058594
r_  generation:  0.5158517360687256
local_output_nid generation:  0.003635406494140625
local_in_edges_tensor generation:  0.005199909210205078
mini_batch_src_global generation:  0.03919482231140137
r_  generation:  0.5265007019042969
local_output_nid generation:  0.003704071044921875
local_in_edges_tensor generation:  0.005068778991699219
mini_batch_src_global generation:  0.040666818618774414
r_  generation:  0.5262832641601562
local_output_nid generation:  0.0036482810974121094
local_in_edges_tensor generation:  0.006136417388916016
mini_batch_src_global generation:  0.04098367691040039
r_  generation:  0.5252718925476074
----------------------check_connections_block total spend ----------------------------- 10.130230903625488
generate_one_block  5.573776721954346
generate_one_block  0.5000007152557373
generate_one_block  0.5124053955078125
generate_one_block  0.5009777545928955
generate_one_block  0.5023138523101807
generate_one_block  0.5052413940429688
generate_one_block  0.5048608779907227
generate_one_block  0.502633810043335
generate_one_block  0.5031876564025879
generate_one_block  0.5030643939971924
generate_one_block  0.5103247165679932
generate_one_block  0.5030126571655273
generate_one_block  0.495913028717041
generate_one_block  0.5065066814422607
generate_one_block  0.499863862991333
generate_one_block  0.5158910751342773
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5673625469207764
gen group dst list time:  0.25211191177368164
time for parepare:  0.46524691581726074
local_output_nid generation:  0.10844016075134277
local_in_edges_tensor generation:  0.6285560131072998
mini_batch_src_global generation:  0.8990676403045654
r_  generation:  10.22538447380066
local_output_nid generation:  0.1598367691040039
local_in_edges_tensor generation:  0.7082085609436035
mini_batch_src_global generation:  1.1701099872589111
r_  generation:  10.383700609207153
local_output_nid generation:  0.17019033432006836
local_in_edges_tensor generation:  0.7761354446411133
mini_batch_src_global generation:  1.1608619689941406
r_  generation:  10.496851921081543
local_output_nid generation:  0.17913818359375
local_in_edges_tensor generation:  0.7970657348632812
mini_batch_src_global generation:  1.1039953231811523
r_  generation:  10.697064638137817
local_output_nid generation:  0.16668200492858887
local_in_edges_tensor generation:  0.6378848552703857
mini_batch_src_global generation:  1.1670904159545898
r_  generation:  10.659677982330322
local_output_nid generation:  0.19032573699951172
local_in_edges_tensor generation:  0.798149585723877
mini_batch_src_global generation:  1.1258578300476074
r_  generation:  10.955829381942749
local_output_nid generation:  0.16754508018493652
local_in_edges_tensor generation:  0.6762480735778809
mini_batch_src_global generation:  1.153761863708496
r_  generation:  10.637409210205078
local_output_nid generation:  0.1964108943939209
local_in_edges_tensor generation:  0.8031806945800781
mini_batch_src_global generation:  1.1793076992034912
r_  generation:  10.95089840888977
local_output_nid generation:  0.17069149017333984
local_in_edges_tensor generation:  0.8331825733184814
mini_batch_src_global generation:  1.141350269317627
r_  generation:  10.642765998840332
local_output_nid generation:  0.19353461265563965
local_in_edges_tensor generation:  0.6738581657409668
mini_batch_src_global generation:  1.1879384517669678
r_  generation:  10.918583154678345
local_output_nid generation:  0.19929099082946777
local_in_edges_tensor generation:  0.8413028717041016
mini_batch_src_global generation:  1.1472249031066895
r_  generation:  10.896369218826294
local_output_nid generation:  0.17611479759216309
local_in_edges_tensor generation:  0.6551272869110107
mini_batch_src_global generation:  1.22068190574646
r_  generation:  10.82775354385376
local_output_nid generation:  0.20206713676452637
local_in_edges_tensor generation:  0.8368468284606934
mini_batch_src_global generation:  1.1374101638793945
r_  generation:  10.807479619979858
local_output_nid generation:  0.17272353172302246
local_in_edges_tensor generation:  0.6585264205932617
mini_batch_src_global generation:  1.1800816059112549
r_  generation:  10.76641845703125
local_output_nid generation:  0.20552563667297363
local_in_edges_tensor generation:  0.8341555595397949
mini_batch_src_global generation:  1.133091926574707
r_  generation:  11.053925037384033
local_output_nid generation:  0.17728948593139648
local_in_edges_tensor generation:  0.6587963104248047
mini_batch_src_global generation:  1.1608903408050537
r_  generation:  10.684360265731812
----------------------check_connections_block total spend ----------------------------- 233.53637266159058
generate_one_block  15.72712230682373
generate_one_block  15.061365842819214
generate_one_block  14.596600770950317
generate_one_block  15.05851411819458
generate_one_block  14.998785257339478
generate_one_block  14.621402025222778
generate_one_block  15.0782790184021
generate_one_block  14.97754168510437
generate_one_block  14.90177321434021
generate_one_block  15.050506591796875
generate_one_block  15.14009428024292
generate_one_block  14.527513265609741
generate_one_block  15.050234317779541
generate_one_block  15.05927562713623
generate_one_block  14.661312818527222
generate_one_block  14.87170958518982
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.325719118118286
gen group dst list time:  1.0914287567138672
time for parepare:  0.5048224925994873
local_output_nid generation:  0.5187604427337646
local_in_edges_tensor generation:  1.7059326171875
mini_batch_src_global generation:  1.8917653560638428
r_  generation:  23.506237983703613
local_output_nid generation:  0.625826358795166
local_in_edges_tensor generation:  2.0461928844451904
mini_batch_src_global generation:  2.5830929279327393
r_  generation:  23.826255798339844
local_output_nid generation:  0.6382594108581543
local_in_edges_tensor generation:  1.7577223777770996
mini_batch_src_global generation:  2.4344370365142822
r_  generation:  23.81216835975647
local_output_nid generation:  0.6416137218475342
local_in_edges_tensor generation:  1.7935354709625244
mini_batch_src_global generation:  2.5530261993408203
r_  generation:  23.77826166152954
local_output_nid generation:  0.6615793704986572
local_in_edges_tensor generation:  1.8087525367736816
mini_batch_src_global generation:  2.644116163253784
r_  generation:  24.002142190933228
local_output_nid generation:  0.6504082679748535
local_in_edges_tensor generation:  3.236267566680908
mini_batch_src_global generation:  2.5289297103881836
r_  generation:  24.248310804367065
local_output_nid generation:  0.658104419708252
local_in_edges_tensor generation:  1.8192558288574219
mini_batch_src_global generation:  2.753599166870117
r_  generation:  24.310946702957153
local_output_nid generation:  0.6497511863708496
local_in_edges_tensor generation:  1.8120536804199219
mini_batch_src_global generation:  2.766547441482544
r_  generation:  24.197876691818237
local_output_nid generation:  0.6656012535095215
local_in_edges_tensor generation:  1.8123328685760498
mini_batch_src_global generation:  2.5480072498321533
r_  generation:  24.24642038345337
local_output_nid generation:  0.6602013111114502
local_in_edges_tensor generation:  1.854590654373169
mini_batch_src_global generation:  2.700869083404541
r_  generation:  24.252495765686035
local_output_nid generation:  0.657172441482544
local_in_edges_tensor generation:  1.8556342124938965
mini_batch_src_global generation:  2.638524055480957
r_  generation:  24.47727346420288
local_output_nid generation:  0.6659142971038818
local_in_edges_tensor generation:  1.8324215412139893
mini_batch_src_global generation:  2.6727004051208496
r_  generation:  24.183459043502808
local_output_nid generation:  0.6585502624511719
local_in_edges_tensor generation:  1.871286392211914
mini_batch_src_global generation:  2.849290132522583
r_  generation:  24.42643904685974
local_output_nid generation:  0.6600189208984375
local_in_edges_tensor generation:  1.82468843460083
mini_batch_src_global generation:  2.589047431945801
r_  generation:  24.27259850502014
local_output_nid generation:  0.675311803817749
local_in_edges_tensor generation:  1.847748041152954
mini_batch_src_global generation:  2.9363486766815186
r_  generation:  24.45053005218506
local_output_nid generation:  0.6652448177337646
local_in_edges_tensor generation:  1.8626618385314941
mini_batch_src_global generation:  2.7190821170806885
r_  generation:  24.373375415802002
----------------------check_connections_block total spend ----------------------------- 539.4118394851685
generate_one_block  32.970112800598145
generate_one_block  33.02441334724426
generate_one_block  32.67639183998108
generate_one_block  32.696391344070435
generate_one_block  33.001412868499756
generate_one_block  32.63772797584534
generate_one_block  33.620230197906494
generate_one_block  33.098328828811646
generate_one_block  33.171656370162964
generate_one_block  32.81641411781311
generate_one_block  32.65557050704956
generate_one_block  32.88808059692383
generate_one_block  32.85198903083801
generate_one_block  33.06677961349487
generate_one_block  32.95955753326416
generate_one_block  33.50672745704651
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  772.948212146759
block generation total time  767.0238151550293
average batch blocks generation time:  47.93898844718933
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6239013671875 GB
    Memory Allocated: 1.5164241790771484  GigaBytes
Max Memory Allocated: 1.5164241790771484  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5106201171875 GB
    Memory Allocated: 3.617062568664551  GigaBytes
Max Memory Allocated: 4.101091384887695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9207763671875 GB
    Memory Allocated: 1.5193772315979004  GigaBytes
Max Memory Allocated: 5.016777992248535  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9227294921875 GB
    Memory Allocated: 3.621384620666504  GigaBytes
Max Memory Allocated: 5.016777992248535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7664794921875 GB
    Memory Allocated: 1.5217018127441406  GigaBytes
Max Memory Allocated: 5.023488521575928  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7684326171875 GB
    Memory Allocated: 3.6250357627868652  GigaBytes
Max Memory Allocated: 5.023488521575928  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5196151733398438  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6192145347595215  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5238728523254395  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.625683307647705  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5216474533081055  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.623598098754883  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5184922218322754  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6170482635498047  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5233583450317383  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6234898567199707  GigaBytes
Max Memory Allocated: 5.030529022216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5250921249389648  GigaBytes
Max Memory Allocated: 5.0306901931762695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6324615478515625  GigaBytes
Max Memory Allocated: 5.0306901931762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.518777847290039  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.616795539855957  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5203075408935547  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6211490631103516  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.51826810836792  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6163411140441895  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5192718505859375  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6166372299194336  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5239434242248535  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6264686584472656  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5180130004882812  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6143221855163574  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5180583000183105  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6145825386047363  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4228784143924713 |0.8819595724344254 |0.049283117055892944 |0.00013780593872070312 |0.033954963088035583 |0.003237485885620117 |
----------------------------------------------------------pseudo_mini_loss sum 8.684122085571289
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  74211586
Number of first layer input nodes during this epoch:  36078245
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 2.8976082801818848  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7290596961975098
range selection method range initialization spend 0.034391164779663086
time for parepare:  0.3750274181365967
local_output_nid generation:  0.003529787063598633
local_in_edges_tensor generation:  0.03655576705932617
mini_batch_src_global generation:  0.027926206588745117
r_  generation:  0.37189769744873047
local_output_nid generation:  0.003774404525756836
local_in_edges_tensor generation:  0.00820612907409668
mini_batch_src_global generation:  0.03421616554260254
r_  generation:  0.408644437789917
local_output_nid generation:  0.0036897659301757812
local_in_edges_tensor generation:  0.005406618118286133
mini_batch_src_global generation:  0.026408672332763672
r_  generation:  0.43736839294433594
local_output_nid generation:  0.0037436485290527344
local_in_edges_tensor generation:  0.005462646484375
mini_batch_src_global generation:  0.02559208869934082
r_  generation:  0.46698713302612305
local_output_nid generation:  0.003698587417602539
local_in_edges_tensor generation:  0.005800724029541016
mini_batch_src_global generation:  0.027548789978027344
r_  generation:  0.4705073833465576
local_output_nid generation:  0.0037508010864257812
local_in_edges_tensor generation:  0.005274057388305664
mini_batch_src_global generation:  0.03037858009338379
r_  generation:  0.4863283634185791
local_output_nid generation:  0.0036644935607910156
local_in_edges_tensor generation:  0.005340576171875
mini_batch_src_global generation:  0.031412363052368164
r_  generation:  0.5069370269775391
local_output_nid generation:  0.0037000179290771484
local_in_edges_tensor generation:  0.005370378494262695
mini_batch_src_global generation:  0.032876014709472656
r_  generation:  0.5094423294067383
local_output_nid generation:  0.0037064552307128906
local_in_edges_tensor generation:  0.0054759979248046875
mini_batch_src_global generation:  0.035505056381225586
r_  generation:  0.5135672092437744
local_output_nid generation:  0.00370025634765625
local_in_edges_tensor generation:  0.0049097537994384766
mini_batch_src_global generation:  0.035706520080566406
r_  generation:  0.5563266277313232
local_output_nid generation:  0.0036907196044921875
local_in_edges_tensor generation:  0.0050127506256103516
mini_batch_src_global generation:  0.03656435012817383
r_  generation:  0.5595541000366211
local_output_nid generation:  0.003776073455810547
local_in_edges_tensor generation:  0.0050966739654541016
mini_batch_src_global generation:  0.0387113094329834
r_  generation:  0.5319242477416992
local_output_nid generation:  0.0037436485290527344
local_in_edges_tensor generation:  0.006436824798583984
mini_batch_src_global generation:  0.03873181343078613
r_  generation:  0.5443422794342041
local_output_nid generation:  0.0036792755126953125
local_in_edges_tensor generation:  0.006226301193237305
mini_batch_src_global generation:  0.039994239807128906
r_  generation:  0.5544908046722412
local_output_nid generation:  0.0040280818939208984
local_in_edges_tensor generation:  0.014498233795166016
mini_batch_src_global generation:  0.04175424575805664
r_  generation:  0.55141282081604
local_output_nid generation:  0.003954172134399414
local_in_edges_tensor generation:  0.00796818733215332
mini_batch_src_global generation:  0.04122138023376465
r_  generation:  0.5302958488464355
----------------------check_connections_block total spend ----------------------------- 10.492793560028076
generate_one_block  0.8643221855163574
generate_one_block  0.5172123908996582
generate_one_block  0.5135457515716553
generate_one_block  0.5129969120025635
generate_one_block  0.5370075702667236
generate_one_block  0.5120584964752197
generate_one_block  0.5120241641998291
generate_one_block  0.5169880390167236
generate_one_block  0.528357744216919
generate_one_block  0.5159246921539307
generate_one_block  0.5329320430755615
generate_one_block  0.5976076126098633
generate_one_block  0.6934118270874023
generate_one_block  0.6717696189880371
generate_one_block  0.5359921455383301
generate_one_block  0.5097630023956299
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5127763748168945
gen group dst list time:  0.25605154037475586
time for parepare:  0.5011436939239502
local_output_nid generation:  0.10735654830932617
local_in_edges_tensor generation:  0.7324953079223633
mini_batch_src_global generation:  0.9905245304107666
r_  generation:  11.144787549972534
local_output_nid generation:  0.15459442138671875
local_in_edges_tensor generation:  0.7449584007263184
mini_batch_src_global generation:  1.2827808856964111
r_  generation:  11.220154762268066
local_output_nid generation:  0.17972326278686523
local_in_edges_tensor generation:  0.870492696762085
mini_batch_src_global generation:  1.1975750923156738
r_  generation:  10.90355372428894
local_output_nid generation:  0.17274808883666992
local_in_edges_tensor generation:  0.778329610824585
mini_batch_src_global generation:  1.2975976467132568
r_  generation:  10.918699264526367
local_output_nid generation:  0.17889070510864258
local_in_edges_tensor generation:  0.8299953937530518
mini_batch_src_global generation:  1.2585082054138184
r_  generation:  10.984498500823975
local_output_nid generation:  0.18230366706848145
local_in_edges_tensor generation:  0.8145191669464111
mini_batch_src_global generation:  1.3330984115600586
r_  generation:  11.08812928199768
local_output_nid generation:  0.1856369972229004
local_in_edges_tensor generation:  0.8416709899902344
mini_batch_src_global generation:  1.2432427406311035
r_  generation:  11.102689743041992
local_output_nid generation:  0.18777084350585938
local_in_edges_tensor generation:  0.8187220096588135
mini_batch_src_global generation:  1.335653305053711
r_  generation:  11.091819524765015
local_output_nid generation:  0.18896031379699707
local_in_edges_tensor generation:  0.8512935638427734
mini_batch_src_global generation:  1.2429084777832031
r_  generation:  11.033037424087524
local_output_nid generation:  0.19139504432678223
local_in_edges_tensor generation:  0.8326575756072998
mini_batch_src_global generation:  1.4235997200012207
r_  generation:  11.541596412658691
local_output_nid generation:  0.203125
local_in_edges_tensor generation:  0.8555264472961426
mini_batch_src_global generation:  1.178830862045288
r_  generation:  11.470536708831787
local_output_nid generation:  0.20805931091308594
local_in_edges_tensor generation:  0.8716750144958496
mini_batch_src_global generation:  1.182370662689209
r_  generation:  11.426470041275024
local_output_nid generation:  0.1740272045135498
local_in_edges_tensor generation:  0.8728353977203369
mini_batch_src_global generation:  1.2003662586212158
r_  generation:  11.310051918029785
local_output_nid generation:  0.1934802532196045
local_in_edges_tensor generation:  0.8619384765625
mini_batch_src_global generation:  1.3289401531219482
r_  generation:  11.242560386657715
local_output_nid generation:  0.1958012580871582
local_in_edges_tensor generation:  0.8789222240447998
mini_batch_src_global generation:  1.2820448875427246
r_  generation:  11.182630777359009
local_output_nid generation:  0.2026979923248291
local_in_edges_tensor generation:  0.8609848022460938
mini_batch_src_global generation:  1.3110895156860352
r_  generation:  11.193045616149902
----------------------check_connections_block total spend ----------------------------- 244.96102118492126
generate_one_block  15.771383047103882
generate_one_block  16.017603158950806
generate_one_block  15.516673564910889
generate_one_block  15.477953433990479
generate_one_block  15.498888731002808
generate_one_block  15.416521549224854
generate_one_block  15.487233877182007
generate_one_block  15.467950582504272
generate_one_block  15.354796648025513
generate_one_block  15.7384352684021
generate_one_block  15.3899827003479
generate_one_block  15.372534036636353
generate_one_block  15.395473003387451
generate_one_block  15.426241159439087
generate_one_block  15.342751026153564
generate_one_block  15.407947540283203
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.5534119606018066
gen group dst list time:  1.1550767421722412
time for parepare:  0.5129060745239258
local_output_nid generation:  0.526066780090332
local_in_edges_tensor generation:  1.820577621459961
mini_batch_src_global generation:  1.9210596084594727
r_  generation:  23.531092405319214
local_output_nid generation:  0.6359467506408691
local_in_edges_tensor generation:  1.9274630546569824
mini_batch_src_global generation:  2.762164354324341
r_  generation:  24.099995374679565
local_output_nid generation:  0.6696724891662598
local_in_edges_tensor generation:  2.0743236541748047
mini_batch_src_global generation:  2.8035035133361816
r_  generation:  24.366722345352173
local_output_nid generation:  0.6977672576904297
local_in_edges_tensor generation:  1.784754991531372
mini_batch_src_global generation:  2.836629867553711
r_  generation:  24.423274040222168
local_output_nid generation:  0.6786952018737793
local_in_edges_tensor generation:  1.8402376174926758
mini_batch_src_global generation:  2.879004955291748
r_  generation:  24.662420511245728
local_output_nid generation:  0.7098376750946045
local_in_edges_tensor generation:  1.806178331375122
mini_batch_src_global generation:  2.864269733428955
r_  generation:  24.466331481933594
local_output_nid generation:  0.712531566619873
local_in_edges_tensor generation:  1.8369147777557373
mini_batch_src_global generation:  2.884726047515869
r_  generation:  24.729787826538086
local_output_nid generation:  0.7133841514587402
local_in_edges_tensor generation:  1.8178918361663818
mini_batch_src_global generation:  2.9787282943725586
r_  generation:  24.717318534851074
local_output_nid generation:  0.7112383842468262
local_in_edges_tensor generation:  1.8343017101287842
mini_batch_src_global generation:  2.8476297855377197
r_  generation:  24.779557704925537
local_output_nid generation:  0.7117083072662354
local_in_edges_tensor generation:  1.9191880226135254
mini_batch_src_global generation:  2.901057481765747
r_  generation:  24.57708477973938
local_output_nid generation:  0.7087547779083252
local_in_edges_tensor generation:  1.945345163345337
mini_batch_src_global generation:  2.967895984649658
r_  generation:  24.802010536193848
local_output_nid generation:  0.7052414417266846
local_in_edges_tensor generation:  1.803581953048706
mini_batch_src_global generation:  2.914100408554077
r_  generation:  25.406444549560547
local_output_nid generation:  0.7183704376220703
local_in_edges_tensor generation:  1.8601069450378418
mini_batch_src_global generation:  2.706949234008789
r_  generation:  24.890151977539062
local_output_nid generation:  0.7214956283569336
local_in_edges_tensor generation:  3.877203941345215
mini_batch_src_global generation:  2.5087294578552246
r_  generation:  24.860607147216797
local_output_nid generation:  0.7177488803863525
local_in_edges_tensor generation:  1.8732924461364746
mini_batch_src_global generation:  2.8857784271240234
r_  generation:  25.025744676589966
local_output_nid generation:  0.7140471935272217
local_in_edges_tensor generation:  1.8540229797363281
mini_batch_src_global generation:  2.8930201530456543
r_  generation:  25.281023740768433
----------------------check_connections_block total spend ----------------------------- 553.2004637718201
generate_one_block  33.89626502990723
generate_one_block  33.55184483528137
generate_one_block  33.96788692474365
generate_one_block  33.73609447479248
generate_one_block  34.03834939002991
generate_one_block  33.804362058639526
generate_one_block  34.13480806350708
generate_one_block  34.77600693702698
generate_one_block  36.38726544380188
generate_one_block  36.69784617424011
generate_one_block  37.31510925292969
generate_one_block  36.90806007385254
generate_one_block  37.470935583114624
generate_one_block  36.965912103652954
generate_one_block  37.765737771987915
generate_one_block  37.70956826210022
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 2.8976082801818848  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

connection checking time:  798.1614849567413
block generation total time  817.2084217071533
average batch blocks generation time:  51.07552635669708
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5199966430664062  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.617619514465332  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5187273025512695  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6162991523742676  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5235209465026855  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.630767345428467  GigaBytes
Max Memory Allocated: 5.035089015960693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5195045471191406  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6219544410705566  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5218567848205566  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.623762607574463  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.521049976348877  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6161088943481445  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5212459564208984  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.620396137237549  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5195159912109375  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.62022066116333  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5196166038513184  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.618544101715088  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5239667892456055  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6277976036071777  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5224847793579102  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.629502296447754  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5189995765686035  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6177988052368164  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5234661102294922  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6254043579101562  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5181255340576172  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6123085021972656  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5186591148376465  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.616781711578369  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5222630500793457  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6223907470703125  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40927374362945557 |1.066747024655342 |0.0043201744556427 |0.00013302266597747803 |0.012842267751693726 |0.0016849040985107422 |
----------------------------------------------------------pseudo_mini_loss sum 5.060154438018799
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  74220465
Number of first layer input nodes during this epoch:  36082138
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 2.904478073120117  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5108864307403564
range selection method range initialization spend 0.03337550163269043
time for parepare:  0.3518848419189453
local_output_nid generation:  0.0035974979400634766
local_in_edges_tensor generation:  0.03013920783996582
mini_batch_src_global generation:  0.029027462005615234
r_  generation:  0.36942076683044434
local_output_nid generation:  0.003686666488647461
local_in_edges_tensor generation:  0.010024070739746094
mini_batch_src_global generation:  0.03595781326293945
r_  generation:  0.4424717426300049
local_output_nid generation:  0.003695249557495117
local_in_edges_tensor generation:  0.010648012161254883
mini_batch_src_global generation:  0.022920846939086914
r_  generation:  0.42395734786987305
local_output_nid generation:  0.003937721252441406
local_in_edges_tensor generation:  0.007201433181762695
mini_batch_src_global generation:  0.025831937789916992
r_  generation:  0.4815099239349365
local_output_nid generation:  0.003797769546508789
local_in_edges_tensor generation:  0.008619308471679688
mini_batch_src_global generation:  0.02762460708618164
r_  generation:  0.48055267333984375
local_output_nid generation:  0.0038580894470214844
local_in_edges_tensor generation:  0.008458852767944336
mini_batch_src_global generation:  0.031063318252563477
r_  generation:  0.5313248634338379
local_output_nid generation:  0.003723621368408203
local_in_edges_tensor generation:  0.00724339485168457
mini_batch_src_global generation:  0.0321810245513916
r_  generation:  0.5189270973205566
local_output_nid generation:  0.0037403106689453125
local_in_edges_tensor generation:  0.00855112075805664
mini_batch_src_global generation:  0.03294086456298828
r_  generation:  0.5545291900634766
local_output_nid generation:  0.003741025924682617
local_in_edges_tensor generation:  0.00842428207397461
mini_batch_src_global generation:  0.03883862495422363
r_  generation:  0.530170202255249
local_output_nid generation:  0.003799915313720703
local_in_edges_tensor generation:  0.007315635681152344
mini_batch_src_global generation:  0.03509640693664551
r_  generation:  0.552919864654541
local_output_nid generation:  0.0038101673126220703
local_in_edges_tensor generation:  0.007302999496459961
mini_batch_src_global generation:  0.0372166633605957
r_  generation:  0.5542492866516113
local_output_nid generation:  0.003799915313720703
local_in_edges_tensor generation:  0.007288694381713867
mini_batch_src_global generation:  0.03929781913757324
r_  generation:  0.5743043422698975
local_output_nid generation:  0.003838062286376953
local_in_edges_tensor generation:  0.010863780975341797
mini_batch_src_global generation:  0.03908967971801758
r_  generation:  0.5353994369506836
local_output_nid generation:  0.003801584243774414
local_in_edges_tensor generation:  0.0074498653411865234
mini_batch_src_global generation:  0.04203009605407715
r_  generation:  0.5726327896118164
local_output_nid generation:  0.0038442611694335938
local_in_edges_tensor generation:  0.007632017135620117
mini_batch_src_global generation:  0.0451657772064209
r_  generation:  0.5471913814544678
local_output_nid generation:  0.0038437843322753906
local_in_edges_tensor generation:  0.0073506832122802734
mini_batch_src_global generation:  0.040662288665771484
r_  generation:  0.5904197692871094
----------------------check_connections_block total spend ----------------------------- 10.752463340759277
generate_one_block  0.892986536026001
generate_one_block  0.5306642055511475
generate_one_block  0.5198204517364502
generate_one_block  0.5194835662841797
generate_one_block  0.518132209777832
generate_one_block  0.509099006652832
generate_one_block  0.5028350353240967
generate_one_block  0.5099132061004639
generate_one_block  0.5067393779754639
generate_one_block  0.5169522762298584
generate_one_block  0.5471758842468262
generate_one_block  0.5261688232421875
generate_one_block  0.540539026260376
generate_one_block  0.5273439884185791
generate_one_block  0.5104351043701172
generate_one_block  0.5110759735107422
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.37339448928833
gen group dst list time:  0.23203039169311523
time for parepare:  0.46204710006713867
local_output_nid generation:  0.11769485473632812
local_in_edges_tensor generation:  0.7722899913787842
mini_batch_src_global generation:  0.8858349323272705
r_  generation:  10.517022609710693
local_output_nid generation:  0.17603683471679688
local_in_edges_tensor generation:  0.8015573024749756
mini_batch_src_global generation:  1.1185688972473145
r_  generation:  10.878167390823364
local_output_nid generation:  0.18328166007995605
local_in_edges_tensor generation:  0.8041350841522217
mini_batch_src_global generation:  1.108858585357666
r_  generation:  11.057257652282715
local_output_nid generation:  0.17239928245544434
local_in_edges_tensor generation:  0.7788515090942383
mini_batch_src_global generation:  1.1222155094146729
r_  generation:  10.97631025314331
local_output_nid generation:  0.1714036464691162
local_in_edges_tensor generation:  0.7659549713134766
mini_batch_src_global generation:  1.223442792892456
r_  generation:  10.909302949905396
local_output_nid generation:  0.18090176582336426
local_in_edges_tensor generation:  0.7786810398101807
mini_batch_src_global generation:  1.1844804286956787
r_  generation:  11.249813079833984
local_output_nid generation:  0.1927506923675537
local_in_edges_tensor generation:  0.8207778930664062
mini_batch_src_global generation:  1.1662700176239014
r_  generation:  11.230903387069702
local_output_nid generation:  0.18725037574768066
local_in_edges_tensor generation:  0.8291332721710205
mini_batch_src_global generation:  1.1738612651824951
r_  generation:  11.023802042007446
local_output_nid generation:  0.18242716789245605
local_in_edges_tensor generation:  0.7490925788879395
mini_batch_src_global generation:  1.2664690017700195
r_  generation:  11.094354391098022
local_output_nid generation:  0.20200109481811523
local_in_edges_tensor generation:  0.7644920349121094
mini_batch_src_global generation:  1.141458511352539
r_  generation:  11.335336923599243
local_output_nid generation:  0.19423770904541016
local_in_edges_tensor generation:  0.8441681861877441
mini_batch_src_global generation:  1.1316955089569092
r_  generation:  11.145617008209229
local_output_nid generation:  0.18506956100463867
local_in_edges_tensor generation:  0.7566838264465332
mini_batch_src_global generation:  1.2994716167449951
r_  generation:  10.90014386177063
local_output_nid generation:  0.19971203804016113
local_in_edges_tensor generation:  0.7703359127044678
mini_batch_src_global generation:  1.1531760692596436
r_  generation:  11.176302194595337
local_output_nid generation:  0.20405101776123047
local_in_edges_tensor generation:  0.8429336547851562
mini_batch_src_global generation:  1.1478984355926514
r_  generation:  11.249314546585083
local_output_nid generation:  0.18001151084899902
local_in_edges_tensor generation:  0.8550355434417725
mini_batch_src_global generation:  1.2124392986297607
r_  generation:  10.923975944519043
local_output_nid generation:  0.19661211967468262
local_in_edges_tensor generation:  0.6596071720123291
mini_batch_src_global generation:  1.2020251750946045
r_  generation:  11.230273008346558
----------------------check_connections_block total spend ----------------------------- 240.30836272239685
generate_one_block  15.621843099594116
generate_one_block  15.869210243225098
generate_one_block  15.098808288574219
generate_one_block  14.812547206878662
generate_one_block  15.493584632873535
generate_one_block  15.585901021957397
generate_one_block  15.309005498886108
generate_one_block  15.52139687538147
generate_one_block  15.438360214233398
generate_one_block  15.38713002204895
generate_one_block  14.998597383499146
generate_one_block  15.413185358047485
generate_one_block  15.416429996490479
generate_one_block  15.257633447647095
generate_one_block  14.910999298095703
generate_one_block  15.290906429290771
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4950900077819824
gen group dst list time:  1.1033267974853516
time for parepare:  0.47522568702697754
local_output_nid generation:  0.5417578220367432
local_in_edges_tensor generation:  2.076167345046997
mini_batch_src_global generation:  1.9224870204925537
r_  generation:  23.44597601890564
local_output_nid generation:  0.637413740158081
local_in_edges_tensor generation:  1.7652325630187988
mini_batch_src_global generation:  2.63769268989563
r_  generation:  24.1858868598938
local_output_nid generation:  0.6416840553283691
local_in_edges_tensor generation:  1.9354491233825684
mini_batch_src_global generation:  2.6499478816986084
r_  generation:  24.183833122253418
local_output_nid generation:  0.6676862239837646
local_in_edges_tensor generation:  1.8533434867858887
mini_batch_src_global generation:  2.627516746520996
r_  generation:  24.289393186569214
local_output_nid generation:  0.6827828884124756
local_in_edges_tensor generation:  1.8175923824310303
mini_batch_src_global generation:  2.6325736045837402
r_  generation:  24.405136346817017
local_output_nid generation:  0.6864762306213379
local_in_edges_tensor generation:  1.8226897716522217
mini_batch_src_global generation:  2.837714433670044
r_  generation:  24.19144058227539
local_output_nid generation:  0.6769399642944336
local_in_edges_tensor generation:  1.8554751873016357
mini_batch_src_global generation:  2.6423287391662598
r_  generation:  24.63115382194519
local_output_nid generation:  0.6720151901245117
local_in_edges_tensor generation:  1.816115379333496
mini_batch_src_global generation:  2.898545742034912
r_  generation:  25.42025661468506
local_output_nid generation:  0.6905796527862549
local_in_edges_tensor generation:  1.872199296951294
mini_batch_src_global generation:  2.6916556358337402
r_  generation:  24.70070481300354
local_output_nid generation:  0.6812491416931152
local_in_edges_tensor generation:  1.8519330024719238
mini_batch_src_global generation:  2.8647890090942383
r_  generation:  24.47679328918457
local_output_nid generation:  0.7179021835327148
local_in_edges_tensor generation:  1.8620150089263916
mini_batch_src_global generation:  2.9166293144226074
r_  generation:  24.920827627182007
local_output_nid generation:  0.6873180866241455
local_in_edges_tensor generation:  1.8213815689086914
mini_batch_src_global generation:  2.7182703018188477
r_  generation:  24.66349959373474
local_output_nid generation:  0.6953685283660889
local_in_edges_tensor generation:  1.8580141067504883
mini_batch_src_global generation:  2.821984052658081
r_  generation:  24.71550464630127
local_output_nid generation:  0.6926770210266113
local_in_edges_tensor generation:  3.9079856872558594
mini_batch_src_global generation:  2.6623992919921875
r_  generation:  24.358980655670166
local_output_nid generation:  0.7184023857116699
local_in_edges_tensor generation:  1.8669486045837402
mini_batch_src_global generation:  2.718141555786133
r_  generation:  24.917964458465576
local_output_nid generation:  0.7314820289611816
local_in_edges_tensor generation:  1.8373079299926758
mini_batch_src_global generation:  2.7000112533569336
r_  generation:  24.76771330833435
----------------------check_connections_block total spend ----------------------------- 548.6244850158691
generate_one_block  33.41711187362671
generate_one_block  33.30552864074707
generate_one_block  33.36519002914429
generate_one_block  33.51067781448364
generate_one_block  33.40847587585449
generate_one_block  33.64035511016846
generate_one_block  34.438905239105225
generate_one_block  36.966594219207764
generate_one_block  36.65559411048889
generate_one_block  36.60052967071533
generate_one_block  36.646872758865356
generate_one_block  36.6522901058197
generate_one_block  36.450037717819214
generate_one_block  36.37828302383423
generate_one_block  36.74611783027649
generate_one_block  37.22996950149536
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 2.904478073120117  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

connection checking time:  788.932847738266
block generation total time  810.8380725383759
average batch blocks generation time:  50.67737953364849
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5231008529663086  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6269259452819824  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5188946723937988  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6172995567321777  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5228562355041504  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.624943733215332  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5188236236572266  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.616177558898926  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5201740264892578  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.620450973510742  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5221571922302246  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6241297721862793  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5178532600402832  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6121392250061035  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5200386047363281  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.618968963623047  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5185356140136719  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.61268949508667  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 1.5198054313659668  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7703857421875 GB
    Memory Allocated: 3.6177172660827637  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5243315696716309  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.631159782409668  GigaBytes
Max Memory Allocated: 5.0356035232543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5205087661743164  GigaBytes
Max Memory Allocated: 5.036180019378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.620797634124756  GigaBytes
Max Memory Allocated: 5.036180019378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.522571086883545  GigaBytes
Max Memory Allocated: 5.036180019378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.625805377960205  GigaBytes
Max Memory Allocated: 5.036180019378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5250511169433594  GigaBytes
Max Memory Allocated: 5.036180019378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.631387710571289  GigaBytes
Max Memory Allocated: 5.036180019378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5250062942504883  GigaBytes
Max Memory Allocated: 5.036180019378662  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6345877647399902  GigaBytes
Max Memory Allocated: 5.036180019378662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.522223949432373  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6257452964782715  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4128299355506897 |1.229616031050682 |0.0052187442779541016 |0.00013393163681030273 |0.02073422074317932 |0.002588987350463867 |
----------------------------------------------------------pseudo_mini_loss sum 3.6617865562438965
Total (block generation + training)time/epoch 1698.11283826828
Training time/epoch 1648139059.628792
Training time without block to device /epoch 1648139039.9549356
Training time without total dataloading part /epoch 0.4199793338775635
load block tensor time/epoch 6.605278968811035
block to device time/epoch 19.673856496810913
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  74247237
Number of first layer input nodes during this epoch:  36087645
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 2.9064269065856934  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6817212104797363
range selection method range initialization spend 0.025447845458984375
time for parepare:  0.34054040908813477
local_output_nid generation:  0.0035512447357177734
local_in_edges_tensor generation:  0.0332643985748291
mini_batch_src_global generation:  0.028589248657226562
r_  generation:  0.3611326217651367
local_output_nid generation:  0.003805398941040039
local_in_edges_tensor generation:  0.010014772415161133
mini_batch_src_global generation:  0.03499174118041992
r_  generation:  0.4141988754272461
local_output_nid generation:  0.003820657730102539
local_in_edges_tensor generation:  0.005429744720458984
mini_batch_src_global generation:  0.022932767868041992
r_  generation:  0.4188671112060547
local_output_nid generation:  0.0038230419158935547
local_in_edges_tensor generation:  0.006540775299072266
mini_batch_src_global generation:  0.027126789093017578
r_  generation:  0.4551379680633545
local_output_nid generation:  0.0037772655487060547
local_in_edges_tensor generation:  0.005365610122680664
mini_batch_src_global generation:  0.027437925338745117
r_  generation:  0.46761345863342285
local_output_nid generation:  0.0037927627563476562
local_in_edges_tensor generation:  0.0063934326171875
mini_batch_src_global generation:  0.03170919418334961
r_  generation:  0.4957282543182373
local_output_nid generation:  0.003725767135620117
local_in_edges_tensor generation:  0.006445884704589844
mini_batch_src_global generation:  0.03147530555725098
r_  generation:  0.49974846839904785
local_output_nid generation:  0.003771543502807617
local_in_edges_tensor generation:  0.006582975387573242
mini_batch_src_global generation:  0.032791852951049805
r_  generation:  0.5080244541168213
local_output_nid generation:  0.0038077831268310547
local_in_edges_tensor generation:  0.0066907405853271484
mini_batch_src_global generation:  0.03430581092834473
r_  generation:  0.5135188102722168
local_output_nid generation:  0.0037314891815185547
local_in_edges_tensor generation:  0.006631374359130859
mini_batch_src_global generation:  0.03540539741516113
r_  generation:  0.5150852203369141
local_output_nid generation:  0.003808736801147461
local_in_edges_tensor generation:  0.007667064666748047
mini_batch_src_global generation:  0.03804612159729004
r_  generation:  0.5162093639373779
local_output_nid generation:  0.0038268566131591797
local_in_edges_tensor generation:  0.00545191764831543
mini_batch_src_global generation:  0.03823447227478027
r_  generation:  0.5245497226715088
local_output_nid generation:  0.0037810802459716797
local_in_edges_tensor generation:  0.006777524948120117
mini_batch_src_global generation:  0.04014015197753906
r_  generation:  0.519472599029541
local_output_nid generation:  0.0038619041442871094
local_in_edges_tensor generation:  0.006417274475097656
mini_batch_src_global generation:  0.040128469467163086
r_  generation:  0.5340683460235596
local_output_nid generation:  0.003771543502807617
local_in_edges_tensor generation:  0.006368398666381836
mini_batch_src_global generation:  0.04163837432861328
r_  generation:  0.5293688774108887
local_output_nid generation:  0.0039937496185302734
local_in_edges_tensor generation:  0.007948160171508789
mini_batch_src_global generation:  0.04189872741699219
r_  generation:  0.5341978073120117
----------------------check_connections_block total spend ----------------------------- 10.209488868713379
generate_one_block  0.879734992980957
generate_one_block  0.5360298156738281
generate_one_block  0.5165677070617676
generate_one_block  0.5191779136657715
generate_one_block  0.5261337757110596
generate_one_block  0.5107758045196533
generate_one_block  0.5119848251342773
generate_one_block  0.5184495449066162
generate_one_block  0.5142035484313965
generate_one_block  0.5355327129364014
generate_one_block  0.5232694149017334
generate_one_block  0.5315468311309814
generate_one_block  0.5382297039031982
generate_one_block  0.5257484912872314
generate_one_block  0.5111963748931885
generate_one_block  0.5165455341339111
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.339343786239624
gen group dst list time:  0.2654287815093994
time for parepare:  0.45163798332214355
local_output_nid generation:  0.11840271949768066
local_in_edges_tensor generation:  0.7608730792999268
mini_batch_src_global generation:  0.905914306640625
r_  generation:  10.224595546722412
local_output_nid generation:  0.16376972198486328
local_in_edges_tensor generation:  0.6530168056488037
mini_batch_src_global generation:  1.1357481479644775
r_  generation:  10.781970500946045
local_output_nid generation:  0.16805553436279297
local_in_edges_tensor generation:  0.8575780391693115
mini_batch_src_global generation:  1.1240100860595703
r_  generation:  10.790661096572876
local_output_nid generation:  0.17066216468811035
local_in_edges_tensor generation:  0.9069113731384277
mini_batch_src_global generation:  1.2508769035339355
r_  generation:  10.829015016555786
local_output_nid generation:  0.18855643272399902
local_in_edges_tensor generation:  0.6560103893280029
mini_batch_src_global generation:  1.1897175312042236
r_  generation:  11.024460792541504
local_output_nid generation:  0.1906442642211914
local_in_edges_tensor generation:  0.8130042552947998
mini_batch_src_global generation:  1.1750853061676025
r_  generation:  11.127497911453247
local_output_nid generation:  0.19240021705627441
local_in_edges_tensor generation:  0.8373477458953857
mini_batch_src_global generation:  1.2047133445739746
r_  generation:  10.832992553710938
local_output_nid generation:  0.19022035598754883
local_in_edges_tensor generation:  0.6662755012512207
mini_batch_src_global generation:  1.200364589691162
r_  generation:  11.06005573272705
local_output_nid generation:  0.2034163475036621
local_in_edges_tensor generation:  0.867612361907959
mini_batch_src_global generation:  1.1595697402954102
r_  generation:  11.179056644439697
local_output_nid generation:  0.19397306442260742
local_in_edges_tensor generation:  0.8700683116912842
mini_batch_src_global generation:  1.1821308135986328
r_  generation:  10.909024477005005
local_output_nid generation:  0.18729090690612793
local_in_edges_tensor generation:  0.7951874732971191
mini_batch_src_global generation:  1.2577283382415771
r_  generation:  11.04281234741211
local_output_nid generation:  0.2059040069580078
local_in_edges_tensor generation:  0.7929553985595703
mini_batch_src_global generation:  1.2120554447174072
r_  generation:  11.226340532302856
local_output_nid generation:  0.20007538795471191
local_in_edges_tensor generation:  0.867713212966919
mini_batch_src_global generation:  1.169353723526001
r_  generation:  10.921082735061646
local_output_nid generation:  0.1903548240661621
local_in_edges_tensor generation:  0.7862310409545898
mini_batch_src_global generation:  1.199585199356079
r_  generation:  11.070600271224976
local_output_nid generation:  0.21257662773132324
local_in_edges_tensor generation:  0.7758872509002686
mini_batch_src_global generation:  1.220423698425293
r_  generation:  11.097796201705933
local_output_nid generation:  0.20135283470153809
local_in_edges_tensor generation:  0.861091136932373
mini_batch_src_global generation:  1.1648337841033936
r_  generation:  11.002225399017334
----------------------check_connections_block total spend ----------------------------- 239.59242820739746
generate_one_block  15.344139814376831
generate_one_block  15.894666910171509
generate_one_block  15.616127967834473
generate_one_block  15.53745698928833
generate_one_block  15.317339181900024
generate_one_block  14.843723058700562
generate_one_block  15.513700723648071
generate_one_block  15.47054147720337
generate_one_block  15.44751787185669
generate_one_block  15.143759489059448
generate_one_block  15.429568529129028
generate_one_block  15.466099262237549
generate_one_block  15.53479552268982
generate_one_block  15.388980150222778
generate_one_block  14.823686122894287
generate_one_block  15.33202052116394
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4603519439697266
gen group dst list time:  1.1219234466552734
time for parepare:  0.5057981014251709
local_output_nid generation:  0.5161824226379395
local_in_edges_tensor generation:  1.65604829788208
mini_batch_src_global generation:  1.9147086143493652
r_  generation:  23.35270380973816
local_output_nid generation:  0.6133973598480225
local_in_edges_tensor generation:  1.7940280437469482
mini_batch_src_global generation:  2.7898073196411133
r_  generation:  24.664435625076294
local_output_nid generation:  0.638251543045044
local_in_edges_tensor generation:  1.99298095703125
mini_batch_src_global generation:  2.570460319519043
r_  generation:  24.060325622558594
local_output_nid generation:  0.667494535446167
local_in_edges_tensor generation:  1.828834056854248
mini_batch_src_global generation:  2.709568738937378
r_  generation:  24.090675592422485
local_output_nid generation:  0.6580007076263428
local_in_edges_tensor generation:  1.8205304145812988
mini_batch_src_global generation:  2.6348328590393066
r_  generation:  24.292571306228638
local_output_nid generation:  0.6636343002319336
local_in_edges_tensor generation:  1.8304738998413086
mini_batch_src_global generation:  2.734376907348633
r_  generation:  24.270190954208374
local_output_nid generation:  0.6838886737823486
local_in_edges_tensor generation:  1.8216729164123535
mini_batch_src_global generation:  2.692999839782715
r_  generation:  24.382724285125732
local_output_nid generation:  0.6864604949951172
local_in_edges_tensor generation:  1.8163726329803467
mini_batch_src_global generation:  2.6949756145477295
r_  generation:  24.578251838684082
local_output_nid generation:  0.6666362285614014
local_in_edges_tensor generation:  1.8624975681304932
mini_batch_src_global generation:  2.7136292457580566
r_  generation:  24.38822031021118
local_output_nid generation:  0.6567420959472656
local_in_edges_tensor generation:  1.843550205230713
mini_batch_src_global generation:  2.703433036804199
r_  generation:  24.57466745376587
local_output_nid generation:  0.6600990295410156
local_in_edges_tensor generation:  1.8418552875518799
mini_batch_src_global generation:  2.747814416885376
r_  generation:  24.486746072769165
local_output_nid generation:  0.6562812328338623
local_in_edges_tensor generation:  1.8536577224731445
mini_batch_src_global generation:  2.7797329425811768
r_  generation:  24.369778633117676
local_output_nid generation:  0.6714284420013428
local_in_edges_tensor generation:  1.8397064208984375
mini_batch_src_global generation:  2.832380533218384
r_  generation:  24.593101263046265
local_output_nid generation:  0.6588704586029053
local_in_edges_tensor generation:  3.784233808517456
mini_batch_src_global generation:  2.6039528846740723
r_  generation:  24.47952365875244
local_output_nid generation:  0.6772496700286865
local_in_edges_tensor generation:  1.8431367874145508
mini_batch_src_global generation:  2.710390329360962
r_  generation:  24.393432140350342
local_output_nid generation:  0.685870885848999
local_in_edges_tensor generation:  1.873687982559204
mini_batch_src_global generation:  2.756884813308716
r_  generation:  24.337200164794922
----------------------check_connections_block total spend ----------------------------- 543.8682401180267
generate_one_block  33.25923228263855
generate_one_block  33.131224393844604
generate_one_block  33.33496809005737
generate_one_block  33.72346496582031
generate_one_block  33.61798071861267
generate_one_block  33.555704832077026
generate_one_block  33.945680379867554
generate_one_block  34.41553211212158
generate_one_block  34.23551535606384
generate_one_block  33.9969527721405
generate_one_block  33.958359241485596
generate_one_block  34.110851526260376
generate_one_block  34.436768531799316
generate_one_block  34.60651350021362
generate_one_block  34.785022258758545
generate_one_block  34.99580240249634
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 2.9064269065856934  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

connection checking time:  783.4606683254242
block generation total time  790.2136969566345
average batch blocks generation time:  49.38835605978966
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5197463035583496  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6164188385009766  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5187797546386719  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.61686372756958  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5250139236450195  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6283822059631348  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5265769958496094  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6356210708618164  GigaBytes
Max Memory Allocated: 5.039691925048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.522834300994873  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6263933181762695  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.519202709197998  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6184983253479004  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5218896865844727  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6255154609680176  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5221714973449707  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6230106353759766  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5195436477661133  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6173477172851562  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5189290046691895  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.61784029006958  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5205607414245605  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.620858669281006  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5185270309448242  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.614290237426758  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5225567817687988  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.630500316619873  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5205607414245605  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6197752952575684  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5210857391357422  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.619260787963867  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5199222564697266  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.617245674133301  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41681477427482605 |0.8856668919324875 |0.0041675865650177 |0.00013400614261627197 |0.004856988787651062 |0.0013430118560791016 |
----------------------------------------------------------pseudo_mini_loss sum 3.0861949920654297
Total (block generation + training)time/epoch 1682.2569411993027
Training time/epoch 1648140726.0302937
Training time without block to device /epoch 1648140711.8596234
Training time without total dataloading part /epoch 0.14788031578063965
load block tensor time/epoch 6.669036388397217
block to device time/epoch 14.1706702709198
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  74233883
Number of first layer input nodes during this epoch:  36085684
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 2.8995723724365234  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6189467906951904
range selection method range initialization spend 0.027042150497436523
time for parepare:  0.3731727600097656
local_output_nid generation:  0.003843545913696289
local_in_edges_tensor generation:  0.03150033950805664
mini_batch_src_global generation:  0.027576923370361328
r_  generation:  0.37255120277404785
local_output_nid generation:  0.00394129753112793
local_in_edges_tensor generation:  0.010727405548095703
mini_batch_src_global generation:  0.03834199905395508
r_  generation:  0.42113232612609863
local_output_nid generation:  0.004151582717895508
local_in_edges_tensor generation:  0.011096477508544922
mini_batch_src_global generation:  0.02428746223449707
r_  generation:  0.42760396003723145
local_output_nid generation:  0.004011869430541992
local_in_edges_tensor generation:  0.008547782897949219
mini_batch_src_global generation:  0.026763439178466797
r_  generation:  0.45742344856262207
local_output_nid generation:  0.00397038459777832
local_in_edges_tensor generation:  0.007404327392578125
mini_batch_src_global generation:  0.02763962745666504
r_  generation:  0.47684502601623535
local_output_nid generation:  0.003997325897216797
local_in_edges_tensor generation:  0.009538888931274414
mini_batch_src_global generation:  0.03038954734802246
r_  generation:  0.5037307739257812
local_output_nid generation:  0.004046916961669922
local_in_edges_tensor generation:  0.0064623355865478516
mini_batch_src_global generation:  0.0316159725189209
r_  generation:  0.5022578239440918
local_output_nid generation:  0.004004240036010742
local_in_edges_tensor generation:  0.006387948989868164
mini_batch_src_global generation:  0.0365452766418457
r_  generation:  0.5610723495483398
local_output_nid generation:  0.0039784908294677734
local_in_edges_tensor generation:  0.006247758865356445
mini_batch_src_global generation:  0.034323692321777344
r_  generation:  0.5355231761932373
local_output_nid generation:  0.003984212875366211
local_in_edges_tensor generation:  0.006480693817138672
mini_batch_src_global generation:  0.03686976432800293
r_  generation:  0.5414102077484131
local_output_nid generation:  0.004021406173706055
local_in_edges_tensor generation:  0.006229877471923828
mini_batch_src_global generation:  0.0376584529876709
r_  generation:  0.5422096252441406
local_output_nid generation:  0.004050254821777344
local_in_edges_tensor generation:  0.00645136833190918
mini_batch_src_global generation:  0.040609121322631836
r_  generation:  0.5418155193328857
local_output_nid generation:  0.0040400028228759766
local_in_edges_tensor generation:  0.0063402652740478516
mini_batch_src_global generation:  0.04291558265686035
r_  generation:  0.5407967567443848
local_output_nid generation:  0.0040819644927978516
local_in_edges_tensor generation:  0.008646726608276367
mini_batch_src_global generation:  0.04020881652832031
r_  generation:  0.557567834854126
local_output_nid generation:  0.004060983657836914
local_in_edges_tensor generation:  0.007874011993408203
mini_batch_src_global generation:  0.04110908508300781
r_  generation:  0.5459909439086914
local_output_nid generation:  0.004168033599853516
local_in_edges_tensor generation:  0.00654911994934082
mini_batch_src_global generation:  0.04176759719848633
r_  generation:  0.5741734504699707
----------------------check_connections_block total spend ----------------------------- 10.656656742095947
generate_one_block  0.8922290802001953
generate_one_block  0.5462188720703125
generate_one_block  0.5209615230560303
generate_one_block  0.5145895481109619
generate_one_block  0.5143699645996094
generate_one_block  0.5113105773925781
generate_one_block  0.5114002227783203
generate_one_block  0.5196144580841064
generate_one_block  0.5088484287261963
generate_one_block  0.5377321243286133
generate_one_block  0.5355327129364014
generate_one_block  0.5464029312133789
generate_one_block  0.5394299030303955
generate_one_block  0.5225131511688232
generate_one_block  0.5228617191314697
generate_one_block  0.5202808380126953
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5033838748931885
gen group dst list time:  0.27398228645324707
time for parepare:  0.4769473075866699
local_output_nid generation:  0.12137746810913086
local_in_edges_tensor generation:  0.7446889877319336
mini_batch_src_global generation:  0.9167797565460205
r_  generation:  10.309900760650635
local_output_nid generation:  0.16566872596740723
local_in_edges_tensor generation:  0.7056903839111328
mini_batch_src_global generation:  1.1952524185180664
r_  generation:  11.066166877746582
local_output_nid generation:  0.1780076026916504
local_in_edges_tensor generation:  0.7838656902313232
mini_batch_src_global generation:  1.1294641494750977
r_  generation:  11.177753448486328
local_output_nid generation:  0.19945120811462402
local_in_edges_tensor generation:  0.8630177974700928
mini_batch_src_global generation:  1.1558330059051514
r_  generation:  11.017969608306885
local_output_nid generation:  0.18642973899841309
local_in_edges_tensor generation:  0.8252310752868652
mini_batch_src_global generation:  1.1943340301513672
r_  generation:  10.936077117919922
local_output_nid generation:  0.17995953559875488
local_in_edges_tensor generation:  0.7689399719238281
mini_batch_src_global generation:  1.2515971660614014
r_  generation:  10.929957389831543
local_output_nid generation:  0.2065896987915039
local_in_edges_tensor generation:  0.7840864658355713
mini_batch_src_global generation:  1.1666085720062256
r_  generation:  11.29811406135559
local_output_nid generation:  0.19243478775024414
local_in_edges_tensor generation:  0.8610637187957764
mini_batch_src_global generation:  1.1813931465148926
r_  generation:  11.004127264022827
local_output_nid generation:  0.1871793270111084
local_in_edges_tensor generation:  0.7551729679107666
mini_batch_src_global generation:  1.2741105556488037
r_  generation:  11.207900524139404
local_output_nid generation:  0.20411038398742676
local_in_edges_tensor generation:  0.7773110866546631
mini_batch_src_global generation:  1.1822195053100586
r_  generation:  11.306967973709106
local_output_nid generation:  0.19948983192443848
local_in_edges_tensor generation:  0.8706703186035156
mini_batch_src_global generation:  1.1800525188446045
r_  generation:  11.055498123168945
local_output_nid generation:  0.1873793601989746
local_in_edges_tensor generation:  0.7729265689849854
mini_batch_src_global generation:  1.2730522155761719
r_  generation:  10.963467597961426
local_output_nid generation:  0.20879769325256348
local_in_edges_tensor generation:  0.7873921394348145
mini_batch_src_global generation:  1.1950790882110596
r_  generation:  11.329075813293457
local_output_nid generation:  0.20798039436340332
local_in_edges_tensor generation:  0.8625657558441162
mini_batch_src_global generation:  1.1832146644592285
r_  generation:  10.956053018569946
local_output_nid generation:  0.18800091743469238
local_in_edges_tensor generation:  0.7625570297241211
mini_batch_src_global generation:  1.2776179313659668
r_  generation:  11.11063003540039
local_output_nid generation:  0.20918965339660645
local_in_edges_tensor generation:  0.7759828567504883
mini_batch_src_global generation:  1.1814262866973877
r_  generation:  11.218034982681274
----------------------check_connections_block total spend ----------------------------- 241.9011354446411
generate_one_block  15.521976709365845
generate_one_block  16.016999006271362
generate_one_block  14.863879919052124
generate_one_block  15.478073835372925
generate_one_block  15.60603404045105
generate_one_block  15.243517637252808
generate_one_block  14.892868757247925
generate_one_block  15.578736066818237
generate_one_block  15.54875922203064
generate_one_block  15.649329662322998
generate_one_block  14.91343641281128
generate_one_block  15.463630437850952
generate_one_block  15.648917436599731
generate_one_block  15.393637418746948
generate_one_block  14.977385520935059
generate_one_block  15.080435752868652
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.5718371868133545
gen group dst list time:  1.083690881729126
time for parepare:  0.47790050506591797
local_output_nid generation:  0.5135502815246582
local_in_edges_tensor generation:  1.7265655994415283
mini_batch_src_global generation:  1.893099069595337
r_  generation:  23.303837776184082
local_output_nid generation:  0.621598482131958
local_in_edges_tensor generation:  1.830672025680542
mini_batch_src_global generation:  2.6551215648651123
r_  generation:  23.996172666549683
local_output_nid generation:  0.6446754932403564
local_in_edges_tensor generation:  1.775681495666504
mini_batch_src_global generation:  2.8961374759674072
r_  generation:  24.295836925506592
local_output_nid generation:  0.6593308448791504
local_in_edges_tensor generation:  1.840416431427002
mini_batch_src_global generation:  2.713491678237915
r_  generation:  24.06986403465271
local_output_nid generation:  0.6961202621459961
local_in_edges_tensor generation:  1.8536591529846191
mini_batch_src_global generation:  2.5815629959106445
r_  generation:  24.483724355697632
local_output_nid generation:  0.6789183616638184
local_in_edges_tensor generation:  1.9127087593078613
mini_batch_src_global generation:  2.9117159843444824
r_  generation:  24.30387854576111
local_output_nid generation:  0.6748809814453125
local_in_edges_tensor generation:  1.8185489177703857
mini_batch_src_global generation:  2.6738719940185547
r_  generation:  24.64240026473999
local_output_nid generation:  0.7034156322479248
local_in_edges_tensor generation:  1.8294897079467773
mini_batch_src_global generation:  2.8811256885528564
r_  generation:  24.244956731796265
local_output_nid generation:  0.678849458694458
local_in_edges_tensor generation:  1.8225996494293213
mini_batch_src_global generation:  2.6983602046966553
r_  generation:  24.488906383514404
local_output_nid generation:  0.708193302154541
local_in_edges_tensor generation:  1.8501179218292236
mini_batch_src_global generation:  2.8891568183898926
r_  generation:  24.355628728866577
local_output_nid generation:  0.684417724609375
local_in_edges_tensor generation:  1.848386287689209
mini_batch_src_global generation:  2.7090909481048584
r_  generation:  24.72386360168457
local_output_nid generation:  0.694133996963501
local_in_edges_tensor generation:  1.876563310623169
mini_batch_src_global generation:  2.890378713607788
r_  generation:  24.291404485702515
local_output_nid generation:  0.6813013553619385
local_in_edges_tensor generation:  1.8332409858703613
mini_batch_src_global generation:  2.701951265335083
r_  generation:  24.650152921676636
local_output_nid generation:  0.7048914432525635
local_in_edges_tensor generation:  3.925992727279663
mini_batch_src_global generation:  2.759366035461426
r_  generation:  24.51344108581543
local_output_nid generation:  0.7091367244720459
local_in_edges_tensor generation:  1.873607873916626
mini_batch_src_global generation:  2.8110392093658447
r_  generation:  24.57425093650818
local_output_nid generation:  0.7103404998779297
local_in_edges_tensor generation:  1.84635591506958
mini_batch_src_global generation:  2.905799627304077
r_  generation:  24.43949794769287
----------------------check_connections_block total spend ----------------------------- 545.9698123931885
generate_one_block  33.60887336730957
generate_one_block  33.55601716041565
generate_one_block  33.661524534225464
generate_one_block  33.31865930557251
generate_one_block  33.491212368011475
generate_one_block  33.50277519226074
generate_one_block  33.48942303657532
generate_one_block  34.07057213783264
generate_one_block  33.528863191604614
generate_one_block  33.58652353286743
generate_one_block  33.69488978385925
generate_one_block  33.672714948654175
generate_one_block  34.02279615402222
generate_one_block  33.938093185424805
generate_one_block  34.04036998748779
generate_one_block  33.954185009002686
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 2.8995723724365234  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

connection checking time:  787.8709478378296
block generation total time  785.0151107311249
average batch blocks generation time:  49.063444420695305
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5177206993103027  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6102075576782227  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5208396911621094  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6260008811950684  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5231013298034668  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.623485565185547  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.518867015838623  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6142778396606445  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5225849151611328  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.626415729522705  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5207428932189941  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.620479106903076  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5228052139282227  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.623643398284912  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5209665298461914  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6224050521850586  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5184898376464844  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6154184341430664  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5239877700805664  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.630242347717285  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5234994888305664  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.629568576812744  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5205893516540527  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.622347354888916  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5194339752197266  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.621246814727783  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5239372253417969  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.629918098449707  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5167961120605469  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6081809997558594  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5191822052001953  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6182069778442383  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39731791615486145 |0.9290834367275238 |0.005003541707992554 |0.0001398921012878418 |0.02075415849685669 |0.0026476383209228516 |
----------------------------------------------------------pseudo_mini_loss sum 2.6561222076416016
Total (block generation + training)time/epoch 1676.9493508338928
Training time/epoch 1648142392.3647754
Training time without block to device /epoch 1648142377.4994404
Training time without total dataloading part /epoch 0.4170091152191162
load block tensor time/epoch 6.357086658477783
block to device time/epoch 14.86533498764038
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  74219692
Number of first layer input nodes during this epoch:  36081337
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 2.898858070373535  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5998258590698242
range selection method range initialization spend 0.026834964752197266
time for parepare:  0.36710548400878906
local_output_nid generation:  0.003576517105102539
local_in_edges_tensor generation:  0.05035090446472168
mini_batch_src_global generation:  0.02868962287902832
r_  generation:  0.3646240234375
local_output_nid generation:  0.003790616989135742
local_in_edges_tensor generation:  0.010239601135253906
mini_batch_src_global generation:  0.036530256271362305
r_  generation:  0.4836404323577881
local_output_nid generation:  0.0038084983825683594
local_in_edges_tensor generation:  0.008773326873779297
mini_batch_src_global generation:  0.023244380950927734
r_  generation:  0.427640438079834
local_output_nid generation:  0.0037920475006103516
local_in_edges_tensor generation:  0.009820222854614258
mini_batch_src_global generation:  0.027905702590942383
r_  generation:  0.4584794044494629
local_output_nid generation:  0.0037517547607421875
local_in_edges_tensor generation:  0.006369352340698242
mini_batch_src_global generation:  0.027373790740966797
r_  generation:  0.47250938415527344
local_output_nid generation:  0.0037522315979003906
local_in_edges_tensor generation:  0.007349252700805664
mini_batch_src_global generation:  0.03136396408081055
r_  generation:  0.5060832500457764
local_output_nid generation:  0.004012107849121094
local_in_edges_tensor generation:  0.0063288211822509766
mini_batch_src_global generation:  0.03166556358337402
r_  generation:  0.5121374130249023
local_output_nid generation:  0.003790616989135742
local_in_edges_tensor generation:  0.006317853927612305
mini_batch_src_global generation:  0.03255176544189453
r_  generation:  0.5182194709777832
local_output_nid generation:  0.003820657730102539
local_in_edges_tensor generation:  0.011293411254882812
mini_batch_src_global generation:  0.03435683250427246
r_  generation:  0.5315108299255371
local_output_nid generation:  0.0038547515869140625
local_in_edges_tensor generation:  0.007490873336791992
mini_batch_src_global generation:  0.035423994064331055
r_  generation:  0.5577871799468994
local_output_nid generation:  0.0038940906524658203
local_in_edges_tensor generation:  0.008598566055297852
mini_batch_src_global generation:  0.03853011131286621
r_  generation:  0.5344877243041992
local_output_nid generation:  0.003887653350830078
local_in_edges_tensor generation:  0.006419181823730469
mini_batch_src_global generation:  0.039563655853271484
r_  generation:  0.5417487621307373
local_output_nid generation:  0.003920793533325195
local_in_edges_tensor generation:  0.0064563751220703125
mini_batch_src_global generation:  0.03961658477783203
r_  generation:  0.5485103130340576
local_output_nid generation:  0.0039980411529541016
local_in_edges_tensor generation:  0.0076868534088134766
mini_batch_src_global generation:  0.040172576904296875
r_  generation:  0.5464065074920654
local_output_nid generation:  0.004000186920166016
local_in_edges_tensor generation:  0.006345510482788086
mini_batch_src_global generation:  0.04086804389953613
r_  generation:  0.5666828155517578
local_output_nid generation:  0.004058361053466797
local_in_edges_tensor generation:  0.015258073806762695
mini_batch_src_global generation:  0.04539179801940918
r_  generation:  0.5234889984130859
----------------------check_connections_block total spend ----------------------------- 10.65291452407837
generate_one_block  0.8969483375549316
generate_one_block  0.5289950370788574
generate_one_block  0.5162839889526367
generate_one_block  0.5143976211547852
generate_one_block  0.518359899520874
generate_one_block  0.5166223049163818
generate_one_block  0.5073063373565674
generate_one_block  0.5121364593505859
generate_one_block  0.5122144222259521
generate_one_block  0.5365855693817139
generate_one_block  0.524031400680542
generate_one_block  0.52024245262146
generate_one_block  0.5234830379486084
generate_one_block  0.5205676555633545
generate_one_block  0.5343489646911621
generate_one_block  0.5190730094909668
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.3438169956207275
gen group dst list time:  0.2479381561279297
time for parepare:  0.43738675117492676
local_output_nid generation:  0.11600756645202637
local_in_edges_tensor generation:  0.7506136894226074
mini_batch_src_global generation:  0.8879351615905762
r_  generation:  10.107567310333252
local_output_nid generation:  0.16297054290771484
local_in_edges_tensor generation:  0.6937978267669678
mini_batch_src_global generation:  1.111276626586914
r_  generation:  10.75301718711853
local_output_nid generation:  0.15903687477111816
local_in_edges_tensor generation:  0.7396705150604248
mini_batch_src_global generation:  1.1621761322021484
r_  generation:  10.550246000289917
local_output_nid generation:  0.1817789077758789
local_in_edges_tensor generation:  0.7432589530944824
mini_batch_src_global generation:  1.1810190677642822
r_  generation:  11.097814798355103
local_output_nid generation:  0.18416261672973633
local_in_edges_tensor generation:  0.8096299171447754
mini_batch_src_global generation:  1.1347079277038574
r_  generation:  11.054830312728882
local_output_nid generation:  0.17854595184326172
local_in_edges_tensor generation:  0.7455956935882568
mini_batch_src_global generation:  1.2909483909606934
r_  generation:  10.870259284973145
local_output_nid generation:  0.20029139518737793
local_in_edges_tensor generation:  0.762578010559082
mini_batch_src_global generation:  1.1678822040557861
r_  generation:  11.128432750701904
local_output_nid generation:  0.19453787803649902
local_in_edges_tensor generation:  0.8333261013031006
mini_batch_src_global generation:  1.1545922756195068
r_  generation:  11.018428087234497
local_output_nid generation:  0.1847381591796875
local_in_edges_tensor generation:  0.7603542804718018
mini_batch_src_global generation:  1.3172976970672607
r_  generation:  10.831055879592896
local_output_nid generation:  0.1923062801361084
local_in_edges_tensor generation:  0.7718102931976318
mini_batch_src_global generation:  1.2311713695526123
r_  generation:  11.203110933303833
local_output_nid generation:  0.19702577590942383
local_in_edges_tensor generation:  0.8425266742706299
mini_batch_src_global generation:  1.1656577587127686
r_  generation:  11.153772354125977
local_output_nid generation:  0.18653202056884766
local_in_edges_tensor generation:  0.7802937030792236
mini_batch_src_global generation:  1.2657396793365479
r_  generation:  10.87336254119873
local_output_nid generation:  0.20294737815856934
local_in_edges_tensor generation:  0.7912743091583252
mini_batch_src_global generation:  1.2231836318969727
r_  generation:  11.125592231750488
local_output_nid generation:  0.1989150047302246
local_in_edges_tensor generation:  0.8837854862213135
mini_batch_src_global generation:  1.1594069004058838
r_  generation:  11.32926893234253
local_output_nid generation:  0.19640469551086426
local_in_edges_tensor generation:  0.8749516010284424
mini_batch_src_global generation:  1.1712431907653809
r_  generation:  10.90312385559082
local_output_nid generation:  0.20235991477966309
local_in_edges_tensor generation:  0.6806764602661133
mini_batch_src_global generation:  1.219968318939209
r_  generation:  11.15622591972351
----------------------check_connections_block total spend ----------------------------- 238.9016556739807
generate_one_block  15.482030153274536
generate_one_block  16.037955284118652
generate_one_block  15.113487243652344
generate_one_block  14.836958646774292
generate_one_block  15.278903245925903
generate_one_block  15.521368980407715
generate_one_block  15.410385608673096
generate_one_block  15.364305257797241
generate_one_block  16.179292917251587
generate_one_block  15.833965539932251
generate_one_block  15.41624140739441
generate_one_block  14.857082605361938
generate_one_block  15.156274318695068
generate_one_block  15.361830949783325
generate_one_block  15.511616468429565
generate_one_block  15.427161693572998
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2662417888641357
gen group dst list time:  1.1072514057159424
time for parepare:  0.45934271812438965
local_output_nid generation:  0.5316371917724609
local_in_edges_tensor generation:  1.6037745475769043
mini_batch_src_global generation:  1.870138168334961
r_  generation:  23.447734117507935
local_output_nid generation:  0.6247408390045166
local_in_edges_tensor generation:  1.7594292163848877
mini_batch_src_global generation:  2.7412166595458984
r_  generation:  23.854132175445557
local_output_nid generation:  0.649749755859375
local_in_edges_tensor generation:  1.9595022201538086
mini_batch_src_global generation:  2.838618040084839
r_  generation:  24.24016809463501
local_output_nid generation:  0.6547119617462158
local_in_edges_tensor generation:  1.7660865783691406
mini_batch_src_global generation:  2.617863416671753
r_  generation:  24.133803367614746
local_output_nid generation:  0.712388277053833
local_in_edges_tensor generation:  1.7999093532562256
mini_batch_src_global generation:  2.7475521564483643
r_  generation:  24.44627022743225
local_output_nid generation:  0.6643996238708496
local_in_edges_tensor generation:  1.8006556034088135
mini_batch_src_global generation:  2.8398518562316895
r_  generation:  24.303043603897095
local_output_nid generation:  0.671856164932251
local_in_edges_tensor generation:  1.8032550811767578
mini_batch_src_global generation:  2.8163437843322754
r_  generation:  24.352703094482422
local_output_nid generation:  0.6747298240661621
local_in_edges_tensor generation:  1.8155086040496826
mini_batch_src_global generation:  2.872047185897827
r_  generation:  24.32960319519043
local_output_nid generation:  0.6767740249633789
local_in_edges_tensor generation:  1.8041479587554932
mini_batch_src_global generation:  2.705965518951416
r_  generation:  24.429229497909546
local_output_nid generation:  0.711024284362793
local_in_edges_tensor generation:  1.8420679569244385
mini_batch_src_global generation:  2.792341470718384
r_  generation:  24.583802223205566
local_output_nid generation:  0.6789882183074951
local_in_edges_tensor generation:  1.806715488433838
mini_batch_src_global generation:  2.660369873046875
r_  generation:  24.52139902114868
local_output_nid generation:  0.7038998603820801
local_in_edges_tensor generation:  1.8572745323181152
mini_batch_src_global generation:  2.7683091163635254
r_  generation:  24.36850333213806
local_output_nid generation:  0.6769115924835205
local_in_edges_tensor generation:  1.8223211765289307
mini_batch_src_global generation:  2.64453125
r_  generation:  24.666290521621704
local_output_nid generation:  0.6940150260925293
local_in_edges_tensor generation:  3.8174564838409424
mini_batch_src_global generation:  2.7799649238586426
r_  generation:  24.624831914901733
local_output_nid generation:  0.6799464225769043
local_in_edges_tensor generation:  1.8305680751800537
mini_batch_src_global generation:  2.826748847961426
r_  generation:  25.282327890396118
local_output_nid generation:  0.6791789531707764
local_in_edges_tensor generation:  1.9338843822479248
mini_batch_src_global generation:  3.1685712337493896
r_  generation:  25.581365823745728
----------------------check_connections_block total spend ----------------------------- 547.9142582416534
generate_one_block  33.769599199295044
generate_one_block  33.64917349815369
generate_one_block  33.826980113983154
generate_one_block  33.90315866470337
generate_one_block  34.00536298751831
generate_one_block  34.01415228843689
generate_one_block  34.06673455238342
generate_one_block  34.7539701461792
generate_one_block  34.193631410598755
generate_one_block  34.407726764678955
generate_one_block  34.196938276290894
generate_one_block  34.475687742233276
generate_one_block  34.76255655288696
generate_one_block  34.796356439590454
generate_one_block  35.716164112091064
generate_one_block  35.405699729919434
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 2.898858070373535  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

connection checking time:  786.8159139156342
block generation total time  796.7327527999878
average batch blocks generation time:  49.79579704999924
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5182805061340332  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6137380599975586  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.522712230682373  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.628457546234131  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5207595825195312  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6190004348754883  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5183253288269043  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.614847183227539  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5204105377197266  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.621939182281494  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5223593711853027  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6285500526428223  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5208983421325684  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6206769943237305  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.525902271270752  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6336731910705566  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.519826889038086  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.621093273162842  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5244321823120117  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.631953239440918  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5202455520629883  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.621997833251953  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5193257331848145  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6207642555236816  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.525498867034912  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.630528450012207  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5187139511108398  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.617042064666748  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5184683799743652  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.6149048805236816  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 1.5221467018127441  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6141357421875 GB
    Memory Allocated: 3.626819610595703  GigaBytes
Max Memory Allocated: 5.041999816894531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4112239181995392 |1.2682279199361801 |0.0037601590156555176 |0.00014153122901916504 |0.004896804690361023 |0.0013561248779296875 |
----------------------------------------------------------pseudo_mini_loss sum 2.372511863708496
Total (block generation + training)time/epoch 1678.2199642658234
Training time/epoch 1648144074.3969536
Training time without block to device /epoch 1648144054.1053069
Training time without total dataloading part /epoch 0.14213204383850098
load block tensor time/epoch 6.579582691192627
block to device time/epoch 20.291646718978882
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  74232977
Number of first layer input nodes during this epoch: Using backend: pytorch
 36081298
