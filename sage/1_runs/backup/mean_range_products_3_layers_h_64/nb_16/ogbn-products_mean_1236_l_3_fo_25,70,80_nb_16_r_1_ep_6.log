main start at this time 1648069063.4131134
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6778781414031982
range selection method range initialization spend 0.029512405395507812
time for parepare:  0.3696930408477783
local_output_nid generation:  0.0035676956176757812
local_in_edges_tensor generation:  0.03564023971557617
mini_batch_src_global generation:  0.02513742446899414
r_  generation:  0.3595914840698242
local_output_nid generation:  0.0037775039672851562
local_in_edges_tensor generation:  0.016352415084838867
mini_batch_src_global generation:  0.03302931785583496
r_  generation:  0.40299105644226074
local_output_nid generation:  0.003723621368408203
local_in_edges_tensor generation:  0.005303621292114258
mini_batch_src_global generation:  0.022873401641845703
r_  generation:  0.41318774223327637
local_output_nid generation:  0.0037708282470703125
local_in_edges_tensor generation:  0.0054132938385009766
mini_batch_src_global generation:  0.025250911712646484
r_  generation:  0.4518144130706787
local_output_nid generation:  0.003736257553100586
local_in_edges_tensor generation:  0.005257844924926758
mini_batch_src_global generation:  0.02708721160888672
r_  generation:  0.471386194229126
local_output_nid generation:  0.003870248794555664
local_in_edges_tensor generation:  0.005415678024291992
mini_batch_src_global generation:  0.029824495315551758
r_  generation:  0.48743605613708496
local_output_nid generation:  0.003724336624145508
local_in_edges_tensor generation:  0.005364894866943359
mini_batch_src_global generation:  0.0315854549407959
r_  generation:  0.49561572074890137
local_output_nid generation:  0.0036988258361816406
local_in_edges_tensor generation:  0.005014181137084961
mini_batch_src_global generation:  0.032746315002441406
r_  generation:  0.5076706409454346
local_output_nid generation:  0.0037488937377929688
local_in_edges_tensor generation:  0.005021810531616211
mini_batch_src_global generation:  0.0339815616607666
r_  generation:  0.5002849102020264
local_output_nid generation:  0.00371551513671875
local_in_edges_tensor generation:  0.005050182342529297
mini_batch_src_global generation:  0.03504133224487305
r_  generation:  0.5274157524108887
local_output_nid generation:  0.0036973953247070312
local_in_edges_tensor generation:  0.0049839019775390625
mini_batch_src_global generation:  0.03636336326599121
r_  generation:  0.5124673843383789
local_output_nid generation:  0.0037078857421875
local_in_edges_tensor generation:  0.004971504211425781
mini_batch_src_global generation:  0.03820538520812988
r_  generation:  0.5149564743041992
local_output_nid generation:  0.0037004947662353516
local_in_edges_tensor generation:  0.005011796951293945
mini_batch_src_global generation:  0.03846454620361328
r_  generation:  0.5143699645996094
local_output_nid generation:  0.0037267208099365234
local_in_edges_tensor generation:  0.00497889518737793
mini_batch_src_global generation:  0.0398259162902832
r_  generation:  0.5254955291748047
local_output_nid generation:  0.0037322044372558594
local_in_edges_tensor generation:  0.0050504207611083984
mini_batch_src_global generation:  0.041071414947509766
r_  generation:  0.5246126651763916
local_output_nid generation:  0.0036962032318115234
local_in_edges_tensor generation:  0.004990100860595703
mini_batch_src_global generation:  0.04163551330566406
r_  generation:  0.5177934169769287
----------------------check_connections_block total spend ----------------------------- 10.089656114578247
generate_one_block  5.530708074569702
generate_one_block  0.5075759887695312
generate_one_block  0.5156919956207275
generate_one_block  0.504143238067627
generate_one_block  0.5067334175109863
generate_one_block  0.5077788829803467
generate_one_block  0.5091965198516846
generate_one_block  0.5066843032836914
generate_one_block  0.5088963508605957
generate_one_block  0.5051059722900391
generate_one_block  0.5137772560119629
generate_one_block  0.5013067722320557
generate_one_block  0.5057790279388428
generate_one_block  0.5020091533660889
generate_one_block  0.5067644119262695
generate_one_block  0.5035643577575684
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.378563404083252
gen group dst list time:  0.255037784576416
time for parepare:  0.47345447540283203
local_output_nid generation:  0.11287641525268555
local_in_edges_tensor generation:  0.6475279331207275
mini_batch_src_global generation:  0.8835716247558594
r_  generation:  10.470719337463379
local_output_nid generation:  0.15670466423034668
local_in_edges_tensor generation:  0.7417163848876953
mini_batch_src_global generation:  1.202280044555664
r_  generation:  10.509684324264526
local_output_nid generation:  0.16489195823669434
local_in_edges_tensor generation:  0.9249038696289062
mini_batch_src_global generation:  1.1633896827697754
r_  generation:  10.588788270950317
local_output_nid generation:  0.1803600788116455
local_in_edges_tensor generation:  0.7920005321502686
mini_batch_src_global generation:  1.1286108493804932
r_  generation:  10.89633059501648
local_output_nid generation:  0.16496729850769043
local_in_edges_tensor generation:  0.6601200103759766
mini_batch_src_global generation:  1.1723875999450684
r_  generation:  10.73937702178955
local_output_nid generation:  0.19028258323669434
local_in_edges_tensor generation:  0.8108081817626953
mini_batch_src_global generation:  1.149562120437622
r_  generation:  11.046859979629517
local_output_nid generation:  0.17017364501953125
local_in_edges_tensor generation:  0.6683566570281982
mini_batch_src_global generation:  1.1520724296569824
r_  generation:  10.827738285064697
local_output_nid generation:  0.19977355003356934
local_in_edges_tensor generation:  0.854576587677002
mini_batch_src_global generation:  1.1977005004882812
r_  generation:  10.923629760742188
local_output_nid generation:  0.17666864395141602
local_in_edges_tensor generation:  0.8500103950500488
mini_batch_src_global generation:  1.1623482704162598
r_  generation:  10.768531322479248
local_output_nid generation:  0.19054770469665527
local_in_edges_tensor generation:  0.6976304054260254
mini_batch_src_global generation:  1.258711576461792
r_  generation:  10.932838678359985
local_output_nid generation:  0.20230889320373535
local_in_edges_tensor generation:  0.8705735206604004
mini_batch_src_global generation:  1.1466643810272217
r_  generation:  11.085487842559814
local_output_nid generation:  0.17494893074035645
local_in_edges_tensor generation:  0.668933629989624
mini_batch_src_global generation:  1.1880764961242676
r_  generation:  10.810024738311768
local_output_nid generation:  0.20321393013000488
local_in_edges_tensor generation:  0.8767940998077393
mini_batch_src_global generation:  1.1448032855987549
r_  generation:  11.06026291847229
local_output_nid generation:  0.18884611129760742
local_in_edges_tensor generation:  0.685706377029419
mini_batch_src_global generation:  1.192328691482544
r_  generation:  10.776362895965576
local_output_nid generation:  0.1980597972869873
local_in_edges_tensor generation:  0.8401179313659668
mini_batch_src_global generation:  1.1917872428894043
r_  generation:  11.066647291183472
local_output_nid generation:  0.18771958351135254
local_in_edges_tensor generation:  0.8569023609161377
mini_batch_src_global generation:  1.1822969913482666
r_  generation:  10.83277153968811
----------------------check_connections_block total spend ----------------------------- 236.57002472877502
generate_one_block  15.850941896438599
generate_one_block  15.212629556655884
generate_one_block  14.856863498687744
generate_one_block  15.001052379608154
generate_one_block  15.20664668083191
generate_one_block  14.796901226043701
generate_one_block  15.100048065185547
generate_one_block  15.176963567733765
generate_one_block  15.011248588562012
generate_one_block  15.154291152954102
generate_one_block  15.297430515289307
generate_one_block  14.678641557693481
generate_one_block  15.128287553787231
generate_one_block  15.244935989379883
generate_one_block  14.664846658706665
generate_one_block  15.1452956199646
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.162785530090332
gen group dst list time:  1.0525803565979004
time for parepare:  0.4750945568084717
local_output_nid generation:  0.5045015811920166
local_in_edges_tensor generation:  1.28599214553833
mini_batch_src_global generation:  1.2027091979980469
r_  generation:  15.928018569946289
local_output_nid generation:  0.6241142749786377
local_in_edges_tensor generation:  1.3532915115356445
mini_batch_src_global generation:  1.6398394107818604
r_  generation:  15.628316879272461
local_output_nid generation:  0.643151044845581
local_in_edges_tensor generation:  1.3882946968078613
mini_batch_src_global generation:  1.5274062156677246
r_  generation:  15.751888751983643
local_output_nid generation:  0.6345620155334473
local_in_edges_tensor generation:  1.3618836402893066
mini_batch_src_global generation:  1.6909558773040771
r_  generation:  15.717700958251953
local_output_nid generation:  0.6419000625610352
local_in_edges_tensor generation:  1.3135838508605957
mini_batch_src_global generation:  1.601146936416626
r_  generation:  15.921112060546875
local_output_nid generation:  0.6508593559265137
local_in_edges_tensor generation:  2.5399041175842285
mini_batch_src_global generation:  1.6692445278167725
r_  generation:  16.364046335220337
local_output_nid generation:  0.6704857349395752
local_in_edges_tensor generation:  1.294112205505371
mini_batch_src_global generation:  1.6753950119018555
r_  generation:  16.18480634689331
local_output_nid generation:  0.6714093685150146
local_in_edges_tensor generation:  1.304302453994751
mini_batch_src_global generation:  1.5623753070831299
r_  generation:  16.48176145553589
local_output_nid generation:  0.6744389533996582
local_in_edges_tensor generation:  1.2869844436645508
mini_batch_src_global generation:  1.8076236248016357
r_  generation:  16.551876544952393
local_output_nid generation:  0.672119140625
local_in_edges_tensor generation:  1.2944259643554688
mini_batch_src_global generation:  1.6574103832244873
r_  generation:  15.753338813781738
local_output_nid generation:  0.6684496402740479
local_in_edges_tensor generation:  1.290555477142334
mini_batch_src_global generation:  1.6396374702453613
r_  generation:  16.18407440185547
local_output_nid generation:  0.6716701984405518
local_in_edges_tensor generation:  1.2891156673431396
mini_batch_src_global generation:  1.6257202625274658
r_  generation:  15.807429075241089
local_output_nid generation:  0.6621010303497314
local_in_edges_tensor generation:  1.2872064113616943
mini_batch_src_global generation:  1.6488640308380127
r_  generation:  16.129178524017334
local_output_nid generation:  0.6714093685150146
local_in_edges_tensor generation:  1.3046386241912842
mini_batch_src_global generation:  1.5642375946044922
r_  generation:  15.905572414398193
local_output_nid generation:  0.6638405323028564
local_in_edges_tensor generation:  1.2917966842651367
mini_batch_src_global generation:  1.6670935153961182
r_  generation:  16.08117175102234
local_output_nid generation:  0.671867847442627
local_in_edges_tensor generation:  1.298793077468872
mini_batch_src_global generation:  1.5699849128723145
r_  generation:  15.882479429244995
----------------------check_connections_block total spend ----------------------------- 362.86075091362
generate_one_block  23.14571762084961
generate_one_block  21.458947896957397
generate_one_block  21.52217435836792
generate_one_block  21.425134897232056
generate_one_block  21.694705486297607
generate_one_block  21.425817012786865
generate_one_block  22.27310609817505
generate_one_block  21.393131494522095
generate_one_block  21.339263677597046
generate_one_block  21.30873727798462
generate_one_block  21.271073818206787
generate_one_block  21.20175051689148
generate_one_block  21.47634720802307
generate_one_block  21.54482364654541
generate_one_block  21.305001258850098
generate_one_block  21.62341570854187
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  599.430775642395
block generation total time  586.9361724853516
average batch blocks generation time:  36.68351078033447
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4305419921875 GB
    Memory Allocated: 1.325181484222412  GigaBytes
Max Memory Allocated: 1.325181484222412  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3074951171875 GB
    Memory Allocated: 3.2497525215148926  GigaBytes
Max Memory Allocated: 3.4885783195495605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3280949592590332  GigaBytes
Max Memory Allocated: 4.018433094024658  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.251577377319336  GigaBytes
Max Memory Allocated: 4.018433094024658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.327977180480957  GigaBytes
Max Memory Allocated: 4.022644996643066  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.2507805824279785  GigaBytes
Max Memory Allocated: 4.022644996643066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.3284454345703125  GigaBytes
Max Memory Allocated: 4.022938251495361  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.2498011589050293  GigaBytes
Max Memory Allocated: 4.022938251495361  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.3282470703125  GigaBytes
Max Memory Allocated: 4.023207187652588  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.2502851486206055  GigaBytes
Max Memory Allocated: 4.023207187652588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.3289885520935059  GigaBytes
Max Memory Allocated: 4.02466344833374  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.251697063446045  GigaBytes
Max Memory Allocated: 4.02466344833374  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 1.329270362854004  GigaBytes
Max Memory Allocated: 4.02466344833374  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4071044921875 GB
    Memory Allocated: 3.2500433921813965  GigaBytes
Max Memory Allocated: 4.02466344833374  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 1.3282208442687988  GigaBytes
Max Memory Allocated: 4.02466344833374  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2352294921875 GB
    Memory Allocated: 3.2476701736450195  GigaBytes
Max Memory Allocated: 4.02466344833374  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.329010009765625  GigaBytes
Max Memory Allocated: 4.02466344833374  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2551522254943848  GigaBytes
Max Memory Allocated: 4.02466344833374  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3272557258605957  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2479729652404785  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3289928436279297  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.251997947692871  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3271369934082031  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2479000091552734  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328033447265625  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.247307300567627  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3293771743774414  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2555627822875977  GigaBytes
Max Memory Allocated: 4.026364803314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3262052536010742  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2454428672790527  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3266921043395996  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.245838165283203  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36450958251953125 |0.5759264528751373 |0.04817117750644684 |0.0001564323902130127 |0.04270462691783905 |0.003682851791381836 |
----------------------------------------------------------pseudo_mini_loss sum 8.758194923400879
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  73592944
Number of first layer input nodes during this epoch:  35461552
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.3505759239196777  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6832790374755859
range selection method range initialization spend 0.022584199905395508
time for parepare:  0.366715669631958
local_output_nid generation:  0.0034825801849365234
local_in_edges_tensor generation:  0.037897348403930664
mini_batch_src_global generation:  0.028627634048461914
r_  generation:  0.35369038581848145
local_output_nid generation:  0.0037157535552978516
local_in_edges_tensor generation:  0.010134458541870117
mini_batch_src_global generation:  0.03389692306518555
r_  generation:  0.3964693546295166
local_output_nid generation:  0.003669261932373047
local_in_edges_tensor generation:  0.005494356155395508
mini_batch_src_global generation:  0.023359298706054688
r_  generation:  0.4227895736694336
local_output_nid generation:  0.00372314453125
local_in_edges_tensor generation:  0.005771160125732422
mini_batch_src_global generation:  0.02546977996826172
r_  generation:  0.4493589401245117
local_output_nid generation:  0.003660917282104492
local_in_edges_tensor generation:  0.0052487850189208984
mini_batch_src_global generation:  0.0276486873626709
r_  generation:  0.4594271183013916
local_output_nid generation:  0.0037436485290527344
local_in_edges_tensor generation:  0.005067348480224609
mini_batch_src_global generation:  0.03026866912841797
r_  generation:  0.4933340549468994
local_output_nid generation:  0.0036993026733398438
local_in_edges_tensor generation:  0.0056841373443603516
mini_batch_src_global generation:  0.03246808052062988
r_  generation:  0.5031664371490479
local_output_nid generation:  0.0037457942962646484
local_in_edges_tensor generation:  0.006519317626953125
mini_batch_src_global generation:  0.03268766403198242
r_  generation:  0.5048918724060059
local_output_nid generation:  0.003710508346557617
local_in_edges_tensor generation:  0.007477760314941406
mini_batch_src_global generation:  0.03530001640319824
r_  generation:  0.5132291316986084
local_output_nid generation:  0.003721475601196289
local_in_edges_tensor generation:  0.0059473514556884766
mini_batch_src_global generation:  0.03506922721862793
r_  generation:  0.5117769241333008
local_output_nid generation:  0.0037009716033935547
local_in_edges_tensor generation:  0.0049991607666015625
mini_batch_src_global generation:  0.03682231903076172
r_  generation:  0.5187625885009766
local_output_nid generation:  0.0037169456481933594
local_in_edges_tensor generation:  0.00505375862121582
mini_batch_src_global generation:  0.03815507888793945
r_  generation:  0.5297987461090088
local_output_nid generation:  0.0037283897399902344
local_in_edges_tensor generation:  0.005471944808959961
mini_batch_src_global generation:  0.03899240493774414
r_  generation:  0.5489087104797363
local_output_nid generation:  0.0036973953247070312
local_in_edges_tensor generation:  0.005306243896484375
mini_batch_src_global generation:  0.039865732192993164
r_  generation:  0.5425848960876465
local_output_nid generation:  0.0037555694580078125
local_in_edges_tensor generation:  0.005103349685668945
mini_batch_src_global generation:  0.04053473472595215
r_  generation:  0.5367636680603027
local_output_nid generation:  0.007044553756713867
local_in_edges_tensor generation:  0.009237051010131836
mini_batch_src_global generation:  0.04129743576049805
r_  generation:  0.5347135066986084
----------------------check_connections_block total spend ----------------------------- 10.243317365646362
generate_one_block  0.8875524997711182
generate_one_block  0.5295624732971191
generate_one_block  0.5165717601776123
generate_one_block  0.5070638656616211
generate_one_block  0.5140960216522217
generate_one_block  0.4992859363555908
generate_one_block  0.5054819583892822
generate_one_block  0.5079953670501709
generate_one_block  0.4978146553039551
generate_one_block  0.5118985176086426
generate_one_block  0.502239465713501
generate_one_block  0.5157489776611328
generate_one_block  0.5105812549591064
generate_one_block  0.5078706741333008
generate_one_block  0.5043189525604248
generate_one_block  0.5082454681396484
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.462172031402588
gen group dst list time:  0.2420482635498047
time for parepare:  0.4843134880065918
local_output_nid generation:  0.1030435562133789
local_in_edges_tensor generation:  0.7194633483886719
mini_batch_src_global generation:  0.9240138530731201
r_  generation:  10.351408243179321
local_output_nid generation:  0.15685510635375977
local_in_edges_tensor generation:  0.7891671657562256
mini_batch_src_global generation:  1.181114912033081
r_  generation:  10.533838272094727
local_output_nid generation:  0.15893816947937012
local_in_edges_tensor generation:  0.8635823726654053
mini_batch_src_global generation:  1.1334753036499023
r_  generation:  10.792285919189453
local_output_nid generation:  0.1819303035736084
local_in_edges_tensor generation:  0.7916197776794434
mini_batch_src_global generation:  1.1450459957122803
r_  generation:  10.899565696716309
local_output_nid generation:  0.18679070472717285
local_in_edges_tensor generation:  0.6420891284942627
mini_batch_src_global generation:  1.1953825950622559
r_  generation:  10.949293613433838
local_output_nid generation:  0.1885206699371338
local_in_edges_tensor generation:  0.8136372566223145
mini_batch_src_global generation:  1.1602261066436768
r_  generation:  10.890458106994629
local_output_nid generation:  0.17112183570861816
local_in_edges_tensor generation:  0.8213798999786377
mini_batch_src_global generation:  1.23116135597229
r_  generation:  10.888986110687256
local_output_nid generation:  0.19530391693115234
local_in_edges_tensor generation:  0.8478353023529053
mini_batch_src_global generation:  1.2798254489898682
r_  generation:  12.008924961090088
local_output_nid generation:  0.21746015548706055
local_in_edges_tensor generation:  0.8509533405303955
mini_batch_src_global generation:  1.3384733200073242
r_  generation:  11.231892585754395
local_output_nid generation:  0.18219232559204102
local_in_edges_tensor generation:  0.8390383720397949
mini_batch_src_global generation:  1.2541234493255615
r_  generation:  10.932890892028809
local_output_nid generation:  0.194411039352417
local_in_edges_tensor generation:  0.843040943145752
mini_batch_src_global generation:  1.254150629043579
r_  generation:  11.13959813117981
local_output_nid generation:  0.2053225040435791
local_in_edges_tensor generation:  0.7562627792358398
mini_batch_src_global generation:  1.196202278137207
r_  generation:  11.17881727218628
local_output_nid generation:  0.20685911178588867
local_in_edges_tensor generation:  0.7654905319213867
mini_batch_src_global generation:  1.1524126529693604
r_  generation:  11.144465446472168
local_output_nid generation:  0.18792343139648438
local_in_edges_tensor generation:  0.8469350337982178
mini_batch_src_global generation:  1.2334353923797607
r_  generation:  10.955864191055298
local_output_nid generation:  0.1978931427001953
local_in_edges_tensor generation:  0.8557953834533691
mini_batch_src_global generation:  1.257507562637329
r_  generation:  11.024877309799194
local_output_nid generation:  0.21802282333374023
local_in_edges_tensor generation:  0.8657486438751221
mini_batch_src_global generation:  1.1698191165924072
r_  generation:  11.041664838790894
----------------------check_connections_block total spend ----------------------------- 240.66898560523987
generate_one_block  15.371344804763794
generate_one_block  15.880445003509521
generate_one_block  15.369777917861938
generate_one_block  15.37715768814087
generate_one_block  15.347456216812134
generate_one_block  15.257885932922363
generate_one_block  15.392813444137573
generate_one_block  15.320509195327759
generate_one_block  15.300691604614258
generate_one_block  15.623912811279297
generate_one_block  15.369854211807251
generate_one_block  15.367112874984741
generate_one_block  15.413187026977539
generate_one_block  15.458462238311768
generate_one_block  15.517797946929932
generate_one_block  15.268049716949463
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.202955722808838
gen group dst list time:  1.1060550212860107
time for parepare:  0.5216693878173828
local_output_nid generation:  0.5087313652038574
local_in_edges_tensor generation:  1.2049734592437744
mini_batch_src_global generation:  1.1602585315704346
r_  generation:  15.564309120178223
local_output_nid generation:  0.6328473091125488
local_in_edges_tensor generation:  1.2742812633514404
mini_batch_src_global generation:  1.5766973495483398
r_  generation:  15.632127285003662
local_output_nid generation:  0.6532392501831055
local_in_edges_tensor generation:  1.4017465114593506
mini_batch_src_global generation:  1.64886474609375
r_  generation:  16.152890920639038
local_output_nid generation:  0.6427359580993652
local_in_edges_tensor generation:  1.2719142436981201
mini_batch_src_global generation:  1.6175079345703125
r_  generation:  16.17259168624878
local_output_nid generation:  0.6674816608428955
local_in_edges_tensor generation:  1.2785720825195312
mini_batch_src_global generation:  1.5557434558868408
r_  generation:  16.366658449172974
local_output_nid generation:  0.6577317714691162
local_in_edges_tensor generation:  1.2764346599578857
mini_batch_src_global generation:  1.566559076309204
r_  generation:  16.177674293518066
local_output_nid generation:  0.6645040512084961
local_in_edges_tensor generation:  1.3092455863952637
mini_batch_src_global generation:  1.542497158050537
r_  generation:  16.470033645629883
local_output_nid generation:  0.6709346771240234
local_in_edges_tensor generation:  1.296128749847412
mini_batch_src_global generation:  1.574650526046753
r_  generation:  16.263591289520264
local_output_nid generation:  0.6703612804412842
local_in_edges_tensor generation:  1.295522928237915
mini_batch_src_global generation:  1.5937676429748535
r_  generation:  16.304330110549927
local_output_nid generation:  0.6731791496276855
local_in_edges_tensor generation:  1.303424596786499
mini_batch_src_global generation:  1.7703182697296143
r_  generation:  16.212192058563232
local_output_nid generation:  0.6808955669403076
local_in_edges_tensor generation:  1.294240951538086
mini_batch_src_global generation:  1.663086175918579
r_  generation:  16.451332330703735
local_output_nid generation:  0.6784570217132568
local_in_edges_tensor generation:  1.2926042079925537
mini_batch_src_global generation:  1.6322040557861328
r_  generation:  16.513080835342407
local_output_nid generation:  0.6812257766723633
local_in_edges_tensor generation:  1.3048465251922607
mini_batch_src_global generation:  1.5832154750823975
r_  generation:  16.478992700576782
local_output_nid generation:  0.6500391960144043
local_in_edges_tensor generation:  2.9358716011047363
mini_batch_src_global generation:  1.5238497257232666
r_  generation:  16.22568106651306
local_output_nid generation:  0.6890218257904053
local_in_edges_tensor generation:  1.2996761798858643
mini_batch_src_global generation:  1.5407440662384033
r_  generation:  16.353432655334473
local_output_nid generation:  0.671452522277832
local_in_edges_tensor generation:  1.3002538681030273
mini_batch_src_global generation:  1.6273715496063232
r_  generation:  16.206634998321533
----------------------check_connections_block total spend ----------------------------- 365.84703969955444
generate_one_block  21.903616189956665
generate_one_block  21.621708393096924
generate_one_block  21.624236822128296
generate_one_block  21.513574361801147
generate_one_block  21.799864292144775
generate_one_block  21.648216724395752
generate_one_block  21.590569257736206
generate_one_block  21.971317768096924
generate_one_block  21.738645315170288
generate_one_block  21.72234296798706
generate_one_block  21.663203239440918
generate_one_block  21.5238516330719
generate_one_block  21.781474113464355
generate_one_block  21.66490888595581
generate_one_block  21.721534252166748
generate_one_block  21.661945819854736
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.3505759239196777  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

connection checking time:  606.5160253047943
block generation total time  593.7874686717987
average batch blocks generation time:  37.11171679198742
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3287525177001953  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2508225440979004  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3264541625976562  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2470083236694336  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3297038078308105  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.254551410675049  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3286638259887695  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2516627311706543  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3281269073486328  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.248427391052246  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3284416198730469  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2478318214416504  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328385353088379  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2508387565612793  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3282842636108398  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2505555152893066  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.328104019165039  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2485132217407227  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3304953575134277  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2565298080444336  GigaBytes
Max Memory Allocated: 4.0292253494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3289241790771484  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2525320053100586  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3276443481445312  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2503838539123535  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3291258811950684  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.252586841583252  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3269615173339844  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2455554008483887  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3283143043518066  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.249882221221924  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3288488388061523  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2507448196411133  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3884723037481308 |0.4506157338619232 |0.0038173794746398926 |0.00014127790927886963 |0.004905819892883301 |0.002782583236694336 |
----------------------------------------------------------pseudo_mini_loss sum 5.08624267578125
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  73595150
Number of first layer input nodes during this epoch:  35460177
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.353682518005371  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.571113109588623
range selection method range initialization spend 0.02889275550842285
time for parepare:  0.3693203926086426
local_output_nid generation:  0.0034515857696533203
local_in_edges_tensor generation:  0.04152965545654297
mini_batch_src_global generation:  0.04480099678039551
r_  generation:  0.36858272552490234
local_output_nid generation:  0.0036859512329101562
local_in_edges_tensor generation:  0.009677886962890625
mini_batch_src_global generation:  0.036138057708740234
r_  generation:  0.4152984619140625
local_output_nid generation:  0.0036110877990722656
local_in_edges_tensor generation:  0.008577823638916016
mini_batch_src_global generation:  0.022848129272460938
r_  generation:  0.42810606956481934
local_output_nid generation:  0.0037202835083007812
local_in_edges_tensor generation:  0.00531768798828125
mini_batch_src_global generation:  0.026296138763427734
r_  generation:  0.4646894931793213
local_output_nid generation:  0.003743886947631836
local_in_edges_tensor generation:  0.006517887115478516
mini_batch_src_global generation:  0.027338743209838867
r_  generation:  0.47416019439697266
local_output_nid generation:  0.003736257553100586
local_in_edges_tensor generation:  0.007727146148681641
mini_batch_src_global generation:  0.030322551727294922
r_  generation:  0.49339818954467773
local_output_nid generation:  0.0036623477935791016
local_in_edges_tensor generation:  0.005337238311767578
mini_batch_src_global generation:  0.03144979476928711
r_  generation:  0.5225586891174316
local_output_nid generation:  0.0037796497344970703
local_in_edges_tensor generation:  0.0063550472259521484
mini_batch_src_global generation:  0.0327448844909668
r_  generation:  0.5355267524719238
local_output_nid generation:  0.0038497447967529297
local_in_edges_tensor generation:  0.006640911102294922
mini_batch_src_global generation:  0.035457611083984375
r_  generation:  0.5226402282714844
local_output_nid generation:  0.0037081241607666016
local_in_edges_tensor generation:  0.0063304901123046875
mini_batch_src_global generation:  0.03525185585021973
r_  generation:  0.5126228332519531
local_output_nid generation:  0.0038187503814697266
local_in_edges_tensor generation:  0.0065975189208984375
mini_batch_src_global generation:  0.03682756423950195
r_  generation:  0.5115652084350586
local_output_nid generation:  0.003962993621826172
local_in_edges_tensor generation:  0.005746603012084961
mini_batch_src_global generation:  0.03859543800354004
r_  generation:  0.5164492130279541
local_output_nid generation:  0.0038836002349853516
local_in_edges_tensor generation:  0.008574724197387695
mini_batch_src_global generation:  0.05280780792236328
r_  generation:  0.525780439376831
local_output_nid generation:  0.004050731658935547
local_in_edges_tensor generation:  0.00880885124206543
mini_batch_src_global generation:  0.04012703895568848
r_  generation:  0.5293765068054199
local_output_nid generation:  0.003900766372680664
local_in_edges_tensor generation:  0.0075151920318603516
mini_batch_src_global generation:  0.040360212326049805
r_  generation:  0.5181329250335693
local_output_nid generation:  0.004187345504760742
local_in_edges_tensor generation:  0.00867009162902832
mini_batch_src_global generation:  0.04032397270202637
r_  generation:  0.5210433006286621
----------------------check_connections_block total spend ----------------------------- 10.38448190689087
generate_one_block  0.8839137554168701
generate_one_block  0.5320789813995361
generate_one_block  0.5147502422332764
generate_one_block  0.513836145401001
generate_one_block  0.5242090225219727
generate_one_block  0.5120713710784912
generate_one_block  0.5101964473724365
generate_one_block  0.515794038772583
generate_one_block  0.5117151737213135
generate_one_block  0.5294647216796875
generate_one_block  0.5158681869506836
generate_one_block  0.5151886940002441
generate_one_block  0.5261580944061279
generate_one_block  0.5222315788269043
generate_one_block  0.5701584815979004
generate_one_block  0.7067155838012695
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.546372175216675
gen group dst list time:  0.2534322738647461
time for parepare:  0.4642212390899658
local_output_nid generation:  0.11386704444885254
local_in_edges_tensor generation:  0.6494650840759277
mini_batch_src_global generation:  0.9191222190856934
r_  generation:  10.761147260665894
local_output_nid generation:  0.1579418182373047
local_in_edges_tensor generation:  0.7607426643371582
mini_batch_src_global generation:  1.1166415214538574
r_  generation:  10.78658652305603
local_output_nid generation:  0.17361760139465332
local_in_edges_tensor generation:  0.9519500732421875
mini_batch_src_global generation:  1.1243603229522705
r_  generation:  10.729668378829956
local_output_nid generation:  0.1646568775177002
local_in_edges_tensor generation:  0.799595832824707
mini_batch_src_global generation:  1.275866985321045
r_  generation:  10.541574716567993
local_output_nid generation:  0.1806929111480713
local_in_edges_tensor generation:  0.6716887950897217
mini_batch_src_global generation:  1.14418625831604
r_  generation:  11.09641146659851
local_output_nid generation:  0.18627429008483887
local_in_edges_tensor generation:  0.8449466228485107
mini_batch_src_global generation:  1.1534051895141602
r_  generation:  10.766762971878052
local_output_nid generation:  0.18088150024414062
local_in_edges_tensor generation:  0.7609610557556152
mini_batch_src_global generation:  1.316770076751709
r_  generation:  10.729502439498901
local_output_nid generation:  0.18956255912780762
local_in_edges_tensor generation:  0.7635087966918945
mini_batch_src_global generation:  1.2361435890197754
r_  generation:  12.323439836502075
local_output_nid generation:  0.20424199104309082
local_in_edges_tensor generation:  0.874565601348877
mini_batch_src_global generation:  1.285801887512207
r_  generation:  10.929032802581787
local_output_nid generation:  0.20105767250061035
local_in_edges_tensor generation:  0.8463516235351562
mini_batch_src_global generation:  1.1627655029296875
r_  generation:  11.090540885925293
local_output_nid generation:  0.20630717277526855
local_in_edges_tensor generation:  0.8543684482574463
mini_batch_src_global generation:  1.1860969066619873
r_  generation:  10.768587112426758
local_output_nid generation:  0.18740057945251465
local_in_edges_tensor generation:  0.6790323257446289
mini_batch_src_global generation:  1.2384910583496094
r_  generation:  11.116501569747925
local_output_nid generation:  0.20421457290649414
local_in_edges_tensor generation:  0.8677358627319336
mini_batch_src_global generation:  1.154832363128662
r_  generation:  11.05172085762024
local_output_nid generation:  0.1791248321533203
local_in_edges_tensor generation:  0.8729677200317383
mini_batch_src_global generation:  1.319361925125122
r_  generation:  10.7647066116333
local_output_nid generation:  0.20202994346618652
local_in_edges_tensor generation:  0.7003204822540283
mini_batch_src_global generation:  1.161937952041626
r_  generation:  11.240299463272095
local_output_nid generation:  0.20106291770935059
local_in_edges_tensor generation:  0.8694086074829102
mini_batch_src_global generation:  1.1701390743255615
r_  generation:  10.806835412979126
----------------------check_connections_block total spend ----------------------------- 239.9973168373108
generate_one_block  15.376858949661255
generate_one_block  16.021644353866577
generate_one_block  15.569411516189575
generate_one_block  15.249513149261475
generate_one_block  15.067285299301147
generate_one_block  15.638924598693848
generate_one_block  15.248701095581055
generate_one_block  14.965959548950195
generate_one_block  15.29908299446106
generate_one_block  15.826215744018555
generate_one_block  15.415625810623169
generate_one_block  14.971991777420044
generate_one_block  15.58731746673584
generate_one_block  15.618477582931519
generate_one_block  15.44475507736206
generate_one_block  14.974483728408813
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2454111576080322
gen group dst list time:  1.0941615104675293
time for parepare:  0.459244966506958
local_output_nid generation:  0.4999551773071289
local_in_edges_tensor generation:  1.1944634914398193
mini_batch_src_global generation:  1.194162130355835
r_  generation:  15.367628812789917
local_output_nid generation:  0.6152667999267578
local_in_edges_tensor generation:  1.3755037784576416
mini_batch_src_global generation:  1.4974308013916016
r_  generation:  15.793786764144897
local_output_nid generation:  0.6390104293823242
local_in_edges_tensor generation:  1.2601406574249268
mini_batch_src_global generation:  1.5025055408477783
r_  generation:  16.083266258239746
local_output_nid generation:  0.6502106189727783
local_in_edges_tensor generation:  1.2667710781097412
mini_batch_src_global generation:  1.5393197536468506
r_  generation:  16.050722122192383
local_output_nid generation:  0.6590602397918701
local_in_edges_tensor generation:  1.2873291969299316
mini_batch_src_global generation:  1.5349478721618652
r_  generation:  16.3888680934906
local_output_nid generation:  0.6639373302459717
local_in_edges_tensor generation:  1.298994541168213
mini_batch_src_global generation:  1.541344165802002
r_  generation:  16.15512704849243
local_output_nid generation:  0.6781868934631348
local_in_edges_tensor generation:  1.3218564987182617
mini_batch_src_global generation:  1.5983586311340332
r_  generation:  16.373522996902466
local_output_nid generation:  0.679934024810791
local_in_edges_tensor generation:  1.337416410446167
mini_batch_src_global generation:  1.5993754863739014
r_  generation:  16.11450219154358
local_output_nid generation:  0.6816062927246094
local_in_edges_tensor generation:  1.3046789169311523
mini_batch_src_global generation:  1.6120820045471191
r_  generation:  16.27648639678955
local_output_nid generation:  0.6770153045654297
local_in_edges_tensor generation:  1.315429449081421
mini_batch_src_global generation:  1.6273863315582275
r_  generation:  16.149590730667114
local_output_nid generation:  0.701519250869751
local_in_edges_tensor generation:  1.327833652496338
mini_batch_src_global generation:  1.6956000328063965
r_  generation:  16.33519220352173
local_output_nid generation:  0.7126715183258057
local_in_edges_tensor generation:  1.3231797218322754
mini_batch_src_global generation:  1.809807538986206
r_  generation:  15.945690870285034
local_output_nid generation:  0.6654260158538818
local_in_edges_tensor generation:  1.3272998332977295
mini_batch_src_global generation:  1.7233176231384277
r_  generation:  16.438419580459595
local_output_nid generation:  0.6976304054260254
local_in_edges_tensor generation:  2.9715325832366943
mini_batch_src_global generation:  1.5288093090057373
r_  generation:  16.303191900253296
local_output_nid generation:  0.6926772594451904
local_in_edges_tensor generation:  1.306028127670288
mini_batch_src_global generation:  1.5764811038970947
r_  generation:  16.452175855636597
local_output_nid generation:  0.6929512023925781
local_in_edges_tensor generation:  1.3040552139282227
mini_batch_src_global generation:  1.56882905960083
r_  generation:  16.23857569694519
----------------------check_connections_block total spend ----------------------------- 364.28926730155945
generate_one_block  21.74555802345276
generate_one_block  21.408014059066772
generate_one_block  21.381049871444702
generate_one_block  21.253734588623047
generate_one_block  21.412453651428223
generate_one_block  22.042264461517334
generate_one_block  21.608745574951172
generate_one_block  22.145204067230225
generate_one_block  21.640206575393677
generate_one_block  21.677427768707275
generate_one_block  21.684703826904297
generate_one_block  21.683118104934692
generate_one_block  21.67909574508667
generate_one_block  21.66882014274597
generate_one_block  21.762786865234375
generate_one_block  21.557282209396362
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 2.353682518005371  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

connection checking time:  604.2865841388702
block generation total time  592.6267142295837
average batch blocks generation time:  37.039169639348984
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.332167148590088  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2583422660827637  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3266072273254395  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2471556663513184  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.329115867614746  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.25309419631958  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3285818099975586  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.24771785736084  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.329230785369873  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.252140522003174  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3283805847167969  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.251605987548828  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3263216018676758  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.244873046875  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3270535469055176  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.24788236618042  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3271574974060059  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2439656257629395  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.3281240463256836  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.250300407409668  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 1.330772876739502  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0633544921875 GB
    Memory Allocated: 3.2558646202087402  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0653076171875 GB
    Memory Allocated: 1.3291263580322266  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0653076171875 GB
    Memory Allocated: 3.2528114318847656  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0653076171875 GB
    Memory Allocated: 1.3296527862548828  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0653076171875 GB
    Memory Allocated: 3.255702018737793  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0653076171875 GB
    Memory Allocated: 1.3312578201293945  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0653076171875 GB
    Memory Allocated: 3.2569069862365723  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0653076171875 GB
    Memory Allocated: 1.3297858238220215  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.259319305419922  GigaBytes
Max Memory Allocated: 4.029961109161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.32887601852417  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.250612735748291  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38504667580127716 |0.5718744397163391 |0.005220308899879456 |0.00014224648475646973 |0.013248845934867859 |0.0013570785522460938 |
----------------------------------------------------------pseudo_mini_loss sum 3.68996000289917
Total (block generation + training)time/epoch 1273.3554484844208
Training time/epoch 1648072922.265545
Training time without block to device /epoch 1648072913.1155539
Training time without total dataloading part /epoch 0.29913949966430664
load block tensor time/epoch 6.160746812820435
block to device time/epoch 9.149991035461426
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  73623826
Number of first layer input nodes during this epoch:  35466977
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 2.3536324501037598  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7773110866546631
range selection method range initialization spend 0.02667975425720215
time for parepare:  0.35315465927124023
local_output_nid generation:  0.003822803497314453
local_in_edges_tensor generation:  0.037796735763549805
mini_batch_src_global generation:  0.029378175735473633
r_  generation:  0.3564896583557129
local_output_nid generation:  0.0038607120513916016
local_in_edges_tensor generation:  0.009610414505004883
mini_batch_src_global generation:  0.037244558334350586
r_  generation:  0.40149688720703125
local_output_nid generation:  0.003853321075439453
local_in_edges_tensor generation:  0.005342006683349609
mini_batch_src_global generation:  0.022962093353271484
r_  generation:  0.41592979431152344
local_output_nid generation:  0.0038568973541259766
local_in_edges_tensor generation:  0.009727239608764648
mini_batch_src_global generation:  0.02675342559814453
r_  generation:  0.45113706588745117
local_output_nid generation:  0.0038576126098632812
local_in_edges_tensor generation:  0.005287647247314453
mini_batch_src_global generation:  0.027491092681884766
r_  generation:  0.4677762985229492
local_output_nid generation:  0.003933429718017578
local_in_edges_tensor generation:  0.00544285774230957
mini_batch_src_global generation:  0.031345367431640625
r_  generation:  0.518021821975708
local_output_nid generation:  0.0038704872131347656
local_in_edges_tensor generation:  0.00905156135559082
mini_batch_src_global generation:  0.036683082580566406
r_  generation:  0.5279810428619385
local_output_nid generation:  0.00384521484375
local_in_edges_tensor generation:  0.0054018497467041016
mini_batch_src_global generation:  0.04446005821228027
r_  generation:  0.5159692764282227
local_output_nid generation:  0.003874540328979492
local_in_edges_tensor generation:  0.005418062210083008
mini_batch_src_global generation:  0.034314870834350586
r_  generation:  0.5183722972869873
local_output_nid generation:  0.0040280818939208984
local_in_edges_tensor generation:  0.00895237922668457
mini_batch_src_global generation:  0.035410165786743164
r_  generation:  0.5287737846374512
local_output_nid generation:  0.003926992416381836
local_in_edges_tensor generation:  0.006677389144897461
mini_batch_src_global generation:  0.03726911544799805
r_  generation:  0.5441479682922363
local_output_nid generation:  0.003860950469970703
local_in_edges_tensor generation:  0.00672459602355957
mini_batch_src_global generation:  0.03846621513366699
r_  generation:  0.5153679847717285
local_output_nid generation:  0.003878355026245117
local_in_edges_tensor generation:  0.006563425064086914
mini_batch_src_global generation:  0.04038071632385254
r_  generation:  0.5347926616668701
local_output_nid generation:  0.004076957702636719
local_in_edges_tensor generation:  0.0069332122802734375
mini_batch_src_global generation:  0.040155887603759766
r_  generation:  0.5368833541870117
local_output_nid generation:  0.004025459289550781
local_in_edges_tensor generation:  0.007934808731079102
mini_batch_src_global generation:  0.04104018211364746
r_  generation:  0.5220389366149902
local_output_nid generation:  0.004058361053466797
local_in_edges_tensor generation:  0.00667881965637207
mini_batch_src_global generation:  0.042591094970703125
r_  generation:  0.5256710052490234
----------------------check_connections_block total spend ----------------------------- 10.409568786621094
generate_one_block  0.880878210067749
generate_one_block  0.5349576473236084
generate_one_block  0.5164856910705566
generate_one_block  0.5149013996124268
generate_one_block  0.5184040069580078
generate_one_block  0.5104289054870605
generate_one_block  0.5113098621368408
generate_one_block  0.5157577991485596
generate_one_block  0.5134565830230713
generate_one_block  0.5456497669219971
generate_one_block  0.5358750820159912
generate_one_block  0.5232882499694824
generate_one_block  0.5382261276245117
generate_one_block  0.5160691738128662
generate_one_block  0.5173451900482178
generate_one_block  0.5234181880950928
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.4611527919769287
gen group dst list time:  0.24988460540771484
time for parepare:  0.477219820022583
local_output_nid generation:  0.1183784008026123
local_in_edges_tensor generation:  0.6937179565429688
mini_batch_src_global generation:  0.8861989974975586
r_  generation:  10.421888828277588
local_output_nid generation:  0.16092371940612793
local_in_edges_tensor generation:  0.7576167583465576
mini_batch_src_global generation:  1.1333975791931152
r_  generation:  10.809057712554932
local_output_nid generation:  0.17523956298828125
local_in_edges_tensor generation:  0.7983264923095703
mini_batch_src_global generation:  1.1177847385406494
r_  generation:  10.545690059661865
local_output_nid generation:  0.1733696460723877
local_in_edges_tensor generation:  0.7716424465179443
mini_batch_src_global generation:  1.1647436618804932
r_  generation:  10.745714902877808
local_output_nid generation:  0.18192410469055176
local_in_edges_tensor generation:  0.7631173133850098
mini_batch_src_global generation:  1.137359619140625
r_  generation:  10.822101831436157
local_output_nid generation:  0.1790914535522461
local_in_edges_tensor generation:  0.8275527954101562
mini_batch_src_global generation:  1.3151302337646484
r_  generation:  10.6718168258667
local_output_nid generation:  0.18715286254882812
local_in_edges_tensor generation:  0.6597747802734375
mini_batch_src_global generation:  1.2393944263458252
r_  generation:  11.119664430618286
local_output_nid generation:  0.19533944129943848
local_in_edges_tensor generation:  0.8359470367431641
mini_batch_src_global generation:  1.162499189376831
r_  generation:  10.737266540527344
local_output_nid generation:  0.18400025367736816
local_in_edges_tensor generation:  0.7548751831054688
mini_batch_src_global generation:  1.1811909675598145
r_  generation:  10.99130916595459
local_output_nid generation:  0.19384980201721191
local_in_edges_tensor generation:  0.7612192630767822
mini_batch_src_global generation:  1.1601667404174805
r_  generation:  10.953153371810913
local_output_nid generation:  0.1831052303314209
local_in_edges_tensor generation:  0.8828322887420654
mini_batch_src_global generation:  1.255127191543579
r_  generation:  10.771707773208618
local_output_nid generation:  0.19255828857421875
local_in_edges_tensor generation:  0.6983242034912109
mini_batch_src_global generation:  1.389995813369751
r_  generation:  11.719264507293701
local_output_nid generation:  0.2178201675415039
local_in_edges_tensor generation:  0.8694899082183838
mini_batch_src_global generation:  1.3353300094604492
r_  generation:  11.090003490447998
local_output_nid generation:  0.20729780197143555
local_in_edges_tensor generation:  0.8627266883850098
mini_batch_src_global generation:  1.1623122692108154
r_  generation:  11.197264909744263
local_output_nid generation:  0.18998193740844727
local_in_edges_tensor generation:  0.8611557483673096
mini_batch_src_global generation:  1.21549654006958
r_  generation:  10.762082576751709
local_output_nid generation:  0.20747089385986328
local_in_edges_tensor generation:  0.6745984554290771
mini_batch_src_global generation:  1.2003626823425293
r_  generation:  11.039411544799805
----------------------check_connections_block total spend ----------------------------- 238.47889971733093
generate_one_block  15.447080850601196
generate_one_block  15.875124216079712
generate_one_block  14.760539054870605
generate_one_block  15.539019346237183
generate_one_block  15.255155324935913
generate_one_block  14.703575611114502
generate_one_block  15.545400142669678
generate_one_block  15.372392416000366
generate_one_block  15.18648099899292
generate_one_block  15.090184688568115
generate_one_block  15.542867183685303
generate_one_block  15.243123769760132
generate_one_block  14.783197164535522
generate_one_block  15.466857194900513
generate_one_block  15.421847581863403
generate_one_block  15.292605638504028
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1804494857788086
gen group dst list time:  1.1129369735717773
time for parepare:  0.47104573249816895
local_output_nid generation:  0.5211167335510254
local_in_edges_tensor generation:  1.251997709274292
mini_batch_src_global generation:  1.1679425239562988
r_  generation:  15.494866371154785
local_output_nid generation:  0.6188504695892334
local_in_edges_tensor generation:  1.3114092350006104
mini_batch_src_global generation:  1.5212292671203613
r_  generation:  15.74946641921997
local_output_nid generation:  0.6053824424743652
local_in_edges_tensor generation:  1.296994924545288
mini_batch_src_global generation:  1.5189602375030518
r_  generation:  15.92598009109497
local_output_nid generation:  0.6303656101226807
local_in_edges_tensor generation:  1.278489589691162
mini_batch_src_global generation:  1.6986117362976074
r_  generation:  15.8857421875
local_output_nid generation:  0.6429202556610107
local_in_edges_tensor generation:  1.2641539573669434
mini_batch_src_global generation:  1.6302268505096436
r_  generation:  16.08931064605713
local_output_nid generation:  0.6438288688659668
local_in_edges_tensor generation:  1.2704293727874756
mini_batch_src_global generation:  1.746424674987793
r_  generation:  15.839050769805908
local_output_nid generation:  0.6566805839538574
local_in_edges_tensor generation:  1.2870440483093262
mini_batch_src_global generation:  1.652806043624878
r_  generation:  16.32953643798828
local_output_nid generation:  0.6789917945861816
local_in_edges_tensor generation:  1.2941622734069824
mini_batch_src_global generation:  1.6877105236053467
r_  generation:  15.921284437179565
local_output_nid generation:  0.656186580657959
local_in_edges_tensor generation:  1.2897331714630127
mini_batch_src_global generation:  1.6913645267486572
r_  generation:  16.331279039382935
local_output_nid generation:  0.6862642765045166
local_in_edges_tensor generation:  1.299290657043457
mini_batch_src_global generation:  1.691267728805542
r_  generation:  15.897813320159912
local_output_nid generation:  0.6580860614776611
local_in_edges_tensor generation:  1.310701847076416
mini_batch_src_global generation:  1.660989761352539
r_  generation:  16.334991693496704
local_output_nid generation:  0.6839890480041504
local_in_edges_tensor generation:  1.302553415298462
mini_batch_src_global generation:  1.6832549571990967
r_  generation:  15.923194646835327
local_output_nid generation:  0.6612715721130371
local_in_edges_tensor generation:  1.3034031391143799
mini_batch_src_global generation:  1.6972861289978027
r_  generation:  16.397481441497803
local_output_nid generation:  0.6917986869812012
local_in_edges_tensor generation:  3.0337729454040527
mini_batch_src_global generation:  1.5778727531433105
r_  generation:  16.01730465888977
local_output_nid generation:  0.6617865562438965
local_in_edges_tensor generation:  1.3129463195800781
mini_batch_src_global generation:  1.6741225719451904
r_  generation:  16.151161193847656
local_output_nid generation:  0.6661288738250732
local_in_edges_tensor generation:  1.2895863056182861
mini_batch_src_global generation:  1.778228759765625
r_  generation:  16.038859367370605
----------------------check_connections_block total spend ----------------------------- 362.16293120384216
generate_one_block  21.679211139678955
generate_one_block  21.648330211639404
generate_one_block  21.704084396362305
generate_one_block  21.72465491294861
generate_one_block  21.681143045425415
generate_one_block  21.643099069595337
generate_one_block  21.69136667251587
generate_one_block  22.074317693710327
generate_one_block  21.586902856826782
generate_one_block  21.973852157592773
generate_one_block  21.623024463653564
generate_one_block  21.655234575271606
generate_one_block  21.72310185432434
generate_one_block  21.663912773132324
generate_one_block  21.539551496505737
generate_one_block  21.571852207183838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 2.3536324501037598  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

connection checking time:  600.6418309211731
block generation total time  591.7090907096863
average batch blocks generation time:  36.98181816935539
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.328150749206543  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2489867210388184  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3271093368530273  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.247446060180664  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3300065994262695  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2535438537597656  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3320751190185547  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2619476318359375  GigaBytes
Max Memory Allocated: 4.031567096710205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.328721523284912  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2518696784973145  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.328413963317871  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2496676445007324  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3284683227539062  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.254697799682617  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3282556533813477  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2493162155151367  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.328507423400879  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2491092681884766  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.328768253326416  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2500476837158203  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.329176425933838  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.253082752227783  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3283662796020508  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2472076416015625  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3302383422851562  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2576422691345215  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.328740119934082  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.251445770263672  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3278579711914062  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.248411178588867  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3279647827148438  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2482004165649414  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38452816009521484 |0.457684651017189 |0.0038706809282302856 |0.00014165043830871582 |0.004829823970794678 |0.0029234886169433594 |
----------------------------------------------------------pseudo_mini_loss sum 3.0922060012817383
Total (block generation + training)time/epoch 1270.08063519001
Training time/epoch 1648074189.071607
Training time without block to device /epoch 1648074181.7486527
Training time without total dataloading part /epoch 0.14439797401428223
load block tensor time/epoch 6.1524505615234375
block to device time/epoch 7.322954416275024
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  73612171
Number of first layer input nodes during this epoch:  35466145
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 2.351837158203125  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.6870672702789307
range selection method range initialization spend 0.025757789611816406
time for parepare:  0.37176060676574707
local_output_nid generation:  0.0034999847412109375
local_in_edges_tensor generation:  0.03215813636779785
mini_batch_src_global generation:  0.030108928680419922
r_  generation:  0.37400293350219727
local_output_nid generation:  0.003719329833984375
local_in_edges_tensor generation:  0.00959014892578125
mini_batch_src_global generation:  0.03832650184631348
r_  generation:  0.4161384105682373
local_output_nid generation:  0.003703594207763672
local_in_edges_tensor generation:  0.009890317916870117
mini_batch_src_global generation:  0.026975631713867188
r_  generation:  0.421234130859375
local_output_nid generation:  0.0037229061126708984
local_in_edges_tensor generation:  0.006373167037963867
mini_batch_src_global generation:  0.025760889053344727
r_  generation:  0.45017337799072266
local_output_nid generation:  0.003701925277709961
local_in_edges_tensor generation:  0.007500886917114258
mini_batch_src_global generation:  0.027585744857788086
r_  generation:  0.4718363285064697
local_output_nid generation:  0.0037720203399658203
local_in_edges_tensor generation:  0.00551605224609375
mini_batch_src_global generation:  0.03055405616760254
r_  generation:  0.4947385787963867
local_output_nid generation:  0.003743886947631836
local_in_edges_tensor generation:  0.005281925201416016
mini_batch_src_global generation:  0.03162956237792969
r_  generation:  0.5007846355438232
local_output_nid generation:  0.0037114620208740234
local_in_edges_tensor generation:  0.005294322967529297
mini_batch_src_global generation:  0.034555673599243164
r_  generation:  0.5288348197937012
local_output_nid generation:  0.0037031173706054688
local_in_edges_tensor generation:  0.0054836273193359375
mini_batch_src_global generation:  0.03432941436767578
r_  generation:  0.5156474113464355
local_output_nid generation:  0.0036902427673339844
local_in_edges_tensor generation:  0.006368398666381836
mini_batch_src_global generation:  0.03521871566772461
r_  generation:  0.5244920253753662
local_output_nid generation:  0.003703594207763672
local_in_edges_tensor generation:  0.007599353790283203
mini_batch_src_global generation:  0.03677177429199219
r_  generation:  0.5161268711090088
local_output_nid generation:  0.0037076473236083984
local_in_edges_tensor generation:  0.005480766296386719
mini_batch_src_global generation:  0.038774728775024414
r_  generation:  0.5259695053100586
local_output_nid generation:  0.0037658214569091797
local_in_edges_tensor generation:  0.0052852630615234375
mini_batch_src_global generation:  0.04148554801940918
r_  generation:  0.526543378829956
local_output_nid generation:  0.0037887096405029297
local_in_edges_tensor generation:  0.008641481399536133
mini_batch_src_global generation:  0.039945125579833984
r_  generation:  0.5342309474945068
local_output_nid generation:  0.003907918930053711
local_in_edges_tensor generation:  0.005361795425415039
mini_batch_src_global generation:  0.04166102409362793
r_  generation:  0.5454733371734619
local_output_nid generation:  0.0037899017333984375
local_in_edges_tensor generation:  0.005361318588256836
mini_batch_src_global generation:  0.04159379005432129
r_  generation:  0.5297107696533203
----------------------check_connections_block total spend ----------------------------- 10.35003399848938
generate_one_block  0.892284631729126
generate_one_block  0.547170877456665
generate_one_block  0.5233595371246338
generate_one_block  0.5238080024719238
generate_one_block  0.5202651023864746
generate_one_block  0.5168578624725342
generate_one_block  0.5095016956329346
generate_one_block  0.5181968212127686
generate_one_block  0.5142455101013184
generate_one_block  0.5140893459320068
generate_one_block  0.5268208980560303
generate_one_block  0.514315128326416
generate_one_block  0.5215682983398438
generate_one_block  0.5175235271453857
generate_one_block  0.5090372562408447
generate_one_block  0.5120904445648193
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.5198707580566406
gen group dst list time:  0.26721692085266113
time for parepare:  0.4673492908477783
local_output_nid generation:  0.11224365234375
local_in_edges_tensor generation:  0.7088813781738281
mini_batch_src_global generation:  0.932283878326416
r_  generation:  10.5211341381073
local_output_nid generation:  0.1659231185913086
local_in_edges_tensor generation:  0.7602453231811523
mini_batch_src_global generation:  1.1691992282867432
r_  generation:  10.985230445861816
local_output_nid generation:  0.16953206062316895
local_in_edges_tensor generation:  0.8949031829833984
mini_batch_src_global generation:  1.1316161155700684
r_  generation:  10.751601696014404
local_output_nid generation:  0.17285656929016113
local_in_edges_tensor generation:  0.848557710647583
mini_batch_src_global generation:  1.316333293914795
r_  generation:  10.678828477859497
local_output_nid generation:  0.18349909782409668
local_in_edges_tensor generation:  0.6738083362579346
mini_batch_src_global generation:  1.1918416023254395
r_  generation:  11.049858570098877
local_output_nid generation:  0.1856822967529297
local_in_edges_tensor generation:  0.8513906002044678
mini_batch_src_global generation:  1.157334804534912
r_  generation:  10.730832815170288
local_output_nid generation:  0.17764806747436523
local_in_edges_tensor generation:  0.8324697017669678
mini_batch_src_global generation:  1.32023286819458
r_  generation:  10.915382146835327
local_output_nid generation:  0.20090246200561523
local_in_edges_tensor generation:  0.6644823551177979
mini_batch_src_global generation:  1.1744601726531982
r_  generation:  11.1572425365448
local_output_nid generation:  0.18982887268066406
local_in_edges_tensor generation:  0.8557214736938477
mini_batch_src_global generation:  1.1752040386199951
r_  generation:  10.686792850494385
local_output_nid generation:  0.1911611557006836
local_in_edges_tensor generation:  0.7214484214782715
mini_batch_src_global generation:  1.2170860767364502
r_  generation:  11.116596221923828
local_output_nid generation:  0.20524191856384277
local_in_edges_tensor generation:  0.8421359062194824
mini_batch_src_global generation:  1.182845115661621
r_  generation:  10.953049659729004
local_output_nid generation:  0.17445111274719238
local_in_edges_tensor generation:  0.8847928047180176
mini_batch_src_global generation:  1.3145434856414795
r_  generation:  10.760805606842041
local_output_nid generation:  0.19611549377441406
local_in_edges_tensor generation:  0.6847090721130371
mini_batch_src_global generation:  1.3097403049468994
r_  generation:  11.109452724456787
local_output_nid generation:  0.19855952262878418
local_in_edges_tensor generation:  0.8688783645629883
mini_batch_src_global generation:  1.1666216850280762
r_  generation:  10.864355087280273
local_output_nid generation:  0.18540477752685547
local_in_edges_tensor generation:  0.8770906925201416
mini_batch_src_global generation:  1.351982593536377
r_  generation:  10.704831600189209
local_output_nid generation:  0.1955432891845703
local_in_edges_tensor generation:  0.6910068988800049
mini_batch_src_global generation:  1.2174139022827148
r_  generation:  11.10123610496521
----------------------check_connections_block total spend ----------------------------- 238.7720410823822
generate_one_block  15.391728639602661
generate_one_block  15.850319385528564
generate_one_block  14.712878465652466
generate_one_block  15.468286275863647
generate_one_block  15.379380464553833
generate_one_block  15.113656997680664
generate_one_block  14.898565769195557
generate_one_block  15.562389850616455
generate_one_block  15.295616149902344
generate_one_block  15.32756757736206
generate_one_block  15.042019367218018
generate_one_block  15.509104251861572
generate_one_block  15.443460941314697
generate_one_block  15.157896041870117
generate_one_block  14.867448329925537
generate_one_block  15.546421766281128
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2389020919799805
gen group dst list time:  1.1078789234161377
time for parepare:  0.4814887046813965
local_output_nid generation:  0.5403456687927246
local_in_edges_tensor generation:  1.2293245792388916
mini_batch_src_global generation:  1.2063536643981934
r_  generation:  15.672767400741577
local_output_nid generation:  0.6421971321105957
local_in_edges_tensor generation:  1.3996682167053223
mini_batch_src_global generation:  1.7483782768249512
r_  generation:  16.21672296524048
local_output_nid generation:  0.6435792446136475
local_in_edges_tensor generation:  1.2634263038635254
mini_batch_src_global generation:  1.864729404449463
r_  generation:  16.332831144332886
local_output_nid generation:  0.6533854007720947
local_in_edges_tensor generation:  1.2569496631622314
mini_batch_src_global generation:  1.579380989074707
r_  generation:  16.113403797149658
local_output_nid generation:  0.6593492031097412
local_in_edges_tensor generation:  1.2717509269714355
mini_batch_src_global generation:  1.556920051574707
r_  generation:  16.49279475212097
local_output_nid generation:  0.6614899635314941
local_in_edges_tensor generation:  1.2849884033203125
mini_batch_src_global generation:  1.570693016052246
r_  generation:  16.331905364990234
local_output_nid generation:  0.6779706478118896
local_in_edges_tensor generation:  1.291104793548584
mini_batch_src_global generation:  1.5637195110321045
r_  generation:  16.610304355621338
local_output_nid generation:  0.682349681854248
local_in_edges_tensor generation:  1.296267032623291
mini_batch_src_global generation:  1.561077356338501
r_  generation:  16.280760288238525
local_output_nid generation:  0.685734748840332
local_in_edges_tensor generation:  1.2909691333770752
mini_batch_src_global generation:  1.6440582275390625
r_  generation:  16.398987531661987
local_output_nid generation:  0.678776741027832
local_in_edges_tensor generation:  1.331496238708496
mini_batch_src_global generation:  1.6376428604125977
r_  generation:  16.297446250915527
local_output_nid generation:  0.6952066421508789
local_in_edges_tensor generation:  1.3741960525512695
mini_batch_src_global generation:  1.7215116024017334
r_  generation:  16.51508092880249
local_output_nid generation:  0.6759335994720459
local_in_edges_tensor generation:  1.2964441776275635
mini_batch_src_global generation:  1.8109369277954102
r_  generation:  16.191985368728638
local_output_nid generation:  0.6562099456787109
local_in_edges_tensor generation:  1.3328475952148438
mini_batch_src_global generation:  1.670933485031128
r_  generation:  16.642132997512817
local_output_nid generation:  0.6699237823486328
local_in_edges_tensor generation:  2.9135053157806396
mini_batch_src_global generation:  1.535280704498291
r_  generation:  16.393897533416748
local_output_nid generation:  0.6671497821807861
local_in_edges_tensor generation:  1.285400152206421
mini_batch_src_global generation:  1.5629236698150635
r_  generation:  16.43430471420288
local_output_nid generation:  0.6795229911804199
local_in_edges_tensor generation:  1.2997345924377441
mini_batch_src_global generation:  1.564979076385498
r_  generation:  16.303170919418335
----------------------check_connections_block total spend ----------------------------- 367.50920271873474
generate_one_block  21.5976402759552
generate_one_block  21.682271242141724
generate_one_block  21.496472120285034
generate_one_block  21.80906391143799
generate_one_block  21.680822372436523
generate_one_block  21.669002056121826
generate_one_block  21.61190104484558
generate_one_block  22.02846097946167
generate_one_block  21.58035373687744
generate_one_block  21.67911434173584
generate_one_block  21.611515283584595
generate_one_block  21.554443836212158
generate_one_block  21.730223655700684
generate_one_block  21.748481035232544
generate_one_block  21.519266843795776
generate_one_block  21.561007022857666
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 2.351837158203125  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

connection checking time:  606.281243801117
block generation total time  591.1267800331116
average batch blocks generation time:  36.94542375206947
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3261408805847168  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2421445846557617  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3314476013183594  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.258070945739746  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.328782558441162  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2485246658325195  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.327885627746582  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2475476264953613  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3288049697875977  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.252509117126465  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3277387619018555  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.245001792907715  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3282575607299805  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2500529289245605  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3291807174682617  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2528157234191895  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3275136947631836  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2475600242614746  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.329641342163086  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.256530284881592  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3291306495666504  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.254973888397217  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3286333084106445  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2523751258850098  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3290081024169922  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2518715858459473  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3293590545654297  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2571768760681152  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3255205154418945  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2411069869995117  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3287253379821777  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2522940635681152  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3881789892911911 |0.4557354152202606 |0.0038623064756393433 |0.00014288723468780518 |0.004839092493057251 |0.002908468246459961 |
----------------------------------------------------------pseudo_mini_loss sum 2.6721723079681396
Total (block generation + training)time/epoch 1270.3837727705638
Training time/epoch 1648075460.0620162
Training time without block to device /epoch 1648075452.7702496
Training time without total dataloading part /epoch 0.14441704750061035
load block tensor time/epoch 6.210863828659058
block to device time/epoch 7.29176664352417
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  73597933
Number of first layer input nodes during this epoch:  35458013
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 2.3554792404174805  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7152297496795654
range selection method range initialization spend 0.025910139083862305
time for parepare:  0.3544328212738037
local_output_nid generation:  0.0036246776580810547
local_in_edges_tensor generation:  0.028750896453857422
mini_batch_src_global generation:  0.029480695724487305
r_  generation:  0.3609738349914551
local_output_nid generation:  0.003862619400024414
local_in_edges_tensor generation:  0.009454011917114258
mini_batch_src_global generation:  0.03841066360473633
r_  generation:  0.4022331237792969
local_output_nid generation:  0.003809690475463867
local_in_edges_tensor generation:  0.007815837860107422
mini_batch_src_global generation:  0.022916316986083984
r_  generation:  0.41750335693359375
local_output_nid generation:  0.003887176513671875
local_in_edges_tensor generation:  0.009764432907104492
mini_batch_src_global generation:  0.026985883712768555
r_  generation:  0.4507119655609131
local_output_nid generation:  0.0039272308349609375
local_in_edges_tensor generation:  0.007378578186035156
mini_batch_src_global generation:  0.027686119079589844
r_  generation:  0.46799302101135254
local_output_nid generation:  0.003858804702758789
local_in_edges_tensor generation:  0.005307674407958984
mini_batch_src_global generation:  0.030416250228881836
r_  generation:  0.4938991069793701
local_output_nid generation:  0.003916025161743164
local_in_edges_tensor generation:  0.005471944808959961
mini_batch_src_global generation:  0.03154873847961426
r_  generation:  0.4989628791809082
local_output_nid generation:  0.003933429718017578
local_in_edges_tensor generation:  0.005358457565307617
mini_batch_src_global generation:  0.032625675201416016
r_  generation:  0.5061931610107422
local_output_nid generation:  0.003899812698364258
local_in_edges_tensor generation:  0.008601665496826172
mini_batch_src_global generation:  0.03428959846496582
r_  generation:  0.5129539966583252
local_output_nid generation:  0.003886699676513672
local_in_edges_tensor generation:  0.007425546646118164
mini_batch_src_global generation:  0.035561561584472656
r_  generation:  0.5145177841186523
local_output_nid generation:  0.003790140151977539
local_in_edges_tensor generation:  0.008787155151367188
mini_batch_src_global generation:  0.0384523868560791
r_  generation:  0.5165674686431885
local_output_nid generation:  0.003834247589111328
local_in_edges_tensor generation:  0.0076558589935302734
mini_batch_src_global generation:  0.03824138641357422
r_  generation:  0.5193436145782471
local_output_nid generation:  0.0037925243377685547
local_in_edges_tensor generation:  0.0063114166259765625
mini_batch_src_global generation:  0.03975820541381836
r_  generation:  0.5230801105499268
local_output_nid generation:  0.004042387008666992
local_in_edges_tensor generation:  0.0071926116943359375
mini_batch_src_global generation:  0.04195046424865723
r_  generation:  0.529655933380127
local_output_nid generation:  0.00397181510925293
local_in_edges_tensor generation:  0.007572174072265625
mini_batch_src_global generation:  0.041979312896728516
r_  generation:  0.528916597366333
local_output_nid generation:  0.0038928985595703125
local_in_edges_tensor generation:  0.010973453521728516
mini_batch_src_global generation:  0.04407763481140137
r_  generation:  0.5239615440368652
----------------------check_connections_block total spend ----------------------------- 10.242477655410767
generate_one_block  0.9131355285644531
generate_one_block  0.542431116104126
generate_one_block  0.5227301120758057
generate_one_block  0.518702507019043
generate_one_block  0.5203993320465088
generate_one_block  0.5127065181732178
generate_one_block  0.5076837539672852
generate_one_block  0.5354223251342773
generate_one_block  0.666651725769043
generate_one_block  0.6844041347503662
generate_one_block  0.5701801776885986
generate_one_block  0.51505446434021
generate_one_block  0.5303921699523926
generate_one_block  0.5294778347015381
generate_one_block  0.5221216678619385
generate_one_block  0.5074942111968994
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.6078450679779053
gen group dst list time:  0.24886274337768555
time for parepare:  0.47583532333374023
local_output_nid generation:  0.11516880989074707
local_in_edges_tensor generation:  0.716796875
mini_batch_src_global generation:  0.955394983291626
r_  generation:  10.442865133285522
local_output_nid generation:  0.1643221378326416
local_in_edges_tensor generation:  0.7675521373748779
mini_batch_src_global generation:  1.158829689025879
r_  generation:  10.927590131759644
local_output_nid generation:  0.16734623908996582
local_in_edges_tensor generation:  0.9306182861328125
mini_batch_src_global generation:  1.1166086196899414
r_  generation:  10.664467573165894
local_output_nid generation:  0.16912841796875
local_in_edges_tensor generation:  0.8459644317626953
mini_batch_src_global generation:  1.3107869625091553
r_  generation:  10.69347095489502
local_output_nid generation:  0.1826474666595459
local_in_edges_tensor generation:  0.6829850673675537
mini_batch_src_global generation:  1.1625816822052002
r_  generation:  11.0538911819458
local_output_nid generation:  0.18691372871398926
local_in_edges_tensor generation:  0.826103925704956
mini_batch_src_global generation:  1.1657404899597168
r_  generation:  10.790152072906494
local_output_nid generation:  0.1793527603149414
local_in_edges_tensor generation:  0.7772705554962158
mini_batch_src_global generation:  1.2816970348358154
r_  generation:  10.921326160430908
local_output_nid generation:  0.2020726203918457
local_in_edges_tensor generation:  0.7310225963592529
mini_batch_src_global generation:  1.1583032608032227
r_  generation:  11.143441200256348
local_output_nid generation:  0.192474365234375
local_in_edges_tensor generation:  0.8765072822570801
mini_batch_src_global generation:  1.1901297569274902
r_  generation:  10.75986623764038
local_output_nid generation:  0.196000337600708
local_in_edges_tensor generation:  0.6916289329528809
mini_batch_src_global generation:  1.2143161296844482
r_  generation:  11.106233835220337
local_output_nid generation:  0.19484519958496094
local_in_edges_tensor generation:  0.8664703369140625
mini_batch_src_global generation:  1.1719896793365479
r_  generation:  11.12460994720459
local_output_nid generation:  0.18605542182922363
local_in_edges_tensor generation:  0.8793656826019287
mini_batch_src_global generation:  1.2651238441467285
r_  generation:  10.79693055152893
local_output_nid generation:  0.19994640350341797
local_in_edges_tensor generation:  0.708165168762207
mini_batch_src_global generation:  1.2284667491912842
r_  generation:  11.161751747131348
local_output_nid generation:  0.19749712944030762
local_in_edges_tensor generation:  0.8674595355987549
mini_batch_src_global generation:  1.159355878829956
r_  generation:  10.9674551486969
local_output_nid generation:  0.18837881088256836
local_in_edges_tensor generation:  0.890819787979126
mini_batch_src_global generation:  1.3198416233062744
r_  generation:  10.723224639892578
local_output_nid generation:  0.1985328197479248
local_in_edges_tensor generation:  0.6988012790679932
mini_batch_src_global generation:  1.2401375770568848
r_  generation:  11.110656023025513
----------------------check_connections_block total spend ----------------------------- 239.08031511306763
generate_one_block  15.464395523071289
generate_one_block  15.917667627334595
generate_one_block  14.645053386688232
generate_one_block  15.526057481765747
generate_one_block  15.373719692230225
generate_one_block  14.909371852874756
generate_one_block  15.177825927734375
generate_one_block  15.558517217636108
generate_one_block  15.35456895828247
generate_one_block  15.00810170173645
generate_one_block  15.485554218292236
generate_one_block  15.449123620986938
generate_one_block  15.379490613937378
generate_one_block  14.720972537994385
generate_one_block  15.358552932739258
generate_one_block  15.479127883911133
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2338616847991943
gen group dst list time:  1.076328992843628
time for parepare:  0.4684326648712158
local_output_nid generation:  0.5337123870849609
local_in_edges_tensor generation:  1.182769536972046
mini_batch_src_global generation:  1.1972715854644775
r_  generation:  15.674944877624512
local_output_nid generation:  0.6225583553314209
local_in_edges_tensor generation:  1.3313462734222412
mini_batch_src_global generation:  1.8130221366882324
r_  generation:  15.810056209564209
local_output_nid generation:  0.6307022571563721
local_in_edges_tensor generation:  1.2795445919036865
mini_batch_src_global generation:  1.6156773567199707
r_  generation:  16.030677318572998
local_output_nid generation:  0.6366183757781982
local_in_edges_tensor generation:  1.2906792163848877
mini_batch_src_global generation:  1.754530429840088
r_  generation:  16.031158685684204
local_output_nid generation:  0.6635541915893555
local_in_edges_tensor generation:  1.3116888999938965
mini_batch_src_global generation:  1.6001322269439697
r_  generation:  16.218889951705933
local_output_nid generation:  0.6677937507629395
local_in_edges_tensor generation:  1.3158457279205322
mini_batch_src_global generation:  1.674443006515503
r_  generation:  16.27493691444397
local_output_nid generation:  0.6672496795654297
local_in_edges_tensor generation:  1.3313751220703125
mini_batch_src_global generation:  1.5885000228881836
r_  generation:  16.389751195907593
local_output_nid generation:  0.6972284317016602
local_in_edges_tensor generation:  1.3126542568206787
mini_batch_src_global generation:  1.6032333374023438
r_  generation:  16.35568332672119
local_output_nid generation:  0.690662145614624
local_in_edges_tensor generation:  1.302931547164917
mini_batch_src_global generation:  1.5655567646026611
r_  generation:  16.484747409820557
local_output_nid generation:  0.6797189712524414
local_in_edges_tensor generation:  1.3151042461395264
mini_batch_src_global generation:  1.6748170852661133
r_  generation:  16.683642148971558
local_output_nid generation:  0.6800320148468018
local_in_edges_tensor generation:  1.3079001903533936
mini_batch_src_global generation:  1.803180456161499
r_  generation:  16.392889738082886
local_output_nid generation:  0.6576614379882812
local_in_edges_tensor generation:  1.2927260398864746
mini_batch_src_global generation:  1.8158149719238281
r_  generation:  16.291588068008423
local_output_nid generation:  0.6611697673797607
local_in_edges_tensor generation:  1.337162733078003
mini_batch_src_global generation:  1.6563136577606201
r_  generation:  16.643085479736328
local_output_nid generation:  0.6990971565246582
local_in_edges_tensor generation:  2.9592785835266113
mini_batch_src_global generation:  1.5214478969573975
r_  generation:  16.43578290939331
local_output_nid generation:  0.6743876934051514
local_in_edges_tensor generation:  1.2864468097686768
mini_batch_src_global generation:  1.5442368984222412
r_  generation:  16.53481411933899
local_output_nid generation:  0.6806933879852295
local_in_edges_tensor generation:  1.2947332859039307
mini_batch_src_global generation:  1.544828176498413
r_  generation:  16.474720001220703
----------------------check_connections_block total spend ----------------------------- 366.7028076648712
generate_one_block  21.740163803100586
generate_one_block  21.59158682823181
generate_one_block  21.5623140335083
generate_one_block  21.50654363632202
generate_one_block  21.65018391609192
generate_one_block  21.628642797470093
generate_one_block  21.871024131774902
generate_one_block  22.140963554382324
generate_one_block  21.56814432144165
generate_one_block  21.60041618347168
generate_one_block  21.700034379959106
generate_one_block  21.66540813446045
generate_one_block  21.698045015335083
generate_one_block  21.7217218875885
generate_one_block  21.610132455825806
generate_one_block  21.729745864868164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 2.3554792404174805  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

connection checking time:  605.7831227779388
block generation total time  591.793172121048
average batch blocks generation time:  36.9870732575655
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3273725509643555  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2462258338928223  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3288350105285645  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.256013870239258  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3273115158081055  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2454566955566406  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.328442096710205  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2482423782348633  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3304729461669922  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2526493072509766  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3293499946594238  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2548413276672363  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3287839889526367  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2476911544799805  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.332578182220459  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.260409355163574  GigaBytes
Max Memory Allocated: 4.033764839172363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3284339904785156  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.251232147216797  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3296995162963867  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.257559299468994  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3276457786560059  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2499146461486816  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3281364440917969  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2497787475585938  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3305597305297852  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.256585121154785  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3274359703063965  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2475600242614746  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3280143737792969  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.2454915046691895  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 1.3282928466796875  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0672607421875 GB
    Memory Allocated: 3.251347541809082  GigaBytes
Max Memory Allocated: 4.03386116027832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3801807761192322 |0.5254757702350616 |0.003916144371032715 |0.00015100836753845215 |0.0048512667417526245 |0.001363992691040039 |
----------------------------------------------------------pseudo_mini_loss sum 2.3866124153137207
Total (block generation + training)time/epoch 1271.1163545250893
Training time/epoch 1648076733.376484
Training time without block to device /epoch 1648076724.9688716
Training time without total dataloading part /epoch 0.1440587043762207
load block tensor time/epoch 6.082892417907715
block to device time/epoch 8.407612323760986
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  73608767
Number of first layer input nodes during this epoch:  35464795Using backend: pytorch

