Using backend: pytorch
main start at this time 1646805758.8257778
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0684127807617188
range selection method range initialization spend 0.028608322143554688
time for parepare:  0.41228151321411133
local_output_nid generation:  0.02628016471862793
local_in_edges_tensor generation:  0.2270209789276123
mini_batch_src_global generation:  0.36769580841064453
r_  generation:  5.77983832359314
local_output_nid generation:  0.02931356430053711
local_in_edges_tensor generation:  0.22690081596374512
mini_batch_src_global generation:  0.47289490699768066
r_  generation:  5.8705151081085205
----------------------check_connections_block total spend ----------------------------- 15.083405017852783
generate_one_block  12.65422248840332
generate_one_block  7.082986831665039
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9926412105560303
gen group dst list time:  0.0942983627319336
time for parepare:  0.46437644958496094
local_output_nid generation:  0.22753477096557617
local_in_edges_tensor generation:  1.5169689655303955
mini_batch_src_global generation:  2.405761957168579
r_  generation:  28.64176106452942
local_output_nid generation:  0.5049591064453125
local_in_edges_tensor generation:  1.9416358470916748
mini_batch_src_global generation:  3.191725969314575
r_  generation:  30.1263370513916
----------------------check_connections_block total spend ----------------------------- 80.38781809806824
generate_one_block  41.0855131149292
generate_one_block  41.71611189842224
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3242549896240234
gen group dst list time:  0.17569398880004883
time for parepare:  0.5042741298675537
local_output_nid generation:  0.4061856269836426
local_in_edges_tensor generation:  1.495443344116211
mini_batch_src_global generation:  2.01299786567688
r_  generation:  26.21650004386902
local_output_nid generation:  0.7388937473297119
local_in_edges_tensor generation:  2.049948215484619
mini_batch_src_global generation:  2.9126474857330322
r_  generation:  25.947696447372437
----------------------check_connections_block total spend ----------------------------- 71.98805928230286
generate_one_block  35.49895405769348
generate_one_block  34.976993560791016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  152.3758773803711
block generation total time  153.27757263183594
average batch blocks generation time:  76.63878631591797
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.30855393409729004 |1.6677312850952148 |0.44640111923217773 |0.0002586841583251953 |0.14339137077331543 |0.004980325698852539 |
----------------------------------------------------------pseudo_mini_loss sum 8.660871505737305
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.37it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.07it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.32it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.97it/s] 40%|████      | 10/25 [00:00<00:00, 17.38it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.47it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.62it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.72it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.84it/s] 80%|████████  | 20/25 [00:01<00:00, 17.93it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.98it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.02it/s]100%|██████████| 25/25 [00:01<00:00, 17.76it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:03,  6.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.57it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.50it/s] 20%|██        | 5/25 [00:00<00:03,  6.47it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.47it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.39it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.51it/s] 60%|██████    | 15/25 [00:02<00:01,  6.56it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.59it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.55it/s] 80%|████████  | 20/25 [00:03<00:00,  6.58it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.60it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.61it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.62it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.64it/s]100%|██████████| 25/25 [00:03<00:00,  6.63it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.53it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.50it/s] 20%|██        | 5/25 [00:00<00:03,  6.51it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.49it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.54it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.59it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.59it/s] 60%|██████    | 15/25 [00:02<00:01,  6.59it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.56it/s] 80%|████████  | 20/25 [00:03<00:00,  6.53it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.58it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.59it/s]100%|██████████| 25/25 [00:03<00:00,  6.63it/s]
Run 00 | Epoch 00000 | Loss 8.6609 | Train 0.0324 | Val 0.0308 | Test 0.0268
Number of nodes during this epoch:  4637782
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.427595138549805  GigaBytes
Max Memory Allocated: 12.212016105651855  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1559314727783203
range selection method range initialization spend 0.029107093811035156
time for parepare:  0.401975154876709
local_output_nid generation:  0.02559041976928711
local_in_edges_tensor generation:  0.2322673797607422
mini_batch_src_global generation:  0.3655092716217041
r_  generation:  5.65029764175415
local_output_nid generation:  0.02902984619140625
local_in_edges_tensor generation:  0.24428629875183105
mini_batch_src_global generation:  0.49840497970581055
r_  generation:  5.787398099899292
----------------------check_connections_block total spend ----------------------------- 14.926144123077393
generate_one_block  7.422306060791016
generate_one_block  7.213420629501343
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.064073085784912
gen group dst list time:  0.09274053573608398
time for parepare:  0.509061336517334
local_output_nid generation:  0.249129056930542
local_in_edges_tensor generation:  1.5745079517364502
mini_batch_src_global generation:  2.4446380138397217
r_  generation:  29.458937644958496
local_output_nid generation:  0.517545223236084
local_in_edges_tensor generation:  2.1551332473754883
mini_batch_src_global generation:  3.579521417617798
r_  generation:  29.754135847091675
----------------------check_connections_block total spend ----------------------------- 82.01578140258789
generate_one_block  41.17837309837341
generate_one_block  41.025607109069824
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.155909538269043
gen group dst list time:  0.17378616333007812
time for parepare:  0.4631829261779785
local_output_nid generation:  0.3718292713165283
local_in_edges_tensor generation:  1.4209389686584473
mini_batch_src_global generation:  2.0037848949432373
r_  generation:  25.280813932418823
local_output_nid generation:  0.7176814079284668
local_in_edges_tensor generation:  2.0629403591156006
mini_batch_src_global generation:  2.838630199432373
r_  generation:  26.481001377105713
----------------------check_connections_block total spend ----------------------------- 71.87876629829407
generate_one_block  35.47209572792053
generate_one_block  36.08747053146362
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.427595138549805  GigaBytes
Max Memory Allocated: 12.212016105651855  GigaBytes

connection checking time:  153.89454770088196
block generation total time  153.7635464668274
average batch blocks generation time:  76.8817732334137
block dataloader generation time/epoch 367.36888551712036
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41710686683654785 |1.3275649547576904 |0.041747093200683594 |0.00016176700592041016 |0.06398284435272217 |0.0032358169555664062 |
----------------------------------------------------------pseudo_mini_loss sum 5.040185928344727
Total (block generation + training)time/epoch 371.27657437324524
Training time/epoch 3.907524824142456
Training time without block to device /epoch 1.2523949146270752
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.92it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.46it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.15it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.58it/s] 40%|████      | 10/25 [00:00<00:00, 17.79it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.88it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.00it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.05it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.97it/s] 80%|████████  | 20/25 [00:01<00:00, 18.04it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.09it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.11it/s]100%|██████████| 25/25 [00:01<00:00, 18.09it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.40it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.45it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.44it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.47it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.47it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.45it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.45it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.29it/s]  8%|▊         | 2/25 [00:00<00:03,  6.27it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.33it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.32it/s] 20%|██        | 5/25 [00:00<00:03,  6.34it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.36it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.33it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.33it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.31it/s] 40%|████      | 10/25 [00:01<00:02,  6.32it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.33it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.36it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.35it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.30it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.32it/s]100%|██████████| 25/25 [00:03<00:00,  7.07it/s]100%|██████████| 25/25 [00:03<00:00,  6.43it/s]
Run 00 | Epoch 00001 | Loss 5.0402 | Train 0.0889 | Val 0.0840 | Test 0.0644
Number of nodes during this epoch:  4638180
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.42824125289917  GigaBytes
Max Memory Allocated: 12.213557720184326  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0193703174591064
range selection method range initialization spend 0.028775453567504883
time for parepare:  0.39145565032958984
local_output_nid generation:  0.02570176124572754
local_in_edges_tensor generation:  0.2291111946105957
mini_batch_src_global generation:  0.3600294589996338
r_  generation:  5.383153915405273
local_output_nid generation:  0.02644205093383789
local_in_edges_tensor generation:  0.19120168685913086
mini_batch_src_global generation:  0.46821165084838867
r_  generation:  5.571005582809448
----------------------check_connections_block total spend ----------------------------- 14.259991884231567
generate_one_block  6.9860100746154785
generate_one_block  6.971754312515259
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0583717823028564
gen group dst list time:  0.08634209632873535
time for parepare:  0.4409034252166748
local_output_nid generation:  0.233320951461792
local_in_edges_tensor generation:  1.5842549800872803
mini_batch_src_global generation:  2.5275087356567383
r_  generation:  29.967126607894897
local_output_nid generation:  0.5304977893829346
local_in_edges_tensor generation:  2.1729588508605957
mini_batch_src_global generation:  3.6819710731506348
r_  generation:  30.07140588760376
----------------------check_connections_block total spend ----------------------------- 83.10601568222046
generate_one_block  41.2547607421875
generate_one_block  40.996646881103516
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.190019130706787
gen group dst list time:  0.17810368537902832
time for parepare:  0.4703233242034912
local_output_nid generation:  0.38666200637817383
local_in_edges_tensor generation:  1.4696383476257324
mini_batch_src_global generation:  2.198050022125244
r_  generation:  26.59070873260498
local_output_nid generation:  0.7344324588775635
local_in_edges_tensor generation:  2.1732730865478516
mini_batch_src_global generation:  2.77398681640625
r_  generation:  26.208528995513916
----------------------check_connections_block total spend ----------------------------- 73.21160888671875
generate_one_block  35.48389554023743
generate_one_block  36.09810161590576
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.42824125289917  GigaBytes
Max Memory Allocated: 12.213557720184326  GigaBytes

connection checking time:  156.3176245689392
block generation total time  153.8334047794342
average batch blocks generation time:  76.9167023897171
block dataloader generation time/epoch 367.5010372400284
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40995001792907715 |1.4115384817123413 |0.004410862922668457 |0.00014901161193847656 |0.005106091499328613 |0.0017261505126953125 |
----------------------------------------------------------pseudo_mini_loss sum 3.664518356323242
Total (block generation + training)time/epoch 371.48665940761566
Training time/epoch 4.063401460647583
Training time without block to device /epoch 1.2403244972229004
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.13it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.10it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.75it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.24it/s] 40%|████      | 10/25 [00:00<00:00, 17.42it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.66it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.82it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.79it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.40it/s] 80%|████████  | 20/25 [00:01<00:00, 17.52it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.63it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.73it/s]100%|██████████| 25/25 [00:01<00:00, 17.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.14it/s]  8%|▊         | 2/25 [00:00<00:04,  5.10it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.66it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.71it/s] 20%|██        | 5/25 [00:00<00:03,  5.20it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.59it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.82it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.95it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.11it/s] 40%|████      | 10/25 [00:01<00:02,  6.23it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.34it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.04it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.20it/s] 60%|██████    | 15/25 [00:02<00:01,  6.27it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.32it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.49it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.49it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.51it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.46it/s]100%|██████████| 25/25 [00:04<00:00,  6.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.08it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.24it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.30it/s] 20%|██        | 5/25 [00:00<00:03,  6.20it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.30it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.30it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.37it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.40it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.44it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.49it/s]
Run 00 | Epoch 00002 | Loss 3.6645 | Train 0.1995 | Val 0.1884 | Test 0.1391
Number of nodes during this epoch:  4638094
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.4248576164245605  GigaBytes
Max Memory Allocated: 12.213557720184326  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.167468547821045
range selection method range initialization spend 0.03641939163208008
time for parepare:  0.36600160598754883
local_output_nid generation:  0.02630615234375
local_in_edges_tensor generation:  0.17711377143859863
mini_batch_src_global generation:  0.3623640537261963
r_  generation:  5.632619142532349
local_output_nid generation:  0.03076791763305664
local_in_edges_tensor generation:  0.23700237274169922
mini_batch_src_global generation:  0.4720499515533447
r_  generation:  5.862997055053711
----------------------check_connections_block total spend ----------------------------- 14.783560514450073
generate_one_block  7.207028865814209
generate_one_block  6.912443161010742
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.168632507324219
gen group dst list time:  0.09748530387878418
time for parepare:  0.4485025405883789
local_output_nid generation:  0.25437092781066895
local_in_edges_tensor generation:  1.6486871242523193
mini_batch_src_global generation:  2.4302778244018555
r_  generation:  29.640413284301758
local_output_nid generation:  0.5126941204071045
local_in_edges_tensor generation:  2.1739304065704346
mini_batch_src_global generation:  3.615191698074341
r_  generation:  29.856568813323975
----------------------check_connections_block total spend ----------------------------- 82.5516881942749
generate_one_block  41.214088439941406
generate_one_block  41.13391733169556
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.0444722175598145
gen group dst list time:  0.18960881233215332
time for parepare:  0.44789552688598633
local_output_nid generation:  0.36519670486450195
local_in_edges_tensor generation:  1.4419584274291992
mini_batch_src_global generation:  2.125581979751587
r_  generation:  27.600646495819092
local_output_nid generation:  0.7322952747344971
local_in_edges_tensor generation:  2.054198741912842
mini_batch_src_global generation:  2.7858808040618896
r_  generation:  26.344449043273926
----------------------check_connections_block total spend ----------------------------- 74.35000991821289
generate_one_block  35.08864736557007
generate_one_block  35.75523042678833
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.4248576164245605  GigaBytes
Max Memory Allocated: 12.213557720184326  GigaBytes

connection checking time:  156.9016981124878
block generation total time  153.19188356399536
average batch blocks generation time:  76.59594178199768
block dataloader generation time/epoch 367.91059764226276
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37962257862091064 |1.3007475137710571 |0.005092978477478027 |0.0001709461212158203 |0.0052471160888671875 |0.0028748512268066406 |
----------------------------------------------------------pseudo_mini_loss sum 3.07894229888916
Total (block generation + training)time/epoch 371.83711886405945
Training time/epoch 3.808159589767456
Training time without block to device /epoch 1.2066645622253418
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.61it/s] 16%|█▌        | 4/25 [00:00<00:01, 13.84it/s] 24%|██▍       | 6/25 [00:00<00:01, 13.71it/s] 32%|███▏      | 8/25 [00:00<00:01, 14.45it/s] 40%|████      | 10/25 [00:00<00:00, 15.04it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.69it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.29it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.76it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.99it/s] 80%|████████  | 20/25 [00:01<00:00, 17.30it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.47it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.36it/s]100%|██████████| 25/25 [00:01<00:00, 16.47it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.08it/s]  8%|▊         | 2/25 [00:00<00:04,  5.07it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.11it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.06it/s] 20%|██        | 5/25 [00:00<00:04,  4.95it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.38it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.64it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.34it/s] 40%|████      | 10/25 [00:01<00:02,  5.28it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.24it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.21it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.18it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.15it/s] 60%|██████    | 15/25 [00:02<00:01,  5.08it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.33it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.10it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.44it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.78it/s] 80%|████████  | 20/25 [00:03<00:00,  6.04it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.21it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.11it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.30it/s]100%|██████████| 25/25 [00:04<00:00,  5.64it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.50it/s]  8%|▊         | 2/25 [00:00<00:04,  5.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.98it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.24it/s] 20%|██        | 5/25 [00:00<00:03,  5.57it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.79it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.05it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.23it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.84it/s] 40%|████      | 10/25 [00:01<00:02,  6.05it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.84it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.54it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.77it/s] 60%|██████    | 15/25 [00:02<00:01,  5.99it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.15it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.29it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.21it/s] 80%|████████  | 20/25 [00:03<00:00,  6.34it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.86it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.46it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.19it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.15it/s]100%|██████████| 25/25 [00:04<00:00,  5.86it/s]100%|██████████| 25/25 [00:04<00:00,  5.89it/s]
Run 00 | Epoch 00003 | Loss 3.0789 | Train 0.2878 | Val 0.2735 | Test 0.1998
Number of nodes during this epoch:  4637490
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.423570156097412  GigaBytes
Max Memory Allocated: 12.213557720184326  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0776944160461426
range selection method range initialization spend 0.042830467224121094
time for parepare:  0.3841273784637451
local_output_nid generation:  0.026347637176513672
local_in_edges_tensor generation:  0.2155144214630127
mini_batch_src_global generation:  0.3746356964111328
r_  generation:  5.637555360794067
local_output_nid generation:  0.02907872200012207
local_in_edges_tensor generation:  0.2639644145965576
mini_batch_src_global generation:  0.46184468269348145
r_  generation:  5.849046468734741
----------------------check_connections_block total spend ----------------------------- 14.882215976715088
generate_one_block  7.261997222900391
generate_one_block  7.0130391120910645
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8883330821990967
gen group dst list time:  0.09184551239013672
time for parepare:  0.4542052745819092
local_output_nid generation:  0.2355337142944336
local_in_edges_tensor generation:  1.5902988910675049
mini_batch_src_global generation:  2.730614185333252
r_  generation:  29.784472227096558
local_output_nid generation:  0.5210080146789551
local_in_edges_tensor generation:  2.2966182231903076
mini_batch_src_global generation:  3.6223909854888916
r_  generation:  29.741498708724976
----------------------check_connections_block total spend ----------------------------- 82.91975522041321
generate_one_block  41.017178535461426
generate_one_block  40.949881076812744
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2443649768829346
gen group dst list time:  0.17990922927856445
time for parepare:  0.43950343132019043
local_output_nid generation:  0.38968849182128906
local_in_edges_tensor generation:  1.5202805995941162
mini_batch_src_global generation:  2.223633050918579
r_  generation:  26.214027881622314
local_output_nid generation:  0.7361969947814941
local_in_edges_tensor generation:  2.0365521907806396
mini_batch_src_global generation:  2.8082268238067627
r_  generation:  26.21936297416687
----------------------check_connections_block total spend ----------------------------- 72.70291042327881
generate_one_block  35.311657667160034
generate_one_block  35.98591685295105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.423570156097412  GigaBytes
Max Memory Allocated: 12.213557720184326  GigaBytes

connection checking time:  155.62266564369202
block generation total time  153.26463413238525
average batch blocks generation time:  76.63231706619263
block dataloader generation time/epoch 367.8638364672661
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4009965658187866 |1.36661958694458 |0.004390358924865723 |0.00014913082122802734 |0.005090236663818359 |0.001491546630859375 |
----------------------------------------------------------pseudo_mini_loss sum 2.6494522094726562
Total (block generation + training)time/epoch 371.8000405430794
Training time/epoch 3.9650962352752686
Training time without block to device /epoch 1.2318570613861084
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.00it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.27it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.03it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.56it/s] 40%|████      | 10/25 [00:00<00:00, 17.56it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.78it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.95it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.01it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.04it/s] 80%|████████  | 20/25 [00:01<00:00, 18.08it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.07it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.13it/s]100%|██████████| 25/25 [00:01<00:00, 18.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.52it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.53it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.55it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.45it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.47it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.36it/s]  8%|▊         | 2/25 [00:00<00:03,  6.40it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.40it/s] 20%|██        | 5/25 [00:00<00:03,  6.41it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.37it/s] 40%|████      | 10/25 [00:01<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.39it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]
Run 00 | Epoch 00004 | Loss 2.6495 | Train 0.3472 | Val 0.3287 | Test 0.2395
Number of nodes during this epoch:  4637594
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.426383018493652  GigaBytes
Max Memory Allocated: 12.213557720184326  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0393688678741455
range selection method range initialization spend 0.027869224548339844
time for parepare:  0.37688350677490234
local_output_nid generation:  0.02589702606201172
local_in_edges_tensor generation:  0.16712713241577148
mini_batch_src_global generation:  0.35933446884155273
r_  generation:  5.409295082092285
local_output_nid generation:  0.026353836059570312
local_in_edges_tensor generation:  0.19885468482971191
mini_batch_src_global generation:  0.4518442153930664
r_  generation:  5.5407395362854
----------------------check_connections_block total spend ----------------------------- 14.10633134841919
generate_one_block  6.806596755981445
generate_one_block  6.925206422805786
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.011560440063477
gen group dst list time:  0.08593559265136719
time for parepare:  0.42904067039489746
local_output_nid generation:  0.2353832721710205
local_in_edges_tensor generation:  1.579585313796997
mini_batch_src_global generation:  2.411959648132324
r_  generation:  28.78383708000183
local_output_nid generation:  0.48843884468078613
local_in_edges_tensor generation:  2.3525946140289307
mini_batch_src_global generation:  3.439383029937744
r_  generation:  29.982171297073364
----------------------check_connections_block total spend ----------------------------- 81.34235048294067
generate_one_block  41.147905111312866
generate_one_block  41.00767421722412
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1976139545440674
gen group dst list time:  0.18107891082763672
time for parepare:  0.4674367904663086
local_output_nid generation:  0.39504408836364746
local_in_edges_tensor generation:  1.5668010711669922
mini_batch_src_global generation:  2.0064857006073
r_  generation:  26.3255774974823
local_output_nid generation:  0.7256474494934082
local_in_edges_tensor generation:  1.9102978706359863
mini_batch_src_global generation:  2.9244909286499023
r_  generation:  26.61862349510193
----------------------check_connections_block total spend ----------------------------- 73.87004256248474
generate_one_block  35.29619240760803
generate_one_block  36.25985097885132
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.426383018493652  GigaBytes
Max Memory Allocated: 12.213557720184326  GigaBytes

connection checking time:  155.21239304542542
block generation total time  153.71162271499634
average batch blocks generation time:  76.85581135749817
block dataloader generation time/epoch 367.470205116272
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.381960391998291 |1.3337328433990479 |0.004508018493652344 |0.00015282630920410156 |0.005125641822814941 |0.0015368461608886719 |
----------------------------------------------------------pseudo_mini_loss sum 2.364236831665039
Total (block generation + training)time/epoch 371.392201423645
Training time/epoch 3.864987850189209
Training time without block to device /epoch 1.1975221633911133
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.29it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.74it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.29it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.64it/s] 40%|████      | 10/25 [00:00<00:00, 17.69it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.71it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.75it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.65it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.82it/s] 80%|████████  | 20/25 [00:01<00:00, 17.89it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.88it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.85it/s]100%|██████████| 25/25 [00:01<00:00, 17.96it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.23it/s]  8%|▊         | 2/25 [00:00<00:04,  5.20it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.19it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.18it/s] 20%|██        | 5/25 [00:00<00:03,  5.18it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.16it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.14it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.14it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.12it/s] 40%|████      | 10/25 [00:01<00:02,  5.10it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.82it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.64it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.86it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.80it/s] 60%|██████    | 15/25 [00:03<00:02,  4.85it/s] 64%|██████▍   | 16/25 [00:03<00:01,  4.89it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.65it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.94it/s] 80%|████████  | 20/25 [00:03<00:00,  6.19it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.79it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.33it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.28it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.59it/s]100%|██████████| 25/25 [00:04<00:00,  5.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.66it/s]  8%|▊         | 2/25 [00:00<00:04,  5.58it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.10it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.55it/s] 20%|██        | 5/25 [00:00<00:03,  5.89it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.56it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.85it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.08it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.26it/s] 40%|████      | 10/25 [00:01<00:02,  5.76it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.24it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.90it/s] 60%|██████    | 15/25 [00:02<00:01,  6.14it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.29it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.33it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.83it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.91it/s] 80%|████████  | 20/25 [00:03<00:00,  5.82it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.11it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.85it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.04it/s]100%|██████████| 25/25 [00:04<00:00,  5.96it/s]
Run 00 | Epoch 00005 | Loss 2.3642 | Train 0.3864 | Val 0.3685 | Test 0.2681
Number of nodes during this epoch:  4637556
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.429266452789307  GigaBytes
Max Memory Allocated: 12.216469287872314  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0782577991485596
range selection method range initialization spend 0.0286712646484375
time for parepare:  0.3679990768432617
local_output_nid generation:  0.026259183883666992
local_in_edges_tensor generation:  0.21375489234924316
mini_batch_src_global generation:  0.3664224147796631
r_  generation:  5.363191604614258
local_output_nid generation:  0.028695344924926758
local_in_edges_tensor generation:  0.19069314002990723
mini_batch_src_global generation:  0.4511728286743164
r_  generation:  5.6600563526153564
----------------------check_connections_block total spend ----------------------------- 14.318633794784546
generate_one_block  7.218222379684448
generate_one_block  6.718824148178101
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.940215826034546
gen group dst list time:  0.08901572227478027
time for parepare:  0.4833812713623047
local_output_nid generation:  0.25534701347351074
local_in_edges_tensor generation:  1.5893325805664062
mini_batch_src_global generation:  2.528836488723755
r_  generation:  30.040366411209106
local_output_nid generation:  0.5291190147399902
local_in_edges_tensor generation:  2.0492172241210938
mini_batch_src_global generation:  3.678656816482544
r_  generation:  30.257478713989258
----------------------check_connections_block total spend ----------------------------- 83.349440574646
generate_one_block  41.2052698135376
generate_one_block  40.94448971748352
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.067518711090088
gen group dst list time:  0.17949271202087402
time for parepare:  0.44576573371887207
local_output_nid generation:  0.3646526336669922
local_in_edges_tensor generation:  1.4780592918395996
mini_batch_src_global generation:  1.9916291236877441
r_  generation:  25.38064408302307
local_output_nid generation:  0.724219560623169
local_in_edges_tensor generation:  2.0795631408691406
mini_batch_src_global generation:  2.9079442024230957
r_  generation:  26.09365439414978
----------------------check_connections_block total spend ----------------------------- 71.13165545463562
generate_one_block  34.983803033828735
generate_one_block  35.80915331840515
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.429266452789307  GigaBytes
Max Memory Allocated: 12.216469287872314  GigaBytes

connection checking time:  154.48109602928162
block generation total time  152.942715883255
average batch blocks generation time:  76.4713579416275
block dataloader generation time/epoch 367.220375140508
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3941609859466553 |1.2860854864120483 |0.004292607307434082 |0.00014591217041015625 |0.005109548568725586 |0.003086566925048828 |
----------------------------------------------------------pseudo_mini_loss sum 2.1426925659179688
Total (block generation + training)time/epoch 371.1200172503789
Training time/epoch 3.7877140045166016
Training time without block to device /epoch 1.2155430316925049
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.81it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.36it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.76it/s] 40%|████      | 10/25 [00:00<00:00, 18.02it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.19it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.32it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.36it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.27it/s] 80%|████████  | 20/25 [00:01<00:00, 18.28it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.33it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.32it/s]100%|██████████| 25/25 [00:01<00:00, 18.34it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.60it/s]  8%|▊         | 2/25 [00:00<00:03,  6.62it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.63it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.65it/s] 20%|██        | 5/25 [00:00<00:02,  6.69it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.67it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.66it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.64it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.64it/s] 40%|████      | 10/25 [00:01<00:02,  6.64it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.63it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.60it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.63it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.61it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.53it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.49it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  6.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.62it/s]  8%|▊         | 2/25 [00:00<00:03,  6.16it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.03it/s] 20%|██        | 5/25 [00:00<00:03,  6.20it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.28it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.13it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.23it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.33it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.50it/s] 60%|██████    | 15/25 [00:02<00:01,  6.53it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.53it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.54it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.49it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]
Run 00 | Epoch 00006 | Loss 2.1427 | Train 0.4173 | Val 0.3967 | Test 0.2906
Number of nodes during this epoch:  4637029
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.4236578941345215  GigaBytes
Max Memory Allocated: 12.216469287872314  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1049575805664062
range selection method range initialization spend 0.027643680572509766
time for parepare:  0.36252713203430176
local_output_nid generation:  0.025122404098510742
local_in_edges_tensor generation:  0.19868779182434082
mini_batch_src_global generation:  0.3675520420074463
r_  generation:  5.3839638233184814
local_output_nid generation:  0.027112722396850586
local_in_edges_tensor generation:  0.1914043426513672
mini_batch_src_global generation:  0.45958900451660156
r_  generation:  5.495488882064819
----------------------check_connections_block total spend ----------------------------- 14.098442077636719
generate_one_block  7.053837776184082
generate_one_block  6.843661546707153
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.927722454071045
gen group dst list time:  0.08697247505187988
time for parepare:  0.4256777763366699
local_output_nid generation:  0.23280596733093262
local_in_edges_tensor generation:  1.5824832916259766
mini_batch_src_global generation:  2.410588264465332
r_  generation:  29.050825119018555
local_output_nid generation:  0.5034036636352539
local_in_edges_tensor generation:  2.3784399032592773
mini_batch_src_global generation:  3.511507987976074
r_  generation:  30.41438388824463
----------------------check_connections_block total spend ----------------------------- 82.03054308891296
generate_one_block  41.42388153076172
generate_one_block  41.29185700416565
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3962090015411377
gen group dst list time:  0.20701932907104492
time for parepare:  0.48396921157836914
local_output_nid generation:  0.39388060569763184
local_in_edges_tensor generation:  1.4937806129455566
mini_batch_src_global generation:  2.010948896408081
r_  generation:  26.242767572402954
local_output_nid generation:  0.7235908508300781
local_in_edges_tensor generation:  1.9282867908477783
mini_batch_src_global generation:  2.798922300338745
r_  generation:  25.96130633354187
----------------------check_connections_block total spend ----------------------------- 72.1177306175232
generate_one_block  34.960930824279785
generate_one_block  35.792255878448486
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.4236578941345215  GigaBytes
Max Memory Allocated: 12.216469287872314  GigaBytes

connection checking time:  154.14827370643616
block generation total time  153.46892523765564
average batch blocks generation time:  76.73446261882782
block dataloader generation time/epoch 366.8755236693791
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3722423315048218 |1.3890732526779175 |0.0042961835861206055 |0.00014519691467285156 |0.005044698715209961 |0.0016095638275146484 |
----------------------------------------------------------pseudo_mini_loss sum 1.9677159786224365
Total (block generation + training)time/epoch 370.782260451998
Training time/epoch 3.949147939682007
Training time without block to device /epoch 1.1710014343261719
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.74it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.43it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.80it/s] 40%|████      | 10/25 [00:00<00:00, 17.71it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.86it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.89it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.86it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.81it/s] 80%|████████  | 20/25 [00:01<00:00, 17.82it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.81it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.73it/s]100%|██████████| 25/25 [00:01<00:00, 17.91it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.61it/s]  8%|▊         | 2/25 [00:00<00:04,  5.66it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.70it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.59it/s] 20%|██        | 5/25 [00:00<00:03,  5.64it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.78it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.97it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.16it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.29it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.46it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.55it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.58it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.64it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.63it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.59it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.79it/s] 80%|████████  | 20/25 [00:03<00:00,  6.01it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.22it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.29it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.54it/s]100%|██████████| 25/25 [00:03<00:00,  6.75it/s]100%|██████████| 25/25 [00:03<00:00,  6.27it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.75it/s]  8%|▊         | 2/25 [00:00<00:03,  6.15it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.42it/s] 20%|██        | 5/25 [00:00<00:03,  5.29it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.22it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.17it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.76it/s] 40%|████      | 10/25 [00:01<00:02,  5.61it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.46it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.29it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.07it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.44it/s] 60%|██████    | 15/25 [00:02<00:01,  5.73it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.57it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.45it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.60it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.87it/s] 80%|████████  | 20/25 [00:03<00:00,  5.68it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.49it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.66it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.91it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.09it/s]100%|██████████| 25/25 [00:04<00:00,  5.70it/s]
Run 00 | Epoch 00007 | Loss 1.9677 | Train 0.4402 | Val 0.4203 | Test 0.3093
Number of nodes during this epoch:  4637649
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.424933910369873  GigaBytes
Max Memory Allocated: 12.216469287872314  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1292624473571777
range selection method range initialization spend 0.029494524002075195
time for parepare:  0.38863515853881836
local_output_nid generation:  0.029539823532104492
local_in_edges_tensor generation:  0.22143125534057617
mini_batch_src_global generation:  0.36895108222961426
r_  generation:  5.4708287715911865
local_output_nid generation:  0.03119492530822754
local_in_edges_tensor generation:  0.2121872901916504
mini_batch_src_global generation:  0.486194372177124
r_  generation:  5.766129016876221
----------------------check_connections_block total spend ----------------------------- 14.61155080795288
generate_one_block  7.295485258102417
generate_one_block  7.247715711593628
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.928067684173584
gen group dst list time:  0.09142708778381348
time for parepare:  0.4536314010620117
local_output_nid generation:  0.2519221305847168
local_in_edges_tensor generation:  1.8950510025024414
mini_batch_src_global generation:  2.463132858276367
r_  generation:  29.77739381790161
local_output_nid generation:  0.5083029270172119
local_in_edges_tensor generation:  2.1944284439086914
mini_batch_src_global generation:  3.4709651470184326
r_  generation:  30.276350498199463
----------------------check_connections_block total spend ----------------------------- 83.1321337223053
generate_one_block  41.03252959251404
generate_one_block  41.43801999092102
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.419189929962158
gen group dst list time:  0.18716907501220703
time for parepare:  0.492340087890625
local_output_nid generation:  0.3929321765899658
local_in_edges_tensor generation:  1.483870029449463
mini_batch_src_global generation:  2.0047645568847656
r_  generation:  26.069499015808105
local_output_nid generation:  0.7312037944793701
local_in_edges_tensor generation:  2.0534603595733643
mini_batch_src_global generation:  2.8004393577575684
r_  generation:  26.088188409805298
----------------------check_connections_block total spend ----------------------------- 72.16675424575806
generate_one_block  35.22458600997925
generate_one_block  35.99389958381653
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.424933910369873  GigaBytes
Max Memory Allocated: 12.216469287872314  GigaBytes

connection checking time:  155.29888796806335
block generation total time  153.68903517723083
average batch blocks generation time:  76.84451758861542
block dataloader generation time/epoch 367.1025535464287
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3068826198577881 |1.48647940158844 |0.04225587844848633 |0.00016629695892333984 |0.06589913368225098 |0.0039730072021484375 |
----------------------------------------------------------pseudo_mini_loss sum 1.8276166915893555
Total (block generation + training)time/epoch 371.04762575030327
Training time/epoch 4.213254690170288
Training time without block to device /epoch 1.2402958869934082
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.28it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.70it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.25it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.62it/s] 40%|████      | 10/25 [00:00<00:00, 17.81it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.91it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.63it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.80it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.96it/s] 80%|████████  | 20/25 [00:01<00:00, 18.10it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.15it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.15it/s]100%|██████████| 25/25 [00:01<00:00, 18.11it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.17it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.46it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.51it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.45it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.49it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.49it/s] 80%|████████  | 20/25 [00:03<00:00,  6.47it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.49it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.50it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.14it/s]  8%|▊         | 2/25 [00:00<00:03,  6.28it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.33it/s] 20%|██        | 5/25 [00:00<00:03,  6.38it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.36it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.42it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.37it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.36it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.37it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.36it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.29it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.29it/s] 80%|████████  | 20/25 [00:03<00:00,  6.07it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.17it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.23it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.28it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.01it/s]100%|██████████| 25/25 [00:03<00:00,  6.38it/s]
Run 00 | Epoch 00008 | Loss 1.8276 | Train 0.4589 | Val 0.4393 | Test 0.3251
Number of nodes during this epoch:  4637953
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.424007415771484  GigaBytes
Max Memory Allocated: 12.216469287872314  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1114051342010498
range selection method range initialization spend 0.027131080627441406
time for parepare:  0.37803196907043457
local_output_nid generation:  0.027611732482910156
local_in_edges_tensor generation:  0.20964574813842773
mini_batch_src_global generation:  0.3712921142578125
r_  generation:  5.4417524337768555
local_output_nid generation:  0.02705073356628418
local_in_edges_tensor generation:  0.21222352981567383
mini_batch_src_global generation:  0.4620380401611328
r_  generation:  5.673476934432983
----------------------check_connections_block total spend ----------------------------- 14.401808977127075
generate_one_block  7.245588302612305
generate_one_block  6.787341594696045
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.893371820449829
gen group dst list time:  0.09287190437316895
time for parepare:  0.4662752151489258
local_output_nid generation:  0.2485065460205078
local_in_edges_tensor generation:  1.8226604461669922
mini_batch_src_global generation:  2.474943161010742
r_  generation:  29.75242590904236
local_output_nid generation:  0.5066275596618652
local_in_edges_tensor generation:  2.32646107673645
mini_batch_src_global generation:  3.6121368408203125
r_  generation:  29.89309549331665
----------------------check_connections_block total spend ----------------------------- 82.97516107559204
generate_one_block  41.07323408126831
generate_one_block  41.40460801124573
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2320821285247803
gen group dst list time:  0.18511104583740234
time for parepare:  0.4649081230163574
local_output_nid generation:  0.40224123001098633
local_in_edges_tensor generation:  1.4680702686309814
mini_batch_src_global generation:  1.9971330165863037
r_  generation:  25.719974994659424
local_output_nid generation:  0.737678050994873
local_in_edges_tensor generation:  2.216907262802124
mini_batch_src_global generation:  2.807490825653076
r_  generation:  26.1340172290802
----------------------check_connections_block total spend ----------------------------- 71.90214490890503
generate_one_block  35.294841051101685
generate_one_block  36.175859451293945
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.424007415771484  GigaBytes
Max Memory Allocated: 12.216469287872314  GigaBytes

connection checking time:  154.87730598449707
block generation total time  153.94854259490967
average batch blocks generation time:  76.97427129745483
block dataloader generation time/epoch 367.0827509297265
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38919150829315186 |1.3234413862228394 |0.004494428634643555 |0.0001475811004638672 |0.005069851875305176 |0.002864360809326172 |
----------------------------------------------------------pseudo_mini_loss sum 1.7029448747634888
Total (block generation + training)time/epoch 371.0171110894945
Training time/epoch 3.8484835624694824
Training time without block to device /epoch 1.2016007900238037
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.32it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.20it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.09it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.56it/s] 40%|████      | 10/25 [00:00<00:00, 17.49it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.24it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.44it/s] 64%|██████▍   | 16/25 [00:00<00:00, 15.18it/s] 72%|███████▏  | 18/25 [00:01<00:00, 15.29it/s] 80%|████████  | 20/25 [00:01<00:00, 15.45it/s] 88%|████████▊ | 22/25 [00:01<00:00, 15.85it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.45it/s]100%|██████████| 25/25 [00:01<00:00, 16.48it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.22it/s]  8%|▊         | 2/25 [00:00<00:04,  5.17it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.13it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.04it/s] 20%|██        | 5/25 [00:00<00:04,  4.93it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.38it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.72it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.49it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.31it/s] 40%|████      | 10/25 [00:01<00:02,  5.17it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.54it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.87it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.09it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.24it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.02it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.72it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.53it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.36it/s] 80%|████████  | 20/25 [00:03<00:00,  5.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.85it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.08it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.17it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.37it/s]100%|██████████| 25/25 [00:04<00:00,  6.68it/s]100%|██████████| 25/25 [00:04<00:00,  5.77it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:04,  5.64it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.38it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.19it/s] 20%|██        | 5/25 [00:00<00:03,  5.59it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.90it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.11it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.25it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.35it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.40it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.40it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  5.99it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.13it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.22it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.30it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.48it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.08it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.75it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.51it/s]100%|██████████| 25/25 [00:04<00:00,  6.33it/s]100%|██████████| 25/25 [00:04<00:00,  6.12it/s]
Run 00 | Epoch 00009 | Loss 1.7029 | Train 0.4754 | Val 0.4571 | Test 0.3388
Number of nodes during this epoch:  4637647
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.429612159729004  GigaBytes
Max Memory Allocated: 12.219107627868652  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.09474778175354
range selection method range initialization spend 0.027594566345214844
time for parepare:  0.3768885135650635
local_output_nid generation:  0.02549147605895996
local_in_edges_tensor generation:  0.21700143814086914
mini_batch_src_global generation:  0.3719971179962158
r_  generation:  5.5892014503479
local_output_nid generation:  0.028514623641967773
local_in_edges_tensor generation:  0.24641895294189453
mini_batch_src_global generation:  0.45994997024536133
r_  generation:  5.863506078720093
----------------------check_connections_block total spend ----------------------------- 14.811482429504395
generate_one_block  7.217260122299194
generate_one_block  6.910473346710205
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9591245651245117
gen group dst list time:  0.0906684398651123
time for parepare:  0.47437310218811035
local_output_nid generation:  0.2601747512817383
local_in_edges_tensor generation:  1.6091265678405762
mini_batch_src_global generation:  2.5131053924560547
r_  generation:  30.031734943389893
local_output_nid generation:  0.5124754905700684
local_in_edges_tensor generation:  2.344863176345825
mini_batch_src_global generation:  3.7417123317718506
r_  generation:  29.918685913085938
----------------------check_connections_block total spend ----------------------------- 83.34861826896667
generate_one_block  41.41085982322693
generate_one_block  41.425355672836304
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2100279331207275
gen group dst list time:  0.1898479461669922
time for parepare:  0.468341588973999
local_output_nid generation:  0.3931121826171875
local_in_edges_tensor generation:  1.5281009674072266
mini_batch_src_global generation:  2.0968940258026123
r_  generation:  26.322030544281006
local_output_nid generation:  0.73941969871521
local_in_edges_tensor generation:  1.9512405395507812
mini_batch_src_global generation:  2.8447864055633545
r_  generation:  26.232710599899292
----------------------check_connections_block total spend ----------------------------- 72.73365569114685
generate_one_block  35.355403423309326
generate_one_block  36.75402879714966
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4578857421875 GB
    Memory Allocated: 4.429612159729004  GigaBytes
Max Memory Allocated: 12.219107627868652  GigaBytes

connection checking time:  156.08227396011353
block generation total time  154.94564771652222
average batch blocks generation time:  77.47282385826111
block dataloader generation time/epoch 367.3625171661377
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38047873973846436 |1.096936583518982 |0.04184091091156006 |0.0001512765884399414 |0.0753864049911499 |0.0040051937103271484 |
----------------------------------------------------------pseudo_mini_loss sum 1.6022019386291504
Total (block generation + training)time/epoch 371.2447641372681
Training time/epoch 3.413121461868286
Training time without block to device /epoch 1.2192482948303223
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.87it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.06it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.93it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.09it/s] 40%|████      | 10/25 [00:00<00:00, 17.50it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.79it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.89it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.43it/s] 80%|████████  | 20/25 [00:01<00:00, 17.75it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.49it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.68it/s]100%|██████████| 25/25 [00:01<00:00, 17.74it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.02it/s]  8%|▊         | 2/25 [00:00<00:04,  5.46it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.98it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.42it/s] 20%|██        | 5/25 [00:00<00:03,  5.30it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.18it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.18it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.59it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.91it/s] 40%|████      | 10/25 [00:01<00:02,  6.04it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.26it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.54it/s] 60%|██████    | 15/25 [00:02<00:01,  6.57it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.55it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.60it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.57it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.64it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.50it/s]  8%|▊         | 2/25 [00:00<00:03,  6.52it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.57it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.63it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.62it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.62it/s] 40%|████      | 10/25 [00:01<00:02,  6.63it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.57it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.61it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.63it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.62it/s] 60%|██████    | 15/25 [00:02<00:01,  6.62it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.62it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.64it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.64it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.66it/s] 80%|████████  | 20/25 [00:03<00:00,  6.68it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.69it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.68it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.67it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.65it/s]100%|██████████| 25/25 [00:03<00:00,  6.76it/s]
Run 00 | Epoch 00010 | Loss 1.6022 | Train 0.4908 | Val 0.4706 | Test 0.3511
Number of nodes during this epoch:  4637753
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428781032562256  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0801985263824463
range selection method range initialization spend 0.0290830135345459
time for parepare:  0.3795201778411865
local_output_nid generation:  0.025700092315673828
local_in_edges_tensor generation:  0.14815020561218262
mini_batch_src_global generation:  0.3912322521209717
r_  generation:  5.563927173614502
local_output_nid generation:  0.028337478637695312
local_in_edges_tensor generation:  0.22811293601989746
mini_batch_src_global generation:  0.45972466468811035
r_  generation:  5.868219614028931
----------------------check_connections_block total spend ----------------------------- 14.688897848129272
generate_one_block  7.251373767852783
generate_one_block  6.991072654724121
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.106062650680542
gen group dst list time:  0.10076403617858887
time for parepare:  0.4671170711517334
local_output_nid generation:  0.26211094856262207
local_in_edges_tensor generation:  1.6703219413757324
mini_batch_src_global generation:  2.4827256202697754
r_  generation:  29.910034656524658
local_output_nid generation:  0.5471651554107666
local_in_edges_tensor generation:  2.28621244430542
mini_batch_src_global generation:  3.5476303100585938
r_  generation:  30.077306032180786
----------------------check_connections_block total spend ----------------------------- 83.32316136360168
generate_one_block  41.423105001449585
generate_one_block  41.23087739944458
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.081552743911743
gen group dst list time:  0.18642807006835938
time for parepare:  0.4597511291503906
local_output_nid generation:  0.3848581314086914
local_in_edges_tensor generation:  1.4753098487854004
mini_batch_src_global generation:  1.9935383796691895
r_  generation:  25.76448369026184
local_output_nid generation:  0.7366364002227783
local_in_edges_tensor generation:  2.193861961364746
mini_batch_src_global generation:  2.807387351989746
r_  generation:  26.318937063217163
----------------------check_connections_block total spend ----------------------------- 72.03119373321533
generate_one_block  35.42024779319763
generate_one_block  36.13631010055542
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428781032562256  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.35435509681702
block generation total time  154.21054029464722
average batch blocks generation time:  77.10527014732361
block dataloader generation time/epoch 367.4803888581016
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.399011492729187 |1.1086831092834473 |0.005057692527770996 |0.00017654895782470703 |0.005324363708496094 |0.0017812252044677734 |
----------------------------------------------------------pseudo_mini_loss sum 1.5169026851654053
Total (block generation + training)time/epoch 371.3228406906128
Training time/epoch 3.444307327270508
Training time without block to device /epoch 1.2269411087036133
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.15it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.62it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.10it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.60it/s] 40%|████      | 10/25 [00:00<00:00, 17.89it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.03it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.18it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.19it/s] 80%|████████  | 20/25 [00:01<00:00, 18.24it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.22it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.25it/s]100%|██████████| 25/25 [00:01<00:00, 18.21it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.37it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.48it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.52it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.45it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.60it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.16it/s]  8%|▊         | 2/25 [00:00<00:03,  6.23it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.29it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.38it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.38it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.38it/s] 40%|████      | 10/25 [00:01<00:02,  6.40it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.39it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.41it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.40it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]
Run 00 | Epoch 00011 | Loss 1.5169 | Train 0.5052 | Val 0.4866 | Test 0.3630
Number of nodes during this epoch:  4637704
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424230098724365  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.9773154258728027
range selection method range initialization spend 0.026823997497558594
time for parepare:  0.36049938201904297
local_output_nid generation:  0.025702714920043945
local_in_edges_tensor generation:  0.21901750564575195
mini_batch_src_global generation:  0.3702726364135742
r_  generation:  5.4501707553863525
local_output_nid generation:  0.026285171508789062
local_in_edges_tensor generation:  0.18916893005371094
mini_batch_src_global generation:  0.4642183780670166
r_  generation:  5.618168830871582
----------------------check_connections_block total spend ----------------------------- 14.342977046966553
generate_one_block  7.060360670089722
generate_one_block  7.052930116653442
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.008761882781982
gen group dst list time:  0.08654999732971191
time for parepare:  0.42516350746154785
local_output_nid generation:  0.22048687934875488
local_in_edges_tensor generation:  1.577141284942627
mini_batch_src_global generation:  2.4118432998657227
r_  generation:  28.909780502319336
local_output_nid generation:  0.4714508056640625
local_in_edges_tensor generation:  2.388119697570801
mini_batch_src_global generation:  3.4331748485565186
r_  generation:  30.056312084197998
----------------------check_connections_block total spend ----------------------------- 81.61676836013794
generate_one_block  41.38129711151123
generate_one_block  40.90680456161499
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2443203926086426
gen group dst list time:  0.19506549835205078
time for parepare:  0.4664297103881836
local_output_nid generation:  0.3629169464111328
local_in_edges_tensor generation:  1.4978501796722412
mini_batch_src_global generation:  2.0109055042266846
r_  generation:  25.711684942245483
local_output_nid generation:  0.725222110748291
local_in_edges_tensor generation:  2.1155152320861816
mini_batch_src_global generation:  2.7442898750305176
r_  generation:  26.11588215827942
----------------------check_connections_block total spend ----------------------------- 71.60301637649536
generate_one_block  35.316807985305786
generate_one_block  35.96040606498718
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424230098724365  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.2197847366333
block generation total time  153.5653157234192
average batch blocks generation time:  76.7826578617096
block dataloader generation time/epoch 367.2287296454112
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4001966714859009 |1.3762999773025513 |0.004375100135803223 |0.00014960765838623047 |0.005109429359436035 |0.0016665458679199219 |
----------------------------------------------------------pseudo_mini_loss sum 1.4388571977615356
Total (block generation + training)time/epoch 371.0830083290736
Training time/epoch 3.9842193126678467
Training time without block to device /epoch 1.2316193580627441
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.28it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.77it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.45it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.80it/s] 40%|████      | 10/25 [00:00<00:00, 17.91it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.07it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.13it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.19it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.09it/s] 80%|████████  | 20/25 [00:01<00:00, 18.13it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.18it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.06it/s]100%|██████████| 25/25 [00:01<00:00, 18.23it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.33it/s]  8%|▊         | 2/25 [00:00<00:03,  6.11it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.28it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.32it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.34it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.07it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.09it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.15it/s] 40%|████      | 10/25 [00:01<00:02,  5.92it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.94it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.98it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.80it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.97it/s] 60%|██████    | 15/25 [00:02<00:01,  6.07it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.92it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.06it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.08it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.20it/s] 80%|████████  | 20/25 [00:03<00:00,  6.24it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.27it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.15it/s]  8%|▊         | 2/25 [00:00<00:03,  6.22it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.26it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.31it/s] 20%|██        | 5/25 [00:00<00:03,  6.34it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.36it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.37it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.38it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.40it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.35it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.35it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.37it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.36it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.33it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
Run 00 | Epoch 00012 | Loss 1.4389 | Train 0.5185 | Val 0.5003 | Test 0.3741
Number of nodes during this epoch:  4637470
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427892208099365  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0703744888305664
range selection method range initialization spend 0.02858877182006836
time for parepare:  0.3549048900604248
local_output_nid generation:  0.02570962905883789
local_in_edges_tensor generation:  0.18718242645263672
mini_batch_src_global generation:  0.3701629638671875
r_  generation:  5.384238004684448
local_output_nid generation:  0.027245759963989258
local_in_edges_tensor generation:  0.22659516334533691
mini_batch_src_global generation:  0.45499587059020996
r_  generation:  5.632270812988281
----------------------check_connections_block total spend ----------------------------- 14.267264604568481
generate_one_block  7.1613383293151855
generate_one_block  7.0218305587768555
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.015247821807861
gen group dst list time:  0.08663272857666016
time for parepare:  0.42278456687927246
local_output_nid generation:  0.2387850284576416
local_in_edges_tensor generation:  1.5939500331878662
mini_batch_src_global generation:  2.4081943035125732
r_  generation:  28.999101161956787
local_output_nid generation:  0.48642468452453613
local_in_edges_tensor generation:  2.0976638793945312
mini_batch_src_global generation:  3.481956958770752
r_  generation:  30.027179479599
----------------------check_connections_block total spend ----------------------------- 81.29224395751953
generate_one_block  41.19827342033386
generate_one_block  41.20147252082825
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.226497173309326
gen group dst list time:  0.18932414054870605
time for parepare:  0.44512939453125
local_output_nid generation:  0.37061643600463867
local_in_edges_tensor generation:  1.4578440189361572
mini_batch_src_global generation:  2.0174098014831543
r_  generation:  25.864490747451782
local_output_nid generation:  0.7180554866790771
local_in_edges_tensor generation:  1.9386873245239258
mini_batch_src_global generation:  2.970932722091675
r_  generation:  26.340779542922974
----------------------check_connections_block total spend ----------------------------- 72.29187178611755
generate_one_block  35.46009802818298
generate_one_block  35.95643591880798
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427892208099365  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.58411574363708
block generation total time  153.81627988815308
average batch blocks generation time:  76.90813994407654
block dataloader generation time/epoch 367.05785114948566
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3865400552749634 |1.2268000841140747 |0.004563450813293457 |0.00015425682067871094 |0.005117177963256836 |0.002967357635498047 |
----------------------------------------------------------pseudo_mini_loss sum 1.3711590766906738
Total (block generation + training)time/epoch 370.8969478973976
Training time/epoch 3.65675687789917
Training time without block to device /epoch 1.2031567096710205
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.61it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.94it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.51it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.85it/s] 40%|████      | 10/25 [00:00<00:00, 18.07it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.20it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.28it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.26it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.29it/s] 80%|████████  | 20/25 [00:01<00:00, 18.35it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.26it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.28it/s]100%|██████████| 25/25 [00:01<00:00, 18.32it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.52it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.59it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.60it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.57it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.54it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.54it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.56it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.56it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.52it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.56it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.57it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.52it/s]100%|██████████| 25/25 [00:03<00:00,  6.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.08it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.36it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.41it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.42it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.42it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.44it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.44it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.46it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.46it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.46it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
Run 00 | Epoch 00013 | Loss 1.3712 | Train 0.5306 | Val 0.5142 | Test 0.3847
Number of nodes during this epoch:  4637523
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428377151489258  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.961451530456543
range selection method range initialization spend 0.026938438415527344
time for parepare:  0.3525974750518799
local_output_nid generation:  0.025468111038208008
local_in_edges_tensor generation:  0.17671489715576172
mini_batch_src_global generation:  0.3633737564086914
r_  generation:  5.413312196731567
local_output_nid generation:  0.025937795639038086
local_in_edges_tensor generation:  0.18858027458190918
mini_batch_src_global generation:  0.4717082977294922
r_  generation:  5.512809753417969
----------------------check_connections_block total spend ----------------------------- 14.11033844947815
generate_one_block  6.909405708312988
generate_one_block  6.891075134277344
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.951153516769409
gen group dst list time:  0.08585500717163086
time for parepare:  0.4179356098175049
local_output_nid generation:  0.22132539749145508
local_in_edges_tensor generation:  1.5693964958190918
mini_batch_src_global generation:  2.4148831367492676
r_  generation:  28.806787967681885
local_output_nid generation:  0.49512624740600586
local_in_edges_tensor generation:  1.9651610851287842
mini_batch_src_global generation:  3.497114896774292
r_  generation:  29.889636993408203
----------------------check_connections_block total spend ----------------------------- 80.84966993331909
generate_one_block  41.129478931427
generate_one_block  40.84905695915222
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.190093517303467
gen group dst list time:  0.17957258224487305
time for parepare:  0.42904233932495117
local_output_nid generation:  0.3690147399902344
local_in_edges_tensor generation:  1.4370882511138916
mini_batch_src_global generation:  1.9992341995239258
r_  generation:  25.457391500473022
local_output_nid generation:  0.7173919677734375
local_in_edges_tensor generation:  1.9403717517852783
mini_batch_src_global generation:  2.6839895248413086
r_  generation:  25.980571746826172
----------------------check_connections_block total spend ----------------------------- 70.86997961997986
generate_one_block  34.9499077796936
generate_one_block  35.987345933914185
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428377151489258  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  151.71964955329895
block generation total time  152.915789604187
average batch blocks generation time:  76.4578948020935
block dataloader generation time/epoch 366.6222043548311
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3877030611038208 |1.1030160188674927 |0.004378676414489746 |0.0001480579376220703 |0.005105137825012207 |0.001941680908203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3093180656433105
Total (block generation + training)time/epoch 370.4303881781442
Training time/epoch 3.4061591625213623
Training time without block to device /epoch 1.200127124786377
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.39it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.84it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.49it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.76it/s] 40%|████      | 10/25 [00:00<00:00, 18.03it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.16it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.25it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.37it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.23it/s] 80%|████████  | 20/25 [00:01<00:00, 18.31it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.32it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.36it/s]100%|██████████| 25/25 [00:01<00:00, 18.35it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  8.13it/s]  8%|▊         | 2/25 [00:00<00:02,  8.48it/s] 12%|█▏        | 3/25 [00:00<00:02,  8.63it/s] 16%|█▌        | 4/25 [00:00<00:02,  8.63it/s] 20%|██        | 5/25 [00:00<00:02,  8.67it/s] 24%|██▍       | 6/25 [00:00<00:02,  8.68it/s] 28%|██▊       | 7/25 [00:00<00:02,  8.63it/s] 32%|███▏      | 8/25 [00:00<00:01,  8.63it/s] 36%|███▌      | 9/25 [00:01<00:01,  8.66it/s] 40%|████      | 10/25 [00:01<00:01,  8.68it/s] 44%|████▍     | 11/25 [00:01<00:01,  8.67it/s] 48%|████▊     | 12/25 [00:01<00:01,  8.69it/s] 52%|█████▏    | 13/25 [00:01<00:01,  8.71it/s] 56%|█████▌    | 14/25 [00:01<00:01,  8.68it/s] 60%|██████    | 15/25 [00:01<00:01,  8.71it/s] 64%|██████▍   | 16/25 [00:01<00:01,  8.69it/s] 68%|██████▊   | 17/25 [00:01<00:00,  8.68it/s] 72%|███████▏  | 18/25 [00:02<00:00,  8.63it/s] 76%|███████▌  | 19/25 [00:02<00:00,  8.67it/s] 80%|████████  | 20/25 [00:02<00:00,  8.69it/s] 84%|████████▍ | 21/25 [00:02<00:00,  8.66it/s] 88%|████████▊ | 22/25 [00:02<00:00,  8.65it/s] 92%|█████████▏| 23/25 [00:02<00:00,  8.67it/s] 96%|█████████▌| 24/25 [00:02<00:00,  8.66it/s]100%|██████████| 25/25 [00:02<00:00,  8.79it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  8.29it/s]  8%|▊         | 2/25 [00:00<00:02,  8.51it/s] 12%|█▏        | 3/25 [00:00<00:02,  8.57it/s] 16%|█▌        | 4/25 [00:00<00:02,  8.61it/s] 20%|██        | 5/25 [00:00<00:02,  8.62it/s] 24%|██▍       | 6/25 [00:00<00:02,  8.61it/s] 28%|██▊       | 7/25 [00:00<00:02,  8.61it/s] 32%|███▏      | 8/25 [00:00<00:01,  8.60it/s] 36%|███▌      | 9/25 [00:01<00:01,  8.61it/s] 40%|████      | 10/25 [00:01<00:01,  8.56it/s] 44%|████▍     | 11/25 [00:01<00:01,  8.56it/s] 48%|████▊     | 12/25 [00:01<00:01,  8.57it/s] 52%|█████▏    | 13/25 [00:01<00:01,  8.59it/s] 56%|█████▌    | 14/25 [00:01<00:01,  8.60it/s] 60%|██████    | 15/25 [00:01<00:01,  8.61it/s] 64%|██████▍   | 16/25 [00:01<00:01,  8.60it/s] 68%|██████▊   | 17/25 [00:01<00:00,  8.61it/s] 72%|███████▏  | 18/25 [00:02<00:00,  8.64it/s] 76%|███████▌  | 19/25 [00:02<00:00,  8.63it/s] 80%|████████  | 20/25 [00:02<00:00,  8.62it/s] 84%|████████▍ | 21/25 [00:02<00:00,  8.63it/s] 88%|████████▊ | 22/25 [00:02<00:00,  8.61it/s] 92%|█████████▏| 23/25 [00:02<00:00,  8.61it/s] 96%|█████████▌| 24/25 [00:02<00:00,  8.61it/s]100%|██████████| 25/25 [00:02<00:00,  8.73it/s]
Run 00 | Epoch 00014 | Loss 1.3093 | Train 0.5420 | Val 0.5273 | Test 0.3950
Number of nodes during this epoch:  4637451
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422921180725098  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.058175802230835
range selection method range initialization spend 0.02732682228088379
time for parepare:  0.3679165840148926
local_output_nid generation:  0.02562713623046875
local_in_edges_tensor generation:  0.1560649871826172
mini_batch_src_global generation:  0.36232781410217285
r_  generation:  5.3030195236206055
local_output_nid generation:  0.026823997497558594
local_in_edges_tensor generation:  0.19028782844543457
mini_batch_src_global generation:  0.4562866687774658
r_  generation:  5.491069555282593
----------------------check_connections_block total spend ----------------------------- 13.930795907974243
generate_one_block  7.168371677398682
generate_one_block  6.707944393157959
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.103727340698242
gen group dst list time:  0.08637547492980957
time for parepare:  0.4226410388946533
local_output_nid generation:  0.24195122718811035
local_in_edges_tensor generation:  1.5718367099761963
mini_batch_src_global generation:  2.618770122528076
r_  generation:  29.94150185585022
local_output_nid generation:  0.5166416168212891
local_in_edges_tensor generation:  2.060959577560425
mini_batch_src_global generation:  3.487053871154785
r_  generation:  29.954055070877075
----------------------check_connections_block total spend ----------------------------- 82.95061039924622
generate_one_block  40.8249192237854
generate_one_block  40.94778227806091
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3805909156799316
gen group dst list time:  0.19080090522766113
time for parepare:  0.47998833656311035
local_output_nid generation:  0.3772296905517578
local_in_edges_tensor generation:  1.5396530628204346
mini_batch_src_global generation:  2.0799472332000732
r_  generation:  26.16826558113098
local_output_nid generation:  0.7375128269195557
local_in_edges_tensor generation:  2.3174309730529785
mini_batch_src_global generation:  2.9358739852905273
r_  generation:  26.682779788970947
----------------------check_connections_block total spend ----------------------------- 73.61065697669983
generate_one_block  36.84258031845093
generate_one_block  37.4075403213501
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422921180725098  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.56126737594604
block generation total time  156.02282214164734
average batch blocks generation time:  78.01141107082367
block dataloader generation time/epoch 366.81445552508035
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39673614501953125 |1.4119943380355835 |0.004403114318847656 |0.0001481771469116211 |0.005196332931518555 |0.0015544891357421875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2607382535934448
Total (block generation + training)time/epoch 370.63807922999064
Training time/epoch 4.0396201610565186
Training time without block to device /epoch 1.2156314849853516
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.04it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.52it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.21it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.53it/s] 40%|████      | 10/25 [00:00<00:01, 13.34it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.41it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.12it/s] 64%|██████▍   | 16/25 [00:01<00:00, 15.70it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.16it/s] 80%|████████  | 20/25 [00:01<00:00, 16.43it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.65it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.83it/s]100%|██████████| 25/25 [00:01<00:00, 16.11it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.41it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.44it/s] 60%|██████    | 15/25 [00:02<00:01,  6.43it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.19it/s]  8%|▊         | 2/25 [00:00<00:03,  6.30it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.32it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.34it/s] 20%|██        | 5/25 [00:00<00:03,  6.37it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.37it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.35it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.29it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.33it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.30it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.29it/s] 60%|██████    | 15/25 [00:02<00:01,  6.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.29it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.31it/s] 80%|████████  | 20/25 [00:03<00:00,  6.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.31it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.28it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.32it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.34it/s]100%|██████████| 25/25 [00:03<00:00,  7.11it/s]100%|██████████| 25/25 [00:03<00:00,  6.42it/s]
Run 00 | Epoch 00015 | Loss 1.2607 | Train 0.5535 | Val 0.5389 | Test 0.4050
Number of nodes during this epoch:  4637443
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423704624176025  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1348984241485596
range selection method range initialization spend 0.02599787712097168
time for parepare:  0.3567016124725342
local_output_nid generation:  0.025968074798583984
local_in_edges_tensor generation:  0.18138480186462402
mini_batch_src_global generation:  0.37422823905944824
r_  generation:  5.772197723388672
local_output_nid generation:  0.029594898223876953
local_in_edges_tensor generation:  0.24287986755371094
mini_batch_src_global generation:  0.46854472160339355
r_  generation:  5.88520884513855
----------------------check_connections_block total spend ----------------------------- 15.035217761993408
generate_one_block  7.587812662124634
generate_one_block  7.4377734661102295
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.969111919403076
gen group dst list time:  0.09235334396362305
time for parepare:  0.46794962882995605
local_output_nid generation:  0.23306059837341309
local_in_edges_tensor generation:  1.639380931854248
mini_batch_src_global generation:  2.5723836421966553
r_  generation:  30.062304258346558
local_output_nid generation:  0.5347676277160645
local_in_edges_tensor generation:  2.438976764678955
mini_batch_src_global generation:  3.8751676082611084
r_  generation:  31.094509601593018
----------------------check_connections_block total spend ----------------------------- 85.4656937122345
generate_one_block  42.67325210571289
generate_one_block  42.41724228858948
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.259112596511841
gen group dst list time:  0.18283343315124512
time for parepare:  0.45496296882629395
local_output_nid generation:  0.37642407417297363
local_in_edges_tensor generation:  1.611424207687378
mini_batch_src_global generation:  2.0062754154205322
r_  generation:  26.479429244995117
local_output_nid generation:  0.7470104694366455
local_in_edges_tensor generation:  1.9445552825927734
mini_batch_src_global generation:  2.9795713424682617
r_  generation:  26.50615882873535
----------------------check_connections_block total spend ----------------------------- 73.76696848869324
generate_one_block  36.69710302352905
generate_one_block  37.52253031730652
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423704624176025  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  159.23266220092773
block generation total time  159.31012773513794
average batch blocks generation time:  79.65506386756897
block dataloader generation time/epoch 367.52974516153336
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37341630458831787 |1.0819865465164185 |0.004878520965576172 |0.00017154216766357422 |0.0051805973052978516 |0.001958608627319336 |
----------------------------------------------------------pseudo_mini_loss sum 1.2057762145996094
Total (block generation + training)time/epoch 371.3231325596571
Training time/epoch 3.3396718502044678
Training time without block to device /epoch 1.1756987571716309
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.86it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.02it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.63it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.26it/s] 40%|████      | 10/25 [00:00<00:00, 16.54it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.66it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.78it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.97it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.52it/s] 80%|████████  | 20/25 [00:01<00:00, 17.87it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.13it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.04it/s]100%|██████████| 25/25 [00:01<00:00, 17.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:04,  5.72it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.68it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.04it/s] 20%|██        | 5/25 [00:00<00:03,  5.79it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.58it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.47it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.65it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.01it/s] 40%|████      | 10/25 [00:01<00:02,  6.26it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.47it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.64it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.75it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.83it/s] 60%|██████    | 15/25 [00:02<00:01,  6.85it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.22it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.49it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.58it/s] 80%|████████  | 20/25 [00:03<00:00,  6.65it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.07it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.21it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.89it/s]100%|██████████| 25/25 [00:03<00:00,  6.30it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.49it/s]  8%|▊         | 2/25 [00:00<00:03,  6.66it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.65it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.66it/s] 20%|██        | 5/25 [00:00<00:03,  6.66it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.66it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.64it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.65it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.67it/s] 40%|████      | 10/25 [00:01<00:02,  6.70it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.58it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.61it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.67it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.69it/s] 60%|██████    | 15/25 [00:02<00:01,  6.71it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.72it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.57it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.08it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.73it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.93it/s]100%|██████████| 25/25 [00:03<00:00,  6.58it/s]
Run 00 | Epoch 00016 | Loss 1.2058 | Train 0.5649 | Val 0.5499 | Test 0.4146
Number of nodes during this epoch:  4637323
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424462795257568  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0466151237487793
range selection method range initialization spend 0.02777409553527832
time for parepare:  0.3704555034637451
local_output_nid generation:  0.026012420654296875
local_in_edges_tensor generation:  0.1890246868133545
mini_batch_src_global generation:  0.3712654113769531
r_  generation:  5.52649450302124
local_output_nid generation:  0.027507781982421875
local_in_edges_tensor generation:  0.2275071144104004
mini_batch_src_global generation:  0.4800426959991455
r_  generation:  5.544224739074707
----------------------check_connections_block total spend ----------------------------- 14.402363300323486
generate_one_block  7.233737945556641
generate_one_block  7.093064785003662
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8264544010162354
gen group dst list time:  0.08759450912475586
time for parepare:  0.4799022674560547
local_output_nid generation:  0.2410585880279541
local_in_edges_tensor generation:  1.6009280681610107
mini_batch_src_global generation:  2.483718156814575
r_  generation:  30.23097324371338
local_output_nid generation:  0.5230276584625244
local_in_edges_tensor generation:  2.276577949523926
mini_batch_src_global generation:  3.748666524887085
r_  generation:  29.97939133644104
----------------------check_connections_block total spend ----------------------------- 83.39355611801147
generate_one_block  41.4585235118866
generate_one_block  41.20815420150757
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1779303550720215
gen group dst list time:  0.18840551376342773
time for parepare:  0.4444291591644287
local_output_nid generation:  0.36782097816467285
local_in_edges_tensor generation:  1.5163748264312744
mini_batch_src_global generation:  2.0680606365203857
r_  generation:  26.55243730545044
local_output_nid generation:  0.721041202545166
local_in_edges_tensor generation:  1.9357500076293945
mini_batch_src_global generation:  2.7936761379241943
r_  generation:  26.45456051826477
----------------------check_connections_block total spend ----------------------------- 73.1121940612793
generate_one_block  35.345566272735596
generate_one_block  35.98770594596863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424462795257568  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.50575017929077
block generation total time  153.9999499320984
average batch blocks generation time:  76.9999749660492
block dataloader generation time/epoch 367.6143347095041
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3859858512878418 |1.3193042278289795 |0.004358530044555664 |0.00014531612396240234 |0.005007266998291016 |0.0016279220581054688 |
----------------------------------------------------------pseudo_mini_loss sum 1.1585766077041626
Total (block generation + training)time/epoch 371.41025257110596
Training time/epoch 3.8362526893615723
Training time without block to device /epoch 1.1976442337036133
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.68it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.44it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.02it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.17it/s] 40%|████      | 10/25 [00:00<00:00, 17.50it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.74it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.85it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.70it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.66it/s] 80%|████████  | 20/25 [00:01<00:00, 17.67it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.59it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.81it/s]100%|██████████| 25/25 [00:01<00:00, 17.83it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.17it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.59it/s] 20%|██        | 5/25 [00:00<00:03,  6.66it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.70it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.75it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.15it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.30it/s] 40%|████      | 10/25 [00:01<00:02,  6.43it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.56it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.66it/s] 60%|██████    | 15/25 [00:02<00:01,  6.70it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.72it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.72it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.74it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.74it/s] 80%|████████  | 20/25 [00:03<00:00,  6.75it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.75it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.72it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.15it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.76it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.74it/s]  8%|▊         | 2/25 [00:00<00:04,  5.70it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.01it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.20it/s] 20%|██        | 5/25 [00:00<00:03,  6.37it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.52it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.46it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  5.91it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.57it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.76it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.98it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.69it/s] 60%|██████    | 15/25 [00:02<00:01,  5.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.58it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.86it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.09it/s] 80%|████████  | 20/25 [00:03<00:00,  5.81it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.37it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.29it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.24it/s]100%|██████████| 25/25 [00:04<00:00,  5.85it/s]
Run 00 | Epoch 00017 | Loss 1.1586 | Train 0.5761 | Val 0.5616 | Test 0.4240
Number of nodes during this epoch:  4637654
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423928260803223  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0499093532562256
range selection method range initialization spend 0.026330232620239258
time for parepare:  0.3590223789215088
local_output_nid generation:  0.02551102638244629
local_in_edges_tensor generation:  0.18605828285217285
mini_batch_src_global generation:  0.3776051998138428
r_  generation:  5.438863515853882
local_output_nid generation:  0.027596473693847656
local_in_edges_tensor generation:  0.19208717346191406
mini_batch_src_global generation:  0.45568275451660156
r_  generation:  5.53558087348938
----------------------check_connections_block total spend ----------------------------- 14.25458550453186
generate_one_block  7.173750877380371
generate_one_block  6.917386770248413
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.848416328430176
gen group dst list time:  0.08972048759460449
time for parepare:  0.4567997455596924
local_output_nid generation:  0.251082181930542
local_in_edges_tensor generation:  1.6983342170715332
mini_batch_src_global generation:  2.498323440551758
r_  generation:  30.241786003112793
local_output_nid generation:  0.5285625457763672
local_in_edges_tensor generation:  2.0922179222106934
mini_batch_src_global generation:  3.520103693008423
r_  generation:  30.141036987304688
----------------------check_connections_block total spend ----------------------------- 83.39973163604736
generate_one_block  41.04754853248596
generate_one_block  41.10767078399658
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.084325075149536
gen group dst list time:  0.1860668659210205
time for parepare:  0.4446597099304199
local_output_nid generation:  0.3744020462036133
local_in_edges_tensor generation:  1.4249248504638672
mini_batch_src_global generation:  2.005981922149658
r_  generation:  25.678351402282715
local_output_nid generation:  0.7284541130065918
local_in_edges_tensor generation:  1.8962726593017578
mini_batch_src_global generation:  2.7968029975891113
r_  generation:  26.046672582626343
----------------------check_connections_block total spend ----------------------------- 71.40564799308777
generate_one_block  35.05369210243225
generate_one_block  35.48501634597778
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423928260803223  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.80537962913513
block generation total time  152.69392776489258
average batch blocks generation time:  76.34696388244629
block dataloader generation time/epoch 367.4826392862532
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38033783435821533 |1.2887645959854126 |0.0043038129806518555 |0.00014662742614746094 |0.005105853080749512 |0.0027418136596679688 |
----------------------------------------------------------pseudo_mini_loss sum 1.1140642166137695
Total (block generation + training)time/epoch 371.27685295210944
Training time/epoch 3.7650864124298096
Training time without block to device /epoch 1.1875572204589844
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.93it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.61it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.26it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.66it/s] 40%|████      | 10/25 [00:00<00:00, 16.63it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.02it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.38it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.03it/s] 72%|███████▏  | 18/25 [00:01<00:00, 15.49it/s] 80%|████████  | 20/25 [00:01<00:00, 15.43it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.20it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.73it/s]100%|██████████| 25/25 [00:01<00:00, 16.48it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.09it/s]  8%|▊         | 2/25 [00:00<00:04,  4.89it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.45it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.25it/s] 20%|██        | 5/25 [00:00<00:03,  5.15it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.09it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.44it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.78it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.62it/s] 40%|████      | 10/25 [00:01<00:02,  5.46it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.35it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.10it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.46it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.77it/s] 60%|██████    | 15/25 [00:02<00:01,  6.03it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.25it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.86it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.99it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.21it/s] 80%|████████  | 20/25 [00:03<00:00,  6.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.48it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.06it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.70it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.95it/s]100%|██████████| 25/25 [00:04<00:00,  5.84it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.35it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.66it/s] 20%|██        | 5/25 [00:00<00:02,  6.68it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.69it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.12it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.26it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.53it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.56it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.59it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.60it/s] 60%|██████    | 15/25 [00:02<00:01,  6.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.58it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.03it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.10it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.25it/s] 80%|████████  | 20/25 [00:03<00:00,  5.78it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.93it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.15it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]
Run 00 | Epoch 00018 | Loss 1.1141 | Train 0.5875 | Val 0.5727 | Test 0.4333
Number of nodes during this epoch:  4637593
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4248151779174805  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.118171215057373
range selection method range initialization spend 0.02662038803100586
time for parepare:  0.3797285556793213
local_output_nid generation:  0.026172161102294922
local_in_edges_tensor generation:  0.19837164878845215
mini_batch_src_global generation:  0.35201048851013184
r_  generation:  5.500964164733887
local_output_nid generation:  0.02927374839782715
local_in_edges_tensor generation:  0.22885560989379883
mini_batch_src_global generation:  0.4798860549926758
r_  generation:  5.832088232040405
----------------------check_connections_block total spend ----------------------------- 14.636805772781372
generate_one_block  7.253445863723755
generate_one_block  7.036461353302002
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.780076026916504
gen group dst list time:  0.09464693069458008
time for parepare:  0.45658183097839355
local_output_nid generation:  0.2544994354248047
local_in_edges_tensor generation:  1.6105918884277344
mini_batch_src_global generation:  2.4682741165161133
r_  generation:  29.57807683944702
local_output_nid generation:  0.5122735500335693
local_in_edges_tensor generation:  2.0444250106811523
mini_batch_src_global generation:  3.4721992015838623
r_  generation:  29.811843156814575
----------------------check_connections_block total spend ----------------------------- 81.90151119232178
generate_one_block  40.87264561653137
generate_one_block  40.90813398361206
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.179279088973999
gen group dst list time:  0.19000959396362305
time for parepare:  0.4519789218902588
local_output_nid generation:  0.37666964530944824
local_in_edges_tensor generation:  1.4434900283813477
mini_batch_src_global generation:  2.0051441192626953
r_  generation:  25.599462032318115
local_output_nid generation:  0.7334117889404297
local_in_edges_tensor generation:  1.9250504970550537
mini_batch_src_global generation:  2.690711498260498
r_  generation:  26.204381227493286
----------------------check_connections_block total spend ----------------------------- 71.6944932937622
generate_one_block  35.391058921813965
generate_one_block  36.04906487464905
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4248151779174805  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.59600448608398
block generation total time  153.22090339660645
average batch blocks generation time:  76.61045169830322
block dataloader generation time/epoch 367.3656262849507
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38896989822387695 |1.3137149810791016 |0.004832148551940918 |0.0001704692840576172 |0.004975318908691406 |0.0022301673889160156 |
----------------------------------------------------------pseudo_mini_loss sum 1.0784095525741577
Total (block generation + training)time/epoch 371.16216891690306
Training time/epoch 3.8383030891418457
Training time without block to device /epoch 1.2108731269836426
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.73it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.35it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.68it/s] 40%|████      | 10/25 [00:00<00:00, 17.82it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.82it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.95it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.01it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.08it/s] 80%|████████  | 20/25 [00:01<00:00, 18.16it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.13it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.14it/s]100%|██████████| 25/25 [00:01<00:00, 18.14it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.55it/s] 20%|██        | 5/25 [00:00<00:03,  6.57it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.54it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.46it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.48it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.52it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.51it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.48it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.49it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.43it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.28it/s]  8%|▊         | 2/25 [00:00<00:03,  5.91it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.71it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.95it/s] 20%|██        | 5/25 [00:00<00:03,  6.07it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.16it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.24it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.29it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.33it/s] 40%|████      | 10/25 [00:01<00:02,  6.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.37it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.38it/s] 60%|██████    | 15/25 [00:02<00:01,  6.37it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.36it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.37it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.32it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.33it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]
Run 00 | Epoch 00019 | Loss 1.0784 | Train 0.5990 | Val 0.5839 | Test 0.4421
Number of nodes during this epoch:  4637249
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428520202636719  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1228244304656982
range selection method range initialization spend 0.025723934173583984
time for parepare:  0.3776264190673828
local_output_nid generation:  0.0260775089263916
local_in_edges_tensor generation:  0.19248509407043457
mini_batch_src_global generation:  0.3703649044036865
r_  generation:  5.388568162918091
local_output_nid generation:  0.02734851837158203
local_in_edges_tensor generation:  0.2119762897491455
mini_batch_src_global generation:  0.4646129608154297
r_  generation:  5.6071484088897705
----------------------check_connections_block total spend ----------------------------- 14.287994623184204
generate_one_block  7.130496025085449
generate_one_block  6.951176404953003
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9119503498077393
gen group dst list time:  0.08715271949768066
time for parepare:  0.43868589401245117
local_output_nid generation:  0.24753928184509277
local_in_edges_tensor generation:  1.7575626373291016
mini_batch_src_global generation:  2.4891531467437744
r_  generation:  29.917312622070312
local_output_nid generation:  0.5184047222137451
local_in_edges_tensor generation:  2.086463212966919
mini_batch_src_global generation:  3.4743988513946533
r_  generation:  30.375025749206543
----------------------check_connections_block total spend ----------------------------- 83.40883421897888
generate_one_block  41.38466191291809
generate_one_block  41.23064827919006
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.19844388961792
gen group dst list time:  0.18390178680419922
time for parepare:  0.4627041816711426
local_output_nid generation:  0.37634921073913574
local_in_edges_tensor generation:  1.4419662952423096
mini_batch_src_global generation:  2.0176451206207275
r_  generation:  25.47696089744568
local_output_nid generation:  0.7568817138671875
local_in_edges_tensor generation:  1.9491679668426514
mini_batch_src_global generation:  3.0289716720581055
r_  generation:  25.949880838394165
----------------------check_connections_block total spend ----------------------------- 71.55491280555725
generate_one_block  35.359670639038086
generate_one_block  35.70921325683594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428520202636719  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.96374702453613
block generation total time  153.68419408798218
average batch blocks generation time:  76.84209704399109
block dataloader generation time/epoch 367.3164054274559
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3817065954208374 |1.3932751417160034 |0.005151271820068359 |0.00018358230590820312 |0.005194425582885742 |0.002224445343017578 |
----------------------------------------------------------pseudo_mini_loss sum 1.0419528484344482
Total (block generation + training)time/epoch 371.1226595044136
Training time/epoch 3.990614652633667
Training time without block to device /epoch 1.2040643692016602
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.00it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.31it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.09it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.29it/s] 40%|████      | 10/25 [00:00<00:01, 13.82it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.88it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.76it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.32it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.70it/s] 80%|████████  | 20/25 [00:01<00:00, 17.03it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.36it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.57it/s]100%|██████████| 25/25 [00:01<00:00, 16.79it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.83it/s]  8%|▊         | 2/25 [00:00<00:04,  4.98it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.81it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.44it/s] 20%|██        | 5/25 [00:00<00:03,  5.80it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.49it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.88it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.16it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.25it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.56it/s] 48%|████▊     | 12/25 [00:02<00:01,  6.65it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.70it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.73it/s] 60%|██████    | 15/25 [00:02<00:01,  6.80it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.84it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.85it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.77it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.84it/s] 80%|████████  | 20/25 [00:03<00:00,  6.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.86it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.46it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.82it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.10it/s]100%|██████████| 25/25 [00:04<00:00,  6.24it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.45it/s]  8%|▊         | 2/25 [00:00<00:03,  6.66it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.69it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.91it/s] 20%|██        | 5/25 [00:00<00:03,  5.51it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.79it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.06it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.28it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.56it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.58it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.05it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.68it/s] 60%|██████    | 15/25 [00:02<00:01,  5.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  4.98it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.23it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.24it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.18it/s] 80%|████████  | 20/25 [00:03<00:00,  5.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.82it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.03it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.23it/s]100%|██████████| 25/25 [00:04<00:00,  6.71it/s]100%|██████████| 25/25 [00:04<00:00,  5.93it/s]
Run 00 | Epoch 00020 | Loss 1.0420 | Train 0.6097 | Val 0.5941 | Test 0.4505
Number of nodes during this epoch:  4637882
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424576282501221  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1051881313323975
range selection method range initialization spend 0.030086994171142578
time for parepare:  0.38099169731140137
local_output_nid generation:  0.02758336067199707
local_in_edges_tensor generation:  0.17910099029541016
mini_batch_src_global generation:  0.37467336654663086
r_  generation:  5.706289768218994
local_output_nid generation:  0.030666112899780273
local_in_edges_tensor generation:  0.24390554428100586
mini_batch_src_global generation:  0.47288012504577637
r_  generation:  5.900096416473389
----------------------check_connections_block total spend ----------------------------- 14.93092679977417
generate_one_block  7.2126665115356445
generate_one_block  6.976695775985718
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.897749423980713
gen group dst list time:  0.08645439147949219
time for parepare:  0.46867871284484863
local_output_nid generation:  0.2583351135253906
local_in_edges_tensor generation:  1.741598129272461
mini_batch_src_global generation:  2.5579562187194824
r_  generation:  29.861328840255737
local_output_nid generation:  0.5206773281097412
local_in_edges_tensor generation:  2.1958014965057373
mini_batch_src_global generation:  3.489104747772217
r_  generation:  30.24070978164673
----------------------check_connections_block total spend ----------------------------- 83.06961512565613
generate_one_block  40.926090717315674
generate_one_block  41.05070877075195
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.104372262954712
gen group dst list time:  0.19010591506958008
time for parepare:  0.4720149040222168
local_output_nid generation:  0.4010007381439209
local_in_edges_tensor generation:  1.5272278785705566
mini_batch_src_global generation:  2.0833382606506348
r_  generation:  26.168773889541626
local_output_nid generation:  0.739630937576294
local_in_edges_tensor generation:  1.975165843963623
mini_batch_src_global generation:  2.8126301765441895
r_  generation:  25.956883192062378
----------------------check_connections_block total spend ----------------------------- 72.13205909729004
generate_one_block  35.20272874832153
generate_one_block  36.1740186214447
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424576282501221  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.20167422294617
block generation total time  153.35354685783386
average batch blocks generation time:  76.67677342891693
block dataloader generation time/epoch 367.3193142073495
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3913228511810303 |1.317592740058899 |0.0045070648193359375 |0.00015211105346679688 |0.005177140235900879 |0.0014030933380126953 |
----------------------------------------------------------pseudo_mini_loss sum 1.0011494159698486
Total (block generation + training)time/epoch 371.1276611714136
Training time/epoch 3.8500399589538574
Training time without block to device /epoch 1.2148544788360596
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.85it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.45it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.62it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.11it/s] 40%|████      | 10/25 [00:00<00:00, 17.45it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.66it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.83it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.90it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.90it/s] 80%|████████  | 20/25 [00:01<00:00, 17.01it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.29it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.46it/s]100%|██████████| 25/25 [00:01<00:00, 17.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.75it/s]  8%|▊         | 2/25 [00:00<00:03,  6.82it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.96it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.61it/s] 20%|██        | 5/25 [00:00<00:03,  5.38it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.13it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.95it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.71it/s] 40%|████      | 10/25 [00:01<00:02,  5.53it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.58it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.81it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.91it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.53it/s] 60%|██████    | 15/25 [00:02<00:01,  5.80it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.09it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.25it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.11it/s] 80%|████████  | 20/25 [00:03<00:00,  6.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.30it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.29it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.47it/s]100%|██████████| 25/25 [00:04<00:00,  7.22it/s]100%|██████████| 25/25 [00:04<00:00,  6.01it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.73it/s]  8%|▊         | 2/25 [00:00<00:04,  5.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.09it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.19it/s] 20%|██        | 5/25 [00:00<00:03,  6.34it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.39it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.49it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.45it/s] 40%|████      | 10/25 [00:01<00:02,  5.80it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.39it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.70it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.99it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.18it/s] 60%|██████    | 15/25 [00:02<00:01,  6.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.36it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.45it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.56it/s] 80%|████████  | 20/25 [00:03<00:00,  6.57it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.57it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]
Run 00 | Epoch 00021 | Loss 1.0011 | Train 0.6193 | Val 0.6046 | Test 0.4582
Number of nodes during this epoch:  4637914
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426380157470703  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1065869331359863
range selection method range initialization spend 0.027212858200073242
time for parepare:  0.36272192001342773
local_output_nid generation:  0.02582240104675293
local_in_edges_tensor generation:  0.20102286338806152
mini_batch_src_global generation:  0.3716707229614258
r_  generation:  5.5180299282073975
local_output_nid generation:  0.030192136764526367
local_in_edges_tensor generation:  0.22995424270629883
mini_batch_src_global generation:  0.45993804931640625
r_  generation:  5.786044597625732
----------------------check_connections_block total spend ----------------------------- 14.659240484237671
generate_one_block  7.183840274810791
generate_one_block  6.870887994766235
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.770907402038574
gen group dst list time:  0.09181976318359375
time for parepare:  0.43920063972473145
local_output_nid generation:  0.23720598220825195
local_in_edges_tensor generation:  1.7168614864349365
mini_batch_src_global generation:  2.4587199687957764
r_  generation:  29.570945501327515
local_output_nid generation:  0.5127944946289062
local_in_edges_tensor generation:  2.055433988571167
mini_batch_src_global generation:  3.4692037105560303
r_  generation:  30.0339195728302
----------------------check_connections_block total spend ----------------------------- 82.40355181694031
generate_one_block  40.851677894592285
generate_one_block  40.894673109054565
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.159350633621216
gen group dst list time:  0.18193531036376953
time for parepare:  0.45203542709350586
local_output_nid generation:  0.36336851119995117
local_in_edges_tensor generation:  1.4463918209075928
mini_batch_src_global generation:  1.990962028503418
r_  generation:  25.762998342514038
local_output_nid generation:  0.7108490467071533
local_in_edges_tensor generation:  1.9595768451690674
mini_batch_src_global generation:  2.7701704502105713
r_  generation:  25.916475296020508
----------------------check_connections_block total spend ----------------------------- 71.567138671875
generate_one_block  35.12809443473816
generate_one_block  35.507911920547485
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426380157470703  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.9706904888153
block generation total time  152.3823573589325
average batch blocks generation time:  76.19117867946625
block dataloader generation time/epoch 367.2071553143588
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38807177543640137 |1.339511752128601 |0.004315495491027832 |0.00014579296112060547 |0.004957079887390137 |0.002953052520751953 |
----------------------------------------------------------pseudo_mini_loss sum 0.9696594476699829
Total (block generation + training)time/epoch 371.0188894596967
Training time/epoch 3.882704257965088
Training time without block to device /epoch 1.2036807537078857
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.37it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.64it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.33it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.70it/s] 40%|████      | 10/25 [00:00<00:00, 17.89it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.12it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.18it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.22it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.28it/s] 80%|████████  | 20/25 [00:01<00:00, 18.28it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.35it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.35it/s]100%|██████████| 25/25 [00:01<00:00, 18.28it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.55it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.59it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.61it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.61it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.59it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.60it/s] 40%|████      | 10/25 [00:01<00:02,  6.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.59it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.59it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.61it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.60it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.60it/s] 80%|████████  | 20/25 [00:03<00:00,  6.61it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.57it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.54it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.56it/s]100%|██████████| 25/25 [00:03<00:00,  6.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.48it/s] 40%|████      | 10/25 [00:01<00:02,  6.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.53it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.55it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.55it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.49it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
Run 00 | Epoch 00022 | Loss 0.9697 | Train 0.6281 | Val 0.6133 | Test 0.4655
Number of nodes during this epoch:  4636818
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425643444061279  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.038163661956787
range selection method range initialization spend 0.02560138702392578
time for parepare:  0.35571980476379395
local_output_nid generation:  0.02567124366760254
local_in_edges_tensor generation:  0.17578625679016113
mini_batch_src_global generation:  0.35657334327697754
r_  generation:  5.340149402618408
local_output_nid generation:  0.026444435119628906
local_in_edges_tensor generation:  0.19196486473083496
mini_batch_src_global generation:  0.4629485607147217
r_  generation:  5.535818338394165
----------------------check_connections_block total spend ----------------------------- 14.040406465530396
generate_one_block  6.667430639266968
generate_one_block  6.905993938446045
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.838759183883667
gen group dst list time:  0.08448219299316406
time for parepare:  0.4072554111480713
local_output_nid generation:  0.220475435256958
local_in_edges_tensor generation:  1.5743234157562256
mini_batch_src_global generation:  2.4064366817474365
r_  generation:  28.532577514648438
local_output_nid generation:  0.49399304389953613
local_in_edges_tensor generation:  2.328671455383301
mini_batch_src_global generation:  3.513469934463501
r_  generation:  29.962903022766113
----------------------check_connections_block total spend ----------------------------- 81.09712862968445
generate_one_block  40.634082078933716
generate_one_block  40.990962505340576
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2017431259155273
gen group dst list time:  0.19522666931152344
time for parepare:  0.48128414154052734
local_output_nid generation:  0.4116034507751465
local_in_edges_tensor generation:  1.5075831413269043
mini_batch_src_global generation:  2.0120325088500977
r_  generation:  25.864251375198364
local_output_nid generation:  0.7461392879486084
local_in_edges_tensor generation:  2.064002513885498
mini_batch_src_global generation:  2.9284756183624268
r_  generation:  26.76457142829895
----------------------check_connections_block total spend ----------------------------- 73.16810154914856
generate_one_block  36.734336614608765
generate_one_block  37.37377858161926
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425643444061279  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.265230178833
block generation total time  155.73315978050232
average batch blocks generation time:  77.86657989025116
block dataloader generation time/epoch 367.1684443121371
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3966381549835205 |1.4831326007843018 |0.004874110221862793 |0.00016868114471435547 |0.0050504207611083984 |0.0022842884063720703 |
----------------------------------------------------------pseudo_mini_loss sum 0.9383573532104492
Total (block generation + training)time/epoch 370.9965828812641
Training time/epoch 4.188868999481201
Training time without block to device /epoch 1.2226037979125977
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.21it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.60it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.18it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.47it/s] 40%|████      | 10/25 [00:00<00:00, 16.64it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.69it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.82it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.84it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.86it/s] 80%|████████  | 20/25 [00:01<00:00, 16.91it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.96it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.98it/s]100%|██████████| 25/25 [00:01<00:00, 16.94it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.27it/s]  8%|▊         | 2/25 [00:00<00:03,  6.24it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.14it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.20it/s] 20%|██        | 5/25 [00:00<00:03,  6.20it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.22it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.23it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.22it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.23it/s] 40%|████      | 10/25 [00:01<00:02,  6.24it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.24it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.26it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.25it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.24it/s] 60%|██████    | 15/25 [00:02<00:01,  6.26it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.26it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.27it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.26it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.27it/s] 80%|████████  | 20/25 [00:03<00:00,  6.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.20it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.21it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.24it/s]100%|██████████| 25/25 [00:03<00:00,  7.04it/s]100%|██████████| 25/25 [00:03<00:00,  6.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.76it/s]  8%|▊         | 2/25 [00:00<00:03,  6.01it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.09it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.13it/s] 20%|██        | 5/25 [00:00<00:03,  6.16it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.18it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.19it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.19it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.19it/s] 40%|████      | 10/25 [00:01<00:02,  6.19it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.20it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.22it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.23it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.21it/s] 60%|██████    | 15/25 [00:02<00:01,  6.22it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.19it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.18it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.18it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.16it/s] 80%|████████  | 20/25 [00:03<00:00,  6.17it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.16it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.17it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.16it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.16it/s]100%|██████████| 25/25 [00:03<00:00,  6.83it/s]100%|██████████| 25/25 [00:03<00:00,  6.25it/s]
Run 00 | Epoch 00023 | Loss 0.9384 | Train 0.6365 | Val 0.6209 | Test 0.4720
Number of nodes during this epoch:  4637645
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424739360809326  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1240384578704834
range selection method range initialization spend 0.028128862380981445
time for parepare:  0.3706071376800537
local_output_nid generation:  0.026077747344970703
local_in_edges_tensor generation:  0.23062610626220703
mini_batch_src_global generation:  0.3805117607116699
r_  generation:  5.5368359088897705
local_output_nid generation:  0.04125809669494629
local_in_edges_tensor generation:  0.22725677490234375
mini_batch_src_global generation:  0.4572408199310303
r_  generation:  5.910058498382568
----------------------check_connections_block total spend ----------------------------- 14.972382068634033
generate_one_block  7.655592918395996
generate_one_block  7.4095165729522705
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.893190383911133
gen group dst list time:  0.09300613403320312
time for parepare:  0.43767213821411133
local_output_nid generation:  0.239485502243042
local_in_edges_tensor generation:  1.7354977130889893
mini_batch_src_global generation:  2.5439038276672363
r_  generation:  30.367822885513306
local_output_nid generation:  0.5419018268585205
local_in_edges_tensor generation:  2.4393582344055176
mini_batch_src_global generation:  3.761746644973755
r_  generation:  30.735036849975586
----------------------check_connections_block total spend ----------------------------- 86.4293737411499
generate_one_block  42.81916069984436
generate_one_block  42.92970538139343
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2857937812805176
gen group dst list time:  0.1835935115814209
time for parepare:  0.45509886741638184
local_output_nid generation:  0.3773012161254883
local_in_edges_tensor generation:  1.5107758045196533
mini_batch_src_global generation:  2.0576488971710205
r_  generation:  26.514899492263794
local_output_nid generation:  0.7378180027008057
local_in_edges_tensor generation:  1.970445156097412
mini_batch_src_global generation:  3.337218761444092
r_  generation:  27.164153814315796
----------------------check_connections_block total spend ----------------------------- 74.7888674736023
generate_one_block  36.7863712310791
generate_one_block  37.3222553730011
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424739360809326  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  161.2182412147522
block generation total time  159.857492685318
average batch blocks generation time:  79.928746342659
block dataloader generation time/epoch 367.756538639466
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3799283504486084 |1.4046248197555542 |0.004919171333312988 |0.00017702579498291016 |0.005220890045166016 |0.001955747604370117 |
----------------------------------------------------------pseudo_mini_loss sum 0.9045685529708862
Total (block generation + training)time/epoch 371.59231399496394
Training time/epoch 4.0112624168396
Training time without block to device /epoch 1.2020127773284912
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.90it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.33it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.86it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.18it/s] 40%|████      | 10/25 [00:00<00:00, 16.21it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.85it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.40it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.81it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.22it/s] 80%|████████  | 20/25 [00:01<00:00, 17.27it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.26it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.99it/s]100%|██████████| 25/25 [00:01<00:00, 17.10it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.19it/s]  8%|▊         | 2/25 [00:00<00:04,  5.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.66it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.00it/s] 20%|██        | 5/25 [00:00<00:03,  6.15it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.27it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.34it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.43it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.98it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.73it/s]100%|██████████| 25/25 [00:03<00:00,  6.29it/s]100%|██████████| 25/25 [00:03<00:00,  6.26it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.78it/s]  8%|▊         | 2/25 [00:00<00:04,  5.43it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.80it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.76it/s] 20%|██        | 5/25 [00:00<00:03,  5.90it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.80it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.80it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.94it/s] 40%|████      | 10/25 [00:01<00:02,  6.07it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.16it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.13it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.14it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.09it/s] 60%|██████    | 15/25 [00:02<00:01,  6.16it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.89it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.73it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.79it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.90it/s] 80%|████████  | 20/25 [00:03<00:00,  6.02it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.12it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.10it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.18it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.22it/s]100%|██████████| 25/25 [00:04<00:00,  7.00it/s]100%|██████████| 25/25 [00:04<00:00,  6.06it/s]
Run 00 | Epoch 00024 | Loss 0.9046 | Train 0.6438 | Val 0.6281 | Test 0.4780
Number of nodes during this epoch:  4637261
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422412395477295  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.182471513748169
range selection method range initialization spend 0.02546405792236328
time for parepare:  0.3701791763305664
local_output_nid generation:  0.025852203369140625
local_in_edges_tensor generation:  0.1761331558227539
mini_batch_src_global generation:  0.36121630668640137
r_  generation:  5.583650827407837
local_output_nid generation:  0.027872800827026367
local_in_edges_tensor generation:  0.23300504684448242
mini_batch_src_global generation:  0.48042774200439453
r_  generation:  5.85498571395874
----------------------check_connections_block total spend ----------------------------- 14.847331047058105
generate_one_block  7.444345235824585
generate_one_block  7.455210447311401
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.019363641738892
gen group dst list time:  0.09563612937927246
time for parepare:  0.4448549747467041
local_output_nid generation:  0.2455909252166748
local_in_edges_tensor generation:  1.565356969833374
mini_batch_src_global generation:  2.440256118774414
r_  generation:  29.338685989379883
local_output_nid generation:  0.526566743850708
local_in_edges_tensor generation:  2.103095293045044
mini_batch_src_global generation:  3.6450047492980957
r_  generation:  30.339372396469116
----------------------check_connections_block total spend ----------------------------- 82.23622059822083
generate_one_block  41.36703872680664
generate_one_block  41.301162242889404
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.090440273284912
gen group dst list time:  0.19131779670715332
time for parepare:  0.4629678726196289
local_output_nid generation:  0.3984074592590332
local_in_edges_tensor generation:  1.4656281471252441
mini_batch_src_global generation:  2.009227752685547
r_  generation:  25.714292764663696
local_output_nid generation:  0.7388226985931396
local_in_edges_tensor generation:  2.152874231338501
mini_batch_src_global generation:  2.789900541305542
r_  generation:  26.408982515335083
----------------------check_connections_block total spend ----------------------------- 72.22466707229614
generate_one_block  35.38241672515869
generate_one_block  35.938624143600464
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422412395477295  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.46088767051697
block generation total time  153.9892418384552
average batch blocks generation time:  76.9946209192276
block dataloader generation time/epoch 367.7687910652161
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38783812522888184 |1.2283544540405273 |0.004666924476623535 |0.00016188621520996094 |0.005057096481323242 |0.0015254020690917969 |
----------------------------------------------------------pseudo_mini_loss sum 0.8776700496673584
Total (block generation + training)time/epoch 371.59766848564146
Training time/epoch 3.6631715297698975
Training time without block to device /epoch 1.2064626216888428
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.57it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.85it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.07it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.34it/s] 40%|████      | 10/25 [00:00<00:01, 13.87it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.84it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.60it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.09it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.67it/s] 80%|████████  | 20/25 [00:01<00:00, 16.85it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.11it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.29it/s]100%|██████████| 25/25 [00:01<00:00, 16.73it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.16it/s]  8%|▊         | 2/25 [00:00<00:03,  6.53it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.84it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.51it/s] 20%|██        | 5/25 [00:00<00:03,  5.64it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.37it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.74it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.04it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.22it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.04it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.75it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.57it/s] 60%|██████    | 15/25 [00:02<00:01,  5.43it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.71it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.91it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.10it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.81it/s] 80%|████████  | 20/25 [00:03<00:00,  5.61it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.69it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.95it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.16it/s]100%|██████████| 25/25 [00:04<00:00,  6.00it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.51it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.57it/s] 20%|██        | 5/25 [00:00<00:03,  6.58it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.62it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.61it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.63it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.63it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.12it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.69it/s] 60%|██████    | 15/25 [00:02<00:01,  5.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.31it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.13it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.12it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.12it/s] 80%|████████  | 20/25 [00:03<00:00,  5.11it/s] 84%|████████▍ | 21/25 [00:03<00:00,  4.99it/s] 88%|████████▊ | 22/25 [00:03<00:00,  4.99it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.35it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.62it/s]100%|██████████| 25/25 [00:04<00:00,  5.93it/s]
Run 00 | Epoch 00025 | Loss 0.8777 | Train 0.6503 | Val 0.6350 | Test 0.4834
Number of nodes during this epoch:  4637662
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427502155303955  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.157867431640625
range selection method range initialization spend 0.025227069854736328
time for parepare:  0.3600351810455322
local_output_nid generation:  0.025487899780273438
local_in_edges_tensor generation:  0.21912574768066406
mini_batch_src_global generation:  0.3803367614746094
r_  generation:  5.43723201751709
local_output_nid generation:  0.027767658233642578
local_in_edges_tensor generation:  0.19505572319030762
mini_batch_src_global generation:  0.46017932891845703
r_  generation:  5.675008535385132
----------------------check_connections_block total spend ----------------------------- 14.45456314086914
generate_one_block  7.352240562438965
generate_one_block  6.98803448677063
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.107369661331177
gen group dst list time:  0.09121108055114746
time for parepare:  0.4263114929199219
local_output_nid generation:  0.22238874435424805
local_in_edges_tensor generation:  1.566326379776001
mini_batch_src_global generation:  2.426196336746216
r_  generation:  28.843207359313965
local_output_nid generation:  0.5052804946899414
local_in_edges_tensor generation:  2.05035662651062
mini_batch_src_global generation:  3.436124563217163
r_  generation:  29.855987548828125
----------------------check_connections_block total spend ----------------------------- 80.96586394309998
generate_one_block  40.78561973571777
generate_one_block  40.89050102233887
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2262771129608154
gen group dst list time:  0.19003057479858398
time for parepare:  0.47034263610839844
local_output_nid generation:  0.397707462310791
local_in_edges_tensor generation:  1.5090515613555908
mini_batch_src_global generation:  2.169480800628662
r_  generation:  26.09587812423706
local_output_nid generation:  0.7254300117492676
local_in_edges_tensor generation:  1.927567720413208
mini_batch_src_global generation:  2.8085274696350098
r_  generation:  26.050219297409058
----------------------check_connections_block total spend ----------------------------- 72.26002049446106
generate_one_block  35.19477200508118
generate_one_block  35.898070096969604
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427502155303955  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.22588443756104
block generation total time  152.76896286010742
average batch blocks generation time:  76.38448143005371
block dataloader generation time/epoch 367.65595161914825
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37435317039489746 |1.1093167066574097 |0.004318356513977051 |0.00014662742614746094 |0.00502777099609375 |0.0016908645629882812 |
----------------------------------------------------------pseudo_mini_loss sum 0.8496858477592468
Total (block generation + training)time/epoch 371.4681425553102
Training time/epoch 3.3948721885681152
Training time without block to device /epoch 1.176238775253296
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.07it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.81it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.31it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.56it/s] 40%|████      | 10/25 [00:00<00:00, 17.62it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.78it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.93it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.04it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.06it/s] 80%|████████  | 20/25 [00:01<00:00, 18.02it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.90it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.70it/s]100%|██████████| 25/25 [00:01<00:00, 17.91it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.11it/s]  8%|▊         | 2/25 [00:00<00:04,  5.60it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.83it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.96it/s] 20%|██        | 5/25 [00:00<00:03,  6.05it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.12it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.15it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.17it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.98it/s] 40%|████      | 10/25 [00:01<00:02,  6.06it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.11it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.14it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.91it/s] 60%|██████    | 15/25 [00:02<00:01,  7.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  7.65it/s] 68%|██████▊   | 17/25 [00:02<00:01,  7.54it/s] 72%|███████▏  | 18/25 [00:02<00:00,  7.63it/s] 76%|███████▌  | 19/25 [00:02<00:00,  7.80it/s] 80%|████████  | 20/25 [00:02<00:00,  7.77it/s] 84%|████████▍ | 21/25 [00:03<00:00,  7.87it/s] 88%|████████▊ | 22/25 [00:03<00:00,  7.19it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.74it/s] 96%|█████████▌| 24/25 [00:03<00:00,  7.09it/s]100%|██████████| 25/25 [00:03<00:00,  6.83it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.80it/s]  8%|▊         | 2/25 [00:00<00:03,  6.00it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.05it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.10it/s] 20%|██        | 5/25 [00:00<00:03,  6.12it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.13it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.14it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.14it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.10it/s] 40%|████      | 10/25 [00:01<00:02,  5.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.42it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.10it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.64it/s] 60%|██████    | 15/25 [00:02<00:01,  7.11it/s] 64%|██████▍   | 16/25 [00:02<00:01,  7.06it/s] 68%|██████▊   | 17/25 [00:02<00:01,  7.30it/s] 72%|███████▏  | 18/25 [00:02<00:00,  7.50it/s] 76%|███████▌  | 19/25 [00:02<00:00,  7.71it/s] 80%|████████  | 20/25 [00:03<00:00,  7.19it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.69it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.24it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.53it/s]
Run 00 | Epoch 00026 | Loss 0.8497 | Train 0.6563 | Val 0.6410 | Test 0.4880
Number of nodes during this epoch:  4637189
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4273858070373535  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0728459358215332
range selection method range initialization spend 0.028048276901245117
time for parepare:  0.38759899139404297
local_output_nid generation:  0.02580738067626953
local_in_edges_tensor generation:  0.18256020545959473
mini_batch_src_global generation:  0.4034559726715088
r_  generation:  5.583824634552002
local_output_nid generation:  0.028766393661499023
local_in_edges_tensor generation:  0.23950815200805664
mini_batch_src_global generation:  0.4610161781311035
r_  generation:  5.855825185775757
----------------------check_connections_block total spend ----------------------------- 14.812989711761475
generate_one_block  7.231745958328247
generate_one_block  7.00180459022522
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9500811100006104
gen group dst list time:  0.09407711029052734
time for parepare:  0.4636843204498291
local_output_nid generation:  0.2610001564025879
local_in_edges_tensor generation:  1.6302425861358643
mini_batch_src_global generation:  2.49686861038208
r_  generation:  29.92277717590332
local_output_nid generation:  0.5187170505523682
local_in_edges_tensor generation:  2.217702627182007
mini_batch_src_global generation:  3.475271701812744
r_  generation:  30.173260927200317
----------------------check_connections_block total spend ----------------------------- 83.11721301078796
generate_one_block  41.13013696670532
generate_one_block  41.05788779258728
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1286580562591553
gen group dst list time:  0.19260573387145996
time for parepare:  0.4643857479095459
local_output_nid generation:  0.37664055824279785
local_in_edges_tensor generation:  1.525066614151001
mini_batch_src_global generation:  2.0969302654266357
r_  generation:  26.830668210983276
local_output_nid generation:  0.7257180213928223
local_in_edges_tensor generation:  1.9356777667999268
mini_batch_src_global generation:  2.8229665756225586
r_  generation:  26.446165800094604
----------------------check_connections_block total spend ----------------------------- 73.19706726074219
generate_one_block  35.14649987220764
generate_one_block  35.94916558265686
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4273858070373535  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.31428027153015
block generation total time  153.2836902141571
average batch blocks generation time:  76.64184510707855
block dataloader generation time/epoch 367.6831230852339
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38178467750549316 |1.1201075315475464 |0.004359841346740723 |0.0001474618911743164 |0.005244255065917969 |0.00193023681640625 |
----------------------------------------------------------pseudo_mini_loss sum 0.822662353515625
Total (block generation + training)time/epoch 371.4813279840681
Training time/epoch 3.4344091415405273
Training time without block to device /epoch 1.1941940784454346
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.33it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.78it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.20it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.62it/s] 40%|████      | 10/25 [00:00<00:00, 17.82it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.93it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.78it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.78it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.89it/s] 80%|████████  | 20/25 [00:01<00:00, 17.80it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.94it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.05it/s]100%|██████████| 25/25 [00:01<00:00, 17.84it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.09it/s]  8%|▊         | 2/25 [00:00<00:04,  5.12it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.14it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.16it/s] 20%|██        | 5/25 [00:00<00:03,  5.15it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.14it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.16it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.17it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.17it/s] 40%|████      | 10/25 [00:01<00:02,  5.17it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.04it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.95it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.68it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.90it/s] 60%|██████    | 15/25 [00:02<00:01,  5.23it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.19it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.51it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.83it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.58it/s] 80%|████████  | 20/25 [00:03<00:00,  5.74it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.38it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.07it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.10it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.09it/s]100%|██████████| 25/25 [00:04<00:00,  5.96it/s]100%|██████████| 25/25 [00:04<00:00,  5.28it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:06,  3.88it/s]  8%|▊         | 2/25 [00:00<00:05,  4.25it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.46it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.02it/s] 20%|██        | 5/25 [00:01<00:03,  5.45it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.76it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.96it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.12it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.25it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.42it/s] 48%|████▊     | 12/25 [00:02<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.56it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.57it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.59it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.59it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.59it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.60it/s] 80%|████████  | 20/25 [00:03<00:00,  6.60it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.59it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.60it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.59it/s]100%|██████████| 25/25 [00:03<00:00,  6.30it/s]
Run 00 | Epoch 00027 | Loss 0.8227 | Train 0.6614 | Val 0.6457 | Test 0.4922
Number of nodes during this epoch:  4637727
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430037021636963  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0888943672180176
range selection method range initialization spend 0.024617671966552734
time for parepare:  0.3532752990722656
local_output_nid generation:  0.02558588981628418
local_in_edges_tensor generation:  0.19024157524108887
mini_batch_src_global generation:  0.3694155216217041
r_  generation:  5.638093709945679
local_output_nid generation:  0.02837395668029785
local_in_edges_tensor generation:  0.23945283889770508
mini_batch_src_global generation:  0.46783876419067383
r_  generation:  5.847030162811279
----------------------check_connections_block total spend ----------------------------- 14.818661212921143
generate_one_block  7.134332895278931
generate_one_block  6.812468767166138
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9416258335113525
gen group dst list time:  0.0863809585571289
time for parepare:  0.4280061721801758
local_output_nid generation:  0.23873090744018555
local_in_edges_tensor generation:  1.5251696109771729
mini_batch_src_global generation:  2.407883405685425
r_  generation:  28.925141096115112
local_output_nid generation:  0.4914066791534424
local_in_edges_tensor generation:  2.075181245803833
mini_batch_src_global generation:  3.396481513977051
r_  generation:  29.979294538497925
----------------------check_connections_block total spend ----------------------------- 81.00926995277405
generate_one_block  41.071380615234375
generate_one_block  41.09242630004883
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1924855709075928
gen group dst list time:  0.18696188926696777
time for parepare:  0.46196937561035156
local_output_nid generation:  0.3900003433227539
local_in_edges_tensor generation:  1.5338356494903564
mini_batch_src_global generation:  2.0878543853759766
r_  generation:  26.576740026474
local_output_nid generation:  0.7196540832519531
local_in_edges_tensor generation:  1.920055866241455
mini_batch_src_global generation:  2.800398826599121
r_  generation:  25.937318801879883
----------------------check_connections_block total spend ----------------------------- 72.43395972251892
generate_one_block  35.14755988121033
generate_one_block  35.75247311592102
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430037021636963  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.44322967529297
block generation total time  153.06383991241455
average batch blocks generation time:  76.53191995620728
block dataloader generation time/epoch 367.57913896015714
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3774075508117676 |1.310205340385437 |0.0043408870697021484 |0.00015246868133544922 |0.005190253257751465 |0.0016913414001464844 |
----------------------------------------------------------pseudo_mini_loss sum 0.797463059425354
Total (block generation + training)time/epoch 371.3775392004422
Training time/epoch 3.8035106658935547
Training time without block to device /epoch 1.1830999851226807
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.09it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.64it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.36it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:00, 17.92it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.96it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.95it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.96it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.03it/s] 80%|████████  | 20/25 [00:01<00:00, 18.10it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.10it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.15it/s]100%|██████████| 25/25 [00:01<00:00, 18.18it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.12it/s]  8%|▊         | 2/25 [00:00<00:04,  5.08it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.10it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.12it/s] 20%|██        | 5/25 [00:00<00:04,  4.94it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.97it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.16it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.59it/s] 40%|████      | 10/25 [00:01<00:02,  5.82it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.98it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.16it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.14it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.05it/s] 60%|██████    | 15/25 [00:02<00:01,  5.65it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.43it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.28it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.13it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.13it/s] 80%|████████  | 20/25 [00:03<00:00,  5.13it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.12it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.07it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.07it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.07it/s]100%|██████████| 25/25 [00:04<00:00,  5.86it/s]100%|██████████| 25/25 [00:04<00:00,  5.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.04it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.50it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.86it/s] 20%|██        | 5/25 [00:00<00:03,  5.49it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.23it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.03it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.47it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.81it/s] 40%|████      | 10/25 [00:01<00:02,  5.57it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.40it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.29it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.20it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.41it/s] 60%|██████    | 15/25 [00:02<00:01,  5.73it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.00it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.19it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.36it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  5.99it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.15it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.83it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.04it/s]100%|██████████| 25/25 [00:04<00:00,  5.91it/s]
Run 00 | Epoch 00028 | Loss 0.7975 | Train 0.6664 | Val 0.6508 | Test 0.4962
Number of nodes during this epoch:  4637094
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427761077880859  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0994486808776855
range selection method range initialization spend 0.02718830108642578
time for parepare:  0.37504029273986816
local_output_nid generation:  0.02547430992126465
local_in_edges_tensor generation:  0.20821595191955566
mini_batch_src_global generation:  0.38820362091064453
r_  generation:  5.578998565673828
local_output_nid generation:  0.028998851776123047
local_in_edges_tensor generation:  0.24471735954284668
mini_batch_src_global generation:  0.457470178604126
r_  generation:  5.890921115875244
----------------------check_connections_block total spend ----------------------------- 14.950908899307251
generate_one_block  7.251891136169434
generate_one_block  7.011272668838501
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.7651865482330322
gen group dst list time:  0.09082174301147461
time for parepare:  0.43711376190185547
local_output_nid generation:  0.24664902687072754
local_in_edges_tensor generation:  1.561241865158081
mini_batch_src_global generation:  2.418869733810425
r_  generation:  28.98793315887451
local_output_nid generation:  0.4826996326446533
local_in_edges_tensor generation:  2.2610180377960205
mini_batch_src_global generation:  3.4402358531951904
r_  generation:  29.985353231430054
----------------------check_connections_block total spend ----------------------------- 81.28537178039551
generate_one_block  41.426392555236816
generate_one_block  41.51229667663574
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1745998859405518
gen group dst list time:  0.18694758415222168
time for parepare:  0.43625831604003906
local_output_nid generation:  0.38646388053894043
local_in_edges_tensor generation:  1.462193250656128
mini_batch_src_global generation:  1.9973881244659424
r_  generation:  25.64873695373535
local_output_nid generation:  0.7339253425598145
local_in_edges_tensor generation:  2.1317458152770996
mini_batch_src_global generation:  2.783830404281616
r_  generation:  26.48959469795227
----------------------check_connections_block total spend ----------------------------- 72.05472230911255
generate_one_block  35.14337706565857
generate_one_block  36.111852407455444
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427761077880859  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.34009408950806
block generation total time  154.19391870498657
average batch blocks generation time:  77.09695935249329
block dataloader generation time/epoch 367.5527626563763
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3856947422027588 |1.4058417081832886 |0.004797577857971191 |0.00016927719116210938 |0.00510859489440918 |0.003975629806518555 |
----------------------------------------------------------pseudo_mini_loss sum 0.779053807258606
Total (block generation + training)time/epoch 371.35844344106215
Training time/epoch 4.009375095367432
Training time without block to device /epoch 1.1976916790008545
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.20it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.74it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.84it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.26it/s] 40%|████      | 10/25 [00:00<00:00, 17.55it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.71it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.86it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.73it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.89it/s] 80%|████████  | 20/25 [00:01<00:00, 17.22it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.57it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.35it/s]100%|██████████| 25/25 [00:01<00:00, 17.14it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.59it/s]  8%|▊         | 2/25 [00:00<00:03,  6.52it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.73it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.39it/s] 20%|██        | 5/25 [00:00<00:03,  5.22it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.14it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.99it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.95it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.33it/s] 40%|████      | 10/25 [00:01<00:02,  5.66it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.94it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.72it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.51it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.34it/s] 60%|██████    | 15/25 [00:02<00:01,  5.28it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.20it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.12it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.95it/s] 80%|████████  | 20/25 [00:03<00:00,  5.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.71it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.02it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.23it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.85it/s]100%|██████████| 25/25 [00:04<00:00,  6.31it/s]100%|██████████| 25/25 [00:04<00:00,  5.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.92it/s]  8%|▊         | 2/25 [00:00<00:03,  6.25it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.84it/s] 20%|██        | 5/25 [00:00<00:03,  5.48it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.79it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.08it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.68it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.47it/s] 40%|████      | 10/25 [00:01<00:02,  5.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.53it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.81it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.01it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.14it/s] 60%|██████    | 15/25 [00:02<00:01,  6.27it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.36it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:04<00:00,  7.20it/s]100%|██████████| 25/25 [00:04<00:00,  6.19it/s]
Run 00 | Epoch 00029 | Loss 0.7791 | Train 0.6705 | Val 0.6555 | Test 0.4999
Number of nodes during this epoch:  4637424
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4265265464782715  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1139471530914307
range selection method range initialization spend 0.025997400283813477
time for parepare:  0.3610391616821289
local_output_nid generation:  0.02556157112121582
local_in_edges_tensor generation:  0.20542263984680176
mini_batch_src_global generation:  0.3698866367340088
r_  generation:  5.393448114395142
local_output_nid generation:  0.027241230010986328
local_in_edges_tensor generation:  0.20983505249023438
mini_batch_src_global generation:  0.47368502616882324
r_  generation:  5.69822883605957
----------------------check_connections_block total spend ----------------------------- 14.466647386550903
generate_one_block  7.175795316696167
generate_one_block  6.803551435470581
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.103658199310303
gen group dst list time:  0.08705329895019531
time for parepare:  0.4452652931213379
local_output_nid generation:  0.2447965145111084
local_in_edges_tensor generation:  1.68695068359375
mini_batch_src_global generation:  2.440934896469116
r_  generation:  29.493659257888794
local_output_nid generation:  0.5120570659637451
local_in_edges_tensor generation:  2.098677396774292
mini_batch_src_global generation:  3.458496332168579
r_  generation:  29.856098890304565
----------------------check_connections_block total spend ----------------------------- 82.19496369361877
generate_one_block  40.88509130477905
generate_one_block  40.90141487121582
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.175438404083252
gen group dst list time:  0.19299006462097168
time for parepare:  0.48366856575012207
local_output_nid generation:  0.3965146541595459
local_in_edges_tensor generation:  1.5485479831695557
mini_batch_src_global generation:  2.0902912616729736
r_  generation:  26.268749475479126
local_output_nid generation:  0.7407577037811279
local_in_edges_tensor generation:  1.8976140022277832
mini_batch_src_global generation:  2.7931370735168457
r_  generation:  26.096977949142456
----------------------check_connections_block total spend ----------------------------- 72.45641279220581
generate_one_block  35.007282733917236
generate_one_block  35.85657477378845
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4265265464782715  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.65137648582458
block generation total time  152.65036368370056
average batch blocks generation time:  76.32518184185028
block dataloader generation time/epoch 367.4967202425003
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37120890617370605 |1.2868984937667847 |0.004312872886657715 |0.00014412403106689453 |0.004981040954589844 |0.0029506683349609375 |
----------------------------------------------------------pseudo_mini_loss sum 0.7526184320449829
Total (block generation + training)time/epoch 371.3003419160843
Training time/epoch 3.7437477111816406
Training time without block to device /epoch 1.1699507236480713
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.27it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.85it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.38it/s] 40%|████      | 10/25 [00:00<00:01, 13.88it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.09it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.25it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.06it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.70it/s] 80%|████████  | 20/25 [00:01<00:00, 17.00it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.11it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.34it/s]100%|██████████| 25/25 [00:01<00:00, 16.54it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.63it/s]  8%|▊         | 2/25 [00:00<00:04,  5.72it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.28it/s] 20%|██        | 5/25 [00:00<00:03,  5.21it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.17it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.03it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.23it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.26it/s] 40%|████      | 10/25 [00:01<00:02,  5.41it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.67it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.91it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.13it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.33it/s] 60%|██████    | 15/25 [00:02<00:01,  5.90it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.60it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.39it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.18it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.82it/s] 80%|████████  | 20/25 [00:03<00:01,  4.85it/s] 84%|████████▍ | 21/25 [00:03<00:00,  4.68it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.15it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.54it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.75it/s]100%|██████████| 25/25 [00:04<00:00,  6.30it/s]100%|██████████| 25/25 [00:04<00:00,  5.50it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.94it/s]  8%|▊         | 2/25 [00:00<00:03,  6.22it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.52it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.55it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.56it/s] 40%|████      | 10/25 [00:01<00:02,  6.58it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.53it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.50it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.55it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.24it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
Run 00 | Epoch 00030 | Loss 0.7526 | Train 0.6739 | Val 0.6597 | Test 0.5034
Number of nodes during this epoch:  4636851
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423566818237305  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1084694862365723
range selection method range initialization spend 0.02479100227355957
time for parepare:  0.3583219051361084
local_output_nid generation:  0.026949405670166016
local_in_edges_tensor generation:  0.22772908210754395
mini_batch_src_global generation:  0.37281179428100586
r_  generation:  5.590215444564819
local_output_nid generation:  0.02891993522644043
local_in_edges_tensor generation:  0.2435910701751709
mini_batch_src_global generation:  0.4683723449707031
r_  generation:  5.867314338684082
----------------------check_connections_block total spend ----------------------------- 14.921083450317383
generate_one_block  7.24272084236145
generate_one_block  6.9299986362457275
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.929008722305298
gen group dst list time:  0.09452700614929199
time for parepare:  0.4331362247467041
local_output_nid generation:  0.23441219329833984
local_in_edges_tensor generation:  1.5385160446166992
mini_batch_src_global generation:  2.4240128993988037
r_  generation:  29.005578756332397
local_output_nid generation:  0.5003211498260498
local_in_edges_tensor generation:  2.0725417137145996
mini_batch_src_global generation:  3.327528715133667
r_  generation:  29.80350971221924
----------------------check_connections_block total spend ----------------------------- 80.91786432266235
generate_one_block  41.438673973083496
generate_one_block  41.30584454536438
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.0935776233673096
gen group dst list time:  0.1802825927734375
time for parepare:  0.4210398197174072
local_output_nid generation:  0.37268519401550293
local_in_edges_tensor generation:  1.4268441200256348
mini_batch_src_global generation:  1.9943480491638184
r_  generation:  25.707740306854248
local_output_nid generation:  0.7267804145812988
local_in_edges_tensor generation:  2.045289993286133
mini_batch_src_global generation:  2.682675838470459
r_  generation:  25.94620108604431
----------------------check_connections_block total spend ----------------------------- 71.0335099697113
generate_one_block  35.21401119232178
generate_one_block  36.017043590545654
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423566818237305  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  151.95137429237366
block generation total time  153.9755733013153
average batch blocks generation time:  76.98778665065765
block dataloader generation time/epoch 367.43681811517285
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3927360773086548 |1.2675291299819946 |0.004389762878417969 |0.00015032291412353516 |0.005140185356140137 |0.0014996528625488281 |
----------------------------------------------------------pseudo_mini_loss sum 0.73827064037323
Total (block generation + training)time/epoch 371.2386934526505
Training time/epoch 3.749305248260498
Training time without block to device /epoch 1.2142469882965088
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.20it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.79it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.34it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.67it/s] 40%|████      | 10/25 [00:00<00:00, 17.91it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.07it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.18it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.21it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.11it/s] 80%|████████  | 20/25 [00:01<00:00, 18.14it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.16it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.23it/s]100%|██████████| 25/25 [00:01<00:00, 18.23it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.47it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.50it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  6.47it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.49it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.53it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.53it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.46it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.46it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.90it/s]  8%|▊         | 2/25 [00:00<00:04,  5.68it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.96it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.14it/s] 20%|██        | 5/25 [00:00<00:03,  6.27it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.35it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.38it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.37it/s] 40%|████      | 10/25 [00:01<00:02,  6.29it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.32it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.09it/s] 60%|██████    | 15/25 [00:02<00:01,  6.17it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.27it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.01it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.01it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.07it/s] 80%|████████  | 20/25 [00:03<00:00,  5.99it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.04it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.13it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.22it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.29it/s]100%|██████████| 25/25 [00:03<00:00,  6.32it/s]
Run 00 | Epoch 00031 | Loss 0.7383 | Train 0.6768 | Val 0.6629 | Test 0.5066
Number of nodes during this epoch:  4638074
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426424026489258  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1686227321624756
range selection method range initialization spend 0.023957490921020508
time for parepare:  0.362943172454834
local_output_nid generation:  0.026208877563476562
local_in_edges_tensor generation:  0.16722798347473145
mini_batch_src_global generation:  0.34685611724853516
r_  generation:  5.424220561981201
local_output_nid generation:  0.0307772159576416
local_in_edges_tensor generation:  0.19412827491760254
mini_batch_src_global generation:  0.4716942310333252
r_  generation:  5.5677173137664795
----------------------check_connections_block total spend ----------------------------- 14.2037353515625
generate_one_block  7.120159387588501
generate_one_block  7.112880706787109
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8780763149261475
gen group dst list time:  0.08762264251708984
time for parepare:  0.4341776371002197
local_output_nid generation:  0.2700066566467285
local_in_edges_tensor generation:  1.618330478668213
mini_batch_src_global generation:  2.512368679046631
r_  generation:  30.03706192970276
local_output_nid generation:  0.508908748626709
local_in_edges_tensor generation:  2.099330425262451
mini_batch_src_global generation:  3.735074758529663
r_  generation:  30.241143941879272
----------------------check_connections_block total spend ----------------------------- 83.3481559753418
generate_one_block  41.08135509490967
generate_one_block  41.11263871192932
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.157261848449707
gen group dst list time:  0.19240427017211914
time for parepare:  0.4496338367462158
local_output_nid generation:  0.3960459232330322
local_in_edges_tensor generation:  1.4775927066802979
mini_batch_src_global generation:  2.2427000999450684
r_  generation:  26.295668840408325
local_output_nid generation:  0.7285153865814209
local_in_edges_tensor generation:  2.0198347568511963
mini_batch_src_global generation:  2.8081653118133545
r_  generation:  26.214988946914673
----------------------check_connections_block total spend ----------------------------- 72.76000595092773
generate_one_block  35.31688046455383
generate_one_block  36.09698748588562
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426424026489258  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.10816192626953
block generation total time  153.60786175727844
average batch blocks generation time:  76.80393087863922
block dataloader generation time/epoch 367.43788580596447
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.28979766368865967 |1.3109893798828125 |0.053246498107910156 |0.00022268295288085938 |0.07635164260864258 |0.002277374267578125 |
----------------------------------------------------------pseudo_mini_loss sum 0.7209227681159973
Total (block generation + training)time/epoch 371.2419936582446
Training time/epoch 3.8731491565704346
Training time without block to device /epoch 1.2511703968048096
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.98it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.60it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.38it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.65it/s] 40%|████      | 10/25 [00:00<00:00, 17.86it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.13it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.03it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.97it/s] 80%|████████  | 20/25 [00:01<00:00, 17.98it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.73it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.77it/s]100%|██████████| 25/25 [00:01<00:00, 18.01it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.60it/s]  8%|▊         | 2/25 [00:00<00:03,  6.53it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.51it/s] 20%|██        | 5/25 [00:00<00:03,  6.52it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.59it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.81it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.72it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.82it/s] 40%|████      | 10/25 [00:01<00:02,  5.96it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.11it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.31it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.54it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.24it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.99it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.18it/s] 80%|████████  | 20/25 [00:03<00:00,  6.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.57it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.62it/s]100%|██████████| 25/25 [00:03<00:00,  6.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.97it/s]  8%|▊         | 2/25 [00:00<00:03,  6.27it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.38it/s] 20%|██        | 5/25 [00:00<00:03,  6.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.57it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.57it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.61it/s] 40%|████      | 10/25 [00:01<00:02,  6.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.57it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.98it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.60it/s] 60%|██████    | 15/25 [00:02<00:01,  5.84it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.04it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.17it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.91it/s] 80%|████████  | 20/25 [00:03<00:00,  5.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.84it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.03it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.76it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.75it/s]100%|██████████| 25/25 [00:04<00:00,  6.54it/s]100%|██████████| 25/25 [00:04<00:00,  6.20it/s]
Run 00 | Epoch 00032 | Loss 0.7209 | Train 0.6785 | Val 0.6648 | Test 0.5094
Number of nodes during this epoch:  4638185
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423295974731445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1489174365997314
range selection method range initialization spend 0.026540756225585938
time for parepare:  0.38193178176879883
local_output_nid generation:  0.02557826042175293
local_in_edges_tensor generation:  0.21234750747680664
mini_batch_src_global generation:  0.37468862533569336
r_  generation:  5.60216498374939
local_output_nid generation:  0.027672767639160156
local_in_edges_tensor generation:  0.22838926315307617
mini_batch_src_global generation:  0.46338939666748047
r_  generation:  5.536957740783691
----------------------check_connections_block total spend ----------------------------- 14.503149271011353
generate_one_block  7.229387998580933
generate_one_block  7.143171072006226
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9209327697753906
gen group dst list time:  0.08947896957397461
time for parepare:  0.4331953525543213
local_output_nid generation:  0.2259533405303955
local_in_edges_tensor generation:  1.6000480651855469
mini_batch_src_global generation:  2.4148824214935303
r_  generation:  28.955029487609863
local_output_nid generation:  0.4829695224761963
local_in_edges_tensor generation:  2.0267245769500732
mini_batch_src_global generation:  3.292909622192383
r_  generation:  29.88309335708618
----------------------check_connections_block total spend ----------------------------- 80.96066904067993
generate_one_block  41.040579319000244
generate_one_block  41.09099984169006
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.078761339187622
gen group dst list time:  0.18912839889526367
time for parepare:  0.4613037109375
local_output_nid generation:  0.36108994483947754
local_in_edges_tensor generation:  1.4491832256317139
mini_batch_src_global generation:  1.9951071739196777
r_  generation:  25.544437170028687
local_output_nid generation:  0.7224206924438477
local_in_edges_tensor generation:  2.139686346054077
mini_batch_src_global generation:  2.7899703979492188
r_  generation:  26.201111555099487
----------------------check_connections_block total spend ----------------------------- 71.77267408370972
generate_one_block  34.80543613433838
generate_one_block  35.726238489151
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423295974731445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  152.73334312438965
block generation total time  152.6632537841797
average batch blocks generation time:  76.33162689208984
block dataloader generation time/epoch 367.3405650817987
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3940904140472412 |1.3208125829696655 |0.004278302192687988 |0.0001437664031982422 |0.005138397216796875 |0.0016398429870605469 |
----------------------------------------------------------pseudo_mini_loss sum 0.7052034139633179
Total (block generation + training)time/epoch 371.1463316715125
Training time/epoch 3.8586902618408203
Training time without block to device /epoch 1.2170650959014893
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.99it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.68it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.32it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.75it/s] 40%|████      | 10/25 [00:00<00:00, 17.98it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.15it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.21it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.55it/s] 80%|████████  | 20/25 [00:01<00:00, 17.83it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.97it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.13it/s]100%|██████████| 25/25 [00:01<00:00, 18.06it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.55it/s]  8%|▊         | 2/25 [00:00<00:03,  6.51it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.24it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.27it/s] 20%|██        | 5/25 [00:00<00:03,  6.35it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.09it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.07it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.14it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.95it/s] 40%|████      | 10/25 [00:01<00:02,  6.05it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.19it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.94it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.13it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.12it/s] 60%|██████    | 15/25 [00:02<00:01,  5.97it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.12it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.26it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.41it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.53it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:03,  6.33it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.45it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.50it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.53it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.49it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.51it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.50it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.52it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.15it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.12it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
Run 00 | Epoch 00033 | Loss 0.7052 | Train 0.6801 | Val 0.6657 | Test 0.5119
Number of nodes during this epoch:  4637610
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426231384277344  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0945765972137451
range selection method range initialization spend 0.023954153060913086
time for parepare:  0.34683656692504883
local_output_nid generation:  0.0255892276763916
local_in_edges_tensor generation:  0.18970155715942383
mini_batch_src_global generation:  0.36985063552856445
r_  generation:  5.349486589431763
local_output_nid generation:  0.02682781219482422
local_in_edges_tensor generation:  0.2093508243560791
mini_batch_src_global generation:  0.45913076400756836
r_  generation:  5.539733409881592
----------------------check_connections_block total spend ----------------------------- 14.123426675796509
generate_one_block  7.101739406585693
generate_one_block  6.847179412841797
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.851018190383911
gen group dst list time:  0.08764886856079102
time for parepare:  0.4188661575317383
local_output_nid generation:  0.23812317848205566
local_in_edges_tensor generation:  1.5626959800720215
mini_batch_src_global generation:  2.570449113845825
r_  generation:  29.900168895721436
local_output_nid generation:  0.5167293548583984
local_in_edges_tensor generation:  2.083853006362915
mini_batch_src_global generation:  3.687392473220825
r_  generation:  29.69639253616333
----------------------check_connections_block total spend ----------------------------- 82.7805507183075
generate_one_block  40.84834599494934
generate_one_block  40.481998920440674
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1569271087646484
gen group dst list time:  0.17906904220581055
time for parepare:  0.44231319427490234
local_output_nid generation:  0.383624792098999
local_in_edges_tensor generation:  1.5114972591400146
mini_batch_src_global generation:  2.0062315464019775
r_  generation:  25.518773078918457
local_output_nid generation:  0.7372779846191406
local_in_edges_tensor generation:  1.9238331317901611
mini_batch_src_global generation:  3.0189547538757324
r_  generation:  25.817323684692383
----------------------check_connections_block total spend ----------------------------- 70.92379403114319
generate_one_block  35.24043273925781
generate_one_block  35.86992406845093
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426231384277344  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.70434474945068
block generation total time  152.44070172309875
average batch blocks generation time:  76.22035086154938
block dataloader generation time/epoch 367.2154593397589
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38543272018432617 |1.2970941066741943 |0.004338979721069336 |0.00014591217041015625 |0.005170226097106934 |0.0029363632202148438 |
----------------------------------------------------------pseudo_mini_loss sum 0.6862579584121704
Total (block generation + training)time/epoch 371.02077938528623
Training time/epoch 3.7904229164123535
Training time without block to device /epoch 1.1962347030639648
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.86it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.69it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.46it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.77it/s] 40%|████      | 10/25 [00:00<00:00, 18.00it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.11it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.18it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.19it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.25it/s] 80%|████████  | 20/25 [00:01<00:00, 18.29it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.29it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.36it/s]100%|██████████| 25/25 [00:01<00:00, 18.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.59it/s]  8%|▊         | 2/25 [00:00<00:04,  5.72it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.31it/s] 20%|██        | 5/25 [00:00<00:03,  5.25it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.26it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.23it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.19it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.17it/s] 40%|████      | 10/25 [00:01<00:02,  5.17it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.16it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.13it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.11it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.89it/s] 60%|██████    | 15/25 [00:02<00:01,  5.06it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.30it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.42it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.60it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.78it/s] 80%|████████  | 20/25 [00:03<00:00,  5.85it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.97it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.10it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.16it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.18it/s]100%|██████████| 25/25 [00:04<00:00,  5.61it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.01it/s]  8%|▊         | 2/25 [00:00<00:05,  4.57it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.27it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.66it/s] 20%|██        | 5/25 [00:00<00:03,  5.84it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.03it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.90it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.73it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.79it/s] 40%|████      | 10/25 [00:01<00:02,  5.93it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.93it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.02it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.07it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.12it/s] 60%|██████    | 15/25 [00:02<00:01,  6.20it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.24it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.32it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.30it/s]100%|██████████| 25/25 [00:04<00:00,  6.15it/s]
Run 00 | Epoch 00034 | Loss 0.6863 | Train 0.6815 | Val 0.6673 | Test 0.5140
Number of nodes during this epoch:  4637893
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422239780426025  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.167447566986084
range selection method range initialization spend 0.023903846740722656
time for parepare:  0.35877323150634766
local_output_nid generation:  0.02553558349609375
local_in_edges_tensor generation:  0.17341923713684082
mini_batch_src_global generation:  0.35997796058654785
r_  generation:  5.409062623977661
local_output_nid generation:  0.027556419372558594
local_in_edges_tensor generation:  0.2102954387664795
mini_batch_src_global generation:  0.4675478935241699
r_  generation:  5.698158025741577
----------------------check_connections_block total spend ----------------------------- 14.352049589157104
generate_one_block  7.174695253372192
generate_one_block  6.7963831424713135
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.057035446166992
gen group dst list time:  0.08931541442871094
time for parepare:  0.4694359302520752
local_output_nid generation:  0.26471710205078125
local_in_edges_tensor generation:  1.5930685997009277
mini_batch_src_global generation:  2.425288677215576
r_  generation:  29.727218627929688
local_output_nid generation:  0.5117645263671875
local_in_edges_tensor generation:  2.1813979148864746
mini_batch_src_global generation:  3.4750072956085205
r_  generation:  30.00609016418457
----------------------check_connections_block total spend ----------------------------- 82.73487758636475
generate_one_block  40.8747992515564
generate_one_block  40.78212904930115
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.105318069458008
gen group dst list time:  0.17890048027038574
time for parepare:  0.43857240676879883
local_output_nid generation:  0.3860452175140381
local_in_edges_tensor generation:  1.4861035346984863
mini_batch_src_global generation:  2.0140740871429443
r_  generation:  25.651620864868164
local_output_nid generation:  0.7642064094543457
local_in_edges_tensor generation:  2.071565628051758
mini_batch_src_global generation:  3.0136044025421143
r_  generation:  26.098848819732666
----------------------check_connections_block total spend ----------------------------- 72.04896712303162
generate_one_block  35.42411828041077
generate_one_block  36.16279721260071
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422239780426025  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.78384470939636
block generation total time  153.24384379386902
average batch blocks generation time:  76.62192189693451
block dataloader generation time/epoch 367.18181809016636
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38756704330444336 |1.3170713186264038 |0.004536867141723633 |0.00015807151794433594 |0.005176901817321777 |0.0029366016387939453 |
----------------------------------------------------------pseudo_mini_loss sum 0.6725288033485413
Total (block generation + training)time/epoch 370.9881306307656
Training time/epoch 3.8398749828338623
Training time without block to device /epoch 1.2057323455810547
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.29it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.73it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.35it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.60it/s] 40%|████      | 10/25 [00:00<00:01, 12.53it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.05it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.10it/s] 64%|██████▍   | 16/25 [00:01<00:00, 15.59it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.32it/s] 80%|████████  | 20/25 [00:01<00:00, 16.86it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.21it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.37it/s]100%|██████████| 25/25 [00:01<00:00, 16.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.47it/s]  8%|▊         | 2/25 [00:00<00:04,  5.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.86it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.11it/s] 20%|██        | 5/25 [00:00<00:03,  5.65it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.91it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.12it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.26it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.04it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.71it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.89it/s] 60%|██████    | 15/25 [00:02<00:01,  6.09it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.26it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.49it/s] 80%|████████  | 20/25 [00:03<00:00,  6.55it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.57it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.58it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.57it/s]100%|██████████| 25/25 [00:03<00:00,  7.25it/s]100%|██████████| 25/25 [00:03<00:00,  6.34it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.42it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.49it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.12it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.57it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.78it/s] 40%|████      | 10/25 [00:01<00:02,  6.02it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.17it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.28it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.37it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.49it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.98it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.63it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.36it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.17it/s] 80%|████████  | 20/25 [00:03<00:00,  5.07it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.05it/s] 88%|████████▊ | 22/25 [00:03<00:00,  4.80it/s] 92%|█████████▏| 23/25 [00:04<00:00,  4.72it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.72it/s]100%|██████████| 25/25 [00:04<00:00,  5.58it/s]100%|██████████| 25/25 [00:04<00:00,  5.70it/s]
Run 00 | Epoch 00035 | Loss 0.6725 | Train 0.6821 | Val 0.6688 | Test 0.5157
Number of nodes during this epoch:  4637830
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424411296844482  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1625254154205322
range selection method range initialization spend 0.029618263244628906
time for parepare:  0.3865668773651123
local_output_nid generation:  0.02707672119140625
local_in_edges_tensor generation:  0.23314332962036133
mini_batch_src_global generation:  0.38108181953430176
r_  generation:  5.583710670471191
local_output_nid generation:  0.02992868423461914
local_in_edges_tensor generation:  0.23095464706420898
mini_batch_src_global generation:  0.4708578586578369
r_  generation:  5.871194362640381
----------------------check_connections_block total spend ----------------------------- 14.979665279388428
generate_one_block  7.295935392379761
generate_one_block  7.140007019042969
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.039946556091309
gen group dst list time:  0.094940185546875
time for parepare:  0.4399099349975586
local_output_nid generation:  0.26351213455200195
local_in_edges_tensor generation:  1.7098073959350586
mini_batch_src_global generation:  2.5519134998321533
r_  generation:  30.49592161178589
local_output_nid generation:  0.524238109588623
local_in_edges_tensor generation:  2.5110771656036377
mini_batch_src_global generation:  3.7641611099243164
r_  generation:  30.130281686782837
----------------------check_connections_block total spend ----------------------------- 84.25707674026489
generate_one_block  41.542219161987305
generate_one_block  41.33585977554321
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.128706455230713
gen group dst list time:  0.19511795043945312
time for parepare:  0.46877121925354004
local_output_nid generation:  0.39450740814208984
local_in_edges_tensor generation:  1.5966343879699707
mini_batch_src_global generation:  2.0584990978240967
r_  generation:  26.111878156661987
local_output_nid generation:  0.7200620174407959
local_in_edges_tensor generation:  1.8970234394073486
mini_batch_src_global generation:  2.806910991668701
r_  generation:  26.243274688720703
----------------------check_connections_block total spend ----------------------------- 72.2210624217987
generate_one_block  35.15386652946472
generate_one_block  36.94417667388916
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424411296844482  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.4781391620636
block generation total time  154.9761221408844
average batch blocks generation time:  77.4880610704422
block dataloader generation time/epoch 367.2882946795887
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3943212032318115 |1.3427340984344482 |0.005195140838623047 |0.00018966197967529297 |0.005220293998718262 |0.0019245147705078125 |
----------------------------------------------------------pseudo_mini_loss sum 0.6569311618804932
Total (block generation + training)time/epoch 371.0973136557473
Training time/epoch 3.9035682678222656
Training time without block to device /epoch 1.2181000709533691
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.20it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.57it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.83it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.24it/s] 40%|████      | 10/25 [00:00<00:00, 17.48it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.54it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.76it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.73it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.20it/s] 80%|████████  | 20/25 [00:01<00:00, 17.39it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.93it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.22it/s]100%|██████████| 25/25 [00:01<00:00, 17.54it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.88it/s]  8%|▊         | 2/25 [00:00<00:04,  5.73it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.15it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.38it/s] 20%|██        | 5/25 [00:00<00:03,  5.79it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.52it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.39it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.32it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.26it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.21it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.19it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.81it/s] 60%|██████    | 15/25 [00:02<00:01,  6.06it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.77it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.58it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.44it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.33it/s] 80%|████████  | 20/25 [00:03<00:00,  5.27it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.22it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.18it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.18it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.14it/s]100%|██████████| 25/25 [00:04<00:00,  5.77it/s]100%|██████████| 25/25 [00:04<00:00,  5.49it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.71it/s]  8%|▊         | 2/25 [00:00<00:03,  6.27it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.69it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.41it/s] 20%|██        | 5/25 [00:00<00:03,  5.28it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.20it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.15it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.13it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.09it/s] 40%|████      | 10/25 [00:01<00:02,  5.07it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.87it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.21it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.56it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.86it/s] 60%|██████    | 15/25 [00:02<00:01,  6.07it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.21it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.73it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.50it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.35it/s] 80%|████████  | 20/25 [00:03<00:00,  5.21it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.22it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.55it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.83it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.52it/s]100%|██████████| 25/25 [00:04<00:00,  5.96it/s]100%|██████████| 25/25 [00:04<00:00,  5.51it/s]
Run 00 | Epoch 00036 | Loss 0.6569 | Train 0.6825 | Val 0.6704 | Test 0.5173
Number of nodes during this epoch:  4637210
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424688339233398  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1034948825836182
range selection method range initialization spend 0.026745319366455078
time for parepare:  0.3643834590911865
local_output_nid generation:  0.025676488876342773
local_in_edges_tensor generation:  0.20264697074890137
mini_batch_src_global generation:  0.3700859546661377
r_  generation:  5.477254629135132
local_output_nid generation:  0.027869701385498047
local_in_edges_tensor generation:  0.21436405181884766
mini_batch_src_global generation:  0.4813222885131836
r_  generation:  5.738201856613159
----------------------check_connections_block total spend ----------------------------- 14.577084302902222
generate_one_block  7.334856748580933
generate_one_block  7.206148147583008
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.7577691078186035
gen group dst list time:  0.08743023872375488
time for parepare:  0.43118834495544434
local_output_nid generation:  0.23276662826538086
local_in_edges_tensor generation:  1.5987622737884521
mini_batch_src_global generation:  2.407365083694458
r_  generation:  28.88939380645752
local_output_nid generation:  0.4688730239868164
local_in_edges_tensor generation:  2.2761740684509277
mini_batch_src_global generation:  3.4512929916381836
r_  generation:  30.07516860961914
----------------------check_connections_block total spend ----------------------------- 81.44453120231628
generate_one_block  40.95156168937683
generate_one_block  41.01801800727844
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.156355857849121
gen group dst list time:  0.17880749702453613
time for parepare:  0.4388904571533203
local_output_nid generation:  0.38201212882995605
local_in_edges_tensor generation:  1.4785664081573486
mini_batch_src_global generation:  2.0385122299194336
r_  generation:  25.431342601776123
local_output_nid generation:  0.7503273487091064
local_in_edges_tensor generation:  2.158996105194092
mini_batch_src_global generation:  2.998520851135254
r_  generation:  25.93393611907959
----------------------check_connections_block total spend ----------------------------- 71.70245814323425
generate_one_block  35.401196241378784
generate_one_block  36.0549533367157
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424688339233398  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.14698934555054
block generation total time  153.42572927474976
average batch blocks generation time:  76.71286463737488
block dataloader generation time/epoch 367.2340876927247
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3942883014678955 |1.3220690488815308 |0.004511237144470215 |0.00015413761138916016 |0.00507354736328125 |0.0029144287109375 |
----------------------------------------------------------pseudo_mini_loss sum 0.6431537866592407
Total (block generation + training)time/epoch 371.04463554073027
Training time/epoch 3.865399122238159
Training time without block to device /epoch 1.2212610244750977
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.84it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.78it/s] 40%|████      | 10/25 [00:00<00:00, 17.98it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.18it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.30it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.36it/s] 80%|████████  | 20/25 [00:01<00:00, 18.35it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.32it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.40it/s]100%|██████████| 25/25 [00:01<00:00, 18.32it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.43it/s]  8%|▊         | 2/25 [00:00<00:03,  6.50it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.54it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.61it/s] 20%|██        | 5/25 [00:00<00:03,  6.64it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.61it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.63it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.63it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.61it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.61it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.64it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.60it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.62it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.62it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.63it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.63it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.61it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.62it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.61it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.60it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.61it/s]100%|██████████| 25/25 [00:03<00:00,  6.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.35it/s]  8%|▊         | 2/25 [00:00<00:03,  6.51it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.56it/s] 20%|██        | 5/25 [00:00<00:03,  6.55it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.58it/s] 40%|████      | 10/25 [00:01<00:02,  6.58it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.58it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.56it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.54it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.56it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.59it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.59it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.59it/s] 80%|████████  | 20/25 [00:03<00:00,  6.60it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.61it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.61it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.61it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.62it/s]100%|██████████| 25/25 [00:03<00:00,  6.67it/s]
Run 00 | Epoch 00037 | Loss 0.6432 | Train 0.6837 | Val 0.6712 | Test 0.5188
Number of nodes during this epoch:  4637630
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426644325256348  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.044285535812378
range selection method range initialization spend 0.023431062698364258
time for parepare:  0.3697669506072998
local_output_nid generation:  0.025383710861206055
local_in_edges_tensor generation:  0.22207117080688477
mini_batch_src_global generation:  0.3672482967376709
r_  generation:  5.365729808807373
local_output_nid generation:  0.025979042053222656
local_in_edges_tensor generation:  0.19176983833312988
mini_batch_src_global generation:  0.4759707450866699
r_  generation:  5.530122518539429
----------------------check_connections_block total spend ----------------------------- 14.240111827850342
generate_one_block  7.102783918380737
generate_one_block  6.7195353507995605
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8777997493743896
gen group dst list time:  0.0843815803527832
time for parepare:  0.4036862850189209
local_output_nid generation:  0.22417402267456055
local_in_edges_tensor generation:  1.5577409267425537
mini_batch_src_global generation:  2.4054648876190186
r_  generation:  29.08007311820984
local_output_nid generation:  0.4767265319824219
local_in_edges_tensor generation:  2.431691884994507
mini_batch_src_global generation:  3.4363458156585693
r_  generation:  29.95393395423889
----------------------check_connections_block total spend ----------------------------- 81.63108134269714
generate_one_block  41.09358239173889
generate_one_block  40.70996284484863
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4424102306365967
gen group dst list time:  0.18266820907592773
time for parepare:  0.48284339904785156
local_output_nid generation:  0.4102756977081299
local_in_edges_tensor generation:  1.4855515956878662
mini_batch_src_global generation:  2.009229898452759
r_  generation:  25.863223552703857
local_output_nid generation:  0.7559750080108643
local_in_edges_tensor generation:  2.00266170501709
mini_batch_src_global generation:  2.8676979541778564
r_  generation:  26.026826858520508
----------------------check_connections_block total spend ----------------------------- 72.09098720550537
generate_one_block  35.12132215499878
generate_one_block  35.850756883621216
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426644325256348  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.72206854820251
block generation total time  152.77562427520752
average batch blocks generation time:  76.38781213760376
block dataloader generation time/epoch 367.140426773774
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38179969787597656 |1.3156979084014893 |0.00435483455657959 |0.0001461505889892578 |0.004981637001037598 |0.0016498565673828125 |
----------------------------------------------------------pseudo_mini_loss sum 0.6330220103263855
Total (block generation + training)time/epoch 370.9513194498263
Training time/epoch 3.823495626449585
Training time without block to device /epoch 1.1920998096466064
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.04it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.76it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.90it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.60it/s] 40%|████      | 10/25 [00:00<00:00, 16.48it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.52it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.78it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.93it/s] 80%|████████  | 20/25 [00:01<00:00, 18.03it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.11it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.19it/s]100%|██████████| 25/25 [00:01<00:00, 17.85it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.64it/s] 20%|██        | 5/25 [00:00<00:03,  6.65it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.67it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.10it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.77it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.55it/s] 40%|████      | 10/25 [00:01<00:02,  5.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.35it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.14it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.93it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.70it/s] 60%|██████    | 15/25 [00:02<00:02,  4.69it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.04it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.40it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.26it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.16it/s] 80%|████████  | 20/25 [00:03<00:00,  5.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.60it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.86it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.04it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.91it/s]100%|██████████| 25/25 [00:04<00:00,  6.72it/s]100%|██████████| 25/25 [00:04<00:00,  5.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.40it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.28it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.47it/s] 20%|██        | 5/25 [00:00<00:03,  5.71it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.98it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.15it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.26it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.32it/s] 40%|████      | 10/25 [00:01<00:02,  5.75it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.97it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.12it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.28it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.31it/s] 60%|██████    | 15/25 [00:02<00:01,  6.43it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.49it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.08it/s] 80%|████████  | 20/25 [00:03<00:00,  5.76it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.89it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.10it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.26it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:04<00:00,  6.90it/s]100%|██████████| 25/25 [00:04<00:00,  6.20it/s]
Run 00 | Epoch 00038 | Loss 0.6330 | Train 0.6846 | Val 0.6733 | Test 0.5201
Number of nodes during this epoch:  4637516
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426603317260742  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.134178638458252
range selection method range initialization spend 0.025072336196899414
time for parepare:  0.3737945556640625
local_output_nid generation:  0.02621173858642578
local_in_edges_tensor generation:  0.21102476119995117
mini_batch_src_global generation:  0.36915063858032227
r_  generation:  5.42975115776062
local_output_nid generation:  0.027982473373413086
local_in_edges_tensor generation:  0.2326502799987793
mini_batch_src_global generation:  0.5671737194061279
r_  generation:  5.514719009399414
----------------------check_connections_block total spend ----------------------------- 14.40190601348877
generate_one_block  7.207127809524536
generate_one_block  7.10974907875061
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.843186616897583
gen group dst list time:  0.08758759498596191
time for parepare:  0.46596837043762207
local_output_nid generation:  0.24661922454833984
local_in_edges_tensor generation:  1.727278232574463
mini_batch_src_global generation:  2.4844870567321777
r_  generation:  29.81129288673401
local_output_nid generation:  0.5389890670776367
local_in_edges_tensor generation:  2.352501630783081
mini_batch_src_global generation:  3.538001537322998
r_  generation:  29.996572971343994
----------------------check_connections_block total spend ----------------------------- 83.1791741847992
generate_one_block  40.8148455619812
generate_one_block  40.83179497718811
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.16051983833313
gen group dst list time:  0.18484044075012207
time for parepare:  0.49278712272644043
local_output_nid generation:  0.4002349376678467
local_in_edges_tensor generation:  1.6486940383911133
mini_batch_src_global generation:  1.9996438026428223
r_  generation:  25.828320503234863
local_output_nid generation:  0.7236731052398682
local_in_edges_tensor generation:  1.904510736465454
mini_batch_src_global generation:  2.8010942935943604
r_  generation:  25.941303491592407
----------------------check_connections_block total spend ----------------------------- 71.73672699928284
generate_one_block  35.06316423416138
generate_one_block  35.80237913131714
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426603317260742  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.91590118408203
block generation total time  152.51218390464783
average batch blocks generation time:  76.25609195232391
block dataloader generation time/epoch 367.1252719316727
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37667953968048096 |1.3005626201629639 |0.004304766654968262 |0.00014519691467285156 |0.005104422569274902 |0.0030400753021240234 |
----------------------------------------------------------pseudo_mini_loss sum 0.6208208203315735
Total (block generation + training)time/epoch 370.93558310851074
Training time/epoch 3.788057565689087
Training time without block to device /epoch 1.1869323253631592
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.78it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.39it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.69it/s] 40%|████      | 10/25 [00:00<00:00, 17.75it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.38it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.65it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.64it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.65it/s] 80%|████████  | 20/25 [00:01<00:00, 17.68it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.63it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.60it/s]100%|██████████| 25/25 [00:01<00:00, 17.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.06it/s]  8%|▊         | 2/25 [00:00<00:04,  4.85it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.92it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.47it/s] 20%|██        | 5/25 [00:00<00:03,  5.86it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.47it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.75it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.71it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.64it/s] 40%|████      | 10/25 [00:01<00:02,  5.29it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.19it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.52it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.85it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.08it/s] 60%|██████    | 15/25 [00:02<00:01,  6.27it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.52it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.01it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.67it/s] 80%|████████  | 20/25 [00:03<00:00,  5.85it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.07it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.30it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.55it/s]100%|██████████| 25/25 [00:04<00:00,  5.98it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.04it/s]  8%|▊         | 2/25 [00:00<00:03,  6.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.82it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.46it/s] 20%|██        | 5/25 [00:00<00:03,  5.30it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.23it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.18it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.11it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.01it/s] 40%|████      | 10/25 [00:01<00:03,  4.93it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.89it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.12it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.50it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.80it/s] 60%|██████    | 15/25 [00:02<00:01,  6.02it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.20it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.31it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.41it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.30it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.46it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.87it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.06it/s]100%|██████████| 25/25 [00:04<00:00,  5.84it/s]
Run 00 | Epoch 00039 | Loss 0.6208 | Train 0.6860 | Val 0.6750 | Test 0.5213
Number of nodes during this epoch:  4637313
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425217151641846  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.108170747756958
range selection method range initialization spend 0.024376869201660156
time for parepare:  0.3884131908416748
local_output_nid generation:  0.027118206024169922
local_in_edges_tensor generation:  0.17999839782714844
mini_batch_src_global generation:  0.3627488613128662
r_  generation:  5.460089445114136
local_output_nid generation:  0.028677940368652344
local_in_edges_tensor generation:  0.21434259414672852
mini_batch_src_global generation:  0.49292731285095215
r_  generation:  5.687910556793213
----------------------check_connections_block total spend ----------------------------- 14.45897126197815
generate_one_block  7.258770942687988
generate_one_block  7.089185953140259
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.049248456954956
gen group dst list time:  0.12076997756958008
time for parepare:  0.46199750900268555
local_output_nid generation:  0.2648000717163086
local_in_edges_tensor generation:  1.715040922164917
mini_batch_src_global generation:  2.5219082832336426
r_  generation:  30.561978101730347
local_output_nid generation:  0.5577747821807861
local_in_edges_tensor generation:  2.2799298763275146
mini_batch_src_global generation:  3.848158121109009
r_  generation:  30.51230764389038
----------------------check_connections_block total spend ----------------------------- 85.20511293411255
generate_one_block  41.518983364105225
generate_one_block  41.91944146156311
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2297236919403076
gen group dst list time:  0.1986982822418213
time for parepare:  0.46384358406066895
local_output_nid generation:  0.4073607921600342
local_in_edges_tensor generation:  1.4743695259094238
mini_batch_src_global generation:  2.108989715576172
r_  generation:  26.637497186660767
local_output_nid generation:  0.7353465557098389
local_in_edges_tensor generation:  2.006117820739746
mini_batch_src_global generation:  2.817512273788452
r_  generation:  26.186370611190796
----------------------check_connections_block total spend ----------------------------- 72.99630093574524
generate_one_block  35.32744550704956
generate_one_block  36.105666399002075
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425217151641846  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  158.2014138698578
block generation total time  154.87153673171997
average batch blocks generation time:  77.43576836585999
block dataloader generation time/epoch 367.2697889566422
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3874624967575073 |1.2988171577453613 |0.0048362016677856445 |0.00017321109771728516 |0.004989147186279297 |0.0019347667694091797 |
----------------------------------------------------------pseudo_mini_loss sum 0.6102761626243591
Total (block generation + training)time/epoch 371.07983261942866
Training time/epoch 3.7994425296783447
Training time without block to device /epoch 1.201808214187622
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.57it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.18it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.51it/s] 40%|████      | 10/25 [00:00<00:01, 14.00it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.20it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.01it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.25it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.83it/s] 80%|████████  | 20/25 [00:01<00:00, 17.24it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.21it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.41it/s]100%|██████████| 25/25 [00:01<00:00, 16.76it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.57it/s]  8%|▊         | 2/25 [00:00<00:03,  6.65it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.94it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.52it/s] 20%|██        | 5/25 [00:00<00:03,  5.40it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.55it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.55it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.63it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.76it/s] 40%|████      | 10/25 [00:01<00:02,  5.91it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.09it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.69it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.53it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.74it/s] 60%|██████    | 15/25 [00:02<00:01,  6.00it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.64it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.46it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.78it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.03it/s] 80%|████████  | 20/25 [00:03<00:00,  6.14it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.79it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.51it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.64it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.90it/s]100%|██████████| 25/25 [00:04<00:00,  5.88it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.31it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.88it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.55it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.35it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.66it/s] 40%|████      | 10/25 [00:01<00:02,  5.91it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.10it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.22it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.33it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.34it/s] 60%|██████    | 15/25 [00:02<00:01,  6.04it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.12it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.24it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.31it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.36it/s] 80%|████████  | 20/25 [00:03<00:00,  6.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
Run 00 | Epoch 00040 | Loss 0.6103 | Train 0.6870 | Val 0.6767 | Test 0.5224
Number of nodes during this epoch:  4637493
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425346374511719  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1252830028533936
range selection method range initialization spend 0.026319503784179688
time for parepare:  0.3737156391143799
local_output_nid generation:  0.027710676193237305
local_in_edges_tensor generation:  0.21681714057922363
mini_batch_src_global generation:  0.3748302459716797
r_  generation:  5.670541524887085
local_output_nid generation:  0.0302278995513916
local_in_edges_tensor generation:  0.23061180114746094
mini_batch_src_global generation:  0.4640069007873535
r_  generation:  5.861135005950928
----------------------check_connections_block total spend ----------------------------- 14.9221031665802
generate_one_block  7.229736804962158
generate_one_block  6.94606351852417
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.036880254745483
gen group dst list time:  0.09556984901428223
time for parepare:  0.47276830673217773
local_output_nid generation:  0.26074934005737305
local_in_edges_tensor generation:  1.6333653926849365
mini_batch_src_global generation:  2.586094379425049
r_  generation:  30.55754256248474
local_output_nid generation:  0.5178334712982178
local_in_edges_tensor generation:  2.375349283218384
mini_batch_src_global generation:  3.7800190448760986
r_  generation:  30.119959831237793
----------------------check_connections_block total spend ----------------------------- 84.15326952934265
generate_one_block  41.49657440185547
generate_one_block  41.30866456031799
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.200888156890869
gen group dst list time:  0.18810534477233887
time for parepare:  0.4758796691894531
local_output_nid generation:  0.4057018756866455
local_in_edges_tensor generation:  1.4603593349456787
mini_batch_src_global generation:  2.0096397399902344
r_  generation:  25.347566604614258
local_output_nid generation:  0.7402529716491699
local_in_edges_tensor generation:  1.9506299495697021
mini_batch_src_global generation:  2.821406841278076
r_  generation:  26.0570707321167
----------------------check_connections_block total spend ----------------------------- 71.24937391281128
generate_one_block  35.1130793094635
generate_one_block  36.07806468009949
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425346374511719  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.40264344215393
block generation total time  153.99638295173645
average batch blocks generation time:  76.99819147586823
block dataloader generation time/epoch 367.3167567253113
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39021122455596924 |1.4276418685913086 |0.0043048858642578125 |0.0001518726348876953 |0.005006909370422363 |0.0028955936431884766 |
----------------------------------------------------------pseudo_mini_loss sum 0.5987224578857422
Total (block generation + training)time/epoch 371.13298623154805
Training time/epoch 4.063502788543701
Training time without block to device /epoch 1.208219051361084
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.36it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.84it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.34it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.85it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.15it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.15it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.26it/s] 80%|████████  | 20/25 [00:01<00:00, 18.26it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.65it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.88it/s]100%|██████████| 25/25 [00:01<00:00, 18.11it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.58it/s]  8%|▊         | 2/25 [00:00<00:04,  5.72it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.11it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.42it/s] 20%|██        | 5/25 [00:00<00:03,  5.77it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.73it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.87it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.03it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.57it/s] 40%|████      | 10/25 [00:01<00:02,  5.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.65it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.93it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.15it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.28it/s] 60%|██████    | 15/25 [00:02<00:01,  5.86it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.59it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.85it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.10it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.30it/s] 80%|████████  | 20/25 [00:03<00:00,  5.88it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.49it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.67it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.93it/s]100%|██████████| 25/25 [00:04<00:00,  5.90it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.20it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.53it/s] 20%|██        | 5/25 [00:00<00:03,  6.57it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.62it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.56it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.93it/s] 40%|████      | 10/25 [00:01<00:02,  5.62it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.39it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.18it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.53it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.85it/s] 60%|██████    | 15/25 [00:02<00:01,  5.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.24it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.52it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.84it/s] 80%|████████  | 20/25 [00:03<00:00,  5.61it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.29it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.59it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.38it/s]100%|██████████| 25/25 [00:04<00:00,  5.82it/s]
Run 00 | Epoch 00041 | Loss 0.5987 | Train 0.6880 | Val 0.6772 | Test 0.5234
Number of nodes during this epoch:  4637108
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423116683959961  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1189239025115967
range selection method range initialization spend 0.03607583045959473
time for parepare:  0.37328147888183594
local_output_nid generation:  0.035857439041137695
local_in_edges_tensor generation:  0.19300055503845215
mini_batch_src_global generation:  0.3693511486053467
r_  generation:  5.490393400192261
local_output_nid generation:  0.028778553009033203
local_in_edges_tensor generation:  0.21636033058166504
mini_batch_src_global generation:  0.47597408294677734
r_  generation:  5.803234577178955
----------------------check_connections_block total spend ----------------------------- 14.645037174224854
generate_one_block  7.272727966308594
generate_one_block  7.088430404663086
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.128819465637207
gen group dst list time:  0.09790658950805664
time for parepare:  0.46439266204833984
local_output_nid generation:  0.2616238594055176
local_in_edges_tensor generation:  1.6546573638916016
mini_batch_src_global generation:  2.483137845993042
r_  generation:  30.218676567077637
local_output_nid generation:  0.5562458038330078
local_in_edges_tensor generation:  2.087294816970825
mini_batch_src_global generation:  3.775465965270996
r_  generation:  30.38230299949646
----------------------check_connections_block total spend ----------------------------- 83.90416598320007
generate_one_block  41.414063692092896
generate_one_block  41.51665186882019
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.206148147583008
gen group dst list time:  0.19234824180603027
time for parepare:  0.47435927391052246
local_output_nid generation:  0.37307024002075195
local_in_edges_tensor generation:  1.544846534729004
mini_batch_src_global generation:  2.1804609298706055
r_  generation:  26.43286919593811
local_output_nid generation:  0.7315645217895508
local_in_edges_tensor generation:  1.9376065731048584
mini_batch_src_global generation:  2.822944402694702
r_  generation:  26.04018259048462
----------------------check_connections_block total spend ----------------------------- 72.65580224990845
generate_one_block  35.23756146430969
generate_one_block  35.91180372238159
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423116683959961  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.55996823310852
block generation total time  154.08008074760437
average batch blocks generation time:  77.04004037380219
block dataloader generation time/epoch 367.39178188074203
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37869131565093994 |1.3045953512191772 |0.052062392234802246 |0.00020778179168701172 |0.07452762126922607 |0.0030565261840820312 |
----------------------------------------------------------pseudo_mini_loss sum 0.5904192924499512
Total (block generation + training)time/epoch 371.20862439700534
Training time/epoch 3.84181809425354
Training time without block to device /epoch 1.2326273918151855
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.01it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.75it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.48it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.63it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.33it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.59it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.70it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.66it/s] 80%|████████  | 20/25 [00:01<00:00, 17.78it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.98it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.86it/s]100%|██████████| 25/25 [00:01<00:00, 17.85it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.36it/s]  8%|▊         | 2/25 [00:00<00:03,  6.65it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.74it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.10it/s] 20%|██        | 5/25 [00:00<00:03,  5.71it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.52it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.38it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.07it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.76it/s] 40%|████      | 10/25 [00:01<00:03,  4.64it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.94it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.23it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.52it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.76it/s] 60%|██████    | 15/25 [00:02<00:01,  5.96it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.17it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.27it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  5.65it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.29it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.25it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.17it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.42it/s]100%|██████████| 25/25 [00:04<00:00,  5.66it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.04it/s]  8%|▊         | 2/25 [00:00<00:03,  5.82it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.03it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.07it/s] 20%|██        | 5/25 [00:00<00:03,  6.18it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.32it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.80it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.96it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.18it/s] 40%|████      | 10/25 [00:01<00:02,  5.78it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.54it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.61it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.86it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.05it/s] 60%|██████    | 15/25 [00:02<00:01,  6.22it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.81it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.44it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.53it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.80it/s] 80%|████████  | 20/25 [00:03<00:00,  6.03it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.72it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.62it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.84it/s]100%|██████████| 25/25 [00:04<00:00,  5.94it/s]
Run 00 | Epoch 00042 | Loss 0.5904 | Train 0.6887 | Val 0.6772 | Test 0.5244
Number of nodes during this epoch:  4637823
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429412364959717  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1157269477844238
range selection method range initialization spend 0.024492263793945312
time for parepare:  0.3607215881347656
local_output_nid generation:  0.029841184616088867
local_in_edges_tensor generation:  0.22952508926391602
mini_batch_src_global generation:  0.37464022636413574
r_  generation:  5.43102240562439
local_output_nid generation:  0.02853679656982422
local_in_edges_tensor generation:  0.21253061294555664
mini_batch_src_global generation:  0.49959897994995117
r_  generation:  5.768283843994141
----------------------check_connections_block total spend ----------------------------- 14.586252212524414
generate_one_block  7.288689136505127
generate_one_block  6.949216604232788
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.102068662643433
gen group dst list time:  0.0979611873626709
time for parepare:  0.446058988571167
local_output_nid generation:  0.258242130279541
local_in_edges_tensor generation:  1.5603008270263672
mini_batch_src_global generation:  2.422827959060669
r_  generation:  28.967013835906982
local_output_nid generation:  0.52840256690979
local_in_edges_tensor generation:  2.073991060256958
mini_batch_src_global generation:  3.4656662940979004
r_  generation:  29.878498315811157
----------------------check_connections_block total spend ----------------------------- 81.60771155357361
generate_one_block  40.72504281997681
generate_one_block  40.958340883255005
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1948628425598145
gen group dst list time:  0.18516325950622559
time for parepare:  0.46958112716674805
local_output_nid generation:  0.3842344284057617
local_in_edges_tensor generation:  1.458536148071289
mini_batch_src_global generation:  2.0121333599090576
r_  generation:  25.40321373939514
local_output_nid generation:  0.7537639141082764
local_in_edges_tensor generation:  1.9558274745941162
mini_batch_src_global generation:  2.972243547439575
r_  generation:  25.84777307510376
----------------------check_connections_block total spend ----------------------------- 71.3846173286438
generate_one_block  35.208534955978394
generate_one_block  35.795711517333984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429412364959717  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  152.9923288822174
block generation total time  152.6876301765442
average batch blocks generation time:  76.3438150882721
block dataloader generation time/epoch 367.34882886465203
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3733879327774048 |1.298805832862854 |0.004645228385925293 |0.00017392635345458984 |0.005308628082275391 |0.0029833316802978516 |
----------------------------------------------------------pseudo_mini_loss sum 0.5817290544509888
Total (block generation + training)time/epoch 371.1646620395572
Training time/epoch 3.773280620574951
Training time without block to device /epoch 1.1756689548492432
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.24it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.81it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.27it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.89it/s] 40%|████      | 10/25 [00:00<00:00, 16.61it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.06it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.22it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.26it/s] 80%|████████  | 20/25 [00:01<00:00, 17.55it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.54it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.68it/s]100%|██████████| 25/25 [00:01<00:00, 17.27it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:03,  6.68it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.75it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.76it/s] 20%|██        | 5/25 [00:00<00:02,  6.80it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.79it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.66it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.93it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.14it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.87it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.60it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.44it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.29it/s] 60%|██████    | 15/25 [00:02<00:01,  5.56it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.85it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.01it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.19it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.03it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.72it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.54it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.42it/s]100%|██████████| 25/25 [00:04<00:00,  5.75it/s]100%|██████████| 25/25 [00:04<00:00,  5.98it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.57it/s]  8%|▊         | 2/25 [00:00<00:03,  6.11it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.84it/s] 20%|██        | 5/25 [00:00<00:03,  5.51it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.34it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.24it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.16it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.08it/s] 40%|████      | 10/25 [00:01<00:02,  5.05it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.78it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.07it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.12it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.46it/s] 60%|██████    | 15/25 [00:02<00:01,  5.73it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.96it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.12it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.26it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.29it/s] 80%|████████  | 20/25 [00:03<00:00,  6.28it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.31it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.46it/s]100%|██████████| 25/25 [00:04<00:00,  5.86it/s]
Run 00 | Epoch 00043 | Loss 0.5817 | Train 0.6894 | Val 0.6776 | Test 0.5253
Number of nodes during this epoch:  4636593
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423892974853516  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.115530014038086
range selection method range initialization spend 0.023687362670898438
time for parepare:  0.3588747978210449
local_output_nid generation:  0.025743722915649414
local_in_edges_tensor generation:  0.18720746040344238
mini_batch_src_global generation:  0.3774700164794922
r_  generation:  5.606736660003662
local_output_nid generation:  0.029027938842773438
local_in_edges_tensor generation:  0.23255372047424316
mini_batch_src_global generation:  0.4623427391052246
r_  generation:  5.82147741317749
----------------------check_connections_block total spend ----------------------------- 14.762283563613892
generate_one_block  7.197869777679443
generate_one_block  6.847034454345703
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9792027473449707
gen group dst list time:  0.09437751770019531
time for parepare:  0.4534003734588623
local_output_nid generation:  0.24562549591064453
local_in_edges_tensor generation:  1.6922247409820557
mini_batch_src_global generation:  2.4678843021392822
r_  generation:  29.55773425102234
local_output_nid generation:  0.5091197490692139
local_in_edges_tensor generation:  2.1154956817626953
mini_batch_src_global generation:  3.476132869720459
r_  generation:  29.979976654052734
----------------------check_connections_block total spend ----------------------------- 82.50529789924622
generate_one_block  40.951228857040405
generate_one_block  40.95441246032715
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.14176869392395
gen group dst list time:  0.1844642162322998
time for parepare:  0.4418308734893799
local_output_nid generation:  0.3802602291107178
local_in_edges_tensor generation:  1.4578804969787598
mini_batch_src_global generation:  2.003034830093384
r_  generation:  25.50486183166504
local_output_nid generation:  0.7280278205871582
local_in_edges_tensor generation:  2.1204144954681396
mini_batch_src_global generation:  2.8510053157806396
r_  generation:  26.040518283843994
----------------------check_connections_block total spend ----------------------------- 71.62130355834961
generate_one_block  36.02196431159973
generate_one_block  35.89193511009216
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423892974853516  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.12660145759583
block generation total time  153.81954073905945
average batch blocks generation time:  76.90977036952972
block dataloader generation time/epoch 367.32902218536896
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3977128267288208 |1.319508671760559 |0.004324197769165039 |0.0001519918441772461 |0.0050629377365112305 |0.001382589340209961 |
----------------------------------------------------------pseudo_mini_loss sum 0.5770217776298523
Total (block generation + training)time/epoch 371.1459266164086
Training time/epoch 3.862800121307373
Training time without block to device /epoch 1.2237827777862549
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.28it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.68it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.07it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.53it/s] 40%|████      | 10/25 [00:00<00:00, 17.81it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.02it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.15it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.20it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.23it/s] 80%|████████  | 20/25 [00:01<00:00, 18.23it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.27it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.33it/s]100%|██████████| 25/25 [00:01<00:00, 18.24it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.61it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.61it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.60it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.62it/s] 40%|████      | 10/25 [00:01<00:02,  6.63it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.59it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.59it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.60it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.60it/s] 60%|██████    | 15/25 [00:02<00:01,  6.59it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.60it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.58it/s] 80%|████████  | 20/25 [00:03<00:00,  6.57it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.55it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  7.21it/s]100%|██████████| 25/25 [00:03<00:00,  6.66it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.85it/s]  8%|▊         | 2/25 [00:00<00:03,  6.18it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.92it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.11it/s] 20%|██        | 5/25 [00:00<00:03,  6.09it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.21it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.30it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.39it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.43it/s] 40%|████      | 10/25 [00:01<00:02,  6.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.44it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.47it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
Run 00 | Epoch 00044 | Loss 0.5770 | Train 0.6900 | Val 0.6782 | Test 0.5263
Number of nodes during this epoch:  4638084
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4249749183654785  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0918362140655518
range selection method range initialization spend 0.02389693260192871
time for parepare:  0.33812570571899414
local_output_nid generation:  0.025974512100219727
local_in_edges_tensor generation:  0.19092202186584473
mini_batch_src_global generation:  0.3717172145843506
r_  generation:  5.318965435028076
local_output_nid generation:  0.027398347854614258
local_in_edges_tensor generation:  0.19486069679260254
mini_batch_src_global generation:  0.4628567695617676
r_  generation:  5.5612664222717285
----------------------check_connections_block total spend ----------------------------- 14.096285343170166
generate_one_block  7.0988428592681885
generate_one_block  6.940037488937378
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.898993730545044
gen group dst list time:  0.08448576927185059
time for parepare:  0.4156227111816406
local_output_nid generation:  0.23820948600769043
local_in_edges_tensor generation:  1.552659511566162
mini_batch_src_global generation:  2.3950393199920654
r_  generation:  28.995147228240967
local_output_nid generation:  0.4741194248199463
local_in_edges_tensor generation:  2.0690243244171143
mini_batch_src_global generation:  3.5043609142303467
r_  generation:  29.79522156715393
----------------------check_connections_block total spend ----------------------------- 80.87707304954529
generate_one_block  41.054765462875366
generate_one_block  41.191473960876465
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2188186645507812
gen group dst list time:  0.19059038162231445
time for parepare:  0.46555018424987793
local_output_nid generation:  0.3666207790374756
local_in_edges_tensor generation:  1.4553966522216797
mini_batch_src_global generation:  2.006016254425049
r_  generation:  25.465330362319946
local_output_nid generation:  0.720736026763916
local_in_edges_tensor generation:  1.9259355068206787
mini_batch_src_global generation:  2.8228275775909424
r_  generation:  26.079251289367676
----------------------check_connections_block total spend ----------------------------- 71.50501608848572
generate_one_block  35.02688932418823
generate_one_block  35.94954562187195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4249749183654785  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  152.382089138031
block generation total time  153.222674369812
average batch blocks generation time:  76.611337184906
block dataloader generation time/epoch 367.2249352508121
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37686383724212646 |1.408902883529663 |0.0043381452560424805 |0.00014662742614746094 |0.005112051963806152 |0.0015301704406738281 |
----------------------------------------------------------pseudo_mini_loss sum 0.5655161142349243
Total (block generation + training)time/epoch 371.0460051642524
Training time/epoch 4.004188776016235
Training time without block to device /epoch 1.1863830089569092
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.90it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.55it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.79it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.33it/s] 40%|████      | 10/25 [00:00<00:01, 13.35it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.68it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.44it/s] 64%|██████▍   | 16/25 [00:01<00:00, 15.66it/s] 72%|███████▏  | 18/25 [00:01<00:00, 14.35it/s] 80%|████████  | 20/25 [00:01<00:00, 14.10it/s] 88%|████████▊ | 22/25 [00:01<00:00, 14.76it/s] 96%|█████████▌| 24/25 [00:01<00:00, 15.48it/s]100%|██████████| 25/25 [00:01<00:00, 15.47it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.10it/s]  8%|▊         | 2/25 [00:00<00:04,  5.12it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.05it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.95it/s] 20%|██        | 5/25 [00:01<00:04,  4.96it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.91it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.16it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.60it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.91it/s] 40%|████      | 10/25 [00:01<00:02,  6.07it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.27it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.93it/s] 60%|██████    | 15/25 [00:02<00:01,  5.96it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.12it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.15it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.28it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.57it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.62it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.64it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.68it/s]100%|██████████| 25/25 [00:04<00:00,  6.10it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.33it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.56it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.65it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.69it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.70it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.12it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.72it/s] 40%|████      | 10/25 [00:01<00:02,  5.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.76it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.99it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.69it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.45it/s] 60%|██████    | 15/25 [00:02<00:01,  5.75it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.03it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.13it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.31it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.87it/s] 80%|████████  | 20/25 [00:03<00:00,  6.00it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.20it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.24it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:04<00:00,  6.23it/s]
Run 00 | Epoch 00045 | Loss 0.5655 | Train 0.6902 | Val 0.6788 | Test 0.5272
Number of nodes during this epoch:  4637574
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425393104553223  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1094794273376465
range selection method range initialization spend 0.024789094924926758
time for parepare:  0.3724327087402344
local_output_nid generation:  0.025814056396484375
local_in_edges_tensor generation:  0.17452168464660645
mini_batch_src_global generation:  0.3725583553314209
r_  generation:  5.534521818161011
local_output_nid generation:  0.028484821319580078
local_in_edges_tensor generation:  0.24920177459716797
mini_batch_src_global generation:  0.4628150463104248
r_  generation:  5.870784044265747
----------------------check_connections_block total spend ----------------------------- 14.787474393844604
generate_one_block  7.224416017532349
generate_one_block  7.053347826004028
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.018224716186523
gen group dst list time:  0.09795880317687988
time for parepare:  0.46504855155944824
local_output_nid generation:  0.2508723735809326
local_in_edges_tensor generation:  1.650928020477295
mini_batch_src_global generation:  2.488629102706909
r_  generation:  29.970812559127808
local_output_nid generation:  0.5403437614440918
local_in_edges_tensor generation:  2.3011934757232666
mini_batch_src_global generation:  3.7703640460968018
r_  generation:  29.88843822479248
----------------------check_connections_block total spend ----------------------------- 83.2142984867096
generate_one_block  41.511974573135376
generate_one_block  41.360109090805054
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1863603591918945
gen group dst list time:  0.18280792236328125
time for parepare:  0.47440099716186523
local_output_nid generation:  0.3962080478668213
local_in_edges_tensor generation:  1.6124634742736816
mini_batch_src_global generation:  2.2696452140808105
r_  generation:  26.698567867279053
local_output_nid generation:  0.7310049533843994
local_in_edges_tensor generation:  2.0379810333251953
mini_batch_src_global generation:  2.8245887756347656
r_  generation:  26.30332899093628
----------------------check_connections_block total spend ----------------------------- 73.47797179222107
generate_one_block  34.77721619606018
generate_one_block  35.97651147842407
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425393104553223  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.69227027893066
block generation total time  153.62581133842468
average batch blocks generation time:  76.81290566921234
block dataloader generation time/epoch 367.26948990510857
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3756645917892456 |1.304097056388855 |0.0043152570724487305 |0.00014495849609375 |0.0051871538162231445 |0.00153350830078125 |
----------------------------------------------------------pseudo_mini_loss sum 0.5575592517852783
Total (block generation + training)time/epoch 371.0898202450379
Training time/epoch 3.786879777908325
Training time without block to device /epoch 1.1786856651306152
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.41it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.99it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.60it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.47it/s] 40%|████      | 10/25 [00:00<00:00, 17.74it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.86it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.88it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.83it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.84it/s] 80%|████████  | 20/25 [00:01<00:00, 17.68it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.82it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.87it/s]100%|██████████| 25/25 [00:01<00:00, 17.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.91it/s]  8%|▊         | 2/25 [00:00<00:04,  4.80it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.09it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.41it/s] 20%|██        | 5/25 [00:00<00:03,  5.07it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.30it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.62it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.82it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.87it/s] 40%|████      | 10/25 [00:01<00:02,  5.42it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.32it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.26it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.22it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.18it/s] 60%|██████    | 15/25 [00:02<00:01,  5.16it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.05it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.97it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.32it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.68it/s] 80%|████████  | 20/25 [00:03<00:00,  5.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.80it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.02it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.69it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.52it/s]100%|██████████| 25/25 [00:04<00:00,  6.11it/s]100%|██████████| 25/25 [00:04<00:00,  5.48it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.76it/s]  8%|▊         | 2/25 [00:00<00:04,  5.65it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.00it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.11it/s] 20%|██        | 5/25 [00:00<00:03,  6.26it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.95it/s] 40%|████      | 10/25 [00:01<00:02,  6.09it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.18it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.33it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.94it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.00it/s] 60%|██████    | 15/25 [00:02<00:01,  6.18it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.29it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.02it/s] 80%|████████  | 20/25 [00:03<00:00,  6.16it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.31it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.90it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.06it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.22it/s]100%|██████████| 25/25 [00:03<00:00,  6.26it/s]
Run 00 | Epoch 00046 | Loss 0.5576 | Train 0.6901 | Val 0.6797 | Test 0.5280
Number of nodes during this epoch:  4636975
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4287824630737305  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0951533317565918
range selection method range initialization spend 0.024542570114135742
time for parepare:  0.36723923683166504
local_output_nid generation:  0.02962636947631836
local_in_edges_tensor generation:  0.17780375480651855
mini_batch_src_global generation:  0.36977624893188477
r_  generation:  5.538229465484619
local_output_nid generation:  0.02874755859375
local_in_edges_tensor generation:  0.22328972816467285
mini_batch_src_global generation:  0.4600241184234619
r_  generation:  5.8948187828063965
----------------------check_connections_block total spend ----------------------------- 14.766266107559204
generate_one_block  7.2434422969818115
generate_one_block  7.055090665817261
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.909849166870117
gen group dst list time:  0.09164547920227051
time for parepare:  0.4491257667541504
local_output_nid generation:  0.2617533206939697
local_in_edges_tensor generation:  1.6076676845550537
mini_batch_src_global generation:  2.5171401500701904
r_  generation:  30.27119541168213
local_output_nid generation:  0.5507359504699707
local_in_edges_tensor generation:  2.3814096450805664
mini_batch_src_global generation:  3.7244489192962646
r_  generation:  30.003095626831055
----------------------check_connections_block total spend ----------------------------- 84.35359644889832
generate_one_block  41.26527428627014
generate_one_block  40.929354429244995
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.172128677368164
gen group dst list time:  0.18210697174072266
time for parepare:  0.4488992691040039
local_output_nid generation:  0.37700629234313965
local_in_edges_tensor generation:  1.4943976402282715
mini_batch_src_global generation:  2.034101963043213
r_  generation:  25.70213770866394
local_output_nid generation:  0.7596561908721924
local_in_edges_tensor generation:  2.08878755569458
mini_batch_src_global generation:  2.972066879272461
r_  generation:  26.006198167800903
----------------------check_connections_block total spend ----------------------------- 72.02863454818726
generate_one_block  35.544782876968384
generate_one_block  36.184966802597046
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4287824630737305  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.38223099708557
block generation total time  153.92437839508057
average batch blocks generation time:  76.96218919754028
block dataloader generation time/epoch 367.3091575592122
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3983050584793091 |1.3374584913253784 |0.004410505294799805 |0.00014913082122802734 |0.004983663558959961 |0.0028531551361083984 |
----------------------------------------------------------pseudo_mini_loss sum 0.5530041456222534
Total (block generation + training)time/epoch 371.13116475369065
Training time/epoch 3.8989810943603516
Training time without block to device /epoch 1.2240641117095947
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.79it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.50it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.10it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.63it/s] 40%|████      | 10/25 [00:00<00:00, 17.93it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.04it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.21it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.26it/s] 80%|████████  | 20/25 [00:01<00:00, 18.18it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.73it/s] 96%|█████████▌| 24/25 [00:01<00:00, 14.93it/s]100%|██████████| 25/25 [00:01<00:00, 16.95it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.14it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.54it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.59it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.59it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.60it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.58it/s] 40%|████      | 10/25 [00:01<00:02,  6.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.60it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.61it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.62it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.62it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.61it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.60it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.60it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.57it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.53it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.55it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.66it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.21it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.41it/s] 20%|██        | 5/25 [00:00<00:03,  6.45it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.43it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.37it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.39it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.43it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.39it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]
Run 00 | Epoch 00047 | Loss 0.5530 | Train 0.6898 | Val 0.6801 | Test 0.5287
Number of nodes during this epoch:  4638156
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423242092132568  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1380600929260254
range selection method range initialization spend 0.041014671325683594
time for parepare:  0.379225492477417
local_output_nid generation:  0.026264190673828125
local_in_edges_tensor generation:  0.21495962142944336
mini_batch_src_global generation:  0.3791987895965576
r_  generation:  5.750725507736206
local_output_nid generation:  0.028581857681274414
local_in_edges_tensor generation:  0.23403191566467285
mini_batch_src_global generation:  0.4655930995941162
r_  generation:  6.038251876831055
----------------------check_connections_block total spend ----------------------------- 15.229642629623413
generate_one_block  7.266958236694336
generate_one_block  6.951246500015259
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8905491828918457
gen group dst list time:  0.09416866302490234
time for parepare:  0.4431881904602051
local_output_nid generation:  0.25206851959228516
local_in_edges_tensor generation:  1.6037774085998535
mini_batch_src_global generation:  2.528017282485962
r_  generation:  30.60232138633728
local_output_nid generation:  0.5173656940460205
local_in_edges_tensor generation:  2.243272066116333
mini_batch_src_global generation:  3.565730333328247
r_  generation:  30.698123693466187
----------------------check_connections_block total spend ----------------------------- 84.33670830726624
generate_one_block  40.99705624580383
generate_one_block  41.22542095184326
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.189605236053467
gen group dst list time:  0.18442392349243164
time for parepare:  0.4562385082244873
local_output_nid generation:  0.3653600215911865
local_in_edges_tensor generation:  1.5141725540161133
mini_batch_src_global generation:  1.99686598777771
r_  generation:  25.397305727005005
local_output_nid generation:  0.7129032611846924
local_in_edges_tensor generation:  2.086268663406372
mini_batch_src_global generation:  2.7809252738952637
r_  generation:  25.913584232330322
----------------------check_connections_block total spend ----------------------------- 71.24130392074585
generate_one_block  34.71835255622864
generate_one_block  35.76863503456116
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423242092132568  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.57801222801208
block generation total time  152.7094647884369
average batch blocks generation time:  76.35473239421844
block dataloader generation time/epoch 367.3045035948356
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39555561542510986 |1.3708949089050293 |0.004302978515625 |0.00014710426330566406 |0.005143404006958008 |0.0018527507781982422 |
----------------------------------------------------------pseudo_mini_loss sum 0.5473359823226929
Total (block generation + training)time/epoch 371.1294534355402
Training time/epoch 3.963082790374756
Training time without block to device /epoch 1.2212929725646973
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.23it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.86it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.47it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.85it/s] 40%|████      | 10/25 [00:00<00:00, 18.05it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.03it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.10it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.17it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.27it/s] 80%|████████  | 20/25 [00:01<00:00, 18.31it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.37it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.40it/s]100%|██████████| 25/25 [00:01<00:00, 18.29it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.43it/s]  8%|▊         | 2/25 [00:00<00:03,  6.55it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.33it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.43it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.49it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.49it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.19it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.27it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.10it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.13it/s] 60%|██████    | 15/25 [00:02<00:01,  6.05it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.97it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.01it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.97it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.09it/s] 80%|████████  | 20/25 [00:03<00:00,  6.19it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.30it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.46it/s]100%|██████████| 25/25 [00:03<00:00,  6.40it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.51it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.55it/s] 20%|██        | 5/25 [00:00<00:03,  6.56it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.51it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.29it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.28it/s] 60%|██████    | 15/25 [00:02<00:01,  6.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.07it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.06it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.15it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.15it/s] 80%|████████  | 20/25 [00:03<00:00,  6.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.27it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00048 | Loss 0.5473 | Train 0.6898 | Val 0.6810 | Test 0.5292
Number of nodes during this epoch:  4638171
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422526836395264  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.163367509841919
range selection method range initialization spend 0.024545907974243164
time for parepare:  0.3719499111175537
local_output_nid generation:  0.0256502628326416
local_in_edges_tensor generation:  0.16864013671875
mini_batch_src_global generation:  0.364086389541626
r_  generation:  5.424240827560425
local_output_nid generation:  0.028491973876953125
local_in_edges_tensor generation:  0.21959662437438965
mini_batch_src_global generation:  0.5007755756378174
r_  generation:  6.273291826248169
----------------------check_connections_block total spend ----------------------------- 15.055949926376343
generate_one_block  7.450087308883667
generate_one_block  6.953449726104736
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9549503326416016
gen group dst list time:  0.08905529975891113
time for parepare:  0.43827319145202637
local_output_nid generation:  0.2469637393951416
local_in_edges_tensor generation:  1.5816445350646973
mini_batch_src_global generation:  2.5675926208496094
r_  generation:  29.8196964263916
local_output_nid generation:  0.5172786712646484
local_in_edges_tensor generation:  2.058067560195923
mini_batch_src_global generation:  3.4903249740600586
r_  generation:  30.4520845413208
----------------------check_connections_block total spend ----------------------------- 83.45539784431458
generate_one_block  41.06354331970215
generate_one_block  40.967772245407104
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.51134991645813
gen group dst list time:  0.18554425239562988
time for parepare:  0.49669837951660156
local_output_nid generation:  0.4021930694580078
local_in_edges_tensor generation:  1.5483558177947998
mini_batch_src_global generation:  2.010373115539551
r_  generation:  26.316840648651123
local_output_nid generation:  0.7319560050964355
local_in_edges_tensor generation:  2.034240961074829
mini_batch_src_global generation:  2.8357224464416504
r_  generation:  26.27599549293518
----------------------check_connections_block total spend ----------------------------- 72.77880954742432
generate_one_block  35.35104703903198
generate_one_block  36.0782732963562
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422526836395264  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.2342073917389
block generation total time  153.46063590049744
average batch blocks generation time:  76.73031795024872
block dataloader generation time/epoch 367.33562220845903
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3862950801849365 |1.2994118928909302 |0.004357337951660156 |0.00014770030975341797 |0.005368828773498535 |0.0030257701873779297 |
----------------------------------------------------------pseudo_mini_loss sum 0.5399342179298401
Total (block generation + training)time/epoch 371.15995171118755
Training time/epoch 3.7943928241729736
Training time without block to device /epoch 1.1955690383911133
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.53it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.09it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.53it/s] 40%|████      | 10/25 [00:00<00:00, 17.85it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.03it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.16it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.16it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.06it/s] 80%|████████  | 20/25 [00:01<00:00, 18.12it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.23it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.19it/s]100%|██████████| 25/25 [00:01<00:00, 18.12it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.37it/s]  8%|▊         | 2/25 [00:00<00:04,  5.69it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.29it/s] 20%|██        | 5/25 [00:00<00:03,  5.23it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.18it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.15it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.89it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.16it/s] 40%|████      | 10/25 [00:01<00:02,  5.25it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.44it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.66it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.72it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.86it/s] 60%|██████    | 15/25 [00:02<00:01,  5.99it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.14it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.05it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.88it/s] 80%|████████  | 20/25 [00:03<00:00,  6.07it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.20it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.22it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.28it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.35it/s]100%|██████████| 25/25 [00:04<00:00,  5.87it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.81it/s]  8%|▊         | 2/25 [00:00<00:04,  5.61it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.54it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.72it/s] 20%|██        | 5/25 [00:00<00:03,  5.87it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.81it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.88it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.00it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.12it/s] 40%|████      | 10/25 [00:01<00:02,  6.22it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.18it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.24it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.27it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.27it/s] 60%|██████    | 15/25 [00:02<00:01,  6.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.24it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.27it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.33it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.32it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.37it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.31it/s]100%|██████████| 25/25 [00:04<00:00,  7.05it/s]100%|██████████| 25/25 [00:04<00:00,  6.23it/s]
Run 00 | Epoch 00049 | Loss 0.5399 | Train 0.6895 | Val 0.6806 | Test 0.5297
Number of nodes during this epoch:  4637820
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429001331329346  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.160151720046997
range selection method range initialization spend 0.024940967559814453
time for parepare:  0.3548014163970947
local_output_nid generation:  0.025727510452270508
local_in_edges_tensor generation:  0.23199963569641113
mini_batch_src_global generation:  0.3733687400817871
r_  generation:  5.457059860229492
local_output_nid generation:  0.027016401290893555
local_in_edges_tensor generation:  0.22518682479858398
mini_batch_src_global generation:  0.47487759590148926
r_  generation:  5.676027059555054
----------------------check_connections_block total spend ----------------------------- 14.49941635131836
generate_one_block  7.228562116622925
generate_one_block  6.820297479629517
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.156558990478516
gen group dst list time:  0.08742499351501465
time for parepare:  0.45290589332580566
local_output_nid generation:  0.23646783828735352
local_in_edges_tensor generation:  1.6806635856628418
mini_batch_src_global generation:  2.4596831798553467
r_  generation:  29.59979271888733
local_output_nid generation:  0.5067713260650635
local_in_edges_tensor generation:  2.084331750869751
mini_batch_src_global generation:  3.486830234527588
r_  generation:  29.845479249954224
----------------------check_connections_block total spend ----------------------------- 82.1440691947937
generate_one_block  40.88988208770752
generate_one_block  40.98368954658508
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1953160762786865
gen group dst list time:  0.190354585647583
time for parepare:  0.45290565490722656
local_output_nid generation:  0.40386462211608887
local_in_edges_tensor generation:  1.4921948909759521
mini_batch_src_global generation:  2.0954129695892334
r_  generation:  26.3270366191864
local_output_nid generation:  0.7383034229278564
local_in_edges_tensor generation:  1.9296035766601562
mini_batch_src_global generation:  2.8372528553009033
r_  generation:  25.909332036972046
----------------------check_connections_block total spend ----------------------------- 72.0590968132019
generate_one_block  35.2312593460083
generate_one_block  36.05805277824402
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429001331329346  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.2031660079956
block generation total time  153.16288375854492
average batch blocks generation time:  76.58144187927246
block dataloader generation time/epoch 367.2968758535385
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3860434293746948 |1.318949818611145 |0.004843592643737793 |0.00016987323760986328 |0.005052685737609863 |0.0036978721618652344 |
----------------------------------------------------------pseudo_mini_loss sum 0.5319619178771973
Total (block generation + training)time/epoch 371.12152851104736
Training time/epoch 3.840320587158203
Training time without block to device /epoch 1.202420949935913
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.12it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.47it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.15it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.61it/s] 40%|████      | 10/25 [00:00<00:01, 13.94it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.15it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.94it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.65it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.14it/s] 80%|████████  | 20/25 [00:01<00:00, 17.31it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.42it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.69it/s]100%|██████████| 25/25 [00:01<00:00, 16.97it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.10it/s]  8%|▊         | 2/25 [00:00<00:04,  5.09it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.07it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.10it/s] 20%|██        | 5/25 [00:00<00:03,  5.10it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.11it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.08it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.03it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.84it/s] 40%|████      | 10/25 [00:02<00:03,  4.59it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.73it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.99it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.27it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.54it/s] 60%|██████    | 15/25 [00:02<00:01,  5.83it/s] 64%|██████▍   | 16/25 [00:03<00:01,  6.07it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.24it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.57it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.32it/s] 80%|████████  | 20/25 [00:03<00:00,  5.06it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.27it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.22it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.10it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.02it/s]100%|██████████| 25/25 [00:04<00:00,  5.60it/s]100%|██████████| 25/25 [00:04<00:00,  5.26it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.74it/s]  8%|▊         | 2/25 [00:00<00:04,  4.94it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.99it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.01it/s] 20%|██        | 5/25 [00:01<00:03,  5.02it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.98it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.95it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.95it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.90it/s] 40%|████      | 10/25 [00:02<00:03,  4.86it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.16it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.47it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.75it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.94it/s] 60%|██████    | 15/25 [00:02<00:01,  6.09it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.78it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.75it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.92it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.07it/s] 80%|████████  | 20/25 [00:03<00:00,  6.17it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.78it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.98it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.11it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.22it/s]100%|██████████| 25/25 [00:04<00:00,  6.72it/s]100%|██████████| 25/25 [00:04<00:00,  5.63it/s]
Run 00 | Epoch 00050 | Loss 0.5320 | Train 0.6897 | Val 0.6800 | Test 0.5302
Number of nodes during this epoch:  4637113
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422950267791748  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1512436866760254
range selection method range initialization spend 0.02375507354736328
time for parepare:  0.37500643730163574
local_output_nid generation:  0.025786399841308594
local_in_edges_tensor generation:  0.19319987297058105
mini_batch_src_global generation:  0.3609294891357422
r_  generation:  5.524160146713257
local_output_nid generation:  0.028817415237426758
local_in_edges_tensor generation:  0.21740436553955078
mini_batch_src_global generation:  0.46077418327331543
r_  generation:  5.8495824337005615
----------------------check_connections_block total spend ----------------------------- 14.659322261810303
generate_one_block  7.272404432296753
generate_one_block  6.974501609802246
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8304104804992676
gen group dst list time:  0.09403491020202637
time for parepare:  0.4389688968658447
local_output_nid generation:  0.2662849426269531
local_in_edges_tensor generation:  1.6600329875946045
mini_batch_src_global generation:  2.652575969696045
r_  generation:  30.220755100250244
local_output_nid generation:  0.522395133972168
local_in_edges_tensor generation:  2.088155746459961
mini_batch_src_global generation:  3.501969814300537
r_  generation:  30.10428810119629
----------------------check_connections_block total spend ----------------------------- 83.4948513507843
generate_one_block  41.1109504699707
generate_one_block  41.234601974487305
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.259814739227295
gen group dst list time:  0.19135761260986328
time for parepare:  0.48732423782348633
local_output_nid generation:  0.38865065574645996
local_in_edges_tensor generation:  1.5111591815948486
mini_batch_src_global generation:  2.1491191387176514
r_  generation:  26.125340700149536
local_output_nid generation:  0.7287335395812988
local_in_edges_tensor generation:  2.1216869354248047
mini_batch_src_global generation:  2.919142961502075
r_  generation:  25.9791362285614
----------------------check_connections_block total spend ----------------------------- 72.40725183486938
generate_one_block  35.320258140563965
generate_one_block  36.85589265823364
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422950267791748  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.9021031856537
block generation total time  154.52170324325562
average batch blocks generation time:  77.26085162162781
block dataloader generation time/epoch 367.3461912519792
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39799606800079346 |1.3595712184906006 |0.00434565544128418 |0.00014853477478027344 |0.005106806755065918 |0.0018031597137451172 |
----------------------------------------------------------pseudo_mini_loss sum 0.5281649827957153
Total (block generation + training)time/epoch 371.1733155998529
Training time/epoch 3.9505436420440674
Training time without block to device /epoch 1.2314012050628662
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.85it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.03it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.48it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.87it/s] 40%|████      | 10/25 [00:00<00:00, 18.07it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.22it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.28it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.30it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.25it/s] 80%|████████  | 20/25 [00:01<00:00, 18.28it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.30it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.36it/s]100%|██████████| 25/25 [00:01<00:00, 18.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.62it/s]  8%|▊         | 2/25 [00:00<00:03,  6.67it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.69it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.64it/s] 20%|██        | 5/25 [00:00<00:03,  6.64it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.61it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.63it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.59it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.63it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.62it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.64it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.63it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.60it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.60it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.61it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.61it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.61it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.61it/s]100%|██████████| 25/25 [00:03<00:00,  6.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.52it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.56it/s] 20%|██        | 5/25 [00:00<00:03,  6.58it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.55it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.46it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.47it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.45it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.45it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.39it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
Run 00 | Epoch 00051 | Loss 0.5282 | Train 0.6900 | Val 0.6800 | Test 0.5307
Number of nodes during this epoch:  4637672
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421824932098389  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1498603820800781
range selection method range initialization spend 0.024985074996948242
time for parepare:  0.374208927154541
local_output_nid generation:  0.025917768478393555
local_in_edges_tensor generation:  0.20404720306396484
mini_batch_src_global generation:  0.40023088455200195
r_  generation:  5.553706645965576
local_output_nid generation:  0.029854536056518555
local_in_edges_tensor generation:  0.24921774864196777
mini_batch_src_global generation:  0.4609532356262207
r_  generation:  5.854573488235474
----------------------check_connections_block total spend ----------------------------- 14.87549877166748
generate_one_block  7.246153116226196
generate_one_block  6.914479732513428
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.030650615692139
gen group dst list time:  0.08950519561767578
time for parepare:  0.4481937885284424
local_output_nid generation:  0.24765276908874512
local_in_edges_tensor generation:  1.6277847290039062
mini_batch_src_global generation:  2.552313804626465
r_  generation:  30.121088981628418
local_output_nid generation:  0.5157732963562012
local_in_edges_tensor generation:  2.2631444931030273
mini_batch_src_global generation:  3.7757108211517334
r_  generation:  30.2570858001709
----------------------check_connections_block total spend ----------------------------- 83.70485401153564
generate_one_block  41.30430364608765
generate_one_block  40.8231303691864
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.200700044631958
gen group dst list time:  0.20287203788757324
time for parepare:  0.46738362312316895
local_output_nid generation:  0.4029240608215332
local_in_edges_tensor generation:  1.80061936378479
mini_batch_src_global generation:  2.02175235748291
r_  generation:  26.428627729415894
local_output_nid generation:  0.7298595905303955
local_in_edges_tensor generation:  2.015629529953003
mini_batch_src_global generation:  3.0127410888671875
r_  generation:  27.0518000125885
----------------------check_connections_block total spend ----------------------------- 74.56969451904297
generate_one_block  36.95682239532471
generate_one_block  37.50423502922058
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421824932098389  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  158.2745485305786
block generation total time  156.58849143981934
average batch blocks generation time:  78.29424571990967
block dataloader generation time/epoch 367.4790935974855
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37895143032073975 |1.3291752338409424 |0.004883885383605957 |0.00017702579498291016 |0.005219459533691406 |0.00399017333984375 |
----------------------------------------------------------pseudo_mini_loss sum 0.5222946405410767
Total (block generation + training)time/epoch 371.30659077259213
Training time/epoch 3.846336603164673
Training time without block to device /epoch 1.187986135482788
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.75it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.81it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.28it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.71it/s] 40%|████      | 10/25 [00:00<00:00, 17.13it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.42it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.46it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.38it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.56it/s] 80%|████████  | 20/25 [00:01<00:00, 17.71it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.69it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.77it/s]100%|██████████| 25/25 [00:01<00:00, 17.49it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.15it/s]  8%|▊         | 2/25 [00:00<00:04,  5.15it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.12it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.06it/s] 20%|██        | 5/25 [00:00<00:03,  5.55it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.91it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.57it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.89it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.16it/s] 40%|████      | 10/25 [00:01<00:02,  5.81it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.60it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.45it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.70it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.97it/s] 60%|██████    | 15/25 [00:02<00:01,  6.22it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.36it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.90it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.08it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.24it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.03it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.73it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.87it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.13it/s]100%|██████████| 25/25 [00:04<00:00,  5.95it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.93it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.76it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.98it/s] 20%|██        | 5/25 [00:00<00:03,  6.23it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.37it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.99it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.68it/s] 40%|████      | 10/25 [00:01<00:02,  5.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.32it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.62it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.85it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.05it/s] 60%|██████    | 15/25 [00:02<00:01,  5.67it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.91it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.15it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.79it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.57it/s] 80%|████████  | 20/25 [00:03<00:00,  5.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.35it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.25it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.17it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.12it/s]100%|██████████| 25/25 [00:04<00:00,  5.75it/s]100%|██████████| 25/25 [00:04<00:00,  5.72it/s]
Run 00 | Epoch 00052 | Loss 0.5223 | Train 0.6908 | Val 0.6802 | Test 0.5314
Number of nodes during this epoch:  4638183
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423648834228516  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0783119201660156
range selection method range initialization spend 0.024446725845336914
time for parepare:  0.36917710304260254
local_output_nid generation:  0.025896787643432617
local_in_edges_tensor generation:  0.20537018775939941
mini_batch_src_global generation:  0.37523317337036133
r_  generation:  5.604962348937988
local_output_nid generation:  0.028744220733642578
local_in_edges_tensor generation:  0.2397291660308838
mini_batch_src_global generation:  0.4618394374847412
r_  generation:  5.888005495071411
----------------------check_connections_block total spend ----------------------------- 14.852718830108643
generate_one_block  7.422593116760254
generate_one_block  7.343891143798828
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.761671543121338
gen group dst list time:  0.0923619270324707
time for parepare:  0.45427584648132324
local_output_nid generation:  0.25052833557128906
local_in_edges_tensor generation:  1.6394453048706055
mini_batch_src_global generation:  2.7019765377044678
r_  generation:  32.320916175842285
local_output_nid generation:  0.5483016967773438
local_in_edges_tensor generation:  2.1003692150115967
mini_batch_src_global generation:  4.439502239227295
r_  generation:  30.703211307525635
----------------------check_connections_block total spend ----------------------------- 88.04078030586243
generate_one_block  42.619590044021606
generate_one_block  42.5341637134552
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2438929080963135
gen group dst list time:  0.1810927391052246
time for parepare:  0.47757792472839355
local_output_nid generation:  0.4077284336090088
local_in_edges_tensor generation:  1.4887375831604004
mini_batch_src_global generation:  2.186490297317505
r_  generation:  26.796247720718384
local_output_nid generation:  0.7789011001586914
local_in_edges_tensor generation:  2.0321826934814453
mini_batch_src_global generation:  2.9217982292175293
r_  generation:  26.671892642974854
----------------------check_connections_block total spend ----------------------------- 74.48517894744873
generate_one_block  35.400593996047974
generate_one_block  36.01135969161987
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423648834228516  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  162.52595925331116
block generation total time  156.56570744514465
average batch blocks generation time:  78.28285372257233
block dataloader generation time/epoch 367.69295615969963
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3826324939727783 |1.303523302078247 |0.004843354225158691 |0.0001671314239501953 |0.005039215087890625 |0.001394033432006836 |
----------------------------------------------------------pseudo_mini_loss sum 0.5180423259735107
Total (block generation + training)time/epoch 371.5199911054575
Training time/epoch 3.8028404712677
Training time without block to device /epoch 1.195793867111206
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.42it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.72it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.06it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.46it/s] 40%|████      | 10/25 [00:00<00:00, 17.69it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.74it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.84it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.88it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.01it/s] 80%|████████  | 20/25 [00:01<00:00, 17.13it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.43it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.61it/s]100%|██████████| 25/25 [00:01<00:00, 17.34it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.52it/s]  8%|▊         | 2/25 [00:00<00:03,  6.67it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.66it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.63it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.63it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.59it/s] 40%|████      | 10/25 [00:01<00:02,  6.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.60it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.61it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.60it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.60it/s] 60%|██████    | 15/25 [00:02<00:01,  6.62it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.59it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.59it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.62it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.63it/s] 80%|████████  | 20/25 [00:03<00:00,  6.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.61it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.60it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.58it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.58it/s]100%|██████████| 25/25 [00:03<00:00,  7.27it/s]100%|██████████| 25/25 [00:03<00:00,  6.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.22it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.45it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.42it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.44it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.47it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.44it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.40it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.41it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  7.19it/s]100%|██████████| 25/25 [00:03<00:00,  6.51it/s]
Run 00 | Epoch 00053 | Loss 0.5180 | Train 0.6915 | Val 0.6814 | Test 0.5324
Number of nodes during this epoch:  4637484
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4236345291137695  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1987640857696533
range selection method range initialization spend 0.02408599853515625
time for parepare:  0.36301541328430176
local_output_nid generation:  0.026076078414916992
local_in_edges_tensor generation:  0.1722545623779297
mini_batch_src_global generation:  0.3722085952758789
r_  generation:  5.549209356307983
local_output_nid generation:  0.028203487396240234
local_in_edges_tensor generation:  0.2320241928100586
mini_batch_src_global generation:  0.4574699401855469
r_  generation:  5.605982542037964
----------------------check_connections_block total spend ----------------------------- 14.415315628051758
generate_one_block  7.343870639801025
generate_one_block  7.191279888153076
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.058565855026245
gen group dst list time:  0.09019017219543457
time for parepare:  0.45058345794677734
local_output_nid generation:  0.2551279067993164
local_in_edges_tensor generation:  1.6826286315917969
mini_batch_src_global generation:  2.4713730812072754
r_  generation:  29.925636053085327
local_output_nid generation:  0.5111584663391113
local_in_edges_tensor generation:  2.042262315750122
mini_batch_src_global generation:  3.495940923690796
r_  generation:  29.87079668045044
----------------------check_connections_block total spend ----------------------------- 82.67731547355652
generate_one_block  40.985095262527466
generate_one_block  40.883095502853394
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.0794730186462402
gen group dst list time:  0.18312287330627441
time for parepare:  0.4389982223510742
local_output_nid generation:  0.3878767490386963
local_in_edges_tensor generation:  1.4377796649932861
mini_batch_src_global generation:  2.1566548347473145
r_  generation:  26.21150040626526
local_output_nid generation:  0.7352063655853271
local_in_edges_tensor generation:  2.064284563064575
mini_batch_src_global generation:  2.8592982292175293
r_  generation:  26.208271503448486
----------------------check_connections_block total spend ----------------------------- 72.62792229652405
generate_one_block  35.45878553390503
generate_one_block  36.29086470603943
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4236345291137695  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.30523777008057
block generation total time  153.61784100532532
average batch blocks generation time:  76.80892050266266
block dataloader generation time/epoch 367.6926193546366
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3884769678115845 |1.2032498121261597 |0.004531264305114746 |0.00015985965728759766 |0.005246281623840332 |0.0015683174133300781 |
----------------------------------------------------------pseudo_mini_loss sum 0.5121994018554688
Total (block generation + training)time/epoch 371.5155664594085
Training time/epoch 3.6061065196990967
Training time without block to device /epoch 1.1996068954467773
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.65it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.06it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.63it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.81it/s] 40%|████      | 10/25 [00:00<00:00, 18.00it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.13it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.16it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.20it/s] 80%|████████  | 20/25 [00:01<00:00, 18.29it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.29it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.33it/s]100%|██████████| 25/25 [00:01<00:00, 18.31it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.31it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.50it/s] 20%|██        | 5/25 [00:00<00:03,  6.53it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.55it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.58it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.57it/s] 40%|████      | 10/25 [00:01<00:02,  6.57it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.58it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.60it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.62it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.62it/s] 60%|██████    | 15/25 [00:02<00:01,  6.62it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.62it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.60it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.63it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.63it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.62it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.61it/s]100%|██████████| 25/25 [00:03<00:00,  6.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.48it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.50it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.49it/s] 40%|████      | 10/25 [00:01<00:02,  6.49it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.51it/s] 60%|██████    | 15/25 [00:02<00:01,  6.53it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.51it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.49it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.61it/s]
Run 00 | Epoch 00054 | Loss 0.5122 | Train 0.6931 | Val 0.6829 | Test 0.5337
Number of nodes during this epoch:  4638318
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424546718597412  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1078667640686035
range selection method range initialization spend 0.02372121810913086
time for parepare:  0.3808164596557617
local_output_nid generation:  0.026072978973388672
local_in_edges_tensor generation:  0.21602463722229004
mini_batch_src_global generation:  0.37569236755371094
r_  generation:  5.642520904541016
local_output_nid generation:  0.02896428108215332
local_in_edges_tensor generation:  0.23214936256408691
mini_batch_src_global generation:  0.468029260635376
r_  generation:  5.923128843307495
----------------------check_connections_block total spend ----------------------------- 14.964422702789307
generate_one_block  7.213642597198486
generate_one_block  6.8900465965271
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.932366132736206
gen group dst list time:  0.09008264541625977
time for parepare:  0.4724423885345459
local_output_nid generation:  0.24333906173706055
local_in_edges_tensor generation:  1.6197314262390137
mini_batch_src_global generation:  2.605900526046753
r_  generation:  29.81403684616089
local_output_nid generation:  0.5216963291168213
local_in_edges_tensor generation:  2.3095879554748535
mini_batch_src_global generation:  3.7227113246917725
r_  generation:  29.7988498210907
----------------------check_connections_block total spend ----------------------------- 83.11233901977539
generate_one_block  40.874351024627686
generate_one_block  40.9416024684906
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.0873055458068848
gen group dst list time:  0.18386435508728027
time for parepare:  0.45441579818725586
local_output_nid generation:  0.3760852813720703
local_in_edges_tensor generation:  1.4455552101135254
mini_batch_src_global generation:  2.1181395053863525
r_  generation:  25.63992953300476
local_output_nid generation:  0.7593240737915039
local_in_edges_tensor generation:  2.1756064891815186
mini_batch_src_global generation:  2.91684627532959
r_  generation:  25.92482900619507
----------------------check_connections_block total spend ----------------------------- 72.00073742866516
generate_one_block  35.35203242301941
generate_one_block  35.777844190597534
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424546718597412  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.11307644844055
block generation total time  152.94583010673523
average batch blocks generation time:  76.47291505336761
block dataloader generation time/epoch 367.6721817883578
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4013712406158447 |1.3250128030776978 |0.004747867584228516 |0.0001652240753173828 |0.005164623260498047 |0.0028607845306396484 |
----------------------------------------------------------pseudo_mini_loss sum 0.5081127882003784
Total (block generation + training)time/epoch 371.49616348526695
Training time/epoch 3.8796868324279785
Training time without block to device /epoch 1.229661226272583
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.67it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.30it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.75it/s] 40%|████      | 10/25 [00:00<00:01, 14.08it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.19it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.10it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.79it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.22it/s] 80%|████████  | 20/25 [00:01<00:00, 17.51it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.75it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.89it/s]100%|██████████| 25/25 [00:01<00:00, 17.14it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.53it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.52it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.49it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.47it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.45it/s] 60%|██████    | 15/25 [00:02<00:01,  6.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.25it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.00it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.73it/s]100%|██████████| 25/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.81it/s]  8%|▊         | 2/25 [00:00<00:03,  6.20it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.40it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.45it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.46it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.46it/s] 40%|████      | 10/25 [00:01<00:02,  6.43it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.31it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.31it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.10it/s] 60%|██████    | 15/25 [00:02<00:01,  5.87it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.79it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.80it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.92it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.04it/s] 80%|████████  | 20/25 [00:03<00:00,  6.18it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.24it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.33it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:03<00:00,  6.34it/s]
Run 00 | Epoch 00055 | Loss 0.5081 | Train 0.6944 | Val 0.6846 | Test 0.5351
Number of nodes during this epoch:  4637514
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426745891571045  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1150259971618652
range selection method range initialization spend 0.0244753360748291
time for parepare:  0.35660314559936523
local_output_nid generation:  0.025781631469726562
local_in_edges_tensor generation:  0.18795371055603027
mini_batch_src_global generation:  0.37558984756469727
r_  generation:  5.393160343170166
local_output_nid generation:  0.028315067291259766
local_in_edges_tensor generation:  0.19382810592651367
mini_batch_src_global generation:  0.4587547779083252
r_  generation:  5.623843669891357
----------------------check_connections_block total spend ----------------------------- 14.276309967041016
generate_one_block  7.161764860153198
generate_one_block  7.149867534637451
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.912766456604004
gen group dst list time:  0.08907961845397949
time for parepare:  0.4416847229003906
local_output_nid generation:  0.23597383499145508
local_in_edges_tensor generation:  1.5921461582183838
mini_batch_src_global generation:  2.4404866695404053
r_  generation:  29.10670828819275
local_output_nid generation:  0.49855613708496094
local_in_edges_tensor generation:  2.080655097961426
mini_batch_src_global generation:  3.304328203201294
r_  generation:  30.18497633934021
----------------------check_connections_block total spend ----------------------------- 81.82700395584106
generate_one_block  41.178608417510986
generate_one_block  41.23369860649109
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.198286294937134
gen group dst list time:  0.18702960014343262
time for parepare:  0.4570012092590332
local_output_nid generation:  0.37802839279174805
local_in_edges_tensor generation:  1.451169729232788
mini_batch_src_global generation:  2.004836320877075
r_  generation:  25.401397943496704
local_output_nid generation:  0.7197465896606445
local_in_edges_tensor generation:  1.9024434089660645
mini_batch_src_global generation:  2.8053905963897705
r_  generation:  26.50687599182129
----------------------check_connections_block total spend ----------------------------- 71.61455392837524
generate_one_block  35.029661417007446
generate_one_block  35.44845485687256
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426745891571045  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.4415578842163
block generation total time  152.89042329788208
average batch blocks generation time:  76.44521164894104
block dataloader generation time/epoch 367.61405169963837
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38124871253967285 |1.378516435623169 |0.004318356513977051 |0.0001468658447265625 |0.004976391792297363 |0.0016105175018310547 |
----------------------------------------------------------pseudo_mini_loss sum 0.5023634433746338
Total (block generation + training)time/epoch 371.44039456333434
Training time/epoch 3.956040143966675
Training time without block to device /epoch 1.199007272720337
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.29it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.76it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.60it/s] 40%|████      | 10/25 [00:00<00:00, 17.78it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.68it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.51it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.77it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.87it/s] 80%|████████  | 20/25 [00:01<00:00, 17.79it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.80it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.95it/s]100%|██████████| 25/25 [00:01<00:00, 17.95it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.52it/s]  8%|▊         | 2/25 [00:00<00:05,  4.27it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.63it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.59it/s] 20%|██        | 5/25 [00:01<00:04,  4.68it/s] 24%|██▍       | 6/25 [00:01<00:04,  4.64it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.73it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.79it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.22it/s] 40%|████      | 10/25 [00:02<00:02,  5.59it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.90it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.15it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.75it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.79it/s] 60%|██████    | 15/25 [00:02<00:01,  5.57it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.43it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.62it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.90it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.57it/s] 80%|████████  | 20/25 [00:03<00:00,  5.87it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.12it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.24it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.33it/s]100%|██████████| 25/25 [00:04<00:00,  5.63it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.91it/s]  8%|▊         | 2/25 [00:00<00:03,  6.38it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.53it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.57it/s] 20%|██        | 5/25 [00:00<00:03,  6.55it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.99it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.57it/s] 40%|████      | 10/25 [00:01<00:02,  5.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.25it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.57it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.83it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.08it/s] 60%|██████    | 15/25 [00:02<00:01,  5.68it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.93it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.16it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.80it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.55it/s] 80%|████████  | 20/25 [00:03<00:00,  5.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.67it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.94it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.62it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.85it/s]100%|██████████| 25/25 [00:04<00:00,  5.97it/s]
Run 00 | Epoch 00056 | Loss 0.5024 | Train 0.6960 | Val 0.6861 | Test 0.5365
Number of nodes during this epoch:  4638147
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425125598907471  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.103797197341919
range selection method range initialization spend 0.034853458404541016
time for parepare:  0.38422369956970215
local_output_nid generation:  0.026540756225585938
local_in_edges_tensor generation:  0.22939705848693848
mini_batch_src_global generation:  0.3793370723724365
r_  generation:  5.676279783248901
local_output_nid generation:  0.02891397476196289
local_in_edges_tensor generation:  0.24181532859802246
mini_batch_src_global generation:  0.4629852771759033
r_  generation:  5.8784167766571045
----------------------check_connections_block total spend ----------------------------- 14.968416690826416
generate_one_block  7.267568111419678
generate_one_block  6.972758769989014
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.04917311668396
gen group dst list time:  0.09225010871887207
time for parepare:  0.4457395076751709
local_output_nid generation:  0.2572031021118164
local_in_edges_tensor generation:  1.6350412368774414
mini_batch_src_global generation:  2.6045925617218018
r_  generation:  29.98898482322693
local_output_nid generation:  0.5141928195953369
local_in_edges_tensor generation:  2.0625057220458984
mini_batch_src_global generation:  3.480851888656616
r_  generation:  30.29431676864624
----------------------check_connections_block total spend ----------------------------- 83.24730038642883
generate_one_block  40.89308309555054
generate_one_block  40.92393517494202
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.131793975830078
gen group dst list time:  0.1817617416381836
time for parepare:  0.4564368724822998
local_output_nid generation:  0.3751335144042969
local_in_edges_tensor generation:  1.4210171699523926
mini_batch_src_global generation:  2.008352756500244
r_  generation:  25.40925693511963
local_output_nid generation:  0.7264130115509033
local_in_edges_tensor generation:  1.9196553230285645
mini_batch_src_global generation:  2.7701640129089355
r_  generation:  26.04508638381958
----------------------check_connections_block total spend ----------------------------- 71.33679795265198
generate_one_block  34.72409462928772
generate_one_block  35.73637104034424
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425125598907471  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.5840983390808
block generation total time  152.2774839401245
average batch blocks generation time:  76.13874197006226
block dataloader generation time/epoch 367.58720712076155
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3835434913635254 |1.1946101188659668 |0.004302024841308594 |0.0001456737518310547 |0.005106091499328613 |0.00157928466796875 |
----------------------------------------------------------pseudo_mini_loss sum 0.49901917576789856
Total (block generation + training)time/epoch 371.40928497649077
Training time/epoch 3.5830790996551514
Training time without block to device /epoch 1.1938588619232178
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.12it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.82it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.41it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.60it/s] 40%|████      | 10/25 [00:00<00:00, 17.80it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.70it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.83it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.00it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.91it/s] 80%|████████  | 20/25 [00:01<00:00, 18.01it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.99it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.98it/s]100%|██████████| 25/25 [00:01<00:00, 17.82it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.97it/s]  8%|▊         | 2/25 [00:00<00:04,  5.05it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.08it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.12it/s] 20%|██        | 5/25 [00:00<00:03,  5.13it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.12it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.09it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.08it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.12it/s] 40%|████      | 10/25 [00:01<00:02,  5.12it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.93it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.15it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.35it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.22it/s] 60%|██████    | 15/25 [00:02<00:01,  5.08it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.42it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.69it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.93it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.60it/s] 80%|████████  | 20/25 [00:03<00:00,  5.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.42it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.75it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.95it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.12it/s]100%|██████████| 25/25 [00:04<00:00,  5.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.54it/s]  8%|▊         | 2/25 [00:00<00:04,  5.51it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.03it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.52it/s] 20%|██        | 5/25 [00:00<00:03,  5.32it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.22it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.10it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.08it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.03it/s] 40%|████      | 10/25 [00:01<00:03,  4.90it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.37it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.73it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.52it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.73it/s] 60%|██████    | 15/25 [00:02<00:01,  6.00it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.74it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.78it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.01it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.22it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.94it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.02it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.30it/s]100%|██████████| 25/25 [00:04<00:00,  5.83it/s]
Run 00 | Epoch 00057 | Loss 0.4990 | Train 0.6972 | Val 0.6873 | Test 0.5376
Number of nodes during this epoch:  4638243
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4238481521606445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.105978012084961
range selection method range initialization spend 0.03476071357727051
time for parepare:  0.3781256675720215
local_output_nid generation:  0.028848886489868164
local_in_edges_tensor generation:  0.20369291305541992
mini_batch_src_global generation:  0.3689460754394531
r_  generation:  5.4328601360321045
local_output_nid generation:  0.029001712799072266
local_in_edges_tensor generation:  0.23018503189086914
mini_batch_src_global generation:  0.47469615936279297
r_  generation:  5.788397789001465
----------------------check_connections_block total spend ----------------------------- 14.581235408782959
generate_one_block  7.229467153549194
generate_one_block  6.955363750457764
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9667608737945557
gen group dst list time:  0.09320425987243652
time for parepare:  0.4696955680847168
local_output_nid generation:  0.2572941780090332
local_in_edges_tensor generation:  1.7835443019866943
mini_batch_src_global generation:  2.5110230445861816
r_  generation:  29.999178409576416
local_output_nid generation:  0.530980110168457
local_in_edges_tensor generation:  2.4601948261260986
mini_batch_src_global generation:  3.725163221359253
r_  generation:  29.899983644485474
----------------------check_connections_block total spend ----------------------------- 83.50128507614136
generate_one_block  40.75675320625305
generate_one_block  41.21136832237244
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1238341331481934
gen group dst list time:  0.18772578239440918
time for parepare:  0.447939395904541
local_output_nid generation:  0.3757495880126953
local_in_edges_tensor generation:  1.4733023643493652
mini_batch_src_global generation:  2.0280516147613525
r_  generation:  25.60910940170288
local_output_nid generation:  0.755366325378418
local_in_edges_tensor generation:  2.0886049270629883
mini_batch_src_global generation:  3.0456159114837646
r_  generation:  25.922088861465454
----------------------check_connections_block total spend ----------------------------- 71.78653478622437
generate_one_block  35.3643274307251
generate_one_block  35.784592151641846
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4238481521606445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.28781986236572
block generation total time  153.11704111099243
average batch blocks generation time:  76.55852055549622
block dataloader generation time/epoch 367.57976532804554
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.391796350479126 |1.361838936805725 |0.009700536727905273 |0.00020933151245117188 |0.005265355110168457 |0.003854036331176758 |
----------------------------------------------------------pseudo_mini_loss sum 0.4966447353363037
Total (block generation + training)time/epoch 371.4040270797137
Training time/epoch 3.948564052581787
Training time without block to device /epoch 1.224886178970337
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.23it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.67it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.23it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.64it/s] 40%|████      | 10/25 [00:00<00:00, 17.86it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.05it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.13it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.23it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.93it/s] 80%|████████  | 20/25 [00:01<00:00, 18.01it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.13it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.81it/s]100%|██████████| 25/25 [00:01<00:00, 17.94it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.49it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.54it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.57it/s] 20%|██        | 5/25 [00:00<00:03,  5.99it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.09it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.21it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.40it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.44it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.43it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.45it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.42it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.46it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:03<00:00,  7.19it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.27it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.36it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.38it/s] 20%|██        | 5/25 [00:00<00:03,  6.35it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.37it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.42it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.40it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.35it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00058 | Loss 0.4966 | Train 0.6985 | Val 0.6886 | Test 0.5388
Number of nodes during this epoch:  4637994
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427830219268799  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1019845008850098
range selection method range initialization spend 0.02458977699279785
time for parepare:  0.3970069885253906
local_output_nid generation:  0.025716781616210938
local_in_edges_tensor generation:  0.183060884475708
mini_batch_src_global generation:  0.3752250671386719
r_  generation:  5.567915678024292
local_output_nid generation:  0.027852296829223633
local_in_edges_tensor generation:  0.21938753128051758
mini_batch_src_global generation:  0.4588043689727783
r_  generation:  5.648056507110596
----------------------check_connections_block total spend ----------------------------- 14.524121046066284
generate_one_block  7.3586156368255615
generate_one_block  7.165876150131226
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.214038133621216
gen group dst list time:  0.08988094329833984
time for parepare:  0.4702634811401367
local_output_nid generation:  0.24591660499572754
local_in_edges_tensor generation:  1.6403796672821045
mini_batch_src_global generation:  2.4689228534698486
r_  generation:  30.06876277923584
local_output_nid generation:  0.5202393531799316
local_in_edges_tensor generation:  2.197766065597534
mini_batch_src_global generation:  3.487527370452881
r_  generation:  30.32091784477234
----------------------check_connections_block total spend ----------------------------- 83.10619521141052
generate_one_block  41.0361065864563
generate_one_block  41.12663292884827
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1104671955108643
gen group dst list time:  0.18571901321411133
time for parepare:  0.45120668411254883
local_output_nid generation:  0.3925971984863281
local_in_edges_tensor generation:  1.4604103565216064
mini_batch_src_global generation:  2.2015724182128906
r_  generation:  26.015595197677612
local_output_nid generation:  0.7234683036804199
local_in_edges_tensor generation:  1.9178180694580078
mini_batch_src_global generation:  2.8345675468444824
r_  generation:  25.94612693786621
----------------------check_connections_block total spend ----------------------------- 71.92044615745544
generate_one_block  35.04240274429321
generate_one_block  35.78580904006958
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427830219268799  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.02664136886597
block generation total time  152.99095129966736
average batch blocks generation time:  76.49547564983368
block dataloader generation time/epoch 367.5656458887003
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38269639015197754 |1.2224129438400269 |0.004352927207946777 |0.00014674663543701172 |0.005109429359436035 |0.0029833316802978516 |
----------------------------------------------------------pseudo_mini_loss sum 0.4909525513648987
Total (block generation + training)time/epoch 371.3868111190149
Training time/epoch 3.6414051055908203
Training time without block to device /epoch 1.1965792179107666
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.25it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.77it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.40it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.79it/s] 40%|████      | 10/25 [00:00<00:00, 18.02it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.25it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.09it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.09it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.14it/s] 80%|████████  | 20/25 [00:01<00:00, 18.16it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.21it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.24it/s]100%|██████████| 25/25 [00:01<00:00, 18.26it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.48it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.95it/s] 20%|██        | 5/25 [00:00<00:03,  5.64it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.44it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.18it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.93it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.06it/s] 40%|████      | 10/25 [00:01<00:02,  5.28it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.48it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.66it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.86it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.99it/s] 60%|██████    | 15/25 [00:02<00:01,  6.17it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.89it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.65it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.84it/s] 76%|███████▌  | 19/25 [00:03<00:01,  6.00it/s] 80%|████████  | 20/25 [00:03<00:00,  6.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.28it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.02it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.17it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.29it/s]100%|██████████| 25/25 [00:04<00:00,  5.95it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.43it/s] 20%|██        | 5/25 [00:00<00:03,  6.38it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.01it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.81it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.85it/s] 40%|████      | 10/25 [00:01<00:02,  5.96it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.10it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.23it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.26it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.31it/s] 60%|██████    | 15/25 [00:02<00:01,  6.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.35it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.31it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
Run 00 | Epoch 00059 | Loss 0.4910 | Train 0.6994 | Val 0.6894 | Test 0.5396
Number of nodes during this epoch:  4638477
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424556255340576  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1441473960876465
range selection method range initialization spend 0.024384498596191406
time for parepare:  0.36885929107666016
local_output_nid generation:  0.026234865188598633
local_in_edges_tensor generation:  0.20584845542907715
mini_batch_src_global generation:  0.37932753562927246
r_  generation:  5.511506080627441
local_output_nid generation:  0.027896404266357422
local_in_edges_tensor generation:  0.21286654472351074
mini_batch_src_global generation:  0.4571502208709717
r_  generation:  5.576983213424683
----------------------check_connections_block total spend ----------------------------- 14.418160676956177
generate_one_block  7.317179918289185
generate_one_block  7.179879426956177
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8883111476898193
gen group dst list time:  0.10503363609313965
time for parepare:  0.4509451389312744
local_output_nid generation:  0.24732208251953125
local_in_edges_tensor generation:  1.6043431758880615
mini_batch_src_global generation:  2.488389492034912
r_  generation:  30.169017791748047
local_output_nid generation:  0.5149109363555908
local_in_edges_tensor generation:  2.1542320251464844
mini_batch_src_global generation:  3.7300686836242676
r_  generation:  29.885050773620605
----------------------check_connections_block total spend ----------------------------- 83.13048911094666
generate_one_block  40.62599539756775
generate_one_block  40.90442442893982
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1248202323913574
gen group dst list time:  0.1844344139099121
time for parepare:  0.46477437019348145
local_output_nid generation:  0.3779609203338623
local_in_edges_tensor generation:  1.4771170616149902
mini_batch_src_global generation:  2.0202126502990723
r_  generation:  25.92730736732483
local_output_nid generation:  0.7395501136779785
local_in_edges_tensor generation:  2.186134099960327
mini_batch_src_global generation:  2.9393656253814697
r_  generation:  26.019174098968506
----------------------check_connections_block total spend ----------------------------- 72.2135968208313
generate_one_block  35.41057229042053
generate_one_block  35.73225998878479
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424556255340576  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.34408593177795
block generation total time  152.6732521057129
average batch blocks generation time:  76.33662605285645
block dataloader generation time/epoch 367.5614619731903
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40187811851501465 |1.4196105003356934 |0.004842162132263184 |0.00016868114471435547 |0.005188941955566406 |0.0019102096557617188 |
----------------------------------------------------------pseudo_mini_loss sum 0.4880777895450592
Total (block generation + training)time/epoch 371.38680621782936
Training time/epoch 4.071741819381714
Training time without block to device /epoch 1.2325208187103271
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.00it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.65it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.18it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.45it/s] 40%|████      | 10/25 [00:00<00:01, 14.01it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.17it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.04it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.72it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.07it/s] 80%|████████  | 20/25 [00:01<00:00, 15.95it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.44it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.95it/s]100%|██████████| 25/25 [00:01<00:00, 16.35it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.92it/s]  8%|▊         | 2/25 [00:00<00:03,  6.17it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.16it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.33it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.52it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.49it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.55it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.57it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.58it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.20it/s] 60%|██████    | 15/25 [00:02<00:01,  6.30it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.52it/s]100%|██████████| 25/25 [00:03<00:00,  7.27it/s]100%|██████████| 25/25 [00:03<00:00,  6.53it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.26it/s]  8%|▊         | 2/25 [00:00<00:03,  6.19it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.35it/s] 20%|██        | 5/25 [00:00<00:03,  6.31it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.37it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.33it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.36it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.40it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.36it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.41it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.37it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:03<00:00,  7.14it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
Run 00 | Epoch 00060 | Loss 0.4881 | Train 0.6996 | Val 0.6895 | Test 0.5401
Number of nodes during this epoch:  4636466
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426278114318848  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.103569746017456
range selection method range initialization spend 0.026246070861816406
time for parepare:  0.3498079776763916
local_output_nid generation:  0.026393890380859375
local_in_edges_tensor generation:  0.16027355194091797
mini_batch_src_global generation:  0.3667256832122803
r_  generation:  5.426080703735352
local_output_nid generation:  0.027231454849243164
local_in_edges_tensor generation:  0.21140742301940918
mini_batch_src_global generation:  0.46038317680358887
r_  generation:  5.570393800735474
----------------------check_connections_block total spend ----------------------------- 14.183818340301514
generate_one_block  6.993036985397339
generate_one_block  6.789842128753662
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.005615949630737
gen group dst list time:  0.09644532203674316
time for parepare:  0.4589974880218506
local_output_nid generation:  0.2928781509399414
local_in_edges_tensor generation:  1.5856759548187256
mini_batch_src_global generation:  2.444284439086914
r_  generation:  29.58565878868103
local_output_nid generation:  0.5966908931732178
local_in_edges_tensor generation:  2.0690574645996094
mini_batch_src_global generation:  3.5676333904266357
r_  generation:  29.948078393936157
----------------------check_connections_block total spend ----------------------------- 82.66459512710571
generate_one_block  41.182806968688965
generate_one_block  41.08276033401489
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3314268589019775
gen group dst list time:  0.19046688079833984
time for parepare:  0.48368215560913086
local_output_nid generation:  0.40491604804992676
local_in_edges_tensor generation:  1.5467283725738525
mini_batch_src_global generation:  2.0149953365325928
r_  generation:  26.077040672302246
local_output_nid generation:  0.7183198928833008
local_in_edges_tensor generation:  1.9616622924804688
mini_batch_src_global generation:  2.8287854194641113
r_  generation:  26.25779628753662
----------------------check_connections_block total spend ----------------------------- 72.27438020706177
generate_one_block  35.07039260864258
generate_one_block  35.90412473678589
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426278114318848  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.93897533416748
block generation total time  153.24008464813232
average batch blocks generation time:  76.62004232406616
block dataloader generation time/epoch 367.52749616982504
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3854057788848877 |1.2330198287963867 |0.004313945770263672 |0.00014960765838623047 |0.005158662796020508 |0.0031070709228515625 |
----------------------------------------------------------pseudo_mini_loss sum 0.485112726688385
Total (block generation + training)time/epoch 371.3502315536874
Training time/epoch 3.6660449504852295
Training time without block to device /epoch 1.200005292892456
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.22it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.33it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.15it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.60it/s] 40%|████      | 10/25 [00:00<00:00, 17.73it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.91it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.93it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.03it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.08it/s] 80%|████████  | 20/25 [00:01<00:00, 18.07it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.14it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.11it/s]100%|██████████| 25/25 [00:01<00:00, 18.05it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.60it/s]  8%|▊         | 2/25 [00:00<00:04,  4.89it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.99it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.85it/s] 20%|██        | 5/25 [00:00<00:03,  5.32it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.71it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.27it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.06it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.36it/s] 40%|████      | 10/25 [00:01<00:02,  5.64it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.46it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.34it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.65it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.94it/s] 60%|██████    | 15/25 [00:02<00:01,  5.93it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.91it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.58it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.79it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.01it/s] 80%|████████  | 20/25 [00:03<00:00,  6.06it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.70it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.93it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.14it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.31it/s]100%|██████████| 25/25 [00:04<00:00,  5.80it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.77it/s]  8%|▊         | 2/25 [00:00<00:04,  5.69it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.10it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.51it/s] 20%|██        | 5/25 [00:00<00:03,  5.29it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.60it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.43it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.27it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.21it/s] 40%|████      | 10/25 [00:01<00:02,  5.17it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.11it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.46it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.81it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.63it/s] 60%|██████    | 15/25 [00:02<00:01,  5.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.72it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.99it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.65it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.87it/s] 80%|████████  | 20/25 [00:03<00:00,  6.11it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.74it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.00it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.23it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.85it/s]100%|██████████| 25/25 [00:04<00:00,  6.60it/s]100%|██████████| 25/25 [00:04<00:00,  5.73it/s]
Run 00 | Epoch 00061 | Loss 0.4851 | Train 0.6992 | Val 0.6897 | Test 0.5404
Number of nodes during this epoch:  4637360
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425588607788086  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1258893013000488
range selection method range initialization spend 0.03409075736999512
time for parepare:  0.37758755683898926
local_output_nid generation:  0.026703357696533203
local_in_edges_tensor generation:  0.24899506568908691
mini_batch_src_global generation:  0.3821732997894287
r_  generation:  5.469518423080444
local_output_nid generation:  0.029000282287597656
local_in_edges_tensor generation:  0.2155747413635254
mini_batch_src_global generation:  0.4834175109863281
r_  generation:  5.882197141647339
----------------------check_connections_block total spend ----------------------------- 14.812861919403076
generate_one_block  7.288984537124634
generate_one_block  7.075784921646118
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0005834102630615
gen group dst list time:  0.09389829635620117
time for parepare:  0.4693338871002197
local_output_nid generation:  0.26823997497558594
local_in_edges_tensor generation:  1.6255309581756592
mini_batch_src_global generation:  2.525493860244751
r_  generation:  29.85011577606201
local_output_nid generation:  0.5312774181365967
local_in_edges_tensor generation:  2.2786011695861816
mini_batch_src_global generation:  3.7419426441192627
r_  generation:  30.014846801757812
----------------------check_connections_block total spend ----------------------------- 83.29246592521667
generate_one_block  41.94829845428467
generate_one_block  41.12721061706543
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.108027935028076
gen group dst list time:  0.1830587387084961
time for parepare:  0.46532654762268066
local_output_nid generation:  0.37714624404907227
local_in_edges_tensor generation:  1.4719111919403076
mini_batch_src_global generation:  2.1994593143463135
r_  generation:  26.230761766433716
local_output_nid generation:  0.7310476303100586
local_in_edges_tensor generation:  2.197969913482666
mini_batch_src_global generation:  3.0789880752563477
r_  generation:  26.954575777053833
----------------------check_connections_block total spend ----------------------------- 73.90793895721436
generate_one_block  35.176499128341675
generate_one_block  35.92375302314758
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425588607788086  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.20040488243103
block generation total time  154.17576122283936
average batch blocks generation time:  77.08788061141968
block dataloader generation time/epoch 367.58117513118253
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4042097330093384 |1.3380154371261597 |0.005116820335388184 |0.00017023086547851562 |0.005045771598815918 |0.0017888545989990234 |
----------------------------------------------------------pseudo_mini_loss sum 0.4802579879760742
Total (block generation + training)time/epoch 371.4053823409542
Training time/epoch 3.913818836212158
Training time without block to device /epoch 1.2377879619598389
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.04it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.60it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.16it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.61it/s] 40%|████      | 10/25 [00:00<00:00, 17.83it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.95it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.06it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.13it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.10it/s] 80%|████████  | 20/25 [00:01<00:00, 18.18it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.24it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.29it/s]100%|██████████| 25/25 [00:01<00:00, 18.16it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.40it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.50it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.49it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.42it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.20it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.23it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.03it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.84it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  6.39it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.68it/s]  8%|▊         | 2/25 [00:00<00:03,  6.01it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.22it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.25it/s] 20%|██        | 5/25 [00:00<00:03,  6.29it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.27it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.31it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.14it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.90it/s] 60%|██████    | 15/25 [00:02<00:01,  5.87it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.95it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.06it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.15it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.27it/s] 80%|████████  | 20/25 [00:03<00:00,  6.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.42it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.49it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]
Run 00 | Epoch 00062 | Loss 0.4803 | Train 0.6987 | Val 0.6897 | Test 0.5407
Number of nodes during this epoch:  4637978
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426913261413574  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0983309745788574
range selection method range initialization spend 0.0242154598236084
time for parepare:  0.36207103729248047
local_output_nid generation:  0.02544689178466797
local_in_edges_tensor generation:  0.16474223136901855
mini_batch_src_global generation:  0.37163710594177246
r_  generation:  5.357396364212036
local_output_nid generation:  0.026304244995117188
local_in_edges_tensor generation:  0.19621992111206055
mini_batch_src_global generation:  0.477794885635376
r_  generation:  5.620087623596191
----------------------check_connections_block total spend ----------------------------- 14.193211078643799
generate_one_block  7.065678596496582
generate_one_block  6.714545726776123
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.173192024230957
gen group dst list time:  0.09220576286315918
time for parepare:  0.4515070915222168
local_output_nid generation:  0.24533414840698242
local_in_edges_tensor generation:  1.626197338104248
mini_batch_src_global generation:  2.465345621109009
r_  generation:  29.394072771072388
local_output_nid generation:  0.5094988346099854
local_in_edges_tensor generation:  2.039376735687256
mini_batch_src_global generation:  3.5117204189300537
r_  generation:  29.76335906982422
----------------------check_connections_block total spend ----------------------------- 81.52385544776917
generate_one_block  41.05832552909851
generate_one_block  40.92096710205078
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.282848834991455
gen group dst list time:  0.1824653148651123
time for parepare:  0.4629998207092285
local_output_nid generation:  0.37997913360595703
local_in_edges_tensor generation:  1.5132391452789307
mini_batch_src_global generation:  2.077191114425659
r_  generation:  26.276804208755493
local_output_nid generation:  0.724586009979248
local_in_edges_tensor generation:  2.0202903747558594
mini_batch_src_global generation:  2.808225393295288
r_  generation:  25.896007776260376
----------------------check_connections_block total spend ----------------------------- 72.08920812606812
generate_one_block  34.96739959716797
generate_one_block  35.93535614013672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426913261413574  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.61306357383728
block generation total time  152.88204836845398
average batch blocks generation time:  76.44102418422699
block dataloader generation time/epoch 367.51950475904675
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3887205123901367 |1.2020206451416016 |0.004416942596435547 |0.00014519691467285156 |0.00502467155456543 |0.0015223026275634766 |
----------------------------------------------------------pseudo_mini_loss sum 0.4748082160949707
Total (block generation + training)time/epoch 371.3403184603131
Training time/epoch 3.6102359294891357
Training time without block to device /epoch 1.2061946392059326
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.23it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.80it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.46it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.71it/s] 40%|████      | 10/25 [00:00<00:00, 17.78it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.78it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.20it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.51it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.74it/s] 80%|████████  | 20/25 [00:01<00:00, 17.86it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.94it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.96it/s]100%|██████████| 25/25 [00:01<00:00, 17.94it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.46it/s]  8%|▊         | 2/25 [00:00<00:03,  6.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  6.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.43it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.54it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.56it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.56it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.57it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.58it/s] 60%|██████    | 15/25 [00:02<00:01,  6.26it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.18it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.08it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.09it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.18it/s] 80%|████████  | 20/25 [00:03<00:00,  6.19it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.27it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.24it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:04,  4.60it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.09it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.18it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.29it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.45it/s] 40%|████      | 10/25 [00:01<00:02,  5.63it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.86it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.05it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.16it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.22it/s] 60%|██████    | 15/25 [00:02<00:01,  6.27it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.28it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.34it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.41it/s] 80%|████████  | 20/25 [00:03<00:00,  6.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:04<00:00,  6.15it/s]
Run 00 | Epoch 00063 | Loss 0.4748 | Train 0.6979 | Val 0.6890 | Test 0.5408
Number of nodes during this epoch:  4637970
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424831867218018  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1590182781219482
range selection method range initialization spend 0.026278972625732422
time for parepare:  0.3743283748626709
local_output_nid generation:  0.02595067024230957
local_in_edges_tensor generation:  0.2172718048095703
mini_batch_src_global generation:  0.3714282512664795
r_  generation:  5.3515403270721436
local_output_nid generation:  0.02702617645263672
local_in_edges_tensor generation:  0.21100473403930664
mini_batch_src_global generation:  0.47172117233276367
r_  generation:  5.632052183151245
----------------------check_connections_block total spend ----------------------------- 14.315404653549194
generate_one_block  7.202796459197998
generate_one_block  6.720211505889893
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.202576398849487
gen group dst list time:  0.08428764343261719
time for parepare:  0.44130444526672363
local_output_nid generation:  0.23961114883422852
local_in_edges_tensor generation:  1.6958932876586914
mini_batch_src_global generation:  2.5040974617004395
r_  generation:  30.84172797203064
local_output_nid generation:  0.5285689830780029
local_in_edges_tensor generation:  2.115952730178833
mini_batch_src_global generation:  3.7517573833465576
r_  generation:  30.320293188095093
----------------------check_connections_block total spend ----------------------------- 84.37878680229187
generate_one_block  42.01091742515564
generate_one_block  41.07627844810486
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3011410236358643
gen group dst list time:  0.2002100944519043
time for parepare:  0.48158693313598633
local_output_nid generation:  0.4266986846923828
local_in_edges_tensor generation:  1.6310112476348877
mini_batch_src_global generation:  2.0282809734344482
r_  generation:  26.03973412513733
local_output_nid generation:  0.7380506992340088
local_in_edges_tensor generation:  2.0064737796783447
mini_batch_src_global generation:  2.8300962448120117
r_  generation:  26.195919513702393
----------------------check_connections_block total spend ----------------------------- 72.5055148601532
generate_one_block  35.39982223510742
generate_one_block  36.171343088150024
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424831867218018  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.88430166244507
block generation total time  154.65836119651794
average batch blocks generation time:  77.32918059825897
block dataloader generation time/epoch 367.5554158873856
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38373517990112305 |1.3260846138000488 |0.0044171810150146484 |0.00014770030975341797 |0.0051048994064331055 |0.0020058155059814453 |
----------------------------------------------------------pseudo_mini_loss sum 0.47443968057632446
Total (block generation + training)time/epoch 371.37668485194445
Training time/epoch 3.849785566329956
Training time without block to device /epoch 1.1976163387298584
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.29it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.68it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.39it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:00, 17.74it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.79it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.94it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.11it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.18it/s] 80%|████████  | 20/25 [00:01<00:00, 18.23it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.28it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.23it/s]100%|██████████| 25/25 [00:01<00:00, 18.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:03,  6.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.71it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.70it/s] 20%|██        | 5/25 [00:00<00:02,  6.68it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.89it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.47it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.89it/s] 40%|████      | 10/25 [00:01<00:02,  6.10it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.97it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.85it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.90it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.93it/s] 60%|██████    | 15/25 [00:02<00:01,  5.95it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.05it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.09it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.19it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.69it/s] 80%|████████  | 20/25 [00:03<00:00,  5.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.78it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.00it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.21it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.28it/s]100%|██████████| 25/25 [00:04<00:00,  6.14it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.16it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.40it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.37it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.37it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.49it/s] 40%|████      | 10/25 [00:01<00:02,  6.55it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.55it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.44it/s] 60%|██████    | 15/25 [00:02<00:01,  6.46it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.47it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.49it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
Run 00 | Epoch 00064 | Loss 0.4744 | Train 0.6972 | Val 0.6884 | Test 0.5410
Number of nodes during this epoch:  4637733
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427319526672363  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1141352653503418
range selection method range initialization spend 0.025835514068603516
time for parepare:  0.35491275787353516
local_output_nid generation:  0.025864601135253906
local_in_edges_tensor generation:  0.2114865779876709
mini_batch_src_global generation:  0.37226080894470215
r_  generation:  5.3744282722473145
local_output_nid generation:  0.030885696411132812
local_in_edges_tensor generation:  0.21181392669677734
mini_batch_src_global generation:  0.46462440490722656
r_  generation:  5.604539394378662
----------------------check_connections_block total spend ----------------------------- 14.300339937210083
generate_one_block  7.117224931716919
generate_one_block  6.716116905212402
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.984407424926758
gen group dst list time:  0.08464360237121582
time for parepare:  0.44696903228759766
local_output_nid generation:  0.24623441696166992
local_in_edges_tensor generation:  1.6570463180541992
mini_batch_src_global generation:  2.4837160110473633
r_  generation:  29.72366213798523
local_output_nid generation:  0.5157058238983154
local_in_edges_tensor generation:  2.0331828594207764
mini_batch_src_global generation:  3.4792301654815674
r_  generation:  30.01157283782959
----------------------check_connections_block total spend ----------------------------- 82.33491396903992
generate_one_block  40.989086866378784
generate_one_block  40.917733669281006
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.0891244411468506
gen group dst list time:  0.18240857124328613
time for parepare:  0.4551846981048584
local_output_nid generation:  0.3834800720214844
local_in_edges_tensor generation:  1.4425098896026611
mini_batch_src_global generation:  2.0196022987365723
r_  generation:  25.48230004310608
local_output_nid generation:  0.7199437618255615
local_in_edges_tensor generation:  2.1034257411956787
mini_batch_src_global generation:  2.9287703037261963
r_  generation:  25.877919673919678
----------------------check_connections_block total spend ----------------------------- 71.56774020195007
generate_one_block  35.16903305053711
generate_one_block  35.55698370933533
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427319526672363  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.90265417099
block generation total time  152.63283729553223
average batch blocks generation time:  76.31641864776611
block dataloader generation time/epoch 367.5019807778872
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3018815517425537 |1.405943512916565 |0.05477273464202881 |0.0002231597900390625 |0.07451820373535156 |0.002048492431640625 |
----------------------------------------------------------pseudo_mini_loss sum 0.4713718295097351
Total (block generation + training)time/epoch 371.32729730972875
Training time/epoch 4.084205389022827
Training time without block to device /epoch 1.2723183631896973
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.68it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.81it/s] 40%|████      | 10/25 [00:00<00:01, 14.21it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.40it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.24it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.86it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.62it/s] 80%|████████  | 20/25 [00:01<00:00, 16.65it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.02it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.36it/s]100%|██████████| 25/25 [00:01<00:00, 16.90it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.42it/s]  8%|▊         | 2/25 [00:00<00:03,  6.00it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.15it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.27it/s] 20%|██        | 5/25 [00:00<00:03,  6.32it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.38it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.44it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.48it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.76it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.96it/s] 60%|██████    | 15/25 [00:02<00:01,  6.14it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.28it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.48it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.56it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.51it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.49it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
Run 00 | Epoch 00065 | Loss 0.4714 | Train 0.6967 | Val 0.6879 | Test 0.5413
Number of nodes during this epoch:  4637410
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423844814300537  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.097578525543213
range selection method range initialization spend 0.025650501251220703
time for parepare:  0.3583393096923828
local_output_nid generation:  0.0258023738861084
local_in_edges_tensor generation:  0.16167163848876953
mini_batch_src_global generation:  0.3667778968811035
r_  generation:  5.35355806350708
local_output_nid generation:  0.0269467830657959
local_in_edges_tensor generation:  0.21013331413269043
mini_batch_src_global generation:  0.45783472061157227
r_  generation:  5.501428127288818
----------------------check_connections_block total spend ----------------------------- 14.023766994476318
generate_one_block  6.886010646820068
generate_one_block  6.710609436035156
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.039566278457642
gen group dst list time:  0.08614873886108398
time for parepare:  0.41805005073547363
local_output_nid generation:  0.24065303802490234
local_in_edges_tensor generation:  1.594759464263916
mini_batch_src_global generation:  2.6072795391082764
r_  generation:  30.039511680603027
local_output_nid generation:  0.5239601135253906
local_in_edges_tensor generation:  2.090508460998535
mini_batch_src_global generation:  3.500710964202881
r_  generation:  30.591842651367188
----------------------check_connections_block total spend ----------------------------- 83.82035756111145
generate_one_block  41.239808559417725
generate_one_block  41.27550029754639
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.0257437229156494
gen group dst list time:  0.17908263206481934
time for parepare:  0.46021270751953125
local_output_nid generation:  0.37124133110046387
local_in_edges_tensor generation:  1.4364700317382812
mini_batch_src_global generation:  2.0097522735595703
r_  generation:  25.758919715881348
local_output_nid generation:  0.7249143123626709
local_in_edges_tensor generation:  1.9552466869354248
mini_batch_src_global generation:  2.702143907546997
r_  generation:  26.305740356445312
----------------------check_connections_block total spend ----------------------------- 71.66072535514832
generate_one_block  34.97560477256775
generate_one_block  35.88559436798096
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423844814300537  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.48108291625977
block generation total time  153.37650799751282
average batch blocks generation time:  76.68825399875641
block dataloader generation time/epoch 367.46781406258094
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.385373592376709 |1.3834238052368164 |0.004327654838562012 |0.00014722347259521484 |0.005018353462219238 |0.0015630722045898438 |
----------------------------------------------------------pseudo_mini_loss sum 0.4675056040287018
Total (block generation + training)time/epoch 371.2952060916207
Training time/epoch 3.9621376991271973
Training time without block to device /epoch 1.1952900886535645
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.76it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.47it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.23it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.67it/s] 40%|████      | 10/25 [00:00<00:00, 17.93it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.14it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.61it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.83it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.89it/s] 80%|████████  | 20/25 [00:01<00:00, 17.95it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.48it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.22it/s]100%|██████████| 25/25 [00:01<00:00, 17.73it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.52it/s]  8%|▊         | 2/25 [00:00<00:04,  5.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.70it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.62it/s] 20%|██        | 5/25 [00:00<00:03,  5.65it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.84it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.06it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.19it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.35it/s] 40%|████      | 10/25 [00:01<00:02,  5.81it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.61it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.53it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.81it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.98it/s] 60%|██████    | 15/25 [00:02<00:01,  6.11it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.29it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.95it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.51it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.38it/s]100%|██████████| 25/25 [00:04<00:00,  6.00it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.34it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.53it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.58it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.63it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.62it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.54it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.53it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.55it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.55it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.58it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.56it/s] 60%|██████    | 15/25 [00:02<00:01,  6.57it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.58it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.56it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.54it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.53it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.51it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.64it/s]
Run 00 | Epoch 00066 | Loss 0.4675 | Train 0.6969 | Val 0.6877 | Test 0.5418
Number of nodes during this epoch:  4638064
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423713207244873  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.12772798538208
range selection method range initialization spend 0.02517247200012207
time for parepare:  0.36046719551086426
local_output_nid generation:  0.02617645263671875
local_in_edges_tensor generation:  0.21348285675048828
mini_batch_src_global generation:  0.36987948417663574
r_  generation:  5.446284294128418
local_output_nid generation:  0.027941226959228516
local_in_edges_tensor generation:  0.21519732475280762
mini_batch_src_global generation:  0.4808807373046875
r_  generation:  5.74522590637207
----------------------check_connections_block total spend ----------------------------- 14.55374789237976
generate_one_block  7.268316745758057
generate_one_block  6.792374610900879
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.105248212814331
gen group dst list time:  0.08830022811889648
time for parepare:  0.44541239738464355
local_output_nid generation:  0.24714326858520508
local_in_edges_tensor generation:  1.7721374034881592
mini_batch_src_global generation:  2.485090970993042
r_  generation:  30.09364628791809
local_output_nid generation:  0.5228726863861084
local_in_edges_tensor generation:  2.176767349243164
mini_batch_src_global generation:  3.57924485206604
r_  generation:  30.405709505081177
----------------------check_connections_block total spend ----------------------------- 83.69257664680481
generate_one_block  40.795756101608276
generate_one_block  41.11710858345032
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3111305236816406
gen group dst list time:  0.198744535446167
time for parepare:  0.48367953300476074
local_output_nid generation:  0.4087357521057129
local_in_edges_tensor generation:  1.5433015823364258
mini_batch_src_global generation:  1.9947192668914795
r_  generation:  25.896245002746582
local_output_nid generation:  0.7403988838195801
local_in_edges_tensor generation:  2.1740031242370605
mini_batch_src_global generation:  2.929060697555542
r_  generation:  26.621931314468384
----------------------check_connections_block total spend ----------------------------- 73.2074363231659
generate_one_block  36.13724637031555
generate_one_block  36.080536127090454
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423713207244873  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.9000129699707
block generation total time  154.1306471824646
average batch blocks generation time:  77.0653235912323
block dataloader generation time/epoch 367.50562068241743
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39489591121673584 |1.408945918083191 |0.0044384002685546875 |0.00015246868133544922 |0.005076766014099121 |0.003244161605834961 |
----------------------------------------------------------pseudo_mini_loss sum 0.46470075845718384
Total (block generation + training)time/epoch 371.3361663142247
Training time/epoch 4.038518190383911
Training time without block to device /epoch 1.2206263542175293
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.75it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.26it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.11it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.56it/s] 40%|████      | 10/25 [00:00<00:00, 17.55it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.82it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.99it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.00it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.64it/s] 80%|████████  | 20/25 [00:01<00:00, 16.92it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.24it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.62it/s]100%|██████████| 25/25 [00:01<00:00, 17.23it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.26it/s]  8%|▊         | 2/25 [00:00<00:03,  6.09it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.29it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.30it/s] 20%|██        | 5/25 [00:00<00:03,  6.36it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.38it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.35it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.39it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.35it/s] 40%|████      | 10/25 [00:01<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.42it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.44it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:03,  6.31it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.39it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.32it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.32it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.34it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.27it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.29it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.28it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
Run 00 | Epoch 00067 | Loss 0.4647 | Train 0.6978 | Val 0.6880 | Test 0.5425
Number of nodes during this epoch:  4638059
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4233551025390625  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1114389896392822
range selection method range initialization spend 0.025108814239501953
time for parepare:  0.3655374050140381
local_output_nid generation:  0.02558302879333496
local_in_edges_tensor generation:  0.1658937931060791
mini_batch_src_global generation:  0.36141157150268555
r_  generation:  5.311748743057251
local_output_nid generation:  0.02661299705505371
local_in_edges_tensor generation:  0.2096712589263916
mini_batch_src_global generation:  0.4564652442932129
r_  generation:  5.450230360031128
----------------------check_connections_block total spend ----------------------------- 13.941828727722168
generate_one_block  6.883034944534302
generate_one_block  6.680359840393066
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9266738891601562
gen group dst list time:  0.08661317825317383
time for parepare:  0.41120362281799316
local_output_nid generation:  0.24361729621887207
local_in_edges_tensor generation:  1.6089417934417725
mini_batch_src_global generation:  2.444797992706299
r_  generation:  30.5130934715271
local_output_nid generation:  0.5225543975830078
local_in_edges_tensor generation:  2.0814242362976074
mini_batch_src_global generation:  3.5019123554229736
r_  generation:  30.154645919799805
----------------------check_connections_block total spend ----------------------------- 83.76969647407532
generate_one_block  41.38608980178833
generate_one_block  41.266756772994995
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1321194171905518
gen group dst list time:  0.18777179718017578
time for parepare:  0.49158358573913574
local_output_nid generation:  0.4078683853149414
local_in_edges_tensor generation:  1.569854497909546
mini_batch_src_global generation:  2.028292179107666
r_  generation:  26.3735933303833
local_output_nid generation:  0.7287225723266602
local_in_edges_tensor generation:  2.032047748565674
mini_batch_src_global generation:  2.8672142028808594
r_  generation:  26.140576601028442
----------------------check_connections_block total spend ----------------------------- 72.63093137741089
generate_one_block  35.38054919242859
generate_one_block  36.19758152961731
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4233551025390625  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.4006278514862
block generation total time  154.23097729682922
average batch blocks generation time:  77.11548864841461
block dataloader generation time/epoch 367.5003695558099
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39042627811431885 |1.3099817037582397 |0.004385471343994141 |0.0001493692398071289 |0.005199909210205078 |0.0017075538635253906 |
----------------------------------------------------------pseudo_mini_loss sum 0.46023356914520264
Total (block generation + training)time/epoch 371.3309059353436
Training time/epoch 3.829754590988159
Training time without block to device /epoch 1.2097911834716797
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.34it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.63it/s] 40%|████      | 10/25 [00:00<00:00, 17.81it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.03it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.03it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.01it/s] 80%|████████  | 20/25 [00:01<00:00, 18.12it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.20it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.15it/s]100%|██████████| 25/25 [00:01<00:00, 18.15it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  5.77it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.37it/s] 20%|██        | 5/25 [00:00<00:03,  5.31it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.26it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.20it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.20it/s] 40%|████      | 10/25 [00:01<00:02,  5.16it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.14it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.12it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.13it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.97it/s] 60%|██████    | 15/25 [00:02<00:01,  5.02it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.03it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.38it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.53it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.51it/s] 80%|████████  | 20/25 [00:03<00:00,  5.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.62it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.81it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.97it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.09it/s]100%|██████████| 25/25 [00:04<00:00,  6.89it/s]100%|██████████| 25/25 [00:04<00:00,  5.54it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.02it/s]  8%|▊         | 2/25 [00:00<00:03,  6.26it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.31it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.35it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.37it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.39it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.37it/s] 40%|████      | 10/25 [00:01<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.34it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.14it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.78it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.76it/s] 60%|██████    | 15/25 [00:02<00:01,  5.86it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.99it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.06it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.11it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.14it/s] 80%|████████  | 20/25 [00:03<00:00,  6.18it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.18it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.25it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.22it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.20it/s]100%|██████████| 25/25 [00:03<00:00,  6.27it/s]
Run 00 | Epoch 00068 | Loss 0.4602 | Train 0.6985 | Val 0.6888 | Test 0.5433
Number of nodes during this epoch:  4638194
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426353454589844  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0780365467071533
range selection method range initialization spend 0.02502608299255371
time for parepare:  0.3881556987762451
local_output_nid generation:  0.027304649353027344
local_in_edges_tensor generation:  0.2135477066040039
mini_batch_src_global generation:  0.3752574920654297
r_  generation:  5.69118070602417
local_output_nid generation:  0.028922557830810547
local_in_edges_tensor generation:  0.2328336238861084
mini_batch_src_global generation:  0.4647965431213379
r_  generation:  5.944549560546875
----------------------check_connections_block total spend ----------------------------- 15.053845167160034
generate_one_block  7.246187210083008
generate_one_block  6.94537878036499
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.93320631980896
gen group dst list time:  0.09623551368713379
time for parepare:  0.467954158782959
local_output_nid generation:  0.272066593170166
local_in_edges_tensor generation:  1.614051342010498
mini_batch_src_global generation:  2.532573938369751
r_  generation:  29.548361778259277
local_output_nid generation:  0.5161499977111816
local_in_edges_tensor generation:  2.3491344451904297
mini_batch_src_global generation:  3.6724162101745605
r_  generation:  29.625125885009766
----------------------check_connections_block total spend ----------------------------- 82.49800300598145
generate_one_block  40.51778054237366
generate_one_block  40.700326919555664
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.108198881149292
gen group dst list time:  0.18555665016174316
time for parepare:  0.4852585792541504
local_output_nid generation:  0.3794288635253906
local_in_edges_tensor generation:  1.4564933776855469
mini_batch_src_global generation:  2.0179834365844727
r_  generation:  25.44330358505249
local_output_nid generation:  0.730158805847168
local_in_edges_tensor generation:  2.128244161605835
mini_batch_src_global generation:  2.8891794681549072
r_  generation:  26.08530354499817
----------------------check_connections_block total spend ----------------------------- 71.6501841545105
generate_one_block  35.23309135437012
generate_one_block  35.66695547103882
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426353454589844  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.14818716049194
block generation total time  152.11815428733826
average batch blocks generation time:  76.05907714366913
block dataloader generation time/epoch 367.4756312681281
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39563775062561035 |1.3734588623046875 |0.005112886428833008 |0.00014674663543701172 |0.005159616470336914 |0.0030777454376220703 |
----------------------------------------------------------pseudo_mini_loss sum 0.45754486322402954
Total (block generation + training)time/epoch 371.3081902386486
Training time/epoch 3.969938278198242
Training time without block to device /epoch 1.2230205535888672
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.53it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.33it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.77it/s] 40%|████      | 10/25 [00:00<00:00, 18.01it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.13it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.23it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.25it/s] 80%|████████  | 20/25 [00:01<00:00, 18.30it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.34it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.35it/s]100%|██████████| 25/25 [00:01<00:00, 18.23it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.50it/s]  8%|▊         | 2/25 [00:00<00:03,  6.55it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.54it/s] 20%|██        | 5/25 [00:00<00:03,  6.58it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.59it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.63it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.61it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.61it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.62it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.63it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.62it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.59it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.59it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.56it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.56it/s]100%|██████████| 25/25 [00:03<00:00,  6.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.47it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.46it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.45it/s] 40%|████      | 10/25 [00:01<00:02,  6.47it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.47it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.46it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.47it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.50it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
Run 00 | Epoch 00069 | Loss 0.4575 | Train 0.6993 | Val 0.6900 | Test 0.5441
Number of nodes during this epoch:  4637779
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422229766845703  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0344009399414062
range selection method range initialization spend 0.024591922760009766
time for parepare:  0.3511850833892822
local_output_nid generation:  0.025850296020507812
local_in_edges_tensor generation:  0.18286514282226562
mini_batch_src_global generation:  0.373640775680542
r_  generation:  5.372941017150879
local_output_nid generation:  0.02646803855895996
local_in_edges_tensor generation:  0.19743824005126953
mini_batch_src_global generation:  0.45588111877441406
r_  generation:  5.523324728012085
----------------------check_connections_block total spend ----------------------------- 14.116451501846313
generate_one_block  6.880892038345337
generate_one_block  6.925063848495483
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.021186113357544
gen group dst list time:  0.0859830379486084
time for parepare:  0.41354823112487793
local_output_nid generation:  0.23932576179504395
local_in_edges_tensor generation:  1.5861389636993408
mini_batch_src_global generation:  2.619405746459961
r_  generation:  30.001924991607666
local_output_nid generation:  0.529714822769165
local_in_edges_tensor generation:  2.12400484085083
mini_batch_src_global generation:  4.02352237701416
r_  generation:  30.724451065063477
----------------------check_connections_block total spend ----------------------------- 84.58557629585266
generate_one_block  41.12176585197449
generate_one_block  41.28490877151489
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.238678216934204
gen group dst list time:  0.18943309783935547
time for parepare:  0.4492018222808838
local_output_nid generation:  0.37480950355529785
local_in_edges_tensor generation:  1.4803974628448486
mini_batch_src_global generation:  2.0189576148986816
r_  generation:  25.48314380645752
local_output_nid generation:  0.7412378787994385
local_in_edges_tensor generation:  1.934196949005127
mini_batch_src_global generation:  2.9990525245666504
r_  generation:  25.771949529647827
----------------------check_connections_block total spend ----------------------------- 71.52326107025146
generate_one_block  35.26019597053528
generate_one_block  36.00064253807068
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422229766845703  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.10883736610413
block generation total time  153.66751313209534
average batch blocks generation time:  76.83375656604767
block dataloader generation time/epoch 367.4661301953452
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3809858560562134 |1.311793565750122 |0.0045049190521240234 |0.00014770030975341797 |0.005153656005859375 |0.001611471176147461 |
----------------------------------------------------------pseudo_mini_loss sum 0.4564366936683655
Total (block generation + training)time/epoch 371.29844420978003
Training time/epoch 3.8152241706848145
Training time without block to device /epoch 1.1916370391845703
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.07it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.68it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.91it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.32it/s] 40%|████      | 10/25 [00:00<00:01, 13.85it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.85it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.25it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.75it/s] 80%|████████  | 20/25 [00:01<00:00, 17.24it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.57it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.70it/s]100%|██████████| 25/25 [00:01<00:00, 16.90it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.49it/s]  8%|▊         | 2/25 [00:00<00:03,  6.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.70it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.02it/s] 20%|██        | 5/25 [00:00<00:03,  5.68it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.44it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.30it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.21it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.02it/s] 40%|████      | 10/25 [00:01<00:02,  5.09it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.42it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.33it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.05it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.83it/s] 60%|██████    | 15/25 [00:02<00:01,  5.11it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.48it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.28it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.19it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.43it/s] 80%|████████  | 20/25 [00:03<00:00,  5.73it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.92it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.11it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.27it/s]100%|██████████| 25/25 [00:04<00:00,  5.68it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.17it/s]  8%|▊         | 2/25 [00:00<00:03,  6.31it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.35it/s] 20%|██        | 5/25 [00:00<00:03,  6.41it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.43it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.54it/s] 40%|████      | 10/25 [00:01<00:02,  6.58it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.57it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.51it/s] 60%|██████    | 15/25 [00:02<00:01,  6.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.56it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.55it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.55it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.49it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.54it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
Run 00 | Epoch 00070 | Loss 0.4564 | Train 0.7001 | Val 0.6904 | Test 0.5450
Number of nodes during this epoch:  4636776
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4289398193359375  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.110732078552246
range selection method range initialization spend 0.024705886840820312
time for parepare:  0.37932872772216797
local_output_nid generation:  0.02602219581604004
local_in_edges_tensor generation:  0.2118844985961914
mini_batch_src_global generation:  0.3680558204650879
r_  generation:  5.314724683761597
local_output_nid generation:  0.030956029891967773
local_in_edges_tensor generation:  0.20930695533752441
mini_batch_src_global generation:  0.4622666835784912
r_  generation:  5.555149555206299
----------------------check_connections_block total spend ----------------------------- 14.182340860366821
generate_one_block  7.106917858123779
generate_one_block  6.698955297470093
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0518128871917725
gen group dst list time:  0.08629775047302246
time for parepare:  0.42270541191101074
local_output_nid generation:  0.23375749588012695
local_in_edges_tensor generation:  1.5161631107330322
mini_batch_src_global generation:  2.5150415897369385
r_  generation:  30.526459455490112
local_output_nid generation:  0.5041635036468506
local_in_edges_tensor generation:  2.0380873680114746
mini_batch_src_global generation:  3.4845056533813477
r_  generation:  29.94578981399536
----------------------check_connections_block total spend ----------------------------- 82.87720775604248
generate_one_block  40.91917371749878
generate_one_block  41.14060878753662
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1612486839294434
gen group dst list time:  0.18452835083007812
time for parepare:  0.47542667388916016
local_output_nid generation:  0.4128553867340088
local_in_edges_tensor generation:  1.546452522277832
mini_batch_src_global generation:  2.1847083568573
r_  generation:  26.484986543655396
local_output_nid generation:  0.7329835891723633
local_in_edges_tensor generation:  1.9194951057434082
mini_batch_src_global generation:  2.8264920711517334
r_  generation:  26.110539197921753
----------------------check_connections_block total spend ----------------------------- 72.57626247406006
generate_one_block  35.445122957229614
generate_one_block  36.09485459327698
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4289398193359375  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.45347023010254
block generation total time  153.599760055542
average batch blocks generation time:  76.799880027771
block dataloader generation time/epoch 367.4552249001785
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3893001079559326 |1.3098900318145752 |0.004541635513305664 |0.00014972686767578125 |0.0049495697021484375 |0.0030236244201660156 |
----------------------------------------------------------pseudo_mini_loss sum 0.45391595363616943
Total (block generation + training)time/epoch 371.28749734583033
Training time/epoch 3.829176425933838
Training time without block to device /epoch 1.2093963623046875
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.97it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.62it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.23it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.47it/s] 40%|████      | 10/25 [00:00<00:00, 17.66it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.85it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.96it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.06it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.08it/s] 80%|████████  | 20/25 [00:01<00:00, 18.08it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.15it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.13it/s]100%|██████████| 25/25 [00:01<00:00, 18.08it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.43it/s]  8%|▊         | 2/25 [00:00<00:03,  6.47it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.37it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.43it/s] 40%|████      | 10/25 [00:01<00:02,  6.40it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.42it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.40it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.41it/s] 80%|████████  | 20/25 [00:03<00:00,  6.42it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.44it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.41it/s]100%|██████████| 25/25 [00:03<00:00,  6.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.17it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.37it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.37it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.38it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.20it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.28it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.25it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.30it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.34it/s] 60%|██████    | 15/25 [00:02<00:01,  6.18it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.21it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.19it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.02it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.09it/s] 80%|████████  | 20/25 [00:03<00:00,  6.01it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.13it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.19it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.27it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.24it/s]100%|██████████| 25/25 [00:03<00:00,  6.35it/s]
Run 00 | Epoch 00071 | Loss 0.4539 | Train 0.7007 | Val 0.6908 | Test 0.5457
Number of nodes during this epoch:  4637089
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426212310791016  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1755433082580566
range selection method range initialization spend 0.02845001220703125
time for parepare:  0.3608543872833252
local_output_nid generation:  0.02572035789489746
local_in_edges_tensor generation:  0.1951279640197754
mini_batch_src_global generation:  0.37631750106811523
r_  generation:  5.707914590835571
local_output_nid generation:  0.02908015251159668
local_in_edges_tensor generation:  0.23379182815551758
mini_batch_src_global generation:  0.47611165046691895
r_  generation:  5.938383102416992
----------------------check_connections_block total spend ----------------------------- 15.059833526611328
generate_one_block  7.229695796966553
generate_one_block  6.905011177062988
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9229204654693604
gen group dst list time:  0.09560465812683105
time for parepare:  0.4433321952819824
local_output_nid generation:  0.2389059066772461
local_in_edges_tensor generation:  1.6002051830291748
mini_batch_src_global generation:  2.4124324321746826
r_  generation:  29.289146423339844
local_output_nid generation:  0.5147178173065186
local_in_edges_tensor generation:  2.095508337020874
mini_batch_src_global generation:  3.348682403564453
r_  generation:  30.023640394210815
----------------------check_connections_block total spend ----------------------------- 81.55168461799622
generate_one_block  41.477947473526
generate_one_block  41.27088689804077
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2446353435516357
gen group dst list time:  0.18301916122436523
time for parepare:  0.45954370498657227
local_output_nid generation:  0.38024258613586426
local_in_edges_tensor generation:  1.50321626663208
mini_batch_src_global generation:  2.078117609024048
r_  generation:  26.19680690765381
local_output_nid generation:  0.7132272720336914
local_in_edges_tensor generation:  2.036237955093384
mini_batch_src_global generation:  2.83662486076355
r_  generation:  25.753865003585815
----------------------check_connections_block total spend ----------------------------- 71.76683950424194
generate_one_block  35.091010093688965
generate_one_block  35.92333149909973
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426212310791016  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.31852412223816
block generation total time  153.76317596435547
average batch blocks generation time:  76.88158798217773
block dataloader generation time/epoch 367.4300097690688
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.387803316116333 |1.2968745231628418 |0.004330158233642578 |0.00014710426330566406 |0.0051136016845703125 |0.001692056655883789 |
----------------------------------------------------------pseudo_mini_loss sum 0.4522736072540283
Total (block generation + training)time/epoch 371.26182370715674
Training time/epoch 3.799098014831543
Training time without block to device /epoch 1.2053489685058594
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.82it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.32it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.67it/s] 40%|████      | 10/25 [00:00<00:00, 17.92it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.07it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.19it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.20it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.25it/s] 80%|████████  | 20/25 [00:01<00:00, 18.33it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.28it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.36it/s]100%|██████████| 25/25 [00:01<00:00, 18.29it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.45it/s]  8%|▊         | 2/25 [00:00<00:03,  6.57it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.61it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.62it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.58it/s] 40%|████      | 10/25 [00:01<00:02,  6.58it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.62it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.62it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.62it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.63it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.62it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.60it/s] 80%|████████  | 20/25 [00:03<00:00,  6.60it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.63it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.62it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.62it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.63it/s]100%|██████████| 25/25 [00:03<00:00,  6.71it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.37it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.48it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.55it/s] 20%|██        | 5/25 [00:00<00:03,  6.57it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.56it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.58it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.56it/s] 40%|████      | 10/25 [00:01<00:02,  6.56it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.47it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.31it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.19it/s] 60%|██████    | 15/25 [00:02<00:01,  6.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.23it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.29it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.53it/s]
Run 00 | Epoch 00072 | Loss 0.4523 | Train 0.7008 | Val 0.6907 | Test 0.5462
Number of nodes during this epoch:  4637609
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426534652709961  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1300737857818604
range selection method range initialization spend 0.033563852310180664
time for parepare:  0.34411120414733887
local_output_nid generation:  0.026465892791748047
local_in_edges_tensor generation:  0.17099761962890625
mini_batch_src_global generation:  0.36704158782958984
r_  generation:  5.688168287277222
local_output_nid generation:  0.028902053833007812
local_in_edges_tensor generation:  0.23334813117980957
mini_batch_src_global generation:  0.47325825691223145
r_  generation:  5.779689788818359
----------------------check_connections_block total spend ----------------------------- 14.797035455703735
generate_one_block  7.215548992156982
generate_one_block  6.877962112426758
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.956554651260376
gen group dst list time:  0.08627438545227051
time for parepare:  0.44129443168640137
local_output_nid generation:  0.25408411026000977
local_in_edges_tensor generation:  1.747694492340088
mini_batch_src_global generation:  2.509430408477783
r_  generation:  30.01481819152832
local_output_nid generation:  0.5281460285186768
local_in_edges_tensor generation:  2.10658597946167
mini_batch_src_global generation:  3.5057413578033447
r_  generation:  30.127543210983276
----------------------check_connections_block total spend ----------------------------- 83.26800036430359
generate_one_block  40.910582542419434
generate_one_block  40.9579758644104
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1906299591064453
gen group dst list time:  0.1918020248413086
time for parepare:  0.47327733039855957
local_output_nid generation:  0.3885524272918701
local_in_edges_tensor generation:  1.4902808666229248
mini_batch_src_global generation:  2.1233930587768555
r_  generation:  26.323479175567627
local_output_nid generation:  0.7543983459472656
local_in_edges_tensor generation:  2.0563225746154785
mini_batch_src_global generation:  2.836000442504883
r_  generation:  26.159689903259277
----------------------check_connections_block total spend ----------------------------- 72.513503074646
generate_one_block  35.361825704574585
generate_one_block  36.172914266586304
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426534652709961  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.78150343894958
block generation total time  153.40329837799072
average batch blocks generation time:  76.70164918899536
block dataloader generation time/epoch 367.42474335187103
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3967258930206299 |1.2272100448608398 |0.0043784379959106445 |0.00014853477478027344 |0.005142569541931152 |0.002440214157104492 |
----------------------------------------------------------pseudo_mini_loss sum 0.4482533037662506
Total (block generation + training)time/epoch 371.25447109300796
Training time/epoch 3.6793582439422607
Training time without block to device /epoch 1.224938154220581
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.75it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.22it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.63it/s] 40%|████      | 10/25 [00:00<00:00, 17.82it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.97it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.05it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.01it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.06it/s] 80%|████████  | 20/25 [00:01<00:00, 17.84it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.98it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.03it/s]100%|██████████| 25/25 [00:01<00:00, 18.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.25it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.45it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.50it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.33it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.09it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.08it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.12it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.99it/s] 60%|██████    | 15/25 [00:02<00:01,  6.00it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.08it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.12it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.19it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.95it/s] 80%|████████  | 20/25 [00:03<00:00,  5.91it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.93it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.10it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.18it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.43it/s]100%|██████████| 25/25 [00:04<00:00,  6.02it/s]100%|██████████| 25/25 [00:04<00:00,  6.13it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.25it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.54it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.53it/s] 20%|██        | 5/25 [00:00<00:03,  6.52it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.50it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.49it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.96it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.52it/s] 40%|████      | 10/25 [00:01<00:02,  5.28it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.66it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.95it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.17it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.25it/s] 60%|██████    | 15/25 [00:02<00:01,  6.34it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.54it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.56it/s] 80%|████████  | 20/25 [00:03<00:00,  6.58it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.59it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.60it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.03it/s]100%|██████████| 25/25 [00:03<00:00,  6.77it/s]100%|██████████| 25/25 [00:03<00:00,  6.31it/s]
Run 00 | Epoch 00073 | Loss 0.4483 | Train 0.7009 | Val 0.6903 | Test 0.5467
Number of nodes during this epoch:  4636855
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42913818359375  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1269500255584717
range selection method range initialization spend 0.02670741081237793
time for parepare:  0.39423656463623047
local_output_nid generation:  0.030681371688842773
local_in_edges_tensor generation:  0.24443721771240234
mini_batch_src_global generation:  0.38184618949890137
r_  generation:  5.644686937332153
local_output_nid generation:  0.028593778610229492
local_in_edges_tensor generation:  0.22617363929748535
mini_batch_src_global generation:  0.45835447311401367
r_  generation:  5.912855863571167
----------------------check_connections_block total spend ----------------------------- 15.011944770812988
generate_one_block  7.253934860229492
generate_one_block  6.99623966217041
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9788925647735596
gen group dst list time:  0.09209275245666504
time for parepare:  0.44478487968444824
local_output_nid generation:  0.2515430450439453
local_in_edges_tensor generation:  1.7364637851715088
mini_batch_src_global generation:  2.4994771480560303
r_  generation:  29.87520718574524
local_output_nid generation:  0.5247588157653809
local_in_edges_tensor generation:  2.3705251216888428
mini_batch_src_global generation:  3.4986937046051025
r_  generation:  30.27886724472046
----------------------check_connections_block total spend ----------------------------- 83.4671459197998
generate_one_block  41.08010745048523
generate_one_block  41.24729561805725
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.170300245285034
gen group dst list time:  0.19326090812683105
time for parepare:  0.4496424198150635
local_output_nid generation:  0.3907468318939209
local_in_edges_tensor generation:  1.532576084136963
mini_batch_src_global generation:  2.0784268379211426
r_  generation:  26.150584936141968
local_output_nid generation:  0.7394819259643555
local_in_edges_tensor generation:  1.9415919780731201
mini_batch_src_global generation:  2.911691665649414
r_  generation:  26.2083158493042
----------------------check_connections_block total spend ----------------------------- 72.37388062477112
generate_one_block  35.349976778030396
generate_one_block  36.09935975074768
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42913818359375  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.84102654457092
block generation total time  153.77673959732056
average batch blocks generation time:  76.88836979866028
block dataloader generation time/epoch 367.441944563711
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3793821334838867 |1.3179011344909668 |0.004384279251098633 |0.00015103816986083984 |0.005202770233154297 |0.003078460693359375 |
----------------------------------------------------------pseudo_mini_loss sum 0.4476681053638458
Total (block generation + training)time/epoch 371.2716095125353
Training time/epoch 3.8249223232269287
Training time without block to device /epoch 1.1891200542449951
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.57it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.09it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.15it/s] 40%|████      | 10/25 [00:00<00:00, 17.57it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.53it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.62it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.49it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.64it/s] 80%|████████  | 20/25 [00:01<00:00, 17.71it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.90it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.05it/s]100%|██████████| 25/25 [00:01<00:00, 17.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.29it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.93it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.61it/s] 20%|██        | 5/25 [00:00<00:03,  5.97it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.24it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.59it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.70it/s] 40%|████      | 10/25 [00:01<00:02,  6.78it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.83it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.64it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.63it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.33it/s] 60%|██████    | 15/25 [00:02<00:01,  6.02it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.02it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.12it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.25it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.56it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.69it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.13it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.73it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.49it/s]100%|██████████| 25/25 [00:04<00:00,  5.83it/s]100%|██████████| 25/25 [00:04<00:00,  6.21it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.69it/s]  8%|▊         | 2/25 [00:00<00:04,  4.73it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.74it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.84it/s] 20%|██        | 5/25 [00:01<00:04,  4.66it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.98it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.34it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.18it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.48it/s] 40%|████      | 10/25 [00:01<00:02,  5.79it/s] 44%|████▍     | 11/25 [00:02<00:02,  6.05it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.18it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.31it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.40it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.55it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.57it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.05it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.67it/s] 80%|████████  | 20/25 [00:03<00:00,  5.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.14it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.47it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.79it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.01it/s]100%|██████████| 25/25 [00:04<00:00,  5.77it/s]
Run 00 | Epoch 00074 | Loss 0.4477 | Train 0.7004 | Val 0.6904 | Test 0.5470
Number of nodes during this epoch:  4637543
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42365837097168  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1164140701293945
range selection method range initialization spend 0.025030136108398438
time for parepare:  0.36998605728149414
local_output_nid generation:  0.03025364875793457
local_in_edges_tensor generation:  0.224623441696167
mini_batch_src_global generation:  0.3739504814147949
r_  generation:  5.565764427185059
local_output_nid generation:  0.028076648712158203
local_in_edges_tensor generation:  0.22702932357788086
mini_batch_src_global generation:  0.45899105072021484
r_  generation:  5.596991539001465
----------------------check_connections_block total spend ----------------------------- 14.546700477600098
generate_one_block  7.294061660766602
generate_one_block  7.137108087539673
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.101597785949707
gen group dst list time:  0.08855390548706055
time for parepare:  0.4457252025604248
local_output_nid generation:  0.24544715881347656
local_in_edges_tensor generation:  1.6861941814422607
mini_batch_src_global generation:  2.451814651489258
r_  generation:  29.426473140716553
local_output_nid generation:  0.5078754425048828
local_in_edges_tensor generation:  2.074692964553833
mini_batch_src_global generation:  3.4970345497131348
r_  generation:  29.81179451942444
----------------------check_connections_block total spend ----------------------------- 81.94278192520142
generate_one_block  40.94583606719971
generate_one_block  40.748536825180054
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.228283643722534
gen group dst list time:  0.18787193298339844
time for parepare:  0.47231268882751465
local_output_nid generation:  0.39243316650390625
local_in_edges_tensor generation:  1.5404620170593262
mini_batch_src_global generation:  2.05329966545105
r_  generation:  26.04603409767151
local_output_nid generation:  0.7505817413330078
local_in_edges_tensor generation:  2.0493853092193604
mini_batch_src_global generation:  2.9264841079711914
r_  generation:  26.708467483520508
----------------------check_connections_block total spend ----------------------------- 73.40938878059387
generate_one_block  35.41881275177002
generate_one_block  35.7896363735199
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42365837097168  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.3521707057953
block generation total time  152.90282201766968
average batch blocks generation time:  76.45141100883484
block dataloader generation time/epoch 367.4462402979533
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3923158645629883 |1.4226776361465454 |0.004431009292602539 |0.00015616416931152344 |0.005213379859924316 |0.0030622482299804688 |
----------------------------------------------------------pseudo_mini_loss sum 0.4452117681503296
Total (block generation + training)time/epoch 371.2790556557973
Training time/epoch 4.065782785415649
Training time without block to device /epoch 1.2204275131225586
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.12it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.70it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.01it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.48it/s] 40%|████      | 10/25 [00:00<00:01, 13.98it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.12it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.40it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.22it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.68it/s] 80%|████████  | 20/25 [00:01<00:00, 17.18it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.49it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.67it/s]100%|██████████| 25/25 [00:01<00:00, 16.83it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.45it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.58it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.55it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.59it/s] 40%|████      | 10/25 [00:01<00:02,  6.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.59it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.40it/s] 60%|██████    | 15/25 [00:02<00:01,  6.34it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.37it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.41it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.46it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.46it/s]100%|██████████| 25/25 [00:03<00:00,  7.18it/s]100%|██████████| 25/25 [00:03<00:00,  6.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.07it/s]  8%|▊         | 2/25 [00:00<00:03,  6.19it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.25it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.25it/s] 20%|██        | 5/25 [00:00<00:03,  6.31it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.31it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.31it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.31it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.31it/s] 40%|████      | 10/25 [00:01<00:02,  6.31it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.16it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.17it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.02it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.66it/s] 60%|██████    | 15/25 [00:02<00:01,  5.87it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.97it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.08it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.13it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.45it/s] 80%|████████  | 20/25 [00:03<00:01,  4.70it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.03it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.61it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.78it/s]100%|██████████| 25/25 [00:04<00:00,  5.91it/s]
Run 00 | Epoch 00075 | Loss 0.4452 | Train 0.7002 | Val 0.6898 | Test 0.5473
Number of nodes during this epoch:  4637917
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427262783050537  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.155013084411621
range selection method range initialization spend 0.025508403778076172
time for parepare:  0.3785979747772217
local_output_nid generation:  0.02659010887145996
local_in_edges_tensor generation:  0.17084169387817383
mini_batch_src_global generation:  0.3694641590118408
r_  generation:  5.754606008529663
local_output_nid generation:  0.029146671295166016
local_in_edges_tensor generation:  0.2317354679107666
mini_batch_src_global generation:  0.4647212028503418
r_  generation:  5.8869218826293945
----------------------check_connections_block total spend ----------------------------- 14.96399998664856
generate_one_block  7.225265264511108
generate_one_block  6.914719104766846
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.129506826400757
gen group dst list time:  0.09154796600341797
time for parepare:  0.4508936405181885
local_output_nid generation:  0.2779514789581299
local_in_edges_tensor generation:  1.6561994552612305
mini_batch_src_global generation:  2.511582374572754
r_  generation:  29.784599542617798
local_output_nid generation:  0.5230867862701416
local_in_edges_tensor generation:  2.0870718955993652
mini_batch_src_global generation:  3.470151901245117
r_  generation:  29.97724223136902
----------------------check_connections_block total spend ----------------------------- 82.51024580001831
generate_one_block  41.02901887893677
generate_one_block  41.108659744262695
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.128819465637207
gen group dst list time:  0.18932366371154785
time for parepare:  0.4514756202697754
local_output_nid generation:  0.3984532356262207
local_in_edges_tensor generation:  1.4584717750549316
mini_batch_src_global generation:  2.0131208896636963
r_  generation:  25.83594799041748
local_output_nid generation:  0.7410421371459961
local_in_edges_tensor generation:  1.9241831302642822
mini_batch_src_global generation:  2.8215792179107666
r_  generation:  26.378922939300537
----------------------check_connections_block total spend ----------------------------- 72.01643443107605
generate_one_block  35.29250931739807
generate_one_block  35.73856520652771
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427262783050537  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.52668023109436
block generation total time  153.16875314712524
average batch blocks generation time:  76.58437657356262
block dataloader generation time/epoch 367.4338416676772
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3817594051361084 |1.396824598312378 |0.004406929016113281 |0.00014984607696533203 |0.005120992660522461 |0.002863645553588867 |
----------------------------------------------------------pseudo_mini_loss sum 0.44421976804733276
Total (block generation + training)time/epoch 371.2687022403667
Training time/epoch 3.988085985183716
Training time without block to device /epoch 1.19443678855896
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.06it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.77it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.97it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.80it/s] 40%|████      | 10/25 [00:00<00:00, 16.88it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.11it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.29it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.56it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.81it/s] 80%|████████  | 20/25 [00:01<00:00, 17.98it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.08it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.08it/s]100%|██████████| 25/25 [00:01<00:00, 17.67it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.17it/s]  8%|▊         | 2/25 [00:00<00:04,  5.07it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.09it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.07it/s] 20%|██        | 5/25 [00:00<00:03,  5.10it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.12it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.13it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.13it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.12it/s] 40%|████      | 10/25 [00:01<00:02,  5.12it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.12it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.04it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.01it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.05it/s] 60%|██████    | 15/25 [00:02<00:01,  5.45it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.73it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.99it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.20it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.87it/s] 80%|████████  | 20/25 [00:03<00:00,  5.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.40it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.24it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.14it/s]100%|██████████| 25/25 [00:04<00:00,  5.72it/s]100%|██████████| 25/25 [00:04<00:00,  5.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.32it/s]  8%|▊         | 2/25 [00:00<00:04,  5.58it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.33it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.22it/s] 20%|██        | 5/25 [00:00<00:03,  5.09it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.03it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.97it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.24it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.64it/s] 40%|████      | 10/25 [00:01<00:02,  5.49it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.35it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.26it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.19it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.34it/s] 60%|██████    | 15/25 [00:02<00:01,  5.67it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.94it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.72it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.53it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.36it/s] 80%|████████  | 20/25 [00:03<00:00,  5.67it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.91it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.68it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.91it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.11it/s]100%|██████████| 25/25 [00:04<00:00,  5.65it/s]
Run 00 | Epoch 00076 | Loss 0.4442 | Train 0.7000 | Val 0.6898 | Test 0.5476
Number of nodes during this epoch:  4638165
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428469657897949  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1499876976013184
range selection method range initialization spend 0.02472233772277832
time for parepare:  0.37410569190979004
local_output_nid generation:  0.025592565536499023
local_in_edges_tensor generation:  0.29909491539001465
mini_batch_src_global generation:  0.3781881332397461
r_  generation:  5.447920322418213
local_output_nid generation:  0.02846240997314453
local_in_edges_tensor generation:  0.21316313743591309
mini_batch_src_global generation:  0.5085408687591553
r_  generation:  5.814895868301392
----------------------check_connections_block total spend ----------------------------- 14.79068660736084
generate_one_block  7.283640146255493
generate_one_block  7.053664922714233
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9848930835723877
gen group dst list time:  0.09118366241455078
time for parepare:  0.4320700168609619
local_output_nid generation:  0.24382972717285156
local_in_edges_tensor generation:  1.5996081829071045
mini_batch_src_global generation:  2.5743534564971924
r_  generation:  29.616907358169556
local_output_nid generation:  0.5142383575439453
local_in_edges_tensor generation:  2.0479891300201416
mini_batch_src_global generation:  3.480559825897217
r_  generation:  30.17062759399414
----------------------check_connections_block total spend ----------------------------- 82.42586922645569
generate_one_block  40.838361501693726
generate_one_block  40.98961019515991
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.182246208190918
gen group dst list time:  0.1915571689605713
time for parepare:  0.4564814567565918
local_output_nid generation:  0.3885037899017334
local_in_edges_tensor generation:  1.5860538482666016
mini_batch_src_global generation:  2.1057238578796387
r_  generation:  26.102471113204956
local_output_nid generation:  0.7422821521759033
local_in_edges_tensor generation:  2.0807557106018066
mini_batch_src_global generation:  2.8840997219085693
r_  generation:  25.874958753585815
----------------------check_connections_block total spend ----------------------------- 72.09092283248901
generate_one_block  35.175089836120605
generate_one_block  35.83734178543091
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428469657897949  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.5167920589447
block generation total time  152.84040331840515
average batch blocks generation time:  76.42020165920258
block dataloader generation time/epoch 367.4217363952042
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3974834680557251 |1.3031671047210693 |0.004487752914428711 |0.00014960765838623047 |0.0050345659255981445 |0.002003908157348633 |
----------------------------------------------------------pseudo_mini_loss sum 0.44030749797821045
Total (block generation + training)time/epoch 371.2565201040986
Training time/epoch 3.8287625312805176
Training time without block to device /epoch 1.222428321838379
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.98it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.62it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.32it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.75it/s] 40%|████      | 10/25 [00:00<00:00, 18.05it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.18it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.28it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.27it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.29it/s] 80%|████████  | 20/25 [00:01<00:00, 18.27it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.33it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.31it/s]100%|██████████| 25/25 [00:01<00:00, 18.26it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.48it/s]  8%|▊         | 2/25 [00:00<00:03,  6.51it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.54it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.56it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.55it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.55it/s] 40%|████      | 10/25 [00:01<00:02,  6.56it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.56it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.54it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.54it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.53it/s] 60%|██████    | 15/25 [00:02<00:01,  6.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.56it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.53it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.51it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.51it/s]100%|██████████| 25/25 [00:03<00:00,  6.63it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.06it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.43it/s] 20%|██        | 5/25 [00:00<00:03,  6.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.48it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.38it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.36it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.05it/s] 60%|██████    | 15/25 [00:02<00:01,  6.16it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.26it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.07it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.19it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.27it/s] 80%|████████  | 20/25 [00:03<00:00,  6.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.28it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.33it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.42it/s]
Run 00 | Epoch 00077 | Loss 0.4403 | Train 0.6999 | Val 0.6897 | Test 0.5480
Number of nodes during this epoch:  4637998
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428399562835693  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1321971416473389
range selection method range initialization spend 0.024208545684814453
time for parepare:  0.3562450408935547
local_output_nid generation:  0.02586221694946289
local_in_edges_tensor generation:  0.15842509269714355
mini_batch_src_global generation:  0.36579298973083496
r_  generation:  5.327285528182983
local_output_nid generation:  0.026442766189575195
local_in_edges_tensor generation:  0.19592905044555664
mini_batch_src_global generation:  0.456571102142334
r_  generation:  5.541102170944214
----------------------check_connections_block total spend ----------------------------- 14.034584045410156
generate_one_block  7.108581304550171
generate_one_block  6.714322805404663
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.1835548877716064
gen group dst list time:  0.08470034599304199
time for parepare:  0.43390727043151855
local_output_nid generation:  0.27292728424072266
local_in_edges_tensor generation:  1.6072909832000732
mini_batch_src_global generation:  2.4338619709014893
r_  generation:  29.734083890914917
local_output_nid generation:  0.5183484554290771
local_in_edges_tensor generation:  2.088280439376831
mini_batch_src_global generation:  3.5223772525787354
r_  generation:  29.940606832504272
----------------------check_connections_block total spend ----------------------------- 82.42812967300415
generate_one_block  41.440664529800415
generate_one_block  41.106086015701294
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.282740831375122
gen group dst list time:  0.18987154960632324
time for parepare:  0.45739293098449707
local_output_nid generation:  0.3764808177947998
local_in_edges_tensor generation:  1.5251002311706543
mini_batch_src_global generation:  2.0030314922332764
r_  generation:  25.55043315887451
local_output_nid generation:  0.7224915027618408
local_in_edges_tensor generation:  1.9773304462432861
mini_batch_src_global generation:  2.8311169147491455
r_  generation:  25.757842779159546
----------------------check_connections_block total spend ----------------------------- 71.41840887069702
generate_one_block  35.0084924697876
generate_one_block  35.416813135147095
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428399562835693  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.84653854370117
block generation total time  152.9720561504364
average batch blocks generation time:  76.4860280752182
block dataloader generation time/epoch 367.38163895790393
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37381887435913086 |1.3357703685760498 |0.004828453063964844 |0.0001709461212158203 |0.0050716400146484375 |0.003942966461181641 |
----------------------------------------------------------pseudo_mini_loss sum 0.440057635307312
Total (block generation + training)time/epoch 371.2166666740026
Training time/epoch 3.853652000427246
Training time without block to device /epoch 1.1821112632751465
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.74it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.08it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.51it/s] 40%|████      | 10/25 [00:00<00:00, 17.75it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.76it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.92it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.37it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.54it/s] 80%|████████  | 20/25 [00:01<00:00, 17.71it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.71it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.87it/s]100%|██████████| 25/25 [00:01<00:00, 17.86it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.74it/s]  8%|▊         | 2/25 [00:00<00:03,  6.83it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.77it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.81it/s] 20%|██        | 5/25 [00:00<00:03,  6.10it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.29it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.91it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.02it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.24it/s] 40%|████      | 10/25 [00:01<00:02,  5.92it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.66it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.85it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.10it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.24it/s] 60%|██████    | 15/25 [00:02<00:01,  5.82it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.03it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.23it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.94it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.04it/s] 80%|████████  | 20/25 [00:03<00:00,  6.16it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.68it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.94it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.12it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.83it/s]100%|██████████| 25/25 [00:04<00:00,  6.24it/s]100%|██████████| 25/25 [00:04<00:00,  6.06it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.95it/s]  8%|▊         | 2/25 [00:00<00:03,  6.30it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.55it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.54it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.45it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.03it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.02it/s] 60%|██████    | 15/25 [00:02<00:01,  6.16it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.22it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.91it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.66it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.49it/s] 80%|████████  | 20/25 [00:03<00:00,  5.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.30it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.03it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.04it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.98it/s]100%|██████████| 25/25 [00:04<00:00,  5.58it/s]100%|██████████| 25/25 [00:04<00:00,  5.88it/s]
Run 00 | Epoch 00078 | Loss 0.4401 | Train 0.7000 | Val 0.6900 | Test 0.5486
Number of nodes during this epoch:  4637702
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424030780792236  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0974879264831543
range selection method range initialization spend 0.024420976638793945
time for parepare:  0.3679335117340088
local_output_nid generation:  0.02686333656311035
local_in_edges_tensor generation:  0.2302231788635254
mini_batch_src_global generation:  0.3660550117492676
r_  generation:  5.446451663970947
local_output_nid generation:  0.028490066528320312
local_in_edges_tensor generation:  0.21192049980163574
mini_batch_src_global generation:  0.49467921257019043
r_  generation:  5.755937337875366
----------------------check_connections_block total spend ----------------------------- 14.62248969078064
generate_one_block  7.187169075012207
generate_one_block  6.892797470092773
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9455528259277344
gen group dst list time:  0.09703278541564941
time for parepare:  0.4732327461242676
local_output_nid generation:  0.2600288391113281
local_in_edges_tensor generation:  1.7007951736450195
mini_batch_src_global generation:  2.468701124191284
r_  generation:  29.81676197052002
local_output_nid generation:  0.5287134647369385
local_in_edges_tensor generation:  2.082340717315674
mini_batch_src_global generation:  3.4900100231170654
r_  generation:  30.180976629257202
----------------------check_connections_block total spend ----------------------------- 83.01048469543457
generate_one_block  41.17835187911987
generate_one_block  42.182674407958984
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.217621326446533
gen group dst list time:  0.18149638175964355
time for parepare:  0.4604768753051758
local_output_nid generation:  0.3990015983581543
local_in_edges_tensor generation:  1.4669091701507568
mini_batch_src_global generation:  2.153479814529419
r_  generation:  26.557734727859497
local_output_nid generation:  0.7375304698944092
local_in_edges_tensor generation:  2.024005174636841
mini_batch_src_global generation:  2.824336051940918
r_  generation:  26.11601424217224
----------------------check_connections_block total spend ----------------------------- 72.76745653152466
generate_one_block  35.27240490913391
generate_one_block  36.128352880477905
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424030780792236  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.77794122695923
block generation total time  154.76178407669067
average batch blocks generation time:  77.38089203834534
block dataloader generation time/epoch 367.40652860267255
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3920164108276367 |1.304802656173706 |0.005333542823791504 |0.0001723766326904297 |0.004961848258972168 |0.0038483142852783203 |
----------------------------------------------------------pseudo_mini_loss sum 0.43624353408813477
Total (block generation + training)time/epoch 371.24143450773215
Training time/epoch 3.8252389430999756
Training time without block to device /epoch 1.2156336307525635
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.22it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.82it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.35it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.68it/s] 40%|████      | 10/25 [00:00<00:00, 17.91it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.98it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.06it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.14it/s] 80%|████████  | 20/25 [00:01<00:00, 18.20it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.10it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.15it/s]100%|██████████| 25/25 [00:01<00:00, 18.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.39it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.40it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.43it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.43it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.48it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.50it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.49it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.49it/s] 80%|████████  | 20/25 [00:03<00:00,  6.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.29it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.22it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.97it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.94it/s]100%|██████████| 25/25 [00:03<00:00,  6.71it/s]100%|██████████| 25/25 [00:03<00:00,  6.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.60it/s]  8%|▊         | 2/25 [00:00<00:03,  6.04it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.15it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.24it/s] 20%|██        | 5/25 [00:00<00:03,  6.30it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.35it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.37it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.39it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.42it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.44it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.44it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  7.14it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
Run 00 | Epoch 00079 | Loss 0.4362 | Train 0.7008 | Val 0.6910 | Test 0.5493
Number of nodes during this epoch:  4637729
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424821376800537  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1227257251739502
range selection method range initialization spend 0.024367809295654297
time for parepare:  0.3770315647125244
local_output_nid generation:  0.02886176109313965
local_in_edges_tensor generation:  0.19228339195251465
mini_batch_src_global generation:  0.37470006942749023
r_  generation:  5.677133560180664
local_output_nid generation:  0.02862715721130371
local_in_edges_tensor generation:  0.23475980758666992
mini_batch_src_global generation:  0.4612851142883301
r_  generation:  5.831027507781982
----------------------check_connections_block total spend ----------------------------- 14.893013000488281
generate_one_block  7.190400838851929
generate_one_block  6.878333568572998
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.914480209350586
gen group dst list time:  0.09168601036071777
time for parepare:  0.4683675765991211
local_output_nid generation:  0.25040531158447266
local_in_edges_tensor generation:  1.6100261211395264
mini_batch_src_global generation:  2.57857346534729
r_  generation:  29.7452609539032
local_output_nid generation:  0.5264997482299805
local_in_edges_tensor generation:  2.0715787410736084
mini_batch_src_global generation:  3.4865188598632812
r_  generation:  29.969476222991943
----------------------check_connections_block total spend ----------------------------- 82.61619877815247
generate_one_block  40.970635414123535
generate_one_block  41.164055824279785
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.128286361694336
gen group dst list time:  0.18947553634643555
time for parepare:  0.46273207664489746
local_output_nid generation:  0.3805992603302002
local_in_edges_tensor generation:  1.441429615020752
mini_batch_src_global generation:  2.0083343982696533
r_  generation:  25.648651361465454
local_output_nid generation:  0.7416636943817139
local_in_edges_tensor generation:  1.9194130897521973
mini_batch_src_global generation:  2.794121503829956
r_  generation:  26.23290181159973
----------------------check_connections_block total spend ----------------------------- 71.70778703689575
generate_one_block  34.92429447174072
generate_one_block  35.646759033203125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424821376800537  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.32398581504822
block generation total time  152.70574474334717
average batch blocks generation time:  76.35287237167358
block dataloader generation time/epoch 367.3739940583706
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3898249864578247 |1.433342695236206 |0.004360318183898926 |0.00015044212341308594 |0.005148172378540039 |0.0029120445251464844 |
----------------------------------------------------------pseudo_mini_loss sum 0.4365779757499695
Total (block generation + training)time/epoch 371.2120012462139
Training time/epoch 4.082843065261841
Training time without block to device /epoch 1.2161576747894287
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.65it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.95it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.50it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.88it/s] 40%|████      | 10/25 [00:00<00:01, 14.21it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.28it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.87it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.59it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.13it/s] 80%|████████  | 20/25 [00:01<00:00, 17.51it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.70it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.90it/s]100%|██████████| 25/25 [00:01<00:00, 17.15it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.42it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.50it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.52it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.49it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.53it/s] 40%|████      | 10/25 [00:01<00:02,  6.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.53it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.56it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.55it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.49it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  6.61it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.31it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.38it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.43it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.44it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.43it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.40it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.41it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]
Run 00 | Epoch 00080 | Loss 0.4366 | Train 0.7016 | Val 0.6919 | Test 0.5502
Number of nodes during this epoch:  4636850
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42201566696167  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0459189414978027
range selection method range initialization spend 0.024130582809448242
time for parepare:  0.35756754875183105
local_output_nid generation:  0.025799036026000977
local_in_edges_tensor generation:  0.20226693153381348
mini_batch_src_global generation:  0.3656315803527832
r_  generation:  5.558277368545532
local_output_nid generation:  0.026551008224487305
local_in_edges_tensor generation:  0.19362735748291016
mini_batch_src_global generation:  0.4733426570892334
r_  generation:  5.68977952003479
----------------------check_connections_block total spend ----------------------------- 14.510117053985596
generate_one_block  6.7538158893585205
generate_one_block  6.932076454162598
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.098453044891357
gen group dst list time:  0.08691120147705078
time for parepare:  0.41632580757141113
local_output_nid generation:  0.24663424491882324
local_in_edges_tensor generation:  1.6758368015289307
mini_batch_src_global generation:  2.446523666381836
r_  generation:  30.131563186645508
local_output_nid generation:  0.5229876041412354
local_in_edges_tensor generation:  2.1776533126831055
mini_batch_src_global generation:  3.448767900466919
r_  generation:  30.303678274154663
----------------------check_connections_block total spend ----------------------------- 84.07552075386047
generate_one_block  40.77120780944824
generate_one_block  40.85185360908508
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.216294527053833
gen group dst list time:  0.1891937255859375
time for parepare:  0.4457576274871826
local_output_nid generation:  0.3811817169189453
local_in_edges_tensor generation:  1.468531847000122
mini_batch_src_global generation:  2.0244507789611816
r_  generation:  25.618228435516357
local_output_nid generation:  0.7354640960693359
local_in_edges_tensor generation:  1.8998572826385498
mini_batch_src_global generation:  2.824915885925293
r_  generation:  26.18714690208435
----------------------check_connections_block total spend ----------------------------- 71.80095601081848
generate_one_block  34.90090370178223
generate_one_block  35.88468861579895
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42201566696167  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.87647676467896
block generation total time  152.4086537361145
average batch blocks generation time:  76.20432686805725
block dataloader generation time/epoch 367.350364808683
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3761751651763916 |1.1168278455734253 |0.0043811798095703125 |0.0001462697982788086 |0.005056619644165039 |0.0030820369720458984 |
----------------------------------------------------------pseudo_mini_loss sum 0.4334782361984253
Total (block generation + training)time/epoch 371.1831519515426
Training time/epoch 3.4150238037109375
Training time without block to device /epoch 1.181368112564087
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.68it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.13it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.53it/s] 40%|████      | 10/25 [00:00<00:00, 17.73it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.86it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.88it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.03it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.13it/s] 80%|████████  | 20/25 [00:01<00:00, 18.21it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.02it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.05it/s]100%|██████████| 25/25 [00:01<00:00, 17.93it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.62it/s]  8%|▊         | 2/25 [00:00<00:03,  6.66it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.70it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.65it/s] 20%|██        | 5/25 [00:00<00:02,  6.69it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.70it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.67it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.64it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.65it/s] 40%|████      | 10/25 [00:01<00:02,  6.65it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.65it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.69it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.13it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.87it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.88it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.69it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.82it/s] 80%|████████  | 20/25 [00:03<00:00,  6.01it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.57it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.87it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.04it/s]100%|██████████| 25/25 [00:03<00:00,  6.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.22it/s]  8%|▊         | 2/25 [00:00<00:03,  5.82it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.17it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.78it/s] 20%|██        | 5/25 [00:00<00:03,  5.54it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.38it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.57it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.81it/s] 40%|████      | 10/25 [00:01<00:02,  6.01it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.67it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.44it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.30it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.17it/s] 60%|██████    | 15/25 [00:02<00:01,  5.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.77it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.99it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.16it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.27it/s] 80%|████████  | 20/25 [00:03<00:00,  6.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.98it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.13it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.27it/s]100%|██████████| 25/25 [00:04<00:00,  5.96it/s]
Run 00 | Epoch 00081 | Loss 0.4335 | Train 0.7022 | Val 0.6923 | Test 0.5510
Number of nodes during this epoch:  4636680
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4251837730407715  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0698812007904053
range selection method range initialization spend 0.024457216262817383
time for parepare:  0.39234089851379395
local_output_nid generation:  0.029555559158325195
local_in_edges_tensor generation:  0.19549870491027832
mini_batch_src_global generation:  0.3714020252227783
r_  generation:  5.520454406738281
local_output_nid generation:  0.028927087783813477
local_in_edges_tensor generation:  0.2344043254852295
mini_batch_src_global generation:  0.47745180130004883
r_  generation:  5.863593578338623
----------------------check_connections_block total spend ----------------------------- 14.763354301452637
generate_one_block  7.260850429534912
generate_one_block  7.056864976882935
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.078572511672974
gen group dst list time:  0.09532284736633301
time for parepare:  0.4677422046661377
local_output_nid generation:  0.2517402172088623
local_in_edges_tensor generation:  1.6216137409210205
mini_batch_src_global generation:  2.5155892372131348
r_  generation:  30.247663974761963
local_output_nid generation:  0.5405130386352539
local_in_edges_tensor generation:  2.387457847595215
mini_batch_src_global generation:  3.7174384593963623
r_  generation:  30.3642315864563
----------------------check_connections_block total spend ----------------------------- 83.9807071685791
generate_one_block  40.63814353942871
generate_one_block  41.0657217502594
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1612043380737305
gen group dst list time:  0.1822202205657959
time for parepare:  0.4544410705566406
local_output_nid generation:  0.3733248710632324
local_in_edges_tensor generation:  1.479166030883789
mini_batch_src_global generation:  2.0197930335998535
r_  generation:  25.525147914886475
local_output_nid generation:  0.7247166633605957
local_in_edges_tensor generation:  2.093890428543091
mini_batch_src_global generation:  3.232342004776001
r_  generation:  26.49729013442993
----------------------check_connections_block total spend ----------------------------- 72.37135028839111
generate_one_block  35.433231353759766
generate_one_block  36.12271213531494
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4251837730407715  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.35205745697021
block generation total time  153.25980877876282
average batch blocks generation time:  76.62990438938141
block dataloader generation time/epoch 367.37368426090336
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4030197858810425 |1.2435476779937744 |0.004675388336181641 |0.00016760826110839844 |0.005190134048461914 |0.003033161163330078 |
----------------------------------------------------------pseudo_mini_loss sum 0.43224528431892395
Total (block generation + training)time/epoch 371.2051476618139
Training time/epoch 3.724076986312866
Training time without block to device /epoch 1.2369816303253174
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.60it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.96it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.57it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.77it/s] 40%|████      | 10/25 [00:00<00:00, 17.97it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.11it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.03it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.17it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.20it/s] 80%|████████  | 20/25 [00:01<00:00, 18.24it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.26it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.27it/s]100%|██████████| 25/25 [00:01<00:00, 18.25it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.44it/s]  8%|▊         | 2/25 [00:00<00:03,  6.47it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.55it/s] 20%|██        | 5/25 [00:00<00:03,  6.56it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.59it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.59it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.60it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.59it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.59it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.59it/s] 60%|██████    | 15/25 [00:02<00:01,  6.58it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.54it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.54it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.56it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.55it/s] 80%|████████  | 20/25 [00:03<00:00,  6.56it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  6.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.27it/s]  8%|▊         | 2/25 [00:00<00:03,  6.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.46it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.44it/s] 60%|██████    | 15/25 [00:02<00:01,  6.43it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.41it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:03<00:00,  6.57it/s]
Run 00 | Epoch 00082 | Loss 0.4322 | Train 0.7024 | Val 0.6930 | Test 0.5517
Number of nodes during this epoch:  4638015
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425013542175293  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1762840747833252
range selection method range initialization spend 0.02425861358642578
time for parepare:  0.37914228439331055
local_output_nid generation:  0.025896072387695312
local_in_edges_tensor generation:  0.21768403053283691
mini_batch_src_global generation:  0.3800787925720215
r_  generation:  5.555729627609253
local_output_nid generation:  0.027842998504638672
local_in_edges_tensor generation:  0.21235013008117676
mini_batch_src_global generation:  0.4566352367401123
r_  generation:  5.52435302734375
----------------------check_connections_block total spend ----------------------------- 14.441129684448242
generate_one_block  7.3017637729644775
generate_one_block  7.127960205078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.11828875541687
gen group dst list time:  0.08836793899536133
time for parepare:  0.4656028747558594
local_output_nid generation:  0.25032472610473633
local_in_edges_tensor generation:  1.6678552627563477
mini_batch_src_global generation:  2.453091621398926
r_  generation:  29.51931118965149
local_output_nid generation:  0.5233948230743408
local_in_edges_tensor generation:  2.0646097660064697
mini_batch_src_global generation:  3.5229341983795166
r_  generation:  29.87777090072632
----------------------check_connections_block total spend ----------------------------- 81.976815700531
generate_one_block  40.93312120437622
generate_one_block  40.95737910270691
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.185810089111328
gen group dst list time:  0.19275760650634766
time for parepare:  0.47676587104797363
local_output_nid generation:  0.41364574432373047
local_in_edges_tensor generation:  1.5152904987335205
mini_batch_src_global generation:  2.0554697513580322
r_  generation:  26.33577036857605
local_output_nid generation:  0.7396893501281738
local_in_edges_tensor generation:  2.053133487701416
mini_batch_src_global generation:  2.9165163040161133
r_  generation:  26.740402221679688
----------------------check_connections_block total spend ----------------------------- 73.56066799163818
generate_one_block  36.839446783065796
generate_one_block  37.38413643836975
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425013542175293  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.5374836921692
block generation total time  156.11408352851868
average batch blocks generation time:  78.05704176425934
block dataloader generation time/epoch 367.4101537106985
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.470561146736145 |1.4947738647460938 |0.005297064781188965 |0.0001863241195678711 |0.005130171775817871 |0.001819610595703125 |
----------------------------------------------------------pseudo_mini_loss sum 0.4296938478946686
Total (block generation + training)time/epoch 371.2481917415757
Training time/epoch 4.376982688903809
Training time without block to device /epoch 1.387434959411621
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.81it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.18it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.76it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.07it/s] 40%|████      | 10/25 [00:00<00:00, 16.25it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.37it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.46it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.46it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.49it/s] 80%|████████  | 20/25 [00:01<00:00, 16.43it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.51it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.53it/s]100%|██████████| 25/25 [00:01<00:00, 16.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.82it/s]  8%|▊         | 2/25 [00:00<00:03,  6.11it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.19it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.22it/s] 20%|██        | 5/25 [00:00<00:03,  6.23it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.20it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.22it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.23it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.22it/s] 40%|████      | 10/25 [00:01<00:02,  6.21it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.22it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.21it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.20it/s] 60%|██████    | 15/25 [00:02<00:01,  6.18it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.19it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.18it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.19it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.20it/s] 80%|████████  | 20/25 [00:03<00:00,  6.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.22it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.21it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.19it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.20it/s]100%|██████████| 25/25 [00:03<00:00,  6.89it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.92it/s]  8%|▊         | 2/25 [00:00<00:03,  6.11it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.14it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.14it/s] 20%|██        | 5/25 [00:00<00:03,  6.15it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.17it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.18it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.11it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.94it/s] 40%|████      | 10/25 [00:01<00:02,  5.93it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.91it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.79it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.58it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.74it/s] 60%|██████    | 15/25 [00:02<00:01,  5.87it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.96it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.00it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.04it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.11it/s] 80%|████████  | 20/25 [00:03<00:00,  6.10it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.15it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.17it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.18it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.20it/s]100%|██████████| 25/25 [00:04<00:00,  6.96it/s]100%|██████████| 25/25 [00:04<00:00,  6.13it/s]
Run 00 | Epoch 00083 | Loss 0.4297 | Train 0.7024 | Val 0.6932 | Test 0.5522
Number of nodes during this epoch:  4637393
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427056312561035  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1145882606506348
range selection method range initialization spend 0.034696340560913086
time for parepare:  0.3646235466003418
local_output_nid generation:  0.030078887939453125
local_in_edges_tensor generation:  0.17276549339294434
mini_batch_src_global generation:  0.38783693313598633
r_  generation:  5.591274261474609
local_output_nid generation:  0.028446435928344727
local_in_edges_tensor generation:  0.23664259910583496
mini_batch_src_global generation:  0.4641571044921875
r_  generation:  5.914531946182251
----------------------check_connections_block total spend ----------------------------- 14.835232734680176
generate_one_block  7.422937870025635
generate_one_block  7.6007399559021
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.1885271072387695
gen group dst list time:  0.10058784484863281
time for parepare:  0.46289682388305664
local_output_nid generation:  0.2728698253631592
local_in_edges_tensor generation:  1.6587622165679932
mini_batch_src_global generation:  2.535653829574585
r_  generation:  30.052004098892212
local_output_nid generation:  0.5850908756256104
local_in_edges_tensor generation:  2.145064115524292
mini_batch_src_global generation:  3.9342217445373535
r_  generation:  31.418070077896118
----------------------check_connections_block total spend ----------------------------- 85.58620095252991
generate_one_block  42.85298824310303
generate_one_block  42.68862533569336
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.265639305114746
gen group dst list time:  0.20215606689453125
time for parepare:  0.46613621711730957
local_output_nid generation:  0.42192983627319336
local_in_edges_tensor generation:  1.4666776657104492
mini_batch_src_global generation:  2.0141282081604004
r_  generation:  26.460440158843994
local_output_nid generation:  0.7556312084197998
local_in_edges_tensor generation:  1.9563508033752441
mini_batch_src_global generation:  2.9216394424438477
r_  generation:  26.921308517456055
----------------------check_connections_block total spend ----------------------------- 74.0897262096405
generate_one_block  36.865851640701294
generate_one_block  37.66693472862244
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427056312561035  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  159.6759271621704
block generation total time  160.07439994812012
average batch blocks generation time:  80.03719997406006
block dataloader generation time/epoch 367.55858537128995
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3821974992752075 |1.3129545450210571 |0.005262613296508789 |0.0001951456069946289 |0.0051108598709106445 |0.003904581069946289 |
----------------------------------------------------------pseudo_mini_loss sum 0.4297853410243988
Total (block generation + training)time/epoch 371.39675157126925
Training time/epoch 3.848609209060669
Training time without block to device /epoch 1.2227001190185547
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.91it/s] 16%|█▌        | 4/25 [00:00<00:01, 14.95it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.88it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.46it/s] 40%|████      | 10/25 [00:00<00:00, 16.63it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.74it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.82it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.04it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.14it/s] 80%|████████  | 20/25 [00:01<00:00, 17.63it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.01it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.31it/s]100%|██████████| 25/25 [00:01<00:00, 17.29it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.13it/s]  8%|▊         | 2/25 [00:00<00:04,  5.17it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.70it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.02it/s] 20%|██        | 5/25 [00:00<00:03,  5.68it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.51it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.40it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.33it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.30it/s] 40%|████      | 10/25 [00:01<00:02,  5.24it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.53it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.76it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.97it/s] 60%|██████    | 15/25 [00:02<00:01,  6.10it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.15it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.26it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.32it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.09it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.71it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.49it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.26it/s]100%|██████████| 25/25 [00:04<00:00,  6.08it/s]100%|██████████| 25/25 [00:04<00:00,  5.76it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.47it/s]  8%|▊         | 2/25 [00:00<00:03,  5.96it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.16it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.25it/s] 20%|██        | 5/25 [00:00<00:03,  6.24it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.22it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.16it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.24it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.49it/s] 40%|████      | 10/25 [00:01<00:02,  5.70it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.48it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.48it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.63it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.76it/s] 60%|██████    | 15/25 [00:02<00:01,  5.90it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.00it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.05it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.08it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.01it/s] 80%|████████  | 20/25 [00:03<00:00,  6.03it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.00it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.07it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.07it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.14it/s]100%|██████████| 25/25 [00:04<00:00,  6.05it/s]
Run 00 | Epoch 00084 | Loss 0.4298 | Train 0.7020 | Val 0.6924 | Test 0.5524
Number of nodes during this epoch:  4637128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426065444946289  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1154708862304688
range selection method range initialization spend 0.02422332763671875
time for parepare:  0.38535070419311523
local_output_nid generation:  0.026027202606201172
local_in_edges_tensor generation:  0.21601533889770508
mini_batch_src_global generation:  0.37676548957824707
r_  generation:  5.6380088329315186
local_output_nid generation:  0.030025005340576172
local_in_edges_tensor generation:  0.2309131622314453
mini_batch_src_global generation:  0.46076345443725586
r_  generation:  5.843270778656006
----------------------check_connections_block total spend ----------------------------- 14.87135100364685
generate_one_block  7.176266431808472
generate_one_block  6.85998272895813
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9412355422973633
gen group dst list time:  0.09184789657592773
time for parepare:  0.43149518966674805
local_output_nid generation:  0.24102234840393066
local_in_edges_tensor generation:  1.5696675777435303
mini_batch_src_global generation:  2.423330068588257
r_  generation:  29.09718656539917
local_output_nid generation:  0.471355676651001
local_in_edges_tensor generation:  2.1172611713409424
mini_batch_src_global generation:  3.500847816467285
r_  generation:  31.379097938537598
----------------------check_connections_block total spend ----------------------------- 84.03553700447083
generate_one_block  41.17380142211914
generate_one_block  41.35346508026123
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.139578104019165
gen group dst list time:  0.18392276763916016
time for parepare:  0.46683311462402344
local_output_nid generation:  0.3871002197265625
local_in_edges_tensor generation:  1.4634215831756592
mini_batch_src_global generation:  2.131725549697876
r_  generation:  26.032036066055298
local_output_nid generation:  0.7470598220825195
local_in_edges_tensor generation:  2.031738042831421
mini_batch_src_global generation:  2.8860063552856445
r_  generation:  25.764544248580933
----------------------check_connections_block total spend ----------------------------- 71.72735905647278
generate_one_block  35.12706756591797
generate_one_block  35.96173405647278
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426065444946289  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.7628960609436
block generation total time  153.61606812477112
average batch blocks generation time:  76.80803406238556
block dataloader generation time/epoch 367.56170865227193
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3907073736190796 |1.512453556060791 |0.004923105239868164 |0.00016546249389648438 |0.005193352699279785 |0.003942966461181641 |
----------------------------------------------------------pseudo_mini_loss sum 0.42672908306121826
Total (block generation + training)time/epoch 371.4045266936807
Training time/epoch 4.233374834060669
Training time without block to device /epoch 1.208467721939087
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.91it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.43it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.97it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.46it/s] 40%|████      | 10/25 [00:00<00:01, 13.91it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.12it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.98it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.56it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.01it/s] 80%|████████  | 20/25 [00:01<00:00, 17.31it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.41it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.52it/s]100%|██████████| 25/25 [00:01<00:00, 16.87it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.40it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.49it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.51it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.51it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.51it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.50it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.51it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  7.14it/s]100%|██████████| 25/25 [00:03<00:00,  6.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.44it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.45it/s] 40%|████      | 10/25 [00:01<00:02,  6.47it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.45it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.46it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.45it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:03<00:00,  6.53it/s]
Run 00 | Epoch 00085 | Loss 0.4267 | Train 0.7015 | Val 0.6919 | Test 0.5526
Number of nodes during this epoch:  4637122
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423186302185059  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1026666164398193
range selection method range initialization spend 0.025220632553100586
time for parepare:  0.3584773540496826
local_output_nid generation:  0.027042865753173828
local_in_edges_tensor generation:  0.17615914344787598
mini_batch_src_global generation:  0.36918091773986816
r_  generation:  5.903951406478882
local_output_nid generation:  0.030627965927124023
local_in_edges_tensor generation:  0.22987008094787598
mini_batch_src_global generation:  0.46860432624816895
r_  generation:  5.879762411117554
----------------------check_connections_block total spend ----------------------------- 15.111530780792236
generate_one_block  7.2292022705078125
generate_one_block  6.852229118347168
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.883708953857422
gen group dst list time:  0.09313654899597168
time for parepare:  0.4478914737701416
local_output_nid generation:  0.25907349586486816
local_in_edges_tensor generation:  1.6103904247283936
mini_batch_src_global generation:  2.566230535507202
r_  generation:  30.441588401794434
local_output_nid generation:  0.5786356925964355
local_in_edges_tensor generation:  2.249159574508667
mini_batch_src_global generation:  3.731198310852051
r_  generation:  30.136777639389038
----------------------check_connections_block total spend ----------------------------- 84.19132614135742
generate_one_block  40.73274612426758
generate_one_block  41.20221281051636
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.226300001144409
gen group dst list time:  0.20403790473937988
time for parepare:  0.511237382888794
local_output_nid generation:  0.4354722499847412
local_in_edges_tensor generation:  1.5864496231079102
mini_batch_src_global generation:  2.029310941696167
r_  generation:  26.04564380645752
local_output_nid generation:  0.7671844959259033
local_in_edges_tensor generation:  2.0927541255950928
mini_batch_src_global generation:  2.925851345062256
r_  generation:  26.121771097183228
----------------------check_connections_block total spend ----------------------------- 72.34772992134094
generate_one_block  35.28350043296814
generate_one_block  36.07829737663269
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423186302185059  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.53905606269836
block generation total time  153.29675674438477
average batch blocks generation time:  76.64837837219238
block dataloader generation time/epoch 367.5702212771704
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3932996988296509 |1.3081302642822266 |0.05320858955383301 |0.00019490718841552734 |0.07457184791564941 |0.0030307769775390625 |
----------------------------------------------------------pseudo_mini_loss sum 0.42471954226493835
Total (block generation + training)time/epoch 371.4135110350542
Training time/epoch 3.883192777633667
Training time without block to device /epoch 1.2669322490692139
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.09it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.70it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.31it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.66it/s] 40%|████      | 10/25 [00:00<00:00, 17.87it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.93it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.99it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.20it/s] 80%|████████  | 20/25 [00:01<00:00, 18.23it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.21it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.24it/s]100%|██████████| 25/25 [00:01<00:00, 18.20it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.51it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.57it/s] 20%|██        | 5/25 [00:00<00:03,  6.58it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.59it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.59it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.59it/s] 40%|████      | 10/25 [00:01<00:02,  6.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.61it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.57it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.57it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.56it/s] 60%|██████    | 15/25 [00:02<00:01,  6.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.54it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.56it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.57it/s] 80%|████████  | 20/25 [00:03<00:00,  6.58it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.57it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.54it/s]100%|██████████| 25/25 [00:03<00:00,  6.66it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.43it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.42it/s] 40%|████      | 10/25 [00:01<00:02,  6.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.45it/s] 60%|██████    | 15/25 [00:02<00:01,  6.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.46it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.18it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.29it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.13it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.23it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.31it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.26it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00086 | Loss 0.4247 | Train 0.7016 | Val 0.6916 | Test 0.5527
Number of nodes during this epoch:  4637817
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428767204284668  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.139176368713379
range selection method range initialization spend 0.024309396743774414
time for parepare:  0.34957218170166016
local_output_nid generation:  0.025881290435791016
local_in_edges_tensor generation:  0.17400741577148438
mini_batch_src_global generation:  0.36075711250305176
r_  generation:  5.320071697235107
local_output_nid generation:  0.02666759490966797
local_in_edges_tensor generation:  0.19430041313171387
mini_batch_src_global generation:  0.45982909202575684
r_  generation:  5.572844743728638
----------------------check_connections_block total spend ----------------------------- 14.067007780075073
generate_one_block  7.098934650421143
generate_one_block  6.780280351638794
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.982936143875122
gen group dst list time:  0.08601617813110352
time for parepare:  0.4252462387084961
local_output_nid generation:  0.24540352821350098
local_in_edges_tensor generation:  1.6178936958312988
mini_batch_src_global generation:  2.601703405380249
r_  generation:  30.090570211410522
local_output_nid generation:  0.5248382091522217
local_in_edges_tensor generation:  2.113658905029297
mini_batch_src_global generation:  3.510288715362549
r_  generation:  29.977526903152466
----------------------check_connections_block total spend ----------------------------- 83.4052665233612
generate_one_block  40.72365999221802
generate_one_block  40.78336191177368
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.175257921218872
gen group dst list time:  0.19097542762756348
time for parepare:  0.4907035827636719
local_output_nid generation:  0.3958868980407715
local_in_edges_tensor generation:  1.486842155456543
mini_batch_src_global generation:  2.152590274810791
r_  generation:  26.162087202072144
local_output_nid generation:  0.7308604717254639
local_in_edges_tensor generation:  1.9423387050628662
mini_batch_src_global generation:  2.901252269744873
r_  generation:  25.942203760147095
----------------------check_connections_block total spend ----------------------------- 72.13729548454285
generate_one_block  35.00211572647095
generate_one_block  35.82373094558716
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428767204284668  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.54256200790405
block generation total time  152.3328685760498
average batch blocks generation time:  76.1664342880249
block dataloader generation time/epoch 367.53965960151845
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3836197853088379 |1.3056763410568237 |0.004365086555480957 |0.00015151500701904297 |0.005058646202087402 |0.0014967918395996094 |
----------------------------------------------------------pseudo_mini_loss sum 0.42234963178634644
Total (block generation + training)time/epoch 371.3825658299457
Training time/epoch 3.8097612857818604
Training time without block to device /epoch 1.198408603668213
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.05it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.50it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.09it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.42it/s] 40%|████      | 10/25 [00:00<00:00, 17.53it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.59it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.54it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.54it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.48it/s] 80%|████████  | 20/25 [00:01<00:00, 17.14it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.46it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.65it/s]100%|██████████| 25/25 [00:01<00:00, 17.64it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.52it/s]  8%|▊         | 2/25 [00:00<00:03,  6.55it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.59it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.58it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.12it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.82it/s] 40%|████      | 10/25 [00:01<00:02,  5.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.44it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.14it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.33it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.59it/s] 60%|██████    | 15/25 [00:02<00:01,  5.83it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.76it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.83it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.74it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.79it/s] 80%|████████  | 20/25 [00:03<00:00,  5.90it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.03it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.13it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.18it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.26it/s]100%|██████████| 25/25 [00:04<00:00,  6.07it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.20it/s]  8%|▊         | 2/25 [00:00<00:03,  6.31it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.36it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.38it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.33it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.32it/s] 40%|████      | 10/25 [00:01<00:02,  6.05it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.11it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.99it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.71it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.64it/s] 60%|██████    | 15/25 [00:02<00:01,  5.68it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.84it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.91it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.06it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.14it/s] 80%|████████  | 20/25 [00:03<00:00,  6.23it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.29it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.33it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:04<00:00,  7.11it/s]100%|██████████| 25/25 [00:04<00:00,  6.25it/s]
Run 00 | Epoch 00087 | Loss 0.4223 | Train 0.7015 | Val 0.6919 | Test 0.5529
Number of nodes during this epoch:  4637631
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429664611816406  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.130298376083374
range selection method range initialization spend 0.024910926818847656
time for parepare:  0.3648231029510498
local_output_nid generation:  0.026871919631958008
local_in_edges_tensor generation:  0.20056891441345215
mini_batch_src_global generation:  0.37415242195129395
r_  generation:  5.591624021530151
local_output_nid generation:  0.030738115310668945
local_in_edges_tensor generation:  0.23132896423339844
mini_batch_src_global generation:  0.46193647384643555
r_  generation:  5.8348002433776855
----------------------check_connections_block total spend ----------------------------- 14.770251035690308
generate_one_block  7.140045642852783
generate_one_block  6.856196165084839
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9820961952209473
gen group dst list time:  0.09328126907348633
time for parepare:  0.4598202705383301
local_output_nid generation:  0.27091455459594727
local_in_edges_tensor generation:  1.626082181930542
mini_batch_src_global generation:  2.5339691638946533
r_  generation:  29.897934913635254
local_output_nid generation:  0.5298693180084229
local_in_edges_tensor generation:  2.3931281566619873
mini_batch_src_global generation:  3.7652225494384766
r_  generation:  30.1889169216156
----------------------check_connections_block total spend ----------------------------- 83.5851981639862
generate_one_block  40.798911571502686
generate_one_block  41.33442139625549
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1738786697387695
gen group dst list time:  0.18558216094970703
time for parepare:  0.45378828048706055
local_output_nid generation:  0.3684866428375244
local_in_edges_tensor generation:  1.559194803237915
mini_batch_src_global generation:  2.2052218914031982
r_  generation:  25.89017128944397
local_output_nid generation:  0.7400350570678711
local_in_edges_tensor generation:  2.0334341526031494
mini_batch_src_global generation:  2.862130641937256
r_  generation:  25.783507823944092
----------------------check_connections_block total spend ----------------------------- 71.74627470970154
generate_one_block  34.9975962638855
generate_one_block  35.6841094493866
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429664611816406  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.33147287368774
block generation total time  152.81503868103027
average batch blocks generation time:  76.40751934051514
block dataloader generation time/epoch 367.52678493478084
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.49498414993286133 |1.4205399751663208 |0.004889249801635742 |0.00016772747039794922 |0.005069851875305176 |0.003216266632080078 |
----------------------------------------------------------pseudo_mini_loss sum 0.4221112132072449
Total (block generation + training)time/epoch 371.37446946447545
Training time/epoch 4.263209342956543
Training time without block to device /epoch 1.4221293926239014
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.01it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.40it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.97it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.35it/s] 40%|████      | 10/25 [00:00<00:00, 17.31it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.61it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.32it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.44it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.61it/s] 80%|████████  | 20/25 [00:01<00:00, 17.69it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.61it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.67it/s]100%|██████████| 25/25 [00:01<00:00, 17.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.64it/s]  8%|▊         | 2/25 [00:00<00:03,  5.76it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.49it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.23it/s] 20%|██        | 5/25 [00:00<00:03,  5.67it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.98it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.21it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.49it/s] 40%|████      | 10/25 [00:01<00:02,  6.00it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.18it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.36it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.99it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.65it/s] 60%|██████    | 15/25 [00:02<00:01,  5.88it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.06it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.16it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  6.53it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.58it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.14it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.69it/s]100%|██████████| 25/25 [00:04<00:00,  6.51it/s]100%|██████████| 25/25 [00:04<00:00,  6.14it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.78it/s]  8%|▊         | 2/25 [00:00<00:04,  5.62it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.03it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.59it/s] 20%|██        | 5/25 [00:00<00:03,  5.40it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.31it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.25it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.15it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.91it/s] 40%|████      | 10/25 [00:01<00:02,  5.20it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.02it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.27it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.63it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.51it/s] 60%|██████    | 15/25 [00:02<00:01,  5.37it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.29it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.21it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.07it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.89it/s] 80%|████████  | 20/25 [00:03<00:00,  5.21it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.53it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.34it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.38it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.57it/s]100%|██████████| 25/25 [00:04<00:00,  6.41it/s]100%|██████████| 25/25 [00:04<00:00,  5.42it/s]
Run 00 | Epoch 00088 | Loss 0.4221 | Train 0.7016 | Val 0.6925 | Test 0.5529
Number of nodes during this epoch:  4638440
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430089950561523  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.14013671875
range selection method range initialization spend 0.024687528610229492
time for parepare:  0.3726489543914795
local_output_nid generation:  0.02966165542602539
local_in_edges_tensor generation:  0.18021273612976074
mini_batch_src_global generation:  0.36447906494140625
r_  generation:  5.574095249176025
local_output_nid generation:  0.0278775691986084
local_in_edges_tensor generation:  0.2147834300994873
mini_batch_src_global generation:  0.4586448669433594
r_  generation:  5.5385026931762695
----------------------check_connections_block total spend ----------------------------- 14.37480092048645
generate_one_block  7.351878643035889
generate_one_block  7.1821348667144775
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.093684911727905
gen group dst list time:  0.0964958667755127
time for parepare:  0.46527886390686035
local_output_nid generation:  0.2538576126098633
local_in_edges_tensor generation:  1.617560625076294
mini_batch_src_global generation:  2.483673572540283
r_  generation:  29.834345817565918
local_output_nid generation:  0.5498089790344238
local_in_edges_tensor generation:  2.1891191005706787
mini_batch_src_global generation:  3.5008246898651123
r_  generation:  30.08794927597046
----------------------check_connections_block total spend ----------------------------- 82.87492370605469
generate_one_block  41.104772090911865
generate_one_block  41.045411109924316
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1869096755981445
gen group dst list time:  0.18194246292114258
time for parepare:  0.44120073318481445
local_output_nid generation:  0.38552212715148926
local_in_edges_tensor generation:  1.4652063846588135
mini_batch_src_global generation:  2.001429796218872
r_  generation:  25.353280544281006
local_output_nid generation:  0.7202491760253906
local_in_edges_tensor generation:  2.151153087615967
mini_batch_src_global generation:  2.7848572731018066
r_  generation:  25.8526291847229
----------------------check_connections_block total spend ----------------------------- 71.30075192451477
generate_one_block  34.55320596694946
generate_one_block  35.84146547317505
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430089950561523  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.17567563056946
block generation total time  152.5448546409607
average batch blocks generation time:  76.27242732048035
block dataloader generation time/epoch 367.51266458597075
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.382973313331604 |1.3011122941970825 |0.00436091423034668 |0.00014698505401611328 |0.005199313163757324 |0.0030705928802490234 |
----------------------------------------------------------pseudo_mini_loss sum 0.4190925657749176
Total (block generation + training)time/epoch 371.35971955770856
Training time/epoch 3.7914881706237793
Training time without block to device /epoch 1.1892635822296143
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.32it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.91it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.75it/s] 40%|████      | 10/25 [00:00<00:00, 17.92it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.93it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.00it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.21it/s] 80%|████████  | 20/25 [00:01<00:00, 18.26it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.29it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.14it/s]100%|██████████| 25/25 [00:01<00:00, 18.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.20it/s]  8%|▊         | 2/25 [00:00<00:04,  5.09it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.91it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.97it/s] 20%|██        | 5/25 [00:00<00:03,  5.43it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.76it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.85it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.02it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.83it/s] 40%|████      | 10/25 [00:01<00:02,  5.67it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.73it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.86it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.01it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.12it/s] 60%|██████    | 15/25 [00:02<00:01,  6.24it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.32it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.31it/s] 80%|████████  | 20/25 [00:03<00:00,  6.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.01it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.85it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.99it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.03it/s]100%|██████████| 25/25 [00:04<00:00,  5.99it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.97it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.25it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.32it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.49it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.49it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.48it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.51it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.44it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.54it/s]
Run 00 | Epoch 00089 | Loss 0.4191 | Train 0.7015 | Val 0.6921 | Test 0.5529
Number of nodes during this epoch:  4637479
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429068565368652  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1440849304199219
range selection method range initialization spend 0.0242462158203125
time for parepare:  0.3854866027832031
local_output_nid generation:  0.029666900634765625
local_in_edges_tensor generation:  0.19950532913208008
mini_batch_src_global generation:  0.3742794990539551
r_  generation:  5.596505165100098
local_output_nid generation:  0.028077125549316406
local_in_edges_tensor generation:  0.21491670608520508
mini_batch_src_global generation:  0.46121811866760254
r_  generation:  5.582539081573486
----------------------check_connections_block total spend ----------------------------- 14.513438940048218
generate_one_block  7.374072074890137
generate_one_block  7.198894739151001
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.086073160171509
gen group dst list time:  0.08962392807006836
time for parepare:  0.45046210289001465
local_output_nid generation:  0.26626157760620117
local_in_edges_tensor generation:  1.6490559577941895
mini_batch_src_global generation:  2.493755578994751
r_  generation:  30.116570711135864
local_output_nid generation:  0.5227599143981934
local_in_edges_tensor generation:  2.0630369186401367
mini_batch_src_global generation:  3.5826261043548584
r_  generation:  30.051990270614624
----------------------check_connections_block total spend ----------------------------- 83.2953712940216
generate_one_block  40.83090806007385
generate_one_block  41.12463593482971
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1322672367095947
gen group dst list time:  0.1895585060119629
time for parepare:  0.4573698043823242
local_output_nid generation:  0.37537646293640137
local_in_edges_tensor generation:  1.449167251586914
mini_batch_src_global generation:  2.0131773948669434
r_  generation:  25.501340627670288
local_output_nid generation:  0.7236568927764893
local_in_edges_tensor generation:  1.9149227142333984
mini_batch_src_global generation:  2.8851335048675537
r_  generation:  25.94853162765503
----------------------check_connections_block total spend ----------------------------- 71.37139821052551
generate_one_block  35.0287561416626
generate_one_block  35.464356660842896
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429068565368652  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.66676950454712
block generation total time  152.44865679740906
average batch blocks generation time:  76.22432839870453
block dataloader generation time/epoch 367.50232124328613
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3766113519668579 |1.3572708368301392 |0.004277229309082031 |0.00014531612396240234 |0.004992246627807617 |0.001461029052734375 |
----------------------------------------------------------pseudo_mini_loss sum 0.41887181997299194
Total (block generation + training)time/epoch 371.349887280994
Training time/epoch 3.8928890228271484
Training time without block to device /epoch 1.1783473491668701
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.51it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.88it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.45it/s] 40%|████      | 10/25 [00:00<00:01, 13.83it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.81it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.61it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.37it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.76it/s] 80%|████████  | 20/25 [00:01<00:00, 16.94it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.29it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.50it/s]100%|██████████| 25/25 [00:01<00:00, 16.74it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.20it/s]  8%|▊         | 2/25 [00:00<00:04,  5.16it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.10it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.05it/s] 20%|██        | 5/25 [00:00<00:03,  5.30it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.68it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.55it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.43it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.30it/s] 40%|████      | 10/25 [00:01<00:02,  5.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.88it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.08it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.22it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.87it/s] 60%|██████    | 15/25 [00:02<00:01,  6.05it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.22it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.33it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.51it/s]100%|██████████| 25/25 [00:04<00:00,  6.94it/s]100%|██████████| 25/25 [00:04<00:00,  6.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:04,  5.51it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.89it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.05it/s] 20%|██        | 5/25 [00:00<00:03,  6.16it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.24it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.32it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.30it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.34it/s] 40%|████      | 10/25 [00:01<00:02,  6.28it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.30it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.30it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.33it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.29it/s] 60%|██████    | 15/25 [00:02<00:01,  6.34it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.37it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.40it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  7.18it/s]100%|██████████| 25/25 [00:03<00:00,  6.39it/s]
Run 00 | Epoch 00090 | Loss 0.4189 | Train 0.7016 | Val 0.6921 | Test 0.5530
Number of nodes during this epoch:  4636994
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42166805267334  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1991100311279297
range selection method range initialization spend 0.02454519271850586
time for parepare:  0.3827066421508789
local_output_nid generation:  0.02562427520751953
local_in_edges_tensor generation:  0.20152664184570312
mini_batch_src_global generation:  0.3829331398010254
r_  generation:  5.464151620864868
local_output_nid generation:  0.027730226516723633
local_in_edges_tensor generation:  0.211655855178833
mini_batch_src_global generation:  0.455564022064209
r_  generation:  5.563972234725952
----------------------check_connections_block total spend ----------------------------- 14.363127946853638
generate_one_block  7.203124523162842
generate_one_block  7.060757875442505
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.997257947921753
gen group dst list time:  0.09385180473327637
time for parepare:  0.4717998504638672
local_output_nid generation:  0.26506829261779785
local_in_edges_tensor generation:  1.7665290832519531
mini_batch_src_global generation:  2.5319790840148926
r_  generation:  29.92742657661438
local_output_nid generation:  0.5472865104675293
local_in_edges_tensor generation:  2.27726149559021
mini_batch_src_global generation:  3.770073175430298
r_  generation:  30.239466428756714
----------------------check_connections_block total spend ----------------------------- 83.73564529418945
generate_one_block  41.150221824645996
generate_one_block  40.819780349731445
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.6726417541503906
gen group dst list time:  0.1811065673828125
time for parepare:  0.47138357162475586
local_output_nid generation:  0.39609313011169434
local_in_edges_tensor generation:  1.5339229106903076
mini_batch_src_global generation:  2.0233848094940186
r_  generation:  25.90415668487549
local_output_nid generation:  0.7300903797149658
local_in_edges_tensor generation:  1.9551613330841064
mini_batch_src_global generation:  2.9505255222320557
r_  generation:  26.23086714744568
----------------------check_connections_block total spend ----------------------------- 72.49718260765076
generate_one_block  35.363765001297
generate_one_block  36.02771258354187
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42166805267334  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.2328279018402
block generation total time  153.3614797592163
average batch blocks generation time:  76.68073987960815
block dataloader generation time/epoch 367.51415202119847
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3762195110321045 |1.3624628782272339 |0.004349470138549805 |0.00014603137969970703 |0.005066037178039551 |0.003289461135864258 |
----------------------------------------------------------pseudo_mini_loss sum 0.4164040684700012
Total (block generation + training)time/epoch 371.3623394022931
Training time/epoch 3.9039435386657715
Training time without block to device /epoch 1.1790177822113037
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.84it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.63it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.29it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:00, 17.88it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.75it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.90it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.06it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.51it/s] 80%|████████  | 20/25 [00:01<00:00, 17.08it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.28it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.61it/s]100%|██████████| 25/25 [00:01<00:00, 17.75it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  6.00it/s]  8%|▊         | 2/25 [00:00<00:04,  5.31it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.90it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.18it/s] 20%|██        | 5/25 [00:00<00:03,  6.09it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.54it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.56it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.75it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.97it/s] 40%|████      | 10/25 [00:01<00:02,  6.05it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.36it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.70it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.77it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.73it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.16it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.55it/s] 80%|████████  | 20/25 [00:03<00:00,  5.18it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.07it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.05it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.02it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.31it/s]100%|██████████| 25/25 [00:04<00:00,  6.17it/s]100%|██████████| 25/25 [00:04<00:00,  5.89it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.40it/s]  8%|▊         | 2/25 [00:00<00:04,  5.60it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.28it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.19it/s] 20%|██        | 5/25 [00:00<00:03,  5.09it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.04it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.44it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.79it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.02it/s] 40%|████      | 10/25 [00:01<00:02,  6.19it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.33it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.51it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.53it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.55it/s] 80%|████████  | 20/25 [00:03<00:00,  6.56it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  6.26it/s]
Run 00 | Epoch 00091 | Loss 0.4164 | Train 0.7016 | Val 0.6924 | Test 0.5532
Number of nodes during this epoch:  4638145
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42520809173584  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1391987800598145
range selection method range initialization spend 0.024381160736083984
time for parepare:  0.38128066062927246
local_output_nid generation:  0.026146888732910156
local_in_edges_tensor generation:  0.2185208797454834
mini_batch_src_global generation:  0.37628912925720215
r_  generation:  5.65350866317749
local_output_nid generation:  0.02931523323059082
local_in_edges_tensor generation:  0.2431027889251709
mini_batch_src_global generation:  0.46378016471862793
r_  generation:  5.849108457565308
----------------------check_connections_block total spend ----------------------------- 14.903097867965698
generate_one_block  7.175055742263794
generate_one_block  6.8333213329315186
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.969219446182251
gen group dst list time:  0.09418797492980957
time for parepare:  0.47193408012390137
local_output_nid generation:  0.25217771530151367
local_in_edges_tensor generation:  1.6064598560333252
mini_batch_src_global generation:  2.6310086250305176
r_  generation:  30.194922924041748
local_output_nid generation:  0.5391013622283936
local_in_edges_tensor generation:  2.1055123805999756
mini_batch_src_global generation:  3.7316677570343018
r_  generation:  29.853872776031494
----------------------check_connections_block total spend ----------------------------- 83.26490807533264
generate_one_block  40.58318209648132
generate_one_block  40.849509716033936
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.22157883644104
gen group dst list time:  0.18421602249145508
time for parepare:  0.46314048767089844
local_output_nid generation:  0.3976142406463623
local_in_edges_tensor generation:  1.4567971229553223
mini_batch_src_global generation:  2.02785062789917
r_  generation:  25.712692975997925
local_output_nid generation:  0.7528243064880371
local_in_edges_tensor generation:  1.9232711791992188
mini_batch_src_global generation:  2.9555349349975586
r_  generation:  25.979780673980713
----------------------check_connections_block total spend ----------------------------- 71.81021881103516
generate_one_block  35.27926325798035
generate_one_block  35.913750648498535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42520809173584  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.0751268863678
block generation total time  152.62570571899414
average batch blocks generation time:  76.31285285949707
block dataloader generation time/epoch 367.5030380617017
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38408803939819336 |1.2961417436599731 |0.004507303237915039 |0.00015735626220703125 |0.00505518913269043 |0.002965688705444336 |
----------------------------------------------------------pseudo_mini_loss sum 0.41672641038894653
Total (block generation + training)time/epoch 371.35061950268954
Training time/epoch 3.7922801971435547
Training time without block to device /epoch 1.1999967098236084
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.31it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.47it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.30it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.32it/s] 40%|████      | 10/25 [00:00<00:00, 17.64it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.83it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.96it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.05it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.02it/s] 80%|████████  | 20/25 [00:01<00:00, 18.12it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.16it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.23it/s]100%|██████████| 25/25 [00:01<00:00, 18.09it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.27it/s]  8%|▊         | 2/25 [00:00<00:03,  6.43it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.33it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.35it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.47it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.46it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  7.18it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.15it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.30it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.41it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.36it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.36it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.36it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.35it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.31it/s] 80%|████████  | 20/25 [00:03<00:00,  6.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.28it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.06it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.84it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.77it/s]100%|██████████| 25/25 [00:03<00:00,  6.58it/s]100%|██████████| 25/25 [00:03<00:00,  6.32it/s]
Run 00 | Epoch 00092 | Loss 0.4167 | Train 0.7021 | Val 0.6929 | Test 0.5535
Number of nodes during this epoch:  4637818
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424034118652344  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1603398323059082
range selection method range initialization spend 0.024926424026489258
time for parepare:  0.3734591007232666
local_output_nid generation:  0.026040315628051758
local_in_edges_tensor generation:  0.2171008586883545
mini_batch_src_global generation:  0.3757896423339844
r_  generation:  5.488421201705933
local_output_nid generation:  0.027553081512451172
local_in_edges_tensor generation:  0.23612475395202637
mini_batch_src_global generation:  0.5194015502929688
r_  generation:  5.619672536849976
----------------------check_connections_block total spend ----------------------------- 14.597278833389282
generate_one_block  7.319962501525879
generate_one_block  7.20230507850647
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.253188371658325
gen group dst list time:  0.09050822257995605
time for parepare:  0.4567131996154785
local_output_nid generation:  0.24717426300048828
local_in_edges_tensor generation:  1.690229892730713
mini_batch_src_global generation:  2.479250907897949
r_  generation:  30.01719093322754
local_output_nid generation:  0.516812801361084
local_in_edges_tensor generation:  2.1094908714294434
mini_batch_src_global generation:  3.519336462020874
r_  generation:  30.075711488723755
----------------------check_connections_block total spend ----------------------------- 82.92720603942871
generate_one_block  41.07429337501526
generate_one_block  41.251179695129395
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1307129859924316
gen group dst list time:  0.18573713302612305
time for parepare:  0.46077561378479004
local_output_nid generation:  0.3690659999847412
local_in_edges_tensor generation:  1.4521832466125488
mini_batch_src_global generation:  2.0127389430999756
r_  generation:  25.358766078948975
local_output_nid generation:  0.7205984592437744
local_in_edges_tensor generation:  2.106132745742798
mini_batch_src_global generation:  2.8131296634674072
r_  generation:  25.858887672424316
----------------------check_connections_block total spend ----------------------------- 71.33084440231323
generate_one_block  35.21199822425842
generate_one_block  35.455968379974365
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424034118652344  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.25805044174194
block generation total time  152.99343967437744
average batch blocks generation time:  76.49671983718872
block dataloader generation time/epoch 367.4949366277264
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3799445629119873 |1.4408063888549805 |0.005287289619445801 |0.00019121170043945312 |0.005278825759887695 |0.001903533935546875 |
----------------------------------------------------------pseudo_mini_loss sum 0.4131370186805725
Total (block generation + training)time/epoch 371.34494550253754
Training time/epoch 4.073173522949219
Training time without block to device /epoch 1.1915607452392578
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.33it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.27it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.09it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.97it/s] 40%|████      | 10/25 [00:00<00:00, 17.31it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.28it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.47it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.48it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.67it/s] 80%|████████  | 20/25 [00:01<00:00, 17.79it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.75it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.91it/s]100%|██████████| 25/25 [00:01<00:00, 17.75it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.50it/s]  8%|▊         | 2/25 [00:00<00:03,  6.66it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.94it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.59it/s] 20%|██        | 5/25 [00:00<00:03,  5.42it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.29it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.23it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.04it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.92it/s] 40%|████      | 10/25 [00:01<00:03,  4.65it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.98it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.95it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.30it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.67it/s] 60%|██████    | 15/25 [00:02<00:01,  5.90it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.18it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.15it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.14it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.44it/s] 80%|████████  | 20/25 [00:03<00:00,  5.81it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.10it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.33it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.54it/s]100%|██████████| 25/25 [00:04<00:00,  5.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.78it/s]  8%|▊         | 2/25 [00:00<00:04,  5.75it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.17it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.73it/s] 20%|██        | 5/25 [00:00<00:03,  5.48it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.21it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.07it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.99it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.91it/s] 40%|████      | 10/25 [00:01<00:03,  4.92it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.93it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.93it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.90it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.29it/s] 60%|██████    | 15/25 [00:02<00:01,  5.67it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.96it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.11it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.74it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.54it/s] 80%|████████  | 20/25 [00:03<00:00,  5.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.65it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.93it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.14it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.33it/s]100%|██████████| 25/25 [00:04<00:00,  5.64it/s]
Run 00 | Epoch 00093 | Loss 0.4131 | Train 0.7022 | Val 0.6933 | Test 0.5539
Number of nodes during this epoch:  4637635
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42632532119751  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0982627868652344
range selection method range initialization spend 0.026354074478149414
time for parepare:  0.3816711902618408
local_output_nid generation:  0.02863907814025879
local_in_edges_tensor generation:  0.22222232818603516
mini_batch_src_global generation:  0.3767669200897217
r_  generation:  5.639312267303467
local_output_nid generation:  0.030673742294311523
local_in_edges_tensor generation:  0.2673048973083496
mini_batch_src_global generation:  0.4595985412597656
r_  generation:  5.883010387420654
----------------------check_connections_block total spend ----------------------------- 14.975188970565796
generate_one_block  7.267888784408569
generate_one_block  6.961900949478149
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9849767684936523
gen group dst list time:  0.10887360572814941
time for parepare:  0.4693899154663086
local_output_nid generation:  0.2671217918395996
local_in_edges_tensor generation:  1.6282780170440674
mini_batch_src_global generation:  2.6483306884765625
r_  generation:  30.645954608917236
local_output_nid generation:  0.5338361263275146
local_in_edges_tensor generation:  2.0939502716064453
mini_batch_src_global generation:  4.020009279251099
r_  generation:  30.078929901123047
----------------------check_connections_block total spend ----------------------------- 85.04111814498901
generate_one_block  41.195589780807495
generate_one_block  40.8656063079834
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2018463611602783
gen group dst list time:  0.19216012954711914
time for parepare:  0.4366638660430908
local_output_nid generation:  0.37845730781555176
local_in_edges_tensor generation:  1.4429378509521484
mini_batch_src_global generation:  2.003058671951294
r_  generation:  25.5406653881073
local_output_nid generation:  0.7370543479919434
local_in_edges_tensor generation:  2.0518882274627686
mini_batch_src_global generation:  2.703644037246704
r_  generation:  25.927958488464355
----------------------check_connections_block total spend ----------------------------- 71.2251467704773
generate_one_block  35.19783854484558
generate_one_block  35.926334381103516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42632532119751  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.2662649154663
block generation total time  153.18536901474
average batch blocks generation time:  76.59268450737
block dataloader generation time/epoch 367.509487768437
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4030817747116089 |1.1248853206634521 |0.004836559295654297 |0.00016951560974121094 |0.005017518997192383 |0.004033565521240234 |
----------------------------------------------------------pseudo_mini_loss sum 0.41299381852149963
Total (block generation + training)time/epoch 371.3556301644508
Training time/epoch 3.486398696899414
Training time without block to device /epoch 1.2366280555725098
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.94it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.42it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.17it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.58it/s] 40%|████      | 10/25 [00:00<00:00, 17.85it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.01it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.99it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.11it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.14it/s] 80%|████████  | 20/25 [00:01<00:00, 17.97it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.06it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.13it/s]100%|██████████| 25/25 [00:01<00:00, 18.06it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.42it/s]  8%|▊         | 2/25 [00:00<00:03,  6.47it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.45it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.50it/s] 20%|██        | 5/25 [00:00<00:03,  6.52it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.52it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.53it/s] 40%|████      | 10/25 [00:01<00:02,  6.53it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.55it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.57it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.58it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.57it/s] 60%|██████    | 15/25 [00:02<00:01,  6.56it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.57it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.56it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.52it/s] 80%|████████  | 20/25 [00:03<00:00,  6.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.50it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.52it/s]100%|██████████| 25/25 [00:03<00:00,  6.67it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.27it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.45it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.45it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.37it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.30it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
Run 00 | Epoch 00094 | Loss 0.4130 | Train 0.7021 | Val 0.6929 | Test 0.5544
Number of nodes during this epoch:  4636928
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423688888549805  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0045301914215088
range selection method range initialization spend 0.02486443519592285
time for parepare:  0.3638339042663574
local_output_nid generation:  0.02633190155029297
local_in_edges_tensor generation:  0.1834428310394287
mini_batch_src_global generation:  0.3855113983154297
r_  generation:  5.637116193771362
local_output_nid generation:  0.029451608657836914
local_in_edges_tensor generation:  0.21303415298461914
mini_batch_src_global generation:  0.461897611618042
r_  generation:  5.87736964225769
----------------------check_connections_block total spend ----------------------------- 14.864770412445068
generate_one_block  7.221155166625977
generate_one_block  6.935208082199097
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8004252910614014
gen group dst list time:  0.09283661842346191
time for parepare:  0.4557778835296631
local_output_nid generation:  0.26284289360046387
local_in_edges_tensor generation:  1.7286195755004883
mini_batch_src_global generation:  2.517028570175171
r_  generation:  30.1924831867218
local_output_nid generation:  0.5337083339691162
local_in_edges_tensor generation:  2.1360726356506348
mini_batch_src_global generation:  3.5495150089263916
r_  generation:  30.281965017318726
----------------------check_connections_block total spend ----------------------------- 83.81692123413086
generate_one_block  40.866785764694214
generate_one_block  41.15668725967407
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1229493618011475
gen group dst list time:  0.18950676918029785
time for parepare:  0.4416007995605469
local_output_nid generation:  0.37305569648742676
local_in_edges_tensor generation:  1.4233853816986084
mini_batch_src_global generation:  2.0504610538482666
r_  generation:  25.308140754699707
local_output_nid generation:  0.7280986309051514
local_in_edges_tensor generation:  1.951697826385498
mini_batch_src_global generation:  2.827056884765625
r_  generation:  26.12323784828186
----------------------check_connections_block total spend ----------------------------- 71.42121386528015
generate_one_block  35.06238842010498
generate_one_block  35.67946004867554
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423688888549805  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.238135099411
block generation total time  152.7653214931488
average batch blocks generation time:  76.3826607465744
block dataloader generation time/epoch 367.49283369716846
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37485170364379883 |1.1782283782958984 |0.004596710205078125 |0.00015664100646972656 |0.005133390426635742 |0.0019063949584960938 |
----------------------------------------------------------pseudo_mini_loss sum 0.41135719418525696
Total (block generation + training)time/epoch 371.3356713445563
Training time/epoch 3.532033920288086
Training time without block to device /epoch 1.175577163696289
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.96it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.64it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.11it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.23it/s] 40%|████      | 10/25 [00:00<00:01, 13.54it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.51it/s] 56%|█████▌    | 14/25 [00:00<00:00, 14.86it/s] 64%|██████▍   | 16/25 [00:01<00:00, 15.76it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.30it/s] 80%|████████  | 20/25 [00:01<00:00, 16.75it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.11it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.45it/s]100%|██████████| 25/25 [00:01<00:00, 16.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.50it/s]  8%|▊         | 2/25 [00:00<00:03,  6.64it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.67it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.01it/s] 20%|██        | 5/25 [00:00<00:03,  5.52it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.85it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.09it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.21it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.35it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.57it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.58it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.62it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.63it/s] 60%|██████    | 15/25 [00:02<00:01,  6.58it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.66it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.70it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.74it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.76it/s] 80%|████████  | 20/25 [00:03<00:00,  6.70it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.71it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.72it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.70it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.27it/s]100%|██████████| 25/25 [00:03<00:00,  6.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.29it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.00it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.06it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.24it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.89it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.63it/s] 40%|████      | 10/25 [00:01<00:02,  5.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.32it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.25it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.20it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.18it/s] 60%|██████    | 15/25 [00:02<00:01,  5.17it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.16it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.11it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.08it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.07it/s] 80%|████████  | 20/25 [00:03<00:00,  5.08it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.08it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.09it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.09it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.09it/s]100%|██████████| 25/25 [00:04<00:00,  5.51it/s]
Run 00 | Epoch 00095 | Loss 0.4114 | Train 0.7023 | Val 0.6933 | Test 0.5549
Number of nodes during this epoch:  4638031
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.420954704284668  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1875379085540771
range selection method range initialization spend 0.02429485321044922
time for parepare:  0.38495564460754395
local_output_nid generation:  0.0308229923248291
local_in_edges_tensor generation:  0.22063946723937988
mini_batch_src_global generation:  0.39104413986206055
r_  generation:  5.539950609207153
local_output_nid generation:  0.028516530990600586
local_in_edges_tensor generation:  0.24115872383117676
mini_batch_src_global generation:  0.4624037742614746
r_  generation:  5.894173622131348
----------------------check_connections_block total spend ----------------------------- 14.968256950378418
generate_one_block  7.264554977416992
generate_one_block  6.944274425506592
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0634541511535645
gen group dst list time:  0.09197783470153809
time for parepare:  0.46952295303344727
local_output_nid generation:  0.2787308692932129
local_in_edges_tensor generation:  1.604740858078003
mini_batch_src_global generation:  2.509751796722412
r_  generation:  29.690618753433228
local_output_nid generation:  0.5206024646759033
local_in_edges_tensor generation:  2.1725621223449707
mini_batch_src_global generation:  3.7012100219726562
r_  generation:  29.887935400009155
----------------------check_connections_block total spend ----------------------------- 82.71113085746765
generate_one_block  40.2728214263916
generate_one_block  40.75772047042847
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2496564388275146
gen group dst list time:  0.2046651840209961
time for parepare:  0.46851539611816406
local_output_nid generation:  0.3871917724609375
local_in_edges_tensor generation:  1.5994603633880615
mini_batch_src_global generation:  2.103398084640503
r_  generation:  26.35261106491089
local_output_nid generation:  0.7604820728302002
local_in_edges_tensor generation:  2.0873663425445557
mini_batch_src_global generation:  3.052593231201172
r_  generation:  26.828495740890503
----------------------check_connections_block total spend ----------------------------- 74.15449523925781
generate_one_block  36.863975524902344
generate_one_block  37.44093203544617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.420954704284668  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.86562609672546
block generation total time  155.33544945716858
average batch blocks generation time:  77.66772472858429
block dataloader generation time/epoch 367.53040655950707
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38409221172332764 |1.4745519161224365 |0.004885077476501465 |0.00016939640045166016 |0.005193114280700684 |0.002129793167114258 |
----------------------------------------------------------pseudo_mini_loss sum 0.4113520383834839
Total (block generation + training)time/epoch 371.37645821273327
Training time/epoch 4.151205062866211
Training time without block to device /epoch 1.202101230621338
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.95it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.41it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.05it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.42it/s] 40%|████      | 10/25 [00:00<00:00, 16.77it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.95it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.06it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.96it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.86it/s] 80%|████████  | 20/25 [00:01<00:00, 16.89it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.00it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.07it/s]100%|██████████| 25/25 [00:01<00:00, 17.00it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.50it/s]  8%|▊         | 2/25 [00:00<00:03,  6.50it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.56it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.95it/s] 20%|██        | 5/25 [00:00<00:03,  5.63it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.87it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.08it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.18it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.26it/s] 40%|████      | 10/25 [00:01<00:02,  6.30it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.35it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.27it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.30it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.26it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.32it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:03<00:00,  7.05it/s]100%|██████████| 25/25 [00:03<00:00,  6.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.12it/s]  8%|▊         | 2/25 [00:00<00:03,  6.28it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.33it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.35it/s] 20%|██        | 5/25 [00:00<00:03,  6.37it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.32it/s] 40%|████      | 10/25 [00:01<00:02,  6.33it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.34it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.36it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.38it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.36it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.28it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.30it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.24it/s]100%|██████████| 25/25 [00:03<00:00,  6.43it/s]
Run 00 | Epoch 00096 | Loss 0.4114 | Train 0.7021 | Val 0.6933 | Test 0.5550
Number of nodes during this epoch:  4637558
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4282050132751465  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1384625434875488
range selection method range initialization spend 0.02447366714477539
time for parepare:  0.3630204200744629
local_output_nid generation:  0.02652716636657715
local_in_edges_tensor generation:  0.2342534065246582
mini_batch_src_global generation:  0.3762805461883545
r_  generation:  5.648826599121094
local_output_nid generation:  0.029138565063476562
local_in_edges_tensor generation:  0.2320094108581543
mini_batch_src_global generation:  0.4766256809234619
r_  generation:  5.900036334991455
----------------------check_connections_block total spend ----------------------------- 15.01068115234375
generate_one_block  7.3854758739471436
generate_one_block  7.502878189086914
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.190322160720825
gen group dst list time:  0.09881019592285156
time for parepare:  0.4680821895599365
local_output_nid generation:  0.27153587341308594
local_in_edges_tensor generation:  1.6737170219421387
mini_batch_src_global generation:  2.4217324256896973
r_  generation:  30.233519554138184
local_output_nid generation:  0.5299942493438721
local_in_edges_tensor generation:  2.3929779529571533
mini_batch_src_global generation:  3.844895601272583
r_  generation:  31.317447662353516
----------------------check_connections_block total spend ----------------------------- 88.32557225227356
generate_one_block  42.96356153488159
generate_one_block  42.99820160865784
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.319263219833374
gen group dst list time:  0.18201518058776855
time for parepare:  0.45333099365234375
local_output_nid generation:  0.3785862922668457
local_in_edges_tensor generation:  1.5268282890319824
mini_batch_src_global generation:  2.008112668991089
r_  generation:  26.55511713027954
local_output_nid generation:  0.7498998641967773
local_in_edges_tensor generation:  1.9255661964416504
mini_batch_src_global generation:  2.9219510555267334
r_  generation:  26.57396626472473
----------------------check_connections_block total spend ----------------------------- 73.32834696769714
generate_one_block  35.30903935432434
generate_one_block  36.13349199295044
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4282050132751465  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  161.6539192199707
block generation total time  157.4042944908142
average batch blocks generation time:  78.7021472454071
block dataloader generation time/epoch 367.6531234746127
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37277281284332275 |1.2170599699020386 |0.0052689313888549805 |0.00015151500701904297 |0.005101680755615234 |0.0030364990234375 |
----------------------------------------------------------pseudo_mini_loss sum 0.4094785153865814
Total (block generation + training)time/epoch 371.49679411072094
Training time/epoch 3.6149277687072754
Training time without block to device /epoch 1.1808078289031982
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.80it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.17it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.08it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.74it/s] 40%|████      | 10/25 [00:00<00:00, 17.19it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.17it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.43it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.66it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.57it/s] 80%|████████  | 20/25 [00:01<00:00, 17.45it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.99it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.25it/s]100%|██████████| 25/25 [00:01<00:00, 17.26it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.62it/s]  8%|▊         | 2/25 [00:00<00:03,  6.70it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.89it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.59it/s] 20%|██        | 5/25 [00:00<00:03,  5.43it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.27it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.02it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.00it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.79it/s] 40%|████      | 10/25 [00:01<00:03,  4.75it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.10it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.93it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.01it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.98it/s] 60%|██████    | 15/25 [00:02<00:01,  5.38it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.75it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.44it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.28it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.20it/s] 80%|████████  | 20/25 [00:03<00:00,  5.17it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.15it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.11it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.11it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.11it/s]100%|██████████| 25/25 [00:04<00:00,  5.93it/s]100%|██████████| 25/25 [00:04<00:00,  5.30it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.44it/s]  8%|▊         | 2/25 [00:00<00:04,  5.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.00it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.33it/s] 20%|██        | 5/25 [00:00<00:03,  5.43it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.69it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.96it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.17it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.84it/s] 40%|████      | 10/25 [00:01<00:02,  5.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.39it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.28it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.21it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.14it/s] 60%|██████    | 15/25 [00:02<00:01,  5.06it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.06it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.06it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.02it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.03it/s] 80%|████████  | 20/25 [00:03<00:01,  5.00it/s] 84%|████████▍ | 21/25 [00:03<00:00,  4.92it/s] 88%|████████▊ | 22/25 [00:04<00:00,  4.82it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.19it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.56it/s]100%|██████████| 25/25 [00:04<00:00,  6.35it/s]100%|██████████| 25/25 [00:04<00:00,  5.41it/s]
Run 00 | Epoch 00097 | Loss 0.4095 | Train 0.7024 | Val 0.6937 | Test 0.5553
Number of nodes during this epoch:  4637102
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426426410675049  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.181356430053711
range selection method range initialization spend 0.024674177169799805
time for parepare:  0.383922815322876
local_output_nid generation:  0.026372432708740234
local_in_edges_tensor generation:  0.2133030891418457
mini_batch_src_global generation:  0.37262511253356934
r_  generation:  5.516377925872803
local_output_nid generation:  0.0278928279876709
local_in_edges_tensor generation:  0.22109293937683105
mini_batch_src_global generation:  0.45668864250183105
r_  generation:  5.592127561569214
----------------------check_connections_block total spend ----------------------------- 14.46882176399231
generate_one_block  7.339054584503174
generate_one_block  7.193023443222046
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.8205413818359375
gen group dst list time:  0.08909964561462402
time for parepare:  0.4501779079437256
local_output_nid generation:  0.24162077903747559
local_in_edges_tensor generation:  1.5738580226898193
mini_batch_src_global generation:  2.4318881034851074
r_  generation:  29.24801230430603
local_output_nid generation:  0.5094199180603027
local_in_edges_tensor generation:  2.369412422180176
mini_batch_src_global generation:  3.435182571411133
r_  generation:  29.848498582839966
----------------------check_connections_block total spend ----------------------------- 81.85765266418457
generate_one_block  40.92514753341675
generate_one_block  41.01080775260925
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2388052940368652
gen group dst list time:  0.19996881484985352
time for parepare:  0.4902968406677246
local_output_nid generation:  0.4327230453491211
local_in_edges_tensor generation:  1.570549488067627
mini_batch_src_global generation:  2.0145463943481445
r_  generation:  26.086737394332886
local_output_nid generation:  0.728905439376831
local_in_edges_tensor generation:  2.125903606414795
mini_batch_src_global generation:  2.8238651752471924
r_  generation:  26.106685876846313
----------------------check_connections_block total spend ----------------------------- 72.4310736656189
generate_one_block  35.463066816329956
generate_one_block  36.18236255645752
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426426410675049  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.28872632980347
block generation total time  153.58138465881348
average batch blocks generation time:  76.79069232940674
block dataloader generation time/epoch 367.64663966821166
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3957451581954956 |1.3490508794784546 |0.00485539436340332 |0.00017273426055908203 |0.005139589309692383 |0.002023935317993164 |
----------------------------------------------------------pseudo_mini_loss sum 0.4087699055671692
Total (block generation + training)time/epoch 371.491114601797
Training time/epoch 3.9223201274871826
Training time without block to device /epoch 1.2242183685302734
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.06it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.73it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.48it/s] 40%|████      | 10/25 [00:00<00:00, 17.76it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.86it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.98it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.02it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.04it/s] 80%|████████  | 20/25 [00:01<00:00, 18.15it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.10it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.14it/s]100%|██████████| 25/25 [00:01<00:00, 18.12it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.46it/s]  8%|▊         | 2/25 [00:00<00:03,  6.55it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.51it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.53it/s] 20%|██        | 5/25 [00:00<00:03,  6.52it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.52it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.56it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.56it/s] 40%|████      | 10/25 [00:01<00:02,  6.57it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.53it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.59it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.59it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.59it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.57it/s] 80%|████████  | 20/25 [00:03<00:00,  6.57it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.51it/s]100%|██████████| 25/25 [00:03<00:00,  6.64it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.73it/s]  8%|▊         | 2/25 [00:00<00:03,  6.12it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.30it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.36it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.24it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.31it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.32it/s] 40%|████      | 10/25 [00:01<00:02,  6.12it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.22it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.31it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.18it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.28it/s] 60%|██████    | 15/25 [00:02<00:01,  6.30it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.36it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.47it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
Run 00 | Epoch 00098 | Loss 0.4088 | Train 0.7025 | Val 0.6938 | Test 0.5553
Number of nodes during this epoch:  4637504
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425582408905029  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1133809089660645
range selection method range initialization spend 0.03561997413635254
time for parepare:  0.3537900447845459
local_output_nid generation:  0.026174306869506836
local_in_edges_tensor generation:  0.22745299339294434
mini_batch_src_global generation:  0.37458276748657227
r_  generation:  5.702101707458496
local_output_nid generation:  0.02926492691040039
local_in_edges_tensor generation:  0.23236489295959473
mini_batch_src_global generation:  0.48192620277404785
r_  generation:  5.951143980026245
----------------------check_connections_block total spend ----------------------------- 15.090717792510986
generate_one_block  7.200227975845337
generate_one_block  6.912358283996582
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.028532981872559
gen group dst list time:  0.0863797664642334
time for parepare:  0.4355640411376953
local_output_nid generation:  0.2583498954772949
local_in_edges_tensor generation:  1.7634942531585693
mini_batch_src_global generation:  2.5715601444244385
r_  generation:  29.948517084121704
local_output_nid generation:  0.5302975177764893
local_in_edges_tensor generation:  2.0960400104522705
mini_batch_src_global generation:  3.5047004222869873
r_  generation:  30.39369773864746
----------------------check_connections_block total spend ----------------------------- 83.5517795085907
generate_one_block  41.09309673309326
generate_one_block  41.28867506980896
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.204035758972168
gen group dst list time:  0.1892843246459961
time for parepare:  0.45227789878845215
local_output_nid generation:  0.3793020248413086
local_in_edges_tensor generation:  1.4824912548065186
mini_batch_src_global generation:  2.084890842437744
r_  generation:  25.7805917263031
local_output_nid generation:  0.731734037399292
local_in_edges_tensor generation:  2.0027546882629395
mini_batch_src_global generation:  2.7788257598876953
r_  generation:  26.38976550102234
----------------------check_connections_block total spend ----------------------------- 72.50100493431091
generate_one_block  35.66770839691162
generate_one_block  36.15616536140442
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425582408905029  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.0527844429016
block generation total time  154.20564556121826
average batch blocks generation time:  77.10282278060913
block dataloader generation time/epoch 367.6613129606151
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38916218280792236 |1.320726752281189 |0.005005836486816406 |0.00016808509826660156 |0.005179882049560547 |0.006378173828125 |
----------------------------------------------------------pseudo_mini_loss sum 0.40743935108184814
Total (block generation + training)time/epoch 371.50589051150314
Training time/epoch 3.854430913925171
Training time without block to device /epoch 1.212977409362793
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.94it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.41it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.13it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.52it/s] 40%|████      | 10/25 [00:00<00:00, 17.75it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.89it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.81it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.92it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.01it/s] 80%|████████  | 20/25 [00:01<00:00, 18.04it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.01it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.12it/s]100%|██████████| 25/25 [00:01<00:00, 18.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.38it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.50it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.53it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.55it/s] 40%|████      | 10/25 [00:01<00:02,  6.55it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.52it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.52it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.54it/s] 60%|██████    | 15/25 [00:02<00:01,  6.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.53it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.50it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.46it/s]100%|██████████| 25/25 [00:03<00:00,  6.60it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.19it/s]  8%|▊         | 2/25 [00:00<00:03,  6.29it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.41it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.42it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.33it/s] 40%|████      | 10/25 [00:01<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.36it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.40it/s] 60%|██████    | 15/25 [00:02<00:01,  6.43it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.40it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.39it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.40it/s]100%|██████████| 25/25 [00:03<00:00,  7.13it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
Run 00 | Epoch 00099 | Loss 0.4074 | Train 0.7027 | Val 0.6940 | Test 0.5556
Number of nodes during this epoch:  4637975
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42653226852417  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0928263664245605
range selection method range initialization spend 0.0258791446685791
time for parepare:  0.3836231231689453
local_output_nid generation:  0.026446104049682617
local_in_edges_tensor generation:  0.2390446662902832
mini_batch_src_global generation:  0.37073564529418945
r_  generation:  5.427383899688721
local_output_nid generation:  0.026942014694213867
local_in_edges_tensor generation:  0.2071683406829834
mini_batch_src_global generation:  0.47302818298339844
r_  generation:  5.657979726791382
----------------------check_connections_block total spend ----------------------------- 14.487876415252686
generate_one_block  7.15632700920105
generate_one_block  6.767738103866577
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.078081846237183
gen group dst list time:  0.09338736534118652
time for parepare:  0.44942498207092285
local_output_nid generation:  0.24158787727355957
local_in_edges_tensor generation:  1.6347129344940186
mini_batch_src_global generation:  2.46840238571167
r_  generation:  29.847548723220825
local_output_nid generation:  0.5152366161346436
local_in_edges_tensor generation:  2.053457498550415
mini_batch_src_global generation:  3.4865167140960693
r_  generation:  29.784207344055176
----------------------check_connections_block total spend ----------------------------- 82.14092183113098
generate_one_block  40.75997519493103
generate_one_block  40.984519243240356
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1364586353302
gen group dst list time:  0.18802142143249512
time for parepare:  0.4522080421447754
local_output_nid generation:  0.3792738914489746
local_in_edges_tensor generation:  1.4356842041015625
mini_batch_src_global generation:  2.003448963165283
r_  generation:  25.43541121482849
local_output_nid generation:  0.7183332443237305
local_in_edges_tensor generation:  1.9177865982055664
mini_batch_src_global generation:  2.7952935695648193
r_  generation:  25.877098321914673
----------------------check_connections_block total spend ----------------------------- 70.95935773849487
generate_one_block  34.6702926158905
generate_one_block  35.34403085708618
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42653226852417  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.10027956962585
block generation total time  151.75881791114807
average batch blocks generation time:  75.87940895557404
block dataloader generation time/epoch 367.60796132087705
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38233423233032227 |1.3718080520629883 |0.004338979721069336 |0.0001519918441772461 |0.0050553083419799805 |0.0016698837280273438 |
----------------------------------------------------------pseudo_mini_loss sum 0.4050397276878357
Total (block generation + training)time/epoch 371.4535536909103
Training time/epoch 3.945897340774536
Training time without block to device /epoch 1.2022812366485596
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.37it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.76it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.49it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.91it/s] 40%|████      | 10/25 [00:00<00:01, 14.28it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.51it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.27it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.93it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.35it/s] 80%|████████  | 20/25 [00:01<00:00, 17.71it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.84it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.04it/s]100%|██████████| 25/25 [00:01<00:00, 17.31it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.69it/s]  8%|▊         | 2/25 [00:00<00:03,  6.69it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.76it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.78it/s] 20%|██        | 5/25 [00:00<00:02,  6.78it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.80it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.49it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.53it/s] 40%|████      | 10/25 [00:01<00:02,  6.31it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.29it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.35it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.23it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.26it/s] 60%|██████    | 15/25 [00:02<00:01,  6.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.51it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.57it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.60it/s] 80%|████████  | 20/25 [00:03<00:00,  6.10it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.73it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.36it/s]100%|██████████| 25/25 [00:04<00:00,  5.97it/s]100%|██████████| 25/25 [00:04<00:00,  6.23it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.77it/s]  8%|▊         | 2/25 [00:00<00:04,  4.96it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.97it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.85it/s] 20%|██        | 5/25 [00:00<00:03,  5.28it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.64it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.90it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.11it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.26it/s] 40%|████      | 10/25 [00:01<00:02,  6.37it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.97it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.67it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.13it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.13it/s] 60%|██████    | 15/25 [00:02<00:01,  5.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.62it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.86it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.09it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.25it/s] 80%|████████  | 20/25 [00:03<00:00,  6.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.99it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.69it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.51it/s]100%|██████████| 25/25 [00:04<00:00,  6.25it/s]100%|██████████| 25/25 [00:04<00:00,  5.76it/s]
Run 00 | Epoch 00100 | Loss 0.4050 | Train 0.7032 | Val 0.6949 | Test 0.5561
Number of nodes during this epoch:  4637688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424571990966797  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1049199104309082
range selection method range initialization spend 0.0239260196685791
time for parepare:  0.3588449954986572
local_output_nid generation:  0.02586984634399414
local_in_edges_tensor generation:  0.18746566772460938
mini_batch_src_global generation:  0.3724799156188965
r_  generation:  5.425023078918457
local_output_nid generation:  0.027540922164916992
local_in_edges_tensor generation:  0.2461552619934082
mini_batch_src_global generation:  0.4798867702484131
r_  generation:  5.677581787109375
----------------------check_connections_block total spend ----------------------------- 14.451761722564697
generate_one_block  7.25112247467041
generate_one_block  6.972014665603638
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.095944881439209
gen group dst list time:  0.09530043601989746
time for parepare:  0.4460256099700928
local_output_nid generation:  0.2503180503845215
local_in_edges_tensor generation:  1.7004685401916504
mini_batch_src_global generation:  2.520648717880249
r_  generation:  30.355249881744385
local_output_nid generation:  0.5185167789459229
local_in_edges_tensor generation:  2.244361639022827
mini_batch_src_global generation:  3.51184344291687
r_  generation:  30.248947620391846
----------------------check_connections_block total spend ----------------------------- 83.71603322029114
generate_one_block  41.187116384506226
generate_one_block  41.3820915222168
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1153974533081055
gen group dst list time:  0.1927022933959961
time for parepare:  0.48459601402282715
local_output_nid generation:  0.3847179412841797
local_in_edges_tensor generation:  1.5369136333465576
mini_batch_src_global generation:  2.112525463104248
r_  generation:  26.69924783706665
local_output_nid generation:  0.7224423885345459
local_in_edges_tensor generation:  1.943500280380249
mini_batch_src_global generation:  2.8294849395751953
r_  generation:  26.01960563659668
----------------------check_connections_block total spend ----------------------------- 73.26445579528809
generate_one_block  35.08534622192383
generate_one_block  35.861915588378906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424571990966797  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.98048901557922
block generation total time  153.51646971702576
average batch blocks generation time:  76.75823485851288
block dataloader generation time/epoch 367.61972082723486
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3780122995376587 |1.3019288778305054 |0.004451870918273926 |0.0001519918441772461 |0.0051223039627075195 |0.0030188560485839844 |
----------------------------------------------------------pseudo_mini_loss sum 0.40463054180145264
Total (block generation + training)time/epoch 371.46476862690236
Training time/epoch 3.790398120880127
Training time without block to device /epoch 1.1865403652191162
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.33it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.76it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.10it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.57it/s] 40%|████      | 10/25 [00:00<00:00, 17.83it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.01it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.19it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.24it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.26it/s] 80%|████████  | 20/25 [00:01<00:00, 18.29it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.33it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.33it/s]100%|██████████| 25/25 [00:01<00:00, 18.25it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.56it/s]  8%|▊         | 2/25 [00:00<00:03,  6.59it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.64it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.72it/s] 20%|██        | 5/25 [00:00<00:02,  6.74it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.75it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.77it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.73it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.70it/s] 40%|████      | 10/25 [00:01<00:02,  6.70it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.71it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.73it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.74it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.73it/s] 60%|██████    | 15/25 [00:02<00:01,  6.73it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.74it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.72it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.72it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.76it/s] 80%|████████  | 20/25 [00:03<00:00,  6.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.90it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.66it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.43it/s]100%|██████████| 25/25 [00:03<00:00,  5.98it/s]100%|██████████| 25/25 [00:03<00:00,  6.40it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.94it/s]  8%|▊         | 2/25 [00:00<00:04,  5.04it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.08it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.10it/s] 20%|██        | 5/25 [00:00<00:03,  5.11it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.11it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.09it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.12it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.12it/s] 40%|████      | 10/25 [00:01<00:02,  5.05it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.07it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.29it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.86it/s] 60%|██████    | 15/25 [00:02<00:01,  5.86it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.03it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.09it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.92it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.03it/s] 80%|████████  | 20/25 [00:03<00:00,  5.98it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.12it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.21it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.27it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.34it/s]100%|██████████| 25/25 [00:04<00:00,  5.74it/s]
Run 00 | Epoch 00101 | Loss 0.4046 | Train 0.7039 | Val 0.6956 | Test 0.5565
Number of nodes during this epoch:  4637655
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428407192230225  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1246368885040283
range selection method range initialization spend 0.023975610733032227
time for parepare:  0.37195515632629395
local_output_nid generation:  0.02568793296813965
local_in_edges_tensor generation:  0.1937563419342041
mini_batch_src_global generation:  0.3716614246368408
r_  generation:  5.670029163360596
local_output_nid generation:  0.029466867446899414
local_in_edges_tensor generation:  0.2332301139831543
mini_batch_src_global generation:  0.4816124439239502
r_  generation:  5.867273807525635
----------------------check_connections_block total spend ----------------------------- 14.91179609298706
generate_one_block  7.226158618927002
generate_one_block  6.825983285903931
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.939345359802246
gen group dst list time:  0.08509683609008789
time for parepare:  0.432936429977417
local_output_nid generation:  0.2498946189880371
local_in_edges_tensor generation:  1.7372610569000244
mini_batch_src_global generation:  2.5819666385650635
r_  generation:  29.976356983184814
local_output_nid generation:  0.5250380039215088
local_in_edges_tensor generation:  2.1096627712249756
mini_batch_src_global generation:  3.5593490600585938
r_  generation:  29.935778379440308
----------------------check_connections_block total spend ----------------------------- 83.32097625732422
generate_one_block  40.5813946723938
generate_one_block  40.97099995613098
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1306750774383545
gen group dst list time:  0.18935084342956543
time for parepare:  0.4663558006286621
local_output_nid generation:  0.36983180046081543
local_in_edges_tensor generation:  1.419987678527832
mini_batch_src_global generation:  2.043370008468628
r_  generation:  25.4131600856781
local_output_nid generation:  0.7316625118255615
local_in_edges_tensor generation:  1.9296977519989014
mini_batch_src_global generation:  2.9761180877685547
r_  generation:  25.75645637512207
----------------------check_connections_block total spend ----------------------------- 71.1217303276062
generate_one_block  35.04471731185913
generate_one_block  35.38401412963867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428407192230225  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.44270658493042
block generation total time  151.98112607002258
average batch blocks generation time:  75.99056303501129
block dataloader generation time/epoch 367.5911615993462
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39084386825561523 |1.3294419050216675 |0.004338860511779785 |0.0001500844955444336 |0.005191683769226074 |0.0015282630920410156 |
----------------------------------------------------------pseudo_mini_loss sum 0.40288615226745605
Total (block generation + training)time/epoch 371.43644969369853
Training time/epoch 3.8693935871124268
Training time without block to device /epoch 1.2105097770690918
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.30it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.57it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.35it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.57it/s] 40%|████      | 10/25 [00:00<00:00, 17.21it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.61it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.82it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.00it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.12it/s] 80%|████████  | 20/25 [00:01<00:00, 18.19it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.19it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.24it/s]100%|██████████| 25/25 [00:01<00:00, 18.06it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.58it/s]  8%|▊         | 2/25 [00:00<00:03,  6.62it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.63it/s] 20%|██        | 5/25 [00:00<00:03,  6.64it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.13it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.78it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.79it/s] 40%|████      | 10/25 [00:01<00:02,  6.03it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.18it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.29it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.47it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.54it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  6.88it/s]100%|██████████| 25/25 [00:03<00:00,  6.39it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.33it/s]  8%|▊         | 2/25 [00:00<00:03,  6.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.51it/s] 20%|██        | 5/25 [00:00<00:03,  6.52it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.55it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.52it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.49it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.43it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.46it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.48it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.47it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.17it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.19it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
Run 00 | Epoch 00102 | Loss 0.4029 | Train 0.7042 | Val 0.6960 | Test 0.5569
Number of nodes during this epoch:  4637216
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429451942443848  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1649317741394043
range selection method range initialization spend 0.02484273910522461
time for parepare:  0.35514044761657715
local_output_nid generation:  0.030899524688720703
local_in_edges_tensor generation:  0.23051118850708008
mini_batch_src_global generation:  0.3725776672363281
r_  generation:  5.422499418258667
local_output_nid generation:  0.02882981300354004
local_in_edges_tensor generation:  0.19263577461242676
mini_batch_src_global generation:  0.45625972747802734
r_  generation:  5.598958969116211
----------------------check_connections_block total spend ----------------------------- 14.332993984222412
generate_one_block  7.218363046646118
generate_one_block  6.871990442276001
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9453976154327393
gen group dst list time:  0.08866286277770996
time for parepare:  0.4589054584503174
local_output_nid generation:  0.25409984588623047
local_in_edges_tensor generation:  1.6558811664581299
mini_batch_src_global generation:  2.504413604736328
r_  generation:  29.897969007492065
local_output_nid generation:  0.5480544567108154
local_in_edges_tensor generation:  2.258425712585449
mini_batch_src_global generation:  3.73862886428833
r_  generation:  29.942132472991943
----------------------check_connections_block total spend ----------------------------- 83.18911957740784
generate_one_block  41.54242753982544
generate_one_block  40.867676734924316
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3214268684387207
gen group dst list time:  0.19957971572875977
time for parepare:  0.4638359546661377
local_output_nid generation:  0.37826967239379883
local_in_edges_tensor generation:  1.5709567070007324
mini_batch_src_global generation:  2.019063711166382
r_  generation:  26.159422397613525
local_output_nid generation:  0.7474837303161621
local_in_edges_tensor generation:  2.12199330329895
mini_batch_src_global generation:  2.9265666007995605
r_  generation:  26.1544406414032
----------------------check_connections_block total spend ----------------------------- 72.44729590415955
generate_one_block  35.34693360328674
generate_one_block  36.0581910610199
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429451942443848  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.63641548156738
block generation total time  153.8152289390564
average batch blocks generation time:  76.9076144695282
block dataloader generation time/epoch 367.5943305214632
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39644086360931396 |1.376621127128601 |0.004852652549743652 |0.00017440319061279297 |0.0052269697189331055 |0.004109859466552734 |
----------------------------------------------------------pseudo_mini_loss sum 0.40191057324409485
Total (block generation + training)time/epoch 371.44090624457425
Training time/epoch 3.9777348041534424
Training time without block to device /epoch 1.2244925498962402
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.48it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.40it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.70it/s] 40%|████      | 10/25 [00:00<00:00, 17.91it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.05it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.10it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.16it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.20it/s] 80%|████████  | 20/25 [00:01<00:00, 18.17it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.22it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.28it/s]100%|██████████| 25/25 [00:01<00:00, 18.24it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.39it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.44it/s] 20%|██        | 5/25 [00:00<00:03,  6.38it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.42it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.47it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.13it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.08it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.97it/s] 60%|██████    | 15/25 [00:02<00:01,  5.98it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.07it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.19it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.26it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.33it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.51it/s]100%|██████████| 25/25 [00:03<00:00,  6.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.36it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.48it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.38it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.42it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.49it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.47it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.47it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.45it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.23it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.23it/s] 60%|██████    | 15/25 [00:02<00:01,  6.28it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.01it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.02it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.11it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.20it/s] 80%|████████  | 20/25 [00:03<00:00,  6.30it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.37it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.44it/s]
Run 00 | Epoch 00103 | Loss 0.4019 | Train 0.7044 | Val 0.6965 | Test 0.5573
Number of nodes during this epoch:  4637756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423225402832031  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0720946788787842
range selection method range initialization spend 0.023555994033813477
time for parepare:  0.3545396327972412
local_output_nid generation:  0.025860071182250977
local_in_edges_tensor generation:  0.17036223411560059
mini_batch_src_global generation:  0.3609802722930908
r_  generation:  5.390737056732178
local_output_nid generation:  0.026716947555541992
local_in_edges_tensor generation:  0.21089506149291992
mini_batch_src_global generation:  0.45784974098205566
r_  generation:  5.678951025009155
----------------------check_connections_block total spend ----------------------------- 14.264105081558228
generate_one_block  7.171445369720459
generate_one_block  6.860054016113281
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9509875774383545
gen group dst list time:  0.0840444564819336
time for parepare:  0.436265230178833
local_output_nid generation:  0.2449488639831543
local_in_edges_tensor generation:  1.6004550457000732
mini_batch_src_global generation:  2.439728260040283
r_  generation:  30.24946665763855
local_output_nid generation:  0.5310635566711426
local_in_edges_tensor generation:  2.0641896724700928
mini_batch_src_global generation:  3.5228869915008545
r_  generation:  30.457084894180298
----------------------check_connections_block total spend ----------------------------- 83.58535099029541
generate_one_block  41.168381214141846
generate_one_block  41.19471549987793
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2115259170532227
gen group dst list time:  0.1966853141784668
time for parepare:  0.5004730224609375
local_output_nid generation:  0.41478681564331055
local_in_edges_tensor generation:  1.5514228343963623
mini_batch_src_global generation:  2.0414466857910156
r_  generation:  26.12581753730774
local_output_nid generation:  0.7223389148712158
local_in_edges_tensor generation:  2.089871644973755
mini_batch_src_global generation:  2.8145911693573
r_  generation:  25.91574716567993
----------------------check_connections_block total spend ----------------------------- 71.98854398727417
generate_one_block  35.10399556159973
generate_one_block  35.88135099411011
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423225402832031  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.57389497756958
block generation total time  153.34844326972961
average batch blocks generation time:  76.67422163486481
block dataloader generation time/epoch 367.5803551352941
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38002634048461914 |1.2858928442001343 |0.004917621612548828 |0.00015532970428466797 |0.005199909210205078 |0.0016663074493408203 |
----------------------------------------------------------pseudo_mini_loss sum 0.4007676839828491
Total (block generation + training)time/epoch 371.4261888701182
Training time/epoch 3.7692337036132812
Training time without block to device /epoch 1.1974480152130127
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.68it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.49it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.26it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.54it/s] 40%|████      | 10/25 [00:00<00:00, 17.62it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.69it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.74it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.75it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.75it/s] 80%|████████  | 20/25 [00:01<00:00, 17.77it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.75it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.85it/s]100%|██████████| 25/25 [00:01<00:00, 17.83it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.39it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.52it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.56it/s] 20%|██        | 5/25 [00:00<00:03,  6.57it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.57it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.49it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.42it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.36it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.07it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.65it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.67it/s] 60%|██████    | 15/25 [00:02<00:01,  5.75it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.83it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.95it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.00it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.46it/s] 80%|████████  | 20/25 [00:03<00:00,  5.63it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.34it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.27it/s]100%|██████████| 25/25 [00:04<00:00,  6.09it/s]100%|██████████| 25/25 [00:04<00:00,  5.97it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.93it/s]  8%|▊         | 2/25 [00:00<00:05,  4.58it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.17it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.55it/s] 20%|██        | 5/25 [00:00<00:03,  5.88it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.03it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.25it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.45it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.51it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.42it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.43it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]
Run 00 | Epoch 00104 | Loss 0.4008 | Train 0.7051 | Val 0.6972 | Test 0.5577
Number of nodes during this epoch:  4637412
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427280902862549  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.130702257156372
range selection method range initialization spend 0.026286602020263672
time for parepare:  0.3684728145599365
local_output_nid generation:  0.025439977645874023
local_in_edges_tensor generation:  0.21624135971069336
mini_batch_src_global generation:  0.3771696090698242
r_  generation:  5.477419376373291
local_output_nid generation:  0.027308225631713867
local_in_edges_tensor generation:  0.22563719749450684
mini_batch_src_global generation:  0.48622846603393555
r_  generation:  5.755963087081909
----------------------check_connections_block total spend ----------------------------- 14.62569260597229
generate_one_block  7.3086583614349365
generate_one_block  7.223828077316284
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.967236280441284
gen group dst list time:  0.09137392044067383
time for parepare:  0.46979761123657227
local_output_nid generation:  0.26052093505859375
local_in_edges_tensor generation:  1.6169793605804443
mini_batch_src_global generation:  2.5272064208984375
r_  generation:  29.59645366668701
local_output_nid generation:  0.5198533535003662
local_in_edges_tensor generation:  2.4258716106414795
mini_batch_src_global generation:  3.6805574893951416
r_  generation:  29.62822389602661
----------------------check_connections_block total spend ----------------------------- 82.66620683670044
generate_one_block  40.37294149398804
generate_one_block  40.52940583229065
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.229279041290283
gen group dst list time:  0.18777775764465332
time for parepare:  0.4565598964691162
local_output_nid generation:  0.3775675296783447
local_in_edges_tensor generation:  1.47529935836792
mini_batch_src_global generation:  2.018047332763672
r_  generation:  25.273152828216553
local_output_nid generation:  0.7224345207214355
local_in_edges_tensor generation:  2.157754421234131
mini_batch_src_global generation:  2.968855857849121
r_  generation:  25.692691326141357
----------------------check_connections_block total spend ----------------------------- 71.087730884552
generate_one_block  34.99188303947449
generate_one_block  35.65097618103027
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427280902862549  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.75393772125244
block generation total time  151.54520654678345
average batch blocks generation time:  75.77260327339172
block dataloader generation time/epoch 367.55502950350444
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39657795429229736 |1.325785517692566 |0.004681110382080078 |0.00016164779663085938 |0.005084633827209473 |0.0016033649444580078 |
----------------------------------------------------------pseudo_mini_loss sum 0.39997631311416626
Total (block generation + training)time/epoch 371.40117487680345
Training time/epoch 3.8783962726593018
Training time without block to device /epoch 1.22682523727417
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.67it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.45it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.84it/s] 40%|████      | 10/25 [00:00<00:01, 14.21it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.38it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.25it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.94it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.40it/s] 80%|████████  | 20/25 [00:01<00:00, 17.75it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.91it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.10it/s]100%|██████████| 25/25 [00:01<00:00, 17.31it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.49it/s]  8%|▊         | 2/25 [00:00<00:03,  6.55it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.57it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.59it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.61it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.56it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.60it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.61it/s] 40%|████      | 10/25 [00:01<00:02,  6.62it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.63it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.61it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.60it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.62it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.62it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.62it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.60it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.62it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.62it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.62it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.62it/s]100%|██████████| 25/25 [00:03<00:00,  6.71it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.20it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.52it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.54it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.52it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.51it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.49it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.50it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.51it/s] 80%|████████  | 20/25 [00:03<00:00,  6.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.51it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  7.26it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
Run 00 | Epoch 00105 | Loss 0.4000 | Train 0.7058 | Val 0.6977 | Test 0.5580
Number of nodes during this epoch:  4637612
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425161838531494  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.157008409500122
range selection method range initialization spend 0.024412870407104492
time for parepare:  0.38103699684143066
local_output_nid generation:  0.026086091995239258
local_in_edges_tensor generation:  0.22126483917236328
mini_batch_src_global generation:  0.38642096519470215
r_  generation:  5.571948766708374
local_output_nid generation:  0.027172565460205078
local_in_edges_tensor generation:  0.21964788436889648
mini_batch_src_global generation:  0.5057549476623535
r_  generation:  5.568978786468506
----------------------check_connections_block total spend ----------------------------- 14.574918031692505
generate_one_block  7.269493818283081
generate_one_block  7.157468795776367
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9281513690948486
gen group dst list time:  0.08863282203674316
time for parepare:  0.469773530960083
local_output_nid generation:  0.257493257522583
local_in_edges_tensor generation:  1.663616418838501
mini_batch_src_global generation:  2.529670000076294
r_  generation:  30.07369065284729
local_output_nid generation:  0.5146346092224121
local_in_edges_tensor generation:  2.188729763031006
mini_batch_src_global generation:  3.5250251293182373
r_  generation:  30.134984731674194
----------------------check_connections_block total spend ----------------------------- 83.47609782218933
generate_one_block  40.7788188457489
generate_one_block  40.683743953704834
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.210824728012085
gen group dst list time:  0.1788475513458252
time for parepare:  0.4451878070831299
local_output_nid generation:  0.3802521228790283
local_in_edges_tensor generation:  1.4502449035644531
mini_batch_src_global generation:  2.027071237564087
r_  generation:  26.671664237976074
local_output_nid generation:  0.7334496974945068
local_in_edges_tensor generation:  1.9186158180236816
mini_batch_src_global generation:  2.8439748287200928
r_  generation:  26.536656141281128
----------------------check_connections_block total spend ----------------------------- 73.44630908966064
generate_one_block  35.05807971954346
generate_one_block  35.73110008239746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425161838531494  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.92240691184998
block generation total time  152.25174260139465
average batch blocks generation time:  76.12587130069733
block dataloader generation time/epoch 367.55800969195815
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37323927879333496 |1.2886971235275269 |0.004344344139099121 |0.0001462697982788086 |0.005124449729919434 |0.0030057430267333984 |
----------------------------------------------------------pseudo_mini_loss sum 0.39828842878341675
Total (block generation + training)time/epoch 371.40327048076773
Training time/epoch 3.7522177696228027
Training time without block to device /epoch 1.174823522567749
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.95it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.60it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.41it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.64it/s] 40%|████      | 10/25 [00:00<00:00, 17.92it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.14it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.08it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.13it/s] 80%|████████  | 20/25 [00:01<00:00, 17.86it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.77it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.76it/s]100%|██████████| 25/25 [00:01<00:00, 17.93it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.11it/s]  8%|▊         | 2/25 [00:00<00:04,  5.13it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.14it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.63it/s] 20%|██        | 5/25 [00:00<00:03,  6.00it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.28it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.90it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.64it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.48it/s] 40%|████      | 10/25 [00:01<00:02,  5.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.29it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.23it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.16it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.14it/s] 60%|██████    | 15/25 [00:02<00:01,  5.00it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.27it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.60it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.89it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.87it/s] 80%|████████  | 20/25 [00:03<00:00,  5.97it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.64it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.89it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.09it/s]100%|██████████| 25/25 [00:04<00:00,  5.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.35it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.66it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.63it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.08it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.07it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.12it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.10it/s] 40%|████      | 10/25 [00:01<00:03,  4.91it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.90it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.06it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.37it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.67it/s] 60%|██████    | 15/25 [00:02<00:01,  5.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.65it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.44it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.27it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.17it/s] 80%|████████  | 20/25 [00:03<00:00,  5.07it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.08it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.08it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.08it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.03it/s]100%|██████████| 25/25 [00:04<00:00,  5.90it/s]100%|██████████| 25/25 [00:04<00:00,  5.41it/s]
Run 00 | Epoch 00106 | Loss 0.3983 | Train 0.7065 | Val 0.6983 | Test 0.5580
Number of nodes during this epoch:  4637227
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423386573791504  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1143934726715088
range selection method range initialization spend 0.02508854866027832
time for parepare:  0.3693063259124756
local_output_nid generation:  0.02613353729248047
local_in_edges_tensor generation:  0.23256278038024902
mini_batch_src_global generation:  0.3766005039215088
r_  generation:  5.691321611404419
local_output_nid generation:  0.02892780303955078
local_in_edges_tensor generation:  0.2519402503967285
mini_batch_src_global generation:  0.47092127799987793
r_  generation:  5.927872896194458
----------------------check_connections_block total spend ----------------------------- 15.09442949295044
generate_one_block  7.271253347396851
generate_one_block  6.958720922470093
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.029032468795776
gen group dst list time:  0.09354043006896973
time for parepare:  0.44970703125
local_output_nid generation:  0.2657172679901123
local_in_edges_tensor generation:  1.6568732261657715
mini_batch_src_global generation:  2.5077579021453857
r_  generation:  29.785237789154053
local_output_nid generation:  0.5222287178039551
local_in_edges_tensor generation:  2.306872606277466
mini_batch_src_global generation:  3.710726499557495
r_  generation:  29.701180934906006
----------------------check_connections_block total spend ----------------------------- 82.91061115264893
generate_one_block  40.819379806518555
generate_one_block  40.76576209068298
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.181245803833008
gen group dst list time:  0.17866277694702148
time for parepare:  0.45186352729797363
local_output_nid generation:  0.37672924995422363
local_in_edges_tensor generation:  1.5368080139160156
mini_batch_src_global generation:  2.1833930015563965
r_  generation:  26.422378301620483
local_output_nid generation:  0.731339693069458
local_in_edges_tensor generation:  1.9796855449676514
mini_batch_src_global generation:  2.8444576263427734
r_  generation:  26.248953580856323
----------------------check_connections_block total spend ----------------------------- 72.78654837608337
generate_one_block  35.44672393798828
generate_one_block  36.04739499092102
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423386573791504  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.6971595287323
block generation total time  153.07926082611084
average batch blocks generation time:  76.53963041305542
block dataloader generation time/epoch 367.5604667217932
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37172412872314453 |1.214621663093567 |0.0043909549713134766 |0.0001550912857055664 |0.005131959915161133 |0.0016884803771972656 |
----------------------------------------------------------pseudo_mini_loss sum 0.3977172374725342
Total (block generation + training)time/epoch 371.40346571441006
Training time/epoch 3.603081703186035
Training time without block to device /epoch 1.1738383769989014
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.47it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.14it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.98it/s] 40%|████      | 10/25 [00:00<00:00, 17.40it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.66it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.76it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.80it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.21it/s] 80%|████████  | 20/25 [00:01<00:00, 16.95it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.38it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.65it/s]100%|██████████| 25/25 [00:01<00:00, 17.60it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.50it/s]  8%|▊         | 2/25 [00:00<00:04,  5.60it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.27it/s] 20%|██        | 5/25 [00:00<00:03,  5.24it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.23it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.21it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.09it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.93it/s] 40%|████      | 10/25 [00:01<00:02,  5.06it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.32it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.57it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.73it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.94it/s] 60%|██████    | 15/25 [00:02<00:01,  6.09it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.01it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.73it/s] 80%|████████  | 20/25 [00:03<00:00,  5.56it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.13it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.86it/s]100%|██████████| 25/25 [00:04<00:00,  5.53it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.90it/s]  8%|▊         | 2/25 [00:00<00:04,  5.72it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.12it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.32it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.98it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.60it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.45it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.33it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.12it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.08it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.04it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.98it/s] 60%|██████    | 15/25 [00:02<00:02,  4.93it/s] 64%|██████▍   | 16/25 [00:03<00:01,  4.89it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.92it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.95it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.97it/s] 80%|████████  | 20/25 [00:03<00:00,  5.00it/s] 84%|████████▍ | 21/25 [00:04<00:00,  4.96it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.30it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.65it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.44it/s]100%|██████████| 25/25 [00:04<00:00,  5.43it/s]
Run 00 | Epoch 00107 | Loss 0.3977 | Train 0.7064 | Val 0.6984 | Test 0.5580
Number of nodes during this epoch:  4637351
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424328804016113  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1190550327301025
range selection method range initialization spend 0.024991273880004883
time for parepare:  0.4011080265045166
local_output_nid generation:  0.02728271484375
local_in_edges_tensor generation:  0.21537017822265625
mini_batch_src_global generation:  0.3717219829559326
r_  generation:  5.474167346954346
local_output_nid generation:  0.02902531623840332
local_in_edges_tensor generation:  0.2165830135345459
mini_batch_src_global generation:  0.49658632278442383
r_  generation:  5.76758074760437
----------------------check_connections_block total spend ----------------------------- 14.645859718322754
generate_one_block  7.319469451904297
generate_one_block  7.010212659835815
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.179448843002319
gen group dst list time:  0.09670591354370117
time for parepare:  0.4631383419036865
local_output_nid generation:  0.27261900901794434
local_in_edges_tensor generation:  1.6684553623199463
mini_batch_src_global generation:  2.498396396636963
r_  generation:  29.927204608917236
local_output_nid generation:  0.5395371913909912
local_in_edges_tensor generation:  2.303030252456665
mini_batch_src_global generation:  3.7349600791931152
r_  generation:  30.039602994918823
----------------------check_connections_block total spend ----------------------------- 83.40061855316162
generate_one_block  41.105852365493774
generate_one_block  40.86123824119568
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3659138679504395
gen group dst list time:  0.18138456344604492
time for parepare:  0.4919247627258301
local_output_nid generation:  0.4023916721343994
local_in_edges_tensor generation:  1.5418238639831543
mini_batch_src_global generation:  2.034486770629883
r_  generation:  26.461288452148438
local_output_nid generation:  0.7314112186431885
local_in_edges_tensor generation:  2.06109881401062
mini_batch_src_global generation:  2.8129873275756836
r_  generation:  26.42989158630371
----------------------check_connections_block total spend ----------------------------- 73.7839035987854
generate_one_block  35.256569623947144
generate_one_block  36.11478877067566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424328804016113  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.18452215194702
block generation total time  153.33844900131226
average batch blocks generation time:  76.66922450065613
block dataloader generation time/epoch 367.5897388590707
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38808560371398926 |1.415433645248413 |0.004392266273498535 |0.00015282630920410156 |0.005215644836425781 |0.0016999244689941406 |
----------------------------------------------------------pseudo_mini_loss sum 0.3967127203941345
Total (block generation + training)time/epoch 371.4346177622124
Training time/epoch 4.045860290527344
Training time without block to device /epoch 1.2149930000305176
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.94it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.57it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.30it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.86it/s] 40%|████      | 10/25 [00:00<00:00, 17.31it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.50it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.00it/s] 64%|██████▍   | 16/25 [00:01<00:00, 14.89it/s] 72%|███████▏  | 18/25 [00:01<00:00, 14.96it/s] 80%|████████  | 20/25 [00:01<00:00, 15.66it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.17it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.62it/s]100%|██████████| 25/25 [00:01<00:00, 16.34it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.44it/s]  8%|▊         | 2/25 [00:00<00:03,  6.61it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.63it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.59it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.59it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.59it/s] 40%|████      | 10/25 [00:01<00:02,  6.55it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.58it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.61it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.63it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.63it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.54it/s] 80%|████████  | 20/25 [00:03<00:00,  6.53it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.54it/s]100%|██████████| 25/25 [00:03<00:00,  6.68it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.47it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.48it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.51it/s] 20%|██        | 5/25 [00:00<00:03,  6.53it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.52it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.45it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.45it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.50it/s] 60%|██████    | 15/25 [00:02<00:01,  6.51it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.50it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.52it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.53it/s]100%|██████████| 25/25 [00:03<00:00,  6.60it/s]
Run 00 | Epoch 00108 | Loss 0.3967 | Train 0.7064 | Val 0.6981 | Test 0.5581
Number of nodes during this epoch:  4637453
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427749156951904  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1365289688110352
range selection method range initialization spend 0.02432870864868164
time for parepare:  0.35202670097351074
local_output_nid generation:  0.02596116065979004
local_in_edges_tensor generation:  0.18851542472839355
mini_batch_src_global generation:  0.3659989833831787
r_  generation:  5.2896082401275635
local_output_nid generation:  0.027315616607666016
local_in_edges_tensor generation:  0.20859789848327637
mini_batch_src_global generation:  0.4680750370025635
r_  generation:  5.568515300750732
----------------------check_connections_block total spend ----------------------------- 14.154260873794556
generate_one_block  7.191643238067627
generate_one_block  6.906365156173706
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0393805503845215
gen group dst list time:  0.08827638626098633
time for parepare:  0.4636058807373047
local_output_nid generation:  0.25458407402038574
local_in_edges_tensor generation:  1.7201292514801025
mini_batch_src_global generation:  2.516832113265991
r_  generation:  29.754793405532837
local_output_nid generation:  0.5254881381988525
local_in_edges_tensor generation:  2.161783218383789
mini_batch_src_global generation:  3.7478933334350586
r_  generation:  29.82219386100769
----------------------check_connections_block total spend ----------------------------- 82.84344911575317
generate_one_block  40.90021896362305
generate_one_block  40.591602087020874
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.492086172103882
gen group dst list time:  0.18802261352539062
time for parepare:  0.4757091999053955
local_output_nid generation:  0.40751028060913086
local_in_edges_tensor generation:  1.5569071769714355
mini_batch_src_global generation:  2.1199347972869873
r_  generation:  26.535805702209473
local_output_nid generation:  0.7231194972991943
local_in_edges_tensor generation:  1.945268154144287
mini_batch_src_global generation:  2.831418752670288
r_  generation:  26.30400323867798
----------------------check_connections_block total spend ----------------------------- 73.39820528030396
generate_one_block  35.318695306777954
generate_one_block  36.608635902404785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427749156951904  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.24165439605713
block generation total time  153.41915225982666
average batch blocks generation time:  76.70957612991333
block dataloader generation time/epoch 367.5934991902168
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3764995336532593 |1.4044761657714844 |0.004847884178161621 |0.000171661376953125 |0.005151271820068359 |0.0038945674896240234 |
----------------------------------------------------------pseudo_mini_loss sum 0.39635998010635376
Total (block generation + training)time/epoch 371.4397756506544
Training time/epoch 3.997042179107666
Training time without block to device /epoch 1.1880898475646973
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.17it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.70it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.87it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.30it/s] 40%|████      | 10/25 [00:00<00:00, 17.42it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.70it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.47it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.48it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.55it/s] 80%|████████  | 20/25 [00:01<00:00, 17.25it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.32it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.26it/s]100%|██████████| 25/25 [00:01<00:00, 17.45it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.99it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.04it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.94it/s] 20%|██        | 5/25 [00:00<00:03,  6.16it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.32it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.43it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.55it/s] 40%|████      | 10/25 [00:01<00:02,  6.58it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.60it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.59it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.56it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.57it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.52it/s] 80%|████████  | 20/25 [00:03<00:00,  6.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.54it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.54it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.58it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.40it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.52it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.54it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.55it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.54it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.54it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.09it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.09it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.22it/s] 80%|████████  | 20/25 [00:03<00:00,  6.31it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.32it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]
Run 00 | Epoch 00109 | Loss 0.3964 | Train 0.7060 | Val 0.6979 | Test 0.5581
Number of nodes during this epoch:  4637841
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426880836486816  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1344883441925049
range selection method range initialization spend 0.02771472930908203
time for parepare:  0.3780076503753662
local_output_nid generation:  0.02642369270324707
local_in_edges_tensor generation:  0.21132516860961914
mini_batch_src_global generation:  0.41929030418395996
r_  generation:  5.5616466999053955
local_output_nid generation:  0.028888940811157227
local_in_edges_tensor generation:  0.2459561824798584
mini_batch_src_global generation:  0.46222543716430664
r_  generation:  5.769961357116699
----------------------check_connections_block total spend ----------------------------- 14.861384153366089
generate_one_block  7.2040770053863525
generate_one_block  6.9418785572052
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.869211435317993
gen group dst list time:  0.10024023056030273
time for parepare:  0.4584946632385254
local_output_nid generation:  0.2702634334564209
local_in_edges_tensor generation:  1.6227636337280273
mini_batch_src_global generation:  2.518916368484497
r_  generation:  30.04369306564331
local_output_nid generation:  0.5278797149658203
local_in_edges_tensor generation:  2.2524755001068115
mini_batch_src_global generation:  3.7649009227752686
r_  generation:  30.421471118927002
----------------------check_connections_block total spend ----------------------------- 83.6343686580658
generate_one_block  41.37692594528198
generate_one_block  41.50767803192139
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.155949115753174
gen group dst list time:  0.18440604209899902
time for parepare:  0.4329710006713867
local_output_nid generation:  0.40294647216796875
local_in_edges_tensor generation:  1.5090203285217285
mini_batch_src_global generation:  2.199955701828003
r_  generation:  26.30136513710022
local_output_nid generation:  0.7263164520263672
local_in_edges_tensor generation:  2.1415228843688965
mini_batch_src_global generation:  2.8203961849212646
r_  generation:  27.0754656791687
----------------------check_connections_block total spend ----------------------------- 73.79500794410706
generate_one_block  35.3717098236084
generate_one_block  36.06794214248657
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426880836486816  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.42937660217285
block generation total time  154.32425594329834
average batch blocks generation time:  77.16212797164917
block dataloader generation time/epoch 367.62292700464076
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38421642780303955 |1.3135876655578613 |0.004502415657043457 |0.00015497207641601562 |0.004995942115783691 |0.0014393329620361328 |
----------------------------------------------------------pseudo_mini_loss sum 0.39454343914985657
Total (block generation + training)time/epoch 371.469011239572
Training time/epoch 3.824934482574463
Training time without block to device /epoch 1.1977591514587402
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.79it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.51it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.32it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.65it/s] 40%|████      | 10/25 [00:00<00:01, 14.06it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.29it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.78it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.29it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.81it/s] 80%|████████  | 20/25 [00:01<00:00, 16.90it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.19it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.92it/s]100%|██████████| 25/25 [00:01<00:00, 16.68it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.55it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.61it/s] 20%|██        | 5/25 [00:00<00:03,  6.09it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.76it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.55it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.42it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.34it/s] 40%|████      | 10/25 [00:01<00:02,  5.26it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.18it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.17it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.17it/s] 60%|██████    | 15/25 [00:02<00:02,  4.92it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.21it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.50it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.74it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.95it/s] 80%|████████  | 20/25 [00:03<00:00,  6.08it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.68it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.65it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.78it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.94it/s]100%|██████████| 25/25 [00:04<00:00,  5.74it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.33it/s]  8%|▊         | 2/25 [00:00<00:03,  6.27it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.33it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.35it/s] 20%|██        | 5/25 [00:00<00:03,  6.33it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.82it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.69it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.78it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.95it/s] 40%|████      | 10/25 [00:01<00:02,  6.09it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.16it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.26it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.49it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.40it/s]
Run 00 | Epoch 00110 | Loss 0.3945 | Train 0.7059 | Val 0.6979 | Test 0.5579
Number of nodes during this epoch:  4637747
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427084445953369  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1335155963897705
range selection method range initialization spend 0.025204896926879883
time for parepare:  0.3617074489593506
local_output_nid generation:  0.026325464248657227
local_in_edges_tensor generation:  0.20336699485778809
mini_batch_src_global generation:  0.3700530529022217
r_  generation:  5.4020750522613525
local_output_nid generation:  0.029436588287353516
local_in_edges_tensor generation:  0.21223735809326172
mini_batch_src_global generation:  0.4672698974609375
r_  generation:  5.676746606826782
----------------------check_connections_block total spend ----------------------------- 14.380101442337036
generate_one_block  7.242453098297119
generate_one_block  6.774114608764648
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.122943639755249
gen group dst list time:  0.08416962623596191
time for parepare:  0.4571197032928467
local_output_nid generation:  0.2537879943847656
local_in_edges_tensor generation:  1.7510035037994385
mini_batch_src_global generation:  2.5226337909698486
r_  generation:  31.21261978149414
local_output_nid generation:  0.5524101257324219
local_in_edges_tensor generation:  2.395212173461914
mini_batch_src_global generation:  3.830690860748291
r_  generation:  30.403570652008057
----------------------check_connections_block total spend ----------------------------- 85.40355968475342
generate_one_block  41.20310091972351
generate_one_block  40.822601318359375
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3505711555480957
gen group dst list time:  0.20037031173706055
time for parepare:  0.4521596431732178
local_output_nid generation:  0.4043080806732178
local_in_edges_tensor generation:  1.5178658962249756
mini_batch_src_global generation:  2.007108688354492
r_  generation:  26.098605632781982
local_output_nid generation:  0.7166180610656738
local_in_edges_tensor generation:  1.9109923839569092
mini_batch_src_global generation:  2.8377718925476074
r_  generation:  25.66727900505066
----------------------check_connections_block total spend ----------------------------- 71.53837847709656
generate_one_block  34.95025897026062
generate_one_block  35.91345977783203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427084445953369  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.94193816184998
block generation total time  152.88942098617554
average batch blocks generation time:  76.44471049308777
block dataloader generation time/epoch 367.62807772610637
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39042866230010986 |1.3114126920700073 |0.004337191581726074 |0.0001506805419921875 |0.005117654800415039 |0.0029075145721435547 |
----------------------------------------------------------pseudo_mini_loss sum 0.3936258852481842
Total (block generation + training)time/epoch 371.47402824367487
Training time/epoch 3.831064224243164
Training time without block to device /epoch 1.2082388401031494
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.94it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.49it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.41it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.46it/s] 40%|████      | 10/25 [00:00<00:00, 17.75it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.87it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.90it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.02it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.86it/s] 80%|████████  | 20/25 [00:01<00:00, 17.91it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.95it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.89it/s]100%|██████████| 25/25 [00:01<00:00, 17.95it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.31it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.50it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.52it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.43it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.23it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.19it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.24it/s] 40%|████      | 10/25 [00:01<00:02,  6.30it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.05it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.75it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.80it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.92it/s] 60%|██████    | 15/25 [00:02<00:01,  6.06it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.20it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.31it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.37it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.36it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.47it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.07it/s]100%|██████████| 25/25 [00:03<00:00,  6.85it/s]100%|██████████| 25/25 [00:03<00:00,  6.32it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.16it/s]  8%|▊         | 2/25 [00:00<00:03,  6.30it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.34it/s] 20%|██        | 5/25 [00:00<00:03,  6.29it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.33it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.35it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.93it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.83it/s] 40%|████      | 10/25 [00:01<00:02,  5.95it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.08it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.21it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.28it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.34it/s] 60%|██████    | 15/25 [00:02<00:01,  6.37it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.27it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.28it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.23it/s] 80%|████████  | 20/25 [00:03<00:00,  6.23it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.19it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.28it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.34it/s]100%|██████████| 25/25 [00:03<00:00,  6.33it/s]
Run 00 | Epoch 00111 | Loss 0.3936 | Train 0.7057 | Val 0.6977 | Test 0.5572
Number of nodes during this epoch:  4637669
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4263081550598145  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1441586017608643
range selection method range initialization spend 0.03484821319580078
time for parepare:  0.39283323287963867
local_output_nid generation:  0.026086091995239258
local_in_edges_tensor generation:  0.19116806983947754
mini_batch_src_global generation:  0.37810707092285156
r_  generation:  5.5409746170043945
local_output_nid generation:  0.029070615768432617
local_in_edges_tensor generation:  0.23421263694763184
mini_batch_src_global generation:  0.4880521297454834
r_  generation:  5.898426532745361
----------------------check_connections_block total spend ----------------------------- 14.83675217628479
generate_one_block  7.296878814697266
generate_one_block  7.107960224151611
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.051374673843384
gen group dst list time:  0.09268569946289062
time for parepare:  0.4730069637298584
local_output_nid generation:  0.2657895088195801
local_in_edges_tensor generation:  1.7144198417663574
mini_batch_src_global generation:  2.5166149139404297
r_  generation:  29.82308053970337
local_output_nid generation:  0.5578334331512451
local_in_edges_tensor generation:  2.3372550010681152
mini_batch_src_global generation:  3.7225348949432373
r_  generation:  29.82443070411682
----------------------check_connections_block total spend ----------------------------- 83.26360368728638
generate_one_block  40.69709873199463
generate_one_block  41.21172618865967
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2478954792022705
gen group dst list time:  0.1889934539794922
time for parepare:  0.4503440856933594
local_output_nid generation:  0.3939216136932373
local_in_edges_tensor generation:  1.466418743133545
mini_batch_src_global generation:  2.039372682571411
r_  generation:  25.782208919525146
local_output_nid generation:  0.7262208461761475
local_in_edges_tensor generation:  1.9224445819854736
mini_batch_src_global generation:  3.015942096710205
r_  generation:  26.017505645751953
----------------------check_connections_block total spend ----------------------------- 72.09343838691711
generate_one_block  35.40248250961304
generate_one_block  36.033347606658936
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4263081550598145  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.3570420742035
block generation total time  153.34465503692627
average batch blocks generation time:  76.67232751846313
block dataloader generation time/epoch 367.6376764518874
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3765730857849121 |1.356997013092041 |0.00435638427734375 |0.00015234947204589844 |0.0050601959228515625 |0.002866983413696289 |
----------------------------------------------------------pseudo_mini_loss sum 0.39096540212631226
Total (block generation + training)time/epoch 371.48408909567763
Training time/epoch 3.8975329399108887
Training time without block to device /epoch 1.1835389137268066
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.05it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.41it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.46it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.98it/s] 40%|████      | 10/25 [00:00<00:00, 17.32it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.46it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.45it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.61it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.83it/s] 80%|████████  | 20/25 [00:01<00:00, 17.51it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.53it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.79it/s]100%|██████████| 25/25 [00:01<00:00, 17.65it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.13it/s]  8%|▊         | 2/25 [00:00<00:04,  4.65it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.24it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.68it/s] 20%|██        | 5/25 [00:00<00:03,  5.98it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.24it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.43it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.66it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.92it/s] 40%|████      | 10/25 [00:01<00:02,  6.12it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.28it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.57it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.59it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.60it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.62it/s] 80%|████████  | 20/25 [00:03<00:00,  6.61it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.59it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.60it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.58it/s]100%|██████████| 25/25 [00:03<00:00,  6.30it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.48it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.40it/s] 20%|██        | 5/25 [00:00<00:03,  5.91it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.76it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.87it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.03it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.18it/s] 40%|████      | 10/25 [00:01<00:02,  6.20it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.29it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.36it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.05it/s] 60%|██████    | 15/25 [00:02<00:01,  5.63it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.39it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.26it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.18it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.17it/s] 80%|████████  | 20/25 [00:03<00:00,  5.12it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.08it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.01it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.31it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.61it/s]100%|██████████| 25/25 [00:04<00:00,  5.81it/s]
Run 00 | Epoch 00112 | Loss 0.3910 | Train 0.7060 | Val 0.6979 | Test 0.5568
Number of nodes during this epoch:  4637847
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4274210929870605  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1320393085479736
range selection method range initialization spend 0.024837732315063477
time for parepare:  0.3729250431060791
local_output_nid generation:  0.02606821060180664
local_in_edges_tensor generation:  0.194230318069458
mini_batch_src_global generation:  0.3730151653289795
r_  generation:  5.677691698074341
local_output_nid generation:  0.029241323471069336
local_in_edges_tensor generation:  0.2334272861480713
mini_batch_src_global generation:  0.4677143096923828
r_  generation:  5.927535772323608
----------------------check_connections_block total spend ----------------------------- 14.986589193344116
generate_one_block  7.1922667026519775
generate_one_block  6.940505504608154
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.030735492706299
gen group dst list time:  0.09520483016967773
time for parepare:  0.4981846809387207
local_output_nid generation:  0.2628898620605469
local_in_edges_tensor generation:  1.6924636363983154
mini_batch_src_global generation:  2.502579689025879
r_  generation:  29.89140009880066
local_output_nid generation:  0.5154461860656738
local_in_edges_tensor generation:  2.1042935848236084
mini_batch_src_global generation:  3.766765832901001
r_  generation:  29.884232759475708
----------------------check_connections_block total spend ----------------------------- 82.98296785354614
generate_one_block  41.08342146873474
generate_one_block  40.981266021728516
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.164658308029175
gen group dst list time:  0.1829519271850586
time for parepare:  0.44469523429870605
local_output_nid generation:  0.37972140312194824
local_in_edges_tensor generation:  1.5455782413482666
mini_batch_src_global generation:  2.119685173034668
r_  generation:  26.303635358810425
local_output_nid generation:  0.7312376499176025
local_in_edges_tensor generation:  1.9159045219421387
mini_batch_src_global generation:  2.82252836227417
r_  generation:  26.26710534095764
----------------------check_connections_block total spend ----------------------------- 72.70891761779785
generate_one_block  35.27595019340515
generate_one_block  35.97158741950989
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4274210929870605  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.691885471344
block generation total time  153.3122251033783
average batch blocks generation time:  76.65611255168915
block dataloader generation time/epoch 367.63772797162557
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37175869941711426 |1.2980222702026367 |0.0043718814849853516 |0.00015652179718017578 |0.005132555961608887 |0.0029976367950439453 |
----------------------------------------------------------pseudo_mini_loss sum 0.3915165662765503
Total (block generation + training)time/epoch 371.48348477878403
Training time/epoch 3.77213454246521
Training time without block to device /epoch 1.1760900020599365
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.92it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.60it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.84it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.17it/s] 40%|████      | 10/25 [00:00<00:00, 17.59it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.86it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.03it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.00it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.08it/s] 80%|████████  | 20/25 [00:01<00:00, 18.08it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.13it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.08it/s]100%|██████████| 25/25 [00:01<00:00, 17.97it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.53it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.57it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.59it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.60it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.62it/s] 40%|████      | 10/25 [00:01<00:02,  6.63it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.63it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.14it/s] 60%|██████    | 15/25 [00:02<00:01,  5.83it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.35it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.27it/s] 80%|████████  | 20/25 [00:03<00:00,  5.04it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.76it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.73it/s]100%|██████████| 25/25 [00:04<00:00,  6.16it/s]100%|██████████| 25/25 [00:04<00:00,  6.02it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.34it/s]  8%|▊         | 2/25 [00:00<00:04,  5.27it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.21it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.18it/s] 20%|██        | 5/25 [00:00<00:03,  5.52it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.78it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.97it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.12it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.19it/s] 40%|████      | 10/25 [00:01<00:02,  6.23it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.30it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.36it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.31it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.82it/s] 60%|██████    | 15/25 [00:02<00:01,  5.98it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.12it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.72it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.59it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.71it/s] 80%|████████  | 20/25 [00:03<00:00,  5.81it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.97it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.03it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.09it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.11it/s]100%|██████████| 25/25 [00:04<00:00,  6.02it/s]
Run 00 | Epoch 00113 | Loss 0.3915 | Train 0.7065 | Val 0.6987 | Test 0.5568
Number of nodes during this epoch:  4638029
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426000595092773  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1373765468597412
range selection method range initialization spend 0.025564908981323242
time for parepare:  0.3604471683502197
local_output_nid generation:  0.02654743194580078
local_in_edges_tensor generation:  0.2316725254058838
mini_batch_src_global generation:  0.37577104568481445
r_  generation:  5.3947954177856445
local_output_nid generation:  0.02734088897705078
local_in_edges_tensor generation:  0.22786188125610352
mini_batch_src_global generation:  0.5509397983551025
r_  generation:  6.597933769226074
----------------------check_connections_block total spend ----------------------------- 15.676576852798462
generate_one_block  7.37826681137085
generate_one_block  7.188594341278076
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.972771406173706
gen group dst list time:  0.08507657051086426
time for parepare:  0.43184900283813477
local_output_nid generation:  0.236297607421875
local_in_edges_tensor generation:  1.5211119651794434
mini_batch_src_global generation:  2.4142730236053467
r_  generation:  28.857150316238403
local_output_nid generation:  0.4796278476715088
local_in_edges_tensor generation:  2.0245518684387207
mini_batch_src_global generation:  3.5057318210601807
r_  generation:  29.930866956710815
----------------------check_connections_block total spend ----------------------------- 80.79052090644836
generate_one_block  41.14476203918457
generate_one_block  41.12598752975464
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.063584804534912
gen group dst list time:  0.18923616409301758
time for parepare:  0.4592599868774414
local_output_nid generation:  0.3902122974395752
local_in_edges_tensor generation:  1.5145177841186523
mini_batch_src_global generation:  2.1103954315185547
r_  generation:  26.261186599731445
local_output_nid generation:  0.7571232318878174
local_in_edges_tensor generation:  2.0691771507263184
mini_batch_src_global generation:  2.8838119506835938
r_  generation:  26.20115089416504
----------------------check_connections_block total spend ----------------------------- 72.60927629470825
generate_one_block  35.35696315765381
generate_one_block  36.18651819229126
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426000595092773  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.39979720115662
block generation total time  153.81423091888428
average batch blocks generation time:  76.90711545944214
block dataloader generation time/epoch 367.6334248132873
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4115549325942993 |1.3055691719055176 |0.004520773887634277 |0.0001558065414428711 |0.005058169364929199 |0.0014286041259765625 |
----------------------------------------------------------pseudo_mini_loss sum 0.3891245126724243
Total (block generation + training)time/epoch 371.47936096107753
Training time/epoch 3.8660120964050293
Training time without block to device /epoch 1.2548737525939941
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.92it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.61it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.29it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.58it/s] 40%|████      | 10/25 [00:00<00:00, 17.83it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.98it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.06it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.17it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.17it/s] 80%|████████  | 20/25 [00:01<00:00, 18.17it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.22it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.26it/s]100%|██████████| 25/25 [00:01<00:00, 18.16it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.46it/s]  8%|▊         | 2/25 [00:00<00:03,  6.43it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.43it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.44it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.43it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.46it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.47it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.48it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.50it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.49it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.48it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.46it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.21it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.42it/s] 20%|██        | 5/25 [00:00<00:03,  6.37it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.42it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.36it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.39it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.39it/s] 60%|██████    | 15/25 [00:02<00:01,  6.23it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.29it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.34it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.21it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.27it/s] 80%|████████  | 20/25 [00:03<00:00,  6.25it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.95it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.02it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.88it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.02it/s]100%|██████████| 25/25 [00:03<00:00,  6.81it/s]100%|██████████| 25/25 [00:03<00:00,  6.34it/s]
Run 00 | Epoch 00114 | Loss 0.3891 | Train 0.7070 | Val 0.6993 | Test 0.5571
Number of nodes during this epoch:  4637569
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.431041240692139  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0783865451812744
range selection method range initialization spend 0.024172544479370117
time for parepare:  0.3529236316680908
local_output_nid generation:  0.026425838470458984
local_in_edges_tensor generation:  0.19542455673217773
mini_batch_src_global generation:  0.369657039642334
r_  generation:  5.394779920578003
local_output_nid generation:  0.027184247970581055
local_in_edges_tensor generation:  0.19261884689331055
mini_batch_src_global generation:  0.4681253433227539
r_  generation:  5.604530334472656
----------------------check_connections_block total spend ----------------------------- 14.248072147369385
generate_one_block  7.172912120819092
generate_one_block  6.885056972503662
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9005424976348877
gen group dst list time:  0.08546853065490723
time for parepare:  0.4225730895996094
local_output_nid generation:  0.2589578628540039
local_in_edges_tensor generation:  1.7127888202667236
mini_batch_src_global generation:  2.5067508220672607
r_  generation:  30.029971599578857
local_output_nid generation:  0.5329687595367432
local_in_edges_tensor generation:  2.1086859703063965
mini_batch_src_global generation:  3.7504947185516357
r_  generation:  29.99506688117981
----------------------check_connections_block total spend ----------------------------- 83.22699666023254
generate_one_block  41.26828861236572
generate_one_block  40.75769066810608
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.150665044784546
gen group dst list time:  0.18221521377563477
time for parepare:  0.4352753162384033
local_output_nid generation:  0.3907926082611084
local_in_edges_tensor generation:  1.4209048748016357
mini_batch_src_global generation:  2.035172462463379
r_  generation:  25.66824221611023
local_output_nid generation:  0.7289361953735352
local_in_edges_tensor generation:  1.9003403186798096
mini_batch_src_global generation:  3.000619649887085
r_  generation:  25.90788173675537
----------------------check_connections_block total spend ----------------------------- 71.36420488357544
generate_one_block  35.19951033592224
generate_one_block  35.83708620071411
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.431041240692139  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.59120154380798
block generation total time  153.06257581710815
average batch blocks generation time:  76.53128790855408
block dataloader generation time/epoch 367.609243672827
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38332223892211914 |1.2833983898162842 |0.004390716552734375 |0.00015044212341308594 |0.005105137825012207 |0.002984285354614258 |
----------------------------------------------------------pseudo_mini_loss sum 0.3887052536010742
Total (block generation + training)time/epoch 371.4544844917629
Training time/epoch 3.765808343887329
Training time without block to device /epoch 1.1990115642547607
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.35it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.95it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.17it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.65it/s] 40%|████      | 10/25 [00:00<00:01, 14.16it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.29it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.17it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.42it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.98it/s] 80%|████████  | 20/25 [00:01<00:00, 17.35it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.57it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.75it/s]100%|██████████| 25/25 [00:01<00:00, 17.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.55it/s]  8%|▊         | 2/25 [00:00<00:03,  6.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.92it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.61it/s] 20%|██        | 5/25 [00:00<00:03,  5.44it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.35it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.30it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.27it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.21it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.19it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.18it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.16it/s] 60%|██████    | 15/25 [00:02<00:01,  5.14it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.12it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.92it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.71it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.88it/s] 80%|████████  | 20/25 [00:03<00:01,  4.84it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.19it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.51it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.34it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.24it/s]100%|██████████| 25/25 [00:04<00:00,  6.06it/s]100%|██████████| 25/25 [00:04<00:00,  5.34it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.64it/s]  8%|▊         | 2/25 [00:00<00:04,  5.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.87it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.92it/s] 20%|██        | 5/25 [00:00<00:03,  5.74it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.78it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.94it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.12it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.28it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.45it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.91it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.04it/s] 60%|██████    | 15/25 [00:02<00:01,  6.19it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.28it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.53it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.43it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.30it/s]
Run 00 | Epoch 00115 | Loss 0.3887 | Train 0.7070 | Val 0.6997 | Test 0.5576
Number of nodes during this epoch:  4637408
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424682140350342  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1070945262908936
range selection method range initialization spend 0.023845911026000977
time for parepare:  0.3798394203186035
local_output_nid generation:  0.026524066925048828
local_in_edges_tensor generation:  0.2160494327545166
mini_batch_src_global generation:  0.3706791400909424
r_  generation:  5.61366605758667
local_output_nid generation:  0.029126882553100586
local_in_edges_tensor generation:  0.23643231391906738
mini_batch_src_global generation:  0.46508216857910156
r_  generation:  5.89534068107605
----------------------check_connections_block total spend ----------------------------- 14.900598049163818
generate_one_block  7.199781179428101
generate_one_block  6.910195350646973
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.01776123046875
gen group dst list time:  0.08418822288513184
time for parepare:  0.46900248527526855
local_output_nid generation:  0.26418209075927734
local_in_edges_tensor generation:  1.6367299556732178
mini_batch_src_global generation:  2.623117446899414
r_  generation:  29.62590789794922
local_output_nid generation:  0.5387921333312988
local_in_edges_tensor generation:  2.214219570159912
mini_batch_src_global generation:  3.732792854309082
r_  generation:  29.61569333076477
----------------------check_connections_block total spend ----------------------------- 82.69534063339233
generate_one_block  40.483651876449585
generate_one_block  40.4192898273468
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1699020862579346
gen group dst list time:  0.1800403594970703
time for parepare:  0.5034136772155762
local_output_nid generation:  0.4086475372314453
local_in_edges_tensor generation:  1.5923566818237305
mini_batch_src_global generation:  2.027235984802246
r_  generation:  26.15343928337097
local_output_nid generation:  0.7576088905334473
local_in_edges_tensor generation:  2.09413743019104
mini_batch_src_global generation:  2.8612449169158936
r_  generation:  26.08715581893921
----------------------check_connections_block total spend ----------------------------- 72.45577430725098
generate_one_block  35.29665422439575
generate_one_block  36.155166149139404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424682140350342  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.1511149406433
block generation total time  152.35476207733154
average batch blocks generation time:  76.17738103866577
block dataloader generation time/epoch 367.59461685295764
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.395182728767395 |1.3216649293899536 |0.004422307014465332 |0.00016033649444580078 |0.005106091499328613 |0.003046751022338867 |
----------------------------------------------------------pseudo_mini_loss sum 0.3882119655609131
Total (block generation + training)time/epoch 371.44001936090405
Training time/epoch 3.8638291358947754
Training time without block to device /epoch 1.2204992771148682
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.90it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.44it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.20it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.61it/s] 40%|████      | 10/25 [00:00<00:00, 17.88it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.07it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.03it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.15it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.24it/s] 80%|████████  | 20/25 [00:01<00:00, 18.30it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.27it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.30it/s]100%|██████████| 25/25 [00:01<00:00, 18.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.11it/s]  8%|▊         | 2/25 [00:00<00:04,  5.12it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.14it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.12it/s] 20%|██        | 5/25 [00:00<00:03,  5.12it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.13it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.15it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.18it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.18it/s] 40%|████      | 10/25 [00:01<00:02,  5.13it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.15it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.15it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.14it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.13it/s] 60%|██████    | 15/25 [00:02<00:01,  5.10it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.10it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.08it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.09it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.32it/s] 80%|████████  | 20/25 [00:03<00:00,  5.63it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.85it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.02it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.66it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.49it/s]100%|██████████| 25/25 [00:04<00:00,  6.10it/s]100%|██████████| 25/25 [00:04<00:00,  5.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.87it/s]  8%|▊         | 2/25 [00:00<00:04,  5.60it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.96it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.85it/s] 20%|██        | 5/25 [00:00<00:03,  5.18it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.50it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.74it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.96it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.06it/s] 40%|████      | 10/25 [00:01<00:02,  5.85it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.05it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.17it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.11it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.23it/s] 60%|██████    | 15/25 [00:02<00:01,  6.28it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.30it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.30it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.36it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.13it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.11it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.19it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.01it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.05it/s]100%|██████████| 25/25 [00:04<00:00,  6.85it/s]100%|██████████| 25/25 [00:04<00:00,  6.10it/s]
Run 00 | Epoch 00116 | Loss 0.3882 | Train 0.7074 | Val 0.7002 | Test 0.5580
Number of nodes during this epoch:  4637757
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4288177490234375  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1602451801300049
range selection method range initialization spend 0.03499650955200195
time for parepare:  0.3733842372894287
local_output_nid generation:  0.026463747024536133
local_in_edges_tensor generation:  0.24881553649902344
mini_batch_src_global generation:  0.3741590976715088
r_  generation:  5.659773349761963
local_output_nid generation:  0.028983116149902344
local_in_edges_tensor generation:  0.23254799842834473
mini_batch_src_global generation:  0.47606682777404785
r_  generation:  5.904027223587036
----------------------check_connections_block total spend ----------------------------- 15.031348466873169
generate_one_block  7.2321696281433105
generate_one_block  6.993658542633057
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0909788608551025
gen group dst list time:  0.09301614761352539
time for parepare:  0.45961713790893555
local_output_nid generation:  0.2721567153930664
local_in_edges_tensor generation:  1.6756665706634521
mini_batch_src_global generation:  2.4830331802368164
r_  generation:  29.679810762405396
local_output_nid generation:  0.5414235591888428
local_in_edges_tensor generation:  2.0753660202026367
mini_batch_src_global generation:  3.48508882522583
r_  generation:  30.18388605117798
----------------------check_connections_block total spend ----------------------------- 82.99308228492737
generate_one_block  41.142946004867554
generate_one_block  41.20579695701599
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2489027976989746
gen group dst list time:  0.18619823455810547
time for parepare:  0.4747273921966553
local_output_nid generation:  0.4127085208892822
local_in_edges_tensor generation:  1.580918788909912
mini_batch_src_global generation:  2.038613796234131
r_  generation:  26.302815198898315
local_output_nid generation:  0.727470874786377
local_in_edges_tensor generation:  2.0755136013031006
mini_batch_src_global generation:  2.8279566764831543
r_  generation:  26.032583475112915
----------------------check_connections_block total spend ----------------------------- 72.41215181350708
generate_one_block  35.18271541595459
generate_one_block  35.91213345527649
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4288177490234375  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.40523409843445
block generation total time  153.44359183311462
average batch blocks generation time:  76.72179591655731
block dataloader generation time/epoch 367.5966587107406
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3783324956893921 |1.2914717197418213 |0.004432082176208496 |0.00014722347259521484 |0.005251288414001465 |0.003034353256225586 |
----------------------------------------------------------pseudo_mini_loss sum 0.3875058591365814
Total (block generation + training)time/epoch 371.44142153528
Training time/epoch 3.770387887954712
Training time without block to device /epoch 1.1874444484710693
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.98it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.71it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.16it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.60it/s] 40%|████      | 10/25 [00:00<00:00, 17.84it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.02it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.14it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.06it/s] 80%|████████  | 20/25 [00:01<00:00, 17.71it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.79it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.83it/s]100%|██████████| 25/25 [00:01<00:00, 17.92it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.02it/s]  8%|▊         | 2/25 [00:00<00:04,  5.08it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.12it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.12it/s] 20%|██        | 5/25 [00:00<00:03,  5.46it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.57it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.90it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.99it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.13it/s] 40%|████      | 10/25 [00:01<00:02,  5.93it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.72it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.76it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.90it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.03it/s] 60%|██████    | 15/25 [00:02<00:01,  6.14it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.26it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.87it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.79it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.40it/s] 80%|████████  | 20/25 [00:03<00:00,  5.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.23it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.17it/s]100%|██████████| 25/25 [00:04<00:00,  5.99it/s]100%|██████████| 25/25 [00:04<00:00,  5.66it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.01it/s]  8%|▊         | 2/25 [00:00<00:03,  6.22it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.18it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.19it/s] 20%|██        | 5/25 [00:00<00:03,  6.21it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.26it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.29it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.37it/s] 40%|████      | 10/25 [00:01<00:02,  6.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.31it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.25it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.27it/s] 60%|██████    | 15/25 [00:02<00:01,  6.29it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.32it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.36it/s] 80%|████████  | 20/25 [00:03<00:00,  6.31it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.31it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
Run 00 | Epoch 00117 | Loss 0.3875 | Train 0.7077 | Val 0.7002 | Test 0.5581
Number of nodes during this epoch:  4637314
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422549724578857  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1530096530914307
range selection method range initialization spend 0.026267051696777344
time for parepare:  0.3647277355194092
local_output_nid generation:  0.02626347541809082
local_in_edges_tensor generation:  0.18843293190002441
mini_batch_src_global generation:  0.36693882942199707
r_  generation:  5.3440611362457275
local_output_nid generation:  0.027405500411987305
local_in_edges_tensor generation:  0.21384668350219727
mini_batch_src_global generation:  0.4622802734375
r_  generation:  5.658001184463501
----------------------check_connections_block total spend ----------------------------- 14.292365312576294
generate_one_block  7.11741042137146
generate_one_block  6.730064392089844
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0599682331085205
gen group dst list time:  0.08486056327819824
time for parepare:  0.4453287124633789
local_output_nid generation:  0.24222111701965332
local_in_edges_tensor generation:  1.6458141803741455
mini_batch_src_global generation:  2.486464262008667
r_  generation:  30.01320242881775
local_output_nid generation:  0.5228080749511719
local_in_edges_tensor generation:  2.0671470165252686
mini_batch_src_global generation:  4.018121719360352
r_  generation:  31.30842924118042
----------------------check_connections_block total spend ----------------------------- 84.88015651702881
generate_one_block  41.241918325424194
generate_one_block  41.21314287185669
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.314385175704956
gen group dst list time:  0.20395946502685547
time for parepare:  0.4860239028930664
local_output_nid generation:  0.4153602123260498
local_in_edges_tensor generation:  1.5403921604156494
mini_batch_src_global generation:  2.0111563205718994
r_  generation:  26.155075550079346
local_output_nid generation:  0.728447675704956
local_in_edges_tensor generation:  1.9022598266601562
mini_batch_src_global generation:  2.8227689266204834
r_  generation:  26.200932502746582
----------------------check_connections_block total spend ----------------------------- 72.5045714378357
generate_one_block  35.13661456108093
generate_one_block  35.890475034713745
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422549724578857  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.3847279548645
block generation total time  153.48215079307556
average batch blocks generation time:  76.74107539653778
block dataloader generation time/epoch 367.61886062056334
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3675999641418457 |1.2974575757980347 |0.004346013069152832 |0.00015676021575927734 |0.005036711692810059 |0.002902984619140625 |
----------------------------------------------------------pseudo_mini_loss sum 0.3855973482131958
Total (block generation + training)time/epoch 371.4629663814933
Training time/epoch 3.7670631408691406
Training time without block to device /epoch 1.1721479892730713
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.34it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.80it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.46it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.82it/s] 40%|████      | 10/25 [00:00<00:00, 18.04it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.04it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.02it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.09it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.99it/s] 80%|████████  | 20/25 [00:01<00:00, 17.96it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.94it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.91it/s]100%|██████████| 25/25 [00:01<00:00, 18.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.99it/s]  8%|▊         | 2/25 [00:00<00:04,  5.08it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.11it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.11it/s] 20%|██        | 5/25 [00:00<00:03,  5.11it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.13it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.13it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.13it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.13it/s] 40%|████      | 10/25 [00:01<00:02,  5.11it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.11it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.06it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.08it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.07it/s] 60%|██████    | 15/25 [00:02<00:01,  5.03it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.39it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.74it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.04it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.21it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.49it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.58it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.66it/s]100%|██████████| 25/25 [00:04<00:00,  5.71it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.42it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.99it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.29it/s] 20%|██        | 5/25 [00:00<00:03,  5.23it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.38it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.76it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.06it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.27it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.86it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.53it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.40it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.30it/s] 60%|██████    | 15/25 [00:02<00:01,  5.01it/s] 64%|██████▍   | 16/25 [00:02<00:01,  4.79it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.08it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.40it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.67it/s] 80%|████████  | 20/25 [00:03<00:00,  5.93it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.15it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.44it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.48it/s]100%|██████████| 25/25 [00:04<00:00,  5.88it/s]
Run 00 | Epoch 00118 | Loss 0.3856 | Train 0.7077 | Val 0.7002 | Test 0.5580
Number of nodes during this epoch:  4637863
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425777912139893  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1165437698364258
range selection method range initialization spend 0.02377915382385254
time for parepare:  0.3882019519805908
local_output_nid generation:  0.02618265151977539
local_in_edges_tensor generation:  0.2158656120300293
mini_batch_src_global generation:  0.3680605888366699
r_  generation:  5.367387533187866
local_output_nid generation:  0.02739882469177246
local_in_edges_tensor generation:  0.21228909492492676
mini_batch_src_global generation:  0.46150827407836914
r_  generation:  5.625919818878174
----------------------check_connections_block total spend ----------------------------- 14.337191104888916
generate_one_block  7.196277141571045
generate_one_block  6.741442680358887
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.92464542388916
gen group dst list time:  0.08346104621887207
time for parepare:  0.44560837745666504
local_output_nid generation:  0.2565312385559082
local_in_edges_tensor generation:  1.6730718612670898
mini_batch_src_global generation:  2.5054633617401123
r_  generation:  29.747148990631104
local_output_nid generation:  0.5245919227600098
local_in_edges_tensor generation:  2.2672877311706543
mini_batch_src_global generation:  4.084113597869873
r_  generation:  30.45212197303772
----------------------check_connections_block total spend ----------------------------- 83.78178334236145
generate_one_block  41.12236928939819
generate_one_block  41.08480358123779
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2887940406799316
gen group dst list time:  0.18986821174621582
time for parepare:  0.4292762279510498
local_output_nid generation:  0.3829326629638672
local_in_edges_tensor generation:  1.4457945823669434
mini_batch_src_global generation:  2.0049941539764404
r_  generation:  25.491835594177246
local_output_nid generation:  0.7314486503601074
local_in_edges_tensor generation:  1.9346370697021484
mini_batch_src_global generation:  2.7431468963623047
r_  generation:  26.1721453666687
----------------------check_connections_block total spend ----------------------------- 71.38995718955994
generate_one_block  34.89103031158447
generate_one_block  35.839518308639526
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425777912139893  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.1717405319214
block generation total time  152.93772149085999
average batch blocks generation time:  76.46886074542999
block dataloader generation time/epoch 367.6074352584967
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37858808040618896 |1.4027204513549805 |0.004327535629272461 |0.00014793872833251953 |0.005056977272033691 |0.0029973983764648438 |
----------------------------------------------------------pseudo_mini_loss sum 0.3847828209400177
Total (block generation + training)time/epoch 371.4527747651108
Training time/epoch 3.9907524585723877
Training time without block to device /epoch 1.1853115558624268
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.87it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.56it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.77it/s] 40%|████      | 10/25 [00:00<00:00, 17.94it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.16it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.30it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.38it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.25it/s] 80%|████████  | 20/25 [00:01<00:00, 18.12it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.15it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.22it/s]100%|██████████| 25/25 [00:01<00:00, 18.24it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.67it/s]  8%|▊         | 2/25 [00:00<00:03,  6.75it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.44it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.54it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.64it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.86it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.41it/s] 40%|████      | 10/25 [00:01<00:02,  5.70it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.97it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.70it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.46it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.36it/s] 60%|██████    | 15/25 [00:02<00:01,  5.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.23it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.11it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.42it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.74it/s] 80%|████████  | 20/25 [00:03<00:00,  5.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.29it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.25it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.24it/s]100%|██████████| 25/25 [00:04<00:00,  5.78it/s]100%|██████████| 25/25 [00:04<00:00,  5.62it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.89it/s]  8%|▊         | 2/25 [00:00<00:03,  6.26it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.78it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.50it/s] 20%|██        | 5/25 [00:00<00:03,  5.31it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.68it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.94it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.67it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.50it/s] 40%|████      | 10/25 [00:01<00:02,  5.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.29it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.13it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.08it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.00it/s] 60%|██████    | 15/25 [00:02<00:02,  4.95it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.30it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.66it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.95it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.14it/s] 80%|████████  | 20/25 [00:03<00:00,  6.25it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.83it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.56it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.83it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.07it/s]100%|██████████| 25/25 [00:04<00:00,  5.73it/s]
Run 00 | Epoch 00119 | Loss 0.3848 | Train 0.7079 | Val 0.7003 | Test 0.5578
Number of nodes during this epoch:  4637562
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424663066864014  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.141357183456421
range selection method range initialization spend 0.024295806884765625
time for parepare:  0.3641190528869629
local_output_nid generation:  0.030483484268188477
local_in_edges_tensor generation:  0.21558594703674316
mini_batch_src_global generation:  0.36771512031555176
r_  generation:  5.4287285804748535
local_output_nid generation:  0.02787947654724121
local_in_edges_tensor generation:  0.19613218307495117
mini_batch_src_global generation:  0.455946683883667
r_  generation:  5.582404613494873
----------------------check_connections_block total spend ----------------------------- 14.31481647491455
generate_one_block  7.284015655517578
generate_one_block  6.888828277587891
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.1107354164123535
gen group dst list time:  0.08599257469177246
time for parepare:  0.4467289447784424
local_output_nid generation:  0.26364946365356445
local_in_edges_tensor generation:  1.771481990814209
mini_batch_src_global generation:  2.5134198665618896
r_  generation:  29.93837594985962
local_output_nid generation:  0.5320525169372559
local_in_edges_tensor generation:  2.1493663787841797
mini_batch_src_global generation:  3.510693311691284
r_  generation:  30.134636640548706
----------------------check_connections_block total spend ----------------------------- 83.20187091827393
generate_one_block  41.06013607978821
generate_one_block  41.110275983810425
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2569026947021484
gen group dst list time:  0.1901249885559082
time for parepare:  0.4857039451599121
local_output_nid generation:  0.3907444477081299
local_in_edges_tensor generation:  1.6264541149139404
mini_batch_src_global generation:  2.0547139644622803
r_  generation:  26.318567991256714
local_output_nid generation:  0.7138392925262451
local_in_edges_tensor generation:  1.993802547454834
mini_batch_src_global generation:  2.8215620517730713
r_  generation:  26.09450340270996
----------------------check_connections_block total spend ----------------------------- 72.52289366722107
generate_one_block  35.04673743247986
generate_one_block  35.79446482658386
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424663066864014  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.724764585495
block generation total time  153.01161432266235
average batch blocks generation time:  76.50580716133118
block dataloader generation time/epoch 367.6100379427274
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3835855722427368 |1.3112659454345703 |0.004401206970214844 |0.00014603137969970703 |0.005103349685668945 |0.0030117034912109375 |
----------------------------------------------------------pseudo_mini_loss sum 0.38489484786987305
Total (block generation + training)time/epoch 371.45514646172523
Training time/epoch 3.8174490928649902
Training time without block to device /epoch 1.1949172019958496
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.01it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.39it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.94it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.47it/s] 40%|████      | 10/25 [00:00<00:01, 13.84it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.12it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.08it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.73it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.20it/s] 80%|████████  | 20/25 [00:01<00:00, 17.52it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.67it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.82it/s]100%|██████████| 25/25 [00:01<00:00, 17.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.60it/s]  8%|▊         | 2/25 [00:00<00:03,  6.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.63it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.67it/s] 20%|██        | 5/25 [00:00<00:03,  6.09it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.75it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.56it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.41it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.27it/s] 40%|████      | 10/25 [00:01<00:02,  5.20it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.15it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.98it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.89it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.23it/s] 60%|██████    | 15/25 [00:02<00:01,  5.30it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.28it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.86it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.24it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.54it/s] 80%|████████  | 20/25 [00:03<00:00,  5.82it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.09it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.74it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.88it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.11it/s]100%|██████████| 25/25 [00:04<00:00,  5.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.62it/s]  8%|▊         | 2/25 [00:00<00:04,  4.92it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.57it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.92it/s] 20%|██        | 5/25 [00:00<00:03,  6.15it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.24it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.24it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.21it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.93it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.73it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.82it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.00it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.13it/s] 60%|██████    | 15/25 [00:02<00:01,  6.20it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.20it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.28it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.28it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.31it/s] 80%|████████  | 20/25 [00:03<00:00,  6.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:04<00:00,  6.23it/s]
Run 00 | Epoch 00120 | Loss 0.3849 | Train 0.7077 | Val 0.7005 | Test 0.5575
Number of nodes during this epoch:  4637729
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423191070556641  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.2016243934631348
range selection method range initialization spend 0.02404308319091797
time for parepare:  0.40651917457580566
local_output_nid generation:  0.027143239974975586
local_in_edges_tensor generation:  0.20114946365356445
mini_batch_src_global generation:  0.37559986114501953
r_  generation:  5.435331344604492
local_output_nid generation:  0.02893233299255371
local_in_edges_tensor generation:  0.21502065658569336
mini_batch_src_global generation:  0.48673319816589355
r_  generation:  5.729049921035767
----------------------check_connections_block total spend ----------------------------- 14.579958438873291
generate_one_block  7.237139463424683
generate_one_block  7.101599931716919
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.129327297210693
gen group dst list time:  0.09577488899230957
time for parepare:  0.46150660514831543
local_output_nid generation:  0.26542234420776367
local_in_edges_tensor generation:  1.6865694522857666
mini_batch_src_global generation:  2.4634275436401367
r_  generation:  29.73496651649475
local_output_nid generation:  0.5171463489532471
local_in_edges_tensor generation:  2.0834367275238037
mini_batch_src_global generation:  3.4807639122009277
r_  generation:  30.07652187347412
----------------------check_connections_block total spend ----------------------------- 82.55905342102051
generate_one_block  40.8192241191864
generate_one_block  40.987215518951416
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.256070852279663
gen group dst list time:  0.1867520809173584
time for parepare:  0.4906625747680664
local_output_nid generation:  0.42661118507385254
local_in_edges_tensor generation:  1.5847012996673584
mini_batch_src_global generation:  2.06013560295105
r_  generation:  26.341086387634277
local_output_nid generation:  0.7224955558776855
local_in_edges_tensor generation:  1.9981472492218018
mini_batch_src_global generation:  2.8388240337371826
r_  generation:  26.286887884140015
----------------------check_connections_block total spend ----------------------------- 72.72348308563232
generate_one_block  35.30725407600403
generate_one_block  36.02982568740845
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423191070556641  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.28253650665283
block generation total time  153.1435194015503
average batch blocks generation time:  76.57175970077515
block dataloader generation time/epoch 367.61843943004766
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38543713092803955 |1.2993947267532349 |0.004461169242858887 |0.00015366077423095703 |0.005126953125 |0.0016036033630371094 |
----------------------------------------------------------pseudo_mini_loss sum 0.3845229744911194
Total (block generation + training)time/epoch 371.46319141269714
Training time/epoch 3.8018009662628174
Training time without block to device /epoch 1.2030115127563477
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.17it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.01it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.43it/s] 40%|████      | 10/25 [00:00<00:00, 17.70it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.86it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.93it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.98it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.92it/s] 80%|████████  | 20/25 [00:01<00:00, 17.86it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.91it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.47it/s]100%|██████████| 25/25 [00:01<00:00, 17.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.49it/s]  8%|▊         | 2/25 [00:00<00:03,  6.57it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.59it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.63it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.50it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.53it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.58it/s] 40%|████      | 10/25 [00:01<00:02,  6.43it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.93it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.37it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.36it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.55it/s] 60%|██████    | 15/25 [00:02<00:01,  5.77it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.98it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.09it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.22it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.29it/s] 80%|████████  | 20/25 [00:03<00:00,  6.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.88it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.64it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.30it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.26it/s]100%|██████████| 25/25 [00:04<00:00,  6.03it/s]100%|██████████| 25/25 [00:04<00:00,  6.02it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.39it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.41it/s] 20%|██        | 5/25 [00:00<00:03,  6.00it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.76it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.84it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.97it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.62it/s] 40%|████      | 10/25 [00:01<00:02,  5.78it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.95it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.04it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.11it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.20it/s] 60%|██████    | 15/25 [00:02<00:01,  6.23it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.30it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.53it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.32it/s]
Run 00 | Epoch 00121 | Loss 0.3845 | Train 0.7077 | Val 0.7003 | Test 0.5575
Number of nodes during this epoch:  4637487
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425389289855957  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1966283321380615
range selection method range initialization spend 0.039571523666381836
time for parepare:  0.40143847465515137
local_output_nid generation:  0.026964187622070312
local_in_edges_tensor generation:  0.18556571006774902
mini_batch_src_global generation:  0.3659839630126953
r_  generation:  5.658725738525391
local_output_nid generation:  0.02832794189453125
local_in_edges_tensor generation:  0.23464512825012207
mini_batch_src_global generation:  0.4678940773010254
r_  generation:  5.9225075244903564
----------------------check_connections_block total spend ----------------------------- 14.9722740650177
generate_one_block  7.234415292739868
generate_one_block  6.887556552886963
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.009972333908081
gen group dst list time:  0.09269547462463379
time for parepare:  0.4673786163330078
local_output_nid generation:  0.25036096572875977
local_in_edges_tensor generation:  1.649291753768921
mini_batch_src_global generation:  2.642329692840576
r_  generation:  29.855486631393433
local_output_nid generation:  0.5312089920043945
local_in_edges_tensor generation:  2.345426321029663
mini_batch_src_global generation:  3.77569842338562
r_  generation:  30.117626905441284
----------------------check_connections_block total spend ----------------------------- 83.57056784629822
generate_one_block  41.25792694091797
generate_one_block  40.86796426773071
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.309931516647339
gen group dst list time:  0.20241975784301758
time for parepare:  0.497234582901001
local_output_nid generation:  0.405651330947876
local_in_edges_tensor generation:  1.5551371574401855
mini_batch_src_global generation:  2.0295400619506836
r_  generation:  26.07072353363037
local_output_nid generation:  0.7650036811828613
local_in_edges_tensor generation:  2.1584317684173584
mini_batch_src_global generation:  2.9028680324554443
r_  generation:  26.127676486968994
----------------------check_connections_block total spend ----------------------------- 72.41492176055908
generate_one_block  35.374380111694336
generate_one_block  36.08388710021973
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425389289855957  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.9854896068573
block generation total time  153.58415842056274
average batch blocks generation time:  76.79207921028137
block dataloader generation time/epoch 367.6259523258835
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4069298505783081 |1.3313792943954468 |0.004453182220458984 |0.00015079975128173828 |0.005153179168701172 |0.0028727054595947266 |
----------------------------------------------------------pseudo_mini_loss sum 0.3830347955226898
Total (block generation + training)time/epoch 371.4712021761253
Training time/epoch 3.90531849861145
Training time without block to device /epoch 1.2425599098205566
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.85it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.35it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.05it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.36it/s] 40%|████      | 10/25 [00:00<00:00, 17.75it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.90it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.11it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.23it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.32it/s] 80%|████████  | 20/25 [00:01<00:00, 18.40it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.43it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.41it/s]100%|██████████| 25/25 [00:01<00:00, 18.19it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.16it/s]  8%|▊         | 2/25 [00:00<00:03,  6.27it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.22it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.32it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.46it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.53it/s]100%|██████████| 25/25 [00:03<00:00,  6.54it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.26it/s]  8%|▊         | 2/25 [00:00<00:03,  6.33it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.45it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.42it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.40it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.39it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.41it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  6.42it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]
Run 00 | Epoch 00122 | Loss 0.3830 | Train 0.7076 | Val 0.7002 | Test 0.5578
Number of nodes during this epoch:  4638401
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427583694458008  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.189384937286377
range selection method range initialization spend 0.02889871597290039
time for parepare:  0.3888669013977051
local_output_nid generation:  0.02606940269470215
local_in_edges_tensor generation:  0.2178211212158203
mini_batch_src_global generation:  0.40602922439575195
r_  generation:  5.702280282974243
local_output_nid generation:  0.028926610946655273
local_in_edges_tensor generation:  0.22406601905822754
mini_batch_src_global generation:  0.4588143825531006
r_  generation:  5.948690176010132
----------------------check_connections_block total spend ----------------------------- 15.128000259399414
generate_one_block  7.267192602157593
generate_one_block  6.9326560497283936
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9854702949523926
gen group dst list time:  0.08745598793029785
time for parepare:  0.4409830570220947
local_output_nid generation:  0.24859142303466797
local_in_edges_tensor generation:  1.5644829273223877
mini_batch_src_global generation:  2.4331374168395996
r_  generation:  29.169891357421875
local_output_nid generation:  0.514319896697998
local_in_edges_tensor generation:  2.016414165496826
mini_batch_src_global generation:  3.3669772148132324
r_  generation:  30.088663816452026
----------------------check_connections_block total spend ----------------------------- 81.5990641117096
generate_one_block  41.141340494155884
generate_one_block  41.17246675491333
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.343761920928955
gen group dst list time:  0.19724559783935547
time for parepare:  0.5090031623840332
local_output_nid generation:  0.40012598037719727
local_in_edges_tensor generation:  1.5596578121185303
mini_batch_src_global generation:  2.015110969543457
r_  generation:  26.135496377944946
local_output_nid generation:  0.7310993671417236
local_in_edges_tensor generation:  2.0588009357452393
mini_batch_src_global generation:  2.8269894123077393
r_  generation:  26.215301752090454
----------------------check_connections_block total spend ----------------------------- 72.62571859359741
generate_one_block  35.221904039382935
generate_one_block  35.83874773979187
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427583694458008  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.224782705307
block generation total time  153.37445902824402
average batch blocks generation time:  76.68722951412201
block dataloader generation time/epoch 367.6197560570104
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3782162666320801 |1.2964451313018799 |0.004420161247253418 |0.00015044212341308594 |0.005083680152893066 |0.0030345916748046875 |
----------------------------------------------------------pseudo_mini_loss sum 0.38254690170288086
Total (block generation + training)time/epoch 371.46446719014546
Training time/epoch 3.778815269470215
Training time without block to device /epoch 1.185925006866455
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.89it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.39it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.70it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.11it/s] 40%|████      | 10/25 [00:00<00:00, 17.57it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.78it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.94it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.02it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.92it/s] 80%|████████  | 20/25 [00:01<00:00, 17.79it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.72it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.78it/s]100%|██████████| 25/25 [00:01<00:00, 17.75it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.09it/s]  8%|▊         | 2/25 [00:00<00:04,  5.09it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.11it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.14it/s] 20%|██        | 5/25 [00:00<00:03,  5.15it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.15it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.15it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.13it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.98it/s] 40%|████      | 10/25 [00:01<00:03,  4.84it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.00it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.25it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.52it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.66it/s] 60%|██████    | 15/25 [00:02<00:01,  5.75it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.87it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.01it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.10it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.16it/s] 80%|████████  | 20/25 [00:03<00:00,  5.86it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.96it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.13it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.26it/s]100%|██████████| 25/25 [00:04<00:00,  5.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.25it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.38it/s] 40%|████      | 10/25 [00:01<00:02,  6.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.33it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.38it/s] 60%|██████    | 15/25 [00:02<00:01,  6.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.31it/s] 80%|████████  | 20/25 [00:03<00:00,  6.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.37it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
Run 00 | Epoch 00123 | Loss 0.3825 | Train 0.7072 | Val 0.6998 | Test 0.5579
Number of nodes during this epoch:  4637550
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424234867095947  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.2023024559020996
range selection method range initialization spend 0.025249004364013672
time for parepare:  0.38889265060424805
local_output_nid generation:  0.026373863220214844
local_in_edges_tensor generation:  0.16873955726623535
mini_batch_src_global generation:  0.37274932861328125
r_  generation:  5.7045042514801025
local_output_nid generation:  0.02898263931274414
local_in_edges_tensor generation:  0.23516321182250977
mini_batch_src_global generation:  0.4792606830596924
r_  generation:  5.915049314498901
----------------------check_connections_block total spend ----------------------------- 15.062778949737549
generate_one_block  7.224450349807739
generate_one_block  6.931614875793457
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.054799556732178
gen group dst list time:  0.09337043762207031
time for parepare:  0.44798707962036133
local_output_nid generation:  0.26464080810546875
local_in_edges_tensor generation:  1.7317593097686768
mini_batch_src_global generation:  2.5042970180511475
r_  generation:  30.167200565338135
local_output_nid generation:  0.5398423671722412
local_in_edges_tensor generation:  2.1468074321746826
mini_batch_src_global generation:  3.806917667388916
r_  generation:  29.991376876831055
----------------------check_connections_block total spend ----------------------------- 83.4850401878357
generate_one_block  41.36053681373596
generate_one_block  40.94850277900696
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3743953704833984
gen group dst list time:  0.18471384048461914
time for parepare:  0.48837947845458984
local_output_nid generation:  0.4289829730987549
local_in_edges_tensor generation:  1.5591859817504883
mini_batch_src_global generation:  2.0453803539276123
r_  generation:  26.442378282546997
local_output_nid generation:  0.7322890758514404
local_in_edges_tensor generation:  1.9229710102081299
mini_batch_src_global generation:  2.845529556274414
r_  generation:  25.930293560028076
----------------------check_connections_block total spend ----------------------------- 72.94611310958862
generate_one_block  35.26115012168884
generate_one_block  36.08908724784851
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424234867095947  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.43115329742432
block generation total time  153.65927696228027
average batch blocks generation time:  76.82963848114014
block dataloader generation time/epoch 367.6347454171027
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3767669200897217 |1.3235182762145996 |0.004839897155761719 |0.00017118453979492188 |0.0051860809326171875 |0.002027750015258789 |
----------------------------------------------------------pseudo_mini_loss sum 0.3822711110115051
Total (block generation + training)time/epoch 371.4793221469848
Training time/epoch 3.8278725147247314
Training time without block to device /epoch 1.1808359622955322
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.98it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.58it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.35it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.63it/s] 40%|████      | 10/25 [00:00<00:00, 17.76it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.23it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.58it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.29it/s] 80%|████████  | 20/25 [00:01<00:00, 17.57it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.79it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.87it/s]100%|██████████| 25/25 [00:01<00:00, 17.67it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.13it/s]  8%|▊         | 2/25 [00:00<00:03,  6.47it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.67it/s] 20%|██        | 5/25 [00:00<00:02,  6.72it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.75it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.75it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.77it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.76it/s] 40%|████      | 10/25 [00:01<00:02,  6.76it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.79it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.71it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.75it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.78it/s] 60%|██████    | 15/25 [00:02<00:01,  6.79it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.81it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.81it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.83it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.29it/s] 80%|████████  | 20/25 [00:03<00:00,  5.92it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.59it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.60it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:03<00:00,  6.40it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.08it/s]  8%|▊         | 2/25 [00:00<00:03,  5.94it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.15it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.27it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.37it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.41it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  5.91it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.42it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.67it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.90it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.09it/s] 60%|██████    | 15/25 [00:02<00:01,  6.22it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.99it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.99it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.79it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.75it/s] 80%|████████  | 20/25 [00:03<00:00,  5.89it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.98it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.05it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.16it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.25it/s]100%|██████████| 25/25 [00:04<00:00,  6.16it/s]
Run 00 | Epoch 00124 | Loss 0.3823 | Train 0.7070 | Val 0.6995 | Test 0.5575
Number of nodes during this epoch:  4637145
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426141738891602  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1587271690368652
range selection method range initialization spend 0.02428126335144043
time for parepare:  0.35181140899658203
local_output_nid generation:  0.02588963508605957
local_in_edges_tensor generation:  0.1918654441833496
mini_batch_src_global generation:  0.3697056770324707
r_  generation:  5.27299165725708
local_output_nid generation:  0.027846813201904297
local_in_edges_tensor generation:  0.19404387474060059
mini_batch_src_global generation:  0.45536279678344727
r_  generation:  5.580115795135498
----------------------check_connections_block total spend ----------------------------- 14.081422567367554
generate_one_block  7.1471991539001465
generate_one_block  6.850439786911011
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9639344215393066
gen group dst list time:  0.09798479080200195
time for parepare:  0.4792647361755371
local_output_nid generation:  0.2705357074737549
local_in_edges_tensor generation:  1.7453269958496094
mini_batch_src_global generation:  2.5115132331848145
r_  generation:  29.78958487510681
local_output_nid generation:  0.5234203338623047
local_in_edges_tensor generation:  2.1617658138275146
mini_batch_src_global generation:  3.4972176551818848
r_  generation:  30.487866163253784
----------------------check_connections_block total spend ----------------------------- 83.40801191329956
generate_one_block  40.962212324142456
generate_one_block  41.09844756126404
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.181480884552002
gen group dst list time:  0.2012162208557129
time for parepare:  0.45524096488952637
local_output_nid generation:  0.4099576473236084
local_in_edges_tensor generation:  1.521735668182373
mini_batch_src_global generation:  2.1772406101226807
r_  generation:  26.092232942581177
local_output_nid generation:  0.7186629772186279
local_in_edges_tensor generation:  1.893770456314087
mini_batch_src_global generation:  2.813166856765747
r_  generation:  25.86030387878418
----------------------check_connections_block total spend ----------------------------- 71.8447892665863
generate_one_block  34.93126440048218
generate_one_block  35.711655616760254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426141738891602  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.25280117988586
block generation total time  152.70357990264893
average batch blocks generation time:  76.35178995132446
block dataloader generation time/epoch 367.61707966804505
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37625062465667725 |1.278169870376587 |0.0044242143630981445 |0.00015282630920410156 |0.005041241645812988 |0.0029222965240478516 |
----------------------------------------------------------pseudo_mini_loss sum 0.38161206245422363
Total (block generation + training)time/epoch 371.4608199901581
Training time/epoch 3.739837884902954
Training time without block to device /epoch 1.1834981441497803
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.45it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.63it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.23it/s] 40%|████      | 10/25 [00:00<00:01, 13.92it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.20it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.14it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.84it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.23it/s] 80%|████████  | 20/25 [00:01<00:00, 17.55it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.74it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.82it/s]100%|██████████| 25/25 [00:01<00:00, 16.93it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.00it/s]  8%|▊         | 2/25 [00:00<00:04,  5.06it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.09it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.13it/s] 20%|██        | 5/25 [00:00<00:03,  5.12it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.14it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.11it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.10it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.07it/s] 40%|████      | 10/25 [00:01<00:02,  5.07it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.08it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.06it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.08it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.06it/s] 60%|██████    | 15/25 [00:02<00:01,  5.05it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.06it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.07it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.07it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.84it/s] 80%|████████  | 20/25 [00:03<00:00,  5.15it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.46it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.75it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.23it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.42it/s]100%|██████████| 25/25 [00:04<00:00,  5.27it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.87it/s]  8%|▊         | 2/25 [00:00<00:03,  6.40it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.63it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.32it/s] 20%|██        | 5/25 [00:00<00:03,  5.11it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.00it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.89it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.30it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.49it/s] 40%|████      | 10/25 [00:01<00:02,  5.14it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.61it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.36it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.62it/s] 60%|██████    | 15/25 [00:02<00:01,  5.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.32it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.21it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.14it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.08it/s] 80%|████████  | 20/25 [00:03<00:00,  5.04it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.24it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.60it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.88it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.10it/s]100%|██████████| 25/25 [00:04<00:00,  5.55it/s]
Run 00 | Epoch 00125 | Loss 0.3816 | Train 0.7070 | Val 0.6993 | Test 0.5569
Number of nodes during this epoch:  4637938
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430008888244629  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1206669807434082
range selection method range initialization spend 0.03661012649536133
time for parepare:  0.36364054679870605
local_output_nid generation:  0.026288747787475586
local_in_edges_tensor generation:  0.1655123233795166
mini_batch_src_global generation:  0.3629286289215088
r_  generation:  5.640784740447998
local_output_nid generation:  0.028966188430786133
local_in_edges_tensor generation:  0.23584818840026855
mini_batch_src_global generation:  0.4739043712615967
r_  generation:  5.906609058380127
----------------------check_connections_block total spend ----------------------------- 14.851573705673218
generate_one_block  7.3850672245025635
generate_one_block  7.3653295040130615
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.1796228885650635
gen group dst list time:  0.0978093147277832
time for parepare:  0.4692549705505371
local_output_nid generation:  0.2669553756713867
local_in_edges_tensor generation:  1.897864580154419
mini_batch_src_global generation:  2.425276517868042
r_  generation:  29.818341493606567
local_output_nid generation:  0.5236914157867432
local_in_edges_tensor generation:  2.1785802841186523
mini_batch_src_global generation:  3.4929590225219727
r_  generation:  30.156517505645752
----------------------check_connections_block total spend ----------------------------- 83.32831025123596
generate_one_block  41.20412087440491
generate_one_block  41.18521285057068
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2675702571868896
gen group dst list time:  0.19051265716552734
time for parepare:  0.4857649803161621
local_output_nid generation:  0.4073333740234375
local_in_edges_tensor generation:  1.6899638175964355
mini_batch_src_global generation:  2.0581367015838623
r_  generation:  26.188255786895752
local_output_nid generation:  0.7342791557312012
local_in_edges_tensor generation:  2.040548801422119
mini_batch_src_global generation:  2.807908773422241
r_  generation:  26.100436210632324
----------------------check_connections_block total spend ----------------------------- 72.36142063140869
generate_one_block  35.39652919769287
generate_one_block  36.14953541755676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430008888244629  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.68973088264465
block generation total time  153.93539834022522
average batch blocks generation time:  76.96769917011261
block dataloader generation time/epoch 367.6356806641533
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39491939544677734 |1.3182495832443237 |0.004444241523742676 |0.00015461444854736328 |0.005104541778564453 |0.0016362667083740234 |
----------------------------------------------------------pseudo_mini_loss sum 0.3788418471813202
Total (block generation + training)time/epoch 371.4795311367701
Training time/epoch 3.857450485229492
Training time without block to device /epoch 1.2209513187408447
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.94it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.53it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.18it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.89it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.10it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.11it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.18it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.25it/s] 80%|████████  | 20/25 [00:01<00:00, 18.29it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.26it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.25it/s]100%|██████████| 25/25 [00:01<00:00, 18.19it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.36it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.45it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.47it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.45it/s] 40%|████      | 10/25 [00:01<00:02,  6.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.44it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.46it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.45it/s] 60%|██████    | 15/25 [00:02<00:01,  6.46it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.44it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.45it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.48it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.46it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.21it/s]  8%|▊         | 2/25 [00:00<00:03,  6.38it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.37it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.42it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.23it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.30it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.34it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.27it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.30it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.27it/s] 60%|██████    | 15/25 [00:02<00:01,  6.09it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.20it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.01it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.13it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.21it/s] 80%|████████  | 20/25 [00:03<00:00,  6.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.31it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.35it/s]100%|██████████| 25/25 [00:03<00:00,  6.39it/s]
Run 00 | Epoch 00126 | Loss 0.3788 | Train 0.7073 | Val 0.6999 | Test 0.5569
Number of nodes during this epoch:  4637524
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424455642700195  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1237924098968506
range selection method range initialization spend 0.024623632431030273
time for parepare:  0.34537529945373535
local_output_nid generation:  0.025981426239013672
local_in_edges_tensor generation:  0.19469904899597168
mini_batch_src_global generation:  0.3739891052246094
r_  generation:  5.668477773666382
local_output_nid generation:  0.02891087532043457
local_in_edges_tensor generation:  0.23640942573547363
mini_batch_src_global generation:  0.4693472385406494
r_  generation:  5.8857200145721436
----------------------check_connections_block total spend ----------------------------- 14.927045583724976
generate_one_block  7.368598937988281
generate_one_block  7.214716672897339
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.14613938331604
gen group dst list time:  0.08791065216064453
time for parepare:  0.4517660140991211
local_output_nid generation:  0.26897311210632324
local_in_edges_tensor generation:  1.6724507808685303
mini_batch_src_global generation:  2.483661413192749
r_  generation:  29.805522680282593
local_output_nid generation:  0.5263431072235107
local_in_edges_tensor generation:  2.0958118438720703
mini_batch_src_global generation:  3.480299234390259
r_  generation:  30.280276775360107
----------------------check_connections_block total spend ----------------------------- 83.07504272460938
generate_one_block  40.98060727119446
generate_one_block  41.08736228942871
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.179704189300537
gen group dst list time:  0.1864912509918213
time for parepare:  0.48163533210754395
local_output_nid generation:  0.4055356979370117
local_in_edges_tensor generation:  1.6568706035614014
mini_batch_src_global generation:  2.014662027359009
r_  generation:  26.12422013282776
local_output_nid generation:  0.7346742153167725
local_in_edges_tensor generation:  1.9898533821105957
mini_batch_src_global generation:  2.8157601356506348
r_  generation:  25.93224048614502
----------------------check_connections_block total spend ----------------------------- 72.3022985458374
generate_one_block  35.18601703643799
generate_one_block  35.814945936203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424455642700195  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.37734127044678
block generation total time  153.06893253326416
average batch blocks generation time:  76.53446626663208
block dataloader generation time/epoch 367.6338206726735
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39258503913879395 |1.343873381614685 |0.004828214645385742 |0.0001761913299560547 |0.0051021575927734375 |0.0029087066650390625 |
----------------------------------------------------------pseudo_mini_loss sum 0.378679484128952
Total (block generation + training)time/epoch 371.47813551820167
Training time/epoch 3.9026553630828857
Training time without block to device /epoch 1.2149085998535156
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.22it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.59it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.41it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.09it/s] 40%|████      | 10/25 [00:00<00:00, 17.58it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.60it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.65it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.91it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.81it/s] 80%|████████  | 20/25 [00:01<00:00, 17.87it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.93it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.81it/s]100%|██████████| 25/25 [00:01<00:00, 17.71it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.98it/s]  8%|▊         | 2/25 [00:00<00:03,  5.99it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.96it/s] 20%|██        | 5/25 [00:00<00:03,  6.21it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.38it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.97it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.59it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.85it/s] 40%|████      | 10/25 [00:01<00:02,  6.04it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.14it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.34it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.96it/s] 60%|██████    | 15/25 [00:02<00:01,  6.13it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.31it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.34it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.93it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.02it/s] 80%|████████  | 20/25 [00:03<00:00,  6.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.37it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.54it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.00it/s]100%|██████████| 25/25 [00:04<00:00,  6.45it/s]100%|██████████| 25/25 [00:04<00:00,  6.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.48it/s]  8%|▊         | 2/25 [00:00<00:03,  6.03it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.25it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.02it/s] 20%|██        | 5/25 [00:00<00:03,  6.21it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.34it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.43it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.23it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.34it/s] 40%|████      | 10/25 [00:01<00:02,  6.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.25it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.28it/s] 60%|██████    | 15/25 [00:02<00:01,  6.26it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.31it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.31it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.83it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.99it/s] 80%|████████  | 20/25 [00:03<00:00,  6.13it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.24it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.91it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.88it/s]100%|██████████| 25/25 [00:03<00:00,  6.64it/s]100%|██████████| 25/25 [00:03<00:00,  6.26it/s]
Run 00 | Epoch 00127 | Loss 0.3787 | Train 0.7075 | Val 0.7000 | Test 0.5573
Number of nodes during this epoch:  4637614
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425997257232666  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1621551513671875
range selection method range initialization spend 0.025146007537841797
time for parepare:  0.36006855964660645
local_output_nid generation:  0.025899171829223633
local_in_edges_tensor generation:  0.19093084335327148
mini_batch_src_global generation:  0.37752795219421387
r_  generation:  5.630262136459351
local_output_nid generation:  0.02896285057067871
local_in_edges_tensor generation:  0.23314237594604492
mini_batch_src_global generation:  0.47142505645751953
r_  generation:  5.837889671325684
----------------------check_connections_block total spend ----------------------------- 14.816249370574951
generate_one_block  7.143630504608154
generate_one_block  6.780082702636719
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.991636037826538
gen group dst list time:  0.09036064147949219
time for parepare:  0.44037961959838867
local_output_nid generation:  0.2731935977935791
local_in_edges_tensor generation:  1.6289489269256592
mini_batch_src_global generation:  2.523120880126953
r_  generation:  29.87626338005066
local_output_nid generation:  0.5314984321594238
local_in_edges_tensor generation:  2.298006296157837
mini_batch_src_global generation:  3.7683017253875732
r_  generation:  29.797240495681763
----------------------check_connections_block total spend ----------------------------- 83.13128113746643
generate_one_block  42.11958384513855
generate_one_block  41.081650495529175
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3357110023498535
gen group dst list time:  0.21168279647827148
time for parepare:  0.513404369354248
local_output_nid generation:  0.4098834991455078
local_in_edges_tensor generation:  1.5140697956085205
mini_batch_src_global generation:  2.027272939682007
r_  generation:  26.27304768562317
local_output_nid generation:  0.7407059669494629
local_in_edges_tensor generation:  2.034200429916382
mini_batch_src_global generation:  2.8165371417999268
r_  generation:  26.183459281921387
----------------------check_connections_block total spend ----------------------------- 72.89530801773071
generate_one_block  35.45884418487549
generate_one_block  36.121946811676025
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425997257232666  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.02658915519714
block generation total time  154.78202533721924
average batch blocks generation time:  77.39101266860962
block dataloader generation time/epoch 367.6506625395268
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3871121406555176 |1.3245388269424438 |0.004388332366943359 |0.00015807151794433594 |0.005102038383483887 |0.0016248226165771484 |
----------------------------------------------------------pseudo_mini_loss sum 0.3779944181442261
Total (block generation + training)time/epoch 371.49506536498666
Training time/epoch 3.85540509223938
Training time without block to device /epoch 1.2063274383544922
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.94it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.55it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.93it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.29it/s] 40%|████      | 10/25 [00:00<00:00, 16.97it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.37it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.64it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.29it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.55it/s] 80%|████████  | 20/25 [00:01<00:00, 17.77it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.96it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.10it/s]100%|██████████| 25/25 [00:01<00:00, 17.79it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.42it/s]  8%|▊         | 2/25 [00:00<00:03,  6.57it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.53it/s] 20%|██        | 5/25 [00:00<00:03,  6.29it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.42it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.49it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.26it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.03it/s] 40%|████      | 10/25 [00:01<00:02,  6.06it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.93it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.89it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.97it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.08it/s] 60%|██████    | 15/25 [00:02<00:01,  6.22it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.48it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.54it/s] 80%|████████  | 20/25 [00:03<00:00,  6.53it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.54it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.57it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.49it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.25it/s] 20%|██        | 5/25 [00:00<00:03,  5.95it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.78it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.85it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.97it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.06it/s] 40%|████      | 10/25 [00:01<00:02,  6.16it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.28it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.31it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.40it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.55it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.58it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.57it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.59it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.60it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00128 | Loss 0.3780 | Train 0.7076 | Val 0.6994 | Test 0.5573
Number of nodes during this epoch:  4637509
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422792434692383  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1273274421691895
range selection method range initialization spend 0.025774478912353516
time for parepare:  0.3959465026855469
local_output_nid generation:  0.0261991024017334
local_in_edges_tensor generation:  0.24350714683532715
mini_batch_src_global generation:  0.38614916801452637
r_  generation:  5.572928190231323
local_output_nid generation:  0.028766632080078125
local_in_edges_tensor generation:  0.24193477630615234
mini_batch_src_global generation:  0.48852109909057617
r_  generation:  6.208265066146851
----------------------check_connections_block total spend ----------------------------- 15.471200942993164
generate_one_block  7.285562992095947
generate_one_block  6.907928228378296
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.088238954544067
gen group dst list time:  0.09488153457641602
time for parepare:  0.4627847671508789
local_output_nid generation:  0.25634241104125977
local_in_edges_tensor generation:  1.620934009552002
mini_batch_src_global generation:  2.613295316696167
r_  generation:  30.025984048843384
local_output_nid generation:  0.5273840427398682
local_in_edges_tensor generation:  2.1033198833465576
mini_batch_src_global generation:  3.6697661876678467
r_  generation:  30.015963554382324
----------------------check_connections_block total spend ----------------------------- 83.45319080352783
generate_one_block  40.93504881858826
generate_one_block  40.872055530548096
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2871832847595215
gen group dst list time:  0.17983460426330566
time for parepare:  0.4616365432739258
local_output_nid generation:  0.3876509666442871
local_in_edges_tensor generation:  1.4953632354736328
mini_batch_src_global generation:  2.0414280891418457
r_  generation:  25.917827129364014
local_output_nid generation:  0.7274401187896729
local_in_edges_tensor generation:  1.940098762512207
mini_batch_src_global generation:  2.944347381591797
r_  generation:  26.87007474899292
----------------------check_connections_block total spend ----------------------------- 73.89948463439941
generate_one_block  35.53393483161926
generate_one_block  36.061437368392944
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422792434692383  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.35267543792725
block generation total time  153.40247654914856
average batch blocks generation time:  76.70123827457428
block dataloader generation time/epoch 367.6794595071512
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.415549635887146 |1.3195315599441528 |0.004838109016418457 |0.0001596212387084961 |0.005241513252258301 |0.0017664432525634766 |
----------------------------------------------------------pseudo_mini_loss sum 0.3778212070465088
Total (block generation + training)time/epoch 371.5243183938108
Training time/epoch 3.903067111968994
Training time without block to device /epoch 1.2640039920806885
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.29it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.23it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.96it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.55it/s] 40%|████      | 10/25 [00:00<00:00, 17.84it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.91it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.05it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.15it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.02it/s] 80%|████████  | 20/25 [00:01<00:00, 18.14it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.03it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.10it/s]100%|██████████| 25/25 [00:01<00:00, 18.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.36it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.45it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.46it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.42it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.41it/s] 80%|████████  | 20/25 [00:03<00:00,  6.42it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.33it/s]  8%|▊         | 2/25 [00:00<00:03,  6.27it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.33it/s] 20%|██        | 5/25 [00:00<00:03,  6.33it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.35it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.34it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.31it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.30it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.32it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.32it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.34it/s] 60%|██████    | 15/25 [00:02<00:01,  6.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.34it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.31it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.33it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.31it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00129 | Loss 0.3778 | Train 0.7075 | Val 0.6995 | Test 0.5570
Number of nodes during this epoch:  4637780
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427970886230469  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1215629577636719
range selection method range initialization spend 0.024698257446289062
time for parepare:  0.37949442863464355
local_output_nid generation:  0.026453733444213867
local_in_edges_tensor generation:  0.21246814727783203
mini_batch_src_global generation:  0.3740875720977783
r_  generation:  5.649538278579712
local_output_nid generation:  0.02904796600341797
local_in_edges_tensor generation:  0.2323300838470459
mini_batch_src_global generation:  0.45893287658691406
r_  generation:  5.8040618896484375
----------------------check_connections_block total spend ----------------------------- 14.855168581008911
generate_one_block  7.167568206787109
generate_one_block  6.858764171600342
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.038883447647095
gen group dst list time:  0.08777403831481934
time for parepare:  0.4459223747253418
local_output_nid generation:  0.25736021995544434
local_in_edges_tensor generation:  1.6428718566894531
mini_batch_src_global generation:  2.5886189937591553
r_  generation:  29.67707633972168
local_output_nid generation:  0.5232462882995605
local_in_edges_tensor generation:  2.2126166820526123
mini_batch_src_global generation:  3.6720659732818604
r_  generation:  29.593170642852783
----------------------check_connections_block total spend ----------------------------- 82.55313682556152
generate_one_block  40.29096174240112
generate_one_block  40.54708671569824
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2261693477630615
gen group dst list time:  0.17937421798706055
time for parepare:  0.4788944721221924
local_output_nid generation:  0.4030601978302002
local_in_edges_tensor generation:  1.7229044437408447
mini_batch_src_global generation:  2.0455098152160645
r_  generation:  25.87998604774475
local_output_nid generation:  0.7248990535736084
local_in_edges_tensor generation:  2.0259127616882324
mini_batch_src_global generation:  2.796074151992798
r_  generation:  25.857691764831543
----------------------check_connections_block total spend ----------------------------- 71.7955060005188
generate_one_block  35.05439114570618
generate_one_block  35.813599824905396
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427970886230469  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.34864282608032
block generation total time  151.70603942871094
average batch blocks generation time:  75.85301971435547
block dataloader generation time/epoch 367.6558197076504
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37642133235931396 |1.286794662475586 |0.004392385482788086 |0.0001474618911743164 |0.004900217056274414 |0.0028395652770996094 |
----------------------------------------------------------pseudo_mini_loss sum 0.37578338384628296
Total (block generation + training)time/epoch 371.5000768074623
Training time/epoch 3.7664589881896973
Training time without block to device /epoch 1.1928696632385254
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.38it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.10it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.68it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.29it/s] 40%|████      | 10/25 [00:00<00:01, 13.27it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.63it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.63it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.27it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.45it/s] 80%|████████  | 20/25 [00:01<00:00, 16.78it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.99it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.19it/s]100%|██████████| 25/25 [00:01<00:00, 16.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.65it/s]  8%|▊         | 2/25 [00:00<00:03,  6.76it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.73it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.98it/s] 20%|██        | 5/25 [00:00<00:03,  6.22it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.30it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.88it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.74it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.99it/s] 40%|████      | 10/25 [00:01<00:02,  6.18it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.83it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.04it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.24it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.39it/s] 60%|██████    | 15/25 [00:02<00:01,  5.99it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.06it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.23it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.34it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.49it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.09it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.14it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.30it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.35it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.52it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.50it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.93it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.08it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.21it/s] 40%|████      | 10/25 [00:01<00:02,  6.28it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.34it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.31it/s] 60%|██████    | 15/25 [00:02<00:01,  6.36it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.01it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.01it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.12it/s] 80%|████████  | 20/25 [00:03<00:00,  6.21it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.30it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.31it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.26it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]
Run 00 | Epoch 00130 | Loss 0.3758 | Train 0.7076 | Val 0.6998 | Test 0.5568
Number of nodes during this epoch:  4637574
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424508571624756  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1055774688720703
range selection method range initialization spend 0.024695158004760742
time for parepare:  0.3644556999206543
local_output_nid generation:  0.02600264549255371
local_in_edges_tensor generation:  0.22633767127990723
mini_batch_src_global generation:  0.3689913749694824
r_  generation:  5.343994617462158
local_output_nid generation:  0.0269925594329834
local_in_edges_tensor generation:  0.22684597969055176
mini_batch_src_global generation:  0.4823126792907715
r_  generation:  5.625676870346069
----------------------check_connections_block total spend ----------------------------- 14.380872011184692
generate_one_block  7.116602897644043
generate_one_block  6.729348182678223
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9097585678100586
gen group dst list time:  0.09153866767883301
time for parepare:  0.4573507308959961
local_output_nid generation:  0.2615687847137451
local_in_edges_tensor generation:  1.6240622997283936
mini_batch_src_global generation:  2.4241552352905273
r_  generation:  30.033632040023804
local_output_nid generation:  0.535771369934082
local_in_edges_tensor generation:  2.097877025604248
mini_batch_src_global generation:  3.492314338684082
r_  generation:  30.139451265335083
----------------------check_connections_block total spend ----------------------------- 83.34942245483398
generate_one_block  40.78978753089905
generate_one_block  40.953611850738525
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2008237838745117
gen group dst list time:  0.1887655258178711
time for parepare:  0.48380112648010254
local_output_nid generation:  0.4494037628173828
local_in_edges_tensor generation:  1.6386003494262695
mini_batch_src_global generation:  2.099921703338623
r_  generation:  26.5986590385437
local_output_nid generation:  0.7464497089385986
local_in_edges_tensor generation:  2.2002615928649902
mini_batch_src_global generation:  2.9101243019104004
r_  generation:  26.936129570007324
----------------------check_connections_block total spend ----------------------------- 74.62572598457336
generate_one_block  36.75842356681824
generate_one_block  37.492053270339966
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424508571624756  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.97514843940735
block generation total time  155.99387621879578
average batch blocks generation time:  77.99693810939789
block dataloader generation time/epoch 367.6907272393467
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3774193525314331 |1.3286019563674927 |0.0048825740814208984 |0.0001806020736694336 |0.00512087345123291 |0.003943443298339844 |
----------------------------------------------------------pseudo_mini_loss sum 0.37619268894195557
Total (block generation + training)time/epoch 371.5349743166043
Training time/epoch 3.8427677154541016
Training time without block to device /epoch 1.1855638027191162
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.04it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.29it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.96it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.00it/s] 40%|████      | 10/25 [00:00<00:00, 17.60it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.60it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.55it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.49it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.51it/s] 80%|████████  | 20/25 [00:01<00:00, 17.50it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.40it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.36it/s]100%|██████████| 25/25 [00:01<00:00, 17.37it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.15it/s]  8%|▊         | 2/25 [00:00<00:04,  5.22it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.65it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.95it/s] 20%|██        | 5/25 [00:00<00:03,  6.13it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.20it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.28it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.42it/s] 40%|████      | 10/25 [00:01<00:02,  6.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.49it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.51it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.51it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.55it/s] 80%|████████  | 20/25 [00:03<00:00,  6.55it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.56it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.56it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.51it/s]100%|██████████| 25/25 [00:03<00:00,  7.19it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.89it/s]  8%|▊         | 2/25 [00:00<00:03,  6.13it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.38it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.44it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.48it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.40it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.15it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.90it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.86it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.96it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
Run 00 | Epoch 00131 | Loss 0.3762 | Train 0.7076 | Val 0.6998 | Test 0.5567
Number of nodes during this epoch:  4637328
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428016185760498  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1042587757110596
range selection method range initialization spend 0.02780938148498535
time for parepare:  0.3992447853088379
local_output_nid generation:  0.026641368865966797
local_in_edges_tensor generation:  0.22349810600280762
mini_batch_src_global generation:  0.37669992446899414
r_  generation:  5.722558975219727
local_output_nid generation:  0.030544519424438477
local_in_edges_tensor generation:  0.23622679710388184
mini_batch_src_global generation:  0.46201634407043457
r_  generation:  5.949640512466431
----------------------check_connections_block total spend ----------------------------- 15.156072854995728
generate_one_block  7.381019353866577
generate_one_block  7.4453511238098145
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0082526206970215
gen group dst list time:  0.08989739418029785
time for parepare:  0.4454207420349121
local_output_nid generation:  0.26392602920532227
local_in_edges_tensor generation:  1.7385356426239014
mini_batch_src_global generation:  2.4872372150421143
r_  generation:  29.85903239250183
local_output_nid generation:  0.5211441516876221
local_in_edges_tensor generation:  2.157421827316284
mini_batch_src_global generation:  3.492372512817383
r_  generation:  29.841827630996704
----------------------check_connections_block total spend ----------------------------- 82.56989741325378
generate_one_block  40.91419291496277
generate_one_block  41.11123704910278
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.164093017578125
gen group dst list time:  0.1869068145751953
time for parepare:  0.44965124130249023
local_output_nid generation:  0.4100770950317383
local_in_edges_tensor generation:  1.5049934387207031
mini_batch_src_global generation:  2.0936834812164307
r_  generation:  26.2453830242157
local_output_nid generation:  0.7597959041595459
local_in_edges_tensor generation:  1.9291691780090332
mini_batch_src_global generation:  2.880633592605591
r_  generation:  26.372064352035522
----------------------check_connections_block total spend ----------------------------- 72.64547729492188
generate_one_block  35.232075452804565
generate_one_block  36.13541913032532
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428016185760498  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.21537470817566
block generation total time  153.39292454719543
average batch blocks generation time:  76.69646227359772
block dataloader generation time/epoch 367.69726663827896
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38626885414123535 |1.3113476037979126 |0.00495302677154541 |0.00016796588897705078 |0.005199909210205078 |0.003933906555175781 |
----------------------------------------------------------pseudo_mini_loss sum 0.3760550618171692
Total (block generation + training)time/epoch 371.5414221033906
Training time/epoch 3.831953287124634
Training time without block to device /epoch 1.2092580795288086
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.03it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.15it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.78it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.40it/s] 40%|████      | 10/25 [00:00<00:00, 17.55it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.76it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.52it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.72it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.92it/s] 80%|████████  | 20/25 [00:01<00:00, 17.99it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.05it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.06it/s]100%|██████████| 25/25 [00:01<00:00, 17.79it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.59it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.59it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.59it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.57it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.46it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.20it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.28it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.34it/s] 60%|██████    | 15/25 [00:02<00:01,  6.37it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.14it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.08it/s] 80%|████████  | 20/25 [00:03<00:00,  5.84it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.83it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.77it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.77it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.88it/s]100%|██████████| 25/25 [00:03<00:00,  6.69it/s]100%|██████████| 25/25 [00:03<00:00,  6.32it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.93it/s]  8%|▊         | 2/25 [00:00<00:03,  6.20it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.26it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.26it/s] 20%|██        | 5/25 [00:00<00:03,  6.31it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.26it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.56it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.80it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.89it/s] 40%|████      | 10/25 [00:01<00:02,  5.75it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.79it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.90it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.81it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.89it/s] 60%|██████    | 15/25 [00:02<00:01,  6.00it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.10it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.20it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.14it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.23it/s] 80%|████████  | 20/25 [00:03<00:00,  6.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.29it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.32it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:04<00:00,  6.19it/s]
Run 00 | Epoch 00132 | Loss 0.3761 | Train 0.7070 | Val 0.6994 | Test 0.5564
Number of nodes during this epoch:  4637533
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426510810852051  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.185075283050537
range selection method range initialization spend 0.0262601375579834
time for parepare:  0.36875033378601074
local_output_nid generation:  0.026149988174438477
local_in_edges_tensor generation:  0.21536684036254883
mini_batch_src_global generation:  0.3741269111633301
r_  generation:  5.487272500991821
local_output_nid generation:  0.027642011642456055
local_in_edges_tensor generation:  0.23728632926940918
mini_batch_src_global generation:  0.48348093032836914
r_  generation:  5.692518949508667
----------------------check_connections_block total spend ----------------------------- 14.587300539016724
generate_one_block  7.2950663566589355
generate_one_block  7.1718409061431885
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.917912006378174
gen group dst list time:  0.0878901481628418
time for parepare:  0.4688138961791992
local_output_nid generation:  0.27100539207458496
local_in_edges_tensor generation:  1.7217555046081543
mini_batch_src_global generation:  2.512106418609619
r_  generation:  30.017433881759644
local_output_nid generation:  0.5177807807922363
local_in_edges_tensor generation:  2.2330381870269775
mini_batch_src_global generation:  3.5449612140655518
r_  generation:  30.012836694717407
----------------------check_connections_block total spend ----------------------------- 83.40576720237732
generate_one_block  41.11109781265259
generate_one_block  40.896297216415405
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.194032907485962
gen group dst list time:  0.18714475631713867
time for parepare:  0.44887828826904297
local_output_nid generation:  0.3766205310821533
local_in_edges_tensor generation:  1.4568185806274414
mini_batch_src_global generation:  2.0419089794158936
r_  generation:  25.47297191619873
local_output_nid generation:  0.7341034412384033
local_in_edges_tensor generation:  1.942798376083374
mini_batch_src_global generation:  2.883843421936035
r_  generation:  26.324835300445557
----------------------check_connections_block total spend ----------------------------- 71.85509014129639
generate_one_block  35.92615365982056
generate_one_block  36.26692748069763
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426510810852051  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.2608573436737
block generation total time  154.20047616958618
average batch blocks generation time:  77.10023808479309
block dataloader generation time/epoch 367.7007321827394
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38034188747406006 |1.2971184253692627 |0.004963278770446777 |0.00017154216766357422 |0.005225419998168945 |0.001888275146484375 |
----------------------------------------------------------pseudo_mini_loss sum 0.3753202259540558
Total (block generation + training)time/epoch 371.5444881467891
Training time/epoch 3.7908263206481934
Training time without block to device /epoch 1.196589469909668
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.21it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.46it/s] 40%|████      | 10/25 [00:00<00:00, 17.80it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.93it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.92it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.91it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.92it/s] 80%|████████  | 20/25 [00:01<00:00, 17.92it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.85it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.77it/s]100%|██████████| 25/25 [00:01<00:00, 17.79it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.49it/s]  8%|▊         | 2/25 [00:00<00:03,  6.68it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.69it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.68it/s] 20%|██        | 5/25 [00:00<00:02,  6.69it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.74it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.77it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.80it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.83it/s] 40%|████      | 10/25 [00:01<00:02,  6.84it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.84it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.65it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.33it/s] 60%|██████    | 15/25 [00:02<00:01,  6.17it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.20it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.30it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.52it/s] 80%|████████  | 20/25 [00:03<00:00,  6.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.65it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.66it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.72it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.74it/s]100%|██████████| 25/25 [00:03<00:00,  6.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.25it/s]  8%|▊         | 2/25 [00:00<00:03,  6.43it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.66it/s] 20%|██        | 5/25 [00:00<00:03,  5.81it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.02it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.03it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.20it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.36it/s] 40%|████      | 10/25 [00:01<00:02,  5.89it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.61it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.36it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.23it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.18it/s] 60%|██████    | 15/25 [00:02<00:01,  5.14it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.09it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.04it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.02it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.00it/s] 80%|████████  | 20/25 [00:03<00:01,  4.94it/s] 84%|████████▍ | 21/25 [00:03<00:00,  4.88it/s] 88%|████████▊ | 22/25 [00:04<00:00,  4.83it/s] 92%|█████████▏| 23/25 [00:04<00:00,  4.80it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.83it/s]100%|██████████| 25/25 [00:04<00:00,  5.45it/s]
Run 00 | Epoch 00133 | Loss 0.3753 | Train 0.7067 | Val 0.6993 | Test 0.5563
Number of nodes during this epoch:  4637448
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427919387817383  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1114616394042969
range selection method range initialization spend 0.024997949600219727
time for parepare:  0.38013720512390137
local_output_nid generation:  0.02828526496887207
local_in_edges_tensor generation:  0.18372201919555664
mini_batch_src_global generation:  0.3670501708984375
r_  generation:  5.608048439025879
local_output_nid generation:  0.029303789138793945
local_in_edges_tensor generation:  0.2364211082458496
mini_batch_src_global generation:  0.4608607292175293
r_  generation:  5.813530921936035
----------------------check_connections_block total spend ----------------------------- 14.732322216033936
generate_one_block  7.154970407485962
generate_one_block  6.833447694778442
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9913012981414795
gen group dst list time:  0.08749032020568848
time for parepare:  0.43845248222351074
local_output_nid generation:  0.2536158561706543
local_in_edges_tensor generation:  1.6395509243011475
mini_batch_src_global generation:  2.6208977699279785
r_  generation:  30.105811595916748
local_output_nid generation:  0.534130334854126
local_in_edges_tensor generation:  2.2889885902404785
mini_batch_src_global generation:  3.7254245281219482
r_  generation:  30.125945806503296
----------------------check_connections_block total spend ----------------------------- 83.78984665870667
generate_one_block  41.293620347976685
generate_one_block  40.99041175842285
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2715601921081543
gen group dst list time:  0.18503117561340332
time for parepare:  0.47362613677978516
local_output_nid generation:  0.40891408920288086
local_in_edges_tensor generation:  1.52947998046875
mini_batch_src_global generation:  2.021505355834961
r_  generation:  26.204060077667236
local_output_nid generation:  0.7233922481536865
local_in_edges_tensor generation:  2.0776288509368896
mini_batch_src_global generation:  2.8429524898529053
r_  generation:  26.147525548934937
----------------------check_connections_block total spend ----------------------------- 72.38236904144287
generate_one_block  35.390950441360474
generate_one_block  36.18574619293213
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427919387817383  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.17221570014954
block generation total time  153.86072874069214
average batch blocks generation time:  76.93036437034607
block dataloader generation time/epoch 367.714898431479
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40543150901794434 |1.3131461143493652 |0.004416704177856445 |0.00014960765838623047 |0.005083680152893066 |0.0021228790283203125 |
----------------------------------------------------------pseudo_mini_loss sum 0.3735540509223938
Total (block generation + training)time/epoch 371.558862677261
Training time/epoch 3.8714983463287354
Training time without block to device /epoch 1.2452061176300049
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.02it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.64it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.97it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.38it/s] 40%|████      | 10/25 [00:00<00:00, 17.50it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.71it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.60it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.69it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.91it/s] 80%|████████  | 20/25 [00:01<00:00, 18.06it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.14it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.25it/s]100%|██████████| 25/25 [00:01<00:00, 17.97it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.13it/s]  8%|▊         | 2/25 [00:00<00:04,  5.17it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.93it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.68it/s] 20%|██        | 5/25 [00:01<00:04,  4.81it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.79it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.16it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.49it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.77it/s] 40%|████      | 10/25 [00:01<00:02,  5.99it/s] 44%|████▍     | 11/25 [00:02<00:02,  6.13it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.24it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.54it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.50it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.11it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.24it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.33it/s]100%|██████████| 25/25 [00:04<00:00,  6.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.47it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.52it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.57it/s] 40%|████      | 10/25 [00:01<00:02,  6.58it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.24it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.02it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.02it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.04it/s] 60%|██████    | 15/25 [00:02<00:01,  6.15it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.25it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.33it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.36it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.47it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.49it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00134 | Loss 0.3736 | Train 0.7070 | Val 0.6996 | Test 0.5565
Number of nodes during this epoch:  4637609
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423994541168213  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1531414985656738
range selection method range initialization spend 0.024327993392944336
time for parepare:  0.36010146141052246
local_output_nid generation:  0.025738000869750977
local_in_edges_tensor generation:  0.2050459384918213
mini_batch_src_global generation:  0.37607312202453613
r_  generation:  5.601807117462158
local_output_nid generation:  0.02859950065612793
local_in_edges_tensor generation:  0.22967147827148438
mini_batch_src_global generation:  0.4729304313659668
r_  generation:  5.837622165679932
----------------------check_connections_block total spend ----------------------------- 14.832329750061035
generate_one_block  7.135962009429932
generate_one_block  6.888878583908081
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9483509063720703
gen group dst list time:  0.0875709056854248
time for parepare:  0.42791223526000977
local_output_nid generation:  0.24548029899597168
local_in_edges_tensor generation:  1.535651445388794
mini_batch_src_global generation:  2.5403358936309814
r_  generation:  30.754371643066406
local_output_nid generation:  0.525834321975708
local_in_edges_tensor generation:  2.0319695472717285
mini_batch_src_global generation:  3.5176727771759033
r_  generation:  30.39735770225525
----------------------check_connections_block total spend ----------------------------- 84.26779460906982
generate_one_block  41.29949998855591
generate_one_block  41.21116542816162
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.071712017059326
gen group dst list time:  0.1916792392730713
time for parepare:  0.4797954559326172
local_output_nid generation:  0.3904080390930176
local_in_edges_tensor generation:  1.6027262210845947
mini_batch_src_global generation:  2.1777307987213135
r_  generation:  26.129393339157104
local_output_nid generation:  0.7275886535644531
local_in_edges_tensor generation:  2.082491397857666
mini_batch_src_global generation:  2.8198912143707275
r_  generation:  25.93083953857422
----------------------check_connections_block total spend ----------------------------- 72.12042260169983
generate_one_block  35.299856185913086
generate_one_block  36.03282022476196
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423994541168213  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.38821721076965
block generation total time  153.84334182739258
average batch blocks generation time:  76.92167091369629
block dataloader generation time/epoch 367.7184505639253
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3807871341705322 |1.2991441488265991 |0.004445195198059082 |0.0001461505889892578 |0.005186676979064941 |0.0017807483673095703 |
----------------------------------------------------------pseudo_mini_loss sum 0.37216973304748535
Total (block generation + training)time/epoch 371.56199915674
Training time/epoch 3.7876834869384766
Training time without block to device /epoch 1.1893951892852783
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.15it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.42it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.05it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.56it/s] 40%|████      | 10/25 [00:00<00:01, 14.05it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.24it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.11it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.36it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.92it/s] 80%|████████  | 20/25 [00:01<00:00, 17.34it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.16it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.49it/s]100%|██████████| 25/25 [00:01<00:00, 16.90it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.61it/s]  8%|▊         | 2/25 [00:00<00:03,  6.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.62it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.61it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.63it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.65it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.60it/s] 40%|████      | 10/25 [00:01<00:02,  6.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.61it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.62it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.62it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.65it/s] 60%|██████    | 15/25 [00:02<00:01,  6.67it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.70it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.54it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.55it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.58it/s] 80%|████████  | 20/25 [00:03<00:00,  6.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.17it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.80it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.14it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.51it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.66it/s]  8%|▊         | 2/25 [00:00<00:04,  5.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.01it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.04it/s] 20%|██        | 5/25 [00:00<00:03,  6.16it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.23it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.29it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.36it/s] 40%|████      | 10/25 [00:01<00:02,  5.97it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.89it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.01it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.14it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.22it/s] 60%|██████    | 15/25 [00:02<00:01,  6.26it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.41it/s]100%|██████████| 25/25 [00:03<00:00,  6.33it/s]
Run 00 | Epoch 00135 | Loss 0.3722 | Train 0.7081 | Val 0.7004 | Test 0.5568
Number of nodes during this epoch:  4638082
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428249835968018  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1254596710205078
range selection method range initialization spend 0.027034759521484375
time for parepare:  0.37842249870300293
local_output_nid generation:  0.026057958602905273
local_in_edges_tensor generation:  0.19888758659362793
mini_batch_src_global generation:  0.37448978424072266
r_  generation:  5.390263080596924
local_output_nid generation:  0.02758502960205078
local_in_edges_tensor generation:  0.2135324478149414
mini_batch_src_global generation:  0.4606974124908447
r_  generation:  5.64937162399292
----------------------check_connections_block total spend ----------------------------- 14.353283405303955
generate_one_block  7.185264348983765
generate_one_block  6.74113917350769
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.141119480133057
gen group dst list time:  0.08324551582336426
time for parepare:  0.437971830368042
local_output_nid generation:  0.26475095748901367
local_in_edges_tensor generation:  1.7443900108337402
mini_batch_src_global generation:  2.4601070880889893
r_  generation:  29.581449508666992
local_output_nid generation:  0.5205512046813965
local_in_edges_tensor generation:  2.157127857208252
mini_batch_src_global generation:  3.503901481628418
r_  generation:  30.006768941879272
----------------------check_connections_block total spend ----------------------------- 82.50955128669739
generate_one_block  41.10224628448486
generate_one_block  41.107547760009766
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2760744094848633
gen group dst list time:  0.19010567665100098
time for parepare:  0.49871158599853516
local_output_nid generation:  0.4188656806945801
local_in_edges_tensor generation:  1.576294183731079
mini_batch_src_global generation:  2.051204204559326
r_  generation:  26.204517364501953
local_output_nid generation:  0.7345380783081055
local_in_edges_tensor generation:  2.0871217250823975
mini_batch_src_global generation:  2.8317105770111084
r_  generation:  26.012082815170288
----------------------check_connections_block total spend ----------------------------- 72.26458835601807
generate_one_block  35.436885356903076
generate_one_block  36.2926881313324
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428249835968018  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.77413964271545
block generation total time  153.9393675327301
average batch blocks generation time:  76.96968376636505
block dataloader generation time/epoch 367.71130790605264
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3949909210205078 |1.3285359144210815 |0.004460811614990234 |0.00015366077423095703 |0.005198001861572266 |0.0018353462219238281 |
----------------------------------------------------------pseudo_mini_loss sum 0.3726758360862732
Total (block generation + training)time/epoch 371.55513391424626
Training time/epoch 3.8811075687408447
Training time without block to device /epoch 1.2240357398986816
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.03it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.47it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.26it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.68it/s] 40%|████      | 10/25 [00:00<00:00, 17.91it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.09it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.23it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.21it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.23it/s] 80%|████████  | 20/25 [00:01<00:00, 18.12it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.19it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.26it/s]100%|██████████| 25/25 [00:01<00:00, 18.21it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.44it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.45it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.51it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.49it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.45it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.44it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.46it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.48it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.46it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.51it/s]100%|██████████| 25/25 [00:03<00:00,  6.58it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.26it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.41it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.22it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.32it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.40it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.26it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.29it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.32it/s] 60%|██████    | 15/25 [00:02<00:01,  6.14it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.24it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.03it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.12it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.21it/s] 80%|████████  | 20/25 [00:03<00:00,  6.28it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.29it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.35it/s]100%|██████████| 25/25 [00:03<00:00,  7.11it/s]100%|██████████| 25/25 [00:03<00:00,  6.39it/s]
Run 00 | Epoch 00136 | Loss 0.3727 | Train 0.7084 | Val 0.7005 | Test 0.5566
Number of nodes during this epoch:  4637474
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426464557647705  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1193325519561768
range selection method range initialization spend 0.024340152740478516
time for parepare:  0.3605952262878418
local_output_nid generation:  0.026208877563476562
local_in_edges_tensor generation:  0.20954513549804688
mini_batch_src_global generation:  0.37361812591552734
r_  generation:  5.784743785858154
local_output_nid generation:  0.029117822647094727
local_in_edges_tensor generation:  0.23337769508361816
mini_batch_src_global generation:  0.47901487350463867
r_  generation:  5.947920322418213
----------------------check_connections_block total spend ----------------------------- 15.113920211791992
generate_one_block  7.177263498306274
generate_one_block  6.9213104248046875
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9191272258758545
gen group dst list time:  0.08925509452819824
time for parepare:  0.43575334548950195
local_output_nid generation:  0.2404165267944336
local_in_edges_tensor generation:  1.6095142364501953
mini_batch_src_global generation:  2.5902891159057617
r_  generation:  30.138095378875732
local_output_nid generation:  0.5185532569885254
local_in_edges_tensor generation:  2.095421075820923
mini_batch_src_global generation:  3.4552862644195557
r_  generation:  30.12970280647278
----------------------check_connections_block total spend ----------------------------- 83.30149483680725
generate_one_block  40.7861602306366
generate_one_block  40.76206016540527
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1836302280426025
gen group dst list time:  0.20194125175476074
time for parepare:  0.4501047134399414
local_output_nid generation:  0.3936147689819336
local_in_edges_tensor generation:  1.5158498287200928
mini_batch_src_global generation:  2.164778470993042
r_  generation:  26.27875018119812
local_output_nid generation:  0.7258899211883545
local_in_edges_tensor generation:  1.9311649799346924
mini_batch_src_global generation:  2.8989109992980957
r_  generation:  25.959080696105957
----------------------check_connections_block total spend ----------------------------- 72.2380256652832
generate_one_block  35.12615990638733
generate_one_block  35.99196743965149
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426464557647705  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.53952050209045
block generation total time  152.6663477420807
average batch blocks generation time:  76.33317387104034
block dataloader generation time/epoch 367.7046622185812
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37366175651550293 |1.2905956506729126 |0.004512786865234375 |0.00015246868133544922 |0.0052651166915893555 |0.003060579299926758 |
----------------------------------------------------------pseudo_mini_loss sum 0.3730849027633667
Total (block generation + training)time/epoch 371.54790217859033
Training time/epoch 3.7633678913116455
Training time without block to device /epoch 1.1821765899658203
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.35it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.88it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.54it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.83it/s] 40%|████      | 10/25 [00:00<00:00, 18.02it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.07it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.10it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.76it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.86it/s] 80%|████████  | 20/25 [00:01<00:00, 17.94it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.04it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.13it/s]100%|██████████| 25/25 [00:01<00:00, 18.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.65it/s]  8%|▊         | 2/25 [00:00<00:04,  5.74it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.03it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.31it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.50it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.07it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.76it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.81it/s] 40%|████      | 10/25 [00:01<00:02,  6.03it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.21it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.25it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.36it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.17it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.82it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.91it/s] 80%|████████  | 20/25 [00:03<00:00,  6.11it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.27it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.53it/s]100%|██████████| 25/25 [00:03<00:00,  6.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.38it/s]  8%|▊         | 2/25 [00:00<00:03,  6.59it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.63it/s] 20%|██        | 5/25 [00:00<00:03,  6.62it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.61it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.62it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.44it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.53it/s] 40%|████      | 10/25 [00:01<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.09it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.23it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.46it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.10it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.21it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.36it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.54it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.57it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.62it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
Run 00 | Epoch 00137 | Loss 0.3731 | Train 0.7083 | Val 0.7008 | Test 0.5565
Number of nodes during this epoch:  4638003
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428187370300293  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.117365837097168
range selection method range initialization spend 0.024327993392944336
time for parepare:  0.36139869689941406
local_output_nid generation:  0.02568650245666504
local_in_edges_tensor generation:  0.21185016632080078
mini_batch_src_global generation:  0.3671419620513916
r_  generation:  5.369795560836792
local_output_nid generation:  0.027874231338500977
local_in_edges_tensor generation:  0.1921837329864502
mini_batch_src_global generation:  0.45470261573791504
r_  generation:  5.560516357421875
----------------------check_connections_block total spend ----------------------------- 14.224175691604614
generate_one_block  7.104429244995117
generate_one_block  7.1638219356536865
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0833446979522705
gen group dst list time:  0.08787250518798828
time for parepare:  0.441295862197876
local_output_nid generation:  0.25161099433898926
local_in_edges_tensor generation:  1.611116647720337
mini_batch_src_global generation:  2.4640166759490967
r_  generation:  29.723300218582153
local_output_nid generation:  0.5265955924987793
local_in_edges_tensor generation:  2.2179510593414307
mini_batch_src_global generation:  3.6987032890319824
r_  generation:  29.725656032562256
----------------------check_connections_block total spend ----------------------------- 82.50507807731628
generate_one_block  40.77772235870361
generate_one_block  40.44207835197449
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3528053760528564
gen group dst list time:  0.1951885223388672
time for parepare:  0.48678135871887207
local_output_nid generation:  0.4075298309326172
local_in_edges_tensor generation:  1.540907859802246
mini_batch_src_global generation:  2.019122362136841
r_  generation:  26.114766120910645
local_output_nid generation:  0.7241661548614502
local_in_edges_tensor generation:  1.9152085781097412
mini_batch_src_global generation:  2.8049256801605225
r_  generation:  26.031548738479614
----------------------check_connections_block total spend ----------------------------- 72.13134121894836
generate_one_block  35.228302240371704
generate_one_block  35.863767862319946
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428187370300293  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.63641929626465
block generation total time  152.31187081336975
average batch blocks generation time:  76.15593540668488
block dataloader generation time/epoch 367.68741576913476
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3840515613555908 |1.3212686777114868 |0.004369258880615234 |0.000152587890625 |0.0052089691162109375 |0.0018339157104492188 |
----------------------------------------------------------pseudo_mini_loss sum 0.3730703592300415
Total (block generation + training)time/epoch 371.53063737827796
Training time/epoch 3.8405416011810303
Training time without block to device /epoch 1.1980042457580566
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.27it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.54it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.21it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.66it/s] 40%|████      | 10/25 [00:00<00:00, 17.87it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.99it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.01it/s] 80%|████████  | 20/25 [00:01<00:00, 18.02it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.01it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.98it/s]100%|██████████| 25/25 [00:01<00:00, 17.95it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:03,  6.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.53it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.26it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.33it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.90it/s] 40%|████      | 10/25 [00:01<00:02,  5.72it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.77it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.91it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.08it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.23it/s] 60%|██████    | 15/25 [00:02<00:01,  6.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.36it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.57it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.59it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.59it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.16it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.95it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.99it/s] 20%|██        | 5/25 [00:00<00:03,  5.25it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.56it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.80it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.97it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.10it/s] 40%|████      | 10/25 [00:01<00:02,  6.23it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.24it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.27it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.26it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.32it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.39it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:04<00:00,  6.23it/s]
Run 00 | Epoch 00138 | Loss 0.3731 | Train 0.7091 | Val 0.7011 | Test 0.5568
Number of nodes during this epoch:  4636876
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429505348205566  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.136017084121704
range selection method range initialization spend 0.024128437042236328
time for parepare:  0.35710763931274414
local_output_nid generation:  0.0259702205657959
local_in_edges_tensor generation:  0.19916820526123047
mini_batch_src_global generation:  0.3735184669494629
r_  generation:  5.621507883071899
local_output_nid generation:  0.028996706008911133
local_in_edges_tensor generation:  0.23198390007019043
mini_batch_src_global generation:  0.46001482009887695
r_  generation:  5.8562963008880615
----------------------check_connections_block total spend ----------------------------- 14.808257579803467
generate_one_block  7.119282484054565
generate_one_block  6.822953224182129
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9869940280914307
gen group dst list time:  0.09314680099487305
time for parepare:  0.4539649486541748
local_output_nid generation:  0.26491618156433105
local_in_edges_tensor generation:  1.6747384071350098
mini_batch_src_global generation:  2.594322681427002
r_  generation:  29.812070608139038
local_output_nid generation:  0.5358352661132812
local_in_edges_tensor generation:  2.216190814971924
mini_batch_src_global generation:  3.7433855533599854
r_  generation:  30.007672786712646
----------------------check_connections_block total spend ----------------------------- 83.31836318969727
generate_one_block  41.87106251716614
generate_one_block  41.14433479309082
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.253495454788208
gen group dst list time:  0.18077874183654785
time for parepare:  0.48160433769226074
local_output_nid generation:  0.426177978515625
local_in_edges_tensor generation:  1.6790611743927002
mini_batch_src_global generation:  2.018770933151245
r_  generation:  26.16670322418213
local_output_nid generation:  0.7377781867980957
local_in_edges_tensor generation:  2.0335965156555176
mini_batch_src_global generation:  2.823702335357666
r_  generation:  26.334546089172363
----------------------check_connections_block total spend ----------------------------- 72.80858254432678
generate_one_block  35.05639600753784
generate_one_block  35.95524978637695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429505348205566  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.12694573402405
block generation total time  154.02704310417175
average batch blocks generation time:  77.01352155208588
block dataloader generation time/epoch 367.69479739751745
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37334585189819336 |1.3486018180847168 |0.004386425018310547 |0.00014603137969970703 |0.005231380462646484 |0.0018436908721923828 |
----------------------------------------------------------pseudo_mini_loss sum 0.37116432189941406
Total (block generation + training)time/epoch 371.5382516898697
Training time/epoch 3.8753952980041504
Training time without block to device /epoch 1.1781916618347168
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.30it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.88it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.12it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.86it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.92it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.68it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.76it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.87it/s] 80%|████████  | 20/25 [00:01<00:00, 17.90it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.89it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.95it/s]100%|██████████| 25/25 [00:01<00:00, 17.85it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.70it/s]  8%|▊         | 2/25 [00:00<00:04,  4.97it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.73it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.03it/s] 20%|██        | 5/25 [00:00<00:03,  5.38it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.25it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.42it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.67it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.89it/s] 40%|████      | 10/25 [00:01<00:02,  6.02it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.17it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.30it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.44it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.53it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.28it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.09it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.22it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.02it/s]100%|██████████| 25/25 [00:04<00:00,  6.47it/s]100%|██████████| 25/25 [00:04<00:00,  6.01it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.62it/s]  8%|▊         | 2/25 [00:00<00:03,  6.18it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.35it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.48it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.43it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.37it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.26it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.30it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.36it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00139 | Loss 0.3712 | Train 0.7092 | Val 0.7012 | Test 0.5569
Number of nodes during this epoch:  4638079
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427313327789307  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1334753036499023
range selection method range initialization spend 0.02546215057373047
time for parepare:  0.38161754608154297
local_output_nid generation:  0.02621603012084961
local_in_edges_tensor generation:  0.21497678756713867
mini_batch_src_global generation:  0.3736996650695801
r_  generation:  5.406233549118042
local_output_nid generation:  0.02747941017150879
local_in_edges_tensor generation:  0.21497011184692383
mini_batch_src_global generation:  0.4777181148529053
r_  generation:  5.652386903762817
----------------------check_connections_block total spend ----------------------------- 14.410061359405518
generate_one_block  7.1653828620910645
generate_one_block  6.750996112823486
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.142172336578369
gen group dst list time:  0.09112262725830078
time for parepare:  0.43331217765808105
local_output_nid generation:  0.2416067123413086
local_in_edges_tensor generation:  1.6529319286346436
mini_batch_src_global generation:  2.553755044937134
r_  generation:  30.017810106277466
local_output_nid generation:  0.5264029502868652
local_in_edges_tensor generation:  2.090507984161377
mini_batch_src_global generation:  3.50369930267334
r_  generation:  30.415437936782837
----------------------check_connections_block total spend ----------------------------- 83.98300409317017
generate_one_block  41.099602699279785
generate_one_block  41.32485508918762
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1829426288604736
gen group dst list time:  0.19294404983520508
time for parepare:  0.47731447219848633
local_output_nid generation:  0.39211177825927734
local_in_edges_tensor generation:  1.6165282726287842
mini_batch_src_global generation:  2.132639169692993
r_  generation:  26.18425440788269
local_output_nid generation:  0.7431859970092773
local_in_edges_tensor generation:  1.9425010681152344
mini_batch_src_global generation:  2.895808696746826
r_  generation:  25.968154430389404
----------------------check_connections_block total spend ----------------------------- 72.30233335494995
generate_one_block  35.12207245826721
generate_one_block  35.91702580451965
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427313327789307  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.28533744812012
block generation total time  153.46355605125427
average batch blocks generation time:  76.73177802562714
block dataloader generation time/epoch 367.6935721567699
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3961803913116455 |1.3246265649795532 |0.00486445426940918 |0.00017142295837402344 |0.005136370658874512 |0.0019631385803222656 |
----------------------------------------------------------pseudo_mini_loss sum 0.37139058113098145
Total (block generation + training)time/epoch 371.5372594646045
Training time/epoch 3.875908613204956
Training time without block to device /epoch 1.2266554832458496
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.48it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.21it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.65it/s] 40%|████      | 10/25 [00:00<00:01, 13.96it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.49it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.51it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.33it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.80it/s] 80%|████████  | 20/25 [00:01<00:00, 17.22it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.52it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.71it/s]100%|██████████| 25/25 [00:01<00:00, 16.83it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.33it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.59it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.00it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.13it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.28it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.47it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.53it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.59it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.60it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.60it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.60it/s] 80%|████████  | 20/25 [00:03<00:00,  6.60it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.60it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.60it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.58it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.56it/s]100%|██████████| 25/25 [00:03<00:00,  6.60it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.44it/s] 20%|██        | 5/25 [00:00<00:03,  6.41it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.46it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.46it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.50it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.49it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.30it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.30it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.34it/s]100%|██████████| 25/25 [00:03<00:00,  7.08it/s]100%|██████████| 25/25 [00:03<00:00,  6.51it/s]
Run 00 | Epoch 00140 | Loss 0.3714 | Train 0.7083 | Val 0.7004 | Test 0.5564
Number of nodes during this epoch:  4637852
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4279985427856445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1448984146118164
range selection method range initialization spend 0.02492666244506836
time for parepare:  0.4016385078430176
local_output_nid generation:  0.02632904052734375
local_in_edges_tensor generation:  0.22314763069152832
mini_batch_src_global generation:  0.38966822624206543
r_  generation:  5.63956618309021
local_output_nid generation:  0.028536081314086914
local_in_edges_tensor generation:  0.2386798858642578
mini_batch_src_global generation:  0.4664268493652344
r_  generation:  5.9508562088012695
----------------------check_connections_block total spend ----------------------------- 15.112039804458618
generate_one_block  7.157915830612183
generate_one_block  6.9119977951049805
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0920023918151855
gen group dst list time:  0.1048283576965332
time for parepare:  0.44596171379089355
local_output_nid generation:  0.2685096263885498
local_in_edges_tensor generation:  1.6797213554382324
mini_batch_src_global generation:  2.544304847717285
r_  generation:  30.182048559188843
local_output_nid generation:  0.5206775665283203
local_in_edges_tensor generation:  2.1574113368988037
mini_batch_src_global generation:  3.545832395553589
r_  generation:  30.341527462005615
----------------------check_connections_block total spend ----------------------------- 83.81480956077576
generate_one_block  40.86405372619629
generate_one_block  41.13713455200195
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3163888454437256
gen group dst list time:  0.18454647064208984
time for parepare:  0.47991132736206055
local_output_nid generation:  0.38407158851623535
local_in_edges_tensor generation:  1.5033984184265137
mini_batch_src_global generation:  2.02624249458313
r_  generation:  25.779833793640137
local_output_nid generation:  0.7324793338775635
local_in_edges_tensor generation:  1.9270033836364746
mini_batch_src_global generation:  2.906623125076294
r_  generation:  26.751736640930176
----------------------check_connections_block total spend ----------------------------- 73.20307731628418
generate_one_block  35.10101866722107
generate_one_block  36.097944259643555
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4279985427856445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.01788687705994
block generation total time  153.20015120506287
average batch blocks generation time:  76.60007560253143
block dataloader generation time/epoch 367.70616965429156
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3917419910430908 |1.4271221160888672 |0.0044023990631103516 |0.00014698505401611328 |0.005015850067138672 |0.0016810894012451172 |
----------------------------------------------------------pseudo_mini_loss sum 0.3699207007884979
Total (block generation + training)time/epoch 371.5514521734089
Training time/epoch 4.068443059921265
Training time without block to device /epoch 1.2141988277435303
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.76it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.42it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.83it/s] 40%|████      | 10/25 [00:00<00:00, 17.97it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.11it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.11it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.45it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.58it/s] 80%|████████  | 20/25 [00:01<00:00, 16.89it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.32it/s] 96%|█████████▌| 24/25 [00:01<00:00, 15.85it/s]100%|██████████| 25/25 [00:01<00:00, 17.07it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.43it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.29it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.47it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.50it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.56it/s] 40%|████      | 10/25 [00:01<00:02,  6.55it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.52it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.52it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.49it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.51it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.52it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.46it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.24it/s]  8%|▊         | 2/25 [00:00<00:03,  6.30it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.39it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.39it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.40it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.37it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.41it/s] 80%|████████  | 20/25 [00:03<00:00,  6.34it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.28it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:03<00:00,  7.10it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00141 | Loss 0.3699 | Train 0.7082 | Val 0.6996 | Test 0.5561
Number of nodes during this epoch:  4637833
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428302764892578  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1483337879180908
range selection method range initialization spend 0.026323795318603516
time for parepare:  0.40268945693969727
local_output_nid generation:  0.025912046432495117
local_in_edges_tensor generation:  0.2366642951965332
mini_batch_src_global generation:  0.3925330638885498
r_  generation:  5.479301929473877
local_output_nid generation:  0.028665542602539062
local_in_edges_tensor generation:  0.2188427448272705
mini_batch_src_global generation:  0.485278844833374
r_  generation:  5.864819526672363
----------------------check_connections_block total spend ----------------------------- 14.87946343421936
generate_one_block  7.295843601226807
generate_one_block  7.014324426651001
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9828083515167236
gen group dst list time:  0.09325098991394043
time for parepare:  0.44861674308776855
local_output_nid generation:  0.2758193016052246
local_in_edges_tensor generation:  1.6541759967803955
mini_batch_src_global generation:  2.550630569458008
r_  generation:  29.99440050125122
local_output_nid generation:  0.5342915058135986
local_in_edges_tensor generation:  2.1300134658813477
mini_batch_src_global generation:  3.658071994781494
r_  generation:  30.24670720100403
----------------------check_connections_block total spend ----------------------------- 83.5476713180542
generate_one_block  40.70342040061951
generate_one_block  41.08074593544006
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2027063369750977
gen group dst list time:  0.1840980052947998
time for parepare:  0.4860200881958008
local_output_nid generation:  0.38296961784362793
local_in_edges_tensor generation:  1.5470128059387207
mini_batch_src_global generation:  2.069638967514038
r_  generation:  26.0767183303833
local_output_nid generation:  0.7257516384124756
local_in_edges_tensor generation:  2.082843542098999
mini_batch_src_global generation:  2.8269684314727783
r_  generation:  26.040268182754517
----------------------check_connections_block total spend ----------------------------- 72.0375463962555
generate_one_block  35.193211793899536
generate_one_block  35.96403503417969
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428302764892578  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.5852177143097
block generation total time  152.9414131641388
average batch blocks generation time:  76.4707065820694
block dataloader generation time/epoch 367.7040826619511
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.389359712600708 |1.3084347248077393 |0.004523634910583496 |0.0001552104949951172 |0.0051795244216918945 |0.0017766952514648438 |
----------------------------------------------------------pseudo_mini_loss sum 0.3689303696155548
Total (block generation + training)time/epoch 371.54925272330433
Training time/epoch 3.8291239738464355
Training time without block to device /epoch 1.212254524230957
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.37it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.59it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.26it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.71it/s] 40%|████      | 10/25 [00:00<00:00, 17.94it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.09it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.22it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.27it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.23it/s] 80%|████████  | 20/25 [00:01<00:00, 18.28it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.33it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.34it/s]100%|██████████| 25/25 [00:01<00:00, 18.25it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.46it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.53it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.54it/s] 20%|██        | 5/25 [00:00<00:03,  6.56it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.60it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.60it/s] 40%|████      | 10/25 [00:01<00:02,  6.56it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.57it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.54it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.56it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.58it/s] 60%|██████    | 15/25 [00:02<00:01,  6.59it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.59it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.60it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.59it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.60it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.59it/s]100%|██████████| 25/25 [00:03<00:00,  6.68it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.29it/s]  8%|▊         | 2/25 [00:00<00:03,  6.40it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.45it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.51it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.53it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.31it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.39it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.24it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.31it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.28it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.08it/s] 80%|████████  | 20/25 [00:03<00:00,  6.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.12it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.24it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.27it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.32it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
Run 00 | Epoch 00142 | Loss 0.3689 | Train 0.7083 | Val 0.6997 | Test 0.5557
Number of nodes during this epoch:  4636849
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429346561431885  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1133480072021484
range selection method range initialization spend 0.024164199829101562
time for parepare:  0.3488645553588867
local_output_nid generation:  0.025533676147460938
local_in_edges_tensor generation:  0.18332314491271973
mini_batch_src_global generation:  0.36730360984802246
r_  generation:  5.253521680831909
local_output_nid generation:  0.02665400505065918
local_in_edges_tensor generation:  0.1930692195892334
mini_batch_src_global generation:  0.4615669250488281
r_  generation:  5.4977569580078125
----------------------check_connections_block total spend ----------------------------- 13.98012375831604
generate_one_block  7.127340078353882
generate_one_block  6.769185781478882
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.912811517715454
gen group dst list time:  0.08803677558898926
time for parepare:  0.44164323806762695
local_output_nid generation:  0.25354886054992676
local_in_edges_tensor generation:  1.586338758468628
mini_batch_src_global generation:  2.4450836181640625
r_  generation:  29.7113676071167
local_output_nid generation:  0.5162711143493652
local_in_edges_tensor generation:  2.0954558849334717
mini_batch_src_global generation:  3.5272817611694336
r_  generation:  30.101726055145264
----------------------check_connections_block total spend ----------------------------- 82.53381085395813
generate_one_block  41.1542284488678
generate_one_block  41.03265690803528
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2238359451293945
gen group dst list time:  0.18960094451904297
time for parepare:  0.433424711227417
local_output_nid generation:  0.37724971771240234
local_in_edges_tensor generation:  1.4550349712371826
mini_batch_src_global generation:  2.0059382915496826
r_  generation:  25.544743299484253
local_output_nid generation:  0.7320175170898438
local_in_edges_tensor generation:  1.939615249633789
mini_batch_src_global generation:  2.8029205799102783
r_  generation:  26.053040981292725
----------------------check_connections_block total spend ----------------------------- 71.51061654090881
generate_one_block  34.64878487586975
generate_one_block  35.76249361038208
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429346561431885  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.04442739486694
block generation total time  152.5981638431549
average batch blocks generation time:  76.29908192157745
block dataloader generation time/epoch 367.6759055927917
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3794288635253906 |1.3852412700653076 |0.0043305158615112305 |0.00015079975128173828 |0.005239963531494141 |0.0016429424285888672 |
----------------------------------------------------------pseudo_mini_loss sum 0.3695121705532074
Total (block generation + training)time/epoch 371.5219262396539
Training time/epoch 3.9666390419006348
Training time without block to device /epoch 1.1961565017700195
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.38it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.57it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.24it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.49it/s] 40%|████      | 10/25 [00:00<00:00, 17.92it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.12it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.06it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.74it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.85it/s] 80%|████████  | 20/25 [00:01<00:00, 17.54it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.66it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.43it/s]100%|██████████| 25/25 [00:01<00:00, 17.77it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.50it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.01it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.70it/s] 40%|████      | 10/25 [00:01<00:02,  5.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.37it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.26it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.20it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.09it/s] 60%|██████    | 15/25 [00:02<00:01,  5.22it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.54it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.80it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.01it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.10it/s] 80%|████████  | 20/25 [00:03<00:00,  6.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.29it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.36it/s]100%|██████████| 25/25 [00:04<00:00,  6.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.32it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.36it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.43it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.53it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.49it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.52it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.54it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.55it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.55it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.51it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.51it/s]100%|██████████| 25/25 [00:03<00:00,  6.58it/s]
Run 00 | Epoch 00143 | Loss 0.3695 | Train 0.7079 | Val 0.6993 | Test 0.5551
Number of nodes during this epoch:  4638405
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42880916595459  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1377921104431152
range selection method range initialization spend 0.024832725524902344
time for parepare:  0.3577096462249756
local_output_nid generation:  0.026111125946044922
local_in_edges_tensor generation:  0.20028996467590332
mini_batch_src_global generation:  0.374570369720459
r_  generation:  5.546631574630737
local_output_nid generation:  0.027815580368041992
local_in_edges_tensor generation:  0.21628642082214355
mini_batch_src_global generation:  0.45859479904174805
r_  generation:  5.483590602874756
----------------------check_connections_block total spend ----------------------------- 14.32682752609253
generate_one_block  7.199497938156128
generate_one_block  7.127665281295776
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0128021240234375
gen group dst list time:  0.09328460693359375
time for parepare:  0.45096421241760254
local_output_nid generation:  0.24873876571655273
local_in_edges_tensor generation:  1.5870885848999023
mini_batch_src_global generation:  2.4337174892425537
r_  generation:  29.16400671005249
local_output_nid generation:  0.5081808567047119
local_in_edges_tensor generation:  2.08801531791687
mini_batch_src_global generation:  3.334897518157959
r_  generation:  29.92643713951111
----------------------check_connections_block total spend ----------------------------- 81.74658584594727
generate_one_block  40.88151454925537
generate_one_block  40.93552923202515
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.266472339630127
gen group dst list time:  0.18839597702026367
time for parepare:  0.4865267276763916
local_output_nid generation:  0.4050753116607666
local_in_edges_tensor generation:  1.600919485092163
mini_batch_src_global generation:  2.0644500255584717
r_  generation:  26.277069330215454
local_output_nid generation:  0.7237968444824219
local_in_edges_tensor generation:  2.0264477729797363
mini_batch_src_global generation:  2.80881667137146
r_  generation:  26.155999183654785
----------------------check_connections_block total spend ----------------------------- 72.59184265136719
generate_one_block  35.18480610847473
generate_one_block  35.91949677467346
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42880916595459  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.33842849731445
block generation total time  152.9213466644287
average batch blocks generation time:  76.46067333221436
block dataloader generation time/epoch 367.6641359312667
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3847154378890991 |1.2096641063690186 |0.004415154457092285 |0.00015234947204589844 |0.005095481872558594 |0.001669168472290039 |
----------------------------------------------------------pseudo_mini_loss sum 0.3680674433708191
Total (block generation + training)time/epoch 371.5085737506549
Training time/epoch 3.6179254055023193
Training time without block to device /epoch 1.1985971927642822
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.47it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.13it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.58it/s] 40%|████      | 10/25 [00:00<00:00, 17.93it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.11it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.17it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.24it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.31it/s] 80%|████████  | 20/25 [00:01<00:00, 18.34it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.27it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.38it/s]100%|██████████| 25/25 [00:01<00:00, 18.24it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.60it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.65it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.68it/s] 20%|██        | 5/25 [00:00<00:02,  6.69it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.63it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.65it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.63it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.64it/s] 40%|████      | 10/25 [00:01<00:02,  6.13it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.78it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.87it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.06it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.18it/s] 60%|██████    | 15/25 [00:02<00:01,  5.84it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.45it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.32it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.11it/s] 80%|████████  | 20/25 [00:03<00:01,  4.92it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.00it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.13it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.35it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.56it/s]100%|██████████| 25/25 [00:04<00:00,  5.93it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.74it/s]  8%|▊         | 2/25 [00:00<00:04,  5.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.98it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.15it/s] 20%|██        | 5/25 [00:00<00:03,  6.26it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.27it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.32it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.37it/s] 40%|████      | 10/25 [00:01<00:02,  5.95it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.66it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.31it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.58it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.79it/s] 60%|██████    | 15/25 [00:02<00:01,  5.99it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.10it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.06it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.10it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.16it/s] 80%|████████  | 20/25 [00:03<00:00,  5.75it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.67it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.77it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.92it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.04it/s]100%|██████████| 25/25 [00:04<00:00,  6.07it/s]
Run 00 | Epoch 00144 | Loss 0.3681 | Train 0.7084 | Val 0.6995 | Test 0.5551
Number of nodes during this epoch:  4637361
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424568176269531  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.161043643951416
range selection method range initialization spend 0.026005029678344727
time for parepare:  0.37415242195129395
local_output_nid generation:  0.02567577362060547
local_in_edges_tensor generation:  0.21455788612365723
mini_batch_src_global generation:  0.3722724914550781
r_  generation:  5.29001522064209
local_output_nid generation:  0.026887178421020508
local_in_edges_tensor generation:  0.21563124656677246
mini_batch_src_global generation:  0.4613959789276123
r_  generation:  5.585537672042847
----------------------check_connections_block total spend ----------------------------- 14.178056001663208
generate_one_block  7.135329484939575
generate_one_block  6.679342746734619
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.102173805236816
gen group dst list time:  0.09039640426635742
time for parepare:  0.4581153392791748
local_output_nid generation:  0.25356197357177734
local_in_edges_tensor generation:  1.8174326419830322
mini_batch_src_global generation:  2.437711477279663
r_  generation:  29.91090726852417
local_output_nid generation:  0.5238854885101318
local_in_edges_tensor generation:  2.199671983718872
mini_batch_src_global generation:  3.6309382915496826
r_  generation:  30.87816882133484
----------------------check_connections_block total spend ----------------------------- 84.97900938987732
generate_one_block  41.34377908706665
generate_one_block  41.24953651428223
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2880465984344482
gen group dst list time:  0.18281960487365723
time for parepare:  0.43610644340515137
local_output_nid generation:  0.39156150817871094
local_in_edges_tensor generation:  1.4722480773925781
mini_batch_src_global generation:  2.19838809967041
r_  generation:  25.897189617156982
local_output_nid generation:  0.7071537971496582
local_in_edges_tensor generation:  1.9137604236602783
mini_batch_src_global generation:  2.829488515853882
r_  generation:  25.925708055496216
----------------------check_connections_block total spend ----------------------------- 71.97177338600159
generate_one_block  35.016117334365845
generate_one_block  35.740623474121094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424568176269531  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.9507827758789
block generation total time  153.35005640983582
average batch blocks generation time:  76.67502820491791
block dataloader generation time/epoch 367.66863775911
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3765953779220581 |1.2879682779312134 |0.0044400691986083984 |0.0001513957977294922 |0.005164980888366699 |0.002004861831665039 |
----------------------------------------------------------pseudo_mini_loss sum 0.3672819137573242
Total (block generation + training)time/epoch 371.5124629070019
Training time/epoch 3.755411148071289
Training time without block to device /epoch 1.1794745922088623
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.39it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.90it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.12it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.38it/s] 40%|████      | 10/25 [00:00<00:01, 13.50it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.74it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.75it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.47it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.09it/s] 80%|████████  | 20/25 [00:01<00:00, 16.72it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.23it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.58it/s]100%|██████████| 25/25 [00:01<00:00, 16.68it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.64it/s]  8%|▊         | 2/25 [00:00<00:04,  5.53it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.82it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.06it/s] 20%|██        | 5/25 [00:00<00:03,  6.23it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.89it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.65it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.47it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.35it/s] 40%|████      | 10/25 [00:01<00:02,  5.28it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.18it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.13it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.38it/s] 60%|██████    | 15/25 [00:02<00:01,  5.69it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.94it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.12it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.86it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.63it/s] 80%|████████  | 20/25 [00:03<00:00,  5.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.37it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.30it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.27it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.22it/s]100%|██████████| 25/25 [00:04<00:00,  5.84it/s]100%|██████████| 25/25 [00:04<00:00,  5.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.82it/s]  8%|▊         | 2/25 [00:00<00:04,  5.70it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.07it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.28it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.95it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.60it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.26it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.13it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.57it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.85it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.05it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.74it/s] 60%|██████    | 15/25 [00:02<00:01,  5.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.14it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.14it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.14it/s] 80%|████████  | 20/25 [00:03<00:00,  5.13it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.13it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.14it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.12it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.12it/s]100%|██████████| 25/25 [00:04<00:00,  5.75it/s]100%|██████████| 25/25 [00:04<00:00,  5.47it/s]
Run 00 | Epoch 00145 | Loss 0.3673 | Train 0.7090 | Val 0.7000 | Test 0.5556
Number of nodes during this epoch:  4638219
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427753925323486  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1257963180541992
range selection method range initialization spend 0.024077415466308594
time for parepare:  0.36562395095825195
local_output_nid generation:  0.026162147521972656
local_in_edges_tensor generation:  0.20427584648132324
mini_batch_src_global generation:  0.37787628173828125
r_  generation:  5.75961446762085
local_output_nid generation:  0.029726028442382812
local_in_edges_tensor generation:  0.23235726356506348
mini_batch_src_global generation:  0.4711024761199951
r_  generation:  5.72486424446106
----------------------check_connections_block total spend ----------------------------- 14.83958101272583
generate_one_block  7.267163038253784
generate_one_block  7.159162282943726
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.049476861953735
gen group dst list time:  0.09343433380126953
time for parepare:  0.4750704765319824
local_output_nid generation:  0.2695276737213135
local_in_edges_tensor generation:  1.7748911380767822
mini_batch_src_global generation:  2.519871711730957
r_  generation:  30.590209007263184
local_output_nid generation:  0.5361316204071045
local_in_edges_tensor generation:  2.288407325744629
mini_batch_src_global generation:  3.596550941467285
r_  generation:  30.656321048736572
----------------------check_connections_block total spend ----------------------------- 84.82155132293701
generate_one_block  40.74191761016846
generate_one_block  40.950488567352295
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2623822689056396
gen group dst list time:  0.18995451927185059
time for parepare:  0.5083420276641846
local_output_nid generation:  0.4086592197418213
local_in_edges_tensor generation:  1.5377483367919922
mini_batch_src_global generation:  2.012880325317383
r_  generation:  25.87153673171997
local_output_nid generation:  0.7395286560058594
local_in_edges_tensor generation:  1.935894250869751
mini_batch_src_global generation:  2.882190227508545
r_  generation:  25.835505723953247
----------------------check_connections_block total spend ----------------------------- 71.66979169845581
generate_one_block  34.97929811477661
generate_one_block  35.793176889419556
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427753925323486  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.49134302139282
block generation total time  152.46488118171692
average batch blocks generation time:  76.23244059085846
block dataloader generation time/epoch 367.67266084723275
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39016294479370117 |1.2059822082519531 |0.004380226135253906 |0.00014650821685791016 |0.005114912986755371 |0.0013833045959472656 |
----------------------------------------------------------pseudo_mini_loss sum 0.36748725175857544
Total (block generation + training)time/epoch 371.5149860888311
Training time/epoch 3.6246702671051025
Training time without block to device /epoch 1.2127058506011963
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.44it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.97it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.60it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.87it/s] 40%|████      | 10/25 [00:00<00:00, 18.09it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.21it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.21it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.30it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.25it/s] 80%|████████  | 20/25 [00:01<00:00, 18.29it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.33it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.36it/s]100%|██████████| 25/25 [00:01<00:00, 18.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.45it/s]  8%|▊         | 2/25 [00:00<00:03,  6.53it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.61it/s] 20%|██        | 5/25 [00:00<00:03,  6.62it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.59it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.62it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.60it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.62it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.63it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.60it/s] 60%|██████    | 15/25 [00:02<00:01,  6.58it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.60it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.60it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.60it/s] 80%|████████  | 20/25 [00:03<00:00,  6.59it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.54it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.55it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.57it/s]100%|██████████| 25/25 [00:03<00:00,  6.68it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.83it/s]  8%|▊         | 2/25 [00:00<00:04,  4.95it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.02it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.40it/s] 20%|██        | 5/25 [00:00<00:03,  5.73it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.95it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.09it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.97it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.73it/s] 40%|████      | 10/25 [00:01<00:02,  5.90it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.03it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.15it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.22it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.29it/s] 60%|██████    | 15/25 [00:02<00:01,  6.30it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.23it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.21it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.19it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.26it/s] 80%|████████  | 20/25 [00:03<00:00,  6.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.31it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.30it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.35it/s]100%|██████████| 25/25 [00:04<00:00,  6.18it/s]
Run 00 | Epoch 00146 | Loss 0.3675 | Train 0.7087 | Val 0.6994 | Test 0.5555
Number of nodes during this epoch:  4636819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424980640411377  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1938705444335938
range selection method range initialization spend 0.025316238403320312
time for parepare:  0.36395263671875
local_output_nid generation:  0.026337862014770508
local_in_edges_tensor generation:  0.21654725074768066
mini_batch_src_global generation:  0.3732166290283203
r_  generation:  5.559231996536255
local_output_nid generation:  0.027813434600830078
local_in_edges_tensor generation:  0.21346235275268555
mini_batch_src_global generation:  0.4558546543121338
r_  generation:  5.583333492279053
----------------------check_connections_block total spend ----------------------------- 14.485340595245361
generate_one_block  7.301893472671509
generate_one_block  7.298683166503906
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.955831527709961
gen group dst list time:  0.09049558639526367
time for parepare:  0.4373757839202881
local_output_nid generation:  0.2620689868927002
local_in_edges_tensor generation:  1.7157092094421387
mini_batch_src_global generation:  2.4992425441741943
r_  generation:  29.747944116592407
local_output_nid generation:  0.5231239795684814
local_in_edges_tensor generation:  2.0607006549835205
mini_batch_src_global generation:  3.504718780517578
r_  generation:  29.91445779800415
----------------------check_connections_block total spend ----------------------------- 82.59847593307495
generate_one_block  40.99631428718567
generate_one_block  41.02221083641052
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.254584312438965
gen group dst list time:  0.19634723663330078
time for parepare:  0.4840967655181885
local_output_nid generation:  0.41899585723876953
local_in_edges_tensor generation:  1.7369921207427979
mini_batch_src_global generation:  2.0342187881469727
r_  generation:  26.416465282440186
local_output_nid generation:  0.7363519668579102
local_in_edges_tensor generation:  2.07963490486145
mini_batch_src_global generation:  2.84122633934021
r_  generation:  27.204952239990234
----------------------check_connections_block total spend ----------------------------- 73.93406677246094
generate_one_block  35.38353633880615
generate_one_block  35.64854311943054
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424980640411377  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.5325427055359
block generation total time  153.05060458183289
average batch blocks generation time:  76.52530229091644
block dataloader generation time/epoch 367.6812791110707
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37064850330352783 |1.3091551065444946 |0.004393100738525391 |0.0001550912857055664 |0.005248665809631348 |0.0017154216766357422 |
----------------------------------------------------------pseudo_mini_loss sum 0.36598432064056396
Total (block generation + training)time/epoch 371.52334240829055
Training time/epoch 3.8036561012268066
Training time without block to device /epoch 1.1853458881378174
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.95it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.64it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.13it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.25it/s] 40%|████      | 10/25 [00:00<00:00, 17.30it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.58it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.80it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.01it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.11it/s] 80%|████████  | 20/25 [00:01<00:00, 18.18it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.95it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.07it/s]100%|██████████| 25/25 [00:01<00:00, 17.95it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.82it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.66it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.96it/s] 20%|██        | 5/25 [00:00<00:03,  6.18it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.58it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.90it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.14it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.70it/s] 40%|████      | 10/25 [00:01<00:02,  5.93it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.10it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.26it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.56it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.12it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.77it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.55it/s] 80%|████████  | 20/25 [00:03<00:00,  5.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.27it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.24it/s]100%|██████████| 25/25 [00:04<00:00,  5.97it/s]100%|██████████| 25/25 [00:04<00:00,  5.88it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.39it/s]  8%|▊         | 2/25 [00:00<00:03,  6.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.42it/s] 20%|██        | 5/25 [00:00<00:03,  6.41it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.58it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.19it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.76it/s] 40%|████      | 10/25 [00:01<00:02,  5.99it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.11it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.30it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.33it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.44it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.41it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.46it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.31it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.97it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.72it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.80it/s]100%|██████████| 25/25 [00:04<00:00,  6.61it/s]100%|██████████| 25/25 [00:04<00:00,  6.17it/s]
Run 00 | Epoch 00147 | Loss 0.3660 | Train 0.7075 | Val 0.6984 | Test 0.5548
Number of nodes during this epoch:  4637740
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424516677856445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0978939533233643
range selection method range initialization spend 0.02686619758605957
time for parepare:  0.36449241638183594
local_output_nid generation:  0.02584218978881836
local_in_edges_tensor generation:  0.20197153091430664
mini_batch_src_global generation:  0.36771345138549805
r_  generation:  5.363790988922119
local_output_nid generation:  0.027372360229492188
local_in_edges_tensor generation:  0.21194720268249512
mini_batch_src_global generation:  0.4564857482910156
r_  generation:  5.623398303985596
----------------------check_connections_block total spend ----------------------------- 14.264162540435791
generate_one_block  7.259401321411133
generate_one_block  6.893662691116333
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.120861053466797
gen group dst list time:  0.09093141555786133
time for parepare:  0.44359850883483887
local_output_nid generation:  0.2593092918395996
local_in_edges_tensor generation:  1.668708086013794
mini_batch_src_global generation:  2.4978957176208496
r_  generation:  30.09464716911316
local_output_nid generation:  0.5335426330566406
local_in_edges_tensor generation:  2.0657334327697754
mini_batch_src_global generation:  3.513051748275757
r_  generation:  30.204238414764404
----------------------check_connections_block total spend ----------------------------- 83.25644183158875
generate_one_block  41.13557243347168
generate_one_block  41.21014881134033
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.240671396255493
gen group dst list time:  0.19251394271850586
time for parepare:  0.4638702869415283
local_output_nid generation:  0.3913917541503906
local_in_edges_tensor generation:  1.5559556484222412
mini_batch_src_global generation:  2.197751522064209
r_  generation:  26.441569089889526
local_output_nid generation:  0.7377355098724365
local_in_edges_tensor generation:  1.936628818511963
mini_batch_src_global generation:  2.832165002822876
r_  generation:  26.170746326446533
----------------------check_connections_block total spend ----------------------------- 72.84839034080505
generate_one_block  35.170305252075195
generate_one_block  35.94021010398865
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424516677856445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.1048321723938
block generation total time  153.45623660087585
average batch blocks generation time:  76.72811830043793
block dataloader generation time/epoch 367.68011440135336
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3752295970916748 |1.2942123413085938 |0.004467606544494629 |0.00015044212341308594 |0.005091667175292969 |0.0013835430145263672 |
----------------------------------------------------------pseudo_mini_loss sum 0.36682775616645813
Total (block generation + training)time/epoch 371.52168614316633
Training time/epoch 3.7691218852996826
Training time without block to device /epoch 1.1806972026824951
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.15it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.77it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.41it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.66it/s] 40%|████      | 10/25 [00:00<00:00, 17.66it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.51it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.64it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.56it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.68it/s] 80%|████████  | 20/25 [00:01<00:00, 17.83it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.97it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.84it/s]100%|██████████| 25/25 [00:01<00:00, 17.83it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.01it/s]  8%|▊         | 2/25 [00:00<00:04,  5.00it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.96it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.79it/s] 20%|██        | 5/25 [00:01<00:04,  4.70it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.87it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.09it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.96it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.28it/s] 40%|████      | 10/25 [00:01<00:02,  5.63it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.47it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.50it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.56it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.83it/s] 60%|██████    | 15/25 [00:02<00:01,  6.08it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.24it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.57it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.45it/s] 80%|████████  | 20/25 [00:03<00:00,  5.23it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.56it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.86it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.06it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.21it/s]100%|██████████| 25/25 [00:04<00:00,  5.65it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  6.00it/s]  8%|▊         | 2/25 [00:00<00:03,  6.19it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.14it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.18it/s] 20%|██        | 5/25 [00:00<00:03,  6.16it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.27it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.23it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.40it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.01it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.93it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.03it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.16it/s] 60%|██████    | 15/25 [00:02<00:01,  6.26it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.97it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.08it/s] 80%|████████  | 20/25 [00:03<00:00,  6.17it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.32it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:03<00:00,  6.32it/s]
Run 00 | Epoch 00148 | Loss 0.3668 | Train 0.7067 | Val 0.6979 | Test 0.5543
Number of nodes during this epoch:  4637899
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425125598907471  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1075553894042969
range selection method range initialization spend 0.02466869354248047
time for parepare:  0.36528491973876953
local_output_nid generation:  0.027216434478759766
local_in_edges_tensor generation:  0.2060854434967041
mini_batch_src_global generation:  0.373854398727417
r_  generation:  5.522965908050537
local_output_nid generation:  0.028084754943847656
local_in_edges_tensor generation:  0.2529745101928711
mini_batch_src_global generation:  0.5646252632141113
r_  generation:  5.5909647941589355
----------------------check_connections_block total spend ----------------------------- 14.582847595214844
generate_one_block  7.315946817398071
generate_one_block  7.202566146850586
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.176968574523926
gen group dst list time:  0.09430336952209473
time for parepare:  0.43956923484802246
local_output_nid generation:  0.26481008529663086
local_in_edges_tensor generation:  1.6704928874969482
mini_batch_src_global generation:  2.477628707885742
r_  generation:  29.895177602767944
local_output_nid generation:  0.525170087814331
local_in_edges_tensor generation:  2.0713789463043213
mini_batch_src_global generation:  3.5093493461608887
r_  generation:  30.15369176864624
----------------------check_connections_block total spend ----------------------------- 82.83026576042175
generate_one_block  41.06156635284424
generate_one_block  41.19644117355347
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.145383596420288
gen group dst list time:  0.18709802627563477
time for parepare:  0.47318577766418457
local_output_nid generation:  0.388444185256958
local_in_edges_tensor generation:  1.620124101638794
mini_batch_src_global generation:  2.0742077827453613
r_  generation:  26.196218967437744
local_output_nid generation:  0.7445476055145264
local_in_edges_tensor generation:  2.0718138217926025
mini_batch_src_global generation:  2.929595947265625
r_  generation:  26.3845112323761
----------------------check_connections_block total spend ----------------------------- 72.78433775901794
generate_one_block  35.32434964179993
generate_one_block  36.184919595718384
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425125598907471  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.6146035194397
block generation total time  153.76727676391602
average batch blocks generation time:  76.88363838195801
block dataloader generation time/epoch 367.68701498620464
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3929600715637207 |1.3049938678741455 |0.0049631595611572266 |0.0001748800277709961 |0.005096793174743652 |0.001796722412109375 |
----------------------------------------------------------pseudo_mini_loss sum 0.3650842308998108
Total (block generation + training)time/epoch 371.5284862934343
Training time/epoch 3.8264098167419434
Training time without block to device /epoch 1.2164220809936523
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.08it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.79it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.48it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.57it/s] 40%|████      | 10/25 [00:00<00:00, 17.84it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.94it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.06it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.11it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.17it/s] 80%|████████  | 20/25 [00:01<00:00, 18.21it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.21it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.21it/s]100%|██████████| 25/25 [00:01<00:00, 18.16it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.06it/s]  8%|▊         | 2/25 [00:00<00:03,  6.33it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.80it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.54it/s] 20%|██        | 5/25 [00:00<00:03,  5.37it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.34it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.28it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.25it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.23it/s] 40%|████      | 10/25 [00:01<00:02,  5.20it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.18it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.17it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.16it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.15it/s] 60%|██████    | 15/25 [00:02<00:01,  5.15it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.16it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.17it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.39it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.69it/s] 80%|████████  | 20/25 [00:03<00:00,  5.90it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.75it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.95it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.54it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.73it/s]100%|██████████| 25/25 [00:04<00:00,  5.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.25it/s]  8%|▊         | 2/25 [00:00<00:04,  5.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.94it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.31it/s] 20%|██        | 5/25 [00:00<00:03,  5.78it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.50it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.32it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.17it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.85it/s] 40%|████      | 10/25 [00:01<00:02,  5.30it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.70it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.00it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.70it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.49it/s] 60%|██████    | 15/25 [00:02<00:01,  5.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.24it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.89it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.74it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.69it/s] 80%|████████  | 20/25 [00:03<00:01,  4.59it/s] 84%|████████▍ | 21/25 [00:04<00:00,  4.96it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.35it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.54it/s]100%|██████████| 25/25 [00:04<00:00,  5.41it/s]
Run 00 | Epoch 00149 | Loss 0.3651 | Train 0.7065 | Val 0.6976 | Test 0.5538
Number of nodes during this epoch:  4638379
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428401947021484  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0878832340240479
range selection method range initialization spend 0.02586531639099121
time for parepare:  0.3626244068145752
local_output_nid generation:  0.02594614028930664
local_in_edges_tensor generation:  0.18395781517028809
mini_batch_src_global generation:  0.36025047302246094
r_  generation:  5.298230409622192
local_output_nid generation:  0.027129173278808594
local_in_edges_tensor generation:  0.2129204273223877
mini_batch_src_global generation:  0.4582517147064209
r_  generation:  5.622185468673706
----------------------check_connections_block total spend ----------------------------- 14.134901762008667
generate_one_block  7.261185646057129
generate_one_block  6.8804097175598145
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9934370517730713
gen group dst list time:  0.09043121337890625
time for parepare:  0.4468357563018799
local_output_nid generation:  0.25925397872924805
local_in_edges_tensor generation:  1.6200065612792969
mini_batch_src_global generation:  2.532784938812256
r_  generation:  29.951619863510132
local_output_nid generation:  0.5372834205627441
local_in_edges_tensor generation:  2.1873862743377686
mini_batch_src_global generation:  3.7442007064819336
r_  generation:  30.118093967437744
----------------------check_connections_block total spend ----------------------------- 83.41800308227539
generate_one_block  40.98474049568176
generate_one_block  40.9382860660553
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3662967681884766
gen group dst list time:  0.1885967254638672
time for parepare:  0.5234634876251221
local_output_nid generation:  0.4223816394805908
local_in_edges_tensor generation:  1.628089427947998
mini_batch_src_global generation:  2.076430320739746
r_  generation:  26.437507390975952
local_output_nid generation:  0.7698571681976318
local_in_edges_tensor generation:  2.211359977722168
mini_batch_src_global generation:  2.859346628189087
r_  generation:  26.234612464904785
----------------------check_connections_block total spend ----------------------------- 73.76015853881836
generate_one_block  35.34905934333801
generate_one_block  36.23823094367981
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428401947021484  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.17816162109375
block generation total time  153.51031684875488
average batch blocks generation time:  76.75515842437744
block dataloader generation time/epoch 367.69189419746397
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4012489318847656 |1.333532691001892 |0.004413723945617676 |0.00015103816986083984 |0.005108356475830078 |0.003069639205932617 |
----------------------------------------------------------pseudo_mini_loss sum 0.36495068669319153
Total (block generation + training)time/epoch 371.5337616570791
Training time/epoch 3.9007186889648438
Training time without block to device /epoch 1.2336533069610596
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.23it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.70it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.77it/s] 40%|████      | 10/25 [00:00<00:01, 14.03it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.19it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.84it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.27it/s] 80%|████████  | 20/25 [00:01<00:00, 17.65it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.83it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.93it/s]100%|██████████| 25/25 [00:01<00:00, 17.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.52it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.56it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.57it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.60it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.15it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.80it/s] 40%|████      | 10/25 [00:01<00:02,  5.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.44it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.37it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.30it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.26it/s] 60%|██████    | 15/25 [00:02<00:01,  5.24it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.24it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.20it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.19it/s] 80%|████████  | 20/25 [00:03<00:00,  5.19it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.17it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.13it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.14it/s]100%|██████████| 25/25 [00:04<00:00,  5.71it/s]100%|██████████| 25/25 [00:04<00:00,  5.58it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.83it/s]  8%|▊         | 2/25 [00:00<00:04,  5.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.63it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.82it/s] 20%|██        | 5/25 [00:00<00:03,  5.16it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.54it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.70it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.90it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.06it/s] 40%|████      | 10/25 [00:01<00:02,  6.18it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.26it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.29it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.30it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.24it/s] 60%|██████    | 15/25 [00:02<00:01,  6.22it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.22it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.23it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.21it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.26it/s] 80%|████████  | 20/25 [00:03<00:00,  6.03it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.80it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.82it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.97it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.14it/s]100%|██████████| 25/25 [00:04<00:00,  6.05it/s]
Run 00 | Epoch 00150 | Loss 0.3650 | Train 0.7066 | Val 0.6979 | Test 0.5537
Number of nodes during this epoch:  4636818
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423242568969727  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1346631050109863
range selection method range initialization spend 0.03585672378540039
time for parepare:  0.37482666969299316
local_output_nid generation:  0.026456356048583984
local_in_edges_tensor generation:  0.21845459938049316
mini_batch_src_global generation:  0.3769364356994629
r_  generation:  5.690992593765259
local_output_nid generation:  0.03046584129333496
local_in_edges_tensor generation:  0.23293566703796387
mini_batch_src_global generation:  0.46384716033935547
r_  generation:  5.9138336181640625
----------------------check_connections_block total spend ----------------------------- 15.00745964050293
generate_one_block  7.226901292800903
generate_one_block  6.976175546646118
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.897465944290161
gen group dst list time:  0.08826351165771484
time for parepare:  0.45589709281921387
local_output_nid generation:  0.25829625129699707
local_in_edges_tensor generation:  1.647221326828003
mini_batch_src_global generation:  2.5466818809509277
r_  generation:  30.010793685913086
local_output_nid generation:  0.5306081771850586
local_in_edges_tensor generation:  2.102773666381836
mini_batch_src_global generation:  3.5598104000091553
r_  generation:  30.209835290908813
----------------------check_connections_block total spend ----------------------------- 83.46473550796509
generate_one_block  40.703359842300415
generate_one_block  41.066157579422
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1083295345306396
gen group dst list time:  0.18380522727966309
time for parepare:  0.46909093856811523
local_output_nid generation:  0.3688170909881592
local_in_edges_tensor generation:  1.4770009517669678
mini_batch_src_global generation:  2.0854241847991943
r_  generation:  25.683553218841553
local_output_nid generation:  0.738926887512207
local_in_edges_tensor generation:  1.9440014362335205
mini_batch_src_global generation:  2.994051218032837
r_  generation:  26.039413452148438
----------------------check_connections_block total spend ----------------------------- 71.89533710479736
generate_one_block  35.4109320640564
generate_one_block  36.15404272079468
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423242568969727  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.36007261276245
block generation total time  153.3344922065735
average batch blocks generation time:  76.66724610328674
block dataloader generation time/epoch 367.6922106853384
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38396692276000977 |1.294952154159546 |0.004627227783203125 |0.00016510486602783203 |0.00511622428894043 |0.00299072265625 |
----------------------------------------------------------pseudo_mini_loss sum 0.3646456003189087
Total (block generation + training)time/epoch 371.53372792376587
Training time/epoch 3.7887916564941406
Training time without block to device /epoch 1.1988873481750488
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.33it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.84it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.51it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.85it/s] 40%|████      | 10/25 [00:00<00:00, 18.08it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.18it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.14it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.61it/s] 80%|████████  | 20/25 [00:01<00:00, 17.78it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.90it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.81it/s]100%|██████████| 25/25 [00:01<00:00, 18.02it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.61it/s]  8%|▊         | 2/25 [00:00<00:03,  6.62it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.59it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.88it/s] 20%|██        | 5/25 [00:00<00:03,  6.11it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.28it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.41it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.58it/s] 40%|████      | 10/25 [00:01<00:02,  6.63it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.65it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.68it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.63it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.63it/s] 60%|██████    | 15/25 [00:02<00:01,  6.67it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.67it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.67it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.66it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.63it/s] 80%|████████  | 20/25 [00:03<00:00,  6.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.62it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.63it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.62it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.60it/s]100%|██████████| 25/25 [00:03<00:00,  7.34it/s]100%|██████████| 25/25 [00:03<00:00,  6.65it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.34it/s]  8%|▊         | 2/25 [00:00<00:03,  6.51it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.51it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.56it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.55it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.57it/s] 40%|████      | 10/25 [00:01<00:02,  6.59it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.28it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.14it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.27it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.17it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.25it/s] 80%|████████  | 20/25 [00:03<00:00,  6.24it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.29it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.24it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.27it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.32it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00151 | Loss 0.3646 | Train 0.7077 | Val 0.6990 | Test 0.5547
Number of nodes during this epoch:  4637791
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4284257888793945  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0965800285339355
range selection method range initialization spend 0.025422334671020508
time for parepare:  0.3674812316894531
local_output_nid generation:  0.026225805282592773
local_in_edges_tensor generation:  0.21421027183532715
mini_batch_src_global generation:  0.3650217056274414
r_  generation:  5.426342725753784
local_output_nid generation:  0.028072834014892578
local_in_edges_tensor generation:  0.19553112983703613
mini_batch_src_global generation:  0.4605545997619629
r_  generation:  5.557918071746826
----------------------check_connections_block total spend ----------------------------- 14.28910207748413
generate_one_block  7.25834846496582
generate_one_block  6.913468599319458
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.118510007858276
gen group dst list time:  0.09810733795166016
time for parepare:  0.4555537700653076
local_output_nid generation:  0.2615950107574463
local_in_edges_tensor generation:  1.8280930519104004
mini_batch_src_global generation:  2.449350118637085
r_  generation:  29.535511016845703
local_output_nid generation:  0.5253527164459229
local_in_edges_tensor generation:  2.143484115600586
mini_batch_src_global generation:  3.5191521644592285
r_  generation:  29.945250272750854
----------------------check_connections_block total spend ----------------------------- 82.5545506477356
generate_one_block  40.934900760650635
generate_one_block  41.15393590927124
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1955881118774414
gen group dst list time:  0.19469380378723145
time for parepare:  0.47089338302612305
local_output_nid generation:  0.41892004013061523
local_in_edges_tensor generation:  1.5316252708435059
mini_batch_src_global generation:  2.205867290496826
r_  generation:  26.38426423072815
local_output_nid generation:  0.730860710144043
local_in_edges_tensor generation:  1.9460291862487793
mini_batch_src_global generation:  2.8447890281677246
r_  generation:  26.258673191070557
----------------------check_connections_block total spend ----------------------------- 72.78296041488647
generate_one_block  35.33002185821533
generate_one_block  35.98920822143555
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4284257888793945  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.33751106262207
block generation total time  153.40806674957275
average batch blocks generation time:  76.70403337478638
block dataloader generation time/epoch 367.687170806684
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38310086727142334 |1.2476890087127686 |0.004407048225402832 |0.00015854835510253906 |0.005084991455078125 |0.0013926029205322266 |
----------------------------------------------------------pseudo_mini_loss sum 0.3636477589607239
Total (block generation + training)time/epoch 371.52769778276746
Training time/epoch 3.6908278465270996
Training time without block to device /epoch 1.1954498291015625
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.79it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.20it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.49it/s] 40%|████      | 10/25 [00:00<00:00, 17.77it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.85it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.86it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.92it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.93it/s] 80%|████████  | 20/25 [00:01<00:00, 18.01it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.92it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.86it/s]100%|██████████| 25/25 [00:01<00:00, 17.73it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.40it/s]  8%|▊         | 2/25 [00:00<00:03,  6.51it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.88it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.58it/s] 20%|██        | 5/25 [00:00<00:03,  5.32it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.25it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.05it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.83it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.91it/s] 40%|████      | 10/25 [00:01<00:02,  5.12it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.37it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.61it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.84it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.00it/s] 60%|██████    | 15/25 [00:02<00:01,  6.15it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.21it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.35it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.18it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.87it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.01it/s]100%|██████████| 25/25 [00:04<00:00,  5.92it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.36it/s]  8%|▊         | 2/25 [00:00<00:04,  5.75it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.99it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.14it/s] 20%|██        | 5/25 [00:00<00:03,  6.25it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.23it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.22it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.20it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.19it/s] 40%|████      | 10/25 [00:01<00:02,  6.21it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.20it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.25it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.30it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.33it/s] 60%|██████    | 15/25 [00:02<00:01,  6.36it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.37it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.39it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.30it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.31it/s]100%|██████████| 25/25 [00:03<00:00,  6.40it/s]
Run 00 | Epoch 00152 | Loss 0.3636 | Train 0.7081 | Val 0.6998 | Test 0.5553
Number of nodes during this epoch:  4637944
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.43149471282959  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1666691303253174
range selection method range initialization spend 0.02570176124572754
time for parepare:  0.3680126667022705
local_output_nid generation:  0.027309179306030273
local_in_edges_tensor generation:  0.23426032066345215
mini_batch_src_global generation:  0.37439393997192383
r_  generation:  5.666672229766846
local_output_nid generation:  0.02901291847229004
local_in_edges_tensor generation:  0.2342524528503418
mini_batch_src_global generation:  0.47632789611816406
r_  generation:  5.894774436950684
----------------------check_connections_block total spend ----------------------------- 15.019113540649414
generate_one_block  7.238495826721191
generate_one_block  6.97467565536499
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9744820594787598
gen group dst list time:  0.09410548210144043
time for parepare:  0.45351433753967285
local_output_nid generation:  0.2738182544708252
local_in_edges_tensor generation:  1.7631745338439941
mini_batch_src_global generation:  2.509636640548706
r_  generation:  29.9381365776062
local_output_nid generation:  0.5313079357147217
local_in_edges_tensor generation:  2.3554718494415283
mini_batch_src_global generation:  3.7291533946990967
r_  generation:  29.978312492370605
----------------------check_connections_block total spend ----------------------------- 83.52575254440308
generate_one_block  40.625080585479736
generate_one_block  41.86651849746704
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3244709968566895
gen group dst list time:  0.18305611610412598
time for parepare:  0.46743106842041016
local_output_nid generation:  0.40688014030456543
local_in_edges_tensor generation:  1.5078988075256348
mini_batch_src_global generation:  2.2355191707611084
r_  generation:  26.332687377929688
local_output_nid generation:  0.7266759872436523
local_in_edges_tensor generation:  1.9088170528411865
mini_batch_src_global generation:  2.838822603225708
r_  generation:  25.969607830047607
----------------------check_connections_block total spend ----------------------------- 72.55208826065063
generate_one_block  35.14494872093201
generate_one_block  36.05196499824524
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.43149471282959  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.0778408050537
block generation total time  153.68851280212402
average batch blocks generation time:  76.84425640106201
block dataloader generation time/epoch 367.69730682310717
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3843874931335449 |1.203580617904663 |0.004407048225402832 |0.00014913082122802734 |0.005117654800415039 |0.0018258094787597656 |
----------------------------------------------------------pseudo_mini_loss sum 0.36209630966186523
Total (block generation + training)time/epoch 371.53632991921666
Training time/epoch 3.6102631092071533
Training time without block to device /epoch 1.2031018733978271
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.68it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.32it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.65it/s] 40%|████      | 10/25 [00:00<00:00, 17.86it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.86it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.94it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.14it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.22it/s] 80%|████████  | 20/25 [00:01<00:00, 18.26it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.31it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.33it/s]100%|██████████| 25/25 [00:01<00:00, 18.20it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.54it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.94it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.64it/s] 20%|██        | 5/25 [00:00<00:03,  5.49it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.37it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.33it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.29it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.27it/s] 40%|████      | 10/25 [00:01<00:02,  5.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.85it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.68it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.52it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.42it/s] 60%|██████    | 15/25 [00:02<00:01,  5.34it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.28it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.02it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.07it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.17it/s] 80%|████████  | 20/25 [00:03<00:00,  5.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.60it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.83it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.03it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.14it/s]100%|██████████| 25/25 [00:04<00:00,  5.71it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.45it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.54it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.70it/s] 40%|████      | 10/25 [00:01<00:02,  5.93it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.09it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.17it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.26it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.29it/s] 60%|██████    | 15/25 [00:02<00:01,  6.15it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.80it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.77it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.84it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.97it/s] 80%|████████  | 20/25 [00:03<00:00,  6.02it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.11it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.25it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
Run 00 | Epoch 00153 | Loss 0.3621 | Train 0.7076 | Val 0.6990 | Test 0.5548
Number of nodes during this epoch:  4637431
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427135467529297  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1342949867248535
range selection method range initialization spend 0.023813724517822266
time for parepare:  0.3699202537536621
local_output_nid generation:  0.026343107223510742
local_in_edges_tensor generation:  0.21771693229675293
mini_batch_src_global generation:  0.37671446800231934
r_  generation:  5.71450400352478
local_output_nid generation:  0.029185056686401367
local_in_edges_tensor generation:  0.233809232711792
mini_batch_src_global generation:  0.4610133171081543
r_  generation:  5.908705234527588
----------------------check_connections_block total spend ----------------------------- 15.025646209716797
generate_one_block  7.241484642028809
generate_one_block  6.898662090301514
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.027544736862183
gen group dst list time:  0.0887308120727539
time for parepare:  0.47116589546203613
local_output_nid generation:  0.2812480926513672
local_in_edges_tensor generation:  1.6547374725341797
mini_batch_src_global generation:  2.6402244567871094
r_  generation:  30.460026502609253
local_output_nid generation:  0.5375988483428955
local_in_edges_tensor generation:  2.1094374656677246
mini_batch_src_global generation:  3.7620372772216797
r_  generation:  30.34875726699829
----------------------check_connections_block total spend ----------------------------- 84.32786226272583
generate_one_block  41.370437145233154
generate_one_block  40.79501247406006
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3830580711364746
gen group dst list time:  0.1994781494140625
time for parepare:  0.4987783432006836
local_output_nid generation:  0.44453001022338867
local_in_edges_tensor generation:  1.5428223609924316
mini_batch_src_global generation:  2.0014727115631104
r_  generation:  25.700448274612427
local_output_nid generation:  0.7317321300506592
local_in_edges_tensor generation:  2.0279500484466553
mini_batch_src_global generation:  2.8242790699005127
r_  generation:  25.768925666809082
----------------------check_connections_block total spend ----------------------------- 71.60344934463501
generate_one_block  35.12788486480713
generate_one_block  35.808966875076294
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427135467529297  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.93131160736084
block generation total time  153.10230135917664
average batch blocks generation time:  76.55115067958832
block dataloader generation time/epoch 367.7011894870114
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4090360403060913 |1.2071295976638794 |0.004291176795959473 |0.00014984607696533203 |0.00500643253326416 |0.003152608871459961 |
----------------------------------------------------------pseudo_mini_loss sum 0.36330947279930115
Total (block generation + training)time/epoch 371.53910540450704
Training time/epoch 3.6683475971221924
Training time without block to device /epoch 1.2540884017944336
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.43it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.04it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.52it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.75it/s] 40%|████      | 10/25 [00:00<00:00, 18.01it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.10it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.29it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.36it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.40it/s] 80%|████████  | 20/25 [00:01<00:00, 18.46it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.45it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.48it/s]100%|██████████| 25/25 [00:01<00:00, 18.39it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.55it/s]  8%|▊         | 2/25 [00:00<00:03,  6.53it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.62it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.59it/s] 40%|████      | 10/25 [00:01<00:02,  6.58it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.60it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.60it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.62it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.60it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.61it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.58it/s] 80%|████████  | 20/25 [00:03<00:00,  6.58it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.58it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.58it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  6.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.26it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.35it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.11it/s] 40%|████      | 10/25 [00:01<00:02,  6.21it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.22it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.08it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.14it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.23it/s] 60%|██████    | 15/25 [00:02<00:01,  6.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.39it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.41it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.49it/s]
Run 00 | Epoch 00154 | Loss 0.3633 | Train 0.7070 | Val 0.6986 | Test 0.5544
Number of nodes during this epoch:  4638011
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423129081726074  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0952365398406982
range selection method range initialization spend 0.024575233459472656
time for parepare:  0.37384963035583496
local_output_nid generation:  0.02591395378112793
local_in_edges_tensor generation:  0.20562505722045898
mini_batch_src_global generation:  0.3672475814819336
r_  generation:  5.322039604187012
local_output_nid generation:  0.02651524543762207
local_in_edges_tensor generation:  0.19112277030944824
mini_batch_src_global generation:  0.46038079261779785
r_  generation:  5.526349067687988
----------------------check_connections_block total spend ----------------------------- 14.14627742767334
generate_one_block  7.0308451652526855
generate_one_block  6.8407182693481445
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9812960624694824
gen group dst list time:  0.0842890739440918
time for parepare:  0.432187557220459
local_output_nid generation:  0.2736830711364746
local_in_edges_tensor generation:  1.6107048988342285
mini_batch_src_global generation:  2.5170345306396484
r_  generation:  30.25731086730957
local_output_nid generation:  0.5211987495422363
local_in_edges_tensor generation:  2.126645088195801
mini_batch_src_global generation:  3.5074970722198486
r_  generation:  29.95919680595398
----------------------check_connections_block total spend ----------------------------- 83.79932570457458
generate_one_block  40.501612424850464
generate_one_block  40.55909180641174
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2050068378448486
gen group dst list time:  0.1832902431488037
time for parepare:  0.45826196670532227
local_output_nid generation:  0.3750326633453369
local_in_edges_tensor generation:  1.4649977684020996
mini_batch_src_global generation:  2.0258758068084717
r_  generation:  25.913724899291992
local_output_nid generation:  0.7354862689971924
local_in_edges_tensor generation:  1.9261746406555176
mini_batch_src_global generation:  2.9782707691192627
r_  generation:  25.899667978286743
----------------------check_connections_block total spend ----------------------------- 71.82736849784851
generate_one_block  35.302780628204346
generate_one_block  36.043591022491455
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423129081726074  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.6266942024231
block generation total time  152.407075881958
average batch blocks generation time:  76.203537940979
block dataloader generation time/epoch 367.6827985978896
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38165247440338135 |1.2951457500457764 |0.004468083381652832 |0.0001499652862548828 |0.0051642656326293945 |0.0016179084777832031 |
----------------------------------------------------------pseudo_mini_loss sum 0.3638352155685425
Total (block generation + training)time/epoch 371.52034521102905
Training time/epoch 3.7804811000823975
Training time without block to device /epoch 1.1901895999908447
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.41it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.88it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.95it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.45it/s] 40%|████      | 10/25 [00:00<00:01, 13.01it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.39it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.17it/s] 64%|██████▍   | 16/25 [00:01<00:00, 15.70it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.23it/s] 80%|████████  | 20/25 [00:01<00:00, 16.62it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.87it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.90it/s]100%|██████████| 25/25 [00:01<00:00, 16.31it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.27it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.45it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.51it/s] 20%|██        | 5/25 [00:00<00:03,  6.55it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.56it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.11it/s] 40%|████      | 10/25 [00:01<00:02,  5.78it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.58it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.44it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.35it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.30it/s] 60%|██████    | 15/25 [00:02<00:01,  5.23it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.21it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.16it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.01it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.95it/s] 80%|████████  | 20/25 [00:03<00:01,  4.77it/s] 84%|████████▍ | 21/25 [00:03<00:00,  4.92it/s] 88%|████████▊ | 22/25 [00:04<00:00,  4.73it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.03it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  6.12it/s]100%|██████████| 25/25 [00:04<00:00,  5.58it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.38it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.89it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.72it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.83it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.91it/s] 40%|████      | 10/25 [00:01<00:02,  6.04it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.13it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.25it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.32it/s]100%|██████████| 25/25 [00:03<00:00,  7.09it/s]100%|██████████| 25/25 [00:03<00:00,  6.36it/s]
Run 00 | Epoch 00155 | Loss 0.3638 | Train 0.7073 | Val 0.6989 | Test 0.5545
Number of nodes during this epoch:  4638278
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423868179321289  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1541385650634766
range selection method range initialization spend 0.024231910705566406
time for parepare:  0.3799009323120117
local_output_nid generation:  0.02669978141784668
local_in_edges_tensor generation:  0.24823808670043945
mini_batch_src_global generation:  0.37709546089172363
r_  generation:  5.618136405944824
local_output_nid generation:  0.028614044189453125
local_in_edges_tensor generation:  0.23229694366455078
mini_batch_src_global generation:  0.47339439392089844
r_  generation:  5.590593576431274
----------------------check_connections_block total spend ----------------------------- 14.643146753311157
generate_one_block  7.297702074050903
generate_one_block  7.186103582382202
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9792511463165283
gen group dst list time:  0.0879983901977539
time for parepare:  0.4630849361419678
local_output_nid generation:  0.2591426372528076
local_in_edges_tensor generation:  1.7855944633483887
mini_batch_src_global generation:  2.5191080570220947
r_  generation:  29.848187685012817
local_output_nid generation:  0.5466628074645996
local_in_edges_tensor generation:  2.1624350547790527
mini_batch_src_global generation:  3.788755416870117
r_  generation:  29.97711420059204
----------------------check_connections_block total spend ----------------------------- 83.28887796401978
generate_one_block  41.28894782066345
generate_one_block  41.431601762771606
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2114737033843994
gen group dst list time:  0.1819148063659668
time for parepare:  0.44785475730895996
local_output_nid generation:  0.38466525077819824
local_in_edges_tensor generation:  1.478266954421997
mini_batch_src_global generation:  2.0976951122283936
r_  generation:  25.98986506462097
local_output_nid generation:  0.7193214893341064
local_in_edges_tensor generation:  1.9022395610809326
mini_batch_src_global generation:  2.819408893585205
r_  generation:  26.06924867630005
----------------------check_connections_block total spend ----------------------------- 72.05955243110657
generate_one_block  34.96932077407837
generate_one_block  35.71172642707825
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423868179321289  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.34843039512634
block generation total time  153.40159678459167
average batch blocks generation time:  76.70079839229584
block dataloader generation time/epoch 367.68196125213916
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.375942587852478 |1.211241602897644 |0.004315376281738281 |0.00014674663543701172 |0.005017876625061035 |0.0029840469360351562 |
----------------------------------------------------------pseudo_mini_loss sum 0.3621128797531128
Total (block generation + training)time/epoch 371.5180718195744
Training time/epoch 3.6133549213409424
Training time without block to device /epoch 1.1908717155456543
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.64it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.38it/s] 40%|████      | 10/25 [00:00<00:00, 17.70it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.94it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.94it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.03it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.97it/s] 80%|████████  | 20/25 [00:01<00:00, 17.93it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.05it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.09it/s]100%|██████████| 25/25 [00:01<00:00, 18.01it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.78it/s]  8%|▊         | 2/25 [00:00<00:03,  6.74it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.78it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.79it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.64it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.68it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.72it/s] 40%|████      | 10/25 [00:01<00:02,  6.75it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.57it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.57it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.07it/s] 60%|██████    | 15/25 [00:02<00:01,  5.46it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.21it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.47it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.79it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.61it/s] 80%|████████  | 20/25 [00:03<00:00,  5.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.15it/s] 88%|████████▊ | 22/25 [00:03<00:00,  4.87it/s] 92%|█████████▏| 23/25 [00:03<00:00,  4.92it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.90it/s]100%|██████████| 25/25 [00:04<00:00,  5.70it/s]100%|██████████| 25/25 [00:04<00:00,  5.88it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.19it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.52it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.61it/s] 20%|██        | 5/25 [00:00<00:02,  6.68it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.05it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.69it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.49it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.37it/s] 40%|████      | 10/25 [00:01<00:02,  5.22it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.08it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.98it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.91it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.90it/s] 60%|██████    | 15/25 [00:02<00:01,  5.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.69it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.93it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.13it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.25it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.59it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.64it/s]100%|██████████| 25/25 [00:04<00:00,  6.00it/s]
Run 00 | Epoch 00156 | Loss 0.3621 | Train 0.7068 | Val 0.6982 | Test 0.5541
Number of nodes during this epoch:  4637633
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427137851715088  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1160218715667725
range selection method range initialization spend 0.03679990768432617
time for parepare:  0.37741971015930176
local_output_nid generation:  0.02608323097229004
local_in_edges_tensor generation:  0.23476576805114746
mini_batch_src_global generation:  0.3773634433746338
r_  generation:  5.6600117683410645
local_output_nid generation:  0.03107905387878418
local_in_edges_tensor generation:  0.23604106903076172
mini_batch_src_global generation:  0.4771389961242676
r_  generation:  5.927783250808716
----------------------check_connections_block total spend ----------------------------- 15.061394214630127
generate_one_block  7.243587017059326
generate_one_block  6.937650203704834
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9339606761932373
gen group dst list time:  0.1063086986541748
time for parepare:  0.4696528911590576
local_output_nid generation:  0.2510693073272705
local_in_edges_tensor generation:  1.621046543121338
mini_batch_src_global generation:  2.5459063053131104
r_  generation:  29.95551300048828
local_output_nid generation:  0.5203835964202881
local_in_edges_tensor generation:  2.1387550830841064
mini_batch_src_global generation:  3.551501512527466
r_  generation:  30.155330896377563
----------------------check_connections_block total spend ----------------------------- 83.41671872138977
generate_one_block  40.76990008354187
generate_one_block  41.16640019416809
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2516348361968994
gen group dst list time:  0.1958296298980713
time for parepare:  0.48916006088256836
local_output_nid generation:  0.39038848876953125
local_in_edges_tensor generation:  1.5982275009155273
mini_batch_src_global generation:  2.051490306854248
r_  generation:  26.127366304397583
local_output_nid generation:  0.7189652919769287
local_in_edges_tensor generation:  1.946526288986206
mini_batch_src_global generation:  2.819748878479004
r_  generation:  26.134174823760986
----------------------check_connections_block total spend ----------------------------- 72.31324434280396
generate_one_block  35.41488528251648
generate_one_block  35.87182855606079
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427137851715088  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.72996306419373
block generation total time  153.22301411628723
average batch blocks generation time:  76.61150705814362
block dataloader generation time/epoch 367.6883799908268
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3800004720687866 |1.215063214302063 |0.004385948181152344 |0.00014841556549072266 |0.0050542354583740234 |0.0032401084899902344 |
----------------------------------------------------------pseudo_mini_loss sum 0.3605186939239502
Total (block generation + training)time/epoch 371.52313393240524
Training time/epoch 3.622950792312622
Training time without block to device /epoch 1.192824363708496
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.77it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.23it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.34it/s] 40%|████      | 10/25 [00:00<00:00, 17.64it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.86it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.43it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.66it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.77it/s] 80%|████████  | 20/25 [00:01<00:00, 17.87it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.99it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.09it/s]100%|██████████| 25/25 [00:01<00:00, 17.93it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.03it/s]  8%|▊         | 2/25 [00:00<00:04,  4.76it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.84it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.05it/s] 20%|██        | 5/25 [00:00<00:03,  5.35it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.28it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.88it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.70it/s] 40%|████      | 10/25 [00:01<00:02,  5.54it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.45it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.32it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.24it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.23it/s] 60%|██████    | 15/25 [00:02<00:01,  5.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.42it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.16it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.33it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.67it/s] 80%|████████  | 20/25 [00:03<00:00,  5.96it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.32it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.41it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.50it/s]100%|██████████| 25/25 [00:04<00:00,  5.76it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.68it/s]  8%|▊         | 2/25 [00:00<00:03,  6.65it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.53it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.55it/s] 20%|██        | 5/25 [00:00<00:03,  6.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.49it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.49it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.53it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.58it/s] 40%|████      | 10/25 [00:01<00:02,  6.65it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.59it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.64it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.64it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.57it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.64it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.59it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.54it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  5.92it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.09it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.23it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:03<00:00,  6.61it/s]
Run 00 | Epoch 00157 | Loss 0.3605 | Train 0.7064 | Val 0.6978 | Test 0.5538
Number of nodes during this epoch:  4637682
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426549434661865  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1438076496124268
range selection method range initialization spend 0.024662017822265625
time for parepare:  0.39696264266967773
local_output_nid generation:  0.02866530418395996
local_in_edges_tensor generation:  0.21850895881652832
mini_batch_src_global generation:  0.3805515766143799
r_  generation:  5.575793266296387
local_output_nid generation:  0.029678821563720703
local_in_edges_tensor generation:  0.2327864170074463
mini_batch_src_global generation:  0.4688410758972168
r_  generation:  5.8926098346710205
----------------------check_connections_block total spend ----------------------------- 14.9231116771698
generate_one_block  7.215114116668701
generate_one_block  6.874546766281128
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.015177011489868
gen group dst list time:  0.09093976020812988
time for parepare:  0.4451878070831299
local_output_nid generation:  0.2722129821777344
local_in_edges_tensor generation:  1.6147913932800293
mini_batch_src_global generation:  2.521761894226074
r_  generation:  30.07137417793274
local_output_nid generation:  0.5220341682434082
local_in_edges_tensor generation:  2.0891623497009277
mini_batch_src_global generation:  3.770601749420166
r_  generation:  29.77516531944275
----------------------check_connections_block total spend ----------------------------- 83.0059506893158
generate_one_block  41.15893578529358
generate_one_block  40.54988121986389
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2506699562072754
gen group dst list time:  0.18056154251098633
time for parepare:  0.5089521408081055
local_output_nid generation:  0.4034264087677002
local_in_edges_tensor generation:  1.5786597728729248
mini_batch_src_global generation:  2.019477128982544
r_  generation:  26.0636088848114
local_output_nid generation:  0.7526803016662598
local_in_edges_tensor generation:  2.1206777095794678
mini_batch_src_global generation:  2.8879916667938232
r_  generation:  26.166642665863037
----------------------check_connections_block total spend ----------------------------- 72.35313129425049
generate_one_block  35.40956497192383
generate_one_block  36.09623074531555
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426549434661865  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.35908198356628
block generation total time  153.21461272239685
average batch blocks generation time:  76.60730636119843
block dataloader generation time/epoch 367.6919196844101
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3902484178543091 |1.318934440612793 |0.0043898820877075195 |0.0001499652862548828 |0.005086779594421387 |0.0014638900756835938 |
----------------------------------------------------------pseudo_mini_loss sum 0.36121201515197754
Total (block generation + training)time/epoch 371.52678385565554
Training time/epoch 3.8519985675811768
Training time without block to device /epoch 1.2141296863555908
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.35it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.52it/s] 40%|████      | 10/25 [00:00<00:00, 17.82it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.92it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.04it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.00it/s] 80%|████████  | 20/25 [00:01<00:00, 18.04it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.07it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.04it/s]100%|██████████| 25/25 [00:01<00:00, 18.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.06it/s]  8%|▊         | 2/25 [00:00<00:03,  5.87it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.44it/s] 20%|██        | 5/25 [00:00<00:03,  5.64it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.84it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.01it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.12it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.14it/s] 40%|████      | 10/25 [00:01<00:02,  6.19it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.15it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.93it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.68it/s] 60%|██████    | 15/25 [00:02<00:01,  5.87it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.94it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.03it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.06it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.10it/s] 80%|████████  | 20/25 [00:03<00:00,  6.11it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.16it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.13it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.18it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.10it/s]100%|██████████| 25/25 [00:04<00:00,  6.84it/s]100%|██████████| 25/25 [00:04<00:00,  6.08it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.33it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.43it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.37it/s] 40%|████      | 10/25 [00:01<00:02,  6.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.39it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.33it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.36it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.35it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.41it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
Run 00 | Epoch 00158 | Loss 0.3612 | Train 0.7073 | Val 0.6988 | Test 0.5543
Number of nodes during this epoch:  4638161
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422783851623535  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1163573265075684
range selection method range initialization spend 0.024424076080322266
time for parepare:  0.36403656005859375
local_output_nid generation:  0.02617478370666504
local_in_edges_tensor generation:  0.21628284454345703
mini_batch_src_global generation:  0.3735685348510742
r_  generation:  5.404938459396362
local_output_nid generation:  0.02732086181640625
local_in_edges_tensor generation:  0.21426963806152344
mini_batch_src_global generation:  0.4625580310821533
r_  generation:  5.712019920349121
----------------------check_connections_block total spend ----------------------------- 14.461442947387695
generate_one_block  7.302478551864624
generate_one_block  6.779389381408691
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0258824825286865
gen group dst list time:  0.09008216857910156
time for parepare:  0.44050025939941406
local_output_nid generation:  0.2611579895019531
local_in_edges_tensor generation:  1.576653242111206
mini_batch_src_global generation:  2.436849594116211
r_  generation:  29.036988258361816
local_output_nid generation:  0.5352318286895752
local_in_edges_tensor generation:  2.082625150680542
mini_batch_src_global generation:  3.4612319469451904
r_  generation:  30.336278676986694
----------------------check_connections_block total spend ----------------------------- 82.07155585289001
generate_one_block  41.19964838027954
generate_one_block  40.86445760726929
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4439709186553955
gen group dst list time:  0.1954503059387207
time for parepare:  0.4911525249481201
local_output_nid generation:  0.4316518306732178
local_in_edges_tensor generation:  1.5134332180023193
mini_batch_src_global generation:  2.0147244930267334
r_  generation:  26.198449850082397
local_output_nid generation:  0.7374274730682373
local_in_edges_tensor generation:  2.1101815700531006
mini_batch_src_global generation:  2.829630136489868
r_  generation:  26.131251096725464
----------------------check_connections_block total spend ----------------------------- 72.46211862564087
generate_one_block  35.33236336708069
generate_one_block  36.10135340690613
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422783851623535  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.53367447853088
block generation total time  153.49782276153564
average batch blocks generation time:  76.74891138076782
block dataloader generation time/epoch 367.68701447930727
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4015086889266968 |1.327194094657898 |0.004366517066955566 |0.00015115737915039062 |0.005082488059997559 |0.0030739307403564453 |
----------------------------------------------------------pseudo_mini_loss sum 0.35995930433273315
Total (block generation + training)time/epoch 371.5221925486559
Training time/epoch 3.884605884552002
Training time without block to device /epoch 1.230217695236206
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.02it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.70it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.40it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.79it/s] 40%|████      | 10/25 [00:00<00:00, 18.04it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.21it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.27it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.32it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.24it/s] 80%|████████  | 20/25 [00:01<00:00, 18.33it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.39it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.42it/s]100%|██████████| 25/25 [00:01<00:00, 18.32it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.53it/s]  8%|▊         | 2/25 [00:00<00:03,  6.62it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.61it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.63it/s] 20%|██        | 5/25 [00:00<00:03,  6.64it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.62it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.62it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.63it/s] 40%|████      | 10/25 [00:01<00:02,  6.62it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.60it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.59it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.46it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.32it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.08it/s]100%|██████████| 25/25 [00:03<00:00,  6.80it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.66it/s]  8%|▊         | 2/25 [00:00<00:04,  5.69it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.93it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.15it/s] 20%|██        | 5/25 [00:00<00:03,  6.25it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.30it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.33it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.39it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.44it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.44it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.11it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.44it/s]100%|██████████| 25/25 [00:04<00:00,  6.12it/s]100%|██████████| 25/25 [00:04<00:00,  6.20it/s]
Run 00 | Epoch 00159 | Loss 0.3600 | Train 0.7081 | Val 0.6997 | Test 0.5545
Number of nodes during this epoch:  4638156
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428311824798584  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1003034114837646
range selection method range initialization spend 0.02462315559387207
time for parepare:  0.363999605178833
local_output_nid generation:  0.025841474533081055
local_in_edges_tensor generation:  0.20720767974853516
mini_batch_src_global generation:  0.37115955352783203
r_  generation:  5.352497100830078
local_output_nid generation:  0.027463912963867188
local_in_edges_tensor generation:  0.19464778900146484
mini_batch_src_global generation:  0.4619638919830322
r_  generation:  5.564026117324829
----------------------check_connections_block total spend ----------------------------- 14.18454098701477
generate_one_block  7.090251684188843
generate_one_block  6.785432815551758
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9414093494415283
gen group dst list time:  0.08365416526794434
time for parepare:  0.4323263168334961
local_output_nid generation:  0.2559232711791992
local_in_edges_tensor generation:  1.5764031410217285
mini_batch_src_global generation:  2.4384138584136963
r_  generation:  30.07102394104004
local_output_nid generation:  0.5193681716918945
local_in_edges_tensor generation:  2.0868382453918457
mini_batch_src_global generation:  3.5346603393554688
r_  generation:  30.211108684539795
----------------------check_connections_block total spend ----------------------------- 82.9365861415863
generate_one_block  41.15286898612976
generate_one_block  41.16113758087158
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1894235610961914
gen group dst list time:  0.19372892379760742
time for parepare:  0.4641594886779785
local_output_nid generation:  0.3762037754058838
local_in_edges_tensor generation:  1.4730865955352783
mini_batch_src_global generation:  2.0255937576293945
r_  generation:  26.089345693588257
local_output_nid generation:  0.7261731624603271
local_in_edges_tensor generation:  1.9452636241912842
mini_batch_src_global generation:  3.01528000831604
r_  generation:  26.112974643707275
----------------------check_connections_block total spend ----------------------------- 72.36754584312439
generate_one_block  35.53253245353699
generate_one_block  36.08299708366394
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428311824798584  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.3041319847107
block generation total time  153.92953610420227
average batch blocks generation time:  76.96476805210114
block dataloader generation time/epoch 367.67794051170347
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3900032043457031 |1.3228429555892944 |0.004833102226257324 |0.00016832351684570312 |0.005123138427734375 |0.003934621810913086 |
----------------------------------------------------------pseudo_mini_loss sum 0.3600310683250427
Total (block generation + training)time/epoch 371.51325433850286
Training time/epoch 3.8567233085632324
Training time without block to device /epoch 1.2110373973846436
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.85it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.46it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.26it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.57it/s] 40%|████      | 10/25 [00:00<00:01, 13.99it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.01it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.65it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.15it/s] 80%|████████  | 20/25 [00:01<00:00, 17.47it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.72it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.87it/s]100%|██████████| 25/25 [00:01<00:00, 16.94it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.70it/s]  8%|▊         | 2/25 [00:00<00:03,  6.70it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.76it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.70it/s] 20%|██        | 5/25 [00:00<00:03,  6.13it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.74it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.52it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.22it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.37it/s] 40%|████      | 10/25 [00:01<00:02,  5.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.62it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.62it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.71it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.79it/s] 60%|██████    | 15/25 [00:02<00:01,  5.97it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.12it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.25it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.25it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.33it/s] 80%|████████  | 20/25 [00:03<00:00,  6.04it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.88it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.06it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.18it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.26it/s]100%|██████████| 25/25 [00:04<00:00,  6.97it/s]100%|██████████| 25/25 [00:04<00:00,  6.06it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.03it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.01it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.80it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.79it/s] 40%|████      | 10/25 [00:01<00:02,  5.90it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.07it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.16it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.28it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.36it/s]
Run 00 | Epoch 00160 | Loss 0.3600 | Train 0.7076 | Val 0.6991 | Test 0.5540
Number of nodes during this epoch:  4637902
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4280900955200195  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1254374980926514
range selection method range initialization spend 0.0247347354888916
time for parepare:  0.3652970790863037
local_output_nid generation:  0.026079893112182617
local_in_edges_tensor generation:  0.18869781494140625
mini_batch_src_global generation:  0.37308669090270996
r_  generation:  5.590811729431152
local_output_nid generation:  0.02914285659790039
local_in_edges_tensor generation:  0.2276897430419922
mini_batch_src_global generation:  0.4593675136566162
r_  generation:  5.83318567276001
----------------------check_connections_block total spend ----------------------------- 14.748723268508911
generate_one_block  7.160191535949707
generate_one_block  6.8684165477752686
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9025075435638428
gen group dst list time:  0.10301923751831055
time for parepare:  0.4767735004425049
local_output_nid generation:  0.26912975311279297
local_in_edges_tensor generation:  1.7471258640289307
mini_batch_src_global generation:  2.5064609050750732
r_  generation:  29.833702564239502
local_output_nid generation:  0.5444059371948242
local_in_edges_tensor generation:  2.1272621154785156
mini_batch_src_global generation:  3.7417144775390625
r_  generation:  29.902117252349854
----------------------check_connections_block total spend ----------------------------- 83.0913827419281
generate_one_block  41.06914663314819
generate_one_block  40.791316986083984
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.345768451690674
gen group dst list time:  0.18029046058654785
time for parepare:  0.45465087890625
local_output_nid generation:  0.38539767265319824
local_in_edges_tensor generation:  1.493718147277832
mini_batch_src_global generation:  2.176659107208252
r_  generation:  26.433034658432007
local_output_nid generation:  0.7370491027832031
local_in_edges_tensor generation:  2.071423292160034
mini_batch_src_global generation:  2.8396549224853516
r_  generation:  26.315336227416992
----------------------check_connections_block total spend ----------------------------- 73.18431973457336
generate_one_block  35.440807819366455
generate_one_block  36.197314500808716
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4280900955200195  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.27570247650146
block generation total time  153.49858593940735
average batch blocks generation time:  76.74929296970367
block dataloader generation time/epoch 367.6820776506981
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40438926219940186 |1.2960121631622314 |0.004395604133605957 |0.00015687942504882812 |0.005036354064941406 |0.0029211044311523438 |
----------------------------------------------------------pseudo_mini_loss sum 0.35961222648620605
Total (block generation + training)time/epoch 371.5173817214018
Training time/epoch 3.8335609436035156
Training time without block to device /epoch 1.2415366172790527
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.12it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.72it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:00, 17.80it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.96it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.11it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.20it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.27it/s] 80%|████████  | 20/25 [00:01<00:00, 18.29it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.27it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.28it/s]100%|██████████| 25/25 [00:01<00:00, 18.21it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.42it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.45it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.43it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.42it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.17it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.05it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.18it/s] 20%|██        | 5/25 [00:00<00:03,  6.21it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.89it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.97it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.90it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.06it/s] 40%|████      | 10/25 [00:01<00:02,  6.17it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.21it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.23it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.30it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.31it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.39it/s]
Run 00 | Epoch 00161 | Loss 0.3596 | Train 0.7066 | Val 0.6983 | Test 0.5532
Number of nodes during this epoch:  4637382
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424941539764404  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.091219186782837
range selection method range initialization spend 0.02495741844177246
time for parepare:  0.38158345222473145
local_output_nid generation:  0.02610921859741211
local_in_edges_tensor generation:  0.2231597900390625
mini_batch_src_global generation:  0.370633602142334
r_  generation:  5.3952813148498535
local_output_nid generation:  0.027107715606689453
local_in_edges_tensor generation:  0.1933300495147705
mini_batch_src_global generation:  0.4687530994415283
r_  generation:  5.616584777832031
----------------------check_connections_block total spend ----------------------------- 14.348980188369751
generate_one_block  7.234726428985596
generate_one_block  6.85969090461731
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9338321685791016
gen group dst list time:  0.09708595275878906
time for parepare:  0.4216747283935547
local_output_nid generation:  0.24503612518310547
local_in_edges_tensor generation:  1.592048168182373
mini_batch_src_global generation:  2.446216106414795
r_  generation:  30.369709730148315
local_output_nid generation:  0.5166878700256348
local_in_edges_tensor generation:  2.088117837905884
mini_batch_src_global generation:  3.535527467727661
r_  generation:  30.235968589782715
----------------------check_connections_block total spend ----------------------------- 83.43578314781189
generate_one_block  41.17407464981079
generate_one_block  41.21110224723816
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2638115882873535
gen group dst list time:  0.18969511985778809
time for parepare:  0.47847557067871094
local_output_nid generation:  0.39948248863220215
local_in_edges_tensor generation:  1.5151653289794922
mini_batch_src_global generation:  2.1938767433166504
r_  generation:  26.119510173797607
local_output_nid generation:  0.7520787715911865
local_in_edges_tensor generation:  1.922616958618164
mini_batch_src_global generation:  2.8649206161499023
r_  generation:  26.013848543167114
----------------------check_connections_block total spend ----------------------------- 72.1861925125122
generate_one_block  35.147146224975586
generate_one_block  35.911461353302
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424941539764404  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.6219756603241
block generation total time  153.44378447532654
average batch blocks generation time:  76.72189223766327
block dataloader generation time/epoch 367.67637892564136
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3724120855331421 |1.1850627660751343 |0.004366278648376465 |0.00014972686767578125 |0.005085349082946777 |0.0016298294067382812 |
----------------------------------------------------------pseudo_mini_loss sum 0.3596331775188446
Total (block generation + training)time/epoch 371.50988513452035
Training time/epoch 3.5438826084136963
Training time without block to device /epoch 1.1737570762634277
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.25it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.47it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.12it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.85it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.93it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.99it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.11it/s] 80%|████████  | 20/25 [00:01<00:00, 18.07it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.93it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.75it/s]100%|██████████| 25/25 [00:01<00:00, 17.90it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.11it/s]  8%|▊         | 2/25 [00:00<00:04,  5.15it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.15it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.15it/s] 20%|██        | 5/25 [00:00<00:03,  5.14it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.14it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.12it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.12it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.12it/s] 40%|████      | 10/25 [00:01<00:02,  5.11it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.13it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.08it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.94it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.81it/s] 60%|██████    | 15/25 [00:02<00:02,  4.97it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.24it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.51it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.59it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.75it/s] 80%|████████  | 20/25 [00:03<00:00,  5.92it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.52it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.79it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.97it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.61it/s]100%|██████████| 25/25 [00:04<00:00,  6.44it/s]100%|██████████| 25/25 [00:04<00:00,  5.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.70it/s]  8%|▊         | 2/25 [00:00<00:03,  6.22it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.58it/s] 20%|██        | 5/25 [00:00<00:03,  5.79it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.27it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.09it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.47it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.77it/s] 40%|████      | 10/25 [00:01<00:02,  6.03it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.19it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.31it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  5.90it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.57it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.39it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.25it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.06it/s] 80%|████████  | 20/25 [00:03<00:00,  5.42it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.75it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.99it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.19it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.34it/s]100%|██████████| 25/25 [00:04<00:00,  5.94it/s]
Run 00 | Epoch 00162 | Loss 0.3596 | Train 0.7060 | Val 0.6978 | Test 0.5530
Number of nodes during this epoch:  4637697
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421285152435303  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1718015670776367
range selection method range initialization spend 0.027923583984375
time for parepare:  0.4240539073944092
local_output_nid generation:  0.02763533592224121
local_in_edges_tensor generation:  0.23154377937316895
mini_batch_src_global generation:  0.38760900497436523
r_  generation:  5.541401386260986
local_output_nid generation:  0.03005075454711914
local_in_edges_tensor generation:  0.24132370948791504
mini_batch_src_global generation:  0.46480536460876465
r_  generation:  5.831010341644287
----------------------check_connections_block total spend ----------------------------- 14.935264348983765
generate_one_block  7.317230463027954
generate_one_block  7.133779525756836
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.025937795639038
gen group dst list time:  0.08725786209106445
time for parepare:  0.4583449363708496
local_output_nid generation:  0.2860267162322998
local_in_edges_tensor generation:  1.594045639038086
mini_batch_src_global generation:  2.53166127204895
r_  generation:  30.078355312347412
local_output_nid generation:  0.5237541198730469
local_in_edges_tensor generation:  2.0563254356384277
mini_batch_src_global generation:  3.5468547344207764
r_  generation:  30.82214593887329
----------------------check_connections_block total spend ----------------------------- 83.77090406417847
generate_one_block  41.07903218269348
generate_one_block  41.07537484169006
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1068825721740723
gen group dst list time:  0.18794536590576172
time for parepare:  0.47312498092651367
local_output_nid generation:  0.40488100051879883
local_in_edges_tensor generation:  1.5777056217193604
mini_batch_src_global generation:  2.143061876296997
r_  generation:  26.214224338531494
local_output_nid generation:  0.722707986831665
local_in_edges_tensor generation:  2.03429913520813
mini_batch_src_global generation:  2.8495895862579346
r_  generation:  25.78894329071045
----------------------check_connections_block total spend ----------------------------- 72.08653616905212
generate_one_block  35.018654108047485
generate_one_block  35.80388569831848
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421285152435303  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.8574402332306
block generation total time  152.9769468307495
average batch blocks generation time:  76.48847341537476
block dataloader generation time/epoch 367.67978656950174
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3740638494491577 |1.286736011505127 |0.004466652870178223 |0.00014543533325195312 |0.005100607872009277 |0.0024869441986083984 |
----------------------------------------------------------pseudo_mini_loss sum 0.35755032300949097
Total (block generation + training)time/epoch 371.51282574794044
Training time/epoch 3.757190227508545
Training time without block to device /epoch 1.183718204498291
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.30it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.83it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.25it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.46it/s] 40%|████      | 10/25 [00:00<00:00, 17.52it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.65it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.84it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.89it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.82it/s] 80%|████████  | 20/25 [00:01<00:00, 17.98it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.11it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.80it/s]100%|██████████| 25/25 [00:01<00:00, 17.80it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.74it/s]  8%|▊         | 2/25 [00:00<00:03,  6.85it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.05it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.66it/s] 20%|██        | 5/25 [00:00<00:03,  5.48it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.35it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.28it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.23it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.17it/s] 40%|████      | 10/25 [00:01<00:02,  5.15it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.14it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.14it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.11it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.10it/s] 60%|██████    | 15/25 [00:02<00:02,  4.78it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.00it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.18it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.43it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.64it/s] 80%|████████  | 20/25 [00:03<00:00,  5.80it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.99it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.11it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.70it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.39it/s]100%|██████████| 25/25 [00:04<00:00,  5.57it/s]100%|██████████| 25/25 [00:04<00:00,  5.43it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.91it/s]  8%|▊         | 2/25 [00:00<00:04,  5.03it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.10it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.10it/s] 20%|██        | 5/25 [00:01<00:04,  4.74it/s] 24%|██▍       | 6/25 [00:01<00:04,  4.61it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.93it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.30it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.57it/s] 40%|████      | 10/25 [00:01<00:02,  5.82it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.61it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.88it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.13it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.34it/s] 60%|██████    | 15/25 [00:02<00:01,  5.97it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.62it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.34it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.11it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.46it/s] 80%|████████  | 20/25 [00:03<00:00,  5.76it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.97it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.16it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.30it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.93it/s]100%|██████████| 25/25 [00:04<00:00,  6.40it/s]100%|██████████| 25/25 [00:04<00:00,  5.64it/s]
Run 00 | Epoch 00163 | Loss 0.3576 | Train 0.7056 | Val 0.6974 | Test 0.5527
Number of nodes during this epoch:  4637332
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425992488861084  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1286897659301758
range selection method range initialization spend 0.024860620498657227
time for parepare:  0.37748217582702637
local_output_nid generation:  0.025984764099121094
local_in_edges_tensor generation:  0.23118805885314941
mini_batch_src_global generation:  0.37133097648620605
r_  generation:  5.501162052154541
local_output_nid generation:  0.02896881103515625
local_in_edges_tensor generation:  0.21570563316345215
mini_batch_src_global generation:  0.49871277809143066
r_  generation:  5.794604063034058
----------------------check_connections_block total spend ----------------------------- 14.771720170974731
generate_one_block  7.272320508956909
generate_one_block  6.932894229888916
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9680562019348145
gen group dst list time:  0.09055638313293457
time for parepare:  0.47290873527526855
local_output_nid generation:  0.26526975631713867
local_in_edges_tensor generation:  1.6105067729949951
mini_batch_src_global generation:  2.4998836517333984
r_  generation:  29.94707727432251
local_output_nid generation:  0.5270648002624512
local_in_edges_tensor generation:  2.0945916175842285
mini_batch_src_global generation:  3.7724881172180176
r_  generation:  29.69943904876709
----------------------check_connections_block total spend ----------------------------- 82.84192442893982
generate_one_block  41.0087673664093
generate_one_block  40.54747796058655
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4189326763153076
gen group dst list time:  0.19102215766906738
time for parepare:  0.4910459518432617
local_output_nid generation:  0.4111661911010742
local_in_edges_tensor generation:  1.5253658294677734
mini_batch_src_global generation:  2.04943585395813
r_  generation:  26.343183755874634
local_output_nid generation:  0.7320830821990967
local_in_edges_tensor generation:  2.023632526397705
mini_batch_src_global generation:  2.824519634246826
r_  generation:  26.08184504508972
----------------------check_connections_block total spend ----------------------------- 72.83846664428711
generate_one_block  35.28518462181091
generate_one_block  35.96531343460083
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425992488861084  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.68039107322693
block generation total time  152.8067433834076
average batch blocks generation time:  76.4033716917038
block dataloader generation time/epoch 367.6818234760587
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3936663866043091 |1.3155419826507568 |0.004392027854919434 |0.00015592575073242188 |0.00514674186706543 |0.0028977394104003906 |
----------------------------------------------------------pseudo_mini_loss sum 0.357604056596756
Total (block generation + training)time/epoch 371.514956711269
Training time/epoch 3.8482894897460938
Training time without block to device /epoch 1.21720552444458
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.95it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.72it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.32it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.89it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.01it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.07it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.09it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.19it/s] 80%|████████  | 20/25 [00:01<00:00, 18.25it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.25it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.25it/s]100%|██████████| 25/25 [00:01<00:00, 18.18it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.22it/s]  8%|▊         | 2/25 [00:00<00:04,  5.21it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.20it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.21it/s] 20%|██        | 5/25 [00:00<00:03,  5.19it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.22it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.19it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.16it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.16it/s] 40%|████      | 10/25 [00:01<00:02,  5.16it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.15it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.12it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.95it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.78it/s] 60%|██████    | 15/25 [00:02<00:02,  4.95it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.17it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.44it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.69it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.91it/s] 80%|████████  | 20/25 [00:03<00:00,  6.08it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.19it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.27it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.37it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.39it/s]100%|██████████| 25/25 [00:04<00:00,  7.16it/s]100%|██████████| 25/25 [00:04<00:00,  5.60it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.19it/s]  8%|▊         | 2/25 [00:00<00:03,  6.43it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.45it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.93it/s] 20%|██        | 5/25 [00:00<00:03,  5.48it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.78it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.01it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.82it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.87it/s] 40%|████      | 10/25 [00:01<00:02,  6.03it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.15it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.23it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.31it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.38it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.90it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.02it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.18it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.24it/s] 80%|████████  | 20/25 [00:03<00:00,  6.31it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:03<00:00,  6.26it/s]
Run 00 | Epoch 00164 | Loss 0.3576 | Train 0.7054 | Val 0.6965 | Test 0.5522
Number of nodes during this epoch:  4636905
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423286437988281  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1235954761505127
range selection method range initialization spend 0.02534031867980957
time for parepare:  0.3916482925415039
local_output_nid generation:  0.027276992797851562
local_in_edges_tensor generation:  0.2201535701751709
mini_batch_src_global generation:  0.37763524055480957
r_  generation:  5.673406600952148
local_output_nid generation:  0.029050827026367188
local_in_edges_tensor generation:  0.23418235778808594
mini_batch_src_global generation:  0.46213698387145996
r_  generation:  5.864006280899048
----------------------check_connections_block total spend ----------------------------- 14.953511953353882
generate_one_block  7.258735656738281
generate_one_block  6.931112766265869
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.066849946975708
gen group dst list time:  0.0974266529083252
time for parepare:  0.49190354347229004
local_output_nid generation:  0.2686896324157715
local_in_edges_tensor generation:  1.669358253479004
mini_batch_src_global generation:  2.5121591091156006
r_  generation:  29.845309495925903
local_output_nid generation:  0.5313112735748291
local_in_edges_tensor generation:  2.150719404220581
mini_batch_src_global generation:  3.4957733154296875
r_  generation:  31.281363487243652
----------------------check_connections_block total spend ----------------------------- 84.50576162338257
generate_one_block  41.169368743896484
generate_one_block  41.13025975227356
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2857182025909424
gen group dst list time:  0.18821930885314941
time for parepare:  0.4803276062011719
local_output_nid generation:  0.4197421073913574
local_in_edges_tensor generation:  1.5243017673492432
mini_batch_src_global generation:  2.1650218963623047
r_  generation:  26.46840810775757
local_output_nid generation:  0.7294034957885742
local_in_edges_tensor generation:  1.9288601875305176
mini_batch_src_global generation:  2.9684858322143555
r_  generation:  26.666883945465088
----------------------check_connections_block total spend ----------------------------- 73.87601375579834
generate_one_block  35.18489861488342
generate_one_block  35.78414344787598
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423286437988281  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  158.3817753791809
block generation total time  153.26867055892944
average batch blocks generation time:  76.63433527946472
block dataloader generation time/epoch 367.7035170396169
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37368738651275635 |1.3025362491607666 |0.004728436470031738 |0.00016188621520996094 |0.0051403045654296875 |0.0014758110046386719 |
----------------------------------------------------------pseudo_mini_loss sum 0.35800787806510925
Total (block generation + training)time/epoch 371.5363692485925
Training time/epoch 3.7866005897521973
Training time without block to device /epoch 1.181528091430664
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.23it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.87it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.09it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.55it/s] 40%|████      | 10/25 [00:00<00:01, 14.01it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.22it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.11it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.72it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.16it/s] 80%|████████  | 20/25 [00:01<00:00, 17.54it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.72it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.77it/s]100%|██████████| 25/25 [00:01<00:00, 17.00it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.79it/s]  8%|▊         | 2/25 [00:00<00:03,  6.91it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.99it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.64it/s] 20%|██        | 5/25 [00:00<00:03,  5.39it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.76it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.04it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.17it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.27it/s] 40%|████      | 10/25 [00:01<00:02,  5.92it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.03it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.21it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.91it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.52it/s] 60%|██████    | 15/25 [00:02<00:01,  5.84it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.06it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.14it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.19it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.60it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.64it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.64it/s]100%|██████████| 25/25 [00:03<00:00,  6.27it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.80it/s]  8%|▊         | 2/25 [00:00<00:04,  4.95it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.04it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.04it/s] 20%|██        | 5/25 [00:00<00:03,  5.08it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.08it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.10it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.12it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.11it/s] 40%|████      | 10/25 [00:01<00:02,  5.11it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.10it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.08it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.06it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.05it/s] 60%|██████    | 15/25 [00:02<00:02,  4.94it/s] 64%|██████▍   | 16/25 [00:03<00:01,  4.92it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.90it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.17it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.50it/s] 80%|████████  | 20/25 [00:03<00:00,  5.79it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.97it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.04it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.18it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.83it/s]100%|██████████| 25/25 [00:04<00:00,  6.34it/s]100%|██████████| 25/25 [00:04<00:00,  5.37it/s]
Run 00 | Epoch 00165 | Loss 0.3580 | Train 0.7059 | Val 0.6965 | Test 0.5520
Number of nodes during this epoch:  4637059
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423487663269043  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1443002223968506
range selection method range initialization spend 0.0238800048828125
time for parepare:  0.374129056930542
local_output_nid generation:  0.03025078773498535
local_in_edges_tensor generation:  0.16609716415405273
mini_batch_src_global generation:  0.36345744132995605
r_  generation:  5.437618970870972
local_output_nid generation:  0.02892446517944336
local_in_edges_tensor generation:  0.21757030487060547
mini_batch_src_global generation:  0.46033406257629395
r_  generation:  5.767699718475342
----------------------check_connections_block total spend ----------------------------- 14.459363460540771
generate_one_block  7.220470190048218
generate_one_block  6.963704586029053
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.915631055831909
gen group dst list time:  0.0936427116394043
time for parepare:  0.467893123626709
local_output_nid generation:  0.30341410636901855
local_in_edges_tensor generation:  1.7094972133636475
mini_batch_src_global generation:  2.5163164138793945
r_  generation:  29.990398406982422
local_output_nid generation:  0.532501220703125
local_in_edges_tensor generation:  2.103864908218384
mini_batch_src_global generation:  3.7427544593811035
r_  generation:  29.97278356552124
----------------------check_connections_block total spend ----------------------------- 83.2745749950409
generate_one_block  41.093894720077515
generate_one_block  40.77673387527466
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.294807195663452
gen group dst list time:  0.19057965278625488
time for parepare:  0.47716569900512695
local_output_nid generation:  0.41730451583862305
local_in_edges_tensor generation:  1.4795403480529785
mini_batch_src_global generation:  2.019148349761963
r_  generation:  26.04889726638794
local_output_nid generation:  0.7508714199066162
local_in_edges_tensor generation:  2.0341625213623047
mini_batch_src_global generation:  2.92720627784729
r_  generation:  26.63439679145813
----------------------check_connections_block total spend ----------------------------- 73.28471422195435
generate_one_block  36.83622741699219
generate_one_block  37.61997866630554
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423487663269043  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.55928921699524
block generation total time  156.3268346786499
average batch blocks generation time:  78.16341733932495
block dataloader generation time/epoch 367.7273011049592
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41107964515686035 |1.4858304262161255 |0.0047026872634887695 |0.00016617774963378906 |0.005165576934814453 |0.001394510269165039 |
----------------------------------------------------------pseudo_mini_loss sum 0.3565739393234253
Total (block generation + training)time/epoch 371.5625747959298
Training time/epoch 4.23464035987854
Training time without block to device /epoch 1.262979507446289
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.48it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.41it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.08it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.55it/s] 40%|████      | 10/25 [00:00<00:00, 16.87it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.14it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.18it/s] 80%|████████  | 20/25 [00:01<00:00, 17.30it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.33it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.36it/s]100%|██████████| 25/25 [00:01<00:00, 17.20it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.22it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.32it/s] 20%|██        | 5/25 [00:00<00:03,  6.35it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.36it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.32it/s] 40%|████      | 10/25 [00:01<00:02,  6.30it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.33it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.33it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.34it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.36it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.21it/s]100%|██████████| 25/25 [00:03<00:00,  6.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.91it/s]  8%|▊         | 2/25 [00:00<00:03,  5.87it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.76it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.75it/s] 20%|██        | 5/25 [00:00<00:03,  5.93it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.00it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.09it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.16it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.13it/s] 40%|████      | 10/25 [00:01<00:02,  6.18it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.17it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.21it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.28it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.29it/s] 60%|██████    | 15/25 [00:02<00:01,  5.81it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.67it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.85it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.99it/s] 80%|████████  | 20/25 [00:03<00:00,  6.05it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.87it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.63it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.66it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.80it/s]100%|██████████| 25/25 [00:04<00:00,  6.61it/s]100%|██████████| 25/25 [00:04<00:00,  6.02it/s]
Run 00 | Epoch 00166 | Loss 0.3566 | Train 0.7056 | Val 0.6960 | Test 0.5516
Number of nodes during this epoch:  4637834
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427935600280762  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1244685649871826
range selection method range initialization spend 0.024130821228027344
time for parepare:  0.36874890327453613
local_output_nid generation:  0.025825023651123047
local_in_edges_tensor generation:  0.218672513961792
mini_batch_src_global generation:  0.37888646125793457
r_  generation:  5.724951505661011
local_output_nid generation:  0.029647350311279297
local_in_edges_tensor generation:  0.23381710052490234
mini_batch_src_global generation:  0.4713563919067383
r_  generation:  5.958304405212402
----------------------check_connections_block total spend ----------------------------- 15.082628726959229
generate_one_block  7.423908948898315
generate_one_block  7.463411808013916
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.425043821334839
gen group dst list time:  0.09575653076171875
time for parepare:  0.43947410583496094
local_output_nid generation:  0.2561464309692383
local_in_edges_tensor generation:  1.6492319107055664
mini_batch_src_global generation:  2.5366361141204834
r_  generation:  29.92739486694336
local_output_nid generation:  0.5899238586425781
local_in_edges_tensor generation:  2.177513837814331
mini_batch_src_global generation:  3.968186855316162
r_  generation:  31.283202648162842
----------------------check_connections_block total spend ----------------------------- 85.7649278640747
generate_one_block  42.82822322845459
generate_one_block  42.67774844169617
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2241313457489014
gen group dst list time:  0.18125081062316895
time for parepare:  0.48020124435424805
local_output_nid generation:  0.4190242290496826
local_in_edges_tensor generation:  1.52577805519104
mini_batch_src_global generation:  2.023057222366333
r_  generation:  26.761638164520264
local_output_nid generation:  0.7566497325897217
local_in_edges_tensor generation:  2.063117504119873
mini_batch_src_global generation:  2.9843854904174805
r_  generation:  26.955374240875244
----------------------check_connections_block total spend ----------------------------- 74.50904893875122
generate_one_block  36.88619565963745
generate_one_block  36.77789330482483
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427935600280762  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  160.27397680282593
block generation total time  159.17006063461304
average batch blocks generation time:  79.58503031730652
block dataloader generation time/epoch 367.8002547104202
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39085185527801514 |1.3281539678573608 |0.004800081253051758 |0.00016641616821289062 |0.005242109298706055 |0.0014693737030029297 |
----------------------------------------------------------pseudo_mini_loss sum 0.3566860258579254
Total (block generation + training)time/epoch 371.63572970978515
Training time/epoch 3.8687236309051514
Training time without block to device /epoch 1.2124156951904297
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.62it/s] 16%|█▌        | 4/25 [00:00<00:01, 14.96it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.63it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.00it/s] 40%|████      | 10/25 [00:00<00:00, 16.28it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.31it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.43it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.53it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.60it/s] 80%|████████  | 20/25 [00:01<00:00, 16.65it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.68it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.72it/s]100%|██████████| 25/25 [00:01<00:00, 16.46it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.97it/s]  8%|▊         | 2/25 [00:00<00:04,  5.66it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.94it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.08it/s] 20%|██        | 5/25 [00:00<00:03,  6.14it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.12it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.16it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.22it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.24it/s] 40%|████      | 10/25 [00:01<00:02,  5.86it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.65it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.47it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.64it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.81it/s] 60%|██████    | 15/25 [00:02<00:01,  5.90it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.99it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.06it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.11it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.06it/s] 80%|████████  | 20/25 [00:03<00:00,  6.13it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.10it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.15it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.19it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.22it/s]100%|██████████| 25/25 [00:04<00:00,  6.86it/s]100%|██████████| 25/25 [00:04<00:00,  6.08it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.92it/s]  8%|▊         | 2/25 [00:00<00:03,  6.07it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.09it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.13it/s] 20%|██        | 5/25 [00:00<00:03,  6.16it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.17it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.18it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.19it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.17it/s] 40%|████      | 10/25 [00:01<00:02,  6.18it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.18it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.18it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.18it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.19it/s] 60%|██████    | 15/25 [00:02<00:01,  6.18it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.17it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.16it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.17it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.17it/s] 80%|████████  | 20/25 [00:03<00:00,  6.17it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.17it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.17it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.19it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.17it/s]100%|██████████| 25/25 [00:04<00:00,  6.85it/s]100%|██████████| 25/25 [00:04<00:00,  6.25it/s]
Run 00 | Epoch 00167 | Loss 0.3567 | Train 0.7042 | Val 0.6945 | Test 0.5508
Number of nodes during this epoch:  4637275
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423184394836426  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1579177379608154
range selection method range initialization spend 0.0268704891204834
time for parepare:  0.39891529083251953
local_output_nid generation:  0.0309598445892334
local_in_edges_tensor generation:  0.20290040969848633
mini_batch_src_global generation:  0.39690399169921875
r_  generation:  6.113449811935425
local_output_nid generation:  0.028733253479003906
local_in_edges_tensor generation:  0.25026512145996094
mini_batch_src_global generation:  0.47411537170410156
r_  generation:  5.957751512527466
----------------------check_connections_block total spend ----------------------------- 15.51866340637207
generate_one_block  7.251072406768799
generate_one_block  6.977095365524292
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.211810350418091
gen group dst list time:  0.09712696075439453
time for parepare:  0.4615507125854492
local_output_nid generation:  0.2663395404815674
local_in_edges_tensor generation:  1.6784019470214844
mini_batch_src_global generation:  2.5030345916748047
r_  generation:  29.89646625518799
local_output_nid generation:  0.5271930694580078
local_in_edges_tensor generation:  2.147914409637451
mini_batch_src_global generation:  3.557126998901367
r_  generation:  30.203468322753906
----------------------check_connections_block total spend ----------------------------- 83.3829243183136
generate_one_block  40.75214743614197
generate_one_block  41.05073809623718
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.278398036956787
gen group dst list time:  0.20149636268615723
time for parepare:  0.46553730964660645
local_output_nid generation:  0.4105696678161621
local_in_edges_tensor generation:  1.5801403522491455
mini_batch_src_global generation:  2.0615663528442383
r_  generation:  26.12868905067444
local_output_nid generation:  0.721684455871582
local_in_edges_tensor generation:  1.925513744354248
mini_batch_src_global generation:  2.8435826301574707
r_  generation:  26.010534048080444
----------------------check_connections_block total spend ----------------------------- 72.14427185058594
generate_one_block  35.220762491226196
generate_one_block  36.01183009147644
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423184394836426  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.52719616889954
block generation total time  153.0354781150818
average batch blocks generation time:  76.5177390575409
block dataloader generation time/epoch 367.8030003252484
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3725537061691284 |1.2983213663101196 |0.004396319389343262 |0.00015914440155029297 |0.006178617477416992 |0.0031845569610595703 |
----------------------------------------------------------pseudo_mini_loss sum 0.3560188412666321
Total (block generation + training)time/epoch 371.63810670375824
Training time/epoch 3.7733752727508545
Training time without block to device /epoch 1.1767325401306152
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.17it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.63it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.27it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.61it/s] 40%|████      | 10/25 [00:00<00:00, 17.86it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.64it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.83it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.87it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.62it/s] 80%|████████  | 20/25 [00:01<00:00, 17.76it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.81it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.71it/s]100%|██████████| 25/25 [00:01<00:00, 17.75it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.04it/s]  8%|▊         | 2/25 [00:00<00:04,  5.13it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.15it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.15it/s] 20%|██        | 5/25 [00:00<00:03,  5.15it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.15it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.16it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.15it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.14it/s] 40%|████      | 10/25 [00:01<00:02,  5.14it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.09it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.08it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.01it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.06it/s] 60%|██████    | 15/25 [00:02<00:01,  5.28it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.63it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.92it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.89it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.02it/s] 80%|████████  | 20/25 [00:03<00:00,  6.17it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.55it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.33it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.47it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.68it/s]100%|██████████| 25/25 [00:04<00:00,  6.05it/s]100%|██████████| 25/25 [00:04<00:00,  5.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.58it/s]  8%|▊         | 2/25 [00:00<00:04,  4.79it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.84it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.52it/s] 20%|██        | 5/25 [00:01<00:04,  4.35it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.75it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.54it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.87it/s] 40%|████      | 10/25 [00:01<00:02,  6.02it/s] 44%|████▍     | 11/25 [00:02<00:02,  6.27it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.60it/s] 60%|██████    | 15/25 [00:02<00:01,  6.12it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.75it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.47it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.29it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.51it/s] 80%|████████  | 20/25 [00:03<00:00,  5.82it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.04it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.17it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.42it/s]100%|██████████| 25/25 [00:04<00:00,  6.74it/s]100%|██████████| 25/25 [00:04<00:00,  5.77it/s]
Run 00 | Epoch 00168 | Loss 0.3560 | Train 0.7041 | Val 0.6945 | Test 0.5506
Number of nodes during this epoch:  4637642
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423409461975098  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1008634567260742
range selection method range initialization spend 0.040055274963378906
time for parepare:  0.40645456314086914
local_output_nid generation:  0.029094934463500977
local_in_edges_tensor generation:  0.23339152336120605
mini_batch_src_global generation:  0.37317919731140137
r_  generation:  5.507659673690796
local_output_nid generation:  0.02922987937927246
local_in_edges_tensor generation:  0.2186591625213623
mini_batch_src_global generation:  0.502199649810791
r_  generation:  5.826427459716797
----------------------check_connections_block total spend ----------------------------- 14.825978517532349
generate_one_block  7.2765491008758545
generate_one_block  7.039830446243286
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.021857738494873
gen group dst list time:  0.08864116668701172
time for parepare:  0.4518272876739502
local_output_nid generation:  0.2607386112213135
local_in_edges_tensor generation:  1.674628734588623
mini_batch_src_global generation:  2.557429075241089
r_  generation:  29.838263273239136
local_output_nid generation:  0.5266697406768799
local_in_edges_tensor generation:  2.1018548011779785
mini_batch_src_global generation:  3.4889419078826904
r_  generation:  30.348780632019043
----------------------check_connections_block total spend ----------------------------- 83.32619452476501
generate_one_block  41.319605350494385
generate_one_block  41.19420838356018
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2531814575195312
gen group dst list time:  0.18688321113586426
time for parepare:  0.44220805168151855
local_output_nid generation:  0.4152674674987793
local_in_edges_tensor generation:  1.5232865810394287
mini_batch_src_global generation:  2.1307051181793213
r_  generation:  26.477414846420288
local_output_nid generation:  0.755103588104248
local_in_edges_tensor generation:  1.917128086090088
mini_batch_src_global generation:  2.852562189102173
r_  generation:  26.1252601146698
----------------------check_connections_block total spend ----------------------------- 72.53572630882263
generate_one_block  35.266671895980835
generate_one_block  36.14253497123718
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423409461975098  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.86192083358765
block generation total time  153.92302060127258
average batch blocks generation time:  76.96151030063629
block dataloader generation time/epoch 367.81289719124516
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38410043716430664 |1.3044708967208862 |0.004397392272949219 |0.00015246868133544922 |0.005204558372497559 |0.001506805419921875 |
----------------------------------------------------------pseudo_mini_loss sum 0.3560589551925659
Total (block generation + training)time/epoch 371.6478371620178
Training time/epoch 3.8068089485168457
Training time without block to device /epoch 1.1978671550750732
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.69it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.45it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.04it/s] 40%|████      | 10/25 [00:00<00:00, 17.52it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.77it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.80it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.93it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.89it/s] 80%|████████  | 20/25 [00:01<00:00, 17.87it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.98it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.77it/s]100%|██████████| 25/25 [00:01<00:00, 17.84it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.04it/s]  8%|▊         | 2/25 [00:00<00:04,  5.09it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.09it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.88it/s] 20%|██        | 5/25 [00:00<00:03,  5.07it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.03it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.23it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.47it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.72it/s] 40%|████      | 10/25 [00:01<00:02,  5.94it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.11it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.25it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.31it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.31it/s] 60%|██████    | 15/25 [00:02<00:01,  6.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.44it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.45it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.49it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.51it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.28it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.08it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.16it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.16it/s]100%|██████████| 25/25 [00:04<00:00,  6.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.53it/s]  8%|▊         | 2/25 [00:00<00:03,  6.02it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.17it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.19it/s] 20%|██        | 5/25 [00:00<00:03,  6.27it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.32it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.29it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.27it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.28it/s] 40%|████      | 10/25 [00:01<00:02,  6.33it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.30it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.34it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.36it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.41it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.41it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  7.18it/s]100%|██████████| 25/25 [00:03<00:00,  6.43it/s]
Run 00 | Epoch 00169 | Loss 0.3561 | Train 0.7049 | Val 0.6949 | Test 0.5506
Number of nodes during this epoch:  4637944
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424138069152832  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1158595085144043
range selection method range initialization spend 0.03688764572143555
time for parepare:  0.3768501281738281
local_output_nid generation:  0.02669501304626465
local_in_edges_tensor generation:  0.20515751838684082
mini_batch_src_global generation:  0.3809971809387207
r_  generation:  5.662636041641235
local_output_nid generation:  0.029332399368286133
local_in_edges_tensor generation:  0.2342679500579834
mini_batch_src_global generation:  0.4621608257293701
r_  generation:  5.883681297302246
----------------------check_connections_block total spend ----------------------------- 14.940978527069092
generate_one_block  7.268165111541748
generate_one_block  6.939083099365234
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.95082426071167
gen group dst list time:  0.08545970916748047
time for parepare:  0.4717984199523926
local_output_nid generation:  0.26113057136535645
local_in_edges_tensor generation:  1.6506540775299072
mini_batch_src_global generation:  2.560612916946411
r_  generation:  29.91877245903015
local_output_nid generation:  0.5307633876800537
local_in_edges_tensor generation:  2.0886526107788086
mini_batch_src_global generation:  3.738189935684204
r_  generation:  29.725879669189453
----------------------check_connections_block total spend ----------------------------- 82.89764046669006
generate_one_block  41.108681440353394
generate_one_block  40.71286916732788
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4006717205047607
gen group dst list time:  0.1840054988861084
time for parepare:  0.4858729839324951
local_output_nid generation:  0.4054727554321289
local_in_edges_tensor generation:  1.5659465789794922
mini_batch_src_global generation:  2.02721905708313
r_  generation:  26.349350214004517
local_output_nid generation:  0.7430095672607422
local_in_edges_tensor generation:  2.220052719116211
mini_batch_src_global generation:  2.945770025253296
r_  generation:  26.33068299293518
----------------------check_connections_block total spend ----------------------------- 73.2958116531372
generate_one_block  35.591115951538086
generate_one_block  36.18908667564392
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424138069152832  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.19345211982727
block generation total time  153.60175323486328
average batch blocks generation time:  76.80087661743164
block dataloader generation time/epoch 367.82483708718246
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3902696371078491 |1.318058729171753 |0.004353880882263184 |0.0001456737518310547 |0.005176544189453125 |0.0028891563415527344 |
----------------------------------------------------------pseudo_mini_loss sum 0.3556123971939087
Total (block generation + training)time/epoch 371.6598842536702
Training time/epoch 3.8529911041259766
Training time without block to device /epoch 1.2168736457824707
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.21it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.86it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.25it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.63it/s] 40%|████      | 10/25 [00:00<00:01, 14.14it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.38it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.28it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.90it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.36it/s] 80%|████████  | 20/25 [00:01<00:00, 17.69it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.91it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.00it/s]100%|██████████| 25/25 [00:01<00:00, 17.24it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.37it/s]  8%|▊         | 2/25 [00:00<00:03,  6.52it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.90it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.58it/s] 20%|██        | 5/25 [00:00<00:03,  5.43it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.28it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.04it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.99it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.39it/s] 40%|████      | 10/25 [00:01<00:02,  5.69it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.79it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.92it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.79it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.69it/s] 60%|██████    | 15/25 [00:02<00:01,  5.75it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.86it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.01it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.16it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.19it/s] 80%|████████  | 20/25 [00:03<00:00,  6.27it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.33it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.90it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.52it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  6.09it/s]100%|██████████| 25/25 [00:04<00:00,  5.77it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.06it/s]  8%|▊         | 2/25 [00:00<00:03,  6.26it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.36it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.35it/s] 20%|██        | 5/25 [00:00<00:03,  6.38it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.31it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.32it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.35it/s] 40%|████      | 10/25 [00:01<00:02,  6.33it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.22it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.22it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.17it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.20it/s] 60%|██████    | 15/25 [00:02<00:01,  6.10it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.19it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.21it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.28it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.25it/s] 80%|████████  | 20/25 [00:03<00:00,  6.25it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.28it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:03<00:00,  6.38it/s]
Run 00 | Epoch 00170 | Loss 0.3556 | Train 0.7053 | Val 0.6958 | Test 0.5506
Number of nodes during this epoch:  4637474
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422266483306885  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1340770721435547
range selection method range initialization spend 0.024918556213378906
time for parepare:  0.38022804260253906
local_output_nid generation:  0.026851415634155273
local_in_edges_tensor generation:  0.23249459266662598
mini_batch_src_global generation:  0.3745148181915283
r_  generation:  5.456434011459351
local_output_nid generation:  0.027986526489257812
local_in_edges_tensor generation:  0.23880600929260254
mini_batch_src_global generation:  0.4906272888183594
r_  generation:  5.5796287059783936
----------------------check_connections_block total spend ----------------------------- 14.583209991455078
generate_one_block  7.261786460876465
generate_one_block  7.047248363494873
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.093594312667847
gen group dst list time:  0.1040201187133789
time for parepare:  0.4888722896575928
local_output_nid generation:  0.26306724548339844
local_in_edges_tensor generation:  1.6616747379302979
mini_batch_src_global generation:  2.5237162113189697
r_  generation:  29.991934537887573
local_output_nid generation:  0.5344533920288086
local_in_edges_tensor generation:  2.080815076828003
mini_batch_src_global generation:  3.7502734661102295
r_  generation:  30.14697551727295
----------------------check_connections_block total spend ----------------------------- 83.47106981277466
generate_one_block  42.28638529777527
generate_one_block  41.15498495101929
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2633285522460938
gen group dst list time:  0.19743824005126953
time for parepare:  0.4766988754272461
local_output_nid generation:  0.4112727642059326
local_in_edges_tensor generation:  1.6227877140045166
mini_batch_src_global generation:  2.1267848014831543
r_  generation:  26.991163969039917
local_output_nid generation:  0.7312843799591064
local_in_edges_tensor generation:  1.9612925052642822
mini_batch_src_global generation:  3.2441418170928955
r_  generation:  26.864274978637695
----------------------check_connections_block total spend ----------------------------- 75.75455141067505
generate_one_block  35.41902542114258
generate_one_block  36.16183924674988
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422266483306885  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  159.2256212234497
block generation total time  155.022234916687
average batch blocks generation time:  77.5111174583435
block dataloader generation time/epoch 367.86118554929544
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39326274394989014 |1.322526216506958 |0.005042910575866699 |0.00017595291137695312 |0.005114912986755371 |0.0020542144775390625 |
----------------------------------------------------------pseudo_mini_loss sum 0.3546563982963562
Total (block generation + training)time/epoch 371.6963834623147
Training time/epoch 3.860649347305298
Training time without block to device /epoch 1.2155969142913818
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.06it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.71it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.12it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.52it/s] 40%|████      | 10/25 [00:00<00:00, 17.81it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.04it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.17it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.23it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.28it/s] 80%|████████  | 20/25 [00:01<00:00, 18.27it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.31it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.33it/s]100%|██████████| 25/25 [00:01<00:00, 18.22it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.47it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.48it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.51it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.55it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.53it/s] 40%|████      | 10/25 [00:01<00:02,  6.55it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.56it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.56it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.55it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.54it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.56it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.57it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.56it/s] 80%|████████  | 20/25 [00:03<00:00,  6.57it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.50it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.62it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.19it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.46it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.46it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.42it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.36it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  7.15it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]
Run 00 | Epoch 00171 | Loss 0.3547 | Train 0.7060 | Val 0.6962 | Test 0.5513
Number of nodes during this epoch:  4638163
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.420560359954834  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0107123851776123
range selection method range initialization spend 0.023568391799926758
time for parepare:  0.34833669662475586
local_output_nid generation:  0.026347637176513672
local_in_edges_tensor generation:  0.21248269081115723
mini_batch_src_global generation:  0.37012600898742676
r_  generation:  5.35955810546875
local_output_nid generation:  0.027344465255737305
local_in_edges_tensor generation:  0.1944434642791748
mini_batch_src_global generation:  0.4786949157714844
r_  generation:  5.5694005489349365
----------------------check_connections_block total spend ----------------------------- 14.198678016662598
generate_one_block  6.954779148101807
generate_one_block  7.00604248046875
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.004073143005371
gen group dst list time:  0.08350205421447754
time for parepare:  0.4163188934326172
local_output_nid generation:  0.23891806602478027
local_in_edges_tensor generation:  1.5816967487335205
mini_batch_src_global generation:  2.502023458480835
r_  generation:  30.00770115852356
local_output_nid generation:  0.5363631248474121
local_in_edges_tensor generation:  2.333315134048462
mini_batch_src_global generation:  3.75695538520813
r_  generation:  29.79658341407776
----------------------check_connections_block total spend ----------------------------- 83.75796103477478
generate_one_block  41.058828592300415
generate_one_block  40.842153787612915
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.260188579559326
gen group dst list time:  0.18181324005126953
time for parepare:  0.46654367446899414
local_output_nid generation:  0.3805365562438965
local_in_edges_tensor generation:  1.459618091583252
mini_batch_src_global generation:  2.0204672813415527
r_  generation:  25.52603816986084
local_output_nid generation:  0.7342791557312012
local_in_edges_tensor generation:  1.948815107345581
mini_batch_src_global generation:  2.93727445602417
r_  generation:  26.053114652633667
----------------------check_connections_block total spend ----------------------------- 71.2905387878418
generate_one_block  35.164711236953735
generate_one_block  35.962586641311646
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.420560359954834  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.04849982261658
block generation total time  153.0282802581787
average batch blocks generation time:  76.51414012908936
block dataloader generation time/epoch 367.8471353386724
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3886704444885254 |1.2997738122940063 |0.004390716552734375 |0.0001519918441772461 |0.00506138801574707 |0.0017938613891601562 |
----------------------------------------------------------pseudo_mini_loss sum 0.3545733094215393
Total (block generation + training)time/epoch 371.68221936253616
Training time/epoch 3.8154373168945312
Training time without block to device /epoch 1.2158896923065186
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.97it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.72it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.38it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.66it/s] 40%|████      | 10/25 [00:00<00:00, 17.87it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.14it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.23it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.29it/s] 80%|████████  | 20/25 [00:01<00:00, 18.29it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.23it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.26it/s]100%|██████████| 25/25 [00:01<00:00, 18.20it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.31it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.51it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.55it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.48it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.49it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.45it/s] 60%|██████    | 15/25 [00:02<00:01,  6.19it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.28it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.34it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.96it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.09it/s] 80%|████████  | 20/25 [00:03<00:00,  6.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.97it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.96it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.03it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.88it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]100%|██████████| 25/25 [00:03<00:00,  6.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.70it/s]  8%|▊         | 2/25 [00:00<00:03,  6.05it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.18it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.28it/s] 20%|██        | 5/25 [00:00<00:03,  6.33it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.37it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.37it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.32it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.33it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.39it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.39it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.18it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.89it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.01it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.78it/s]100%|██████████| 25/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.29it/s]
Run 00 | Epoch 00172 | Loss 0.3546 | Train 0.7064 | Val 0.6964 | Test 0.5518
Number of nodes during this epoch:  4637772
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428882122039795  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.075993537902832
range selection method range initialization spend 0.024225234985351562
time for parepare:  0.36185479164123535
local_output_nid generation:  0.025929927825927734
local_in_edges_tensor generation:  0.20929527282714844
mini_batch_src_global generation:  0.37258172035217285
r_  generation:  5.637476205825806
local_output_nid generation:  0.033144235610961914
local_in_edges_tensor generation:  0.23023271560668945
mini_batch_src_global generation:  0.4629242420196533
r_  generation:  5.806594133377075
----------------------check_connections_block total spend ----------------------------- 14.811391592025757
generate_one_block  7.1381635665893555
generate_one_block  6.854584693908691
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.928391695022583
gen group dst list time:  0.08468937873840332
time for parepare:  0.45409631729125977
local_output_nid generation:  0.2570061683654785
local_in_edges_tensor generation:  1.5912296772003174
mini_batch_src_global generation:  2.5739941596984863
r_  generation:  29.589414834976196
local_output_nid generation:  0.5225181579589844
local_in_edges_tensor generation:  2.103414535522461
mini_batch_src_global generation:  3.5791704654693604
r_  generation:  29.795433282852173
----------------------check_connections_block total spend ----------------------------- 82.55579662322998
generate_one_block  40.88024187088013
generate_one_block  40.61070370674133
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2054781913757324
gen group dst list time:  0.18088912963867188
time for parepare:  0.4705824851989746
local_output_nid generation:  0.3801884651184082
local_in_edges_tensor generation:  1.4875295162200928
mini_batch_src_global generation:  2.0313782691955566
r_  generation:  25.6890766620636
local_output_nid generation:  0.7401292324066162
local_in_edges_tensor generation:  1.9503934383392334
mini_batch_src_global generation:  2.9314956665039062
r_  generation:  26.106666564941406
----------------------check_connections_block total spend ----------------------------- 71.56201934814453
generate_one_block  35.324151277542114
generate_one_block  35.897605657577515
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428882122039795  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.1178159713745
block generation total time  152.7127025127411
average batch blocks generation time:  76.35635125637054
block dataloader generation time/epoch 367.8299883969257
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3931926488876343 |1.4131407737731934 |0.004381299018859863 |0.00015604496002197266 |0.005040287971496582 |0.0019326210021972656 |
----------------------------------------------------------pseudo_mini_loss sum 0.3535424470901489
Total (block generation + training)time/epoch 371.66626309521627
Training time/epoch 4.040900230407715
Training time without block to device /epoch 1.2146186828613281
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.08it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.63it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.40it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.76it/s] 40%|████      | 10/25 [00:00<00:00, 17.95it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.53it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.77it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.90it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.04it/s] 80%|████████  | 20/25 [00:01<00:00, 16.34it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.50it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.86it/s]100%|██████████| 25/25 [00:01<00:00, 17.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.64it/s]  8%|▊         | 2/25 [00:00<00:03,  6.16it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.15it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.26it/s] 20%|██        | 5/25 [00:00<00:03,  6.36it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.42it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.46it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.45it/s] 40%|████      | 10/25 [00:01<00:02,  6.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.44it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.47it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.91it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.03it/s] 60%|██████    | 15/25 [00:02<00:01,  6.18it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.20it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.28it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.36it/s]  8%|▊         | 2/25 [00:00<00:03,  6.28it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.32it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.29it/s] 20%|██        | 5/25 [00:00<00:03,  6.32it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.36it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.37it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.37it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.40it/s] 60%|██████    | 15/25 [00:02<00:01,  6.37it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.37it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.37it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.39it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.41it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.40it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00173 | Loss 0.3535 | Train 0.7049 | Val 0.6952 | Test 0.5510
Number of nodes during this epoch:  4637293
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427438259124756  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1464593410491943
range selection method range initialization spend 0.02684640884399414
time for parepare:  0.38446497917175293
local_output_nid generation:  0.02619647979736328
local_in_edges_tensor generation:  0.23363208770751953
mini_batch_src_global generation:  0.37188005447387695
r_  generation:  5.406267881393433
local_output_nid generation:  0.02760148048400879
local_in_edges_tensor generation:  0.21180248260498047
mini_batch_src_global generation:  0.4726142883300781
r_  generation:  5.643342971801758
----------------------check_connections_block total spend ----------------------------- 14.459516525268555
generate_one_block  7.182780742645264
generate_one_block  6.792816877365112
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.210095167160034
gen group dst list time:  0.09037399291992188
time for parepare:  0.4519474506378174
local_output_nid generation:  0.2551558017730713
local_in_edges_tensor generation:  1.6970181465148926
mini_batch_src_global generation:  2.423919916152954
r_  generation:  29.812929391860962
local_output_nid generation:  0.5188992023468018
local_in_edges_tensor generation:  2.07853102684021
mini_batch_src_global generation:  3.5364911556243896
r_  generation:  30.075714588165283
----------------------check_connections_block total spend ----------------------------- 82.74419903755188
generate_one_block  40.99212956428528
generate_one_block  40.99702262878418
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2485949993133545
gen group dst list time:  0.19233012199401855
time for parepare:  0.4974379539489746
local_output_nid generation:  0.4052116870880127
local_in_edges_tensor generation:  1.5444221496582031
mini_batch_src_global generation:  2.0831925868988037
r_  generation:  26.22220253944397
local_output_nid generation:  0.7230551242828369
local_in_edges_tensor generation:  1.9349093437194824
mini_batch_src_global generation:  2.8264918327331543
r_  generation:  26.09424376487732
----------------------check_connections_block total spend ----------------------------- 72.29559326171875
generate_one_block  35.23502278327942
generate_one_block  36.01330304145813
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427438259124756  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.03979229927063
block generation total time  153.237478017807
average batch blocks generation time:  76.6187390089035
block dataloader generation time/epoch 367.82175656433765
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3818455934524536 |1.2967933416366577 |0.004430294036865234 |0.00014650821685791016 |0.005090236663818359 |0.0029387474060058594 |
----------------------------------------------------------pseudo_mini_loss sum 0.3533475995063782
Total (block generation + training)time/epoch 371.65773525457274
Training time/epoch 3.784597158432007
Training time without block to device /epoch 1.1910104751586914
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.00it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.78it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.39it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.80it/s] 40%|████      | 10/25 [00:00<00:00, 17.77it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.15it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.24it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.18it/s] 80%|████████  | 20/25 [00:01<00:00, 18.24it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.27it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.28it/s]100%|██████████| 25/25 [00:01<00:00, 18.21it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.18it/s]  8%|▊         | 2/25 [00:00<00:04,  5.21it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.17it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.16it/s] 20%|██        | 5/25 [00:00<00:03,  5.17it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.18it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.19it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.20it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.18it/s] 40%|████      | 10/25 [00:01<00:02,  5.18it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.17it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.18it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.17it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.16it/s] 60%|██████    | 15/25 [00:02<00:01,  5.11it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.10it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.10it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.11it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.10it/s] 80%|████████  | 20/25 [00:03<00:00,  5.11it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.12it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.13it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.12it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.12it/s]100%|██████████| 25/25 [00:04<00:00,  5.72it/s]100%|██████████| 25/25 [00:04<00:00,  5.22it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.30it/s]  8%|▊         | 2/25 [00:00<00:03,  5.75it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.45it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.06it/s] 20%|██        | 5/25 [00:00<00:04,  4.95it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.19it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.80it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.02it/s] 40%|████      | 10/25 [00:01<00:02,  6.16it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.27it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.24it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.31it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.24it/s] 60%|██████    | 15/25 [00:02<00:01,  6.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.26it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.27it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.27it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.32it/s] 80%|████████  | 20/25 [00:03<00:00,  5.88it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.74it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.79it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.91it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.08it/s]100%|██████████| 25/25 [00:04<00:00,  6.02it/s]
Run 00 | Epoch 00174 | Loss 0.3533 | Train 0.7035 | Val 0.6946 | Test 0.5500
Number of nodes during this epoch:  4637177
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42379093170166  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.185577630996704
range selection method range initialization spend 0.02727198600769043
time for parepare:  0.38314175605773926
local_output_nid generation:  0.026355981826782227
local_in_edges_tensor generation:  0.21635866165161133
mini_batch_src_global generation:  0.3724682331085205
r_  generation:  5.604008436203003
local_output_nid generation:  0.027964115142822266
local_in_edges_tensor generation:  0.21613836288452148
mini_batch_src_global generation:  0.4875040054321289
r_  generation:  5.799666881561279
----------------------check_connections_block total spend ----------------------------- 14.794154405593872
generate_one_block  7.295753240585327
generate_one_block  7.103605508804321
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.925339460372925
gen group dst list time:  0.08797287940979004
time for parepare:  0.43969297409057617
local_output_nid generation:  0.25993990898132324
local_in_edges_tensor generation:  1.5949585437774658
mini_batch_src_global generation:  2.437964916229248
r_  generation:  28.993589878082275
local_output_nid generation:  0.47791361808776855
local_in_edges_tensor generation:  2.130631446838379
mini_batch_src_global generation:  3.388184070587158
r_  generation:  29.972115516662598
----------------------check_connections_block total spend ----------------------------- 81.56285071372986
generate_one_block  41.30299973487854
generate_one_block  41.323864459991455
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.233729124069214
gen group dst list time:  0.18167328834533691
time for parepare:  0.4325392246246338
local_output_nid generation:  0.38718223571777344
local_in_edges_tensor generation:  1.4653141498565674
mini_batch_src_global generation:  2.005885124206543
r_  generation:  25.729840993881226
local_output_nid generation:  0.7265489101409912
local_in_edges_tensor generation:  1.9369685649871826
mini_batch_src_global generation:  2.708627462387085
r_  generation:  26.483484029769897
----------------------check_connections_block total spend ----------------------------- 71.97073721885681
generate_one_block  35.34294509887695
generate_one_block  36.107181549072266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42379093170166  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.53358793258667
block generation total time  154.0769908428192
average batch blocks generation time:  77.0384954214096
block dataloader generation time/epoch 367.814283424105
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39123308658599854 |1.314244270324707 |0.004453063011169434 |0.00014984607696533203 |0.005289912223815918 |0.0016994476318359375 |
----------------------------------------------------------pseudo_mini_loss sum 0.3539659380912781
Total (block generation + training)time/epoch 371.6503367355892
Training time/epoch 3.8488669395446777
Training time without block to device /epoch 1.2203783988952637
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.01it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.52it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.22it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:01, 14.00it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.11it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.02it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.64it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.11it/s] 80%|████████  | 20/25 [00:01<00:00, 17.46it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.64it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.85it/s]100%|██████████| 25/25 [00:01<00:00, 17.05it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.42it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.48it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.52it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.50it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.51it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.51it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.45it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.46it/s]100%|██████████| 25/25 [00:03<00:00,  6.58it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.24it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.36it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.41it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.17it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.25it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.29it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.28it/s] 40%|████      | 10/25 [00:01<00:02,  6.32it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.16it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.22it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.26it/s] 60%|██████    | 15/25 [00:02<00:01,  6.10it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.19it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.27it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.16it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.24it/s] 80%|████████  | 20/25 [00:03<00:00,  6.28it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.40it/s]
Run 00 | Epoch 00175 | Loss 0.3540 | Train 0.7042 | Val 0.6947 | Test 0.5503
Number of nodes during this epoch:  4637904
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428297519683838  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1559832096099854
range selection method range initialization spend 0.024594545364379883
time for parepare:  0.3433492183685303
local_output_nid generation:  0.026032447814941406
local_in_edges_tensor generation:  0.18137407302856445
mini_batch_src_global generation:  0.37363648414611816
r_  generation:  5.379316806793213
local_output_nid generation:  0.027010679244995117
local_in_edges_tensor generation:  0.19574904441833496
mini_batch_src_global generation:  0.46019625663757324
r_  generation:  5.596194505691528
----------------------check_connections_block total spend ----------------------------- 14.177072286605835
generate_one_block  7.181707382202148
generate_one_block  6.82874608039856
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.038134574890137
gen group dst list time:  0.08819174766540527
time for parepare:  0.45374178886413574
local_output_nid generation:  0.2616908550262451
local_in_edges_tensor generation:  1.5535838603973389
mini_batch_src_global generation:  2.45004940032959
r_  generation:  29.559260845184326
local_output_nid generation:  0.5149595737457275
local_in_edges_tensor generation:  2.103623151779175
mini_batch_src_global generation:  3.5188584327697754
r_  generation:  30.031940937042236
----------------------check_connections_block total spend ----------------------------- 82.59031963348389
generate_one_block  40.80023193359375
generate_one_block  40.82717251777649
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.217344284057617
gen group dst list time:  0.18210864067077637
time for parepare:  0.44123029708862305
local_output_nid generation:  0.3899812698364258
local_in_edges_tensor generation:  1.4697973728179932
mini_batch_src_global generation:  2.0196115970611572
r_  generation:  26.172719478607178
local_output_nid generation:  0.7406225204467773
local_in_edges_tensor generation:  1.9682087898254395
mini_batch_src_global generation:  3.0303611755371094
r_  generation:  26.081635236740112
----------------------check_connections_block total spend ----------------------------- 72.51165127754211
generate_one_block  35.59284257888794
generate_one_block  36.0959837436676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428297519683838  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.101970911026
block generation total time  153.31623077392578
average batch blocks generation time:  76.65811538696289
block dataloader generation time/epoch 367.80331991883844
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38518810272216797 |1.323272466659546 |0.004879951477050781 |0.00017404556274414062 |0.005112886428833008 |0.0038671493530273438 |
----------------------------------------------------------pseudo_mini_loss sum 0.35343557596206665
Total (block generation + training)time/epoch 371.6394513168118
Training time/epoch 3.8496203422546387
Training time without block to device /epoch 1.2030754089355469
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.48it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.23it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.67it/s] 40%|████      | 10/25 [00:00<00:00, 17.90it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.93it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.09it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.07it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.07it/s] 80%|████████  | 20/25 [00:01<00:00, 18.13it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.20it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.13it/s]100%|██████████| 25/25 [00:01<00:00, 17.99it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.52it/s]  8%|▊         | 2/25 [00:00<00:04,  5.75it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.27it/s] 20%|██        | 5/25 [00:00<00:03,  5.22it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.19it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.16it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.11it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.91it/s] 40%|████      | 10/25 [00:01<00:03,  4.93it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.31it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.65it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.72it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.85it/s] 60%|██████    | 15/25 [00:02<00:01,  5.72it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.63it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.71it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.86it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.02it/s] 80%|████████  | 20/25 [00:03<00:00,  6.11it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.29it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.37it/s]100%|██████████| 25/25 [00:04<00:00,  5.80it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.21it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.36it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.35it/s] 20%|██        | 5/25 [00:00<00:03,  5.85it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.05it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.16it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.24it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.26it/s] 40%|████      | 10/25 [00:01<00:02,  6.30it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.31it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.84it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.73it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.81it/s] 60%|██████    | 15/25 [00:02<00:01,  5.93it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.05it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.13it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.17it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.18it/s] 80%|████████  | 20/25 [00:03<00:00,  6.15it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.12it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.13it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.13it/s]100%|██████████| 25/25 [00:04<00:00,  6.91it/s]100%|██████████| 25/25 [00:04<00:00,  6.20it/s]
Run 00 | Epoch 00176 | Loss 0.3534 | Train 0.7047 | Val 0.6956 | Test 0.5509
Number of nodes during this epoch:  4637733
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4240522384643555  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1374223232269287
range selection method range initialization spend 0.02498316764831543
time for parepare:  0.3672330379486084
local_output_nid generation:  0.026242733001708984
local_in_edges_tensor generation:  0.21947717666625977
mini_batch_src_global generation:  0.3735237121582031
r_  generation:  5.454899787902832
local_output_nid generation:  0.027539491653442383
local_in_edges_tensor generation:  0.2253890037536621
mini_batch_src_global generation:  0.4689774513244629
r_  generation:  5.762812376022339
----------------------check_connections_block total spend ----------------------------- 14.579594135284424
generate_one_block  7.259926080703735
generate_one_block  6.776981592178345
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9988675117492676
gen group dst list time:  0.08708596229553223
time for parepare:  0.4440150260925293
local_output_nid generation:  0.2717726230621338
local_in_edges_tensor generation:  1.622804880142212
mini_batch_src_global generation:  2.5927493572235107
r_  generation:  29.876444578170776
local_output_nid generation:  0.5268661975860596
local_in_edges_tensor generation:  2.0598738193511963
mini_batch_src_global generation:  3.4775755405426025
r_  generation:  29.845584630966187
----------------------check_connections_block total spend ----------------------------- 82.69972562789917
generate_one_block  40.76723647117615
generate_one_block  40.811678409576416
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.167029857635498
gen group dst list time:  0.1840066909790039
time for parepare:  0.4397854804992676
local_output_nid generation:  0.4010434150695801
local_in_edges_tensor generation:  1.4965875148773193
mini_batch_src_global generation:  2.175316572189331
r_  generation:  26.527897596359253
local_output_nid generation:  0.7393250465393066
local_in_edges_tensor generation:  1.9352903366088867
mini_batch_src_global generation:  2.818540096282959
r_  generation:  26.165392875671387
----------------------check_connections_block total spend ----------------------------- 72.87339639663696
generate_one_block  35.32839870452881
generate_one_block  36.178741693496704
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4240522384643555  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.57312202453613
block generation total time  153.08605527877808
average batch blocks generation time:  76.54302763938904
block dataloader generation time/epoch 367.7968915384368
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37404346466064453 |1.2944307327270508 |0.00450444221496582 |0.00014960765838623047 |0.005069136619567871 |0.0020737648010253906 |
----------------------------------------------------------pseudo_mini_loss sum 0.35359030961990356
Total (block generation + training)time/epoch 371.6326461080777
Training time/epoch 3.769244432449341
Training time without block to device /epoch 1.1803829669952393
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.09it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.70it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.30it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.67it/s] 40%|████      | 10/25 [00:00<00:00, 17.90it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.97it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.02it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.98it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.04it/s] 80%|████████  | 20/25 [00:01<00:00, 18.14it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.96it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.87it/s]100%|██████████| 25/25 [00:01<00:00, 18.02it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.76it/s]  8%|▊         | 2/25 [00:00<00:03,  6.75it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.81it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.81it/s] 20%|██        | 5/25 [00:00<00:02,  6.83it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.22it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.85it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.63it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.50it/s] 40%|████      | 10/25 [00:01<00:02,  5.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.28it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.20it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.18it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.18it/s] 60%|██████    | 15/25 [00:02<00:01,  5.00it/s] 64%|██████▍   | 16/25 [00:02<00:01,  4.92it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.15it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.38it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.12it/s] 80%|████████  | 20/25 [00:03<00:01,  4.86it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.07it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.50it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.71it/s]100%|██████████| 25/25 [00:04<00:00,  5.61it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.01it/s]  8%|▊         | 2/25 [00:00<00:03,  6.13it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.20it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.31it/s] 20%|██        | 5/25 [00:00<00:04,  4.92it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.19it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.43it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.73it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.94it/s] 40%|████      | 10/25 [00:01<00:02,  6.13it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.21it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.28it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.93it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.57it/s] 60%|██████    | 15/25 [00:02<00:01,  5.70it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.83it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.91it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.04it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.16it/s] 80%|████████  | 20/25 [00:03<00:00,  6.27it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.34it/s]100%|██████████| 25/25 [00:04<00:00,  6.05it/s]
Run 00 | Epoch 00177 | Loss 0.3536 | Train 0.7045 | Val 0.6955 | Test 0.5511
Number of nodes during this epoch:  4637128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425055980682373  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.141671895980835
range selection method range initialization spend 0.02468085289001465
time for parepare:  0.35082030296325684
local_output_nid generation:  0.026083707809448242
local_in_edges_tensor generation:  0.2166914939880371
mini_batch_src_global generation:  0.37822532653808594
r_  generation:  5.556935787200928
local_output_nid generation:  0.02884984016418457
local_in_edges_tensor generation:  0.2294154167175293
mini_batch_src_global generation:  0.4555623531341553
r_  generation:  5.798630714416504
----------------------check_connections_block total spend ----------------------------- 14.735034227371216
generate_one_block  7.155638217926025
generate_one_block  6.803585052490234
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9639060497283936
gen group dst list time:  0.09152913093566895
time for parepare:  0.42765259742736816
local_output_nid generation:  0.24773740768432617
local_in_edges_tensor generation:  1.5347294807434082
mini_batch_src_global generation:  2.402771472930908
r_  generation:  28.996142864227295
local_output_nid generation:  0.4906301498413086
local_in_edges_tensor generation:  2.0752949714660645
mini_batch_src_global generation:  3.3644654750823975
r_  generation:  29.885920524597168
----------------------check_connections_block total spend ----------------------------- 80.89829063415527
generate_one_block  41.12921905517578
generate_one_block  40.89833164215088
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3070967197418213
gen group dst list time:  0.1929459571838379
time for parepare:  0.4734663963317871
local_output_nid generation:  0.4018571376800537
local_in_edges_tensor generation:  1.5336697101593018
mini_batch_src_global generation:  2.173734188079834
r_  generation:  26.424920320510864
local_output_nid generation:  0.7304105758666992
local_in_edges_tensor generation:  1.939655065536499
mini_batch_src_global generation:  2.83808970451355
r_  generation:  26.056673049926758
----------------------check_connections_block total spend ----------------------------- 72.50372648239136
generate_one_block  35.27409243583679
generate_one_block  36.99907565116882
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425055980682373  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.40201711654663
block generation total time  154.30071878433228
average batch blocks generation time:  77.15035939216614
block dataloader generation time/epoch 367.7888980032353
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39518046379089355 |1.345218300819397 |0.004380226135253906 |0.000152587890625 |0.005055069923400879 |0.0029609203338623047 |
----------------------------------------------------------pseudo_mini_loss sum 0.35329824686050415
Total (block generation + training)time/epoch 371.6250620571415
Training time/epoch 3.908474922180176
Training time without block to device /epoch 1.2180383205413818
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.63it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.99it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.52it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.80it/s] 40%|████      | 10/25 [00:00<00:00, 17.76it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.78it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.76it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.80it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.70it/s] 80%|████████  | 20/25 [00:01<00:00, 17.76it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.78it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.64it/s]100%|██████████| 25/25 [00:01<00:00, 17.88it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.60it/s]  8%|▊         | 2/25 [00:00<00:03,  6.64it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.55it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.56it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.55it/s] 40%|████      | 10/25 [00:01<00:02,  6.53it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.54it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.53it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.53it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.52it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.62it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.14it/s]  8%|▊         | 2/25 [00:00<00:03,  6.24it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.28it/s] 20%|██        | 5/25 [00:00<00:03,  6.32it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.38it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.38it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.42it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.40it/s] 60%|██████    | 15/25 [00:02<00:01,  6.37it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.37it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.34it/s]100%|██████████| 25/25 [00:03<00:00,  7.06it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00178 | Loss 0.3533 | Train 0.7047 | Val 0.6962 | Test 0.5511
Number of nodes during this epoch:  4637605
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422506809234619  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1179075241088867
range selection method range initialization spend 0.024457454681396484
time for parepare:  0.39400362968444824
local_output_nid generation:  0.026054859161376953
local_in_edges_tensor generation:  0.25714898109436035
mini_batch_src_global generation:  0.3789949417114258
r_  generation:  5.420956373214722
local_output_nid generation:  0.02829289436340332
local_in_edges_tensor generation:  0.19507408142089844
mini_batch_src_global generation:  0.4563884735107422
r_  generation:  5.6420488357543945
----------------------check_connections_block total spend ----------------------------- 14.45511507987976
generate_one_block  7.283441066741943
generate_one_block  6.9821577072143555
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.195681571960449
gen group dst list time:  0.09710168838500977
time for parepare:  0.46013617515563965
local_output_nid generation:  0.2790186405181885
local_in_edges_tensor generation:  1.7020416259765625
mini_batch_src_global generation:  2.429344654083252
r_  generation:  29.779351949691772
local_output_nid generation:  0.5443346500396729
local_in_edges_tensor generation:  2.332796812057495
mini_batch_src_global generation:  3.5121867656707764
r_  generation:  30.199366092681885
----------------------check_connections_block total spend ----------------------------- 83.4909393787384
generate_one_block  41.19618272781372
generate_one_block  41.41367292404175
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2242848873138428
gen group dst list time:  0.18840718269348145
time for parepare:  0.5235650539398193
local_output_nid generation:  0.43857693672180176
local_in_edges_tensor generation:  1.6510396003723145
mini_batch_src_global generation:  2.0711798667907715
r_  generation:  27.140958547592163
local_output_nid generation:  0.7402596473693848
local_in_edges_tensor generation:  2.0486209392547607
mini_batch_src_global generation:  2.8330607414245605
r_  generation:  26.305810689926147
----------------------check_connections_block total spend ----------------------------- 74.4796130657196
generate_one_block  35.225075483322144
generate_one_block  36.03402829170227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422506809234619  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.970552444458
block generation total time  153.86895942687988
average batch blocks generation time:  76.93447971343994
block dataloader generation time/epoch 367.8050791964185
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3794996738433838 |1.3054234981536865 |0.004328012466430664 |0.00015592575073242188 |0.005202651023864746 |0.0013990402221679688 |
----------------------------------------------------------pseudo_mini_loss sum 0.3517106771469116
Total (block generation + training)time/epoch 371.6410281698131
Training time/epoch 3.7974915504455566
Training time without block to device /epoch 1.1866445541381836
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.70it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.32it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:00, 17.99it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.12it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.25it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.31it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.28it/s] 80%|████████  | 20/25 [00:01<00:00, 18.34it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.37it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.41it/s]100%|██████████| 25/25 [00:01<00:00, 18.31it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.62it/s]  8%|▊         | 2/25 [00:00<00:03,  6.64it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.65it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.62it/s] 20%|██        | 5/25 [00:00<00:03,  6.62it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.63it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.62it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.62it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.60it/s] 40%|████      | 10/25 [00:01<00:02,  6.62it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.17it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.84it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.65it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.49it/s] 60%|██████    | 15/25 [00:02<00:01,  5.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.31it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.59it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.67it/s] 80%|████████  | 20/25 [00:03<00:00,  5.91it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.05it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.17it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.28it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.17it/s]100%|██████████| 25/25 [00:04<00:00,  6.92it/s]100%|██████████| 25/25 [00:04<00:00,  6.15it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.08it/s]  8%|▊         | 2/25 [00:00<00:03,  5.89it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.15it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.26it/s] 20%|██        | 5/25 [00:00<00:03,  6.13it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.24it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.32it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.35it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.43it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.44it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.43it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.42it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.46it/s]100%|██████████| 25/25 [00:03<00:00,  7.23it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00179 | Loss 0.3517 | Train 0.7045 | Val 0.6959 | Test 0.5509
Number of nodes during this epoch:  4637691
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423566818237305  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.083411455154419
range selection method range initialization spend 0.025107145309448242
time for parepare:  0.3535609245300293
local_output_nid generation:  0.026122093200683594
local_in_edges_tensor generation:  0.19505023956298828
mini_batch_src_global generation:  0.3706328868865967
r_  generation:  5.392956256866455
local_output_nid generation:  0.02744603157043457
local_in_edges_tensor generation:  0.19737601280212402
mini_batch_src_global generation:  0.45853614807128906
r_  generation:  5.640767812728882
----------------------check_connections_block total spend ----------------------------- 14.290923595428467
generate_one_block  7.1948418617248535
generate_one_block  6.997467041015625
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.051469802856445
gen group dst list time:  0.08439779281616211
time for parepare:  0.4152350425720215
local_output_nid generation:  0.24836444854736328
local_in_edges_tensor generation:  1.605680227279663
mini_batch_src_global generation:  2.453106641769409
r_  generation:  29.56218147277832
local_output_nid generation:  0.5187087059020996
local_in_edges_tensor generation:  2.094627618789673
mini_batch_src_global generation:  3.535090684890747
r_  generation:  30.02388882637024
----------------------check_connections_block total spend ----------------------------- 82.58951187133789
generate_one_block  40.799973249435425
generate_one_block  41.00565695762634
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2565724849700928
gen group dst list time:  0.19122052192687988
time for parepare:  0.47185540199279785
local_output_nid generation:  0.41829609870910645
local_in_edges_tensor generation:  1.6989109516143799
mini_batch_src_global generation:  2.0748894214630127
r_  generation:  26.238853454589844
local_output_nid generation:  0.7390651702880859
local_in_edges_tensor generation:  1.9801416397094727
mini_batch_src_global generation:  2.8204002380371094
r_  generation:  26.151435613632202
----------------------check_connections_block total spend ----------------------------- 72.70788216590881
generate_one_block  35.3428692817688
generate_one_block  36.10002136230469
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423566818237305  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.2973940372467
block generation total time  153.24852085113525
average batch blocks generation time:  76.62426042556763
block dataloader generation time/epoch 367.7973230547375
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3815103769302368 |1.309484601020813 |0.004423737525939941 |0.00014841556549072266 |0.005084514617919922 |0.0028791427612304688 |
----------------------------------------------------------pseudo_mini_loss sum 0.3508933186531067
Total (block generation + training)time/epoch 371.63315756718316
Training time/epoch 3.8151731491088867
Training time without block to device /epoch 1.1962039470672607
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.89it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.49it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.23it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.51it/s] 40%|████      | 10/25 [00:00<00:01, 14.01it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.24it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.71it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.14it/s] 80%|████████  | 20/25 [00:01<00:00, 17.43it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.62it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.74it/s]100%|██████████| 25/25 [00:01<00:00, 16.97it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.62it/s]  8%|▊         | 2/25 [00:00<00:04,  5.70it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.29it/s] 20%|██        | 5/25 [00:00<00:03,  5.19it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.00it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.96it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.70it/s] 40%|████      | 10/25 [00:01<00:02,  5.40it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.98it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.85it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.18it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.49it/s] 60%|██████    | 15/25 [00:02<00:01,  5.28it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.33it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.57it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.90it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.15it/s] 80%|████████  | 20/25 [00:03<00:00,  5.82it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.60it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.47it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.32it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.23it/s]100%|██████████| 25/25 [00:04<00:00,  5.98it/s]100%|██████████| 25/25 [00:04<00:00,  5.47it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:04,  5.46it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.28it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.18it/s] 20%|██        | 5/25 [00:00<00:03,  5.14it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.07it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.03it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.59it/s] 40%|████      | 10/25 [00:01<00:02,  5.84it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.98it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.16it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.29it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.33it/s] 60%|██████    | 15/25 [00:02<00:01,  6.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.45it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.28it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.91it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.06it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.20it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.29it/s]100%|██████████| 25/25 [00:04<00:00,  6.05it/s]
Run 00 | Epoch 00180 | Loss 0.3509 | Train 0.7040 | Val 0.6953 | Test 0.5503
Number of nodes during this epoch:  4637976
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426417827606201  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.125903606414795
range selection method range initialization spend 0.024663209915161133
time for parepare:  0.3984696865081787
local_output_nid generation:  0.026555776596069336
local_in_edges_tensor generation:  0.23175668716430664
mini_batch_src_global generation:  0.3727843761444092
r_  generation:  5.390447616577148
local_output_nid generation:  0.028298377990722656
local_in_edges_tensor generation:  0.19672703742980957
mini_batch_src_global generation:  0.47077059745788574
r_  generation:  5.712299823760986
----------------------check_connections_block total spend ----------------------------- 14.51356291770935
generate_one_block  7.301480054855347
generate_one_block  6.975372314453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.145226955413818
gen group dst list time:  0.09040307998657227
time for parepare:  0.464632511138916
local_output_nid generation:  0.2728583812713623
local_in_edges_tensor generation:  1.6492528915405273
mini_batch_src_global generation:  2.496142864227295
r_  generation:  29.9454402923584
local_output_nid generation:  0.5281639099121094
local_in_edges_tensor generation:  2.089066505432129
mini_batch_src_global generation:  3.5241963863372803
r_  generation:  29.973531007766724
----------------------check_connections_block total spend ----------------------------- 82.98479199409485
generate_one_block  40.7525577545166
generate_one_block  40.74452757835388
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.299298048019409
gen group dst list time:  0.19975709915161133
time for parepare:  0.499957799911499
local_output_nid generation:  0.42632269859313965
local_in_edges_tensor generation:  1.5815935134887695
mini_batch_src_global generation:  2.0242273807525635
r_  generation:  26.306527614593506
local_output_nid generation:  0.7471680641174316
local_in_edges_tensor generation:  1.9512991905212402
mini_batch_src_global generation:  2.837923049926758
r_  generation:  26.44868230819702
----------------------check_connections_block total spend ----------------------------- 72.8660819530487
generate_one_block  35.353373765945435
generate_one_block  36.28324508666992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426417827606201  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.85087394714355
block generation total time  153.13370418548584
average batch blocks generation time:  76.56685209274292
block dataloader generation time/epoch 367.8012883952968
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39946234226226807 |1.3161884546279907 |0.004519224166870117 |0.0001556873321533203 |0.00514984130859375 |0.0028579235076904297 |
----------------------------------------------------------pseudo_mini_loss sum 0.3509824872016907
Total (block generation + training)time/epoch 371.63727855418927
Training time/epoch 3.8638150691986084
Training time without block to device /epoch 1.231438159942627
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.73it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.32it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.69it/s] 40%|████      | 10/25 [00:00<00:00, 17.94it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.11it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.13it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.20it/s] 80%|████████  | 20/25 [00:01<00:00, 18.27it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.30it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.27it/s]100%|██████████| 25/25 [00:01<00:00, 18.21it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.39it/s]  8%|▊         | 2/25 [00:00<00:03,  6.31it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.49it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.53it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.55it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.50it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.52it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.50it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.48it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.46it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.41it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.38it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.37it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.42it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.39it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.37it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.33it/s] 60%|██████    | 15/25 [00:02<00:01,  6.21it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.29it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.09it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.18it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.26it/s] 80%|████████  | 20/25 [00:03<00:00,  6.07it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.17it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.21it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.26it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.31it/s]100%|██████████| 25/25 [00:03<00:00,  6.40it/s]
Run 00 | Epoch 00181 | Loss 0.3510 | Train 0.7030 | Val 0.6943 | Test 0.5497
Number of nodes during this epoch:  4638209
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42355489730835  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1394102573394775
range selection method range initialization spend 0.02445220947265625
time for parepare:  0.36229729652404785
local_output_nid generation:  0.02657771110534668
local_in_edges_tensor generation:  0.20134902000427246
mini_batch_src_global generation:  0.37334275245666504
r_  generation:  5.452970027923584
local_output_nid generation:  0.027924537658691406
local_in_edges_tensor generation:  0.1966722011566162
mini_batch_src_global generation:  0.45990562438964844
r_  generation:  5.659112453460693
----------------------check_connections_block total spend ----------------------------- 14.427942276000977
generate_one_block  7.211110353469849
generate_one_block  7.219254493713379
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.111987590789795
gen group dst list time:  0.09069299697875977
time for parepare:  0.4503793716430664
local_output_nid generation:  0.2718381881713867
local_in_edges_tensor generation:  1.632481575012207
mini_batch_src_global generation:  2.5405311584472656
r_  generation:  29.863142490386963
local_output_nid generation:  0.5325405597686768
local_in_edges_tensor generation:  2.036503553390503
mini_batch_src_global generation:  3.5815882682800293
r_  generation:  30.311790943145752
----------------------check_connections_block total spend ----------------------------- 83.13579726219177
generate_one_block  40.819297313690186
generate_one_block  40.94755291938782
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1912894248962402
gen group dst list time:  0.1885981559753418
time for parepare:  0.47372937202453613
local_output_nid generation:  0.37976551055908203
local_in_edges_tensor generation:  1.5459644794464111
mini_batch_src_global generation:  2.19870924949646
r_  generation:  26.28693652153015
local_output_nid generation:  0.7279882431030273
local_in_edges_tensor generation:  1.901846170425415
mini_batch_src_global generation:  2.8099918365478516
r_  generation:  26.06930947303772
----------------------check_connections_block total spend ----------------------------- 72.36113238334656
generate_one_block  35.16218638420105
generate_one_block  35.842270374298096
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42355489730835  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.49692964553833
block generation total time  152.77130699157715
average batch blocks generation time:  76.38565349578857
block dataloader generation time/epoch 367.79739966890315
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3753647804260254 |1.281227469444275 |0.004416108131408691 |0.00015270709991455078 |0.005031108856201172 |0.0030138492584228516 |
----------------------------------------------------------pseudo_mini_loss sum 0.3504006862640381
Total (block generation + training)time/epoch 371.632910490036
Training time/epoch 3.7485830783843994
Training time without block to device /epoch 1.1861281394958496
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.12it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.42it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.08it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.51it/s] 40%|████      | 10/25 [00:00<00:00, 16.65it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.18it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.49it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.70it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.87it/s] 80%|████████  | 20/25 [00:01<00:00, 17.97it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.04it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.97it/s]100%|██████████| 25/25 [00:01<00:00, 17.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.57it/s]  8%|▊         | 2/25 [00:00<00:03,  6.68it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.69it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.06it/s] 20%|██        | 5/25 [00:00<00:03,  5.73it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.53it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.41it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.34it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.27it/s] 40%|████      | 10/25 [00:01<00:02,  5.24it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.18it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.20it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.17it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.99it/s] 60%|██████    | 15/25 [00:02<00:01,  5.03it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.05it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.07it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.91it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.89it/s] 80%|████████  | 20/25 [00:03<00:00,  5.05it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.33it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.61it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.87it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.04it/s]100%|██████████| 25/25 [00:04<00:00,  5.54it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.83it/s]  8%|▊         | 2/25 [00:00<00:04,  5.68it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.88it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.16it/s] 20%|██        | 5/25 [00:00<00:03,  6.20it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.32it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.01it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.16it/s] 40%|████      | 10/25 [00:01<00:02,  6.28it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.02it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.14it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.24it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.33it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.44it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.13it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.08it/s] 80%|████████  | 20/25 [00:03<00:00,  6.15it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.99it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.03it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.09it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.15it/s]100%|██████████| 25/25 [00:04<00:00,  6.96it/s]100%|██████████| 25/25 [00:04<00:00,  6.24it/s]
Run 00 | Epoch 00182 | Loss 0.3504 | Train 0.7026 | Val 0.6936 | Test 0.5499
Number of nodes during this epoch:  4637900
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424348831176758  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1234865188598633
range selection method range initialization spend 0.026351451873779297
time for parepare:  0.40223026275634766
local_output_nid generation:  0.027849674224853516
local_in_edges_tensor generation:  0.21870064735412598
mini_batch_src_global generation:  0.37351274490356445
r_  generation:  5.591393709182739
local_output_nid generation:  0.029528379440307617
local_in_edges_tensor generation:  0.23263096809387207
mini_batch_src_global generation:  0.4577491283416748
r_  generation:  5.799669504165649
----------------------check_connections_block total spend ----------------------------- 14.821268320083618
generate_one_block  7.172544479370117
generate_one_block  6.880531311035156
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.020294904708862
gen group dst list time:  0.09199810028076172
time for parepare:  0.47704529762268066
local_output_nid generation:  0.28270816802978516
local_in_edges_tensor generation:  1.7173469066619873
mini_batch_src_global generation:  2.50010085105896
r_  generation:  30.09669780731201
local_output_nid generation:  0.5240259170532227
local_in_edges_tensor generation:  2.20385479927063
mini_batch_src_global generation:  3.7622158527374268
r_  generation:  29.9678316116333
----------------------check_connections_block total spend ----------------------------- 84.0542504787445
generate_one_block  41.32983183860779
generate_one_block  41.101024866104126
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2636260986328125
gen group dst list time:  0.18072795867919922
time for parepare:  0.4412856101989746
local_output_nid generation:  0.4007711410522461
local_in_edges_tensor generation:  1.4822182655334473
mini_batch_src_global generation:  2.222996711730957
r_  generation:  26.18974232673645
local_output_nid generation:  0.7307021617889404
local_in_edges_tensor generation:  1.9235308170318604
mini_batch_src_global generation:  2.845158100128174
r_  generation:  26.13532781600952
----------------------check_connections_block total spend ----------------------------- 72.82807779312134
generate_one_block  35.133342027664185
generate_one_block  35.866111278533936
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424348831176758  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.88232827186584
block generation total time  153.43031001091003
average batch blocks generation time:  76.71515500545502
block dataloader generation time/epoch 367.80367891124035
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3814162015914917 |1.3035088777542114 |0.004336714744567871 |0.00014781951904296875 |0.005146980285644531 |0.0017807483673095703 |
----------------------------------------------------------pseudo_mini_loss sum 0.3503850996494293
Total (block generation + training)time/epoch 371.6389977801693
Training time/epoch 3.8002102375030518
Training time without block to device /epoch 1.193192481994629
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.28it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.90it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.40it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.79it/s] 40%|████      | 10/25 [00:00<00:00, 18.02it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.06it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.14it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.12it/s] 80%|████████  | 20/25 [00:01<00:00, 18.04it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.77it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.97it/s]100%|██████████| 25/25 [00:01<00:00, 18.08it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.66it/s]  8%|▊         | 2/25 [00:00<00:03,  6.74it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.73it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.72it/s] 20%|██        | 5/25 [00:00<00:02,  6.78it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.73it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.72it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.70it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.74it/s] 40%|████      | 10/25 [00:01<00:02,  6.75it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.77it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.76it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.55it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.60it/s] 60%|██████    | 15/25 [00:02<00:01,  6.64it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.28it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.11it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.14it/s] 80%|████████  | 20/25 [00:03<00:00,  6.25it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.21it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.26it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.62it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.01it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  5.81it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.71it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.84it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.04it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.19it/s] 40%|████      | 10/25 [00:01<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.37it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.45it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.40it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.48it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.57it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.54it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.59it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.52it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.33it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.32it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:03<00:00,  7.09it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
Run 00 | Epoch 00183 | Loss 0.3504 | Train 0.7027 | Val 0.6933 | Test 0.5501
Number of nodes during this epoch:  4637720
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426497936248779  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1419398784637451
range selection method range initialization spend 0.024063825607299805
time for parepare:  0.35933661460876465
local_output_nid generation:  0.027770519256591797
local_in_edges_tensor generation:  0.23450589179992676
mini_batch_src_global generation:  0.3765127658843994
r_  generation:  5.6452436447143555
local_output_nid generation:  0.029211997985839844
local_in_edges_tensor generation:  0.2315843105316162
mini_batch_src_global generation:  0.4717552661895752
r_  generation:  5.861250877380371
----------------------check_connections_block total spend ----------------------------- 14.940500974655151
generate_one_block  7.217312574386597
generate_one_block  6.919921875
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.013258934020996
gen group dst list time:  0.09427523612976074
time for parepare:  0.49915194511413574
local_output_nid generation:  0.2673957347869873
local_in_edges_tensor generation:  1.7361938953399658
mini_batch_src_global generation:  2.5105743408203125
r_  generation:  29.92120623588562
local_output_nid generation:  0.5379393100738525
local_in_edges_tensor generation:  2.2585649490356445
mini_batch_src_global generation:  3.7539570331573486
r_  generation:  30.207628965377808
----------------------check_connections_block total spend ----------------------------- 83.64107751846313
generate_one_block  41.12398386001587
generate_one_block  40.80004644393921
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3634514808654785
gen group dst list time:  0.18782424926757812
time for parepare:  0.47296977043151855
local_output_nid generation:  0.4123528003692627
local_in_edges_tensor generation:  1.5751276016235352
mini_batch_src_global generation:  2.018289804458618
r_  generation:  26.34041476249695
local_output_nid generation:  0.7398281097412109
local_in_edges_tensor generation:  1.9440059661865234
mini_batch_src_global generation:  2.820119857788086
r_  generation:  26.32832646369934
----------------------check_connections_block total spend ----------------------------- 72.94992065429688
generate_one_block  35.470521450042725
generate_one_block  36.156699419021606
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426497936248779  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.59099817276
block generation total time  153.5512511730194
average batch blocks generation time:  76.7756255865097
block dataloader generation time/epoch 367.8095310939395
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3935561180114746 |1.2597154378890991 |0.004387617111206055 |0.00014901161193847656 |0.005082607269287109 |0.0030698776245117188 |
----------------------------------------------------------pseudo_mini_loss sum 0.3496953248977661
Total (block generation + training)time/epoch 371.6443304989649
Training time/epoch 3.7395641803741455
Training time without block to device /epoch 1.2201333045959473
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.74it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.55it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.06it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.49it/s] 40%|████      | 10/25 [00:00<00:00, 17.74it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.96it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.99it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.10it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.19it/s] 80%|████████  | 20/25 [00:01<00:00, 18.16it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.20it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.23it/s]100%|██████████| 25/25 [00:01<00:00, 18.10it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.49it/s]  8%|▊         | 2/25 [00:00<00:03,  6.54it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.56it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.55it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.55it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.55it/s] 40%|████      | 10/25 [00:01<00:02,  6.55it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.54it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.54it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.56it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.53it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.53it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.32it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.37it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.14it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.12it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.47it/s]  8%|▊         | 2/25 [00:00<00:03,  6.01it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.85it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.05it/s] 20%|██        | 5/25 [00:00<00:03,  6.12it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.20it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.26it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.31it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.33it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.37it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.37it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.34it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.39it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.40it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.32it/s]100%|██████████| 25/25 [00:03<00:00,  6.43it/s]
Run 00 | Epoch 00184 | Loss 0.3497 | Train 0.7017 | Val 0.6923 | Test 0.5497
Number of nodes during this epoch:  4637567
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423357963562012  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.083735466003418
range selection method range initialization spend 0.024541378021240234
time for parepare:  0.36785268783569336
local_output_nid generation:  0.026088953018188477
local_in_edges_tensor generation:  0.2065415382385254
mini_batch_src_global generation:  0.36946868896484375
r_  generation:  5.397077322006226
local_output_nid generation:  0.02707076072692871
local_in_edges_tensor generation:  0.19664883613586426
mini_batch_src_global generation:  0.45874571800231934
r_  generation:  5.585582733154297
----------------------check_connections_block total spend ----------------------------- 14.265374422073364
generate_one_block  7.2196033000946045
generate_one_block  6.9248881340026855
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9770052433013916
gen group dst list time:  0.08461642265319824
time for parepare:  0.4178755283355713
local_output_nid generation:  0.24716448783874512
local_in_edges_tensor generation:  1.563035249710083
mini_batch_src_global generation:  2.406372547149658
r_  generation:  29.13462781906128
local_output_nid generation:  0.4851357936859131
local_in_edges_tensor generation:  2.0435147285461426
mini_batch_src_global generation:  3.4401683807373047
r_  generation:  29.99003028869629
----------------------check_connections_block total spend ----------------------------- 81.12332916259766
generate_one_block  41.04844331741333
generate_one_block  40.847254037857056
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1612179279327393
gen group dst list time:  0.18040060997009277
time for parepare:  0.43261146545410156
local_output_nid generation:  0.3844165802001953
local_in_edges_tensor generation:  1.4756808280944824
mini_batch_src_global generation:  2.0657355785369873
r_  generation:  26.166481733322144
local_output_nid generation:  0.7263967990875244
local_in_edges_tensor generation:  1.9210848808288574
mini_batch_src_global generation:  2.852144479751587
r_  generation:  26.04310393333435
----------------------check_connections_block total spend ----------------------------- 72.46506023406982
generate_one_block  35.138895988464355
generate_one_block  35.87148189544678
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423357963562012  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.58838939666748
block generation total time  152.90607523918152
average batch blocks generation time:  76.45303761959076
block dataloader generation time/epoch 367.7891807130865
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37346208095550537 |1.3040798902511597 |0.004517912864685059 |0.00014984607696533203 |0.0052182674407958984 |0.00191497802734375 |
----------------------------------------------------------pseudo_mini_loss sum 0.3503301739692688
Total (block generation + training)time/epoch 371.6237442158364
Training time/epoch 3.7909622192382812
Training time without block to device /epoch 1.182802438735962
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.60it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.14it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.67it/s] 40%|████      | 10/25 [00:00<00:01, 14.09it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.33it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.24it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.88it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.37it/s] 80%|████████  | 20/25 [00:01<00:00, 17.72it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.92it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.01it/s]100%|██████████| 25/25 [00:01<00:00, 17.15it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.18it/s]  8%|▊         | 2/25 [00:00<00:04,  5.17it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.21it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.18it/s] 20%|██        | 5/25 [00:00<00:03,  5.15it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.13it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.13it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.14it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.14it/s] 40%|████      | 10/25 [00:01<00:02,  5.12it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.10it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.08it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.08it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.89it/s] 60%|██████    | 15/25 [00:02<00:01,  5.25it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.32it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.44it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.61it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.83it/s] 80%|████████  | 20/25 [00:03<00:00,  6.03it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.12it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.27it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.46it/s]100%|██████████| 25/25 [00:04<00:00,  7.08it/s]100%|██████████| 25/25 [00:04<00:00,  5.60it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.37it/s]  8%|▊         | 2/25 [00:00<00:04,  5.29it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.32it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.57it/s] 20%|██        | 5/25 [00:00<00:03,  5.85it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.07it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.17it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.30it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.84it/s] 40%|████      | 10/25 [00:01<00:02,  5.59it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.13it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.35it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.26it/s] 60%|██████    | 15/25 [00:02<00:01,  5.21it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.16it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.15it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.13it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.46it/s] 80%|████████  | 20/25 [00:03<00:00,  5.76it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.93it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.63it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.79it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.05it/s]100%|██████████| 25/25 [00:04<00:00,  5.72it/s]
Run 00 | Epoch 00185 | Loss 0.3503 | Train 0.7021 | Val 0.6929 | Test 0.5501
Number of nodes during this epoch:  4637748
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4228410720825195  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.123734712600708
range selection method range initialization spend 0.03623771667480469
time for parepare:  0.38585591316223145
local_output_nid generation:  0.026603221893310547
local_in_edges_tensor generation:  0.20171093940734863
mini_batch_src_global generation:  0.3934316635131836
r_  generation:  5.437726736068726
local_output_nid generation:  0.028633832931518555
local_in_edges_tensor generation:  0.23254752159118652
mini_batch_src_global generation:  0.4552946090698242
r_  generation:  5.7941014766693115
----------------------check_connections_block total spend ----------------------------- 14.686363220214844
generate_one_block  7.15668511390686
generate_one_block  6.9346606731414795
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.037190914154053
gen group dst list time:  0.09332752227783203
time for parepare:  0.45693159103393555
local_output_nid generation:  0.2680935859680176
local_in_edges_tensor generation:  1.6997530460357666
mini_batch_src_global generation:  2.49627423286438
r_  generation:  29.686413288116455
local_output_nid generation:  0.5460894107818604
local_in_edges_tensor generation:  2.059424638748169
mini_batch_src_global generation:  3.496032238006592
r_  generation:  29.840709686279297
----------------------check_connections_block total spend ----------------------------- 82.43043947219849
generate_one_block  40.853532552719116
generate_one_block  40.79901933670044
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.24763822555542
gen group dst list time:  0.18781614303588867
time for parepare:  0.46287989616394043
local_output_nid generation:  0.42490100860595703
local_in_edges_tensor generation:  1.6191201210021973
mini_batch_src_global generation:  2.0465080738067627
r_  generation:  26.03273868560791
local_output_nid generation:  0.7578418254852295
local_in_edges_tensor generation:  2.0774855613708496
mini_batch_src_global generation:  2.888897180557251
r_  generation:  26.18121600151062
----------------------check_connections_block total spend ----------------------------- 72.3475866317749
generate_one_block  35.36196851730347
generate_one_block  36.0689480304718
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4228410720825195  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.7780261039734
block generation total time  153.08346843719482
average batch blocks generation time:  76.54173421859741
block dataloader generation time/epoch 367.7843606074651
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4030245542526245 |1.4986971616744995 |0.0049239397048950195 |0.00017201900482177734 |0.00503385066986084 |0.004128456115722656 |
----------------------------------------------------------pseudo_mini_loss sum 0.34934520721435547
Total (block generation + training)time/epoch 371.6210730075836
Training time/epoch 4.234077215194702
Training time without block to device /epoch 1.2366828918457031
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.15it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.64it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.33it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.72it/s] 40%|████      | 10/25 [00:00<00:00, 17.95it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.20it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.24it/s] 80%|████████  | 20/25 [00:01<00:00, 18.21it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.20it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.23it/s]100%|██████████| 25/25 [00:01<00:00, 18.18it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.44it/s]  8%|▊         | 2/25 [00:00<00:03,  6.52it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.56it/s] 20%|██        | 5/25 [00:00<00:03,  6.56it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.57it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.59it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.59it/s] 40%|████      | 10/25 [00:01<00:02,  6.59it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.59it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.59it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.58it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.56it/s] 60%|██████    | 15/25 [00:02<00:01,  6.57it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.57it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.59it/s] 80%|████████  | 20/25 [00:03<00:00,  6.57it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.52it/s]100%|██████████| 25/25 [00:03<00:00,  7.24it/s]100%|██████████| 25/25 [00:03<00:00,  6.65it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.22it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.44it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.39it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.41it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.49it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.48it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.48it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.47it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.49it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.49it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  7.21it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
Run 00 | Epoch 00186 | Loss 0.3493 | Train 0.7034 | Val 0.6936 | Test 0.5504
Number of nodes during this epoch:  4637559
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430146217346191  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1242570877075195
range selection method range initialization spend 0.023869752883911133
time for parepare:  0.34947657585144043
local_output_nid generation:  0.026849746704101562
local_in_edges_tensor generation:  0.19438505172729492
mini_batch_src_global generation:  0.3681004047393799
r_  generation:  5.3538665771484375
local_output_nid generation:  0.027815580368041992
local_in_edges_tensor generation:  0.21915149688720703
mini_batch_src_global generation:  0.46370458602905273
r_  generation:  5.557841777801514
----------------------check_connections_block total spend ----------------------------- 14.172143459320068
generate_one_block  7.223322868347168
generate_one_block  6.87911581993103
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.077170133590698
gen group dst list time:  0.09273242950439453
time for parepare:  0.46639585494995117
local_output_nid generation:  0.2641005516052246
local_in_edges_tensor generation:  1.6266229152679443
mini_batch_src_global generation:  2.4863078594207764
r_  generation:  29.750630617141724
local_output_nid generation:  0.52459716796875
local_in_edges_tensor generation:  2.0705809593200684
mini_batch_src_global generation:  3.5895135402679443
r_  generation:  29.72552180290222
----------------------check_connections_block total spend ----------------------------- 82.52074313163757
generate_one_block  40.51260852813721
generate_one_block  40.676965951919556
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1092536449432373
gen group dst list time:  0.18366384506225586
time for parepare:  0.45270657539367676
local_output_nid generation:  0.3726034164428711
local_in_edges_tensor generation:  1.4554026126861572
mini_batch_src_global generation:  2.0252113342285156
r_  generation:  25.440481662750244
local_output_nid generation:  0.7287602424621582
local_in_edges_tensor generation:  2.0002670288085938
mini_batch_src_global generation:  2.9725236892700195
r_  generation:  25.758519411087036
----------------------check_connections_block total spend ----------------------------- 71.45973682403564
generate_one_block  35.13664126396179
generate_one_block  35.706828594207764
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430146217346191  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.98047995567322
block generation total time  152.03304433822632
average batch blocks generation time:  76.01652216911316
block dataloader generation time/epoch 367.7618596056566
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38227736949920654 |1.2825835943222046 |0.004646778106689453 |0.00015604496002197266 |0.005181550979614258 |0.0018355846405029297 |
----------------------------------------------------------pseudo_mini_loss sum 0.34903931617736816
Total (block generation + training)time/epoch 371.59816891751825
Training time/epoch 3.7611687183380127
Training time without block to device /epoch 1.1960015296936035
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.06it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.37it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.95it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.44it/s] 40%|████      | 10/25 [00:00<00:00, 17.62it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.84it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.00it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.02it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.86it/s] 80%|████████  | 20/25 [00:01<00:00, 17.93it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.95it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.78it/s]100%|██████████| 25/25 [00:01<00:00, 17.88it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.93it/s] 20%|██        | 5/25 [00:00<00:03,  6.03it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.15it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.26it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.94it/s] 40%|████      | 10/25 [00:01<00:02,  5.97it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.10it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.22it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.31it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.49it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.53it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.51it/s]100%|██████████| 25/25 [00:03<00:00,  6.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.22it/s]  8%|▊         | 2/25 [00:00<00:03,  6.33it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.43it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.49it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.53it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.30it/s] 40%|████      | 10/25 [00:01<00:02,  5.92it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.08it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.20it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.26it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.28it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.40it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.53it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
Run 00 | Epoch 00187 | Loss 0.3490 | Train 0.7036 | Val 0.6938 | Test 0.5501
Number of nodes during this epoch:  4637527
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421384811401367  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1517138481140137
range selection method range initialization spend 0.02404618263244629
time for parepare:  0.3779776096343994
local_output_nid generation:  0.027046918869018555
local_in_edges_tensor generation:  0.23244094848632812
mini_batch_src_global generation:  0.3755326271057129
r_  generation:  5.356278419494629
local_output_nid generation:  0.028246402740478516
local_in_edges_tensor generation:  0.19553923606872559
mini_batch_src_global generation:  0.5021665096282959
r_  generation:  5.770815134048462
----------------------check_connections_block total spend ----------------------------- 14.549198389053345
generate_one_block  7.17786169052124
generate_one_block  6.801570415496826
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.148473501205444
gen group dst list time:  0.09359502792358398
time for parepare:  0.45879125595092773
local_output_nid generation:  0.2685058116912842
local_in_edges_tensor generation:  1.846074104309082
mini_batch_src_global generation:  2.435314655303955
r_  generation:  29.842475414276123
local_output_nid generation:  0.5242719650268555
local_in_edges_tensor generation:  2.2212953567504883
mini_batch_src_global generation:  3.519110918045044
r_  generation:  29.91829252243042
----------------------check_connections_block total spend ----------------------------- 82.99753737449646
generate_one_block  40.797064542770386
generate_one_block  40.977262020111084
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.271338701248169
gen group dst list time:  0.19500303268432617
time for parepare:  0.48218607902526855
local_output_nid generation:  0.3982727527618408
local_in_edges_tensor generation:  1.5520353317260742
mini_batch_src_global generation:  2.18792462348938
r_  generation:  26.196741342544556
local_output_nid generation:  0.7247703075408936
local_in_edges_tensor generation:  1.9578447341918945
mini_batch_src_global generation:  2.818115472793579
r_  generation:  25.994070768356323
----------------------check_connections_block total spend ----------------------------- 72.35743832588196
generate_one_block  35.144611835479736
generate_one_block  35.921736001968384
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421384811401367  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.35497570037842
block generation total time  152.8406744003296
average batch blocks generation time:  76.4203372001648
block dataloader generation time/epoch 367.7550789346086
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3680999279022217 |1.3018105030059814 |0.004424691200256348 |0.00015103816986083984 |0.005070209503173828 |0.0019354820251464844 |
----------------------------------------------------------pseudo_mini_loss sum 0.3489590883255005
Total (block generation + training)time/epoch 371.591044327046
Training time/epoch 3.771465301513672
Training time without block to device /epoch 1.167844295501709
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.27it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.67it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.14it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.37it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.98it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.39it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.62it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.79it/s] 80%|████████  | 20/25 [00:01<00:00, 17.67it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.89it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.00it/s]100%|██████████| 25/25 [00:01<00:00, 17.79it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.26it/s]  8%|▊         | 2/25 [00:00<00:03,  6.59it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.94it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.59it/s] 20%|██        | 5/25 [00:00<00:03,  5.36it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.25it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.18it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.98it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.78it/s] 40%|████      | 10/25 [00:01<00:02,  5.00it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.18it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.02it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.74it/s] 60%|██████    | 15/25 [00:02<00:01,  5.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.82it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.05it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.26it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  5.98it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.66it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.47it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.16it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.07it/s]100%|██████████| 25/25 [00:04<00:00,  5.65it/s]100%|██████████| 25/25 [00:04<00:00,  5.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.17it/s]  8%|▊         | 2/25 [00:00<00:04,  5.02it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.01it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.99it/s] 20%|██        | 5/25 [00:00<00:03,  5.42it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.77it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.48it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.66it/s] 40%|████      | 10/25 [00:01<00:02,  5.87it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.67it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.49it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.31it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.25it/s] 60%|██████    | 15/25 [00:02<00:01,  5.19it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.17it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.13it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.03it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.43it/s] 80%|████████  | 20/25 [00:03<00:00,  5.78it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.57it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.40it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.29it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.18it/s]100%|██████████| 25/25 [00:04<00:00,  5.43it/s]
Run 00 | Epoch 00188 | Loss 0.3490 | Train 0.7035 | Val 0.6938 | Test 0.5504
Number of nodes during this epoch:  4637562
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424032211303711  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0888783931732178
range selection method range initialization spend 0.02417731285095215
time for parepare:  0.365966796875
local_output_nid generation:  0.026493310928344727
local_in_edges_tensor generation:  0.2012314796447754
mini_batch_src_global generation:  0.3718712329864502
r_  generation:  5.641541957855225
local_output_nid generation:  0.028992891311645508
local_in_edges_tensor generation:  0.23555278778076172
mini_batch_src_global generation:  0.47638726234436035
r_  generation:  5.615645885467529
----------------------check_connections_block total spend ----------------------------- 14.641606330871582
generate_one_block  7.315937042236328
generate_one_block  7.218858003616333
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.079186201095581
gen group dst list time:  0.08889102935791016
time for parepare:  0.47031521797180176
local_output_nid generation:  0.26271843910217285
local_in_edges_tensor generation:  1.6450204849243164
mini_batch_src_global generation:  2.5194969177246094
r_  generation:  30.692047595977783
local_output_nid generation:  0.5403220653533936
local_in_edges_tensor generation:  2.045790433883667
mini_batch_src_global generation:  3.7838847637176514
r_  generation:  30.0349702835083
----------------------check_connections_block total spend ----------------------------- 83.95081520080566
generate_one_block  41.20748233795166
generate_one_block  41.051167249679565
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2252378463745117
gen group dst list time:  0.20055723190307617
time for parepare:  0.4503753185272217
local_output_nid generation:  0.392087459564209
local_in_edges_tensor generation:  1.5067110061645508
mini_batch_src_global generation:  2.118778944015503
r_  generation:  26.28380537033081
local_output_nid generation:  0.7282180786132812
local_in_edges_tensor generation:  1.9578924179077148
mini_batch_src_global generation:  2.814060688018799
r_  generation:  25.981974124908447
----------------------check_connections_block total spend ----------------------------- 72.54144859313965
generate_one_block  35.15854334831238
generate_one_block  35.803945541381836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424032211303711  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.4922637939453
block generation total time  153.22113847732544
average batch blocks generation time:  76.61056923866272
block dataloader generation time/epoch 367.76465488489345
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37991368770599365 |1.2970046997070312 |0.004342079162597656 |0.0001653432846069336 |0.0050945281982421875 |0.0018188953399658203 |
----------------------------------------------------------pseudo_mini_loss sum 0.3477954566478729
Total (block generation + training)time/epoch 371.6003621658951
Training time/epoch 3.787012815475464
Training time without block to device /epoch 1.1930034160614014
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.31it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.84it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.22it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.69it/s] 40%|████      | 10/25 [00:00<00:00, 17.78it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.97it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.10it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.59it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.71it/s] 80%|████████  | 20/25 [00:01<00:00, 17.81it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.92it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.04it/s]100%|██████████| 25/25 [00:01<00:00, 18.00it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.45it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.45it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.54it/s] 40%|████      | 10/25 [00:01<00:02,  6.16it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.28it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.05it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.79it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.82it/s] 60%|██████    | 15/25 [00:02<00:01,  5.87it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.94it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.07it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.20it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.30it/s] 80%|████████  | 20/25 [00:03<00:00,  6.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.49it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.25it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.26it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.96it/s] 40%|████      | 10/25 [00:01<00:02,  5.96it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.05it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.03it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.11it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.16it/s] 60%|██████    | 15/25 [00:02<00:01,  6.22it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.31it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
Run 00 | Epoch 00189 | Loss 0.3478 | Train 0.7026 | Val 0.6929 | Test 0.5506
Number of nodes during this epoch:  4637286
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429830551147461  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1350288391113281
range selection method range initialization spend 0.026650190353393555
time for parepare:  0.3898911476135254
local_output_nid generation:  0.03066539764404297
local_in_edges_tensor generation:  0.25716066360473633
mini_batch_src_global generation:  0.3766896724700928
r_  generation:  5.579826593399048
local_output_nid generation:  0.029326677322387695
local_in_edges_tensor generation:  0.22059202194213867
mini_batch_src_global generation:  0.4967067241668701
r_  generation:  5.9556052684783936
----------------------check_connections_block total spend ----------------------------- 15.017177820205688
generate_one_block  7.294845104217529
generate_one_block  7.076736211776733
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.258403778076172
gen group dst list time:  0.09815502166748047
time for parepare:  0.4701817035675049
local_output_nid generation:  0.2731513977050781
local_in_edges_tensor generation:  1.7132863998413086
mini_batch_src_global generation:  2.4280083179473877
r_  generation:  30.269627571105957
local_output_nid generation:  0.5266585350036621
local_in_edges_tensor generation:  2.0889008045196533
mini_batch_src_global generation:  3.4969701766967773
r_  generation:  31.199027061462402
----------------------check_connections_block total spend ----------------------------- 84.70549750328064
generate_one_block  40.91488313674927
generate_one_block  40.89555835723877
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1593034267425537
gen group dst list time:  0.1888737678527832
time for parepare:  0.46203088760375977
local_output_nid generation:  0.3759500980377197
local_in_edges_tensor generation:  1.4636743068695068
mini_batch_src_global generation:  2.012035846710205
r_  generation:  25.261260986328125
local_output_nid generation:  0.7172091007232666
local_in_edges_tensor generation:  1.9844958782196045
mini_batch_src_global generation:  2.786977529525757
r_  generation:  25.731607913970947
----------------------check_connections_block total spend ----------------------------- 71.1557183265686
generate_one_block  36.148449182510376
generate_one_block  35.930951833724976
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429830551147461  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.86121582984924
block generation total time  153.8898425102234
average batch blocks generation time:  76.9449212551117
block dataloader generation time/epoch 367.7705285235455
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39888978004455566 |1.3294934034347534 |0.004836082458496094 |0.00017547607421875 |0.005125284194946289 |0.0033767223358154297 |
----------------------------------------------------------pseudo_mini_loss sum 0.34772199392318726
Total (block generation + training)time/epoch 371.60651014980516
Training time/epoch 3.887657403945923
Training time without block to device /epoch 1.228670597076416
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.15it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.80it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.38it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.72it/s] 40%|████      | 10/25 [00:00<00:01, 13.87it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.95it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.75it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.46it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.01it/s] 80%|████████  | 20/25 [00:01<00:00, 17.39it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.66it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.83it/s]100%|██████████| 25/25 [00:01<00:00, 17.02it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.55it/s]  8%|▊         | 2/25 [00:00<00:03,  6.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.64it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.56it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.54it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.53it/s] 40%|████      | 10/25 [00:01<00:02,  6.54it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.54it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.50it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.50it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.51it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.50it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.51it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.51it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  6.82it/s]100%|██████████| 25/25 [00:03<00:00,  6.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.97it/s]  8%|▊         | 2/25 [00:00<00:04,  5.57it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.88it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.04it/s] 20%|██        | 5/25 [00:00<00:03,  6.16it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.18it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.22it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.19it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.11it/s] 40%|████      | 10/25 [00:01<00:02,  6.11it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.76it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.71it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.86it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.97it/s] 60%|██████    | 15/25 [00:02<00:01,  6.04it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.09it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.13it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.16it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.85it/s] 80%|████████  | 20/25 [00:03<00:00,  5.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.73it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.90it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.02it/s]100%|██████████| 25/25 [00:04<00:00,  6.80it/s]100%|██████████| 25/25 [00:04<00:00,  6.02it/s]
Run 00 | Epoch 00190 | Loss 0.3477 | Train 0.7016 | Val 0.6925 | Test 0.5502
Number of nodes during this epoch:  4637833
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428470134735107  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1649298667907715
range selection method range initialization spend 0.025676727294921875
time for parepare:  0.3871119022369385
local_output_nid generation:  0.02615976333618164
local_in_edges_tensor generation:  0.20125317573547363
mini_batch_src_global generation:  0.3787424564361572
r_  generation:  5.692223072052002
local_output_nid generation:  0.0282595157623291
local_in_edges_tensor generation:  0.21307063102722168
mini_batch_src_global generation:  0.46969079971313477
r_  generation:  5.6792380809783936
----------------------check_connections_block total spend ----------------------------- 14.764296770095825
generate_one_block  7.500359058380127
generate_one_block  7.239558696746826
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.032289743423462
gen group dst list time:  0.09021353721618652
time for parepare:  0.46295952796936035
local_output_nid generation:  0.27241945266723633
local_in_edges_tensor generation:  1.767603874206543
mini_batch_src_global generation:  2.4737298488616943
r_  generation:  29.7497079372406
local_output_nid generation:  0.5254552364349365
local_in_edges_tensor generation:  2.2168257236480713
mini_batch_src_global generation:  3.5059053897857666
r_  generation:  31.171621084213257
----------------------check_connections_block total spend ----------------------------- 84.1919195652008
generate_one_block  41.235374212265015
generate_one_block  41.303048610687256
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.19287371635437
gen group dst list time:  0.19461798667907715
time for parepare:  0.4653787612915039
local_output_nid generation:  0.4221043586730957
local_in_edges_tensor generation:  1.5882148742675781
mini_batch_src_global generation:  2.0132534503936768
r_  generation:  25.949849367141724
local_output_nid generation:  0.7197611331939697
local_in_edges_tensor generation:  1.9262959957122803
mini_batch_src_global generation:  2.8079793453216553
r_  generation:  26.105396270751953
----------------------check_connections_block total spend ----------------------------- 72.18360900878906
generate_one_block  35.221200466156006
generate_one_block  35.871161222457886
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428470134735107  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.37552857398987
block generation total time  153.63078451156616
average batch blocks generation time:  76.81539225578308
block dataloader generation time/epoch 367.77771250614944
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3812175989151001 |1.2995959520339966 |0.0044040679931640625 |0.0001481771469116211 |0.004974246025085449 |0.0017321109771728516 |
----------------------------------------------------------pseudo_mini_loss sum 0.3476884365081787
Total (block generation + training)time/epoch 371.61346737502134
Training time/epoch 3.7924954891204834
Training time without block to device /epoch 1.1933035850524902
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.03it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.29it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.01it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.43it/s] 40%|████      | 10/25 [00:00<00:00, 17.73it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.92it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.62it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.78it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.00it/s] 80%|████████  | 20/25 [00:01<00:00, 18.11it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.19it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.25it/s]100%|██████████| 25/25 [00:01<00:00, 18.01it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.56it/s]  8%|▊         | 2/25 [00:00<00:03,  6.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.63it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.61it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.65it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.13it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.79it/s] 40%|████      | 10/25 [00:01<00:02,  5.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.64it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.89it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.07it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.02it/s] 60%|██████    | 15/25 [00:02<00:01,  6.06it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.84it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.69it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.76it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.86it/s] 80%|████████  | 20/25 [00:03<00:00,  6.00it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.16it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.24it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:04<00:00,  6.22it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.09it/s]  8%|▊         | 2/25 [00:00<00:03,  6.19it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.03it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.65it/s] 20%|██        | 5/25 [00:00<00:03,  5.63it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.70it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.86it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.97it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.74it/s] 40%|████      | 10/25 [00:01<00:02,  5.56it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.85it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.06it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.21it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.35it/s] 60%|██████    | 15/25 [00:02<00:01,  6.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.51it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.54it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.46it/s] 80%|████████  | 20/25 [00:03<00:00,  6.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.56it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.12it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.94it/s]100%|██████████| 25/25 [00:04<00:00,  6.20it/s]
Run 00 | Epoch 00191 | Loss 0.3477 | Train 0.7024 | Val 0.6934 | Test 0.5499
Number of nodes during this epoch:  4637809
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429661750793457  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.2157087326049805
range selection method range initialization spend 0.024594783782958984
time for parepare:  0.38477325439453125
local_output_nid generation:  0.026293516159057617
local_in_edges_tensor generation:  0.23587679862976074
mini_batch_src_global generation:  0.37186336517333984
r_  generation:  5.623695611953735
local_output_nid generation:  0.029117107391357422
local_in_edges_tensor generation:  0.22067737579345703
mini_batch_src_global generation:  0.46421337127685547
r_  generation:  5.884654760360718
----------------------check_connections_block total spend ----------------------------- 14.92510461807251
generate_one_block  7.268689155578613
generate_one_block  7.0489842891693115
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.017019748687744
gen group dst list time:  0.10702252388000488
time for parepare:  0.4514169692993164
local_output_nid generation:  0.27933573722839355
local_in_edges_tensor generation:  1.7205240726470947
mini_batch_src_global generation:  2.532900094985962
r_  generation:  29.74358582496643
local_output_nid generation:  0.5419340133666992
local_in_edges_tensor generation:  2.322890281677246
mini_batch_src_global generation:  3.745333671569824
r_  generation:  29.85505747795105
----------------------check_connections_block total spend ----------------------------- 83.27569127082825
generate_one_block  40.600200176239014
generate_one_block  40.74502658843994
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.325399160385132
gen group dst list time:  0.18139386177062988
time for parepare:  0.5165934562683105
local_output_nid generation:  0.40921998023986816
local_in_edges_tensor generation:  1.5719900131225586
mini_batch_src_global generation:  2.0145695209503174
r_  generation:  26.115708589553833
local_output_nid generation:  0.7404704093933105
local_in_edges_tensor generation:  2.0926883220672607
mini_batch_src_global generation:  2.9436047077178955
r_  generation:  26.801256895065308
----------------------check_connections_block total spend ----------------------------- 73.78192281723022
generate_one_block  37.066728591918945
generate_one_block  37.52802753448486
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429661750793457  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.05761408805847
block generation total time  155.93998289108276
average batch blocks generation time:  77.96999144554138
block dataloader generation time/epoch 367.80557071665925
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38678061962127686 |1.4940707683563232 |0.004708409309387207 |0.00016260147094726562 |0.005178928375244141 |0.0015785694122314453 |
----------------------------------------------------------pseudo_mini_loss sum 0.34708818793296814
Total (block generation + training)time/epoch 371.6431915735205
Training time/epoch 4.1938440799713135
Training time without block to device /epoch 1.205702543258667
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.70it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.14it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.80it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.05it/s] 40%|████      | 10/25 [00:00<00:00, 16.25it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.23it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.36it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.45it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.48it/s] 80%|████████  | 20/25 [00:01<00:00, 16.48it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.50it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.55it/s]100%|██████████| 25/25 [00:01<00:00, 16.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.13it/s]  8%|▊         | 2/25 [00:00<00:04,  5.22it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.23it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.19it/s] 20%|██        | 5/25 [00:00<00:03,  5.53it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.77it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.96it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.05it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.13it/s] 40%|████      | 10/25 [00:01<00:02,  6.18it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.26it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.28it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.28it/s] 60%|██████    | 15/25 [00:02<00:01,  6.28it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.27it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.26it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.22it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.20it/s] 80%|████████  | 20/25 [00:03<00:00,  6.24it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.25it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.27it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.30it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.24it/s]100%|██████████| 25/25 [00:04<00:00,  6.93it/s]100%|██████████| 25/25 [00:04<00:00,  6.15it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.97it/s]  8%|▊         | 2/25 [00:00<00:03,  6.08it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.13it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.16it/s] 20%|██        | 5/25 [00:00<00:03,  6.19it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.18it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.21it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.22it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.22it/s] 40%|████      | 10/25 [00:01<00:02,  6.23it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.21it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.23it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.23it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.20it/s] 60%|██████    | 15/25 [00:02<00:01,  6.21it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.22it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.21it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.23it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.22it/s] 80%|████████  | 20/25 [00:03<00:00,  6.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.05it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.02it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.64it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.61it/s]100%|██████████| 25/25 [00:04<00:00,  6.44it/s]100%|██████████| 25/25 [00:04<00:00,  6.17it/s]
Run 00 | Epoch 00192 | Loss 0.3471 | Train 0.7026 | Val 0.6931 | Test 0.5497
Number of nodes during this epoch:  4638034
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428307056427002  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1636273860931396
range selection method range initialization spend 0.025651216506958008
time for parepare:  0.383131742477417
local_output_nid generation:  0.026459217071533203
local_in_edges_tensor generation:  0.19551348686218262
mini_batch_src_global generation:  0.3918190002441406
r_  generation:  5.547603130340576
local_output_nid generation:  0.028868436813354492
local_in_edges_tensor generation:  0.26189231872558594
mini_batch_src_global generation:  0.4691958427429199
r_  generation:  5.834682464599609
----------------------check_connections_block total spend ----------------------------- 14.952381610870361
generate_one_block  7.627657175064087
generate_one_block  7.443189382553101
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.985531806945801
gen group dst list time:  0.09450459480285645
time for parepare:  0.45552921295166016
local_output_nid generation:  0.2840721607208252
local_in_edges_tensor generation:  1.611893653869629
mini_batch_src_global generation:  2.523308753967285
r_  generation:  30.238505363464355
local_output_nid generation:  0.5550916194915771
local_in_edges_tensor generation:  2.148345470428467
mini_batch_src_global generation:  3.811830997467041
r_  generation:  31.429625749588013
----------------------check_connections_block total spend ----------------------------- 85.81778812408447
generate_one_block  42.83039307594299
generate_one_block  41.465163469314575
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1497936248779297
gen group dst list time:  0.1808764934539795
time for parepare:  0.4636085033416748
local_output_nid generation:  0.43575239181518555
local_in_edges_tensor generation:  1.5279242992401123
mini_batch_src_global generation:  2.0193591117858887
r_  generation:  26.07529377937317
local_output_nid generation:  0.7670304775238037
local_in_edges_tensor generation:  2.00777530670166
mini_batch_src_global generation:  2.8698155879974365
r_  generation:  26.146386861801147
----------------------check_connections_block total spend ----------------------------- 72.16296005249023
generate_one_block  35.42576742172241
generate_one_block  37.38548970222473
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428307056427002  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.9807481765747
block generation total time  157.1068136692047
average batch blocks generation time:  78.55340683460236
block dataloader generation time/epoch 367.8465468698215
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3852236270904541 |1.3230630159378052 |0.004405021667480469 |0.0001518726348876953 |0.0052187442779541016 |0.0017108917236328125 |
----------------------------------------------------------pseudo_mini_loss sum 0.3476228415966034
Total (block generation + training)time/epoch 371.68423351228546
Training time/epoch 3.850144863128662
Training time without block to device /epoch 1.2040188312530518
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.98it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.50it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.12it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.88it/s] 40%|████      | 10/25 [00:00<00:00, 16.98it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.41it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.70it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.81it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.95it/s] 80%|████████  | 20/25 [00:01<00:00, 18.07it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.15it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.18it/s]100%|██████████| 25/25 [00:01<00:00, 17.89it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:03,  6.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.86it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.07it/s] 20%|██        | 5/25 [00:00<00:03,  6.29it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.37it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.47it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.55it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.56it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.57it/s] 60%|██████    | 15/25 [00:02<00:01,  6.56it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.47it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.41it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.54it/s]100%|██████████| 25/25 [00:03<00:00,  7.23it/s]100%|██████████| 25/25 [00:03<00:00,  6.54it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:03,  6.29it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.37it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.36it/s] 20%|██        | 5/25 [00:00<00:03,  6.39it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.42it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.45it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.46it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.43it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.40it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.44it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.39it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.35it/s] 80%|████████  | 20/25 [00:03<00:00,  6.34it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
Run 00 | Epoch 00193 | Loss 0.3476 | Train 0.7030 | Val 0.6928 | Test 0.5498
Number of nodes during this epoch:  4637999
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42533540725708  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1149818897247314
range selection method range initialization spend 0.02556157112121582
time for parepare:  0.36515331268310547
local_output_nid generation:  0.02615523338317871
local_in_edges_tensor generation:  0.26151561737060547
mini_batch_src_global generation:  0.3797767162322998
r_  generation:  5.438883066177368
local_output_nid generation:  0.028187990188598633
local_in_edges_tensor generation:  0.19412994384765625
mini_batch_src_global generation:  0.47015857696533203
r_  generation:  5.61969780921936
----------------------check_connections_block total spend ----------------------------- 14.483627080917358
generate_one_block  7.318222522735596
generate_one_block  7.181563377380371
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.008744716644287
gen group dst list time:  0.08792233467102051
time for parepare:  0.4716463088989258
local_output_nid generation:  0.27588725090026855
local_in_edges_tensor generation:  1.663600206375122
mini_batch_src_global generation:  2.555356502532959
r_  generation:  30.174848556518555
local_output_nid generation:  0.5596070289611816
local_in_edges_tensor generation:  2.3658082485198975
mini_batch_src_global generation:  3.779780864715576
r_  generation:  29.973203420639038
----------------------check_connections_block total spend ----------------------------- 84.38190364837646
generate_one_block  40.911625146865845
generate_one_block  41.13838791847229
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2639660835266113
gen group dst list time:  0.19468212127685547
time for parepare:  0.4833056926727295
local_output_nid generation:  0.43758177757263184
local_in_edges_tensor generation:  1.6354610919952393
mini_batch_src_global generation:  2.1140971183776855
r_  generation:  26.889055728912354
local_output_nid generation:  0.7407755851745605
local_in_edges_tensor generation:  1.9856863021850586
mini_batch_src_global generation:  2.9385106563568115
r_  generation:  26.27194881439209
----------------------check_connections_block total spend ----------------------------- 74.19453072547913
generate_one_block  35.45337271690369
generate_one_block  36.18350291252136
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42533540725708  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  158.5764343738556
block generation total time  153.68688869476318
average batch blocks generation time:  76.84344434738159
block dataloader generation time/epoch 367.8644417708682
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39381635189056396 |1.311820387840271 |0.004412293434143066 |0.00015091896057128906 |0.0052032470703125 |0.001920938491821289 |
----------------------------------------------------------pseudo_mini_loss sum 0.3482494354248047
Total (block generation + training)time/epoch 371.7021439026312
Training time/epoch 3.84051513671875
Training time without block to device /epoch 1.216874361038208
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.67it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.04it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.44it/s] 40%|████      | 10/25 [00:00<00:00, 17.65it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.88it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.00it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.00it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.11it/s] 80%|████████  | 20/25 [00:01<00:00, 18.15it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.06it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.10it/s]100%|██████████| 25/25 [00:01<00:00, 18.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.36it/s]  8%|▊         | 2/25 [00:00<00:03,  6.43it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.42it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.34it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.36it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.42it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.43it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.40it/s]100%|██████████| 25/25 [00:03<00:00,  6.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.70it/s]  8%|▊         | 2/25 [00:00<00:03,  6.08it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.18it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.26it/s] 20%|██        | 5/25 [00:00<00:03,  6.24it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.05it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.15it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.92it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.06it/s] 40%|████      | 10/25 [00:01<00:02,  6.09it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.17it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.21it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.26it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.31it/s] 60%|██████    | 15/25 [00:02<00:01,  6.34it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.32it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.34it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.35it/s] 80%|████████  | 20/25 [00:03<00:00,  6.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.37it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:03<00:00,  6.35it/s]
Run 00 | Epoch 00194 | Loss 0.3482 | Train 0.7015 | Val 0.6923 | Test 0.5491
Number of nodes during this epoch:  4638161
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424802303314209  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.126361608505249
range selection method range initialization spend 0.024434566497802734
time for parepare:  0.3894782066345215
local_output_nid generation:  0.030524253845214844
local_in_edges_tensor generation:  0.25719118118286133
mini_batch_src_global generation:  0.3860478401184082
r_  generation:  5.4594032764434814
local_output_nid generation:  0.029053449630737305
local_in_edges_tensor generation:  0.21399426460266113
mini_batch_src_global generation:  0.4845876693725586
r_  generation:  5.801605939865112
----------------------check_connections_block total spend ----------------------------- 14.734953880310059
generate_one_block  7.228481769561768
generate_one_block  6.879021644592285
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.113775253295898
gen group dst list time:  0.09332466125488281
time for parepare:  0.4593021869659424
local_output_nid generation:  0.29253482818603516
local_in_edges_tensor generation:  1.6545343399047852
mini_batch_src_global generation:  2.525803327560425
r_  generation:  30.23485231399536
local_output_nid generation:  0.5397307872772217
local_in_edges_tensor generation:  2.120396375656128
mini_batch_src_global generation:  3.736105442047119
r_  generation:  30.0205397605896
----------------------check_connections_block total spend ----------------------------- 83.51880884170532
generate_one_block  41.03496837615967
generate_one_block  40.725831508636475
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2461938858032227
gen group dst list time:  0.18123197555541992
time for parepare:  0.4862802028656006
local_output_nid generation:  0.4046604633331299
local_in_edges_tensor generation:  1.534184455871582
mini_batch_src_global generation:  2.0095672607421875
r_  generation:  25.759887218475342
local_output_nid generation:  0.7511756420135498
local_in_edges_tensor generation:  2.047044515609741
mini_batch_src_global generation:  2.898547887802124
r_  generation:  25.960242748260498
----------------------check_connections_block total spend ----------------------------- 71.73493599891663
generate_one_block  35.19465970993042
generate_one_block  35.953222036361694
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424802303314209  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.25374484062195
block generation total time  152.90868163108826
average batch blocks generation time:  76.45434081554413
block dataloader generation time/epoch 367.8598790058723
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39074814319610596 |1.3098491430282593 |0.004326224327087402 |0.0001480579376220703 |0.005177974700927734 |0.0017802715301513672 |
----------------------------------------------------------pseudo_mini_loss sum 0.34674298763275146
Total (block generation + training)time/epoch 371.69758487848134
Training time/epoch 3.838254928588867
Training time without block to device /epoch 1.2185566425323486
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.32it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.84it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.56it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.83it/s] 40%|████      | 10/25 [00:00<00:01, 14.12it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.32it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.21it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.85it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.29it/s] 80%|████████  | 20/25 [00:01<00:00, 17.58it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.85it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.02it/s]100%|██████████| 25/25 [00:01<00:00, 17.24it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.62it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.59it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.63it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.63it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.62it/s] 40%|████      | 10/25 [00:01<00:02,  6.62it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.14it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.84it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.62it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.49it/s] 60%|██████    | 15/25 [00:02<00:01,  5.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.27it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.23it/s] 80%|████████  | 20/25 [00:03<00:00,  5.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.15it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.15it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.99it/s]100%|██████████| 25/25 [00:04<00:00,  5.76it/s]100%|██████████| 25/25 [00:04<00:00,  5.75it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  6.00it/s]  8%|▊         | 2/25 [00:00<00:03,  6.08it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.70it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.98it/s] 20%|██        | 5/25 [00:00<00:03,  6.10it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.06it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.17it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.25it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.29it/s] 40%|████      | 10/25 [00:01<00:02,  6.33it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.27it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.23it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.29it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.30it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.31it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.94it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.08it/s] 80%|████████  | 20/25 [00:03<00:00,  6.17it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.30it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.07it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.06it/s]100%|██████████| 25/25 [00:03<00:00,  6.85it/s]100%|██████████| 25/25 [00:03<00:00,  6.26it/s]
Run 00 | Epoch 00195 | Loss 0.3467 | Train 0.6995 | Val 0.6901 | Test 0.5479
Number of nodes during this epoch:  4638186
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424862861633301  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1367595195770264
range selection method range initialization spend 0.025182247161865234
time for parepare:  0.3911447525024414
local_output_nid generation:  0.029473543167114258
local_in_edges_tensor generation:  0.22531938552856445
mini_batch_src_global generation:  0.3842658996582031
r_  generation:  5.4440388679504395
local_output_nid generation:  0.0316472053527832
local_in_edges_tensor generation:  0.21173810958862305
mini_batch_src_global generation:  0.45436739921569824
r_  generation:  5.798599481582642
----------------------check_connections_block total spend ----------------------------- 14.719053268432617
generate_one_block  7.157408714294434
generate_one_block  6.8871564865112305
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.001596689224243
gen group dst list time:  0.09229898452758789
time for parepare:  0.4658012390136719
local_output_nid generation:  0.2673006057739258
local_in_edges_tensor generation:  1.6628658771514893
mini_batch_src_global generation:  2.639690399169922
r_  generation:  29.864338397979736
local_output_nid generation:  0.540125846862793
local_in_edges_tensor generation:  2.1352226734161377
mini_batch_src_global generation:  3.765608787536621
r_  generation:  29.823755741119385
----------------------check_connections_block total spend ----------------------------- 83.21342968940735
generate_one_block  40.977147340774536
generate_one_block  40.549166679382324
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2854297161102295
gen group dst list time:  0.19127273559570312
time for parepare:  0.5049822330474854
local_output_nid generation:  0.42743754386901855
local_in_edges_tensor generation:  1.5851497650146484
mini_batch_src_global generation:  2.0176477432250977
r_  generation:  26.58543848991394
local_output_nid generation:  0.7471399307250977
local_in_edges_tensor generation:  2.105851650238037
mini_batch_src_global generation:  2.837301731109619
r_  generation:  26.207573652267456
----------------------check_connections_block total spend ----------------------------- 73.03085422515869
generate_one_block  35.17560362815857
generate_one_block  35.974942207336426
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424862861633301  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.24428391456604
block generation total time  152.67685985565186
average batch blocks generation time:  76.33842992782593
block dataloader generation time/epoch 367.85894792177237
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3861396312713623 |1.3070117235183716 |0.004386544227600098 |0.00015604496002197266 |0.005143404006958008 |0.0029401779174804688 |
----------------------------------------------------------pseudo_mini_loss sum 0.34651339054107666
Total (block generation + training)time/epoch 371.6965375822418
Training time/epoch 3.8147552013397217
Training time without block to device /epoch 1.2007317543029785
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.79it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.55it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.24it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.68it/s] 40%|████      | 10/25 [00:00<00:00, 17.90it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.11it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.24it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.29it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.23it/s] 80%|████████  | 20/25 [00:01<00:00, 18.29it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.33it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.32it/s]100%|██████████| 25/25 [00:01<00:00, 18.22it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.53it/s]  8%|▊         | 2/25 [00:00<00:03,  6.47it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.59it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.57it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.59it/s] 40%|████      | 10/25 [00:01<00:02,  6.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.54it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.51it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.50it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  7.17it/s]100%|██████████| 25/25 [00:03<00:00,  6.61it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.22it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.14it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.23it/s] 20%|██        | 5/25 [00:00<00:03,  6.33it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.29it/s] 40%|████      | 10/25 [00:01<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.40it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.14it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.20it/s] 60%|██████    | 15/25 [00:02<00:01,  6.08it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.20it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.24it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.31it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.32it/s] 80%|████████  | 20/25 [00:03<00:00,  6.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.37it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.41it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00196 | Loss 0.3465 | Train 0.6990 | Val 0.6897 | Test 0.5474
Number of nodes during this epoch:  4637666
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422473907470703  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1253600120544434
range selection method range initialization spend 0.024810791015625
time for parepare:  0.3676896095275879
local_output_nid generation:  0.026079654693603516
local_in_edges_tensor generation:  0.19481158256530762
mini_batch_src_global generation:  0.3710448741912842
r_  generation:  5.350412368774414
local_output_nid generation:  0.026730060577392578
local_in_edges_tensor generation:  0.1947612762451172
mini_batch_src_global generation:  0.45662736892700195
r_  generation:  5.588810920715332
----------------------check_connections_block total spend ----------------------------- 14.170648574829102
generate_one_block  7.14992618560791
generate_one_block  6.771862030029297
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.984428644180298
gen group dst list time:  0.0886380672454834
time for parepare:  0.4619481563568115
local_output_nid generation:  0.28008294105529785
local_in_edges_tensor generation:  1.5846214294433594
mini_batch_src_global generation:  2.4436042308807373
r_  generation:  29.595422983169556
local_output_nid generation:  0.5187525749206543
local_in_edges_tensor generation:  2.0814945697784424
mini_batch_src_global generation:  3.5293211936950684
r_  generation:  29.73793625831604
----------------------check_connections_block total spend ----------------------------- 82.12175393104553
generate_one_block  41.036593437194824
generate_one_block  40.99065542221069
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.217005491256714
gen group dst list time:  0.18887567520141602
time for parepare:  0.4890265464782715
local_output_nid generation:  0.40700531005859375
local_in_edges_tensor generation:  1.6367847919464111
mini_batch_src_global generation:  2.072427272796631
r_  generation:  26.249053239822388
local_output_nid generation:  0.7214107513427734
local_in_edges_tensor generation:  1.9699394702911377
mini_batch_src_global generation:  2.817201852798462
r_  generation:  26.147833824157715
----------------------check_connections_block total spend ----------------------------- 72.49000144004822
generate_one_block  35.34248948097229
generate_one_block  36.10266304016113
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422473907470703  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.61175537109375
block generation total time  153.47240138053894
average batch blocks generation time:  76.73620069026947
block dataloader generation time/epoch 367.84669768628737
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38234031200408936 |1.31321382522583 |0.004412174224853516 |0.00014841556549072266 |0.005177855491638184 |0.0015370845794677734 |
----------------------------------------------------------pseudo_mini_loss sum 0.3446618318557739
Total (block generation + training)time/epoch 371.68421552144935
Training time/epoch 3.823267936706543
Training time without block to device /epoch 1.1968402862548828
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.09it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.71it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.32it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.43it/s] 40%|████      | 10/25 [00:00<00:00, 17.71it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.93it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.01it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.17it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.19it/s] 80%|████████  | 20/25 [00:01<00:00, 17.93it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.91it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.00it/s]100%|██████████| 25/25 [00:01<00:00, 17.87it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.68it/s]  8%|▊         | 2/25 [00:00<00:03,  6.71it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.77it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.83it/s] 20%|██        | 5/25 [00:00<00:02,  6.85it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.96it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.80it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.76it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.82it/s] 40%|████      | 10/25 [00:01<00:02,  5.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.56it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.76it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.66it/s] 60%|██████    | 15/25 [00:02<00:01,  5.92it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.92it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.73it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.97it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.21it/s] 80%|████████  | 20/25 [00:03<00:00,  5.77it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.16it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.44it/s]100%|██████████| 25/25 [00:04<00:00,  6.27it/s]100%|██████████| 25/25 [00:04<00:00,  5.87it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.01it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.79it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.49it/s] 20%|██        | 5/25 [00:00<00:03,  5.34it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.25it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.20it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.97it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.38it/s] 40%|████      | 10/25 [00:01<00:02,  5.76it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.06it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.28it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.43it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.39it/s] 60%|██████    | 15/25 [00:02<00:01,  5.96it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.81it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.02it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.18it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.31it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.54it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:04<00:00,  6.11it/s]
Run 00 | Epoch 00197 | Loss 0.3447 | Train 0.6997 | Val 0.6907 | Test 0.5476
Number of nodes during this epoch:  4638277
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428609848022461  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1201238632202148
range selection method range initialization spend 0.035584211349487305
time for parepare:  0.37821006774902344
local_output_nid generation:  0.026791095733642578
local_in_edges_tensor generation:  0.18367218971252441
mini_batch_src_global generation:  0.3621535301208496
r_  generation:  5.691317796707153
local_output_nid generation:  0.029083251953125
local_in_edges_tensor generation:  0.23675775527954102
mini_batch_src_global generation:  0.4728548526763916
r_  generation:  5.923061370849609
----------------------check_connections_block total spend ----------------------------- 14.945688962936401
generate_one_block  7.2321484088897705
generate_one_block  6.904890298843384
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.034520626068115
gen group dst list time:  0.09097528457641602
time for parepare:  0.4568796157836914
local_output_nid generation:  0.2859787940979004
local_in_edges_tensor generation:  1.6453652381896973
mini_batch_src_global generation:  2.5102832317352295
r_  generation:  30.0994873046875
local_output_nid generation:  0.5505185127258301
local_in_edges_tensor generation:  2.276665449142456
mini_batch_src_global generation:  3.733583450317383
r_  generation:  29.912474155426025
----------------------check_connections_block total spend ----------------------------- 83.65285730361938
generate_one_block  40.86151361465454
generate_one_block  40.99454402923584
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1692562103271484
gen group dst list time:  0.18598508834838867
time for parepare:  0.47826623916625977
local_output_nid generation:  0.410078763961792
local_in_edges_tensor generation:  1.4911072254180908
mini_batch_src_global generation:  2.0212719440460205
r_  generation:  25.556876182556152
local_output_nid generation:  0.7496917247772217
local_in_edges_tensor generation:  1.9684185981750488
mini_batch_src_global generation:  2.7802653312683105
r_  generation:  26.321943283081055
----------------------check_connections_block total spend ----------------------------- 72.14306569099426
generate_one_block  35.37307167053223
generate_one_block  35.80901646614075
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428609848022461  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.79592299461365
block generation total time  153.03814578056335
average batch blocks generation time:  76.51907289028168
block dataloader generation time/epoch 367.84925565454694
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38136565685272217 |1.3994220495224 |0.004389524459838867 |0.00015616416931152344 |0.0049898624420166016 |0.003212451934814453 |
----------------------------------------------------------pseudo_mini_loss sum 0.34524762630462646
Total (block generation + training)time/epoch 371.68757330408
Training time/epoch 3.995709180831909
Training time without block to device /epoch 1.1968650817871094
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.13it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.64it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.25it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.63it/s] 40%|████      | 10/25 [00:00<00:00, 17.89it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.01it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.13it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.19it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.18it/s] 80%|████████  | 20/25 [00:01<00:00, 18.19it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.11it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.20it/s]100%|██████████| 25/25 [00:01<00:00, 18.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.48it/s]  8%|▊         | 2/25 [00:00<00:03,  6.51it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.50it/s] 20%|██        | 5/25 [00:00<00:03,  6.53it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.50it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.46it/s] 40%|████      | 10/25 [00:01<00:02,  6.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.50it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.46it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.41it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.24it/s]  8%|▊         | 2/25 [00:00<00:03,  6.38it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.32it/s] 20%|██        | 5/25 [00:00<00:03,  6.37it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.39it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.41it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  7.16it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
Run 00 | Epoch 00198 | Loss 0.3452 | Train 0.7006 | Val 0.6911 | Test 0.5479
Number of nodes during this epoch:  4637548
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427433967590332  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0334272384643555
range selection method range initialization spend 0.02436208724975586
time for parepare:  0.35979437828063965
local_output_nid generation:  0.02621936798095703
local_in_edges_tensor generation:  0.21709036827087402
mini_batch_src_global generation:  0.3685476779937744
r_  generation:  5.354806423187256
local_output_nid generation:  0.026767730712890625
local_in_edges_tensor generation:  0.1945807933807373
mini_batch_src_global generation:  0.4553215503692627
r_  generation:  5.598702907562256
----------------------check_connections_block total spend ----------------------------- 14.225741386413574
generate_one_block  6.75348687171936
generate_one_block  6.953173875808716
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9652814865112305
gen group dst list time:  0.09046101570129395
time for parepare:  0.5435178279876709
local_output_nid generation:  0.32183122634887695
local_in_edges_tensor generation:  1.6290555000305176
mini_batch_src_global generation:  2.4217145442962646
r_  generation:  29.670334815979004
local_output_nid generation:  0.6564502716064453
local_in_edges_tensor generation:  2.0898325443267822
mini_batch_src_global generation:  3.591840982437134
r_  generation:  29.953240156173706
----------------------check_connections_block total spend ----------------------------- 82.56972050666809
generate_one_block  40.98298621177673
generate_one_block  40.994983434677124
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.279435873031616
gen group dst list time:  0.20477986335754395
time for parepare:  0.4836769104003906
local_output_nid generation:  0.4089484214782715
local_in_edges_tensor generation:  1.5596559047698975
mini_batch_src_global generation:  2.180997133255005
r_  generation:  26.407291173934937
local_output_nid generation:  0.7295148372650146
local_in_edges_tensor generation:  1.953413963317871
mini_batch_src_global generation:  2.8164899349212646
r_  generation:  26.347320556640625
----------------------check_connections_block total spend ----------------------------- 72.96927261352539
generate_one_block  35.37538194656372
generate_one_block  36.07389998435974
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427433967590332  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.53899312019348
block generation total time  153.42725157737732
average batch blocks generation time:  76.71362578868866
block dataloader generation time/epoch 367.8405657018249
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3829309940338135 |1.3183679580688477 |0.004484057426452637 |0.00014770030975341797 |0.005125880241394043 |0.0015227794647216797 |
----------------------------------------------------------pseudo_mini_loss sum 0.34414228796958923
Total (block generation + training)time/epoch 371.67885270430213
Training time/epoch 3.832044839859009
Training time without block to device /epoch 1.1953089237213135
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.98it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.62it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.06it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.41it/s] 40%|████      | 10/25 [00:00<00:00, 17.47it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.74it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.91it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.92it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.94it/s] 80%|████████  | 20/25 [00:01<00:00, 17.72it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.91it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.98it/s]100%|██████████| 25/25 [00:01<00:00, 17.91it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.67it/s]  8%|▊         | 2/25 [00:00<00:03,  6.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.84it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.55it/s] 20%|██        | 5/25 [00:00<00:03,  5.41it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.29it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.96it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.03it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.14it/s] 40%|████      | 10/25 [00:01<00:02,  5.01it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.37it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.70it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.74it/s] 60%|██████    | 15/25 [00:02<00:01,  5.97it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.68it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.49it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.39it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.25it/s] 80%|████████  | 20/25 [00:03<00:00,  5.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.19it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.14it/s] 92%|█████████▏| 23/25 [00:04<00:00,  4.74it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.17it/s]100%|██████████| 25/25 [00:04<00:00,  5.79it/s]100%|██████████| 25/25 [00:04<00:00,  5.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.90it/s]  8%|▊         | 2/25 [00:00<00:04,  4.83it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.80it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.14it/s] 20%|██        | 5/25 [00:00<00:03,  5.62it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.34it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.13it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.05it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.00it/s] 40%|████      | 10/25 [00:01<00:02,  5.01it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.96it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.91it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.68it/s] 60%|██████    | 15/25 [00:02<00:01,  5.47it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.34it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.36it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.28it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.45it/s] 80%|████████  | 20/25 [00:03<00:00,  5.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.65it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.94it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.13it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.28it/s]100%|██████████| 25/25 [00:04<00:00,  5.53it/s]
Run 00 | Epoch 00199 | Loss 0.3441 | Train 0.7029 | Val 0.6926 | Test 0.5491
Number of nodes during this epoch:  4637304
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424219608306885  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.137096881866455
range selection method range initialization spend 0.024251699447631836
time for parepare:  0.3695392608642578
local_output_nid generation:  0.026846885681152344
local_in_edges_tensor generation:  0.21785879135131836
mini_batch_src_global generation:  0.3708326816558838
r_  generation:  5.684697151184082
local_output_nid generation:  0.03040599822998047
local_in_edges_tensor generation:  0.23628807067871094
mini_batch_src_global generation:  0.4682159423828125
r_  generation:  5.9200599193573
----------------------check_connections_block total spend ----------------------------- 15.000739097595215
generate_one_block  7.226345062255859
generate_one_block  7.015807628631592
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0744407176971436
gen group dst list time:  0.09287524223327637
time for parepare:  0.4635188579559326
local_output_nid generation:  0.27010464668273926
local_in_edges_tensor generation:  1.7067592144012451
mini_batch_src_global generation:  2.5115878582000732
r_  generation:  29.9920654296875
local_output_nid generation:  0.5324904918670654
local_in_edges_tensor generation:  2.0587034225463867
mini_batch_src_global generation:  3.7845358848571777
r_  generation:  29.97796082496643
----------------------check_connections_block total spend ----------------------------- 83.18540215492249
generate_one_block  41.30712819099426
generate_one_block  41.17658615112305
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2231929302215576
gen group dst list time:  0.1826949119567871
time for parepare:  0.43515920639038086
local_output_nid generation:  0.40732812881469727
local_in_edges_tensor generation:  1.5553691387176514
mini_batch_src_global generation:  2.2331418991088867
r_  generation:  26.35551166534424
local_output_nid generation:  0.7371721267700195
local_in_edges_tensor generation:  1.9355032444000244
mini_batch_src_global generation:  2.8365602493286133
r_  generation:  26.17532753944397
----------------------check_connections_block total spend ----------------------------- 72.74495697021484
generate_one_block  35.298057556152344
generate_one_block  36.11478281021118
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424219608306885  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.93035912513733
block generation total time  153.89655470848083
average batch blocks generation time:  76.94827735424042
block dataloader generation time/epoch 367.8471205067635
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3816338777542114 |1.3075621128082275 |0.004403352737426758 |0.0001569986343383789 |0.005090951919555664 |0.0028650760650634766 |
----------------------------------------------------------pseudo_mini_loss sum 0.3456314206123352
Total (block generation + training)time/epoch 371.6852672624588
Training time/epoch 3.8100602626800537
Training time without block to device /epoch 1.1949360370635986
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.89it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.57it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.31it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.72it/s] 40%|████      | 10/25 [00:00<00:01, 14.09it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.30it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.89it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.42it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.71it/s] 80%|████████  | 20/25 [00:01<00:00, 15.76it/s] 88%|████████▊ | 22/25 [00:01<00:00, 14.18it/s] 96%|█████████▌| 24/25 [00:01<00:00, 14.46it/s]100%|██████████| 25/25 [00:01<00:00, 15.65it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:03,  6.61it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.94it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.61it/s] 20%|██        | 5/25 [00:00<00:03,  5.30it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.59it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.90it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.11it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.28it/s] 40%|████      | 10/25 [00:01<00:02,  5.82it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.90it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.08it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.24it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.34it/s] 60%|██████    | 15/25 [00:02<00:01,  5.90it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.06it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.22it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.32it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.26it/s]100%|██████████| 25/25 [00:04<00:00,  6.22it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.06it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.46it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.50it/s] 20%|██        | 5/25 [00:00<00:03,  5.97it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.85it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.99it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.14it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.25it/s] 40%|████      | 10/25 [00:01<00:02,  6.30it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.34it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.39it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.43it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.40it/s]100%|██████████| 25/25 [00:03<00:00,  7.18it/s]100%|██████████| 25/25 [00:03<00:00,  6.42it/s]
Run 00 | Epoch 00200 | Loss 0.3456 | Train 0.7038 | Val 0.6935 | Test 0.5501
Number of nodes during this epoch:  4638304
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423516750335693  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1887540817260742
range selection method range initialization spend 0.02522587776184082
time for parepare:  0.36673688888549805
local_output_nid generation:  0.02573227882385254
local_in_edges_tensor generation:  0.20449066162109375
mini_batch_src_global generation:  0.3814225196838379
r_  generation:  5.584247350692749
local_output_nid generation:  0.02780914306640625
local_in_edges_tensor generation:  0.21434831619262695
mini_batch_src_global generation:  0.45733070373535156
r_  generation:  5.665284872055054
----------------------check_connections_block total spend ----------------------------- 14.57393765449524
generate_one_block  7.3406219482421875
generate_one_block  7.161168813705444
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.1215598583221436
gen group dst list time:  0.08932280540466309
time for parepare:  0.4437735080718994
local_output_nid generation:  0.262561559677124
local_in_edges_tensor generation:  1.7903108596801758
mini_batch_src_global generation:  2.476679563522339
r_  generation:  29.761751890182495
local_output_nid generation:  0.5211012363433838
local_in_edges_tensor generation:  2.100327253341675
mini_batch_src_global generation:  3.4915106296539307
r_  generation:  29.877301692962646
----------------------check_connections_block total spend ----------------------------- 82.34241127967834
generate_one_block  40.83484983444214
generate_one_block  40.93958806991577
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.167710781097412
gen group dst list time:  0.19292712211608887
time for parepare:  0.4298527240753174
local_output_nid generation:  0.3880648612976074
local_in_edges_tensor generation:  1.4442112445831299
mini_batch_src_global generation:  2.011957883834839
r_  generation:  25.618648767471313
local_output_nid generation:  0.7254972457885742
local_in_edges_tensor generation:  1.9196550846099854
mini_batch_src_global generation:  2.7054271697998047
r_  generation:  25.986501455307007
----------------------check_connections_block total spend ----------------------------- 71.02501082420349
generate_one_block  35.25802779197693
generate_one_block  36.084555864334106
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423516750335693  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.36742210388184
block generation total time  153.11702156066895
average batch blocks generation time:  76.55851078033447
block dataloader generation time/epoch 367.83805614561584
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38792526721954346 |1.3039100170135498 |0.004449605941772461 |0.00015306472778320312 |0.005040407180786133 |0.0032486915588378906 |
----------------------------------------------------------pseudo_mini_loss sum 0.3455202579498291
Total (block generation + training)time/epoch 371.67608279493913
Training time/epoch 3.813829183578491
Training time without block to device /epoch 1.2060091495513916
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.51it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.34it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:00, 17.83it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.88it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.90it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.91it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.84it/s] 80%|████████  | 20/25 [00:01<00:00, 17.96it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.13it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.26it/s]100%|██████████| 25/25 [00:01<00:00, 18.09it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.65it/s]  8%|▊         | 2/25 [00:00<00:03,  6.62it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.67it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.71it/s] 20%|██        | 5/25 [00:00<00:02,  6.71it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.67it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.64it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.64it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.64it/s] 40%|████      | 10/25 [00:01<00:02,  6.63it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.63it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.64it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.59it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.62it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.64it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.63it/s] 80%|████████  | 20/25 [00:03<00:00,  6.61it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.56it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.57it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.61it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.63it/s]100%|██████████| 25/25 [00:03<00:00,  6.73it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.32it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.42it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.57it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.23it/s] 40%|████      | 10/25 [00:01<00:02,  6.05it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.21it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.32it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.40it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.44it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.87it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00201 | Loss 0.3455 | Train 0.7017 | Val 0.6923 | Test 0.5494
Number of nodes during this epoch:  4638352
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424407005310059  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1185059547424316
range selection method range initialization spend 0.024389266967773438
time for parepare:  0.35663628578186035
local_output_nid generation:  0.026311397552490234
local_in_edges_tensor generation:  0.2351090908050537
mini_batch_src_global generation:  0.37656402587890625
r_  generation:  5.382578372955322
local_output_nid generation:  0.027716875076293945
local_in_edges_tensor generation:  0.19440531730651855
mini_batch_src_global generation:  0.4667043685913086
r_  generation:  5.589587211608887
----------------------check_connections_block total spend ----------------------------- 14.34212350845337
generate_one_block  7.1573708057403564
generate_one_block  7.139301300048828
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9806020259857178
gen group dst list time:  0.08983564376831055
time for parepare:  0.4579465389251709
local_output_nid generation:  0.25127339363098145
local_in_edges_tensor generation:  1.550222635269165
mini_batch_src_global generation:  2.4410316944122314
r_  generation:  28.99038863182068
local_output_nid generation:  0.5032992362976074
local_in_edges_tensor generation:  2.030550241470337
mini_batch_src_global generation:  3.317471742630005
r_  generation:  30.13956570625305
----------------------check_connections_block total spend ----------------------------- 81.32762336730957
generate_one_block  41.05749797821045
generate_one_block  41.04523253440857
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.279165267944336
gen group dst list time:  0.18744158744812012
time for parepare:  0.4556865692138672
local_output_nid generation:  0.4147517681121826
local_in_edges_tensor generation:  1.5172147750854492
mini_batch_src_global generation:  2.188772201538086
r_  generation:  26.480717420578003
local_output_nid generation:  0.7335608005523682
local_in_edges_tensor generation:  1.92519211769104
mini_batch_src_global generation:  2.8361032009124756
r_  generation:  26.24036478996277
----------------------check_connections_block total spend ----------------------------- 72.83531999588013
generate_one_block  35.34225249290466
generate_one_block  36.102702379226685
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424407005310059  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.1629433631897
block generation total time  153.54768538475037
average batch blocks generation time:  76.77384269237518
block dataloader generation time/epoch 367.82878550916615
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3930736780166626 |1.3200472593307495 |0.0044133663177490234 |0.00015246868133544922 |0.005190610885620117 |0.003036975860595703 |
----------------------------------------------------------pseudo_mini_loss sum 0.34364020824432373
Total (block generation + training)time/epoch 371.66690328333635
Training time/epoch 3.8562614917755127
Training time without block to device /epoch 1.2161669731140137
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.43it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.13it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.52it/s] 40%|████      | 10/25 [00:00<00:00, 17.77it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.95it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.02it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.11it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.18it/s] 80%|████████  | 20/25 [00:01<00:00, 18.23it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.25it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.21it/s]100%|██████████| 25/25 [00:01<00:00, 18.12it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.36it/s]  8%|▊         | 2/25 [00:00<00:03,  6.43it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.38it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.41it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.46it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.46it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.45it/s] 60%|██████    | 15/25 [00:02<00:01,  6.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.15it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.12it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.86it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.87it/s] 80%|████████  | 20/25 [00:03<00:00,  5.76it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.82it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.90it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.01it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.13it/s]100%|██████████| 25/25 [00:03<00:00,  6.89it/s]100%|██████████| 25/25 [00:03<00:00,  6.30it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:03,  6.23it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.33it/s] 20%|██        | 5/25 [00:00<00:03,  6.32it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.35it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.32it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.35it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.33it/s] 40%|████      | 10/25 [00:01<00:02,  6.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.10it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.20it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.26it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.65it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.79it/s] 80%|████████  | 20/25 [00:03<00:00,  5.94it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.79it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.84it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.86it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.99it/s]100%|██████████| 25/25 [00:04<00:00,  6.80it/s]100%|██████████| 25/25 [00:04<00:00,  6.23it/s]
Run 00 | Epoch 00202 | Loss 0.3436 | Train 0.7005 | Val 0.6911 | Test 0.5487
Number of nodes during this epoch:  4637788
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4282331466674805  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1853876113891602
range selection method range initialization spend 0.025254249572753906
time for parepare:  0.36512112617492676
local_output_nid generation:  0.026911020278930664
local_in_edges_tensor generation:  0.20211553573608398
mini_batch_src_global generation:  0.370471715927124
r_  generation:  5.389933109283447
local_output_nid generation:  0.028003454208374023
local_in_edges_tensor generation:  0.21495366096496582
mini_batch_src_global generation:  0.46098852157592773
r_  generation:  5.706969738006592
----------------------check_connections_block total spend ----------------------------- 14.41111445426941
generate_one_block  7.274672985076904
generate_one_block  6.784088850021362
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.189255714416504
gen group dst list time:  0.08596062660217285
time for parepare:  0.4646470546722412
local_output_nid generation:  0.25394153594970703
local_in_edges_tensor generation:  1.5935044288635254
mini_batch_src_global generation:  2.4432485103607178
r_  generation:  29.002769231796265
local_output_nid generation:  0.5187485218048096
local_in_edges_tensor generation:  2.0547471046447754
mini_batch_src_global generation:  3.333620309829712
r_  generation:  30.028246641159058
----------------------check_connections_block total spend ----------------------------- 81.68023109436035
generate_one_block  41.11940860748291
generate_one_block  41.3064239025116
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.398385763168335
gen group dst list time:  0.20653486251831055
time for parepare:  0.48329710960388184
local_output_nid generation:  0.4164772033691406
local_in_edges_tensor generation:  1.5166056156158447
mini_batch_src_global generation:  2.016279458999634
r_  generation:  26.371127605438232
local_output_nid generation:  0.7407321929931641
local_in_edges_tensor generation:  1.9389607906341553
mini_batch_src_global generation:  2.824993848800659
r_  generation:  26.211321592330933
----------------------check_connections_block total spend ----------------------------- 72.43597435951233
generate_one_block  35.22423005104065
generate_one_block  36.0199990272522
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4282331466674805  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.11620545387268
block generation total time  153.67006158828735
average batch blocks generation time:  76.83503079414368
block dataloader generation time/epoch 367.82349051982897
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3886547088623047 |1.3006426095962524 |0.004410266876220703 |0.00014853477478027344 |0.005132317543029785 |0.0016639232635498047 |
----------------------------------------------------------pseudo_mini_loss sum 0.3445631265640259
Total (block generation + training)time/epoch 371.66150269719765
Training time/epoch 3.8165080547332764
Training time without block to device /epoch 1.2152228355407715
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.23it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.77it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.39it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.71it/s] 40%|████      | 10/25 [00:00<00:00, 17.93it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.22it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.27it/s] 80%|████████  | 20/25 [00:01<00:00, 18.30it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.25it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.28it/s]100%|██████████| 25/25 [00:01<00:00, 18.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.44it/s]  8%|▊         | 2/25 [00:00<00:03,  6.47it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.53it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.55it/s] 20%|██        | 5/25 [00:00<00:03,  6.55it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.57it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.54it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.56it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.58it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.59it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.59it/s] 60%|██████    | 15/25 [00:02<00:01,  6.58it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.58it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.57it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.54it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.54it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.51it/s]100%|██████████| 25/25 [00:03<00:00,  7.04it/s]100%|██████████| 25/25 [00:03<00:00,  6.61it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.24it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.45it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.24it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.31it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.39it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.19it/s] 40%|████      | 10/25 [00:01<00:02,  6.29it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.26it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.11it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.22it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.31it/s] 60%|██████    | 15/25 [00:02<00:01,  6.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.41it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  6.42it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  7.20it/s]100%|██████████| 25/25 [00:03<00:00,  6.44it/s]
Run 00 | Epoch 00203 | Loss 0.3446 | Train 0.7011 | Val 0.6914 | Test 0.5488
Number of nodes during this epoch:  4637670
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423801898956299  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0797679424285889
range selection method range initialization spend 0.024822711944580078
time for parepare:  0.35312938690185547
local_output_nid generation:  0.02634596824645996
local_in_edges_tensor generation:  0.20819854736328125
mini_batch_src_global generation:  0.3708174228668213
r_  generation:  5.348240375518799
local_output_nid generation:  0.02672886848449707
local_in_edges_tensor generation:  0.1949596405029297
mini_batch_src_global generation:  0.4585728645324707
r_  generation:  5.589929103851318
----------------------check_connections_block total spend ----------------------------- 14.199465274810791
generate_one_block  7.182817220687866
generate_one_block  6.810265779495239
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.04402756690979
gen group dst list time:  0.08305025100708008
time for parepare:  0.4276549816131592
local_output_nid generation:  0.249802827835083
local_in_edges_tensor generation:  1.5996918678283691
mini_batch_src_global generation:  2.415388345718384
r_  generation:  29.12523078918457
local_output_nid generation:  0.5144393444061279
local_in_edges_tensor generation:  2.1260197162628174
mini_batch_src_global generation:  3.488211154937744
r_  generation:  30.341197729110718
----------------------check_connections_block total spend ----------------------------- 81.85727000236511
generate_one_block  41.285276889801025
generate_one_block  41.25869178771973
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2991833686828613
gen group dst list time:  0.18921971321105957
time for parepare:  0.4662477970123291
local_output_nid generation:  0.38951754570007324
local_in_edges_tensor generation:  1.4934611320495605
mini_batch_src_global generation:  2.0167183876037598
r_  generation:  25.940681219100952
local_output_nid generation:  0.7404234409332275
local_in_edges_tensor generation:  1.9562993049621582
mini_batch_src_global generation:  2.9779036045074463
r_  generation:  26.043740272521973
----------------------check_connections_block total spend ----------------------------- 72.20479488372803
generate_one_block  35.45077681541443
generate_one_block  36.13185977935791
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423801898956299  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.06206488609314
block generation total time  154.1266052722931
average batch blocks generation time:  77.06330263614655
block dataloader generation time/epoch 367.81383492666134
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38505029678344727 |1.318284511566162 |0.0044023990631103516 |0.00015211105346679688 |0.005064249038696289 |0.002901315689086914 |
----------------------------------------------------------pseudo_mini_loss sum 0.34389227628707886
Total (block generation + training)time/epoch 371.65183611710864
Training time/epoch 3.835599184036255
Training time without block to device /epoch 1.1990301609039307
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.27it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.78it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.53it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.87it/s] 40%|████      | 10/25 [00:00<00:00, 17.92it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.69it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.85it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.04it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.97it/s] 80%|████████  | 20/25 [00:01<00:00, 17.92it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.03it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.97it/s]100%|██████████| 25/25 [00:01<00:00, 17.96it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.62it/s]  8%|▊         | 2/25 [00:00<00:04,  5.65it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.26it/s] 20%|██        | 5/25 [00:00<00:03,  5.22it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.19it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.18it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.12it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.09it/s] 40%|████      | 10/25 [00:01<00:02,  5.07it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.10it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.11it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.97it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.01it/s] 60%|██████    | 15/25 [00:02<00:02,  4.94it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.34it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.66it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.52it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.49it/s] 80%|████████  | 20/25 [00:03<00:00,  5.55it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.75it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.94it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.12it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.26it/s]100%|██████████| 25/25 [00:04<00:00,  7.00it/s]100%|██████████| 25/25 [00:04<00:00,  5.55it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.22it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.33it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.36it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.83it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.95it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.09it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.82it/s] 40%|████      | 10/25 [00:01<00:02,  5.80it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.88it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.00it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.10it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.17it/s] 60%|██████    | 15/25 [00:02<00:01,  6.27it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.32it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.28it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.33it/s] 80%|████████  | 20/25 [00:03<00:00,  6.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.37it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.30it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.31it/s]
Run 00 | Epoch 00204 | Loss 0.3439 | Train 0.7003 | Val 0.6909 | Test 0.5482
Number of nodes during this epoch:  4638056
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424892902374268  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1770384311676025
range selection method range initialization spend 0.03666067123413086
time for parepare:  0.3591923713684082
local_output_nid generation:  0.026457548141479492
local_in_edges_tensor generation:  0.2160499095916748
mini_batch_src_global generation:  0.36931729316711426
r_  generation:  5.4943718910217285
local_output_nid generation:  0.028579235076904297
local_in_edges_tensor generation:  0.2178332805633545
mini_batch_src_global generation:  0.4778742790222168
r_  generation:  5.814961194992065
----------------------check_connections_block total spend ----------------------------- 14.678634643554688
generate_one_block  7.25476336479187
generate_one_block  6.985440254211426
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.029095888137817
gen group dst list time:  0.08704185485839844
time for parepare:  0.432736873626709
local_output_nid generation:  0.26112890243530273
local_in_edges_tensor generation:  1.6586086750030518
mini_batch_src_global generation:  2.54555606842041
r_  generation:  29.673263549804688
local_output_nid generation:  0.5231068134307861
local_in_edges_tensor generation:  2.0784099102020264
mini_batch_src_global generation:  3.5432610511779785
r_  generation:  29.95371150970459
----------------------check_connections_block total spend ----------------------------- 82.67437887191772
generate_one_block  40.607173204422
generate_one_block  41.073580265045166
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.233245849609375
gen group dst list time:  0.18216514587402344
time for parepare:  0.45508289337158203
local_output_nid generation:  0.36703038215637207
local_in_edges_tensor generation:  1.4656071662902832
mini_batch_src_global generation:  2.0145673751831055
r_  generation:  25.244290590286255
local_output_nid generation:  0.712216854095459
local_in_edges_tensor generation:  1.9291417598724365
mini_batch_src_global generation:  2.7957019805908203
r_  generation:  25.897504329681396
----------------------check_connections_block total spend ----------------------------- 71.18300151824951
generate_one_block  34.66289710998535
generate_one_block  35.650381565093994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424892902374268  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.85738039016724
block generation total time  151.9940321445465
average batch blocks generation time:  75.99701607227325
block dataloader generation time/epoch 367.7986673413253
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3738642930984497 |1.283363699913025 |0.0043152570724487305 |0.00014638900756835938 |0.005060076713562012 |0.0029659271240234375 |
----------------------------------------------------------pseudo_mini_loss sum 0.3437877893447876
Total (block generation + training)time/epoch 371.63620824232333
Training time/epoch 3.74346923828125
Training time without block to device /epoch 1.1767418384552002
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.43it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.96it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.02it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.52it/s] 40%|████      | 10/25 [00:00<00:01, 13.94it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.03it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.97it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.61it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.13it/s] 80%|████████  | 20/25 [00:01<00:00, 17.49it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.64it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.80it/s]100%|██████████| 25/25 [00:01<00:00, 16.96it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.32it/s]  8%|▊         | 2/25 [00:00<00:03,  6.55it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.71it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.84it/s] 20%|██        | 5/25 [00:00<00:03,  6.14it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.78it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.60it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.47it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.19it/s] 40%|████      | 10/25 [00:01<00:03,  4.82it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.09it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.08it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.72it/s] 60%|██████    | 15/25 [00:02<00:01,  5.51it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.38it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.20it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.15it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.36it/s] 80%|████████  | 20/25 [00:03<00:00,  5.75it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.57it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.26it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.13it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.80it/s]100%|██████████| 25/25 [00:04<00:00,  5.40it/s]100%|██████████| 25/25 [00:04<00:00,  5.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.88it/s]  8%|▊         | 2/25 [00:00<00:04,  5.74it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.17it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.72it/s] 20%|██        | 5/25 [00:00<00:03,  5.44it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.23it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.11it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.97it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.75it/s] 40%|████      | 10/25 [00:01<00:03,  4.82it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.90it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.96it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.00it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.03it/s] 60%|██████    | 15/25 [00:02<00:01,  5.10it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.35it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.74it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.05it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.19it/s] 80%|████████  | 20/25 [00:03<00:00,  5.81it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.04it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.26it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.91it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.62it/s]100%|██████████| 25/25 [00:04<00:00,  6.08it/s]100%|██████████| 25/25 [00:04<00:00,  5.49it/s]
Run 00 | Epoch 00205 | Loss 0.3438 | Train 0.7001 | Val 0.6907 | Test 0.5483
Number of nodes during this epoch:  4637675
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426088809967041  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1149206161499023
range selection method range initialization spend 0.03493380546569824
time for parepare:  0.3761556148529053
local_output_nid generation:  0.026666641235351562
local_in_edges_tensor generation:  0.2716398239135742
mini_batch_src_global generation:  0.3848257064819336
r_  generation:  5.467067003250122
local_output_nid generation:  0.02895951271057129
local_in_edges_tensor generation:  0.21622204780578613
mini_batch_src_global generation:  0.5131866931915283
r_  generation:  5.864912509918213
----------------------check_connections_block total spend ----------------------------- 14.875293493270874
generate_one_block  7.272243976593018
generate_one_block  7.056737661361694
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.104202508926392
gen group dst list time:  0.0972900390625
time for parepare:  0.45896291732788086
local_output_nid generation:  0.2718367576599121
local_in_edges_tensor generation:  1.6647334098815918
mini_batch_src_global generation:  2.4669628143310547
r_  generation:  29.717272520065308
local_output_nid generation:  0.5323939323425293
local_in_edges_tensor generation:  2.044025421142578
mini_batch_src_global generation:  3.4857447147369385
r_  generation:  30.048465490341187
----------------------check_connections_block total spend ----------------------------- 82.80980181694031
generate_one_block  40.91202163696289
generate_one_block  41.15239119529724
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1636433601379395
gen group dst list time:  0.1883254051208496
time for parepare:  0.45966315269470215
local_output_nid generation:  0.37810206413269043
local_in_edges_tensor generation:  1.4439480304718018
mini_batch_src_global generation:  2.0099480152130127
r_  generation:  25.337295055389404
local_output_nid generation:  0.7206447124481201
local_in_edges_tensor generation:  1.9577336311340332
mini_batch_src_global generation:  2.778754949569702
r_  generation:  25.874457836151123
----------------------check_connections_block total spend ----------------------------- 71.29806327819824
generate_one_block  35.10034441947937
generate_one_block  35.37281656265259
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426088809967041  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.10786509513855
block generation total time  152.5375738143921
average batch blocks generation time:  76.26878690719604
block dataloader generation time/epoch 367.7880859421295
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3865863084793091 |1.3904160261154175 |0.004379153251647949 |0.00015020370483398438 |0.005265474319458008 |0.001875162124633789 |
----------------------------------------------------------pseudo_mini_loss sum 0.34309205412864685
Total (block generation + training)time/epoch 371.6263229013647
Training time/epoch 3.9807536602020264
Training time without block to device /epoch 1.1999216079711914
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.78it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.95it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.44it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.81it/s] 40%|████      | 10/25 [00:00<00:00, 18.03it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.21it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.28it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.35it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.41it/s] 80%|████████  | 20/25 [00:01<00:00, 18.40it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.13it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.23it/s]100%|██████████| 25/25 [00:01<00:00, 18.31it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.39it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.59it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.52it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.47it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.79it/s] 40%|████      | 10/25 [00:01<00:02,  6.02it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.19it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.21it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.40it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.48it/s] 60%|██████    | 15/25 [00:02<00:01,  6.56it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.65it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.69it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.73it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.75it/s] 80%|████████  | 20/25 [00:03<00:00,  6.77it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.79it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.81it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.80it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.80it/s]100%|██████████| 25/25 [00:03<00:00,  6.64it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.79it/s]  8%|▊         | 2/25 [00:00<00:04,  5.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.04it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.26it/s] 20%|██        | 5/25 [00:00<00:03,  6.35it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.36it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.44it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.49it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.53it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.56it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.59it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.60it/s] 60%|██████    | 15/25 [00:02<00:01,  6.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.53it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.44it/s] 80%|████████  | 20/25 [00:03<00:00,  6.47it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.48it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.53it/s]
Run 00 | Epoch 00206 | Loss 0.3431 | Train 0.7020 | Val 0.6919 | Test 0.5495
Number of nodes during this epoch:  4637364
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423019886016846  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1067798137664795
range selection method range initialization spend 0.03965163230895996
time for parepare:  0.3736536502838135
local_output_nid generation:  0.026880979537963867
local_in_edges_tensor generation:  0.20253515243530273
mini_batch_src_global generation:  0.37509918212890625
r_  generation:  5.6856160163879395
local_output_nid generation:  0.02956223487854004
local_in_edges_tensor generation:  0.23267078399658203
mini_batch_src_global generation:  0.465073823928833
r_  generation:  5.930424451828003
----------------------check_connections_block total spend ----------------------------- 14.998048543930054
generate_one_block  7.2030322551727295
generate_one_block  6.920182228088379
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.09902286529541
gen group dst list time:  0.0941615104675293
time for parepare:  0.45116233825683594
local_output_nid generation:  0.26717662811279297
local_in_edges_tensor generation:  1.65435791015625
mini_batch_src_global generation:  2.536417007446289
r_  generation:  29.830869436264038
local_output_nid generation:  0.5376095771789551
local_in_edges_tensor generation:  2.277329444885254
mini_batch_src_global generation:  3.7128098011016846
r_  generation:  29.74742317199707
----------------------check_connections_block total spend ----------------------------- 82.99145650863647
generate_one_block  40.79037261009216
generate_one_block  40.67177963256836
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1824162006378174
gen group dst list time:  0.1842658519744873
time for parepare:  0.4733238220214844
local_output_nid generation:  0.38216066360473633
local_in_edges_tensor generation:  1.5005898475646973
mini_batch_src_global generation:  2.04687237739563
r_  generation:  25.74893856048584
local_output_nid generation:  0.7421679496765137
local_in_edges_tensor generation:  1.986619234085083
mini_batch_src_global generation:  3.0258448123931885
r_  generation:  25.94742226600647
----------------------check_connections_block total spend ----------------------------- 72.18530178070068
generate_one_block  35.440176486968994
generate_one_block  36.1579794883728
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423019886016846  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.17675828933716
block generation total time  153.06030821800232
average batch blocks generation time:  76.53015410900116
block dataloader generation time/epoch 367.78540261356153
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38655173778533936 |1.3171930313110352 |0.004750251770019531 |0.00015807151794433594 |0.005095362663269043 |0.003014802932739258 |
----------------------------------------------------------pseudo_mini_loss sum 0.3433052599430084
Total (block generation + training)time/epoch 371.62367989705956
Training time/epoch 3.846407413482666
Training time without block to device /epoch 1.2120213508605957
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.20it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.67it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.26it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.99it/s] 40%|████      | 10/25 [00:00<00:00, 17.36it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.72it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.91it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.78it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.90it/s] 80%|████████  | 20/25 [00:01<00:00, 17.96it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.06it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.08it/s]100%|██████████| 25/25 [00:01<00:00, 17.94it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.46it/s]  8%|▊         | 2/25 [00:00<00:04,  5.62it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.98it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.22it/s] 20%|██        | 5/25 [00:00<00:03,  5.74it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.86it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.10it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.21it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.29it/s] 40%|████      | 10/25 [00:01<00:02,  6.26it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.31it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.42it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.53it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.54it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.57it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.59it/s] 80%|████████  | 20/25 [00:03<00:00,  6.57it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.60it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.60it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.58it/s]100%|██████████| 25/25 [00:03<00:00,  7.29it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.21it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.52it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.49it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.24it/s] 60%|██████    | 15/25 [00:02<00:01,  6.27it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.87it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.88it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.01it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.18it/s] 80%|████████  | 20/25 [00:03<00:00,  6.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.33it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  7.19it/s]100%|██████████| 25/25 [00:03<00:00,  6.43it/s]
Run 00 | Epoch 00207 | Loss 0.3433 | Train 0.7011 | Val 0.6915 | Test 0.5490
Number of nodes during this epoch:  4638075
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424278259277344  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0983657836914062
range selection method range initialization spend 0.03522825241088867
time for parepare:  0.3737976551055908
local_output_nid generation:  0.026189565658569336
local_in_edges_tensor generation:  0.233536958694458
mini_batch_src_global generation:  0.3717179298400879
r_  generation:  5.550510883331299
local_output_nid generation:  0.043665409088134766
local_in_edges_tensor generation:  0.22494006156921387
mini_batch_src_global generation:  0.4707460403442383
r_  generation:  5.883281469345093
----------------------check_connections_block total spend ----------------------------- 14.969640970230103
generate_one_block  7.232797861099243
generate_one_block  6.909330606460571
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0575220584869385
gen group dst list time:  0.09016799926757812
time for parepare:  0.44548702239990234
local_output_nid generation:  0.2837538719177246
local_in_edges_tensor generation:  1.648364782333374
mini_batch_src_global generation:  2.545846462249756
r_  generation:  29.588716983795166
local_output_nid generation:  0.5257275104522705
local_in_edges_tensor generation:  2.2170212268829346
mini_batch_src_global generation:  3.712023973464966
r_  generation:  29.45473003387451
----------------------check_connections_block total spend ----------------------------- 82.33370113372803
generate_one_block  40.39989638328552
generate_one_block  40.80248308181763
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2618188858032227
gen group dst list time:  0.19144439697265625
time for parepare:  0.4550011157989502
local_output_nid generation:  0.4065423011779785
local_in_edges_tensor generation:  1.6616525650024414
mini_batch_src_global generation:  2.099760055541992
r_  generation:  26.349754095077515
local_output_nid generation:  0.7632255554199219
local_in_edges_tensor generation:  2.020219087600708
mini_batch_src_global generation:  3.0467002391815186
r_  generation:  26.733800411224365
----------------------check_connections_block total spend ----------------------------- 74.04563617706299
generate_one_block  35.56373929977417
generate_one_block  36.0362982749939
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424278259277344  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.37933731079102
block generation total time  152.80241703987122
average batch blocks generation time:  76.40120851993561
block dataloader generation time/epoch 367.7864970186582
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37881433963775635 |1.464085340499878 |0.004887819290161133 |0.0001761913299560547 |0.005102872848510742 |0.002919912338256836 |
----------------------------------------------------------pseudo_mini_loss sum 0.3420705795288086
Total (block generation + training)time/epoch 371.6261234226135
Training time/epoch 4.1187145709991455
Training time without block to device /epoch 1.1905438899993896
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.39it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.80it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.08it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.49it/s] 40%|████      | 10/25 [00:00<00:00, 17.74it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.96it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.81it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.99it/s] 80%|████████  | 20/25 [00:01<00:00, 18.07it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.03it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.60it/s]100%|██████████| 25/25 [00:01<00:00, 17.76it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.37it/s]  8%|▊         | 2/25 [00:00<00:03,  6.60it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.67it/s] 20%|██        | 5/25 [00:00<00:02,  6.70it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.68it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.62it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.63it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.64it/s] 40%|████      | 10/25 [00:01<00:02,  6.65it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.64it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.62it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.64it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.62it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.60it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.63it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.14it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.82it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.58it/s]100%|██████████| 25/25 [00:03<00:00,  6.36it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.15it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.41it/s] 20%|██        | 5/25 [00:00<00:03,  6.36it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.39it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.32it/s] 40%|████      | 10/25 [00:01<00:02,  6.31it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.83it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.81it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.91it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.04it/s] 60%|██████    | 15/25 [00:02<00:01,  6.09it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.18it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.25it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.29it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.43it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.44it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]
Run 00 | Epoch 00208 | Loss 0.3421 | Train 0.6983 | Val 0.6889 | Test 0.5472
Number of nodes during this epoch:  4637651
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425670623779297  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1040387153625488
range selection method range initialization spend 0.02672433853149414
time for parepare:  0.3564746379852295
local_output_nid generation:  0.026493072509765625
local_in_edges_tensor generation:  0.23686671257019043
mini_batch_src_global generation:  0.3747408390045166
r_  generation:  5.637624740600586
local_output_nid generation:  0.029240131378173828
local_in_edges_tensor generation:  0.23250794410705566
mini_batch_src_global generation:  0.47582459449768066
r_  generation:  5.87997579574585
----------------------check_connections_block total spend ----------------------------- 14.950037956237793
generate_one_block  7.175845623016357
generate_one_block  6.847454071044922
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.012118339538574
gen group dst list time:  0.0902407169342041
time for parepare:  0.4487590789794922
local_output_nid generation:  0.2698843479156494
local_in_edges_tensor generation:  1.6486339569091797
mini_batch_src_global generation:  2.6202232837677
r_  generation:  29.566739082336426
local_output_nid generation:  0.5207338333129883
local_in_edges_tensor generation:  2.064479351043701
mini_batch_src_global generation:  3.4726381301879883
r_  generation:  29.792755365371704
----------------------check_connections_block total spend ----------------------------- 82.2127320766449
generate_one_block  40.62222337722778
generate_one_block  40.68457746505737
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1985442638397217
gen group dst list time:  0.18896937370300293
time for parepare:  0.4749464988708496
local_output_nid generation:  0.39713525772094727
local_in_edges_tensor generation:  1.5036778450012207
mini_batch_src_global generation:  2.1446897983551025
r_  generation:  26.22956943511963
local_output_nid generation:  0.7257630825042725
local_in_edges_tensor generation:  1.9252378940582275
mini_batch_src_global generation:  2.831249952316284
r_  generation:  26.076733827590942
----------------------check_connections_block total spend ----------------------------- 72.22786498069763
generate_one_block  35.08406043052673
generate_one_block  36.0096538066864
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425670623779297  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.44059705734253
block generation total time  152.4005150794983
average batch blocks generation time:  76.20025753974915
block dataloader generation time/epoch 367.7758429175929
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37862372398376465 |1.1987895965576172 |0.0044127702713012695 |0.000148773193359375 |0.005240797996520996 |0.0015544891357421875 |
----------------------------------------------------------pseudo_mini_loss sum 0.3422912359237671
Total (block generation + training)time/epoch 371.6142544381356
Training time/epoch 3.585538625717163
Training time without block to device /epoch 1.1879594326019287
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.86it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.54it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.88it/s] 40%|████      | 10/25 [00:00<00:00, 17.77it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.95it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.03it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.35it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.60it/s] 80%|████████  | 20/25 [00:01<00:00, 17.93it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.11it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.23it/s]100%|██████████| 25/25 [00:01<00:00, 18.07it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.53it/s]  8%|▊         | 2/25 [00:00<00:03,  6.65it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.70it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.70it/s] 20%|██        | 5/25 [00:00<00:03,  6.66it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.66it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.63it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.64it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.62it/s] 40%|████      | 10/25 [00:01<00:02,  6.59it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.54it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.58it/s] 60%|██████    | 15/25 [00:02<00:01,  6.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.29it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.99it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.83it/s] 76%|███████▌  | 19/25 [00:02<00:01,  5.86it/s] 80%|████████  | 20/25 [00:03<00:00,  5.97it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.08it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.18it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.29it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.96it/s]100%|██████████| 25/25 [00:03<00:00,  6.35it/s]100%|██████████| 25/25 [00:03<00:00,  6.35it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.66it/s]  8%|▊         | 2/25 [00:00<00:04,  5.50it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.02it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.18it/s] 20%|██        | 5/25 [00:00<00:03,  6.32it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.05it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.95it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.06it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.15it/s] 40%|████      | 10/25 [00:01<00:02,  6.26it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.40it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.45it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.54it/s] 60%|██████    | 15/25 [00:02<00:01,  6.62it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.60it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.63it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.63it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.62it/s] 80%|████████  | 20/25 [00:03<00:00,  6.59it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.60it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.65it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.71it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.71it/s]100%|██████████| 25/25 [00:03<00:00,  6.53it/s]
Run 00 | Epoch 00209 | Loss 0.3423 | Train 0.6986 | Val 0.6891 | Test 0.5477
Number of nodes during this epoch:  4637607
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424136161804199  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0769741535186768
range selection method range initialization spend 0.0250394344329834
time for parepare:  0.3570113182067871
local_output_nid generation:  0.026058673858642578
local_in_edges_tensor generation:  0.22956514358520508
mini_batch_src_global generation:  0.36753392219543457
r_  generation:  5.441546678543091
local_output_nid generation:  0.030427217483520508
local_in_edges_tensor generation:  0.24868345260620117
mini_batch_src_global generation:  0.48935437202453613
r_  generation:  5.674068927764893
----------------------check_connections_block total spend ----------------------------- 14.594118595123291
generate_one_block  7.261351585388184
generate_one_block  6.9891064167022705
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.006414890289307
gen group dst list time:  0.09056520462036133
time for parepare:  0.44717907905578613
local_output_nid generation:  0.2709388732910156
local_in_edges_tensor generation:  1.6342296600341797
mini_batch_src_global generation:  2.515458822250366
r_  generation:  29.974236011505127
local_output_nid generation:  0.523719072341919
local_in_edges_tensor generation:  2.1385114192962646
mini_batch_src_global generation:  3.539803981781006
r_  generation:  29.737884044647217
----------------------check_connections_block total spend ----------------------------- 82.95830011367798
generate_one_block  40.48632597923279
generate_one_block  40.49268555641174
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.265561819076538
gen group dst list time:  0.18104815483093262
time for parepare:  0.4870574474334717
local_output_nid generation:  0.43378376960754395
local_in_edges_tensor generation:  1.574155569076538
mini_batch_src_global generation:  2.0664310455322266
r_  generation:  26.28859782218933
local_output_nid generation:  0.7503132820129395
local_in_edges_tensor generation:  1.9355103969573975
mini_batch_src_global generation:  2.925934314727783
r_  generation:  26.513608932495117
----------------------check_connections_block total spend ----------------------------- 73.21778416633606
generate_one_block  35.43853569030762
generate_one_block  35.854533195495605
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424136161804199  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.17608428001404
block generation total time  152.27208042144775
average batch blocks generation time:  76.13604021072388
block dataloader generation time/epoch 367.7751915557044
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39306390285491943 |1.234846830368042 |0.0047713518142700195 |0.00016617774963378906 |0.005100727081298828 |0.0018475055694580078 |
----------------------------------------------------------pseudo_mini_loss sum 0.3413170576095581
Total (block generation + training)time/epoch 371.6129160529091
Training time/epoch 3.6939661502838135
Training time without block to device /epoch 1.2242724895477295
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.71it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.07it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.54it/s] 40%|████      | 10/25 [00:00<00:01, 14.05it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.14it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.01it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.70it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.56it/s] 80%|████████  | 20/25 [00:01<00:00, 17.10it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.43it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.40it/s]100%|██████████| 25/25 [00:01<00:00, 16.81it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.72it/s]  8%|▊         | 2/25 [00:00<00:03,  6.74it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.78it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.81it/s] 20%|██        | 5/25 [00:00<00:02,  6.81it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.79it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.75it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.65it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.65it/s] 40%|████      | 10/25 [00:01<00:02,  6.67it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.64it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.67it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.65it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.65it/s] 60%|██████    | 15/25 [00:02<00:01,  6.54it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.59it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.57it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.62it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.61it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.58it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.61it/s]100%|██████████| 25/25 [00:03<00:00,  6.76it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  6.47it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.53it/s] 40%|████      | 10/25 [00:01<00:02,  6.54it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.46it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.49it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.50it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.49it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.52it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.51it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.62it/s]
Run 00 | Epoch 00210 | Loss 0.3413 | Train 0.6994 | Val 0.6897 | Test 0.5483
Number of nodes during this epoch:  4637955
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424286842346191  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1520557403564453
range selection method range initialization spend 0.024860858917236328
time for parepare:  0.3627948760986328
local_output_nid generation:  0.026337146759033203
local_in_edges_tensor generation:  0.2314012050628662
mini_batch_src_global generation:  0.3774988651275635
r_  generation:  5.487930059432983
local_output_nid generation:  0.028053998947143555
local_in_edges_tensor generation:  0.21380853652954102
mini_batch_src_global generation:  0.4657480716705322
r_  generation:  5.583948850631714
----------------------check_connections_block total spend ----------------------------- 14.454101324081421
generate_one_block  7.24857759475708
generate_one_block  7.126372337341309
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.982344627380371
gen group dst list time:  0.08930134773254395
time for parepare:  0.4333651065826416
local_output_nid generation:  0.2552499771118164
local_in_edges_tensor generation:  1.5322751998901367
mini_batch_src_global generation:  2.421081781387329
r_  generation:  28.914757013320923
local_output_nid generation:  0.5095713138580322
local_in_edges_tensor generation:  2.0327532291412354
mini_batch_src_global generation:  3.2887990474700928
r_  generation:  30.106303691864014
----------------------check_connections_block total spend ----------------------------- 81.27263045310974
generate_one_block  40.8076958656311
generate_one_block  40.99953365325928
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1672682762145996
gen group dst list time:  0.19104480743408203
time for parepare:  0.4569430351257324
local_output_nid generation:  0.4000375270843506
local_in_edges_tensor generation:  1.4790751934051514
mini_batch_src_global generation:  2.179196834564209
r_  generation:  26.536290884017944
local_output_nid generation:  0.7424094676971436
local_in_edges_tensor generation:  2.0157196521759033
mini_batch_src_global generation:  2.9337029457092285
r_  generation:  27.020359992980957
----------------------check_connections_block total spend ----------------------------- 74.43959641456604
generate_one_block  36.92952609062195
generate_one_block  37.443670988082886
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424286842346191  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.71222686767578
block generation total time  156.18042659759521
average batch blocks generation time:  78.09021329879761
block dataloader generation time/epoch 367.7866407231697
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3773101568222046 |1.4418797492980957 |0.004871368408203125 |0.00017654895782470703 |0.0052335262298583984 |0.0020265579223632812 |
----------------------------------------------------------pseudo_mini_loss sum 0.3424978256225586
Total (block generation + training)time/epoch 371.62551476266145
Training time/epoch 4.080097675323486
Training time without block to device /epoch 1.196338176727295
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.81it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.13it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.80it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.42it/s] 40%|████      | 10/25 [00:00<00:00, 16.69it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.97it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.07it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.08it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.33it/s] 80%|████████  | 20/25 [00:01<00:00, 17.23it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.13it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.15it/s]100%|██████████| 25/25 [00:01<00:00, 17.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.10it/s]  8%|▊         | 2/25 [00:00<00:04,  5.20it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.21it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.12it/s] 20%|██        | 5/25 [00:00<00:03,  5.56it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.84it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.10it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.28it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.85it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.03it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.15it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.28it/s] 60%|██████    | 15/25 [00:02<00:01,  5.92it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.07it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.26it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.86it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.03it/s] 80%|████████  | 20/25 [00:03<00:00,  5.74it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.60it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.49it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.74it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.98it/s]100%|██████████| 25/25 [00:04<00:00,  6.74it/s]100%|██████████| 25/25 [00:04<00:00,  5.98it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.76it/s]  8%|▊         | 2/25 [00:00<00:04,  5.61it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.79it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.00it/s] 20%|██        | 5/25 [00:00<00:03,  6.17it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.80it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.60it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.35it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.59it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.40it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.28it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.17it/s] 60%|██████    | 15/25 [00:02<00:01,  5.14it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.10it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.97it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.03it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.28it/s] 80%|████████  | 20/25 [00:03<00:00,  5.14it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.10it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.24it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.54it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.77it/s]100%|██████████| 25/25 [00:04<00:00,  6.58it/s]100%|██████████| 25/25 [00:04<00:00,  5.51it/s]
Run 00 | Epoch 00211 | Loss 0.3425 | Train 0.6988 | Val 0.6895 | Test 0.5474
Number of nodes during this epoch:  4637031
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424353122711182  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1264500617980957
range selection method range initialization spend 0.024908065795898438
time for parepare:  0.36308836936950684
local_output_nid generation:  0.02599358558654785
local_in_edges_tensor generation:  0.20880985260009766
mini_batch_src_global generation:  0.37313246726989746
r_  generation:  5.589030981063843
local_output_nid generation:  0.028903484344482422
local_in_edges_tensor generation:  0.23259353637695312
mini_batch_src_global generation:  0.46807861328125
r_  generation:  5.8921802043914795
----------------------check_connections_block total spend ----------------------------- 14.879306077957153
generate_one_block  7.171888113021851
generate_one_block  6.889756917953491
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.041504859924316
gen group dst list time:  0.09019756317138672
time for parepare:  0.4289274215698242
local_output_nid generation:  0.24902057647705078
local_in_edges_tensor generation:  1.5899596214294434
mini_batch_src_global generation:  2.414883613586426
r_  generation:  28.95906162261963
local_output_nid generation:  0.507387638092041
local_in_edges_tensor generation:  2.0724451541900635
mini_batch_src_global generation:  3.3612232208251953
r_  generation:  29.92022156715393
----------------------check_connections_block total spend ----------------------------- 81.09326577186584
generate_one_block  41.0423858165741
generate_one_block  41.05557370185852
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2387208938598633
gen group dst list time:  0.18993616104125977
time for parepare:  0.43488383293151855
local_output_nid generation:  0.4074997901916504
local_in_edges_tensor generation:  1.574976921081543
mini_batch_src_global generation:  2.175229072570801
r_  generation:  26.038029670715332
local_output_nid generation:  0.7452676296234131
local_in_edges_tensor generation:  1.9694669246673584
mini_batch_src_global generation:  2.9007184505462646
r_  generation:  26.110389709472656
----------------------check_connections_block total spend ----------------------------- 72.3053605556488
generate_one_block  35.240360260009766
generate_one_block  35.95992088317871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424353122711182  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.39862632751465
block generation total time  153.2982406616211
average batch blocks generation time:  76.64912033081055
block dataloader generation time/epoch 367.77470852743903
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3849231004714966 |1.3214010000228882 |0.004441499710083008 |0.0001462697982788086 |0.00501251220703125 |0.0016624927520751953 |
----------------------------------------------------------pseudo_mini_loss sum 0.34209439158439636
Total (block generation + training)time/epoch 371.61362887103604
Training time/epoch 3.848515748977661
Training time without block to device /epoch 1.2057137489318848
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.03it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.38it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.81it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.36it/s] 40%|████      | 10/25 [00:00<00:00, 17.61it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.77it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.89it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.63it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.72it/s] 80%|████████  | 20/25 [00:01<00:00, 17.82it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.82it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.66it/s]100%|██████████| 25/25 [00:01<00:00, 17.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  6.00it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.53it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.06it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.71it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.52it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.40it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.32it/s] 40%|████      | 10/25 [00:01<00:02,  5.03it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.69it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.79it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.02it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.35it/s] 60%|██████    | 15/25 [00:02<00:01,  5.64it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.86it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.05it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.17it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.27it/s] 80%|████████  | 20/25 [00:03<00:00,  6.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.18it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.73it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.90it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.03it/s]100%|██████████| 25/25 [00:04<00:00,  5.81it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.13it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.14it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.20it/s] 20%|██        | 5/25 [00:00<00:03,  6.23it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.95it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.95it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.89it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.97it/s] 40%|████      | 10/25 [00:01<00:02,  6.09it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.09it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.28it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.30it/s] 60%|██████    | 15/25 [00:02<00:01,  6.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.36it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.37it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.36it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.39it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.35it/s]100%|██████████| 25/25 [00:03<00:00,  7.08it/s]100%|██████████| 25/25 [00:03<00:00,  6.33it/s]
Run 00 | Epoch 00212 | Loss 0.3421 | Train 0.6997 | Val 0.6903 | Test 0.5472
Number of nodes during this epoch:  4637603
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428158283233643  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1476776599884033
range selection method range initialization spend 0.02608203887939453
time for parepare:  0.3622756004333496
local_output_nid generation:  0.02619647979736328
local_in_edges_tensor generation:  0.2025318145751953
mini_batch_src_global generation:  0.3749854564666748
r_  generation:  5.431515693664551
local_output_nid generation:  0.027568578720092773
local_in_edges_tensor generation:  0.2183990478515625
mini_batch_src_global generation:  0.46776914596557617
r_  generation:  5.670565605163574
----------------------check_connections_block total spend ----------------------------- 14.420927047729492
generate_one_block  7.215240001678467
generate_one_block  6.781768798828125
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.237962245941162
gen group dst list time:  0.08493900299072266
time for parepare:  0.4810519218444824
local_output_nid generation:  0.26576900482177734
local_in_edges_tensor generation:  1.6959640979766846
mini_batch_src_global generation:  2.439741849899292
r_  generation:  29.98433494567871
local_output_nid generation:  0.5326013565063477
local_in_edges_tensor generation:  2.094517469406128
mini_batch_src_global generation:  3.5095245838165283
r_  generation:  29.908529043197632
----------------------check_connections_block total spend ----------------------------- 82.99985885620117
generate_one_block  40.87696576118469
generate_one_block  40.99580121040344
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1456427574157715
gen group dst list time:  0.18821406364440918
time for parepare:  0.46089673042297363
local_output_nid generation:  0.39857959747314453
local_in_edges_tensor generation:  1.4590296745300293
mini_batch_src_global generation:  2.06095814704895
r_  generation:  25.33124327659607
local_output_nid generation:  0.7353296279907227
local_in_edges_tensor generation:  1.9301259517669678
mini_batch_src_global generation:  2.8072714805603027
r_  generation:  25.920093774795532
----------------------check_connections_block total spend ----------------------------- 71.34399604797363
generate_one_block  34.70429301261902
generate_one_block  36.55327296257019
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428158283233643  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.3438549041748
block generation total time  153.13033294677734
average batch blocks generation time:  76.56516647338867
block dataloader generation time/epoch 367.7661163672595
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3783996105194092 |1.3509612083435059 |0.004829883575439453 |0.00016605854034423828 |0.005165815353393555 |0.0019061565399169922 |
----------------------------------------------------------pseudo_mini_loss sum 0.3420342206954956
Total (block generation + training)time/epoch 371.6053029315572
Training time/epoch 3.8954477310180664
Training time without block to device /epoch 1.1935253143310547
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.02it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.49it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.73it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.29it/s] 40%|████      | 10/25 [00:00<00:00, 17.64it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.79it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.88it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.80it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.53it/s] 80%|████████  | 20/25 [00:01<00:00, 17.74it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.37it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.63it/s]100%|██████████| 25/25 [00:01<00:00, 17.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.23it/s]  8%|▊         | 2/25 [00:00<00:04,  5.19it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.97it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.41it/s] 20%|██        | 5/25 [00:00<00:03,  5.85it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.58it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.24it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.11it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.83it/s] 40%|████      | 10/25 [00:01<00:02,  5.06it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.36it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.18it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.55it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.88it/s] 60%|██████    | 15/25 [00:02<00:01,  5.64it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.78it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.87it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.96it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.69it/s] 80%|████████  | 20/25 [00:03<00:00,  5.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.31it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.23it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.21it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.14it/s]100%|██████████| 25/25 [00:04<00:00,  5.68it/s]100%|██████████| 25/25 [00:04<00:00,  5.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.10it/s]  8%|▊         | 2/25 [00:00<00:03,  6.33it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.51it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.86it/s] 20%|██        | 5/25 [00:00<00:03,  5.55it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.31it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.23it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.10it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.09it/s] 40%|████      | 10/25 [00:01<00:02,  5.05it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.96it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.88it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.27it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.64it/s] 60%|██████    | 15/25 [00:02<00:01,  5.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.87it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.12it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.73it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.97it/s] 80%|████████  | 20/25 [00:03<00:00,  6.16it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.47it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.02it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.16it/s]100%|██████████| 25/25 [00:04<00:00,  5.81it/s]
Run 00 | Epoch 00213 | Loss 0.3420 | Train 0.6990 | Val 0.6890 | Test 0.5469
Number of nodes during this epoch:  4637374
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425758361816406  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1178617477416992
range selection method range initialization spend 0.03094172477722168
time for parepare:  0.38194894790649414
local_output_nid generation:  0.026515722274780273
local_in_edges_tensor generation:  0.22657227516174316
mini_batch_src_global generation:  0.3921499252319336
r_  generation:  5.510308265686035
local_output_nid generation:  0.028664112091064453
local_in_edges_tensor generation:  0.22127532958984375
mini_batch_src_global generation:  0.49880433082580566
r_  generation:  5.853954076766968
----------------------check_connections_block total spend ----------------------------- 14.815553903579712
generate_one_block  7.283460855484009
generate_one_block  7.027904033660889
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.078005790710449
gen group dst list time:  0.09021282196044922
time for parepare:  0.4326941967010498
local_output_nid generation:  0.2557508945465088
local_in_edges_tensor generation:  1.6237754821777344
mini_batch_src_global generation:  2.6251461505889893
r_  generation:  29.936488389968872
local_output_nid generation:  0.5325367450714111
local_in_edges_tensor generation:  2.1912591457366943
mini_batch_src_global generation:  4.024064540863037
r_  generation:  30.922534704208374
----------------------check_connections_block total spend ----------------------------- 84.50704741477966
generate_one_block  41.570209980010986
generate_one_block  41.30604338645935
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.296212673187256
gen group dst list time:  0.19185256958007812
time for parepare:  0.43815135955810547
local_output_nid generation:  0.40897607803344727
local_in_edges_tensor generation:  1.6262140274047852
mini_batch_src_global generation:  2.081557512283325
r_  generation:  26.343433141708374
local_output_nid generation:  0.7295169830322266
local_in_edges_tensor generation:  1.9177687168121338
mini_batch_src_global generation:  2.802302360534668
r_  generation:  26.145259857177734
----------------------check_connections_block total spend ----------------------------- 72.53171038627625
generate_one_block  35.062987327575684
generate_one_block  35.86562967300415
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425758361816406  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.0387578010559
block generation total time  153.80487036705017
average batch blocks generation time:  76.90243518352509
block dataloader generation time/epoch 367.7770738390005
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37964415550231934 |1.2861348390579224 |0.00437319278717041 |0.0001513957977294922 |0.005111098289489746 |0.0018086433410644531 |
----------------------------------------------------------pseudo_mini_loss sum 0.3394708037376404
Total (block generation + training)time/epoch 371.6158900918248
Training time/epoch 3.759765148162842
Training time without block to device /epoch 1.187495470046997
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.30it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.46it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.20it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.65it/s] 40%|████      | 10/25 [00:00<00:00, 17.74it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.78it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.60it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.84it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.99it/s] 80%|████████  | 20/25 [00:01<00:00, 17.97it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.09it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.16it/s]100%|██████████| 25/25 [00:01<00:00, 17.91it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.14it/s]  8%|▊         | 2/25 [00:00<00:04,  5.10it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.08it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.11it/s] 20%|██        | 5/25 [00:00<00:03,  5.13it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.13it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.15it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.13it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.09it/s] 40%|████      | 10/25 [00:01<00:03,  4.88it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.20it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.19it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.97it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.15it/s] 60%|██████    | 15/25 [00:02<00:01,  5.43it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.72it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.98it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.71it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.52it/s] 80%|████████  | 20/25 [00:03<00:00,  5.38it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.15it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.15it/s] 92%|█████████▏| 23/25 [00:04<00:00,  4.90it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.87it/s]100%|██████████| 25/25 [00:04<00:00,  5.62it/s]100%|██████████| 25/25 [00:04<00:00,  5.27it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:04,  5.65it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.04it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.96it/s] 20%|██        | 5/25 [00:00<00:03,  5.24it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.57it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.24it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.76it/s] 40%|████      | 10/25 [00:01<00:02,  5.43it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.22it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.13it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.07it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.02it/s] 60%|██████    | 15/25 [00:02<00:01,  5.04it/s] 64%|██████▍   | 16/25 [00:03<00:01,  4.99it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.99it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.35it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.69it/s] 80%|████████  | 20/25 [00:03<00:00,  5.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.77it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.01it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.16it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.83it/s]100%|██████████| 25/25 [00:04<00:00,  5.53it/s]
Run 00 | Epoch 00214 | Loss 0.3395 | Train 0.6979 | Val 0.6891 | Test 0.5463
Number of nodes during this epoch:  4637387
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423573017120361  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1088039875030518
range selection method range initialization spend 0.0288088321685791
time for parepare:  0.3719806671142578
local_output_nid generation:  0.026912927627563477
local_in_edges_tensor generation:  0.20751166343688965
mini_batch_src_global generation:  0.37802982330322266
r_  generation:  5.669595718383789
local_output_nid generation:  0.029298067092895508
local_in_edges_tensor generation:  0.2348482608795166
mini_batch_src_global generation:  0.4732363224029541
r_  generation:  5.916852712631226
----------------------check_connections_block total spend ----------------------------- 15.034242153167725
generate_one_block  7.264465808868408
generate_one_block  6.908048391342163
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0248191356658936
gen group dst list time:  0.08942174911499023
time for parepare:  0.4646785259246826
local_output_nid generation:  0.2730138301849365
local_in_edges_tensor generation:  1.668138027191162
mini_batch_src_global generation:  2.502732276916504
r_  generation:  29.90368962287903
local_output_nid generation:  0.5437591075897217
local_in_edges_tensor generation:  2.039372205734253
mini_batch_src_global generation:  3.5074753761291504
r_  generation:  29.888974905014038
----------------------check_connections_block total spend ----------------------------- 82.79895639419556
generate_one_block  40.808013677597046
generate_one_block  40.98963141441345
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.133774995803833
gen group dst list time:  0.18995046615600586
time for parepare:  0.4601893424987793
local_output_nid generation:  0.3829970359802246
local_in_edges_tensor generation:  1.4565479755401611
mini_batch_src_global generation:  2.009826183319092
r_  generation:  25.63356375694275
local_output_nid generation:  0.737224817276001
local_in_edges_tensor generation:  1.961958885192871
mini_batch_src_global generation:  2.8186943531036377
r_  generation:  26.09578847885132
----------------------check_connections_block total spend ----------------------------- 71.54775977134705
generate_one_block  34.81859374046326
generate_one_block  35.71492671966553
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423573017120361  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.3467161655426
block generation total time  152.33116555213928
average batch blocks generation time:  76.16558277606964
block dataloader generation time/epoch 367.7691336598507
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3837946653366089 |1.378204107284546 |0.004390835762023926 |0.00015103816986083984 |0.005104422569274902 |0.0029468536376953125 |
----------------------------------------------------------pseudo_mini_loss sum 0.34101444482803345
Total (block generation + training)time/epoch 371.6084996578305
Training time/epoch 3.9568331241607666
Training time without block to device /epoch 1.2004249095916748
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.15it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.73it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.34it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.89it/s] 40%|████      | 10/25 [00:00<00:01, 13.72it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.93it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.46it/s] 72%|███████▏  | 18/25 [00:01<00:00, 15.92it/s] 80%|████████  | 20/25 [00:01<00:00, 16.58it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.10it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.46it/s]100%|██████████| 25/25 [00:01<00:00, 16.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.48it/s]  8%|▊         | 2/25 [00:00<00:03,  6.68it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.67it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.66it/s] 20%|██        | 5/25 [00:00<00:03,  6.66it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.67it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.66it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.68it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.26it/s] 40%|████      | 10/25 [00:01<00:02,  6.16it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.28it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.42it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.56it/s] 60%|██████    | 15/25 [00:02<00:01,  6.63it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.66it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.67it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.71it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.71it/s] 80%|████████  | 20/25 [00:03<00:00,  6.72it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.73it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.73it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.68it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.70it/s]100%|██████████| 25/25 [00:03<00:00,  6.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.07it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.54it/s] 20%|██        | 5/25 [00:00<00:03,  6.57it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.57it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.57it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.56it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.53it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.51it/s] 60%|██████    | 15/25 [00:02<00:01,  6.34it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.29it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.37it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.52it/s]100%|██████████| 25/25 [00:03<00:00,  6.58it/s]
Run 00 | Epoch 00215 | Loss 0.3410 | Train 0.6976 | Val 0.6892 | Test 0.5459
Number of nodes during this epoch:  4637449
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424452781677246  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1477160453796387
range selection method range initialization spend 0.025432586669921875
time for parepare:  0.3822062015533447
local_output_nid generation:  0.02664494514465332
local_in_edges_tensor generation:  0.21185636520385742
mini_batch_src_global generation:  0.3962531089782715
r_  generation:  5.531980991363525
local_output_nid generation:  0.02900528907775879
local_in_edges_tensor generation:  0.23400187492370605
mini_batch_src_global generation:  0.4601438045501709
r_  generation:  5.827936887741089
----------------------check_connections_block total spend ----------------------------- 14.851496696472168
generate_one_block  7.24985671043396
generate_one_block  7.0729076862335205
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.086957931518555
gen group dst list time:  0.09031033515930176
time for parepare:  0.4807140827178955
local_output_nid generation:  0.2748837471008301
local_in_edges_tensor generation:  1.6288189888000488
mini_batch_src_global generation:  2.532604694366455
r_  generation:  29.870200872421265
local_output_nid generation:  0.5382785797119141
local_in_edges_tensor generation:  2.1214511394500732
mini_batch_src_global generation:  3.7481470108032227
r_  generation:  30.032324075698853
----------------------check_connections_block total spend ----------------------------- 83.21592307090759
generate_one_block  41.14265179634094
generate_one_block  40.83912920951843
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3491499423980713
gen group dst list time:  0.18369412422180176
time for parepare:  0.4818897247314453
local_output_nid generation:  0.43610525131225586
local_in_edges_tensor generation:  1.5503053665161133
mini_batch_src_global generation:  2.008491039276123
r_  generation:  25.932173013687134
local_output_nid generation:  0.7287542819976807
local_in_edges_tensor generation:  1.9370372295379639
mini_batch_src_global generation:  2.827915906906128
r_  generation:  25.814680576324463
----------------------check_connections_block total spend ----------------------------- 71.71229791641235
generate_one_block  34.998011112213135
generate_one_block  35.74451041221619
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424452781677246  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.92822098731995
block generation total time  152.7243025302887
average batch blocks generation time:  76.36215126514435
block dataloader generation time/epoch 367.76791520471926
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37874841690063477 |1.3049442768096924 |0.0042841434478759766 |0.00015366077423095703 |0.005091190338134766 |0.0018467903137207031 |
----------------------------------------------------------pseudo_mini_loss sum 0.3399692177772522
Total (block generation + training)time/epoch 371.60707225733336
Training time/epoch 3.7940614223480225
Training time without block to device /epoch 1.1841728687286377
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.27it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.28it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.11it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.35it/s] 40%|████      | 10/25 [00:00<00:00, 17.41it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.60it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.86it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.00it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.14it/s] 80%|████████  | 20/25 [00:01<00:00, 18.19it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.23it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.23it/s]100%|██████████| 25/25 [00:01<00:00, 18.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.40it/s]  8%|▊         | 2/25 [00:00<00:03,  6.54it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.44it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.57it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.06it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.76it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.70it/s] 40%|████      | 10/25 [00:01<00:02,  5.65it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.69it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.25it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.43it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.60it/s] 60%|██████    | 15/25 [00:02<00:01,  5.86it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.02it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.20it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.14it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.29it/s] 80%|████████  | 20/25 [00:03<00:00,  6.13it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.29it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.37it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.30it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.41it/s]100%|██████████| 25/25 [00:04<00:00,  6.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.37it/s]  8%|▊         | 2/25 [00:00<00:03,  5.80it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.59it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.75it/s] 20%|██        | 5/25 [00:00<00:03,  5.96it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.14it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.29it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.40it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.44it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.57it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.57it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.60it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.48it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.53it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.55it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.59it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]
Run 00 | Epoch 00216 | Loss 0.3400 | Train 0.6974 | Val 0.6878 | Test 0.5458
Number of nodes during this epoch:  4637809
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42394495010376  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1686344146728516
range selection method range initialization spend 0.026187658309936523
time for parepare:  0.3685147762298584
local_output_nid generation:  0.025932788848876953
local_in_edges_tensor generation:  0.23169374465942383
mini_batch_src_global generation:  0.37021422386169434
r_  generation:  5.4565489292144775
local_output_nid generation:  0.027400970458984375
local_in_edges_tensor generation:  0.22768235206604004
mini_batch_src_global generation:  0.49352526664733887
r_  generation:  5.819140195846558
----------------------check_connections_block total spend ----------------------------- 14.729082345962524
generate_one_block  7.29059100151062
generate_one_block  7.019174098968506
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.043600559234619
gen group dst list time:  0.09293031692504883
time for parepare:  0.4573700428009033
local_output_nid generation:  0.2777523994445801
local_in_edges_tensor generation:  1.737119197845459
mini_batch_src_global generation:  2.5202085971832275
r_  generation:  30.11974573135376
local_output_nid generation:  0.5407853126525879
local_in_edges_tensor generation:  2.1766364574432373
mini_batch_src_global generation:  3.7717790603637695
r_  generation:  30.006287097930908
----------------------check_connections_block total spend ----------------------------- 83.52703499794006
generate_one_block  41.240938901901245
generate_one_block  40.935943365097046
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.346452236175537
gen group dst list time:  0.18263816833496094
time for parepare:  0.45995593070983887
local_output_nid generation:  0.39398694038391113
local_in_edges_tensor generation:  1.5073435306549072
mini_batch_src_global generation:  2.0550694465637207
r_  generation:  25.89488124847412
local_output_nid generation:  0.7200899124145508
local_in_edges_tensor generation:  1.9395225048065186
mini_batch_src_global generation:  2.8149912357330322
r_  generation:  25.998127937316895
----------------------check_connections_block total spend ----------------------------- 72.15694952011108
generate_one_block  35.240527629852295
generate_one_block  36.022822856903076
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42394495010376  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.68398451805115
block generation total time  153.44023275375366
average batch blocks generation time:  76.72011637687683
block dataloader generation time/epoch 367.7716407501203
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3864603042602539 |1.3213356733322144 |0.004353523254394531 |0.00014591217041015625 |0.005209088325500488 |0.002940654754638672 |
----------------------------------------------------------pseudo_mini_loss sum 0.3397471308708191
Total (block generation + training)time/epoch 371.6108075946157
Training time/epoch 3.841109037399292
Training time without block to device /epoch 1.1984376907348633
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.50it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.21it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.53it/s] 40%|████      | 10/25 [00:00<00:00, 17.81it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.72it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.59it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.82it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.91it/s] 80%|████████  | 20/25 [00:01<00:00, 18.00it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.03it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.11it/s]100%|██████████| 25/25 [00:01<00:00, 17.98it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.36it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.46it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.93it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.08it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.22it/s] 60%|██████    | 15/25 [00:02<00:01,  6.02it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.99it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.83it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.85it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.96it/s] 80%|████████  | 20/25 [00:03<00:00,  5.95it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.02it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.09it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.17it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.24it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.33it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.27it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.77it/s] 20%|██        | 5/25 [00:00<00:03,  5.62it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.75it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.90it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.05it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.14it/s] 40%|████      | 10/25 [00:01<00:02,  6.20it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.22it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.24it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.23it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.23it/s] 60%|██████    | 15/25 [00:02<00:01,  6.28it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.28it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.29it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.31it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.36it/s] 80%|████████  | 20/25 [00:03<00:00,  6.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  6.31it/s]
Run 00 | Epoch 00217 | Loss 0.3397 | Train 0.6969 | Val 0.6872 | Test 0.5460
Number of nodes during this epoch:  4637395
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426206111907959  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1238932609558105
range selection method range initialization spend 0.025008678436279297
time for parepare:  0.3852860927581787
local_output_nid generation:  0.026250123977661133
local_in_edges_tensor generation:  0.23190975189208984
mini_batch_src_global generation:  0.3942859172821045
r_  generation:  5.399920463562012
local_output_nid generation:  0.027578115463256836
local_in_edges_tensor generation:  0.21391773223876953
mini_batch_src_global generation:  0.4780309200286865
r_  generation:  5.6976752281188965
----------------------check_connections_block total spend ----------------------------- 14.567680835723877
generate_one_block  7.210897207260132
generate_one_block  6.831434726715088
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.213710308074951
gen group dst list time:  0.08353519439697266
time for parepare:  0.44325852394104004
local_output_nid generation:  0.2676055431365967
local_in_edges_tensor generation:  1.7536077499389648
mini_batch_src_global generation:  2.474696636199951
r_  generation:  29.859405279159546
local_output_nid generation:  0.5264968872070312
local_in_edges_tensor generation:  2.167508125305176
mini_batch_src_global generation:  3.5179755687713623
r_  generation:  30.384276151657104
----------------------check_connections_block total spend ----------------------------- 83.48314881324768
generate_one_block  41.18146562576294
generate_one_block  41.15334916114807
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.345222234725952
gen group dst list time:  0.2106189727783203
time for parepare:  0.5102763175964355
local_output_nid generation:  0.41301918029785156
local_in_edges_tensor generation:  1.5312669277191162
mini_batch_src_global generation:  2.0172531604766846
r_  generation:  25.91529107093811
local_output_nid generation:  0.7195849418640137
local_in_edges_tensor generation:  2.06783390045166
mini_batch_src_global generation:  2.819370746612549
r_  generation:  25.771125555038452
----------------------check_connections_block total spend ----------------------------- 71.74388074874878
generate_one_block  35.02901363372803
generate_one_block  35.77707076072693
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426206111907959  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.22702956199646
block generation total time  153.14089918136597
average batch blocks generation time:  76.57044959068298
block dataloader generation time/epoch 367.76759794764564
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.367000937461853 |1.2738455533981323 |0.0043146610260009766 |0.00015103816986083984 |0.005098819732666016 |0.0016562938690185547 |
----------------------------------------------------------pseudo_mini_loss sum 0.3395041823387146
Total (block generation + training)time/epoch 371.6062052206162
Training time/epoch 3.717007637023926
Training time without block to device /epoch 1.1693165302276611
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.37it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.95it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.13it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.79it/s] 40%|████      | 10/25 [00:00<00:00, 16.62it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.97it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.32it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.47it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.66it/s] 80%|████████  | 20/25 [00:01<00:00, 17.76it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.71it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.64it/s]100%|██████████| 25/25 [00:01<00:00, 17.39it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.15it/s]  8%|▊         | 2/25 [00:00<00:03,  6.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.84it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.56it/s] 20%|██        | 5/25 [00:00<00:03,  5.03it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.39it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.76it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.99it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.78it/s] 40%|████      | 10/25 [00:01<00:02,  5.64it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.70it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.44it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.62it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.88it/s] 60%|██████    | 15/25 [00:02<00:01,  5.70it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.50it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.40it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.28it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.20it/s] 80%|████████  | 20/25 [00:03<00:00,  5.10it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.12it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.00it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.05it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.28it/s]100%|██████████| 25/25 [00:04<00:00,  5.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.85it/s]  8%|▊         | 2/25 [00:00<00:04,  4.79it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.46it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.83it/s] 20%|██        | 5/25 [00:00<00:03,  5.28it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.60it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.88it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.95it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.69it/s] 40%|████      | 10/25 [00:01<00:02,  5.45it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.34it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.28it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.22it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.36it/s] 60%|██████    | 15/25 [00:02<00:01,  5.58it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.80it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.99it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.16it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.30it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.49it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.44it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.42it/s]100%|██████████| 25/25 [00:04<00:00,  5.86it/s]
Run 00 | Epoch 00218 | Loss 0.3395 | Train 0.6968 | Val 0.6872 | Test 0.5469
Number of nodes during this epoch:  4637954
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4279890060424805  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.149562120437622
range selection method range initialization spend 0.025089263916015625
time for parepare:  0.38535547256469727
local_output_nid generation:  0.02738213539123535
local_in_edges_tensor generation:  0.21463799476623535
mini_batch_src_global generation:  0.37119507789611816
r_  generation:  5.428286552429199
local_output_nid generation:  0.029179811477661133
local_in_edges_tensor generation:  0.22591662406921387
mini_batch_src_global generation:  0.4872133731842041
r_  generation:  5.773438215255737
----------------------check_connections_block total spend ----------------------------- 14.612365245819092
generate_one_block  7.248447418212891
generate_one_block  6.996627330780029
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.219833135604858
gen group dst list time:  0.09682607650756836
time for parepare:  0.49155426025390625
local_output_nid generation:  0.2713780403137207
local_in_edges_tensor generation:  1.7055673599243164
mini_batch_src_global generation:  2.4442782402038574
r_  generation:  29.56560969352722
local_output_nid generation:  0.5184712409973145
local_in_edges_tensor generation:  2.0572023391723633
mini_batch_src_global generation:  3.498591661453247
r_  generation:  29.991154193878174
----------------------check_connections_block total spend ----------------------------- 82.29617404937744
generate_one_block  40.813608169555664
generate_one_block  40.814894676208496
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1523427963256836
gen group dst list time:  0.1835160255432129
time for parepare:  0.4638843536376953
local_output_nid generation:  0.3780980110168457
local_in_edges_tensor generation:  1.471663475036621
mini_batch_src_global generation:  2.021735906600952
r_  generation:  25.676692724227905
local_output_nid generation:  0.7382407188415527
local_in_edges_tensor generation:  1.9387152194976807
mini_batch_src_global generation:  2.9800336360931396
r_  generation:  25.82900309562683
----------------------check_connections_block total spend ----------------------------- 71.61832761764526
generate_one_block  35.17566204071045
generate_one_block  35.43110108375549
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4279890060424805  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.9145016670227
block generation total time  152.2352659702301
average batch blocks generation time:  76.11763298511505
block dataloader generation time/epoch 367.7585668988424
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3858221769332886 |1.3525137901306152 |0.004360675811767578 |0.00014925003051757812 |0.005102634429931641 |0.0013926029205322266 |
----------------------------------------------------------pseudo_mini_loss sum 0.3382629156112671
Total (block generation + training)time/epoch 371.5975164463531
Training time/epoch 3.9133949279785156
Training time without block to device /epoch 1.2083673477172852
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.78it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.51it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.70it/s] 40%|████      | 10/25 [00:00<00:00, 17.93it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.52it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.05it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.13it/s] 80%|████████  | 20/25 [00:01<00:00, 17.35it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.64it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.92it/s]100%|██████████| 25/25 [00:01<00:00, 17.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.81it/s]  8%|▊         | 2/25 [00:00<00:03,  6.92it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.89it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.93it/s] 20%|██        | 5/25 [00:00<00:02,  6.95it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.94it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.25it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.57it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.62it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.69it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.67it/s] 60%|██████    | 15/25 [00:02<00:01,  6.65it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.66it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.45it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.54it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.57it/s] 80%|████████  | 20/25 [00:03<00:00,  6.58it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.61it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.62it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.66it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.71it/s]100%|██████████| 25/25 [00:03<00:00,  7.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.73it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.83it/s]  8%|▊         | 2/25 [00:00<00:04,  5.68it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.13it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.69it/s] 20%|██        | 5/25 [00:00<00:03,  5.42it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.29it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.21it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.15it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.10it/s] 40%|████      | 10/25 [00:01<00:03,  4.94it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.25it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.42it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.20it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.40it/s] 60%|██████    | 15/25 [00:02<00:01,  5.26it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.16it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.44it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.76it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.99it/s] 80%|████████  | 20/25 [00:03<00:00,  6.17it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.14it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.91it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.05it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.21it/s]100%|██████████| 25/25 [00:04<00:00,  5.69it/s]
Run 00 | Epoch 00219 | Loss 0.3383 | Train 0.6969 | Val 0.6872 | Test 0.5469
Number of nodes during this epoch:  4637199
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426473140716553  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1095011234283447
range selection method range initialization spend 0.024719953536987305
time for parepare:  0.3849666118621826
local_output_nid generation:  0.037299156188964844
local_in_edges_tensor generation:  0.20800304412841797
mini_batch_src_global generation:  0.3850877285003662
r_  generation:  5.48689603805542
local_output_nid generation:  0.02903890609741211
local_in_edges_tensor generation:  0.21905159950256348
mini_batch_src_global generation:  0.4800388813018799
r_  generation:  5.857820749282837
----------------------check_connections_block total spend ----------------------------- 14.749449253082275
generate_one_block  7.282897472381592
generate_one_block  7.105124235153198
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.011217832565308
gen group dst list time:  0.09830069541931152
time for parepare:  0.48648810386657715
local_output_nid generation:  0.268451452255249
local_in_edges_tensor generation:  1.719698429107666
mini_batch_src_global generation:  2.5024020671844482
r_  generation:  29.761220693588257
local_output_nid generation:  0.5116934776306152
local_in_edges_tensor generation:  2.0366902351379395
mini_batch_src_global generation:  3.7315573692321777
r_  generation:  29.68514609336853
----------------------check_connections_block total spend ----------------------------- 82.51408386230469
generate_one_block  40.82783079147339
generate_one_block  40.74418520927429
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.247177839279175
gen group dst list time:  0.1810774803161621
time for parepare:  0.43107056617736816
local_output_nid generation:  0.405672550201416
local_in_edges_tensor generation:  1.500176191329956
mini_batch_src_global generation:  2.162520408630371
r_  generation:  26.652852535247803
local_output_nid generation:  0.7332422733306885
local_in_edges_tensor generation:  1.9384799003601074
mini_batch_src_global generation:  2.8241233825683594
r_  generation:  26.246723651885986
----------------------check_connections_block total spend ----------------------------- 73.48229908943176
generate_one_block  35.39741110801697
generate_one_block  36.11778426170349
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426473140716553  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.99638295173645
block generation total time  153.08721137046814
average batch blocks generation time:  76.54360568523407
block dataloader generation time/epoch 367.7581603462046
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3799213171005249 |1.3066182136535645 |0.004456639289855957 |0.0001513957977294922 |0.00513768196105957 |0.003139495849609375 |
----------------------------------------------------------pseudo_mini_loss sum 0.33871349692344666
Total (block generation + training)time/epoch 371.5969570214098
Training time/epoch 3.8051435947418213
Training time without block to device /epoch 1.1919071674346924
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.90it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.60it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.36it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.10it/s] 40%|████      | 10/25 [00:00<00:01, 13.80it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.03it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.87it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.46it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.99it/s] 80%|████████  | 20/25 [00:01<00:00, 17.30it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.56it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.67it/s]100%|██████████| 25/25 [00:01<00:00, 16.78it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.21it/s]  8%|▊         | 2/25 [00:00<00:04,  5.20it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.18it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.18it/s] 20%|██        | 5/25 [00:00<00:04,  4.98it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.25it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.78it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.92it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.20it/s] 40%|████      | 10/25 [00:01<00:02,  5.47it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.71it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.92it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.12it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.23it/s] 60%|██████    | 15/25 [00:02<00:01,  6.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.97it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.88it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.04it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.14it/s] 80%|████████  | 20/25 [00:03<00:00,  6.21it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.33it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.32it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.46it/s]100%|██████████| 25/25 [00:04<00:00,  5.90it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.29it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.31it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.31it/s] 40%|████      | 10/25 [00:01<00:02,  6.21it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.24it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.31it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.48it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.49it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.51it/s]
Run 00 | Epoch 00220 | Loss 0.3387 | Train 0.6964 | Val 0.6870 | Test 0.5463
Number of nodes during this epoch:  4637363
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426053047180176  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1377131938934326
range selection method range initialization spend 0.025022268295288086
time for parepare:  0.360598087310791
local_output_nid generation:  0.026488780975341797
local_in_edges_tensor generation:  0.20201730728149414
mini_batch_src_global generation:  0.37325358390808105
r_  generation:  5.37301778793335
local_output_nid generation:  0.027546405792236328
local_in_edges_tensor generation:  0.21387290954589844
mini_batch_src_global generation:  0.46396565437316895
r_  generation:  5.650865316390991
----------------------check_connections_block total spend ----------------------------- 14.358296155929565
generate_one_block  7.216288089752197
generate_one_block  6.727581977844238
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.185952186584473
gen group dst list time:  0.08985662460327148
time for parepare:  0.4703218936920166
local_output_nid generation:  0.2660837173461914
local_in_edges_tensor generation:  1.6840665340423584
mini_batch_src_global generation:  2.5009043216705322
r_  generation:  30.49134111404419
local_output_nid generation:  0.5270164012908936
local_in_edges_tensor generation:  2.0604212284088135
mini_batch_src_global generation:  3.7492449283599854
r_  generation:  30.121108055114746
----------------------check_connections_block total spend ----------------------------- 84.47177076339722
generate_one_block  41.08538293838501
generate_one_block  41.09048318862915
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.298598051071167
gen group dst list time:  0.18076515197753906
time for parepare:  0.4327993392944336
local_output_nid generation:  0.41533803939819336
local_in_edges_tensor generation:  1.4695243835449219
mini_batch_src_global generation:  2.196129322052002
r_  generation:  26.495745182037354
local_output_nid generation:  0.737769365310669
local_in_edges_tensor generation:  1.945443868637085
mini_batch_src_global generation:  2.8271474838256836
r_  generation:  26.385777711868286
----------------------check_connections_block total spend ----------------------------- 73.33823919296265
generate_one_block  35.4553325176239
generate_one_block  36.12559652328491
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426053047180176  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.81000995635986
block generation total time  153.75679516792297
average batch blocks generation time:  76.87839758396149
block dataloader generation time/epoch 367.7674412630262
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3881324529647827 |1.30635666847229 |0.0044699907302856445 |0.0001512765884399414 |0.005046486854553223 |0.003015279769897461 |
----------------------------------------------------------pseudo_mini_loss sum 0.3380658030509949
Total (block generation + training)time/epoch 371.60616098270157
Training time/epoch 3.8216164112091064
Training time without block to device /epoch 1.2089030742645264
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.94it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.51it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.25it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.68it/s] 40%|████      | 10/25 [00:00<00:00, 17.62it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.83it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.98it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.73it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.80it/s] 80%|████████  | 20/25 [00:01<00:00, 17.89it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.94it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.92it/s]100%|██████████| 25/25 [00:01<00:00, 17.93it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.61it/s]  8%|▊         | 2/25 [00:00<00:03,  6.62it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.57it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.61it/s] 20%|██        | 5/25 [00:00<00:03,  6.55it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.32it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.34it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.22it/s] 40%|████      | 10/25 [00:01<00:02,  6.20it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.07it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.03it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.09it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.20it/s] 60%|██████    | 15/25 [00:02<00:01,  6.25it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.37it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.56it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.06it/s] 80%|████████  | 20/25 [00:03<00:00,  5.72it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.35it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.10it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.13it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.11it/s]100%|██████████| 25/25 [00:04<00:00,  5.96it/s]100%|██████████| 25/25 [00:04<00:00,  6.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.07it/s]  8%|▊         | 2/25 [00:00<00:04,  5.03it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.61it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.58it/s] 20%|██        | 5/25 [00:01<00:03,  5.00it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.42it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.35it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.62it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.42it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.14it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.07it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.07it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.05it/s] 60%|██████    | 15/25 [00:02<00:02,  4.97it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.00it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.93it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.97it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.00it/s] 80%|████████  | 20/25 [00:03<00:00,  5.01it/s] 84%|████████▍ | 21/25 [00:04<00:00,  4.97it/s] 88%|████████▊ | 22/25 [00:04<00:00,  4.91it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.34it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.68it/s]100%|██████████| 25/25 [00:04<00:00,  6.23it/s]100%|██████████| 25/25 [00:04<00:00,  5.23it/s]
Run 00 | Epoch 00221 | Loss 0.3381 | Train 0.6948 | Val 0.6850 | Test 0.5456
Number of nodes during this epoch:  4637922
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427734851837158  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1003267765045166
range selection method range initialization spend 0.03720903396606445
time for parepare:  0.36836838722229004
local_output_nid generation:  0.025677204132080078
local_in_edges_tensor generation:  0.23753118515014648
mini_batch_src_global generation:  0.37501025199890137
r_  generation:  5.691476583480835
local_output_nid generation:  0.029104232788085938
local_in_edges_tensor generation:  0.23597931861877441
mini_batch_src_global generation:  0.47599005699157715
r_  generation:  5.959796190261841
----------------------check_connections_block total spend ----------------------------- 15.118401527404785
generate_one_block  7.229933023452759
generate_one_block  6.917839765548706
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.052493095397949
gen group dst list time:  0.09468555450439453
time for parepare:  0.4859201908111572
local_output_nid generation:  0.2862842082977295
local_in_edges_tensor generation:  1.7074928283691406
mini_batch_src_global generation:  2.5124943256378174
r_  generation:  29.91554880142212
local_output_nid generation:  0.5444362163543701
local_in_edges_tensor generation:  2.275733232498169
mini_batch_src_global generation:  3.7365312576293945
r_  generation:  29.917757749557495
----------------------check_connections_block total spend ----------------------------- 83.4315619468689
generate_one_block  40.87539291381836
generate_one_block  41.148698568344116
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.274512529373169
gen group dst list time:  0.18117308616638184
time for parepare:  0.483720064163208
local_output_nid generation:  0.39304113388061523
local_in_edges_tensor generation:  1.5660102367401123
mini_batch_src_global generation:  2.021230936050415
r_  generation:  26.522140979766846
local_output_nid generation:  0.7347919940948486
local_in_edges_tensor generation:  1.9368562698364258
mini_batch_src_global generation:  2.862746477127075
r_  generation:  26.32709503173828
----------------------check_connections_block total spend ----------------------------- 72.86442494392395
generate_one_block  35.388577461242676
generate_one_block  36.05570101737976
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427734851837158  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.29598689079285
block generation total time  153.4683699607849
average batch blocks generation time:  76.73418498039246
block dataloader generation time/epoch 367.77555877775757
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39430558681488037 |1.2405977249145508 |0.004497408866882324 |0.0001512765884399414 |0.005132317543029785 |0.0016510486602783203 |
----------------------------------------------------------pseudo_mini_loss sum 0.3386225998401642
Total (block generation + training)time/epoch 371.613659748086
Training time/epoch 3.701167583465576
Training time without block to device /epoch 1.2199721336364746
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.51it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.27it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.70it/s] 40%|████      | 10/25 [00:00<00:00, 17.94it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.11it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.20it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.22it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.30it/s] 80%|████████  | 20/25 [00:01<00:00, 18.34it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.33it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.34it/s]100%|██████████| 25/25 [00:01<00:00, 18.25it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.52it/s]  8%|▊         | 2/25 [00:00<00:03,  6.57it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.61it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.61it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.59it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.61it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.61it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.57it/s] 80%|████████  | 20/25 [00:03<00:00,  6.59it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  6.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.31it/s]  8%|▊         | 2/25 [00:00<00:03,  6.24it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.22it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.29it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.25it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.32it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.49it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.52it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
Run 00 | Epoch 00222 | Loss 0.3386 | Train 0.6940 | Val 0.6834 | Test 0.5457
Number of nodes during this epoch:  4637930
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430571556091309  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1193926334381104
range selection method range initialization spend 0.02655649185180664
time for parepare:  0.3727834224700928
local_output_nid generation:  0.026680946350097656
local_in_edges_tensor generation:  0.23415517807006836
mini_batch_src_global generation:  0.38178110122680664
r_  generation:  5.657028436660767
local_output_nid generation:  0.029180049896240234
local_in_edges_tensor generation:  0.23312711715698242
mini_batch_src_global generation:  0.4724452495574951
r_  generation:  5.832698106765747
----------------------check_connections_block total spend ----------------------------- 14.950922012329102
generate_one_block  7.20944356918335
generate_one_block  6.926291227340698
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.046361207962036
gen group dst list time:  0.09261441230773926
time for parepare:  0.4399073123931885
local_output_nid generation:  0.2676253318786621
local_in_edges_tensor generation:  1.682361125946045
mini_batch_src_global generation:  2.6332919597625732
r_  generation:  30.093716144561768
local_output_nid generation:  0.52764892578125
local_in_edges_tensor generation:  2.097399950027466
mini_batch_src_global generation:  3.787227153778076
r_  generation:  29.909891366958618
----------------------check_connections_block total spend ----------------------------- 83.32107591629028
generate_one_block  41.0700466632843
generate_one_block  40.65161418914795
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.354377269744873
gen group dst list time:  0.18119215965270996
time for parepare:  0.460496187210083
local_output_nid generation:  0.3936493396759033
local_in_edges_tensor generation:  1.5376827716827393
mini_batch_src_global generation:  2.0411367416381836
r_  generation:  25.600247859954834
local_output_nid generation:  0.7344062328338623
local_in_edges_tensor generation:  1.9693183898925781
mini_batch_src_global generation:  2.9579243659973145
r_  generation:  26.88490605354309
----------------------check_connections_block total spend ----------------------------- 73.36171364784241
generate_one_block  35.38736581802368
generate_one_block  36.07066082954407
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430571556091309  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.6827895641327
block generation total time  153.1796875
average batch blocks generation time:  76.58984375
block dataloader generation time/epoch 367.7814779131936
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39570367336273193 |1.342333197593689 |0.0051680803298950195 |0.00019049644470214844 |0.005166411399841309 |0.002301454544067383 |
----------------------------------------------------------pseudo_mini_loss sum 0.3386487364768982
Total (block generation + training)time/epoch 371.61991230147834
Training time/epoch 3.912276268005371
Training time without block to device /epoch 1.2276098728179932
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.20it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.80it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.26it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.85it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.01it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.14it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.22it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.28it/s] 80%|████████  | 20/25 [00:01<00:00, 18.26it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.28it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.28it/s]100%|██████████| 25/25 [00:01<00:00, 18.21it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.37it/s]  8%|▊         | 2/25 [00:00<00:03,  6.40it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.42it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.40it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.39it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.39it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:03<00:00,  6.49it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.05it/s]  8%|▊         | 2/25 [00:00<00:03,  6.22it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.30it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.30it/s] 20%|██        | 5/25 [00:00<00:03,  6.33it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.34it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.38it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.37it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.35it/s] 60%|██████    | 15/25 [00:02<00:01,  6.36it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.32it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.33it/s] 80%|████████  | 20/25 [00:03<00:00,  6.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.34it/s]100%|██████████| 25/25 [00:03<00:00,  7.07it/s]100%|██████████| 25/25 [00:03<00:00,  6.43it/s]
Run 00 | Epoch 00223 | Loss 0.3386 | Train 0.6943 | Val 0.6839 | Test 0.5462
Number of nodes during this epoch:  4637514
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429132461547852  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.003157138824463
range selection method range initialization spend 0.024994850158691406
time for parepare:  0.36144471168518066
local_output_nid generation:  0.02601027488708496
local_in_edges_tensor generation:  0.2203357219696045
mini_batch_src_global generation:  0.3733689785003662
r_  generation:  5.626713275909424
local_output_nid generation:  0.027512073516845703
local_in_edges_tensor generation:  0.21347618103027344
mini_batch_src_global generation:  0.45886993408203125
r_  generation:  5.7514872550964355
----------------------check_connections_block total spend ----------------------------- 14.709923267364502
generate_one_block  6.82629132270813
generate_one_block  6.948421955108643
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.097006797790527
gen group dst list time:  0.08406424522399902
time for parepare:  0.42469263076782227
local_output_nid generation:  0.24504995346069336
local_in_edges_tensor generation:  1.6176910400390625
mini_batch_src_global generation:  2.425978183746338
r_  generation:  29.612521409988403
local_output_nid generation:  0.5182745456695557
local_in_edges_tensor generation:  2.1288552284240723
mini_batch_src_global generation:  3.6515891551971436
r_  generation:  30.726580142974854
----------------------check_connections_block total spend ----------------------------- 82.9031732082367
generate_one_block  41.40451979637146
generate_one_block  41.25323176383972
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.287113666534424
gen group dst list time:  0.18201923370361328
time for parepare:  0.43863630294799805
local_output_nid generation:  0.40722060203552246
local_in_edges_tensor generation:  1.5443041324615479
mini_batch_src_global generation:  2.124105215072632
r_  generation:  26.970404624938965
local_output_nid generation:  0.7292325496673584
local_in_edges_tensor generation:  1.9737107753753662
mini_batch_src_global generation:  2.821141481399536
r_  generation:  26.22370982170105
----------------------check_connections_block total spend ----------------------------- 73.5470278263092
generate_one_block  35.09582757949829
generate_one_block  35.97950005531311
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429132461547852  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.4502010345459
block generation total time  153.73307919502258
average batch blocks generation time:  76.86653959751129
block dataloader generation time/epoch 367.7831415885261
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3766613006591797 |1.3287429809570312 |0.00501251220703125 |0.00017952919006347656 |0.005062460899353027 |0.0038750171661376953 |
----------------------------------------------------------pseudo_mini_loss sum 0.33785131573677063
Total (block generation + training)time/epoch 371.621613258762
Training time/epoch 3.846574068069458
Training time without block to device /epoch 1.1890881061553955
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.69it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.33it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.33it/s] 40%|████      | 10/25 [00:00<00:00, 17.35it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.68it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.80it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.99it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.80it/s] 80%|████████  | 20/25 [00:01<00:00, 17.96it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.09it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.47it/s]100%|██████████| 25/25 [00:01<00:00, 17.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.76it/s]  8%|▊         | 2/25 [00:00<00:03,  6.72it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.80it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.50it/s] 20%|██        | 5/25 [00:00<00:03,  6.47it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.00it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.91it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.03it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.22it/s] 40%|████      | 10/25 [00:01<00:02,  6.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.53it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.59it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.68it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.74it/s] 60%|██████    | 15/25 [00:02<00:01,  6.77it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.83it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.82it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.85it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.78it/s] 80%|████████  | 20/25 [00:03<00:00,  6.79it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.62it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.77it/s]100%|██████████| 25/25 [00:03<00:00,  6.21it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.88it/s]  8%|▊         | 2/25 [00:00<00:03,  5.96it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.23it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.30it/s] 20%|██        | 5/25 [00:00<00:03,  6.40it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.52it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.46it/s] 40%|████      | 10/25 [00:01<00:02,  6.43it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.56it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.63it/s] 60%|██████    | 15/25 [00:02<00:01,  6.65it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.61it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.55it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.10it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.25it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.48it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.57it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.10it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]100%|██████████| 25/25 [00:03<00:00,  6.44it/s]
Run 00 | Epoch 00224 | Loss 0.3379 | Train 0.6941 | Val 0.6841 | Test 0.5461
Number of nodes during this epoch:  4637429
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425727844238281  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1617493629455566
range selection method range initialization spend 0.02547621726989746
time for parepare:  0.3836252689361572
local_output_nid generation:  0.026642322540283203
local_in_edges_tensor generation:  0.23013973236083984
mini_batch_src_global generation:  0.38008832931518555
r_  generation:  5.469012975692749
local_output_nid generation:  0.02889537811279297
local_in_edges_tensor generation:  0.21155571937561035
mini_batch_src_global generation:  0.4553079605102539
r_  generation:  5.87612247467041
----------------------check_connections_block total spend ----------------------------- 14.760079860687256
generate_one_block  7.243235349655151
generate_one_block  6.906591176986694
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0364251136779785
gen group dst list time:  0.08333015441894531
time for parepare:  0.464475154876709
local_output_nid generation:  0.26799798011779785
local_in_edges_tensor generation:  1.6274080276489258
mini_batch_src_global generation:  2.5993545055389404
r_  generation:  29.651877880096436
local_output_nid generation:  0.5225999355316162
local_in_edges_tensor generation:  2.0833916664123535
mini_batch_src_global generation:  3.715428590774536
r_  generation:  29.546667337417603
----------------------check_connections_block total spend ----------------------------- 82.34147071838379
generate_one_block  40.74598240852356
generate_one_block  40.36208724975586
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.241544723510742
gen group dst list time:  0.1802825927734375
time for parepare:  0.4508955478668213
local_output_nid generation:  0.3811774253845215
local_in_edges_tensor generation:  1.447460412979126
mini_batch_src_global generation:  2.0282251834869385
r_  generation:  25.40082812309265
local_output_nid generation:  0.732764482498169
local_in_edges_tensor generation:  1.9099090099334717
mini_batch_src_global generation:  3.186095714569092
r_  generation:  26.587281942367554
----------------------check_connections_block total spend ----------------------------- 72.16573977470398
generate_one_block  35.38123869895935
generate_one_block  36.042978286743164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425727844238281  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.50721049308777
block generation total time  152.53228664398193
average batch blocks generation time:  76.26614332199097
block dataloader generation time/epoch 367.77571317566765
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.399599552154541 |1.31449556350708 |0.005169034004211426 |0.0001800060272216797 |0.005070686340332031 |0.001863241195678711 |
----------------------------------------------------------pseudo_mini_loss sum 0.33879750967025757
Total (block generation + training)time/epoch 371.6142713737488
Training time/epoch 3.857769012451172
Training time without block to device /epoch 1.2287778854370117
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.47it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.20it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.53it/s] 40%|████      | 10/25 [00:00<00:01, 13.52it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.60it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.60it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.32it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.86it/s] 80%|████████  | 20/25 [00:01<00:00, 17.07it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.42it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.59it/s]100%|██████████| 25/25 [00:01<00:00, 16.70it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.52it/s]  8%|▊         | 2/25 [00:00<00:03,  6.63it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.70it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.77it/s] 20%|██        | 5/25 [00:00<00:02,  6.80it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.81it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.80it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.82it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.86it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.63it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.31it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.42it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.32it/s] 60%|██████    | 15/25 [00:02<00:01,  5.04it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.29it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.57it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.79it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.01it/s] 80%|████████  | 20/25 [00:03<00:00,  6.15it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.28it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.28it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.30it/s]100%|██████████| 25/25 [00:04<00:00,  6.69it/s]100%|██████████| 25/25 [00:04<00:00,  6.09it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.98it/s]  8%|▊         | 2/25 [00:00<00:03,  6.30it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.77it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.49it/s] 20%|██        | 5/25 [00:00<00:03,  5.26it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.88it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.02it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.29it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.48it/s] 40%|████      | 10/25 [00:01<00:02,  5.68it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.81it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.00it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.01it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.08it/s] 60%|██████    | 15/25 [00:02<00:01,  6.06it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.11it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.21it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.34it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.51it/s]100%|██████████| 25/25 [00:04<00:00,  6.07it/s]
Run 00 | Epoch 00225 | Loss 0.3388 | Train 0.6950 | Val 0.6852 | Test 0.5464
Number of nodes during this epoch:  4637582
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422860145568848  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.151679277420044
range selection method range initialization spend 0.03552961349487305
time for parepare:  0.3644983768463135
local_output_nid generation:  0.027682065963745117
local_in_edges_tensor generation:  0.23966121673583984
mini_batch_src_global generation:  0.3735353946685791
r_  generation:  5.344523668289185
local_output_nid generation:  0.029184818267822266
local_in_edges_tensor generation:  0.21703553199768066
mini_batch_src_global generation:  0.48425960540771484
r_  generation:  5.704860687255859
----------------------check_connections_block total spend ----------------------------- 14.442082405090332
generate_one_block  7.183036804199219
generate_one_block  6.964265584945679
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9754457473754883
gen group dst list time:  0.09132862091064453
time for parepare:  0.4334242343902588
local_output_nid generation:  0.2524378299713135
local_in_edges_tensor generation:  1.5677015781402588
mini_batch_src_global generation:  2.4181649684906006
r_  generation:  28.848141193389893
local_output_nid generation:  0.5067508220672607
local_in_edges_tensor generation:  2.029832363128662
mini_batch_src_global generation:  3.350080728530884
r_  generation:  30.167712450027466
----------------------check_connections_block total spend ----------------------------- 81.30179595947266
generate_one_block  41.267354011535645
generate_one_block  41.2136127948761
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.142468214035034
gen group dst list time:  0.18376803398132324
time for parepare:  0.45850610733032227
local_output_nid generation:  0.3921031951904297
local_in_edges_tensor generation:  1.4774744510650635
mini_batch_src_global generation:  2.035365343093872
r_  generation:  25.654036283493042
local_output_nid generation:  0.7304022312164307
local_in_edges_tensor generation:  1.9263436794281006
mini_batch_src_global generation:  3.0668530464172363
r_  generation:  25.875691652297974
----------------------check_connections_block total spend ----------------------------- 71.70233535766602
generate_one_block  35.47408628463745
generate_one_block  36.134705543518066
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422860145568848  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.00413131713867
block generation total time  154.08975863456726
average batch blocks generation time:  77.04487931728363
block dataloader generation time/epoch 367.7680494605967
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3794364929199219 |1.3039318323135376 |0.0044384002685546875 |0.00015079975128173828 |0.005144715309143066 |0.0014338493347167969 |
----------------------------------------------------------pseudo_mini_loss sum 0.3376184105873108
Total (block generation + training)time/epoch 371.6064264341793
Training time/epoch 3.797426223754883
Training time without block to device /epoch 1.1895625591278076
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.94it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.43it/s] 40%|████      | 10/25 [00:00<00:00, 17.76it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.90it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.90it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.90it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.86it/s] 80%|████████  | 20/25 [00:01<00:00, 17.76it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.62it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.87it/s]100%|██████████| 25/25 [00:01<00:00, 17.88it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.44it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.56it/s] 20%|██        | 5/25 [00:00<00:03,  6.57it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.60it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.61it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.61it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.54it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.93it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.11it/s] 60%|██████    | 15/25 [00:02<00:01,  6.24it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.04it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.02it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.80it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.70it/s] 80%|████████  | 20/25 [00:03<00:00,  5.76it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.87it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.02it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.17it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.27it/s]100%|██████████| 25/25 [00:03<00:00,  6.34it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.25it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.24it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.29it/s] 20%|██        | 5/25 [00:00<00:03,  5.92it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.74it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.86it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.00it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.12it/s] 40%|████      | 10/25 [00:01<00:02,  6.23it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.16it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.14it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.21it/s] 60%|██████    | 15/25 [00:02<00:01,  6.16it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.21it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.15it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.18it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.11it/s] 80%|████████  | 20/25 [00:03<00:00,  6.12it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.21it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.25it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.31it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.33it/s]100%|██████████| 25/25 [00:03<00:00,  6.27it/s]
Run 00 | Epoch 00226 | Loss 0.3376 | Train 0.6957 | Val 0.6851 | Test 0.5468
Number of nodes during this epoch:  4637660
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429019451141357  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.131927490234375
range selection method range initialization spend 0.02485942840576172
time for parepare:  0.3614938259124756
local_output_nid generation:  0.026890277862548828
local_in_edges_tensor generation:  0.22835350036621094
mini_batch_src_global generation:  0.3745238780975342
r_  generation:  5.5544092655181885
local_output_nid generation:  0.029139995574951172
local_in_edges_tensor generation:  0.23021364212036133
mini_batch_src_global generation:  0.4740002155303955
r_  generation:  5.785381317138672
----------------------check_connections_block total spend ----------------------------- 14.767747163772583
generate_one_block  7.142217636108398
generate_one_block  6.821975469589233
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.01335072517395
gen group dst list time:  0.08682632446289062
time for parepare:  0.44252562522888184
local_output_nid generation:  0.2638204097747803
local_in_edges_tensor generation:  1.6051454544067383
mini_batch_src_global generation:  2.6296133995056152
r_  generation:  29.792728662490845
local_output_nid generation:  0.5376989841461182
local_in_edges_tensor generation:  2.123265027999878
mini_batch_src_global generation:  3.5105295181274414
r_  generation:  31.189334392547607
----------------------check_connections_block total spend ----------------------------- 84.521231174469
generate_one_block  41.22298526763916
generate_one_block  41.237348556518555
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.228489637374878
gen group dst list time:  0.18731045722961426
time for parepare:  0.4607369899749756
local_output_nid generation:  0.40866899490356445
local_in_edges_tensor generation:  1.5038118362426758
mini_batch_src_global generation:  2.1410303115844727
r_  generation:  26.28063941001892
local_output_nid generation:  0.7254903316497803
local_in_edges_tensor generation:  1.9027597904205322
mini_batch_src_global generation:  2.839557647705078
r_  generation:  26.03643226623535
----------------------check_connections_block total spend ----------------------------- 72.29576468467712
generate_one_block  35.22723436355591
generate_one_block  36.02291440963745
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429019451141357  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.81699585914612
block generation total time  153.71048259735107
average batch blocks generation time:  76.85524129867554
block dataloader generation time/epoch 367.77289431840836
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37989139556884766 |1.299760341644287 |0.004383206367492676 |0.00015747547149658203 |0.0052068233489990234 |0.0023229122161865234 |
----------------------------------------------------------pseudo_mini_loss sum 0.3370745778083801
Total (block generation + training)time/epoch 371.61105379869235
Training time/epoch 3.7888314723968506
Training time without block to device /epoch 1.1893107891082764
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.69it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.99it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.31it/s] 40%|████      | 10/25 [00:00<00:00, 17.47it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.73it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.94it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.10it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.00it/s] 80%|████████  | 20/25 [00:01<00:00, 18.04it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.09it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.15it/s]100%|██████████| 25/25 [00:01<00:00, 18.02it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.12it/s]  8%|▊         | 2/25 [00:00<00:04,  5.11it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.15it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.17it/s] 20%|██        | 5/25 [00:00<00:03,  5.16it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.91it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.18it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.14it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.96it/s] 40%|████      | 10/25 [00:01<00:02,  5.27it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.34it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.31it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.25it/s] 60%|██████    | 15/25 [00:02<00:01,  5.53it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.86it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.08it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.18it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.32it/s] 80%|████████  | 20/25 [00:03<00:00,  6.42it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.20it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.22it/s]100%|██████████| 25/25 [00:04<00:00,  5.74it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.46it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.51it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.48it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.03it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.98it/s] 40%|████      | 10/25 [00:01<00:02,  5.78it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.75it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.85it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.99it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.10it/s] 60%|██████    | 15/25 [00:02<00:01,  6.17it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.24it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.28it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.27it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.26it/s] 80%|████████  | 20/25 [00:03<00:00,  6.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:03<00:00,  7.13it/s]100%|██████████| 25/25 [00:03<00:00,  6.32it/s]
Run 00 | Epoch 00227 | Loss 0.3371 | Train 0.6943 | Val 0.6830 | Test 0.5466
Number of nodes during this epoch:  4637180
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423428058624268  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1597187519073486
range selection method range initialization spend 0.026197195053100586
time for parepare:  0.3671870231628418
local_output_nid generation:  0.025876283645629883
local_in_edges_tensor generation:  0.20370006561279297
mini_batch_src_global generation:  0.377352237701416
r_  generation:  5.3899688720703125
local_output_nid generation:  0.0276486873626709
local_in_edges_tensor generation:  0.21631073951721191
mini_batch_src_global generation:  0.4662480354309082
r_  generation:  5.6927454471588135
----------------------check_connections_block total spend ----------------------------- 14.400126218795776
generate_one_block  7.186671495437622
generate_one_block  6.767850160598755
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.186249732971191
gen group dst list time:  0.08474254608154297
time for parepare:  0.465198278427124
local_output_nid generation:  0.26121091842651367
local_in_edges_tensor generation:  1.7911334037780762
mini_batch_src_global generation:  2.4797909259796143
r_  generation:  30.1214439868927
local_output_nid generation:  0.5366008281707764
local_in_edges_tensor generation:  2.216707468032837
mini_batch_src_global generation:  3.515035629272461
r_  generation:  30.04573154449463
----------------------check_connections_block total spend ----------------------------- 84.10074067115784
generate_one_block  40.95861577987671
generate_one_block  41.022040367126465
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.269719123840332
gen group dst list time:  0.18523955345153809
time for parepare:  0.4844989776611328
local_output_nid generation:  0.39873218536376953
local_in_edges_tensor generation:  1.5255937576293945
mini_batch_src_global generation:  2.1991119384765625
r_  generation:  26.57283639907837
local_output_nid generation:  0.7256917953491211
local_in_edges_tensor generation:  1.9546008110046387
mini_batch_src_global generation:  2.821042537689209
r_  generation:  26.347288131713867
----------------------check_connections_block total spend ----------------------------- 73.27223587036133
generate_one_block  35.36618113517761
generate_one_block  36.11770439147949
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423428058624268  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.37297654151917
block generation total time  153.46454167366028
average batch blocks generation time:  76.73227083683014
block dataloader generation time/epoch 367.7789348395247
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3825165033340454 |1.3057764768600464 |0.004419565200805664 |0.00015878677368164062 |0.004977583885192871 |0.0013964176177978516 |
----------------------------------------------------------pseudo_mini_loss sum 0.33739349246025085
Total (block generation + training)time/epoch 371.61698857629506
Training time/epoch 3.813871383666992
Training time without block to device /epoch 1.2023184299468994
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.07it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.76it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.11it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.60it/s] 40%|████      | 10/25 [00:00<00:00, 17.55it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.86it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.06it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.81it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.78it/s] 80%|████████  | 20/25 [00:01<00:00, 17.91it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.87it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.84it/s]100%|██████████| 25/25 [00:01<00:00, 17.82it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.29it/s]  8%|▊         | 2/25 [00:00<00:04,  5.16it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.16it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.15it/s] 20%|██        | 5/25 [00:00<00:03,  5.13it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.16it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.16it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.14it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.15it/s] 40%|████      | 10/25 [00:01<00:02,  5.15it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.73it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.58it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.45it/s] 60%|██████    | 15/25 [00:02<00:01,  5.69it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.42it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.40it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.35it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.43it/s] 80%|████████  | 20/25 [00:03<00:00,  5.57it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.42it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.25it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.58it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.84it/s]100%|██████████| 25/25 [00:04<00:00,  6.65it/s]100%|██████████| 25/25 [00:04<00:00,  5.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.24it/s]  8%|▊         | 2/25 [00:00<00:04,  5.65it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.03it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.27it/s] 20%|██        | 5/25 [00:00<00:03,  5.35it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.47it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.75it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.99it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.18it/s] 40%|████      | 10/25 [00:01<00:02,  6.30it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.48it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.50it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.48it/s] 60%|██████    | 15/25 [00:02<00:01,  6.49it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.02it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.16it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.30it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.46it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.84it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
Run 00 | Epoch 00228 | Loss 0.3374 | Train 0.6935 | Val 0.6824 | Test 0.5463
Number of nodes during this epoch:  4637705
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423495769500732  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.125680685043335
range selection method range initialization spend 0.035553693771362305
time for parepare:  0.39006519317626953
local_output_nid generation:  0.02658677101135254
local_in_edges_tensor generation:  0.22068238258361816
mini_batch_src_global generation:  0.3833787441253662
r_  generation:  5.685617923736572
local_output_nid generation:  0.02928471565246582
local_in_edges_tensor generation:  0.23603105545043945
mini_batch_src_global generation:  0.46468210220336914
r_  generation:  5.989221572875977
----------------------check_connections_block total spend ----------------------------- 15.103276252746582
generate_one_block  7.224019527435303
generate_one_block  6.9218127727508545
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.055812835693359
gen group dst list time:  0.09287357330322266
time for parepare:  0.4751100540161133
local_output_nid generation:  0.26874732971191406
local_in_edges_tensor generation:  1.6188366413116455
mini_batch_src_global generation:  2.487117290496826
r_  generation:  29.802422046661377
local_output_nid generation:  0.5258934497833252
local_in_edges_tensor generation:  2.090696334838867
mini_batch_src_global generation:  3.5160651206970215
r_  generation:  30.429901361465454
----------------------check_connections_block total spend ----------------------------- 83.42312288284302
generate_one_block  40.80420207977295
generate_one_block  41.06882691383362
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1969640254974365
gen group dst list time:  0.18200254440307617
time for parepare:  0.45827746391296387
local_output_nid generation:  0.41017866134643555
local_in_edges_tensor generation:  1.4720664024353027
mini_batch_src_global generation:  2.0595896244049072
r_  generation:  25.908862590789795
local_output_nid generation:  0.7676730155944824
local_in_edges_tensor generation:  1.9446635246276855
mini_batch_src_global generation:  2.983097791671753
r_  generation:  26.005608081817627
----------------------check_connections_block total spend ----------------------------- 72.26660799980164
generate_one_block  35.355483055114746
generate_one_block  35.80222964286804
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423495769500732  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.68973088264465
block generation total time  153.03074169158936
average batch blocks generation time:  76.51537084579468
block dataloader generation time/epoch 367.77914155206304
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39982593059539795 |1.3306422233581543 |0.005196213722229004 |0.00019276142120361328 |0.005149960517883301 |0.0024890899658203125 |
----------------------------------------------------------pseudo_mini_loss sum 0.3363209068775177
Total (block generation + training)time/epoch 371.61743842982827
Training time/epoch 3.893552303314209
Training time without block to device /epoch 1.2322678565979004
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.77it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.28it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.67it/s] 40%|████      | 10/25 [00:00<00:00, 17.87it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.97it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.01it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.15it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.16it/s] 80%|████████  | 20/25 [00:01<00:00, 18.21it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.19it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.25it/s]100%|██████████| 25/25 [00:01<00:00, 18.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.44it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.50it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.53it/s] 20%|██        | 5/25 [00:00<00:03,  6.53it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.50it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.50it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.49it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.50it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.51it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.51it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.87it/s]  8%|▊         | 2/25 [00:00<00:03,  6.19it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.30it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.35it/s] 20%|██        | 5/25 [00:00<00:03,  6.34it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.32it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.38it/s] 40%|████      | 10/25 [00:01<00:02,  6.32it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.32it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.36it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.33it/s] 60%|██████    | 15/25 [00:02<00:01,  6.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.31it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.46it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.43it/s]100%|██████████| 25/25 [00:03<00:00,  7.19it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00229 | Loss 0.3363 | Train 0.6927 | Val 0.6814 | Test 0.5457
Number of nodes during this epoch:  4637148
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423856258392334  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1251871585845947
range selection method range initialization spend 0.024739503860473633
time for parepare:  0.3799874782562256
local_output_nid generation:  0.025758743286132812
local_in_edges_tensor generation:  0.21503663063049316
mini_batch_src_global generation:  0.3721354007720947
r_  generation:  5.6650590896606445
local_output_nid generation:  0.027756690979003906
local_in_edges_tensor generation:  0.21582674980163574
mini_batch_src_global generation:  0.4593977928161621
r_  generation:  5.588638782501221
----------------------check_connections_block total spend ----------------------------- 14.623232126235962
generate_one_block  7.311255216598511
generate_one_block  7.181655168533325
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.156919717788696
gen group dst list time:  0.09217238426208496
time for parepare:  0.48815393447875977
local_output_nid generation:  0.28000450134277344
local_in_edges_tensor generation:  1.7972052097320557
mini_batch_src_global generation:  2.4711265563964844
r_  generation:  30.06316637992859
local_output_nid generation:  0.5289459228515625
local_in_edges_tensor generation:  2.1070401668548584
mini_batch_src_global generation:  3.5306193828582764
r_  generation:  30.192647457122803
----------------------check_connections_block total spend ----------------------------- 83.23065400123596
generate_one_block  41.10254645347595
generate_one_block  41.14613676071167
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1212611198425293
gen group dst list time:  0.1915295124053955
time for parepare:  0.48506617546081543
local_output_nid generation:  0.4003458023071289
local_in_edges_tensor generation:  1.6183199882507324
mini_batch_src_global generation:  2.1557929515838623
r_  generation:  26.620277404785156
local_output_nid generation:  0.7352275848388672
local_in_edges_tensor generation:  1.9293184280395508
mini_batch_src_global generation:  2.889712333679199
r_  generation:  26.145360708236694
----------------------check_connections_block total spend ----------------------------- 72.96603655815125
generate_one_block  35.349873304367065
generate_one_block  36.08847689628601
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423856258392334  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.1966905593872
block generation total time  153.6870334148407
average batch blocks generation time:  76.84351670742035
block dataloader generation time/epoch 367.78309102680373
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3835422992706299 |1.2972265481948853 |0.005031466484069824 |0.0001729726791381836 |0.00509190559387207 |0.003824949264526367 |
----------------------------------------------------------pseudo_mini_loss sum 0.33709073066711426
Total (block generation + training)time/epoch 371.6212009450664
Training time/epoch 3.795095205307007
Training time without block to device /epoch 1.2006421089172363
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.07it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.20it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.21it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.02it/s] 40%|████      | 10/25 [00:00<00:01, 13.65it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.83it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.65it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.37it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.92it/s] 80%|████████  | 20/25 [00:01<00:00, 17.29it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.53it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.65it/s]100%|██████████| 25/25 [00:01<00:00, 16.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.47it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.61it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.62it/s] 40%|████      | 10/25 [00:01<00:02,  6.59it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.58it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.60it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.62it/s] 60%|██████    | 15/25 [00:02<00:01,  6.62it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.61it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.67it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.73it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.22it/s] 80%|████████  | 20/25 [00:03<00:00,  5.83it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.29it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.50it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.90it/s]100%|██████████| 25/25 [00:04<00:00,  6.22it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.49it/s]  8%|▊         | 2/25 [00:00<00:04,  5.41it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.40it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.01it/s] 20%|██        | 5/25 [00:00<00:03,  5.43it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.79it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.09it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.24it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.81it/s] 40%|████      | 10/25 [00:01<00:02,  5.56it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.35it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.28it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.18it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.04it/s] 60%|██████    | 15/25 [00:02<00:01,  5.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.73it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.53it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.42it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.31it/s] 80%|████████  | 20/25 [00:03<00:00,  5.21it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.10it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.02it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.01it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.30it/s]100%|██████████| 25/25 [00:04<00:00,  5.48it/s]
Run 00 | Epoch 00230 | Loss 0.3371 | Train 0.6907 | Val 0.6797 | Test 0.5445
Number of nodes during this epoch:  4637334
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427340984344482  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1398735046386719
range selection method range initialization spend 0.024570941925048828
time for parepare:  0.39177680015563965
local_output_nid generation:  0.02640986442565918
local_in_edges_tensor generation:  0.2400503158569336
mini_batch_src_global generation:  0.3808937072753906
r_  generation:  5.575338840484619
local_output_nid generation:  0.0279080867767334
local_in_edges_tensor generation:  0.21386957168579102
mini_batch_src_global generation:  0.4557507038116455
r_  generation:  5.624711513519287
----------------------check_connections_block total spend ----------------------------- 14.576365232467651
generate_one_block  7.416339635848999
generate_one_block  7.1702375411987305
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.039675712585449
gen group dst list time:  0.09113168716430664
time for parepare:  0.4892153739929199
local_output_nid generation:  0.2688751220703125
local_in_edges_tensor generation:  1.688476800918579
mini_batch_src_global generation:  2.4807958602905273
r_  generation:  29.97780466079712
local_output_nid generation:  0.5233535766601562
local_in_edges_tensor generation:  2.091641426086426
mini_batch_src_global generation:  3.6004581451416016
r_  generation:  30.56023859977722
----------------------check_connections_block total spend ----------------------------- 83.7632360458374
generate_one_block  40.66687226295471
generate_one_block  41.17873978614807
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2434253692626953
gen group dst list time:  0.18724679946899414
time for parepare:  0.47618842124938965
local_output_nid generation:  0.4340975284576416
local_in_edges_tensor generation:  1.5757765769958496
mini_batch_src_global generation:  2.059154987335205
r_  generation:  26.39094090461731
local_output_nid generation:  0.7398269176483154
local_in_edges_tensor generation:  1.9413301944732666
mini_batch_src_global generation:  2.8297030925750732
r_  generation:  26.304458141326904
----------------------check_connections_block total spend ----------------------------- 72.78114199638367
generate_one_block  35.43818378448486
generate_one_block  36.09107995033264
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427340984344482  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.54437804222107
block generation total time  153.3748757839203
average batch blocks generation time:  76.68743789196014
block dataloader generation time/epoch 367.791076729308
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3784947395324707 |1.3021949529647827 |0.004424333572387695 |0.00015223026275634766 |0.005135536193847656 |0.002933502197265625 |
----------------------------------------------------------pseudo_mini_loss sum 0.33620426058769226
Total (block generation + training)time/epoch 371.62899192277484
Training time/epoch 3.792954444885254
Training time without block to device /epoch 1.1885645389556885
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.86it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.56it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.24it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.49it/s] 40%|████      | 10/25 [00:00<00:00, 17.78it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.80it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.92it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.92it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.78it/s] 80%|████████  | 20/25 [00:01<00:00, 17.65it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.54it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.54it/s]100%|██████████| 25/25 [00:01<00:00, 17.75it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.72it/s]  8%|▊         | 2/25 [00:00<00:05,  4.47it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.90it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.31it/s] 20%|██        | 5/25 [00:01<00:03,  5.08it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.04it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.40it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.65it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.65it/s] 40%|████      | 10/25 [00:01<00:02,  6.01it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.75it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.56it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.28it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.29it/s] 60%|██████    | 15/25 [00:02<00:02,  4.93it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.41it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.80it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.61it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.48it/s] 80%|████████  | 20/25 [00:03<00:00,  5.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.12it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.40it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.70it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.02it/s]100%|██████████| 25/25 [00:04<00:00,  5.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.95it/s]  8%|▊         | 2/25 [00:00<00:03,  5.83it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.19it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.66it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.62it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.63it/s] 40%|████      | 10/25 [00:01<00:02,  6.68it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.57it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.54it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.62it/s] 60%|██████    | 15/25 [00:02<00:01,  6.13it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.80it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.91it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.89it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.86it/s] 80%|████████  | 20/25 [00:03<00:00,  5.64it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.91it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.14it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.29it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.90it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
Run 00 | Epoch 00231 | Loss 0.3362 | Train 0.6889 | Val 0.6772 | Test 0.5427
Number of nodes during this epoch:  4637574
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423436164855957  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.126777172088623
range selection method range initialization spend 0.03712177276611328
time for parepare:  0.36958909034729004
local_output_nid generation:  0.029016494750976562
local_in_edges_tensor generation:  0.2342391014099121
mini_batch_src_global generation:  0.3782031536102295
r_  generation:  5.7051308155059814
local_output_nid generation:  0.028954267501831055
local_in_edges_tensor generation:  0.23615646362304688
mini_batch_src_global generation:  0.4767279624938965
r_  generation:  5.957810878753662
----------------------check_connections_block total spend ----------------------------- 15.14155912399292
generate_one_block  7.23535943031311
generate_one_block  6.877049446105957
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.923532247543335
gen group dst list time:  0.0873260498046875
time for parepare:  0.4478323459625244
local_output_nid generation:  0.260814905166626
local_in_edges_tensor generation:  1.6328136920928955
mini_batch_src_global generation:  2.605613946914673
r_  generation:  30.08035182952881
local_output_nid generation:  0.5221912860870361
local_in_edges_tensor generation:  2.1039392948150635
mini_batch_src_global generation:  3.5496561527252197
r_  generation:  29.951581239700317
----------------------check_connections_block total spend ----------------------------- 83.38617849349976
generate_one_block  40.61003017425537
generate_one_block  40.99688100814819
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1441097259521484
gen group dst list time:  0.1860036849975586
time for parepare:  0.49471092224121094
local_output_nid generation:  0.40038275718688965
local_in_edges_tensor generation:  1.6779797077178955
mini_batch_src_global generation:  2.0574655532836914
r_  generation:  26.324712991714478
local_output_nid generation:  0.7511491775512695
local_in_edges_tensor generation:  2.066026210784912
mini_batch_src_global generation:  3.0302586555480957
r_  generation:  26.883145809173584
----------------------check_connections_block total spend ----------------------------- 74.10651516914368
generate_one_block  36.9215943813324
generate_one_block  37.505943298339844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423436164855957  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.49269366264343
block generation total time  156.0344488620758
average batch blocks generation time:  78.0172244310379
block dataloader generation time/epoch 367.8144418730818
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37622320652008057 |1.4564236402511597 |0.0048787593841552734 |0.00017273426055908203 |0.005161404609680176 |0.002198934555053711 |
----------------------------------------------------------pseudo_mini_loss sum 0.33587756752967834
Total (block generation + training)time/epoch 371.6534659924178
Training time/epoch 4.095005512237549
Training time without block to device /epoch 1.1821582317352295
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.21it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.55it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.11it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.44it/s] 40%|████      | 10/25 [00:00<00:00, 16.69it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.15it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.18it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.23it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.29it/s] 80%|████████  | 20/25 [00:01<00:00, 17.58it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.86it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.02it/s]100%|██████████| 25/25 [00:01<00:00, 17.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.27it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.52it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.88it/s] 20%|██        | 5/25 [00:00<00:03,  6.11it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.29it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.30it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.76it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.00it/s] 40%|████      | 10/25 [00:01<00:02,  6.20it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.82it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.01it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.18it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.28it/s] 60%|██████    | 15/25 [00:02<00:01,  6.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.90it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.03it/s] 80%|████████  | 20/25 [00:03<00:00,  6.19it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.33it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  7.14it/s]100%|██████████| 25/25 [00:03<00:00,  6.30it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.43it/s]  8%|▊         | 2/25 [00:00<00:04,  5.68it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.16it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.29it/s] 20%|██        | 5/25 [00:00<00:03,  5.65it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.88it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.03it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.08it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.11it/s] 40%|████      | 10/25 [00:01<00:02,  6.10it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.66it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.62it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.76it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.87it/s] 60%|██████    | 15/25 [00:02<00:01,  5.98it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.08it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.15it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.20it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.00it/s] 80%|████████  | 20/25 [00:03<00:00,  5.66it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.61it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.67it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.73it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.78it/s]100%|██████████| 25/25 [00:04<00:00,  6.52it/s]100%|██████████| 25/25 [00:04<00:00,  5.90it/s]
Run 00 | Epoch 00232 | Loss 0.3359 | Train 0.6892 | Val 0.6772 | Test 0.5424
Number of nodes during this epoch:  4637563
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423626899719238  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1740734577178955
range selection method range initialization spend 0.024527311325073242
time for parepare:  0.3844616413116455
local_output_nid generation:  0.026106595993041992
local_in_edges_tensor generation:  0.20688629150390625
mini_batch_src_global generation:  0.39594459533691406
r_  generation:  5.607217788696289
local_output_nid generation:  0.0290067195892334
local_in_edges_tensor generation:  0.24128961563110352
mini_batch_src_global generation:  0.458812952041626
r_  generation:  5.930217266082764
----------------------check_connections_block total spend ----------------------------- 15.045901536941528
generate_one_block  7.504200220108032
generate_one_block  7.426640748977661
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.006841421127319
gen group dst list time:  0.08979988098144531
time for parepare:  0.4623286724090576
local_output_nid generation:  0.2842862606048584
local_in_edges_tensor generation:  1.6572089195251465
mini_batch_src_global generation:  2.5428626537323
r_  generation:  30.142030239105225
local_output_nid generation:  0.5818436145782471
local_in_edges_tensor generation:  2.360624074935913
mini_batch_src_global generation:  3.9344112873077393
r_  generation:  31.328776597976685
----------------------check_connections_block total spend ----------------------------- 86.33746600151062
generate_one_block  42.962202310562134
generate_one_block  42.75855493545532
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.406562089920044
gen group dst list time:  0.19497919082641602
time for parepare:  0.47182750701904297
local_output_nid generation:  0.40981602668762207
local_in_edges_tensor generation:  1.565100908279419
mini_batch_src_global generation:  2.205648899078369
r_  generation:  26.891228675842285
local_output_nid generation:  0.7609348297119141
local_in_edges_tensor generation:  1.9671995639801025
mini_batch_src_global generation:  2.839757204055786
r_  generation:  26.149704456329346
----------------------check_connections_block total spend ----------------------------- 73.42931389808655
generate_one_block  35.194215059280396
generate_one_block  35.8702974319458
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423626899719238  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  159.76677989959717
block generation total time  156.78526973724365
average batch blocks generation time:  78.39263486862183
block dataloader generation time/epoch 367.85507633553044
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3787037134170532 |1.2933470010757446 |0.0044252872467041016 |0.0001455545425415039 |0.005116701126098633 |0.0017235279083251953 |
----------------------------------------------------------pseudo_mini_loss sum 0.3351643681526184
Total (block generation + training)time/epoch 371.6938380980185
Training time/epoch 3.7777199745178223
Training time without block to device /epoch 1.191025972366333
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.95it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.36it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.20it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.47it/s] 40%|████      | 10/25 [00:00<00:00, 17.61it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.55it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.26it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.54it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.71it/s] 80%|████████  | 20/25 [00:01<00:00, 17.81it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.89it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.97it/s]100%|██████████| 25/25 [00:01<00:00, 17.78it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.69it/s]  8%|▊         | 2/25 [00:00<00:03,  6.72it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.72it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.66it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.67it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.71it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.75it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.74it/s] 40%|████      | 10/25 [00:01<00:02,  6.71it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.73it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.48it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.57it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.67it/s] 60%|██████    | 15/25 [00:02<00:01,  6.19it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.97it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.00it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.08it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.24it/s] 80%|████████  | 20/25 [00:03<00:00,  6.30it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.35it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.54it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.54it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.58it/s]  8%|▊         | 2/25 [00:00<00:05,  4.28it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.78it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.16it/s] 20%|██        | 5/25 [00:00<00:03,  5.55it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.76it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.94it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.01it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.19it/s] 40%|████      | 10/25 [00:01<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.42it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.44it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.47it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.53it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.56it/s] 80%|████████  | 20/25 [00:03<00:00,  6.58it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.61it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.60it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.59it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.61it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
Run 00 | Epoch 00233 | Loss 0.3352 | Train 0.6912 | Val 0.6792 | Test 0.5438
Number of nodes during this epoch:  4637354
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4228925704956055  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.134690284729004
range selection method range initialization spend 0.03543519973754883
time for parepare:  0.37465739250183105
local_output_nid generation:  0.026660680770874023
local_in_edges_tensor generation:  0.2218458652496338
mini_batch_src_global generation:  0.3943824768066406
r_  generation:  5.579833507537842
local_output_nid generation:  0.029493331909179688
local_in_edges_tensor generation:  0.2380974292755127
mini_batch_src_global generation:  0.45780253410339355
r_  generation:  5.949992656707764
----------------------check_connections_block total spend ----------------------------- 15.039632797241211
generate_one_block  7.292416095733643
generate_one_block  6.977234125137329
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.016305208206177
gen group dst list time:  0.09027457237243652
time for parepare:  0.44554638862609863
local_output_nid generation:  0.2642664909362793
local_in_edges_tensor generation:  1.653346300125122
mini_batch_src_global generation:  2.545376777648926
r_  generation:  29.868760585784912
local_output_nid generation:  0.5351848602294922
local_in_edges_tensor generation:  2.142585515975952
mini_batch_src_global generation:  3.566377639770508
r_  generation:  30.06844711303711
----------------------check_connections_block total spend ----------------------------- 83.29344964027405
generate_one_block  40.672515630722046
generate_one_block  41.10899376869202
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3210065364837646
gen group dst list time:  0.18585205078125
time for parepare:  0.46529173851013184
local_output_nid generation:  0.38852858543395996
local_in_edges_tensor generation:  1.49174165725708
mini_batch_src_global generation:  2.0348455905914307
r_  generation:  25.7020423412323
local_output_nid generation:  0.7330374717712402
local_in_edges_tensor generation:  1.9055674076080322
mini_batch_src_global generation:  2.824491024017334
r_  generation:  26.512462854385376
----------------------check_connections_block total spend ----------------------------- 71.92825961112976
generate_one_block  35.3527934551239
generate_one_block  36.14982843399048
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4228925704956055  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.2217092514038
block generation total time  153.28413128852844
average batch blocks generation time:  76.64206564426422
block dataloader generation time/epoch 367.8569082938708
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38994503021240234 |1.3407784700393677 |0.004437685012817383 |0.00015079975128173828 |0.005133271217346191 |0.0031442642211914062 |
----------------------------------------------------------pseudo_mini_loss sum 0.3360826373100281
Total (block generation + training)time/epoch 371.69589307674994
Training time/epoch 3.890768051147461
Training time without block to device /epoch 1.2092111110687256
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.22it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.80it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.30it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.14it/s] 40%|████      | 10/25 [00:00<00:00, 17.36it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.68it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.85it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.97it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.01it/s] 80%|████████  | 20/25 [00:01<00:00, 18.09it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.98it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.08it/s]100%|██████████| 25/25 [00:01<00:00, 17.97it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.45it/s]  8%|▊         | 2/25 [00:00<00:03,  6.59it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.56it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.63it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.62it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.63it/s] 40%|████      | 10/25 [00:01<00:02,  6.62it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.61it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.57it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.58it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.46it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.32it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.90it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.79it/s] 76%|███████▌  | 19/25 [00:02<00:01,  5.85it/s] 80%|████████  | 20/25 [00:03<00:00,  5.92it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.05it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.21it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  7.07it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.30it/s]  8%|▊         | 2/25 [00:00<00:03,  6.50it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.50it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.54it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.41it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.14it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.11it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.15it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.21it/s] 60%|██████    | 15/25 [00:02<00:01,  6.24it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.34it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.35it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.43it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00234 | Loss 0.3361 | Train 0.6942 | Val 0.6822 | Test 0.5461
Number of nodes during this epoch:  4636197
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428487777709961  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1327178478240967
range selection method range initialization spend 0.02368760108947754
time for parepare:  0.37254953384399414
local_output_nid generation:  0.0263974666595459
local_in_edges_tensor generation:  0.20579743385314941
mini_batch_src_global generation:  0.37645578384399414
r_  generation:  5.649987697601318
local_output_nid generation:  0.02882862091064453
local_in_edges_tensor generation:  0.2344365119934082
mini_batch_src_global generation:  0.4668397903442383
r_  generation:  5.912622928619385
----------------------check_connections_block total spend ----------------------------- 14.947187662124634
generate_one_block  7.2208030223846436
generate_one_block  6.914964437484741
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9771676063537598
gen group dst list time:  0.09924983978271484
time for parepare:  0.4561333656311035
local_output_nid generation:  0.2706165313720703
local_in_edges_tensor generation:  1.7743942737579346
mini_batch_src_global generation:  2.462895631790161
r_  generation:  30.00904369354248
local_output_nid generation:  0.530566930770874
local_in_edges_tensor generation:  2.196589231491089
mini_batch_src_global generation:  3.4744882583618164
r_  generation:  29.715540647506714
----------------------check_connections_block total spend ----------------------------- 82.81240940093994
generate_one_block  40.738157749176025
generate_one_block  40.850765228271484
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1498324871063232
gen group dst list time:  0.1830146312713623
time for parepare:  0.43010997772216797
local_output_nid generation:  0.3885180950164795
local_in_edges_tensor generation:  1.4403924942016602
mini_batch_src_global generation:  2.000882863998413
r_  generation:  25.4425847530365
local_output_nid generation:  0.7204794883728027
local_in_edges_tensor generation:  1.9131875038146973
mini_batch_src_global generation:  2.6742825508117676
r_  generation:  25.972508907318115
----------------------check_connections_block total spend ----------------------------- 71.05675172805786
generate_one_block  35.03266668319702
generate_one_block  35.617125511169434
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428487777709961  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.8691611289978
block generation total time  152.23871517181396
average batch blocks generation time:  76.11935758590698
block dataloader generation time/epoch 367.84257147667256
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37971460819244385 |1.2055559158325195 |0.004661202430725098 |0.00016164779663085938 |0.005170583724975586 |0.0018749237060546875 |
----------------------------------------------------------pseudo_mini_loss sum 0.33600836992263794
Total (block generation + training)time/epoch 371.68052529679966
Training time/epoch 3.5965373516082764
Training time without block to device /epoch 1.1854255199432373
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.17it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.51it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.25it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.28it/s] 40%|████      | 10/25 [00:00<00:01, 13.93it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.17it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.07it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.73it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.13it/s] 80%|████████  | 20/25 [00:01<00:00, 17.41it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.60it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.57it/s]100%|██████████| 25/25 [00:01<00:00, 16.95it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.74it/s]  8%|▊         | 2/25 [00:00<00:03,  5.77it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.36it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.82it/s] 20%|██        | 5/25 [00:00<00:03,  6.14it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.32it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.03it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.15it/s] 40%|████      | 10/25 [00:01<00:02,  6.28it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.45it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.48it/s] 60%|██████    | 15/25 [00:02<00:01,  6.52it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.55it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.59it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.62it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.65it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.66it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.64it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.63it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.64it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.29it/s]  8%|▊         | 2/25 [00:00<00:03,  6.43it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.03it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.06it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.23it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.32it/s] 40%|████      | 10/25 [00:01<00:02,  6.40it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.47it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.53it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.54it/s] 60%|██████    | 15/25 [00:02<00:01,  6.07it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.72it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.81it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.82it/s] 76%|███████▌  | 19/25 [00:03<00:01,  6.00it/s] 80%|████████  | 20/25 [00:03<00:00,  5.89it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.24it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.77it/s]100%|██████████| 25/25 [00:04<00:00,  6.16it/s]
Run 00 | Epoch 00235 | Loss 0.3360 | Train 0.6940 | Val 0.6817 | Test 0.5459
Number of nodes during this epoch:  4638038
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422216415405273  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1241869926452637
range selection method range initialization spend 0.024832725524902344
time for parepare:  0.37780308723449707
local_output_nid generation:  0.026157617568969727
local_in_edges_tensor generation:  0.26744580268859863
mini_batch_src_global generation:  0.37948155403137207
r_  generation:  5.455991744995117
local_output_nid generation:  0.028522968292236328
local_in_edges_tensor generation:  0.2150893211364746
mini_batch_src_global generation:  0.4981365203857422
r_  generation:  5.8295204639434814
----------------------check_connections_block total spend ----------------------------- 14.78829574584961
generate_one_block  7.238319635391235
generate_one_block  6.885573625564575
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9693763256073
gen group dst list time:  0.10174560546875
time for parepare:  0.47033166885375977
local_output_nid generation:  0.2739708423614502
local_in_edges_tensor generation:  1.6290078163146973
mini_batch_src_global generation:  2.5534820556640625
r_  generation:  29.766734838485718
local_output_nid generation:  0.5268447399139404
local_in_edges_tensor generation:  2.1140856742858887
mini_batch_src_global generation:  3.5517709255218506
r_  generation:  29.84029793739319
----------------------check_connections_block total spend ----------------------------- 82.85880303382874
generate_one_block  40.6947808265686
generate_one_block  41.66442656517029
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.376620054244995
gen group dst list time:  0.1816544532775879
time for parepare:  0.4939699172973633
local_output_nid generation:  0.4192678928375244
local_in_edges_tensor generation:  1.591679573059082
mini_batch_src_global generation:  2.047468662261963
r_  generation:  26.356417894363403
local_output_nid generation:  0.7417654991149902
local_in_edges_tensor generation:  2.138598680496216
mini_batch_src_global generation:  2.8283843994140625
r_  generation:  26.23224973678589
----------------------check_connections_block total spend ----------------------------- 73.46896052360535
generate_one_block  35.40822458267212
generate_one_block  36.15409874916077
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422216415405273  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.32776355743408
block generation total time  153.92153072357178
average batch blocks generation time:  76.96076536178589
block dataloader generation time/epoch 367.8498994243347
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3889693021774292 |1.2293713092803955 |0.004976391792297363 |0.00016939640045166016 |0.005185604095458984 |0.0019562244415283203 |
----------------------------------------------------------pseudo_mini_loss sum 0.3358128070831299
Total (block generation + training)time/epoch 371.68713092702933
Training time/epoch 3.667301654815674
Training time without block to device /epoch 1.2085590362548828
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.76it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.52it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.31it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.72it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.90it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.78it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.96it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.96it/s] 80%|████████  | 20/25 [00:01<00:00, 18.08it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.19it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.28it/s]100%|██████████| 25/25 [00:01<00:00, 18.07it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.14it/s]  8%|▊         | 2/25 [00:00<00:04,  5.13it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.15it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.15it/s] 20%|██        | 5/25 [00:00<00:03,  5.15it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.14it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.14it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.14it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.15it/s] 40%|████      | 10/25 [00:01<00:02,  5.14it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.09it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.88it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.05it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.83it/s] 60%|██████    | 15/25 [00:02<00:02,  4.98it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.21it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.44it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.65it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.89it/s] 80%|████████  | 20/25 [00:03<00:00,  6.08it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.22it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.33it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.94it/s]100%|██████████| 25/25 [00:04<00:00,  6.42it/s]100%|██████████| 25/25 [00:04<00:00,  5.50it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.46it/s]  8%|▊         | 2/25 [00:00<00:04,  5.12it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.34it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.99it/s] 20%|██        | 5/25 [00:00<00:04,  4.98it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.96it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.76it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.58it/s] 40%|████      | 10/25 [00:01<00:02,  5.37it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.22it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.20it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.14it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.07it/s] 60%|██████    | 15/25 [00:02<00:01,  5.07it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.07it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.37it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.70it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.92it/s] 80%|████████  | 20/25 [00:03<00:00,  6.04it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.15it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.27it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.28it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.30it/s]100%|██████████| 25/25 [00:04<00:00,  5.66it/s]
Run 00 | Epoch 00236 | Loss 0.3358 | Train 0.6924 | Val 0.6814 | Test 0.5448
Number of nodes during this epoch:  4637539
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423706531524658  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.176048755645752
range selection method range initialization spend 0.02511763572692871
time for parepare:  0.3842501640319824
local_output_nid generation:  0.030800580978393555
local_in_edges_tensor generation:  0.23022818565368652
mini_batch_src_global generation:  0.38589906692504883
r_  generation:  5.4774158000946045
local_output_nid generation:  0.02924942970275879
local_in_edges_tensor generation:  0.21659636497497559
mini_batch_src_global generation:  0.49776339530944824
r_  generation:  5.83575439453125
----------------------check_connections_block total spend ----------------------------- 14.78809380531311
generate_one_block  7.324509620666504
generate_one_block  7.021487474441528
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.049584627151489
gen group dst list time:  0.0904233455657959
time for parepare:  0.46348071098327637
local_output_nid generation:  0.2664647102355957
local_in_edges_tensor generation:  1.661987543106079
mini_batch_src_global generation:  2.503974199295044
r_  generation:  30.125681161880493
local_output_nid generation:  0.5689740180969238
local_in_edges_tensor generation:  2.0925915241241455
mini_batch_src_global generation:  3.7458739280700684
r_  generation:  30.0583438873291
----------------------check_connections_block total spend ----------------------------- 83.42074799537659
generate_one_block  41.25576376914978
generate_one_block  40.92054724693298
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.256833791732788
gen group dst list time:  0.20000815391540527
time for parepare:  0.494966983795166
local_output_nid generation:  0.4111628532409668
local_in_edges_tensor generation:  1.57265305519104
mini_batch_src_global generation:  2.020437479019165
r_  generation:  26.76474118232727
local_output_nid generation:  0.7362959384918213
local_in_edges_tensor generation:  1.9987797737121582
mini_batch_src_global generation:  2.8145217895507812
r_  generation:  26.424273252487183
----------------------check_connections_block total spend ----------------------------- 73.4878101348877
generate_one_block  35.214651346206665
generate_one_block  35.898850440979004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423706531524658  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.90855813026428
block generation total time  153.28981280326843
average batch blocks generation time:  76.64490640163422
block dataloader generation time/epoch 367.85949905411604
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3775433301925659 |1.2059710025787354 |0.004370212554931641 |0.00015413761138916016 |0.005179286003112793 |0.0015070438385009766 |
----------------------------------------------------------pseudo_mini_loss sum 0.33601808547973633
Total (block generation + training)time/epoch 371.69573129983894
Training time/epoch 3.600234031677246
Training time without block to device /epoch 1.1882920265197754
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.20it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.29it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.71it/s] 40%|████      | 10/25 [00:00<00:00, 17.90it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.07it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.39it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.53it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.76it/s] 80%|████████  | 20/25 [00:01<00:00, 17.99it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.88it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.98it/s]100%|██████████| 25/25 [00:01<00:00, 17.76it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.58it/s]  8%|▊         | 2/25 [00:00<00:03,  6.64it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.65it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.68it/s] 20%|██        | 5/25 [00:00<00:02,  6.71it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.70it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.68it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.69it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.69it/s] 40%|████      | 10/25 [00:01<00:02,  6.71it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.73it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.69it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.72it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.74it/s] 60%|██████    | 15/25 [00:02<00:01,  6.64it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.72it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.77it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.27it/s] 76%|███████▌  | 19/25 [00:02<00:01,  5.43it/s] 80%|████████  | 20/25 [00:03<00:00,  5.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.72it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.94it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.11it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.26it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.09it/s]  8%|▊         | 2/25 [00:00<00:03,  6.30it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.32it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.72it/s] 20%|██        | 5/25 [00:00<00:03,  5.98it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.14it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.26it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.35it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.39it/s] 40%|████      | 10/25 [00:01<00:02,  6.37it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.27it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.98it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.74it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.79it/s] 60%|██████    | 15/25 [00:02<00:01,  5.94it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.06it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.19it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.24it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.33it/s] 80%|████████  | 20/25 [00:03<00:00,  6.30it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.37it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.31it/s]
Run 00 | Epoch 00237 | Loss 0.3360 | Train 0.6938 | Val 0.6813 | Test 0.5453
Number of nodes during this epoch:  4636848
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422994136810303  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1365108489990234
range selection method range initialization spend 0.025020122528076172
time for parepare:  0.3706963062286377
local_output_nid generation:  0.026742935180664062
local_in_edges_tensor generation:  0.21540522575378418
mini_batch_src_global generation:  0.369842529296875
r_  generation:  5.611202716827393
local_output_nid generation:  0.029253482818603516
local_in_edges_tensor generation:  0.23291516304016113
mini_batch_src_global generation:  0.46289873123168945
r_  generation:  5.8255860805511475
----------------------check_connections_block total spend ----------------------------- 14.812003135681152
generate_one_block  7.184386730194092
generate_one_block  6.882915019989014
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9282681941986084
gen group dst list time:  0.09247016906738281
time for parepare:  0.465378999710083
local_output_nid generation:  0.2624695301055908
local_in_edges_tensor generation:  1.6695468425750732
mini_batch_src_global generation:  2.598665475845337
r_  generation:  30.58070969581604
local_output_nid generation:  0.5298328399658203
local_in_edges_tensor generation:  2.098923683166504
mini_batch_src_global generation:  3.7805087566375732
r_  generation:  29.925161600112915
----------------------check_connections_block total spend ----------------------------- 83.96088695526123
generate_one_block  41.23892903327942
generate_one_block  40.82002544403076
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3075621128082275
gen group dst list time:  0.18250751495361328
time for parepare:  0.4670429229736328
local_output_nid generation:  0.38522911071777344
local_in_edges_tensor generation:  1.5193078517913818
mini_batch_src_global generation:  2.162501096725464
r_  generation:  26.86742877960205
local_output_nid generation:  0.7311036586761475
local_in_edges_tensor generation:  2.0012123584747314
mini_batch_src_global generation:  2.8395309448242188
r_  generation:  26.193917274475098
----------------------check_connections_block total spend ----------------------------- 73.94573473930359
generate_one_block  35.421345710754395
generate_one_block  36.0541512966156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422994136810303  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.90662169456482
block generation total time  153.53445148468018
average batch blocks generation time:  76.76722574234009
block dataloader generation time/epoch 367.87006484260075
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38894903659820557 |1.3203012943267822 |0.00439298152923584 |0.00015163421630859375 |0.005101919174194336 |0.0017833709716796875 |
----------------------------------------------------------pseudo_mini_loss sum 0.3343605399131775
Total (block generation + training)time/epoch 371.7063414339258
Training time/epoch 3.8466105461120605
Training time without block to device /epoch 1.206007957458496
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.59it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.28it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.65it/s] 40%|████      | 10/25 [00:00<00:00, 17.88it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.08it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.02it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.06it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.13it/s] 80%|████████  | 20/25 [00:01<00:00, 18.16it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.17it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.19it/s]100%|██████████| 25/25 [00:01<00:00, 18.14it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:03,  6.50it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.53it/s] 20%|██        | 5/25 [00:00<00:03,  6.51it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.49it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.51it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.48it/s] 40%|████      | 10/25 [00:01<00:02,  6.09it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.76it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.57it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.45it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.38it/s] 60%|██████    | 15/25 [00:02<00:01,  5.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.29it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.26it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.24it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.22it/s] 80%|████████  | 20/25 [00:03<00:00,  5.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.05it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.07it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.00it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.38it/s]100%|██████████| 25/25 [00:04<00:00,  5.73it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.71it/s]  8%|▊         | 2/25 [00:00<00:03,  6.13it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.01it/s] 20%|██        | 5/25 [00:00<00:03,  6.14it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.02it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.11it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.14it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.17it/s] 40%|████      | 10/25 [00:01<00:02,  6.27it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.26it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.63it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.65it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.78it/s] 60%|██████    | 15/25 [00:02<00:01,  5.91it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.06it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.16it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.20it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.20it/s] 80%|████████  | 20/25 [00:03<00:00,  6.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.23it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.31it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:04<00:00,  7.12it/s]100%|██████████| 25/25 [00:04<00:00,  6.21it/s]
Run 00 | Epoch 00238 | Loss 0.3344 | Train 0.6945 | Val 0.6822 | Test 0.5462
Number of nodes during this epoch:  4637680
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428890228271484  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1773159503936768
range selection method range initialization spend 0.02682018280029297
time for parepare:  0.35807061195373535
local_output_nid generation:  0.026561498641967773
local_in_edges_tensor generation:  0.2234330177307129
mini_batch_src_global generation:  0.37096261978149414
r_  generation:  5.493671894073486
local_output_nid generation:  0.026941537857055664
local_in_edges_tensor generation:  0.2132430076599121
mini_batch_src_global generation:  0.46423840522766113
r_  generation:  5.619520902633667
----------------------check_connections_block total spend ----------------------------- 14.423626899719238
generate_one_block  7.318209409713745
generate_one_block  6.897338628768921
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.219778060913086
gen group dst list time:  0.08900785446166992
time for parepare:  0.4705996513366699
local_output_nid generation:  0.25910043716430664
local_in_edges_tensor generation:  1.7936375141143799
mini_batch_src_global generation:  2.4299778938293457
r_  generation:  29.78475856781006
local_output_nid generation:  0.519228458404541
local_in_edges_tensor generation:  2.0832345485687256
mini_batch_src_global generation:  3.5135316848754883
r_  generation:  30.089731216430664
----------------------check_connections_block total spend ----------------------------- 82.78427743911743
generate_one_block  41.02138876914978
generate_one_block  41.08571910858154
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.195793628692627
gen group dst list time:  0.19117474555969238
time for parepare:  0.4592459201812744
local_output_nid generation:  0.3949241638183594
local_in_edges_tensor generation:  1.5384266376495361
mini_batch_src_global generation:  2.169616222381592
r_  generation:  26.317577600479126
local_output_nid generation:  0.7182526588439941
local_in_edges_tensor generation:  1.9135515689849854
mini_batch_src_global generation:  2.8282418251037598
r_  generation:  26.016596794128418
----------------------check_connections_block total spend ----------------------------- 72.30119514465332
generate_one_block  35.23075032234192
generate_one_block  35.96782326698303
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428890228271484  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.08547258377075
block generation total time  153.30568146705627
average batch blocks generation time:  76.65284073352814
block dataloader generation time/epoch 367.86555424095695
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3764535188674927 |1.2928630113601685 |0.004421353340148926 |0.00014793872833251953 |0.0050470829010009766 |0.0014913082122802734 |
----------------------------------------------------------pseudo_mini_loss sum 0.334494411945343
Total (block generation + training)time/epoch 371.70156778152017
Training time/epoch 3.77323055267334
Training time without block to device /epoch 1.187504529953003
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.24it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.74it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.87it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.31it/s] 40%|████      | 10/25 [00:00<00:00, 17.62it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.92it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.06it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.16it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.24it/s] 80%|████████  | 20/25 [00:01<00:00, 18.31it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.31it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.32it/s]100%|██████████| 25/25 [00:01<00:00, 18.15it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.70it/s]  8%|▊         | 2/25 [00:00<00:03,  6.74it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.76it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.78it/s] 20%|██        | 5/25 [00:00<00:02,  6.82it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.80it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.77it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.81it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.76it/s] 40%|████      | 10/25 [00:01<00:02,  6.76it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.82it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.82it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.86it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.89it/s] 60%|██████    | 15/25 [00:02<00:01,  6.87it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.87it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.84it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.86it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.84it/s] 80%|████████  | 20/25 [00:03<00:00,  5.95it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.81it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.88it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.02it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.00it/s]100%|██████████| 25/25 [00:03<00:00,  6.78it/s]100%|██████████| 25/25 [00:03<00:00,  6.61it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.10it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.50it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.10it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.75it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.39it/s] 40%|████      | 10/25 [00:01<00:02,  5.20it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.14it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.09it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.10it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.12it/s] 60%|██████    | 15/25 [00:02<00:01,  5.01it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.05it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.18it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.99it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.28it/s] 80%|████████  | 20/25 [00:03<00:00,  5.14it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.20it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.14it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.04it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.95it/s]100%|██████████| 25/25 [00:04<00:00,  5.80it/s]100%|██████████| 25/25 [00:04<00:00,  5.41it/s]
Run 00 | Epoch 00239 | Loss 0.3345 | Train 0.6942 | Val 0.6816 | Test 0.5458
Number of nodes during this epoch:  4638156
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4269490242004395  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1347510814666748
range selection method range initialization spend 0.025034666061401367
time for parepare:  0.36279892921447754
local_output_nid generation:  0.028006315231323242
local_in_edges_tensor generation:  0.19045400619506836
mini_batch_src_global generation:  0.3696615695953369
r_  generation:  5.447789430618286
local_output_nid generation:  0.02768087387084961
local_in_edges_tensor generation:  0.2423384189605713
mini_batch_src_global generation:  0.4880406856536865
r_  generation:  5.634099960327148
----------------------check_connections_block total spend ----------------------------- 14.486950397491455
generate_one_block  7.205176591873169
generate_one_block  6.960242033004761
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.162547826766968
gen group dst list time:  0.0915229320526123
time for parepare:  0.44202399253845215
local_output_nid generation:  0.27308225631713867
local_in_edges_tensor generation:  1.7927978038787842
mini_batch_src_global generation:  2.4438204765319824
r_  generation:  29.533573627471924
local_output_nid generation:  0.515831708908081
local_in_edges_tensor generation:  2.182673215866089
mini_batch_src_global generation:  3.4787259101867676
r_  generation:  29.733203172683716
----------------------check_connections_block total spend ----------------------------- 82.25519394874573
generate_one_block  40.76562142372131
generate_one_block  40.92776370048523
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1654224395751953
gen group dst list time:  0.189849853515625
time for parepare:  0.4389824867248535
local_output_nid generation:  0.4011526107788086
local_in_edges_tensor generation:  1.4773809909820557
mini_batch_src_global generation:  2.0157361030578613
r_  generation:  25.369901180267334
local_output_nid generation:  0.7261407375335693
local_in_edges_tensor generation:  1.9619419574737549
mini_batch_src_global generation:  2.837597370147705
r_  generation:  26.03020453453064
----------------------check_connections_block total spend ----------------------------- 71.32379651069641
generate_one_block  34.810380697250366
generate_one_block  35.84787845611572
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4269490242004395  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.57899045944214
block generation total time  152.35164427757263
average batch blocks generation time:  76.17582213878632
block dataloader generation time/epoch 367.85355661213396
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38734543323516846 |1.313019037246704 |0.004385709762573242 |0.00015354156494140625 |0.005048036575317383 |0.0029954910278320312 |
----------------------------------------------------------pseudo_mini_loss sum 0.33343058824539185
Total (block generation + training)time/epoch 371.68954090376695
Training time/epoch 3.8288161754608154
Training time without block to device /epoch 1.2027781009674072
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.11it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.57it/s] 40%|████      | 10/25 [00:00<00:01, 13.98it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.02it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.63it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.18it/s] 80%|████████  | 20/25 [00:01<00:00, 17.56it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.84it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.72it/s]100%|██████████| 25/25 [00:01<00:00, 17.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.50it/s]  8%|▊         | 2/25 [00:00<00:03,  6.59it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.66it/s] 20%|██        | 5/25 [00:00<00:02,  6.68it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.11it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.78it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.55it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.21it/s] 40%|████      | 10/25 [00:01<00:02,  5.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.59it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.77it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.66it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.71it/s] 60%|██████    | 15/25 [00:02<00:01,  5.74it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.83it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.98it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.13it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.23it/s] 80%|████████  | 20/25 [00:03<00:00,  6.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.51it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.52it/s]100%|██████████| 25/25 [00:04<00:00,  6.16it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.34it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.28it/s] 20%|██        | 5/25 [00:00<00:03,  6.31it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.39it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.45it/s] 40%|████      | 10/25 [00:01<00:02,  6.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.44it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.47it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.45it/s] 60%|██████    | 15/25 [00:02<00:01,  6.29it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.94it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.94it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.87it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.92it/s] 80%|████████  | 20/25 [00:03<00:00,  6.02it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.16it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.23it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.30it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.34it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]
Run 00 | Epoch 00240 | Loss 0.3334 | Train 0.6921 | Val 0.6797 | Test 0.5451
Number of nodes during this epoch:  4637621
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427886486053467  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1886370182037354
range selection method range initialization spend 0.036702632904052734
time for parepare:  0.37122535705566406
local_output_nid generation:  0.026741981506347656
local_in_edges_tensor generation:  0.20502209663391113
mini_batch_src_global generation:  0.3716294765472412
r_  generation:  5.455697774887085
local_output_nid generation:  0.041181087493896484
local_in_edges_tensor generation:  0.21514391899108887
mini_batch_src_global generation:  0.48595261573791504
r_  generation:  5.860859394073486
----------------------check_connections_block total spend ----------------------------- 14.699116706848145
generate_one_block  7.24739146232605
generate_one_block  7.102894067764282
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.007921457290649
gen group dst list time:  0.11050653457641602
time for parepare:  0.46630191802978516
local_output_nid generation:  0.2618710994720459
local_in_edges_tensor generation:  1.7816238403320312
mini_batch_src_global generation:  2.5294384956359863
r_  generation:  29.920830488204956
local_output_nid generation:  0.5271317958831787
local_in_edges_tensor generation:  2.1888108253479004
mini_batch_src_global generation:  3.501215934753418
r_  generation:  30.00571870803833
----------------------check_connections_block total spend ----------------------------- 83.18117260932922
generate_one_block  40.99215221405029
generate_one_block  41.06076955795288
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2922134399414062
gen group dst list time:  0.19688081741333008
time for parepare:  0.4811854362487793
local_output_nid generation:  0.39792537689208984
local_in_edges_tensor generation:  1.516860008239746
mini_batch_src_global generation:  2.1880908012390137
r_  generation:  26.181506395339966
local_output_nid generation:  0.7676901817321777
local_in_edges_tensor generation:  1.9532551765441895
mini_batch_src_global generation:  2.898341178894043
r_  generation:  26.097742080688477
----------------------check_connections_block total spend ----------------------------- 72.4625952243805
generate_one_block  35.25225591659546
generate_one_block  36.19367742538452
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427886486053467  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.64376783370972
block generation total time  153.49885511398315
average batch blocks generation time:  76.74942755699158
block dataloader generation time/epoch 367.85677474959755
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3891007900238037 |1.4296473264694214 |0.004875779151916504 |0.00018095970153808594 |0.005175948143005371 |0.004027366638183594 |
----------------------------------------------------------pseudo_mini_loss sum 0.3339085578918457
Total (block generation + training)time/epoch 371.6937286458075
Training time/epoch 4.06947922706604
Training time without block to device /epoch 1.2101845741271973
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.73it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.97it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.17it/s] 40%|████      | 10/25 [00:00<00:00, 17.60it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.85it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.51it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.48it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.53it/s] 80%|████████  | 20/25 [00:01<00:00, 17.73it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.84it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.93it/s]100%|██████████| 25/25 [00:01<00:00, 17.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.14it/s]  8%|▊         | 2/25 [00:00<00:04,  5.08it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.69it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.09it/s] 20%|██        | 5/25 [00:00<00:03,  5.70it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.48it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.41it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.30it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.13it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.12it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.72it/s] 60%|██████    | 15/25 [00:02<00:01,  5.96it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.17it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.51it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.59it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.58it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.62it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.60it/s]100%|██████████| 25/25 [00:04<00:00,  5.99it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.03it/s]  8%|▊         | 2/25 [00:00<00:03,  6.33it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.86it/s] 20%|██        | 5/25 [00:00<00:03,  6.05it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.25it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.32it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.55it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.07it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.74it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.53it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.40it/s] 60%|██████    | 15/25 [00:02<00:01,  5.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.27it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.49it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.77it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.01it/s] 80%|████████  | 20/25 [00:03<00:00,  6.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.26it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.08it/s]100%|██████████| 25/25 [00:04<00:00,  6.10it/s]
Run 00 | Epoch 00241 | Loss 0.3339 | Train 0.6893 | Val 0.6771 | Test 0.5438
Number of nodes during this epoch:  4637618
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427325248718262  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.144794225692749
range selection method range initialization spend 0.02407240867614746
time for parepare:  0.37340497970581055
local_output_nid generation:  0.02616262435913086
local_in_edges_tensor generation:  0.26250123977661133
mini_batch_src_global generation:  0.3805577754974365
r_  generation:  5.409297227859497
local_output_nid generation:  0.028138160705566406
local_in_edges_tensor generation:  0.1935412883758545
mini_batch_src_global generation:  0.45531487464904785
r_  generation:  5.562803030014038
----------------------check_connections_block total spend ----------------------------- 14.350232362747192
generate_one_block  7.268206596374512
generate_one_block  6.925257682800293
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.907332420349121
gen group dst list time:  0.08833432197570801
time for parepare:  0.45615649223327637
local_output_nid generation:  0.2794675827026367
local_in_edges_tensor generation:  1.6196990013122559
mini_batch_src_global generation:  2.5126824378967285
r_  generation:  29.993114471435547
local_output_nid generation:  0.5347819328308105
local_in_edges_tensor generation:  2.0884015560150146
mini_batch_src_global generation:  3.507875919342041
r_  generation:  30.018315076828003
----------------------check_connections_block total spend ----------------------------- 83.10993814468384
generate_one_block  40.99804139137268
generate_one_block  41.08108305931091
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.205416679382324
gen group dst list time:  0.1973576545715332
time for parepare:  0.4651663303375244
local_output_nid generation:  0.4210166931152344
local_in_edges_tensor generation:  1.5455336570739746
mini_batch_src_global generation:  2.0545547008514404
r_  generation:  25.94731593132019
local_output_nid generation:  0.7343192100524902
local_in_edges_tensor generation:  1.8957078456878662
mini_batch_src_global generation:  2.8083934783935547
r_  generation:  25.99189281463623
----------------------check_connections_block total spend ----------------------------- 71.77791619300842
generate_one_block  35.14706587791443
generate_one_block  35.80282402038574
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427325248718262  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.88785433769226
block generation total time  153.02901434898376
average batch blocks generation time:  76.51450717449188
block dataloader generation time/epoch 367.85096910078664
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3695117235183716 |1.2844253778457642 |0.004389166831970215 |0.00015151500701904297 |0.005000114440917969 |0.002626180648803711 |
----------------------------------------------------------pseudo_mini_loss sum 0.33297887444496155
Total (block generation + training)time/epoch 371.68751166477676
Training time/epoch 3.737236976623535
Training time without block to device /epoch 1.1683862209320068
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.77it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.83it/s] 40%|████      | 10/25 [00:00<00:00, 17.93it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.76it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.88it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.86it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.66it/s] 80%|████████  | 20/25 [00:01<00:00, 17.49it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.43it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.51it/s]100%|██████████| 25/25 [00:01<00:00, 17.74it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.08it/s]  8%|▊         | 2/25 [00:00<00:04,  5.07it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.10it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.12it/s] 20%|██        | 5/25 [00:00<00:03,  5.12it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.13it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.14it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.14it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.13it/s] 40%|████      | 10/25 [00:01<00:02,  5.14it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.14it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.13it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.13it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.12it/s] 60%|██████    | 15/25 [00:02<00:01,  5.10it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.10it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.96it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.01it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.97it/s] 80%|████████  | 20/25 [00:03<00:00,  5.02it/s] 84%|████████▍ | 21/25 [00:04<00:00,  4.88it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.26it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.64it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.74it/s]100%|██████████| 25/25 [00:04<00:00,  6.16it/s]100%|██████████| 25/25 [00:04<00:00,  5.25it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.26it/s]  8%|▊         | 2/25 [00:00<00:04,  5.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.97it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.62it/s] 20%|██        | 5/25 [00:00<00:03,  5.38it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.17it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.02it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.23it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.62it/s] 40%|████      | 10/25 [00:01<00:02,  5.40it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.30it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.90it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.78it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.08it/s] 60%|██████    | 15/25 [00:02<00:01,  5.46it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.74it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.91it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.63it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.43it/s] 80%|████████  | 20/25 [00:03<00:00,  5.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.51it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.82it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.07it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.74it/s]100%|██████████| 25/25 [00:04<00:00,  6.01it/s]100%|██████████| 25/25 [00:04<00:00,  5.48it/s]
Run 00 | Epoch 00242 | Loss 0.3330 | Train 0.6873 | Val 0.6754 | Test 0.5423
Number of nodes during this epoch:  4637288
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423572540283203  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.139735460281372
range selection method range initialization spend 0.03706216812133789
time for parepare:  0.37424635887145996
local_output_nid generation:  0.02633523941040039
local_in_edges_tensor generation:  0.22058892250061035
mini_batch_src_global generation:  0.3768959045410156
r_  generation:  5.690457582473755
local_output_nid generation:  0.02906489372253418
local_in_edges_tensor generation:  0.2371201515197754
mini_batch_src_global generation:  0.4658026695251465
r_  generation:  5.9329893589019775
----------------------check_connections_block total spend ----------------------------- 15.0617196559906
generate_one_block  7.2488932609558105
generate_one_block  6.976642608642578
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0537354946136475
gen group dst list time:  0.08827686309814453
time for parepare:  0.45102715492248535
local_output_nid generation:  0.2686176300048828
local_in_edges_tensor generation:  1.6770496368408203
mini_batch_src_global generation:  2.548595905303955
r_  generation:  30.002305269241333
local_output_nid generation:  0.5432920455932617
local_in_edges_tensor generation:  2.2929329872131348
mini_batch_src_global generation:  3.7648770809173584
r_  generation:  30.135200262069702
----------------------check_connections_block total spend ----------------------------- 83.67834877967834
generate_one_block  40.874181270599365
generate_one_block  40.90637564659119
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.289703369140625
gen group dst list time:  0.17999863624572754
time for parepare:  0.4466884136199951
local_output_nid generation:  0.38140392303466797
local_in_edges_tensor generation:  1.4940319061279297
mini_batch_src_global generation:  2.021519899368286
r_  generation:  25.337363958358765
local_output_nid generation:  0.7265949249267578
local_in_edges_tensor generation:  1.9125909805297852
mini_batch_src_global generation:  2.998645067214966
r_  generation:  25.61125135421753
----------------------check_connections_block total spend ----------------------------- 70.91607093811035
generate_one_block  35.14548850059509
generate_one_block  35.82646560668945
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423572540283203  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.5944197177887
block generation total time  152.7525110244751
average batch blocks generation time:  76.37625551223755
block dataloader generation time/epoch 367.84441190393864
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3832728862762451 |1.297852873802185 |0.004504561424255371 |0.0001474618911743164 |0.00507199764251709 |0.0014400482177734375 |
----------------------------------------------------------pseudo_mini_loss sum 0.33496126532554626
Total (block generation + training)time/epoch 371.6807740117297
Training time/epoch 3.7923526763916016
Training time without block to device /epoch 1.1966469287872314
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.36it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.85it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.29it/s] 40%|████      | 10/25 [00:00<00:00, 17.51it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.78it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.88it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.00it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.05it/s] 80%|████████  | 20/25 [00:01<00:00, 18.13it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.13it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.00it/s]100%|██████████| 25/25 [00:01<00:00, 18.01it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.21it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.52it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.45it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.45it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.49it/s] 40%|████      | 10/25 [00:01<00:02,  6.53it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.52it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.49it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.46it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.35it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:03<00:00,  7.10it/s]100%|██████████| 25/25 [00:03<00:00,  6.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.37it/s] 20%|██        | 5/25 [00:00<00:03,  6.38it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.30it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.31it/s] 40%|████      | 10/25 [00:01<00:02,  6.30it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.32it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.32it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.31it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.31it/s] 60%|██████    | 15/25 [00:02<00:01,  6.30it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.32it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.32it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.36it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.18it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.03it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.76it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.78it/s]100%|██████████| 25/25 [00:03<00:00,  6.58it/s]100%|██████████| 25/25 [00:03<00:00,  6.29it/s]
Run 00 | Epoch 00243 | Loss 0.3350 | Train 0.6885 | Val 0.6769 | Test 0.5428
Number of nodes during this epoch:  4637038
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430679798126221  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1153016090393066
range selection method range initialization spend 0.024277925491333008
time for parepare:  0.3638739585876465
local_output_nid generation:  0.026080608367919922
local_in_edges_tensor generation:  0.1857447624206543
mini_batch_src_global generation:  0.37137484550476074
r_  generation:  5.613225698471069
local_output_nid generation:  0.027904987335205078
local_in_edges_tensor generation:  0.21292996406555176
mini_batch_src_global generation:  0.4637119770050049
r_  generation:  6.168904542922974
----------------------check_connections_block total spend ----------------------------- 15.120367765426636
generate_one_block  7.5048987865448
generate_one_block  7.201082706451416
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.145910739898682
gen group dst list time:  0.08774495124816895
time for parepare:  0.4592244625091553
local_output_nid generation:  0.2598683834075928
local_in_edges_tensor generation:  1.785893440246582
mini_batch_src_global generation:  2.4502086639404297
r_  generation:  30.785167694091797
local_output_nid generation:  0.5391519069671631
local_in_edges_tensor generation:  2.19783091545105
mini_batch_src_global generation:  3.5074374675750732
r_  generation:  30.27716302871704
----------------------check_connections_block total spend ----------------------------- 85.08386611938477
generate_one_block  41.27164840698242
generate_one_block  41.25972032546997
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1408557891845703
gen group dst list time:  0.18982243537902832
time for parepare:  0.45397090911865234
local_output_nid generation:  0.415311336517334
local_in_edges_tensor generation:  1.4939656257629395
mini_batch_src_global generation:  2.201868772506714
r_  generation:  26.97208285331726
local_output_nid generation:  0.7580091953277588
local_in_edges_tensor generation:  1.9298810958862305
mini_batch_src_global generation:  3.061661958694458
r_  generation:  27.181490659713745
----------------------check_connections_block total spend ----------------------------- 75.21135210990906
generate_one_block  37.03206968307495
generate_one_block  37.55922174453735
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.430679798126221  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  160.29521822929382
block generation total time  157.1226601600647
average batch blocks generation time:  78.56133008003235
block dataloader generation time/epoch 367.88287849015876
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5735461711883545 |1.4504445791244507 |0.004837632179260254 |0.0001678466796875 |0.005168795585632324 |0.0029458999633789062 |
----------------------------------------------------------pseudo_mini_loss sum 0.33336877822875977
Total (block generation + training)time/epoch 371.72189520617
Training time/epoch 4.483904600143433
Training time without block to device /epoch 1.5830154418945312
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.91it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.23it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.92it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.27it/s] 40%|████      | 10/25 [00:00<00:00, 16.39it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.49it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.52it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.60it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.58it/s] 80%|████████  | 20/25 [00:01<00:00, 16.64it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.34it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.34it/s]100%|██████████| 25/25 [00:01<00:00, 16.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.08it/s]  8%|▊         | 2/25 [00:00<00:03,  6.12it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.15it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.19it/s] 20%|██        | 5/25 [00:00<00:03,  6.16it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.17it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.18it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.18it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.18it/s] 40%|████      | 10/25 [00:01<00:02,  6.17it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.17it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.18it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.17it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.16it/s] 60%|██████    | 15/25 [00:02<00:01,  6.17it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.17it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.15it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.17it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.17it/s] 80%|████████  | 20/25 [00:03<00:00,  6.04it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.82it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.62it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.44it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.43it/s]100%|██████████| 25/25 [00:04<00:00,  6.19it/s]100%|██████████| 25/25 [00:04<00:00,  6.06it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.74it/s]  8%|▊         | 2/25 [00:00<00:03,  5.90it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.99it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.05it/s] 20%|██        | 5/25 [00:00<00:03,  6.10it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.11it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.14it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.16it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.13it/s] 40%|████      | 10/25 [00:01<00:02,  6.13it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.10it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.12it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.14it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.14it/s] 60%|██████    | 15/25 [00:02<00:01,  6.13it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.14it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.80it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.75it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.66it/s] 80%|████████  | 20/25 [00:03<00:00,  5.71it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.81it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.87it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.90it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.96it/s]100%|██████████| 25/25 [00:04<00:00,  6.71it/s]100%|██████████| 25/25 [00:04<00:00,  6.08it/s]
Run 00 | Epoch 00244 | Loss 0.3334 | Train 0.6917 | Val 0.6788 | Test 0.5443
Number of nodes during this epoch:  4637998
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424764156341553  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.221999168395996
range selection method range initialization spend 0.028958797454833984
time for parepare:  0.5082542896270752
local_output_nid generation:  0.028326988220214844
local_in_edges_tensor generation:  0.21945834159851074
mini_batch_src_global generation:  0.3759188652038574
r_  generation:  5.679791450500488
local_output_nid generation:  0.03028559684753418
local_in_edges_tensor generation:  0.23789572715759277
mini_batch_src_global generation:  0.46659207344055176
r_  generation:  5.983882904052734
----------------------check_connections_block total spend ----------------------------- 15.24241590499878
generate_one_block  7.560699701309204
generate_one_block  7.323927402496338
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.103004455566406
gen group dst list time:  0.08806562423706055
time for parepare:  0.440051794052124
local_output_nid generation:  0.2630341053009033
local_in_edges_tensor generation:  1.6814959049224854
mini_batch_src_global generation:  2.588491201400757
r_  generation:  29.902112007141113
local_output_nid generation:  0.5254456996917725
local_in_edges_tensor generation:  2.185934066772461
mini_batch_src_global generation:  3.5638020038604736
r_  generation:  29.80046010017395
----------------------check_connections_block total spend ----------------------------- 83.23307490348816
generate_one_block  40.55329918861389
generate_one_block  40.861823320388794
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2164981365203857
gen group dst list time:  0.1883833408355713
time for parepare:  0.47312021255493164
local_output_nid generation:  0.40844202041625977
local_in_edges_tensor generation:  1.638852596282959
mini_batch_src_global generation:  2.0692405700683594
r_  generation:  26.506482362747192
local_output_nid generation:  0.7413978576660156
local_in_edges_tensor generation:  2.0082788467407227
mini_batch_src_global generation:  3.0561933517456055
r_  generation:  27.051398515701294
----------------------check_connections_block total spend ----------------------------- 74.57777953147888
generate_one_block  36.986284017562866
generate_one_block  37.71310472488403
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424764156341553  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.81085443496704
block generation total time  156.11451125144958
average batch blocks generation time:  78.05725562572479
block dataloader generation time/epoch 367.91100617330903
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5486615896224976 |1.4454115629196167 |0.005082607269287109 |0.00018846988677978516 |0.005126953125 |0.0028829574584960938 |
----------------------------------------------------------pseudo_mini_loss sum 0.33446991443634033
Total (block generation + training)time/epoch 371.7525144907893
Training time/epoch 4.449239730834961
Training time without block to device /epoch 1.5584166049957275
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.31it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.12it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.56it/s] 40%|████      | 10/25 [00:00<00:01, 13.47it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.59it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.34it/s] 64%|██████▍   | 16/25 [00:01<00:00, 15.94it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.27it/s] 80%|████████  | 20/25 [00:01<00:00, 15.79it/s] 88%|████████▊ | 22/25 [00:01<00:00, 15.15it/s] 96%|█████████▌| 24/25 [00:01<00:00, 15.05it/s]100%|██████████| 25/25 [00:01<00:00, 15.50it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.09it/s]  8%|▊         | 2/25 [00:00<00:04,  5.17it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.13it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.17it/s] 20%|██        | 5/25 [00:00<00:03,  5.59it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.88it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.05it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.21it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.31it/s] 40%|████      | 10/25 [00:01<00:02,  6.37it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.34it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.39it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.43it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.47it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.43it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.90it/s]100%|██████████| 25/25 [00:04<00:00,  6.45it/s]100%|██████████| 25/25 [00:04<00:00,  6.19it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.86it/s]  8%|▊         | 2/25 [00:00<00:04,  5.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.92it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.02it/s] 20%|██        | 5/25 [00:00<00:03,  6.07it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.11it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.09it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.06it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.09it/s] 40%|████      | 10/25 [00:01<00:02,  6.03it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.05it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.00it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.01it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.07it/s] 60%|██████    | 15/25 [00:02<00:01,  6.12it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.18it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.19it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.22it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.06it/s] 80%|████████  | 20/25 [00:03<00:00,  6.18it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.24it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.30it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.33it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.35it/s]100%|██████████| 25/25 [00:04<00:00,  6.21it/s]
Run 00 | Epoch 00245 | Loss 0.3345 | Train 0.6921 | Val 0.6784 | Test 0.5448
Number of nodes during this epoch:  4637809
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422476768493652  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1625571250915527
range selection method range initialization spend 0.024569988250732422
time for parepare:  0.3731391429901123
local_output_nid generation:  0.026488065719604492
local_in_edges_tensor generation:  0.21808934211730957
mini_batch_src_global generation:  0.38088369369506836
r_  generation:  5.673776865005493
local_output_nid generation:  0.029077529907226562
local_in_edges_tensor generation:  0.2353959083557129
mini_batch_src_global generation:  0.4685204029083252
r_  generation:  5.910287141799927
----------------------check_connections_block total spend ----------------------------- 14.99231743812561
generate_one_block  7.2502758502960205
generate_one_block  6.906562566757202
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.045469760894775
gen group dst list time:  0.08980679512023926
time for parepare:  0.4405543804168701
local_output_nid generation:  0.2587165832519531
local_in_edges_tensor generation:  1.628312110900879
mini_batch_src_global generation:  2.59639048576355
r_  generation:  30.17121648788452
local_output_nid generation:  0.5402114391326904
local_in_edges_tensor generation:  2.082310199737549
mini_batch_src_global generation:  3.5062127113342285
r_  generation:  30.197864055633545
----------------------check_connections_block total spend ----------------------------- 83.51123547554016
generate_one_block  40.930084466934204
generate_one_block  40.84417104721069
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.176690101623535
gen group dst list time:  0.18990850448608398
time for parepare:  0.4732646942138672
local_output_nid generation:  0.3961293697357178
local_in_edges_tensor generation:  1.4719977378845215
mini_batch_src_global generation:  2.0198190212249756
r_  generation:  25.572168350219727
local_output_nid generation:  0.7494001388549805
local_in_edges_tensor generation:  1.9540159702301025
mini_batch_src_global generation:  2.8677375316619873
r_  generation:  26.002888441085815
----------------------check_connections_block total spend ----------------------------- 71.75500822067261
generate_one_block  35.40714406967163
generate_one_block  35.67521548271179
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422476768493652  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.26624369621277
block generation total time  152.85661506652832
average batch blocks generation time:  76.42830753326416
block dataloader generation time/epoch 367.90774680928484
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38215184211730957 |1.3619725704193115 |0.004404425621032715 |0.00014865398406982422 |0.005202889442443848 |0.0015773773193359375 |
----------------------------------------------------------pseudo_mini_loss sum 0.3338918685913086
Total (block generation + training)time/epoch 371.7495613737804
Training time/epoch 3.916660785675049
Training time without block to device /epoch 1.1927156448364258
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.80it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.48it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.01it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.31it/s] 40%|████      | 10/25 [00:00<00:00, 17.40it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.46it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.50it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.53it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.28it/s] 80%|████████  | 20/25 [00:01<00:00, 17.34it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.44it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.67it/s]100%|██████████| 25/25 [00:01<00:00, 17.34it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.38it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.44it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.43it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.42it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.43it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.47it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.39it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.46it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.45it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.45it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.70it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.24it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  6.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.43it/s] 40%|████      | 10/25 [00:01<00:02,  6.43it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.43it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.43it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.42it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.39it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.28it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.28it/s]100%|██████████| 25/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
Run 00 | Epoch 00246 | Loss 0.3339 | Train 0.6901 | Val 0.6772 | Test 0.5443
Number of nodes during this epoch:  4637472
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424991130828857  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0837960243225098
range selection method range initialization spend 0.025159597396850586
time for parepare:  0.3752861022949219
local_output_nid generation:  0.034001827239990234
local_in_edges_tensor generation:  0.2512364387512207
mini_batch_src_global generation:  0.38060474395751953
r_  generation:  5.4154133796691895
local_output_nid generation:  0.028163433074951172
local_in_edges_tensor generation:  0.19167208671569824
mini_batch_src_global generation:  0.4557919502258301
r_  generation:  5.531928539276123
----------------------check_connections_block total spend ----------------------------- 14.379209518432617
generate_one_block  7.112699031829834
generate_one_block  7.166645288467407
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.037123918533325
gen group dst list time:  0.09332680702209473
time for parepare:  0.45703673362731934
local_output_nid generation:  0.276216983795166
local_in_edges_tensor generation:  1.8039076328277588
mini_batch_src_global generation:  2.5210399627685547
r_  generation:  29.940255880355835
local_output_nid generation:  0.5241804122924805
local_in_edges_tensor generation:  2.149493932723999
mini_batch_src_global generation:  3.5197219848632812
r_  generation:  30.271766901016235
----------------------check_connections_block total spend ----------------------------- 83.64129328727722
generate_one_block  40.9349160194397
generate_one_block  41.03234362602234
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1739249229431152
gen group dst list time:  0.18688488006591797
time for parepare:  0.4666748046875
local_output_nid generation:  0.38509154319763184
local_in_edges_tensor generation:  1.5410137176513672
mini_batch_src_global generation:  2.0588767528533936
r_  generation:  26.076343774795532
local_output_nid generation:  0.728665828704834
local_in_edges_tensor generation:  1.8754115104675293
mini_batch_src_global generation:  2.8121724128723145
r_  generation:  26.045824766159058
----------------------check_connections_block total spend ----------------------------- 71.94699740409851
generate_one_block  35.01755928993225
generate_one_block  35.77325510978699
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424991130828857  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.58829069137573
block generation total time  152.75807404518127
average batch blocks generation time:  76.37903702259064
block dataloader generation time/epoch 367.90311240667273
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3754119873046875 |1.2761870622634888 |0.004354119300842285 |0.00014793872833251953 |0.005111575126647949 |0.003192424774169922 |
----------------------------------------------------------pseudo_mini_loss sum 0.33288756012916565
Total (block generation + training)time/epoch 371.74448541108416
Training time/epoch 3.732572317123413
Training time without block to device /epoch 1.1801981925964355
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.17it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.41it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.07it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.51it/s] 40%|████      | 10/25 [00:00<00:00, 17.69it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.89it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.02it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.95it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.90it/s] 80%|████████  | 20/25 [00:01<00:00, 17.81it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.82it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.58it/s]100%|██████████| 25/25 [00:01<00:00, 17.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.57it/s]  8%|▊         | 2/25 [00:00<00:03,  6.70it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.72it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.71it/s] 20%|██        | 5/25 [00:00<00:03,  6.13it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.73it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.49it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.06it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.33it/s] 40%|████      | 10/25 [00:01<00:02,  5.62it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.22it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.35it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.59it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.84it/s] 60%|██████    | 15/25 [00:02<00:01,  6.04it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.24it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.83it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.01it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.21it/s] 80%|████████  | 20/25 [00:03<00:00,  6.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.03it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.70it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.58it/s]100%|██████████| 25/25 [00:04<00:00,  5.98it/s]100%|██████████| 25/25 [00:04<00:00,  5.87it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.32it/s]  8%|▊         | 2/25 [00:00<00:03,  6.53it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.59it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.56it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.57it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.02it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.87it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.92it/s] 40%|████      | 10/25 [00:01<00:02,  6.08it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.13it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.25it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.33it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.40it/s] 60%|██████    | 15/25 [00:02<00:01,  6.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.34it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.30it/s] 80%|████████  | 20/25 [00:03<00:00,  6.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.38it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.40it/s]100%|██████████| 25/25 [00:03<00:00,  6.42it/s]
Run 00 | Epoch 00247 | Loss 0.3329 | Train 0.6885 | Val 0.6763 | Test 0.5439
Number of nodes during this epoch:  4638139
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428380966186523  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1853938102722168
range selection method range initialization spend 0.026224374771118164
time for parepare:  0.38243865966796875
local_output_nid generation:  0.02906513214111328
local_in_edges_tensor generation:  0.23250913619995117
mini_batch_src_global generation:  0.3748912811279297
r_  generation:  5.614638566970825
local_output_nid generation:  0.02905440330505371
local_in_edges_tensor generation:  0.23553133010864258
mini_batch_src_global generation:  0.471820592880249
r_  generation:  5.901574373245239
----------------------check_connections_block total spend ----------------------------- 14.997851610183716
generate_one_block  7.205188274383545
generate_one_block  6.924738645553589
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9889755249023438
gen group dst list time:  0.08922886848449707
time for parepare:  0.4732997417449951
local_output_nid generation:  0.26810216903686523
local_in_edges_tensor generation:  1.6236543655395508
mini_batch_src_global generation:  2.5731914043426514
r_  generation:  30.412412405014038
local_output_nid generation:  0.5408792495727539
local_in_edges_tensor generation:  2.1150264739990234
mini_batch_src_global generation:  3.511223554611206
r_  generation:  30.614975690841675
----------------------check_connections_block total spend ----------------------------- 84.30624079704285
generate_one_block  41.24866247177124
generate_one_block  41.24646830558777
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.228851318359375
gen group dst list time:  0.18817400932312012
time for parepare:  0.464932918548584
local_output_nid generation:  0.39649271965026855
local_in_edges_tensor generation:  1.5121564865112305
mini_batch_src_global generation:  2.1160988807678223
r_  generation:  26.301717042922974
local_output_nid generation:  0.7679598331451416
local_in_edges_tensor generation:  1.9450840950012207
mini_batch_src_global generation:  2.8945629596710205
r_  generation:  26.193685293197632
----------------------check_connections_block total spend ----------------------------- 72.58156228065491
generate_one_block  35.29436635971069
generate_one_block  36.195903062820435
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428380966186523  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.88780307769775
block generation total time  153.98540019989014
average batch blocks generation time:  76.99270009994507
block dataloader generation time/epoch 367.91128539366105
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.380426287651062 |1.3029025793075562 |0.0044471025466918945 |0.000148773193359375 |0.005061626434326172 |0.0031690597534179688 |
----------------------------------------------------------pseudo_mini_loss sum 0.3321099877357483
Total (block generation + training)time/epoch 371.75248060399485
Training time/epoch 3.7971014976501465
Training time without block to device /epoch 1.1912963390350342
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.98it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.59it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.87it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.13it/s] 40%|████      | 10/25 [00:00<00:00, 17.40it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.64it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.76it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.81it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.90it/s] 80%|████████  | 20/25 [00:01<00:00, 17.80it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.98it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.07it/s]100%|██████████| 25/25 [00:01<00:00, 17.84it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.68it/s]  8%|▊         | 2/25 [00:00<00:03,  6.73it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.69it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.66it/s] 20%|██        | 5/25 [00:00<00:03,  6.05it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.69it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.27it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.40it/s] 40%|████      | 10/25 [00:01<00:02,  5.62it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.85it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.80it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.91it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.02it/s] 60%|██████    | 15/25 [00:02<00:01,  5.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.78it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.02it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.22it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.49it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.02it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.62it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.41it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.26it/s]100%|██████████| 25/25 [00:04<00:00,  5.81it/s]100%|██████████| 25/25 [00:04<00:00,  5.84it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.77it/s]  8%|▊         | 2/25 [00:00<00:04,  5.25it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.69it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.98it/s] 20%|██        | 5/25 [00:00<00:03,  5.84it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.42it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.31it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.24it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.51it/s] 40%|████      | 10/25 [00:01<00:02,  5.79it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.96it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.60it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.84it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.10it/s] 60%|██████    | 15/25 [00:02<00:01,  6.27it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.41it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.88it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.05it/s] 80%|████████  | 20/25 [00:03<00:00,  6.25it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.85it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.92it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.14it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.32it/s]100%|██████████| 25/25 [00:04<00:00,  6.01it/s]
Run 00 | Epoch 00248 | Loss 0.3321 | Train 0.6882 | Val 0.6761 | Test 0.5445
Number of nodes during this epoch:  4637656
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424166679382324  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.146686315536499
range selection method range initialization spend 0.03493690490722656
time for parepare:  0.38474249839782715
local_output_nid generation:  0.032224416732788086
local_in_edges_tensor generation:  0.2174825668334961
mini_batch_src_global generation:  0.3867650032043457
r_  generation:  5.662308692932129
local_output_nid generation:  0.029206275939941406
local_in_edges_tensor generation:  0.2233436107635498
mini_batch_src_global generation:  0.4780855178833008
r_  generation:  5.9755072593688965
----------------------check_connections_block total spend ----------------------------- 15.085343837738037
generate_one_block  7.256387948989868
generate_one_block  7.034497261047363
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.042961120605469
gen group dst list time:  0.09314799308776855
time for parepare:  0.47533297538757324
local_output_nid generation:  0.28920626640319824
local_in_edges_tensor generation:  1.637819766998291
mini_batch_src_global generation:  2.534191846847534
r_  generation:  30.545442819595337
local_output_nid generation:  0.535513162612915
local_in_edges_tensor generation:  2.2531628608703613
mini_batch_src_global generation:  3.7283151149749756
r_  generation:  29.97490358352661
----------------------check_connections_block total spend ----------------------------- 84.011399269104
generate_one_block  41.06651043891907
generate_one_block  40.67070913314819
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.7286741733551025
gen group dst list time:  0.18575000762939453
time for parepare:  0.48590683937072754
local_output_nid generation:  0.41108179092407227
local_in_edges_tensor generation:  1.4946434497833252
mini_batch_src_global generation:  2.017669916152954
r_  generation:  26.040754079818726
local_output_nid generation:  0.7399935722351074
local_in_edges_tensor generation:  1.9184229373931885
mini_batch_src_global generation:  3.0054028034210205
r_  generation:  27.196288347244263
----------------------check_connections_block total spend ----------------------------- 74.26356983184814
generate_one_block  35.51342725753784
generate_one_block  36.33642387390137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424166679382324  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  158.27496910095215
block generation total time  153.58707070350647
average batch blocks generation time:  76.79353535175323
block dataloader generation time/epoch 367.92828490839423
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3986574411392212 |1.489450454711914 |0.005210161209106445 |0.00019168853759765625 |0.0052106380462646484 |0.0019683837890625 |
----------------------------------------------------------pseudo_mini_loss sum 0.3331518769264221
Total (block generation + training)time/epoch 371.77098041748906
Training time/epoch 4.214589834213257
Training time without block to device /epoch 1.2356889247894287
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.04it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.72it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.85it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.09it/s] 40%|████      | 10/25 [00:00<00:00, 17.42it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.04it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.31it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.58it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.56it/s] 80%|████████  | 20/25 [00:01<00:00, 17.74it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.94it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.91it/s]100%|██████████| 25/25 [00:01<00:00, 17.71it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.63it/s]  8%|▊         | 2/25 [00:00<00:04,  5.71it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.93it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.17it/s] 20%|██        | 5/25 [00:00<00:03,  6.32it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.41it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.51it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.59it/s] 40%|████      | 10/25 [00:01<00:02,  6.66it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.69it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.15it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.84it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.60it/s] 60%|██████    | 15/25 [00:02<00:01,  5.79it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.05it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.24it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.91it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.68it/s] 80%|████████  | 20/25 [00:03<00:00,  5.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.37it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.25it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.19it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.16it/s]100%|██████████| 25/25 [00:04<00:00,  5.38it/s]100%|██████████| 25/25 [00:04<00:00,  5.85it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.72it/s]  8%|▊         | 2/25 [00:00<00:04,  5.02it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.04it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.03it/s] 20%|██        | 5/25 [00:00<00:04,  4.97it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.24it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.12it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.05it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.02it/s] 40%|████      | 10/25 [00:01<00:03,  4.92it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.95it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.97it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.00it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.29it/s] 60%|██████    | 15/25 [00:02<00:01,  5.59it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.24it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.34it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.16it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.10it/s] 80%|████████  | 20/25 [00:03<00:00,  5.15it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.40it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.70it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.48it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.31it/s]100%|██████████| 25/25 [00:04<00:00,  5.88it/s]100%|██████████| 25/25 [00:04<00:00,  5.27it/s]
Run 00 | Epoch 00249 | Loss 0.3332 | Train 0.6869 | Val 0.6746 | Test 0.5441
Number of nodes during this epoch:  4638065
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429760456085205  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1383779048919678
range selection method range initialization spend 0.036414384841918945
time for parepare:  0.3798365592956543
local_output_nid generation:  0.02657008171081543
local_in_edges_tensor generation:  0.20572543144226074
mini_batch_src_global generation:  0.3931884765625
r_  generation:  5.58122706413269
local_output_nid generation:  0.03085494041442871
local_in_edges_tensor generation:  0.23915696144104004
mini_batch_src_global generation:  0.46490955352783203
r_  generation:  5.9092206954956055
----------------------check_connections_block total spend ----------------------------- 14.966892957687378
generate_one_block  7.259549379348755
generate_one_block  6.93863844871521
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.054457902908325
gen group dst list time:  0.08701896667480469
time for parepare:  0.44220566749572754
local_output_nid generation:  0.2665245532989502
local_in_edges_tensor generation:  1.630373477935791
mini_batch_src_global generation:  2.5974881649017334
r_  generation:  30.302077054977417
local_output_nid generation:  0.5252013206481934
local_in_edges_tensor generation:  2.263317108154297
mini_batch_src_global generation:  3.7389285564422607
r_  generation:  30.193224906921387
----------------------check_connections_block total spend ----------------------------- 84.00991630554199
generate_one_block  41.312145709991455
generate_one_block  40.992992877960205
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.312044858932495
gen group dst list time:  0.19984221458435059
time for parepare:  0.47090578079223633
local_output_nid generation:  0.41707491874694824
local_in_edges_tensor generation:  1.5293657779693604
mini_batch_src_global generation:  2.0167629718780518
r_  generation:  26.220961570739746
local_output_nid generation:  0.7243437767028809
local_in_edges_tensor generation:  1.9299957752227783
mini_batch_src_global generation:  2.846560001373291
r_  generation:  26.307361841201782
----------------------check_connections_block total spend ----------------------------- 72.41986513137817
generate_one_block  35.47549653053284
generate_one_block  36.12561368942261
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429760456085205  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.42978143692017
block generation total time  153.9062488079071
average batch blocks generation time:  76.95312440395355
block dataloader generation time/epoch 367.93694683933256
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3792370557785034 |1.3255336284637451 |0.004411578178405762 |0.00014770030975341797 |0.005101680755615234 |0.002932310104370117 |
----------------------------------------------------------pseudo_mini_loss sum 0.33219191431999207
Total (block generation + training)time/epoch 371.77963794994355
Training time/epoch 3.841414451599121
Training time without block to device /epoch 1.1903471946716309
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.92it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.58it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.09it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.57it/s] 40%|████      | 10/25 [00:00<00:01, 13.36it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.71it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.52it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.31it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.53it/s] 80%|████████  | 20/25 [00:01<00:00, 16.81it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.16it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.40it/s]100%|██████████| 25/25 [00:01<00:00, 16.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.34it/s]  8%|▊         | 2/25 [00:00<00:04,  4.62it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.09it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.56it/s] 20%|██        | 5/25 [00:00<00:03,  5.29it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.19it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.51it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.83it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.55it/s] 40%|████      | 10/25 [00:01<00:02,  5.48it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.40it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.16it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.93it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.97it/s] 60%|██████    | 15/25 [00:02<00:01,  5.04it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.05it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.33it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.83it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.26it/s] 80%|████████  | 20/25 [00:03<00:00,  5.61it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.40it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.28it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.53it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.82it/s]100%|██████████| 25/25 [00:04<00:00,  5.40it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.67it/s]  8%|▊         | 2/25 [00:00<00:04,  5.52it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.99it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.16it/s] 20%|██        | 5/25 [00:00<00:03,  5.67it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.00it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.20it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.45it/s] 40%|████      | 10/25 [00:01<00:02,  6.47it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.52it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.59it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.07it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.21it/s] 60%|██████    | 15/25 [00:02<00:01,  6.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.45it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.50it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.51it/s] 80%|████████  | 20/25 [00:03<00:00,  6.04it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.18it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.34it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]
Run 00 | Epoch 00250 | Loss 0.3322 | Train 0.6867 | Val 0.6740 | Test 0.5435
Number of nodes during this epoch:  4636617
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427103519439697  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1116325855255127
range selection method range initialization spend 0.029474496841430664
time for parepare:  0.38045477867126465
local_output_nid generation:  0.031391143798828125
local_in_edges_tensor generation:  0.2660367488861084
mini_batch_src_global generation:  0.38025832176208496
r_  generation:  5.475899934768677
local_output_nid generation:  0.028470754623413086
local_in_edges_tensor generation:  0.1963968276977539
mini_batch_src_global generation:  0.47309017181396484
r_  generation:  5.675219774246216
----------------------check_connections_block total spend ----------------------------- 14.607587337493896
generate_one_block  7.279199838638306
generate_one_block  7.190662145614624
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.065825939178467
gen group dst list time:  0.09396767616271973
time for parepare:  0.4686400890350342
local_output_nid generation:  0.26912927627563477
local_in_edges_tensor generation:  1.6699519157409668
mini_batch_src_global generation:  2.4815967082977295
r_  generation:  29.89813995361328
local_output_nid generation:  0.5309751033782959
local_in_edges_tensor generation:  2.0947771072387695
mini_batch_src_global generation:  3.5695383548736572
r_  generation:  29.89387536048889
----------------------check_connections_block total spend ----------------------------- 82.8809061050415
generate_one_block  40.90980124473572
generate_one_block  40.530712842941284
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3316731452941895
gen group dst list time:  0.180023193359375
time for parepare:  0.4654421806335449
local_output_nid generation:  0.38944530487060547
local_in_edges_tensor generation:  1.4918694496154785
mini_batch_src_global generation:  2.044265031814575
r_  generation:  25.738184213638306
local_output_nid generation:  0.7402050495147705
local_in_edges_tensor generation:  1.9468369483947754
mini_batch_src_global generation:  2.9192609786987305
r_  generation:  26.515036582946777
----------------------check_connections_block total spend ----------------------------- 72.27382278442383
generate_one_block  35.550334215164185
generate_one_block  36.134867429733276
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427103519439697  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.15472888946533
block generation total time  153.12571573257446
average batch blocks generation time:  76.56285786628723
block dataloader generation time/epoch 367.9355060256335
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39115428924560547 |1.3825514316558838 |0.004379630088806152 |0.00014972686767578125 |0.0050008296966552734 |0.003173828125 |
----------------------------------------------------------pseudo_mini_loss sum 0.3327264189720154
Total (block generation + training)time/epoch 371.7787484885212
Training time/epoch 3.980903387069702
Training time without block to device /epoch 1.2158005237579346
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.59it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.26it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.70it/s] 40%|████      | 10/25 [00:00<00:00, 17.94it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.92it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.97it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.07it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.08it/s] 80%|████████  | 20/25 [00:01<00:00, 18.18it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.26it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.29it/s]100%|██████████| 25/25 [00:01<00:00, 18.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.58it/s]  8%|▊         | 2/25 [00:00<00:03,  6.54it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.53it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.25it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.25it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.05it/s] 40%|████      | 10/25 [00:01<00:02,  6.08it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.16it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.11it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.16it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.25it/s] 60%|██████    | 15/25 [00:02<00:01,  6.34it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.54it/s] 80%|████████  | 20/25 [00:03<00:00,  6.56it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.58it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.61it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.62it/s]100%|██████████| 25/25 [00:03<00:00,  6.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.49it/s] 20%|██        | 5/25 [00:00<00:03,  6.53it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.56it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.57it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.17it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.12it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.97it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.01it/s] 60%|██████    | 15/25 [00:02<00:01,  6.13it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.23it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.32it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.47it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.48it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.50it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00251 | Loss 0.3327 | Train 0.6880 | Val 0.6750 | Test 0.5440
Number of nodes during this epoch:  4638201
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425302505493164  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1413342952728271
range selection method range initialization spend 0.024958133697509766
time for parepare:  0.3720102310180664
local_output_nid generation:  0.026177406311035156
local_in_edges_tensor generation:  0.21695327758789062
mini_batch_src_global generation:  0.38087034225463867
r_  generation:  5.407755374908447
local_output_nid generation:  0.028194189071655273
local_in_edges_tensor generation:  0.19630908966064453
mini_batch_src_global generation:  0.4603757858276367
r_  generation:  5.67692232131958
----------------------check_connections_block total spend ----------------------------- 14.410671472549438
generate_one_block  7.318728446960449
generate_one_block  6.933896780014038
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.046697616577148
gen group dst list time:  0.08980107307434082
time for parepare:  0.4608595371246338
local_output_nid generation:  0.271852970123291
local_in_edges_tensor generation:  1.7411870956420898
mini_batch_src_global generation:  2.5046114921569824
r_  generation:  29.93580436706543
local_output_nid generation:  0.539043664932251
local_in_edges_tensor generation:  2.1737148761749268
mini_batch_src_global generation:  3.561363458633423
r_  generation:  30.217748880386353
----------------------check_connections_block total spend ----------------------------- 83.48397326469421
generate_one_block  40.81765174865723
generate_one_block  41.013749837875366
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.294966220855713
gen group dst list time:  0.19300198554992676
time for parepare:  0.48235535621643066
local_output_nid generation:  0.44907259941101074
local_in_edges_tensor generation:  1.601020336151123
mini_batch_src_global generation:  2.0580742359161377
r_  generation:  26.27030658721924
local_output_nid generation:  0.7370250225067139
local_in_edges_tensor generation:  1.988966941833496
mini_batch_src_global generation:  2.8280398845672607
r_  generation:  26.19567632675171
----------------------check_connections_block total spend ----------------------------- 72.61769771575928
generate_one_block  35.51121234893799
generate_one_block  36.12826633453369
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425302505493164  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.1016709804535
block generation total time  153.47088027000427
average batch blocks generation time:  76.73544013500214
block dataloader generation time/epoch 367.9365898115294
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3828542232513428 |1.3068125247955322 |0.004407405853271484 |0.00014781951904296875 |0.0051326751708984375 |0.003037691116333008 |
----------------------------------------------------------pseudo_mini_loss sum 0.33185088634490967
Total (block generation + training)time/epoch 371.7797273123075
Training time/epoch 3.816615104675293
Training time without block to device /epoch 1.2029900550842285
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.75it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.34it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.69it/s] 40%|████      | 10/25 [00:00<00:00, 17.83it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.50it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.55it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.79it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.99it/s] 80%|████████  | 20/25 [00:01<00:00, 18.06it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.07it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.05it/s]100%|██████████| 25/25 [00:01<00:00, 17.94it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.99it/s]  8%|▊         | 2/25 [00:00<00:04,  4.97it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.05it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.09it/s] 20%|██        | 5/25 [00:00<00:03,  5.08it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.08it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.06it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.80it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.81it/s] 40%|████      | 10/25 [00:01<00:02,  5.07it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.28it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.52it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.66it/s] 60%|██████    | 15/25 [00:02<00:01,  5.97it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.70it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.52it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.84it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.12it/s] 80%|████████  | 20/25 [00:03<00:00,  6.27it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.77it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.42it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.34it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.24it/s]100%|██████████| 25/25 [00:04<00:00,  5.80it/s]100%|██████████| 25/25 [00:04<00:00,  5.43it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.69it/s]  8%|▊         | 2/25 [00:00<00:03,  6.13it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.52it/s] 20%|██        | 5/25 [00:00<00:03,  6.57it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.06it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.64it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.36it/s] 40%|████      | 10/25 [00:01<00:02,  5.28it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.26it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.21it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.13it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.06it/s] 60%|██████    | 15/25 [00:02<00:01,  5.02it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.32it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.57it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.41it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.70it/s] 80%|████████  | 20/25 [00:03<00:00,  5.94it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.14it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.82it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.58it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.61it/s]100%|██████████| 25/25 [00:04<00:00,  6.11it/s]100%|██████████| 25/25 [00:04<00:00,  5.65it/s]
Run 00 | Epoch 00252 | Loss 0.3319 | Train 0.6878 | Val 0.6761 | Test 0.5441
Number of nodes during this epoch:  4637727
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424533843994141  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1130366325378418
range selection method range initialization spend 0.024871110916137695
time for parepare:  0.3915731906890869
local_output_nid generation:  0.02633523941040039
local_in_edges_tensor generation:  0.2292616367340088
mini_batch_src_global generation:  0.36750054359436035
r_  generation:  5.587147951126099
local_output_nid generation:  0.02974557876586914
local_in_edges_tensor generation:  0.23247075080871582
mini_batch_src_global generation:  0.4935600757598877
r_  generation:  6.136663913726807
----------------------check_connections_block total spend ----------------------------- 15.210478067398071
generate_one_block  7.405797481536865
generate_one_block  7.295833349227905
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.191159725189209
gen group dst list time:  0.08530402183532715
time for parepare:  0.4425797462463379
local_output_nid generation:  0.2562987804412842
local_in_edges_tensor generation:  1.6263666152954102
mini_batch_src_global generation:  2.587886095046997
r_  generation:  29.759841442108154
local_output_nid generation:  0.5176510810852051
local_in_edges_tensor generation:  2.0962319374084473
mini_batch_src_global generation:  3.4884231090545654
r_  generation:  30.072457313537598
----------------------check_connections_block total spend ----------------------------- 82.99702596664429
generate_one_block  40.85921049118042
generate_one_block  40.86478400230408
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.194587230682373
gen group dst list time:  0.18941688537597656
time for parepare:  0.4437847137451172
local_output_nid generation:  0.39708709716796875
local_in_edges_tensor generation:  1.5089163780212402
mini_batch_src_global generation:  2.170713186264038
r_  generation:  26.54182243347168
local_output_nid generation:  0.7267651557922363
local_in_edges_tensor generation:  1.928694486618042
mini_batch_src_global generation:  2.82883358001709
r_  generation:  26.011001586914062
----------------------check_connections_block total spend ----------------------------- 72.78007864952087
generate_one_block  35.178024768829346
generate_one_block  35.9035062789917
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424533843994141  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.77710461616516
block generation total time  152.80552554130554
average batch blocks generation time:  76.40276277065277
block dataloader generation time/epoch 367.9416773404057
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3829289674758911 |1.5363022089004517 |0.004861950874328613 |0.00016963481903076172 |0.005205512046813965 |0.0020084381103515625 |
----------------------------------------------------------pseudo_mini_loss sum 0.3318049907684326
Total (block generation + training)time/epoch 371.78650195890737
Training time/epoch 4.269789934158325
Training time without block to device /epoch 1.1971855163574219
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.75it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.19it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.63it/s] 40%|████      | 10/25 [00:00<00:00, 17.77it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.04it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.03it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.98it/s] 80%|████████  | 20/25 [00:01<00:00, 18.00it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.88it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.85it/s]100%|██████████| 25/25 [00:01<00:00, 17.97it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.98it/s]  8%|▊         | 2/25 [00:00<00:04,  5.70it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.09it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.21it/s] 20%|██        | 5/25 [00:00<00:03,  6.34it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.58it/s] 40%|████      | 10/25 [00:01<00:02,  6.56it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.11it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.80it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.58it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.44it/s] 60%|██████    | 15/25 [00:02<00:01,  5.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.28it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.20it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.47it/s] 80%|████████  | 20/25 [00:03<00:00,  5.81it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.06it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.28it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.29it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.10it/s]100%|██████████| 25/25 [00:04<00:00,  6.67it/s]100%|██████████| 25/25 [00:04<00:00,  5.99it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.27it/s]  8%|▊         | 2/25 [00:00<00:03,  5.99it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.27it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.41it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.54it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.55it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.52it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.54it/s] 60%|██████    | 15/25 [00:02<00:01,  6.13it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.76it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.80it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.61it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.48it/s] 80%|████████  | 20/25 [00:03<00:00,  5.59it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.71it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.91it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.08it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.20it/s]100%|██████████| 25/25 [00:04<00:00,  6.23it/s]
Run 00 | Epoch 00253 | Loss 0.3318 | Train 0.6864 | Val 0.6750 | Test 0.5436
Number of nodes during this epoch:  4637451
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42426061630249  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1445374488830566
range selection method range initialization spend 0.025175094604492188
time for parepare:  0.36626434326171875
local_output_nid generation:  0.025655746459960938
local_in_edges_tensor generation:  0.217390775680542
mini_batch_src_global generation:  0.3741028308868408
r_  generation:  5.593952894210815
local_output_nid generation:  0.028783559799194336
local_in_edges_tensor generation:  0.2318592071533203
mini_batch_src_global generation:  0.45554208755493164
r_  generation:  5.884050607681274
----------------------check_connections_block total spend ----------------------------- 14.884589672088623
generate_one_block  7.164832592010498
generate_one_block  6.869303941726685
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.041905403137207
gen group dst list time:  0.09224319458007812
time for parepare:  0.48198962211608887
local_output_nid generation:  0.28279805183410645
local_in_edges_tensor generation:  1.7303874492645264
mini_batch_src_global generation:  2.5471301078796387
r_  generation:  30.293067693710327
local_output_nid generation:  0.5375456809997559
local_in_edges_tensor generation:  2.399704694747925
mini_batch_src_global generation:  3.8994710445404053
r_  generation:  30.037137031555176
----------------------check_connections_block total spend ----------------------------- 84.96968650817871
generate_one_block  41.87022948265076
generate_one_block  41.10547208786011
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.198286294937134
gen group dst list time:  0.184006929397583
time for parepare:  0.4558596611022949
local_output_nid generation:  0.3933227062225342
local_in_edges_tensor generation:  1.4704363346099854
mini_batch_src_global generation:  2.018825054168701
r_  generation:  25.587942123413086
local_output_nid generation:  0.7399258613586426
local_in_edges_tensor generation:  1.9115352630615234
mini_batch_src_global generation:  2.8125295639038086
r_  generation:  26.207053661346436
----------------------check_connections_block total spend ----------------------------- 71.78334259986877
generate_one_block  34.953805685043335
generate_one_block  35.89475131034851
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42426061630249  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.75302910804749
block generation total time  153.8242585659027
average batch blocks generation time:  76.91212928295135
block dataloader generation time/epoch 367.9478804088953
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38367199897766113 |1.3261464834213257 |0.00487971305847168 |0.00017583370208740234 |0.0050814151763916016 |0.003700733184814453 |
----------------------------------------------------------pseudo_mini_loss sum 0.3325275182723999
Total (block generation + training)time/epoch 371.79276560798405
Training time/epoch 3.860028028488159
Training time without block to device /epoch 1.2077350616455078
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.20it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.34it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.82it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.26it/s] 40%|████      | 10/25 [00:00<00:00, 17.51it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.56it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.62it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.70it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.89it/s] 80%|████████  | 20/25 [00:01<00:00, 17.89it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.80it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.84it/s]100%|██████████| 25/25 [00:01<00:00, 17.72it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.57it/s]  8%|▊         | 2/25 [00:00<00:04,  5.75it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.96it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.23it/s] 20%|██        | 5/25 [00:00<00:03,  5.80it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.09it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.64it/s] 40%|████      | 10/25 [00:01<00:02,  5.87it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.06it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.30it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.35it/s] 60%|██████    | 15/25 [00:02<00:01,  6.38it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.36it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.48it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.57it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.51it/s]100%|██████████| 25/25 [00:04<00:00,  7.05it/s]100%|██████████| 25/25 [00:04<00:00,  6.23it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.86it/s]  8%|▊         | 2/25 [00:00<00:04,  5.69it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.04it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.20it/s] 20%|██        | 5/25 [00:00<00:03,  6.30it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.34it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.20it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.24it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.28it/s] 40%|████      | 10/25 [00:01<00:02,  6.03it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.05it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.97it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.05it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.17it/s] 60%|██████    | 15/25 [00:02<00:01,  6.29it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.49it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.34it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.30it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.35it/s]100%|██████████| 25/25 [00:03<00:00,  7.08it/s]100%|██████████| 25/25 [00:03<00:00,  6.32it/s]
Run 00 | Epoch 00254 | Loss 0.3325 | Train 0.6844 | Val 0.6728 | Test 0.5425
Number of nodes during this epoch:  4638111
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424017429351807  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.136444091796875
range selection method range initialization spend 0.024062395095825195
time for parepare:  0.39070606231689453
local_output_nid generation:  0.026741981506347656
local_in_edges_tensor generation:  0.2234814167022705
mini_batch_src_global generation:  0.37416839599609375
r_  generation:  5.664712429046631
local_output_nid generation:  0.029313087463378906
local_in_edges_tensor generation:  0.23613572120666504
mini_batch_src_global generation:  0.4630765914916992
r_  generation:  5.899393081665039
----------------------check_connections_block total spend ----------------------------- 15.017830848693848
generate_one_block  7.531724452972412
generate_one_block  7.45142674446106
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.013453245162964
gen group dst list time:  0.0926826000213623
time for parepare:  0.5080533027648926
local_output_nid generation:  0.27973246574401855
local_in_edges_tensor generation:  1.7178399562835693
mini_batch_src_global generation:  2.5129003524780273
r_  generation:  29.877921104431152
local_output_nid generation:  0.5314171314239502
local_in_edges_tensor generation:  2.0472359657287598
mini_batch_src_global generation:  3.7618894577026367
r_  generation:  29.953246116638184
----------------------check_connections_block total spend ----------------------------- 83.15808987617493
generate_one_block  41.15046977996826
generate_one_block  41.285722970962524
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.224799156188965
gen group dst list time:  0.18265461921691895
time for parepare:  0.4940013885498047
local_output_nid generation:  0.4248502254486084
local_in_edges_tensor generation:  1.6474947929382324
mini_batch_src_global generation:  2.0341312885284424
r_  generation:  26.181251287460327
local_output_nid generation:  0.7331535816192627
local_in_edges_tensor generation:  1.9778707027435303
mini_batch_src_global generation:  2.8187756538391113
r_  generation:  25.9782772064209
----------------------check_connections_block total spend ----------------------------- 72.41934776306152
generate_one_block  35.206270694732666
generate_one_block  36.016733169555664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424017429351807  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.57743763923645
block generation total time  153.65919661521912
average batch blocks generation time:  76.82959830760956
block dataloader generation time/epoch 367.9511289213218
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37934446334838867 |1.2961169481277466 |0.004364967346191406 |0.00015342235565185547 |0.0052242279052734375 |0.0029954910278320312 |
----------------------------------------------------------pseudo_mini_loss sum 0.3311362564563751
Total (block generation + training)time/epoch 371.79576501004834
Training time/epoch 3.7811853885650635
Training time without block to device /epoch 1.1889514923095703
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.29it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.89it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.41it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:01, 14.15it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.35it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.24it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.82it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.18it/s] 80%|████████  | 20/25 [00:01<00:00, 17.57it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.81it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.97it/s]100%|██████████| 25/25 [00:01<00:00, 17.21it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:03,  6.72it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.70it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.69it/s] 20%|██        | 5/25 [00:00<00:02,  6.73it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.18it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.83it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.62it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.49it/s] 40%|████      | 10/25 [00:01<00:02,  5.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.31it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.27it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.22it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.21it/s] 60%|██████    | 15/25 [00:02<00:01,  5.18it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.17it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.14it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.14it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.15it/s] 80%|████████  | 20/25 [00:03<00:00,  5.16it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.16it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.16it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.16it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.11it/s]100%|██████████| 25/25 [00:04<00:00,  5.75it/s]100%|██████████| 25/25 [00:04<00:00,  5.50it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.79it/s]  8%|▊         | 2/25 [00:00<00:04,  5.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.83it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.82it/s] 20%|██        | 5/25 [00:00<00:03,  6.07it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.24it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.18it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.27it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.33it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.44it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.49it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.46it/s] 60%|██████    | 15/25 [00:02<00:01,  6.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.49it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.94it/s] 80%|████████  | 20/25 [00:03<00:00,  5.88it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.93it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.95it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.10it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.23it/s]100%|██████████| 25/25 [00:03<00:00,  6.29it/s]
Run 00 | Epoch 00255 | Loss 0.3311 | Train 0.6835 | Val 0.6716 | Test 0.5416
Number of nodes during this epoch:  4638356
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428496837615967  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.163975715637207
range selection method range initialization spend 0.024601459503173828
time for parepare:  0.3696610927581787
local_output_nid generation:  0.03681492805480957
local_in_edges_tensor generation:  0.22130560874938965
mini_batch_src_global generation:  0.37166476249694824
r_  generation:  5.351372480392456
local_output_nid generation:  0.027814865112304688
local_in_edges_tensor generation:  0.19381093978881836
mini_batch_src_global generation:  0.45804309844970703
r_  generation:  5.6156005859375
----------------------check_connections_block total spend ----------------------------- 14.292442321777344
generate_one_block  7.34684681892395
generate_one_block  6.8900721073150635
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.23757266998291
gen group dst list time:  0.08690381050109863
time for parepare:  0.4819788932800293
local_output_nid generation:  0.28180932998657227
local_in_edges_tensor generation:  1.6494224071502686
mini_batch_src_global generation:  2.4429781436920166
r_  generation:  29.878690481185913
local_output_nid generation:  0.5352790355682373
local_in_edges_tensor generation:  2.1466054916381836
mini_batch_src_global generation:  3.5143649578094482
r_  generation:  30.124494791030884
----------------------check_connections_block total spend ----------------------------- 83.04978585243225
generate_one_block  41.132471323013306
generate_one_block  41.32348656654358
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.216224193572998
gen group dst list time:  0.18897366523742676
time for parepare:  0.4675137996673584
local_output_nid generation:  0.40787792205810547
local_in_edges_tensor generation:  1.473055124282837
mini_batch_src_global generation:  2.028700113296509
r_  generation:  25.879422664642334
local_output_nid generation:  0.7475025653839111
local_in_edges_tensor generation:  1.9556176662445068
mini_batch_src_global generation:  2.810851812362671
r_  generation:  26.53091073036194
----------------------check_connections_block total spend ----------------------------- 72.45039463043213
generate_one_block  35.57025170326233
generate_one_block  36.06052875518799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428496837615967  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.50018048286438
block generation total time  154.0867383480072
average batch blocks generation time:  77.0433691740036
block dataloader generation time/epoch 367.95166322775185
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38582897186279297 |1.3162809610366821 |0.004882693290710449 |0.00017118453979492188 |0.005117297172546387 |0.0038118362426757812 |
----------------------------------------------------------pseudo_mini_loss sum 0.3301028609275818
Total (block generation + training)time/epoch 371.79626283142716
Training time/epoch 3.835111618041992
Training time without block to device /epoch 1.202549695968628
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.12it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.75it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.16it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.40it/s] 40%|████      | 10/25 [00:00<00:00, 17.47it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.49it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.67it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.82it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.01it/s] 80%|████████  | 20/25 [00:01<00:00, 18.13it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.21it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.22it/s]100%|██████████| 25/25 [00:01<00:00, 18.00it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.32it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.46it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.94it/s] 20%|██        | 5/25 [00:00<00:03,  5.73it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.53it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.05it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.24it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.51it/s] 40%|████      | 10/25 [00:01<00:02,  5.73it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.94it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.72it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.57it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.40it/s] 60%|██████    | 15/25 [00:02<00:01,  5.23it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.16it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.96it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.83it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.92it/s] 80%|████████  | 20/25 [00:03<00:01,  4.96it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.02it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.06it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.10it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.08it/s]100%|██████████| 25/25 [00:04<00:00,  5.15it/s]100%|██████████| 25/25 [00:04<00:00,  5.32it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.46it/s]  8%|▊         | 2/25 [00:00<00:04,  5.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.84it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.13it/s] 20%|██        | 5/25 [00:00<00:03,  5.70it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.36it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.71it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.98it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.73it/s] 40%|████      | 10/25 [00:01<00:02,  5.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.33it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.24it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.14it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.08it/s] 60%|██████    | 15/25 [00:02<00:01,  5.03it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.05it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.06it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.01it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.90it/s] 80%|████████  | 20/25 [00:03<00:00,  5.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.62it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.87it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.08it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.24it/s]100%|██████████| 25/25 [00:04<00:00,  5.61it/s]
Run 00 | Epoch 00256 | Loss 0.3301 | Train 0.6855 | Val 0.6727 | Test 0.5427
Number of nodes during this epoch:  4638194
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424018859863281  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1884434223175049
range selection method range initialization spend 0.0258939266204834
time for parepare:  0.36772680282592773
local_output_nid generation:  0.027298450469970703
local_in_edges_tensor generation:  0.2193000316619873
mini_batch_src_global generation:  0.3718376159667969
r_  generation:  5.598421573638916
local_output_nid generation:  0.03007340431213379
local_in_edges_tensor generation:  0.23632478713989258
mini_batch_src_global generation:  0.49091529846191406
r_  generation:  5.582643985748291
----------------------check_connections_block total spend ----------------------------- 14.611770868301392
generate_one_block  7.230640649795532
generate_one_block  7.121316909790039
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.055866956710815
gen group dst list time:  0.0922999382019043
time for parepare:  0.45386242866516113
local_output_nid generation:  0.26552581787109375
local_in_edges_tensor generation:  1.6015467643737793
mini_batch_src_global generation:  2.4956650733947754
r_  generation:  29.765037059783936
local_output_nid generation:  0.5197570323944092
local_in_edges_tensor generation:  2.0528149604797363
mini_batch_src_global generation:  3.477342128753662
r_  generation:  29.817259073257446
----------------------check_connections_block total spend ----------------------------- 82.21456718444824
generate_one_block  40.821829080581665
generate_one_block  40.88041591644287
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.154338836669922
gen group dst list time:  0.18314385414123535
time for parepare:  0.44263792037963867
local_output_nid generation:  0.37546420097351074
local_in_edges_tensor generation:  1.4514782428741455
mini_batch_src_global generation:  1.9981751441955566
r_  generation:  25.36643934249878
local_output_nid generation:  0.7248268127441406
local_in_edges_tensor generation:  1.9123921394348145
mini_batch_src_global generation:  2.6806578636169434
r_  generation:  25.941026210784912
----------------------check_connections_block total spend ----------------------------- 70.95855903625488
generate_one_block  34.725125312805176
generate_one_block  36.75861430168152
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424018859863281  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.17312622070312
block generation total time  153.18598461151123
average batch blocks generation time:  76.59299230575562
block dataloader generation time/epoch 367.9438594157594
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4029198884963989 |1.5012896060943604 |0.004852175712585449 |0.00017511844635009766 |0.005143523216247559 |0.002049684524536133 |
----------------------------------------------------------pseudo_mini_loss sum 0.33132076263427734
Total (block generation + training)time/epoch 371.78998792403405
Training time/epoch 4.237343072891235
Training time without block to device /epoch 1.2347638607025146
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.79it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.49it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.51it/s] 40%|████      | 10/25 [00:00<00:00, 17.82it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.49it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.72it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.37it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.67it/s] 80%|████████  | 20/25 [00:01<00:00, 17.90it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.98it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.12it/s]100%|██████████| 25/25 [00:01<00:00, 17.94it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.64it/s]  8%|▊         | 2/25 [00:00<00:03,  6.67it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.72it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.74it/s] 20%|██        | 5/25 [00:00<00:02,  6.76it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.63it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.65it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.67it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.62it/s] 40%|████      | 10/25 [00:01<00:02,  6.64it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.11it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.26it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.61it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.67it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.15it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.80it/s] 76%|███████▌  | 19/25 [00:02<00:01,  5.94it/s] 80%|████████  | 20/25 [00:03<00:00,  6.13it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.83it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.62it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.36it/s]100%|██████████| 25/25 [00:04<00:00,  5.51it/s]100%|██████████| 25/25 [00:04<00:00,  6.14it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.13it/s]  8%|▊         | 2/25 [00:00<00:04,  5.49it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.47it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.77it/s] 20%|██        | 5/25 [00:00<00:03,  6.06it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.86it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.61it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.37it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.24it/s] 40%|████      | 10/25 [00:01<00:02,  5.11it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.07it/s] 48%|████▊     | 12/25 [00:02<00:03,  4.01it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.42it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.83it/s] 60%|██████    | 15/25 [00:02<00:01,  5.25it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.60it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.89it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.10it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.26it/s] 80%|████████  | 20/25 [00:03<00:00,  6.34it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.84it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.49it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.27it/s]100%|██████████| 25/25 [00:04<00:00,  5.75it/s]100%|██████████| 25/25 [00:04<00:00,  5.48it/s]
Run 00 | Epoch 00257 | Loss 0.3313 | Train 0.6870 | Val 0.6746 | Test 0.5438
Number of nodes during this epoch:  4637800
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422993183135986  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1281027793884277
range selection method range initialization spend 0.026012659072875977
time for parepare:  0.3930850028991699
local_output_nid generation:  0.028061389923095703
local_in_edges_tensor generation:  0.20613813400268555
mini_batch_src_global generation:  0.3709371089935303
r_  generation:  5.489454507827759
local_output_nid generation:  0.029813289642333984
local_in_edges_tensor generation:  0.21938776969909668
mini_batch_src_global generation:  0.47502899169921875
r_  generation:  5.850311279296875
----------------------check_connections_block total spend ----------------------------- 14.718108892440796
generate_one_block  7.2717320919036865
generate_one_block  6.988029718399048
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.058069229125977
gen group dst list time:  0.10099911689758301
time for parepare:  0.4543275833129883
local_output_nid generation:  0.27050185203552246
local_in_edges_tensor generation:  1.6549675464630127
mini_batch_src_global generation:  2.6073288917541504
r_  generation:  30.481014728546143
local_output_nid generation:  0.5322897434234619
local_in_edges_tensor generation:  2.0920724868774414
mini_batch_src_global generation:  3.7675013542175293
r_  generation:  30.141377925872803
----------------------check_connections_block total spend ----------------------------- 84.13433051109314
generate_one_block  41.34222102165222
generate_one_block  40.79272723197937
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4093191623687744
gen group dst list time:  0.21178507804870605
time for parepare:  0.4855799674987793
local_output_nid generation:  0.411038875579834
local_in_edges_tensor generation:  1.591817855834961
mini_batch_src_global generation:  2.013312339782715
r_  generation:  26.205588817596436
local_output_nid generation:  0.758455753326416
local_in_edges_tensor generation:  2.1034326553344727
mini_batch_src_global generation:  2.8699254989624023
r_  generation:  26.314154386520386
----------------------check_connections_block total spend ----------------------------- 72.66115236282349
generate_one_block  35.398977279663086
generate_one_block  36.34938597679138
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422993183135986  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.79548287391663
block generation total time  153.88331151008606
average batch blocks generation time:  76.94165575504303
block dataloader generation time/epoch 367.94992651403413
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39815807342529297 |1.4696357250213623 |0.005266904830932617 |0.0001895427703857422 |0.005200028419494629 |0.0020089149475097656 |
----------------------------------------------------------pseudo_mini_loss sum 0.3307446241378784
Total (block generation + training)time/epoch 371.7973186332126
Training time/epoch 4.171947002410889
Training time without block to device /epoch 1.232675552368164
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.75it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.54it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.28it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.51it/s] 40%|████      | 10/25 [00:00<00:00, 17.80it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.84it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.67it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.90it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.69it/s] 80%|████████  | 20/25 [00:01<00:00, 17.89it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.08it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.15it/s]100%|██████████| 25/25 [00:01<00:00, 17.98it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.46it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.51it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.54it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.35it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.40it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.35it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.00it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.02it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.15it/s] 60%|██████    | 15/25 [00:02<00:01,  6.27it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.40it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.41it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.44it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  7.20it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.38it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.46it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.51it/s] 20%|██        | 5/25 [00:00<00:03,  6.51it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.51it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.37it/s] 40%|████      | 10/25 [00:01<00:02,  6.20it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.01it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.16it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.27it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.34it/s] 60%|██████    | 15/25 [00:02<00:01,  6.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.15it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.27it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.32it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.36it/s] 80%|████████  | 20/25 [00:03<00:00,  6.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.47it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.46it/s]
Run 00 | Epoch 00258 | Loss 0.3307 | Train 0.6854 | Val 0.6732 | Test 0.5427
Number of nodes during this epoch:  4637241
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423583507537842  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1506829261779785
range selection method range initialization spend 0.026680946350097656
time for parepare:  0.39064908027648926
local_output_nid generation:  0.02652740478515625
local_in_edges_tensor generation:  0.2213728427886963
mini_batch_src_global generation:  0.3698267936706543
r_  generation:  5.425071477890015
local_output_nid generation:  0.029279232025146484
local_in_edges_tensor generation:  0.19571447372436523
mini_batch_src_global generation:  0.45908188819885254
r_  generation:  5.728495836257935
----------------------check_connections_block total spend ----------------------------- 14.478258848190308
generate_one_block  7.268718957901001
generate_one_block  6.77873420715332
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.145351886749268
gen group dst list time:  0.09126996994018555
time for parepare:  0.47011733055114746
local_output_nid generation:  0.2653777599334717
local_in_edges_tensor generation:  1.8326807022094727
mini_batch_src_global generation:  2.4412429332733154
r_  generation:  29.587557554244995
local_output_nid generation:  0.5235986709594727
local_in_edges_tensor generation:  2.1726300716400146
mini_batch_src_global generation:  3.5224859714508057
r_  generation:  29.910110473632812
----------------------check_connections_block total spend ----------------------------- 82.54607152938843
generate_one_block  41.04265260696411
generate_one_block  41.07058358192444
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3578832149505615
gen group dst list time:  0.18606066703796387
time for parepare:  0.5120844841003418
local_output_nid generation:  0.4161505699157715
local_in_edges_tensor generation:  1.5939807891845703
mini_batch_src_global generation:  2.0152926445007324
r_  generation:  26.347447395324707
local_output_nid generation:  0.7254214286804199
local_in_edges_tensor generation:  1.9738855361938477
mini_batch_src_global generation:  2.8456034660339355
r_  generation:  26.0285964012146
----------------------check_connections_block total spend ----------------------------- 72.32555818557739
generate_one_block  35.371443033218384
generate_one_block  37.392889976501465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423583507537842  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.87162971496582
block generation total time  154.8775691986084
average batch blocks generation time:  77.4387845993042
block dataloader generation time/epoch 367.9534197884637
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3795713186264038 |1.315575361251831 |0.004376888275146484 |0.0001538991928100586 |0.005204677581787109 |0.0031130313873291016 |
----------------------------------------------------------pseudo_mini_loss sum 0.3313618004322052
Total (block generation + training)time/epoch 371.80071685673187
Training time/epoch 3.8226001262664795
Training time without block to device /epoch 1.1914494037628174
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.85it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.97it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.48it/s] 40%|████      | 10/25 [00:00<00:00, 17.80it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.98it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.58it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.18it/s] 80%|████████  | 20/25 [00:01<00:00, 17.50it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.46it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.71it/s]100%|██████████| 25/25 [00:01<00:00, 17.76it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.63it/s] 20%|██        | 5/25 [00:00<00:03,  5.96it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.14it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.19it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.33it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.54it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.56it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.56it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.59it/s] 60%|██████    | 15/25 [00:02<00:01,  6.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.58it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.55it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.57it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.57it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.55it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.57it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.59it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.59it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.25it/s]  8%|▊         | 2/25 [00:00<00:03,  6.48it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.87it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.53it/s] 20%|██        | 5/25 [00:00<00:03,  5.39it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.31it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.18it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.15it/s] 40%|████      | 10/25 [00:01<00:02,  5.13it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.10it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.94it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.88it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.98it/s] 60%|██████    | 15/25 [00:02<00:01,  5.27it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.25it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.12it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.07it/s] 80%|████████  | 20/25 [00:03<00:01,  4.98it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.01it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.02it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.04it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.06it/s]100%|██████████| 25/25 [00:04<00:00,  5.62it/s]100%|██████████| 25/25 [00:04<00:00,  5.24it/s]
Run 00 | Epoch 00259 | Loss 0.3314 | Train 0.6862 | Val 0.6737 | Test 0.5436
Number of nodes during this epoch:  4637523
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425163745880127  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1334056854248047
range selection method range initialization spend 0.030073881149291992
time for parepare:  0.39902520179748535
local_output_nid generation:  0.03197979927062988
local_in_edges_tensor generation:  0.2520604133605957
mini_batch_src_global generation:  0.3859403133392334
r_  generation:  5.563860893249512
local_output_nid generation:  0.029177427291870117
local_in_edges_tensor generation:  0.22174715995788574
mini_batch_src_global generation:  0.4908130168914795
r_  generation:  5.863834619522095
----------------------check_connections_block total spend ----------------------------- 14.93118953704834
generate_one_block  7.303440093994141
generate_one_block  6.947718620300293
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.210611820220947
gen group dst list time:  0.10281538963317871
time for parepare:  0.4808533191680908
local_output_nid generation:  0.2746858596801758
local_in_edges_tensor generation:  1.7147409915924072
mini_batch_src_global generation:  2.463015079498291
r_  generation:  30.16622257232666
local_output_nid generation:  0.5276734828948975
local_in_edges_tensor generation:  2.133660316467285
mini_batch_src_global generation:  3.526282548904419
r_  generation:  30.392741203308105
----------------------check_connections_block total spend ----------------------------- 83.64725804328918
generate_one_block  41.14562463760376
generate_one_block  41.09151530265808
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2000110149383545
gen group dst list time:  0.18796682357788086
time for parepare:  0.4643230438232422
local_output_nid generation:  0.3911166191101074
local_in_edges_tensor generation:  1.5027239322662354
mini_batch_src_global generation:  2.0308923721313477
r_  generation:  25.5338134765625
local_output_nid generation:  0.7376580238342285
local_in_edges_tensor generation:  1.9879984855651855
mini_batch_src_global generation:  2.787492036819458
r_  generation:  26.40160036087036
----------------------check_connections_block total spend ----------------------------- 71.98489308357239
generate_one_block  35.40780568122864
generate_one_block  35.6640248298645
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425163745880127  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.63215112686157
block generation total time  153.30897045135498
average batch blocks generation time:  76.65448522567749
block dataloader generation time/epoch 367.9560524399464
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3829386234283447 |1.3019568920135498 |0.004573225975036621 |0.00015485286712646484 |0.005073666572570801 |0.002786874771118164 |
----------------------------------------------------------pseudo_mini_loss sum 0.3296414613723755
Total (block generation + training)time/epoch 371.80317742824553
Training time/epoch 3.802184820175171
Training time without block to device /epoch 1.1982710361480713
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.95it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.62it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.17it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.54it/s] 40%|████      | 10/25 [00:00<00:01, 13.99it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.92it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.30it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.00it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.70it/s] 80%|████████  | 20/25 [00:01<00:00, 17.22it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.53it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.64it/s]100%|██████████| 25/25 [00:01<00:00, 16.74it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.08it/s]  8%|▊         | 2/25 [00:00<00:04,  5.08it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.04it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.06it/s] 20%|██        | 5/25 [00:00<00:03,  5.02it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.98it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.02it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.03it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.06it/s] 40%|████      | 10/25 [00:01<00:02,  5.07it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.05it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.18it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.54it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.85it/s] 60%|██████    | 15/25 [00:02<00:01,  6.08it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.24it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.35it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.64it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.79it/s] 80%|████████  | 20/25 [00:03<00:00,  6.00it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.17it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.92it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.90it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.02it/s]100%|██████████| 25/25 [00:04<00:00,  6.81it/s]100%|██████████| 25/25 [00:04<00:00,  5.66it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.28it/s]  8%|▊         | 2/25 [00:00<00:03,  6.49it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.53it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.55it/s] 20%|██        | 5/25 [00:00<00:03,  6.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.48it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.28it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.90it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.37it/s] 40%|████      | 10/25 [00:01<00:02,  5.27it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.53it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.80it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.99it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.15it/s] 60%|██████    | 15/25 [00:02<00:01,  6.24it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.26it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.78it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.96it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.02it/s] 80%|████████  | 20/25 [00:03<00:00,  6.11it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.12it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.21it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.31it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.37it/s]100%|██████████| 25/25 [00:04<00:00,  6.18it/s]
Run 00 | Epoch 00260 | Loss 0.3296 | Train 0.6852 | Val 0.6729 | Test 0.5434
Number of nodes during this epoch:  4637785
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427800178527832  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1528046131134033
range selection method range initialization spend 0.02558422088623047
time for parepare:  0.3757023811340332
local_output_nid generation:  0.02947854995727539
local_in_edges_tensor generation:  0.22624564170837402
mini_batch_src_global generation:  0.3788919448852539
r_  generation:  5.699284553527832
local_output_nid generation:  0.02888774871826172
local_in_edges_tensor generation:  0.2353224754333496
mini_batch_src_global generation:  0.46457695960998535
r_  generation:  5.9732136726379395
----------------------check_connections_block total spend ----------------------------- 15.13719391822815
generate_one_block  7.223282337188721
generate_one_block  6.93476128578186
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.035434007644653
gen group dst list time:  0.09284090995788574
time for parepare:  0.4666423797607422
local_output_nid generation:  0.28125810623168945
local_in_edges_tensor generation:  1.635605812072754
mini_batch_src_global generation:  2.51385760307312
r_  generation:  29.888741493225098
local_output_nid generation:  0.5343179702758789
local_in_edges_tensor generation:  2.108778476715088
mini_batch_src_global generation:  3.5971951484680176
r_  generation:  30.181825399398804
----------------------check_connections_block total spend ----------------------------- 83.38355350494385
generate_one_block  40.70411205291748
generate_one_block  40.801857233047485
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1999359130859375
gen group dst list time:  0.18359827995300293
time for parepare:  0.49303293228149414
local_output_nid generation:  0.4267079830169678
local_in_edges_tensor generation:  1.5284278392791748
mini_batch_src_global generation:  2.078338861465454
r_  generation:  26.15260887145996
local_output_nid generation:  0.7256450653076172
local_in_edges_tensor generation:  1.9271070957183838
mini_batch_src_global generation:  2.857677459716797
r_  generation:  25.943183422088623
----------------------check_connections_block total spend ----------------------------- 71.97905898094177
generate_one_block  35.15402436256409
generate_one_block  35.94760847091675
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427800178527832  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.36261248588562
block generation total time  152.6076021194458
average batch blocks generation time:  76.3038010597229
block dataloader generation time/epoch 367.9525004858258
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3860512971878052 |1.3001278638839722 |0.004395842552185059 |0.0001552104949951172 |0.005211949348449707 |0.0029582977294921875 |
----------------------------------------------------------pseudo_mini_loss sum 0.3300274610519409
Total (block generation + training)time/epoch 371.7994615109031
Training time/epoch 3.8041515350341797
Training time without block to device /epoch 1.2038958072662354
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.85it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.42it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.83it/s] 40%|████      | 10/25 [00:00<00:00, 18.02it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.13it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.15it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.26it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.30it/s] 80%|████████  | 20/25 [00:01<00:00, 18.28it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.21it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.30it/s]100%|██████████| 25/25 [00:01<00:00, 18.26it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.63it/s]  8%|▊         | 2/25 [00:00<00:03,  6.67it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.99it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.66it/s] 20%|██        | 5/25 [00:00<00:03,  5.46it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.36it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.29it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.27it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.23it/s] 40%|████      | 10/25 [00:01<00:02,  5.25it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.21it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.18it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.15it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.16it/s] 60%|██████    | 15/25 [00:02<00:01,  5.14it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.16it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.14it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.15it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.97it/s] 80%|████████  | 20/25 [00:03<00:00,  5.03it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.02it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.40it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.70it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.74it/s]100%|██████████| 25/25 [00:04<00:00,  6.57it/s]100%|██████████| 25/25 [00:04<00:00,  5.46it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.94it/s]  8%|▊         | 2/25 [00:00<00:04,  5.54it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.97it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.65it/s] 20%|██        | 5/25 [00:00<00:03,  5.45it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.21it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.07it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.95it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.17it/s] 40%|████      | 10/25 [00:01<00:02,  5.48it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.77it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.53it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.69it/s] 60%|██████    | 15/25 [00:02<00:01,  5.85it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.05it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.14it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.26it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.52it/s]100%|██████████| 25/25 [00:04<00:00,  6.66it/s]100%|██████████| 25/25 [00:04<00:00,  5.90it/s]
Run 00 | Epoch 00261 | Loss 0.3300 | Train 0.6840 | Val 0.6705 | Test 0.5422
Number of nodes during this epoch:  4637903
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4248366355896  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1436643600463867
range selection method range initialization spend 0.03543734550476074
time for parepare:  0.37179136276245117
local_output_nid generation:  0.02673172950744629
local_in_edges_tensor generation:  0.25138330459594727
mini_batch_src_global generation:  0.3774988651275635
r_  generation:  5.731194734573364
local_output_nid generation:  0.029524803161621094
local_in_edges_tensor generation:  0.23391079902648926
mini_batch_src_global generation:  0.47142744064331055
r_  generation:  5.975458860397339
----------------------check_connections_block total spend ----------------------------- 15.150280714035034
generate_one_block  7.254119873046875
generate_one_block  6.971708059310913
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.012173652648926
gen group dst list time:  0.0855855941772461
time for parepare:  0.4669816493988037
local_output_nid generation:  0.26358914375305176
local_in_edges_tensor generation:  1.63289475440979
mini_batch_src_global generation:  2.596778392791748
r_  generation:  29.755622625350952
local_output_nid generation:  0.5308716297149658
local_in_edges_tensor generation:  2.239560127258301
mini_batch_src_global generation:  3.705643892288208
r_  generation:  29.67845344543457
----------------------check_connections_block total spend ----------------------------- 82.93353414535522
generate_one_block  40.881582260131836
generate_one_block  40.47605752944946
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.314640760421753
gen group dst list time:  0.18111634254455566
time for parepare:  0.49556732177734375
local_output_nid generation:  0.40174102783203125
local_in_edges_tensor generation:  1.6812865734100342
mini_batch_src_global generation:  2.020829439163208
r_  generation:  26.08717107772827
local_output_nid generation:  0.7232768535614014
local_in_edges_tensor generation:  1.9711122512817383
mini_batch_src_global generation:  2.8400397300720215
r_  generation:  26.125584602355957
----------------------check_connections_block total spend ----------------------------- 72.27214169502258
generate_one_block  35.44798970222473
generate_one_block  36.16629481315613
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4248366355896  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.2056758403778
block generation total time  152.97192430496216
average batch blocks generation time:  76.48596215248108
block dataloader generation time/epoch 367.94997225553936
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39457952976226807 |1.3250073194503784 |0.0049059391021728516 |0.00016963481903076172 |0.005087018013000488 |0.0035247802734375 |
----------------------------------------------------------pseudo_mini_loss sum 0.3304152190685272
Total (block generation + training)time/epoch 371.7970153466436
Training time/epoch 3.868272542953491
Training time without block to device /epoch 1.2182579040527344
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.41it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.23it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.53it/s] 40%|████      | 10/25 [00:00<00:00, 17.67it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.80it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.99it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.05it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.19it/s] 80%|████████  | 20/25 [00:01<00:00, 18.21it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.27it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.28it/s]100%|██████████| 25/25 [00:01<00:00, 18.12it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.39it/s]  8%|▊         | 2/25 [00:00<00:03,  6.50it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.47it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.48it/s] 40%|████      | 10/25 [00:01<00:02,  6.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.49it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.54it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.57it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.56it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.55it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.52it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.54it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.56it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.56it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.55it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  6.61it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.22it/s]  8%|▊         | 2/25 [00:00<00:03,  5.88it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.16it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.28it/s] 20%|██        | 5/25 [00:00<00:03,  6.34it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.38it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.28it/s] 40%|████      | 10/25 [00:01<00:02,  6.31it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.07it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.20it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.26it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.10it/s] 60%|██████    | 15/25 [00:02<00:01,  6.20it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.27it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.31it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.36it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.36it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  7.15it/s]100%|██████████| 25/25 [00:03<00:00,  6.40it/s]
Run 00 | Epoch 00262 | Loss 0.3304 | Train 0.6851 | Val 0.6732 | Test 0.5432
Number of nodes during this epoch:  4637662
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422264575958252  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1558444499969482
range selection method range initialization spend 0.024487972259521484
time for parepare:  0.3572354316711426
local_output_nid generation:  0.026467323303222656
local_in_edges_tensor generation:  0.19801592826843262
mini_batch_src_global generation:  0.37538743019104004
r_  generation:  5.708835124969482
local_output_nid generation:  0.029469728469848633
local_in_edges_tensor generation:  0.2330188751220703
mini_batch_src_global generation:  0.4732186794281006
r_  generation:  5.952275037765503
----------------------check_connections_block total spend ----------------------------- 15.045320987701416
generate_one_block  7.217114448547363
generate_one_block  6.937130689620972
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.101377964019775
gen group dst list time:  0.09239745140075684
time for parepare:  0.44605302810668945
local_output_nid generation:  0.2771744728088379
local_in_edges_tensor generation:  1.6077618598937988
mini_batch_src_global generation:  2.546297073364258
r_  generation:  30.06423020362854
local_output_nid generation:  0.5348899364471436
local_in_edges_tensor generation:  2.1560349464416504
mini_batch_src_global generation:  3.5752131938934326
r_  generation:  30.12231993675232
----------------------check_connections_block total spend ----------------------------- 83.44057941436768
generate_one_block  40.8521032333374
generate_one_block  41.16913676261902
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3249223232269287
gen group dst list time:  0.19431185722351074
time for parepare:  0.4984099864959717
local_output_nid generation:  0.42418742179870605
local_in_edges_tensor generation:  1.6956830024719238
mini_batch_src_global generation:  2.0818185806274414
r_  generation:  28.147661685943604
local_output_nid generation:  0.7360682487487793
local_in_edges_tensor generation:  2.003333568572998
mini_batch_src_global generation:  3.1713151931762695
r_  generation:  27.014955759048462
----------------------check_connections_block total spend ----------------------------- 77.03665113449097
generate_one_block  35.465343952178955
generate_one_block  36.14259743690491
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422264575958252  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  160.47723054885864
block generation total time  153.62918138504028
average batch blocks generation time:  76.81459069252014
block dataloader generation time/epoch 367.96993295230794
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38442277908325195 |1.3165682554244995 |0.005049347877502441 |0.0001766681671142578 |0.005112171173095703 |0.003854990005493164 |
----------------------------------------------------------pseudo_mini_loss sum 0.32873618602752686
Total (block generation + training)time/epoch 371.81693219413324
Training time/epoch 3.835330009460449
Training time without block to device /epoch 1.2021934986114502
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.04it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.33it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.85it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.02it/s] 40%|████      | 10/25 [00:00<00:00, 17.49it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.53it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.61it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.37it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.68it/s] 80%|████████  | 20/25 [00:01<00:00, 17.83it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.92it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.27it/s]100%|██████████| 25/25 [00:01<00:00, 17.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.63it/s]  8%|▊         | 2/25 [00:00<00:03,  6.64it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.67it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.66it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.60it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.55it/s] 40%|████      | 10/25 [00:01<00:02,  6.53it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.51it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.53it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.52it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.54it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.55it/s] 80%|████████  | 20/25 [00:03<00:00,  6.55it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.54it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.55it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.52it/s]100%|██████████| 25/25 [00:03<00:00,  7.25it/s]100%|██████████| 25/25 [00:03<00:00,  6.63it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.25it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  6.50it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.51it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.52it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.49it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.47it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.49it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.50it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.49it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.99it/s] 76%|███████▌  | 19/25 [00:02<00:01,  5.96it/s] 80%|████████  | 20/25 [00:03<00:00,  6.12it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.21it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.29it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.36it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00263 | Loss 0.3287 | Train 0.6858 | Val 0.6729 | Test 0.5436
Number of nodes during this epoch:  4638308
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425155162811279  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1219263076782227
range selection method range initialization spend 0.02470231056213379
time for parepare:  0.3700833320617676
local_output_nid generation:  0.02622842788696289
local_in_edges_tensor generation:  0.23166537284851074
mini_batch_src_global generation:  0.3697643280029297
r_  generation:  5.46031379699707
local_output_nid generation:  0.027906179428100586
local_in_edges_tensor generation:  0.23022007942199707
mini_batch_src_global generation:  0.4940664768218994
r_  generation:  5.7136390209198
----------------------check_connections_block total spend ----------------------------- 14.618876218795776
generate_one_block  7.27472186088562
generate_one_block  6.972174644470215
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.033454179763794
gen group dst list time:  0.09174823760986328
time for parepare:  0.46814584732055664
local_output_nid generation:  0.2690451145172119
local_in_edges_tensor generation:  1.6462082862854004
mini_batch_src_global generation:  2.534749746322632
r_  generation:  30.012333393096924
local_output_nid generation:  0.5362210273742676
local_in_edges_tensor generation:  2.1260154247283936
mini_batch_src_global generation:  3.565289258956909
r_  generation:  30.30751872062683
----------------------check_connections_block total spend ----------------------------- 83.53472399711609
generate_one_block  41.273462772369385
generate_one_block  41.25400519371033
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.266984462738037
gen group dst list time:  0.1889791488647461
time for parepare:  0.44640016555786133
local_output_nid generation:  0.41807079315185547
local_in_edges_tensor generation:  1.4847371578216553
mini_batch_src_global generation:  2.168858289718628
r_  generation:  26.5865957736969
local_output_nid generation:  0.7334773540496826
local_in_edges_tensor generation:  1.9338915348052979
mini_batch_src_global generation:  2.858269214630127
r_  generation:  26.288549423217773
----------------------check_connections_block total spend ----------------------------- 72.97978019714355
generate_one_block  35.38578414916992
generate_one_block  36.1554274559021
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425155162811279  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.51450419425964
block generation total time  154.06867957115173
average batch blocks generation time:  77.03433978557587
block dataloader generation time/epoch 367.9760410695365
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3762366771697998 |1.309362530708313 |0.004529237747192383 |0.0001513957977294922 |0.005166053771972656 |0.0016913414001464844 |
----------------------------------------------------------pseudo_mini_loss sum 0.3296303153038025
Total (block generation + training)time/epoch 371.8228673817533
Training time/epoch 3.801142692565918
Training time without block to device /epoch 1.182417631149292
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.54it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.16it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.19it/s] 40%|████      | 10/25 [00:00<00:00, 16.77it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.09it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.45it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.69it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.48it/s] 80%|████████  | 20/25 [00:01<00:00, 17.23it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.37it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.59it/s]100%|██████████| 25/25 [00:01<00:00, 17.43it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.66it/s]  8%|▊         | 2/25 [00:00<00:03,  6.74it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.69it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.08it/s] 20%|██        | 5/25 [00:00<00:03,  5.70it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.86it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.14it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.80it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.33it/s] 40%|████      | 10/25 [00:01<00:02,  5.28it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.30it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.11it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.03it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.02it/s] 60%|██████    | 15/25 [00:02<00:01,  5.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.74it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.99it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.81it/s] 80%|████████  | 20/25 [00:03<00:00,  5.58it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.40it/s] 88%|████████▊ | 22/25 [00:03<00:00,  4.99it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.31it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.68it/s]100%|██████████| 25/25 [00:04<00:00,  5.71it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.79it/s]  8%|▊         | 2/25 [00:00<00:04,  5.70it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.06it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.29it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.86it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.53it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.33it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.21it/s] 40%|████      | 10/25 [00:01<00:02,  5.09it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.01it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.96it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.93it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.97it/s] 60%|██████    | 15/25 [00:02<00:02,  4.99it/s] 64%|██████▍   | 16/25 [00:03<00:01,  4.93it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.36it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.73it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.56it/s] 80%|████████  | 20/25 [00:03<00:00,  5.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.64it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.93it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.17it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.31it/s]100%|██████████| 25/25 [00:04<00:00,  5.64it/s]
Run 00 | Epoch 00264 | Loss 0.3296 | Train 0.6858 | Val 0.6728 | Test 0.5438
Number of nodes during this epoch:  4637438
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429437160491943  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.138925313949585
range selection method range initialization spend 0.025075912475585938
time for parepare:  0.37099456787109375
local_output_nid generation:  0.02629375457763672
local_in_edges_tensor generation:  0.1904006004333496
mini_batch_src_global generation:  0.3764653205871582
r_  generation:  5.605931758880615
local_output_nid generation:  0.027999162673950195
local_in_edges_tensor generation:  0.21660518646240234
mini_batch_src_global generation:  0.4579904079437256
r_  generation:  5.593811750411987
----------------------check_connections_block total spend ----------------------------- 14.515313863754272
generate_one_block  7.377063751220703
generate_one_block  7.198184251785278
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.952162504196167
gen group dst list time:  0.09045600891113281
time for parepare:  0.46790099143981934
local_output_nid generation:  0.2681295871734619
local_in_edges_tensor generation:  1.7463476657867432
mini_batch_src_global generation:  2.5201075077056885
r_  generation:  29.681563138961792
local_output_nid generation:  0.5267865657806396
local_in_edges_tensor generation:  2.140080690383911
mini_batch_src_global generation:  3.626272439956665
r_  generation:  30.1089768409729
----------------------check_connections_block total spend ----------------------------- 83.1184732913971
generate_one_block  40.49976134300232
generate_one_block  40.96276378631592
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1455442905426025
gen group dst list time:  0.19373631477355957
time for parepare:  0.46619224548339844
local_output_nid generation:  0.43099379539489746
local_in_edges_tensor generation:  1.5017666816711426
mini_batch_src_global generation:  2.0449466705322266
r_  generation:  25.906117916107178
local_output_nid generation:  0.7540690898895264
local_in_edges_tensor generation:  1.9733285903930664
mini_batch_src_global generation:  3.0275588035583496
r_  generation:  27.22697138786316
----------------------check_connections_block total spend ----------------------------- 73.84555101394653
generate_one_block  36.82220816612244
generate_one_block  36.035420417785645
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429437160491943  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.96402430534363
block generation total time  154.32015371322632
average batch blocks generation time:  77.16007685661316
block dataloader generation time/epoch 367.98421887901594
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3806208372116089 |1.3582936525344849 |0.004447817802429199 |0.00015020370483398438 |0.005044817924499512 |0.003083467483520508 |
----------------------------------------------------------pseudo_mini_loss sum 0.33023518323898315
Total (block generation + training)time/epoch 371.83135197387554
Training time/epoch 3.927945852279663
Training time without block to device /epoch 1.2113585472106934
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.86it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.33it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.38it/s] 40%|████      | 10/25 [00:00<00:01, 13.92it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.14it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.07it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.73it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.95it/s] 80%|████████  | 20/25 [00:01<00:00, 17.26it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.20it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.25it/s]100%|██████████| 25/25 [00:01<00:00, 16.84it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.62it/s]  8%|▊         | 2/25 [00:00<00:03,  6.73it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.71it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.02it/s] 20%|██        | 5/25 [00:00<00:03,  6.07it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.82it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.86it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.11it/s] 40%|████      | 10/25 [00:01<00:02,  6.26it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.37it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.41it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.50it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.54it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.59it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.59it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.63it/s] 80%|████████  | 20/25 [00:03<00:00,  6.71it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.72it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.69it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.60it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.62it/s]100%|██████████| 25/25 [00:03<00:00,  7.35it/s]100%|██████████| 25/25 [00:03<00:00,  6.50it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.57it/s]  8%|▊         | 2/25 [00:00<00:03,  6.38it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.51it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.64it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.58it/s] 40%|████      | 10/25 [00:01<00:02,  6.60it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.62it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.58it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.58it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.54it/s] 60%|██████    | 15/25 [00:02<00:01,  6.57it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.55it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.61it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  5.85it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.58it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.17it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.13it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.12it/s]100%|██████████| 25/25 [00:04<00:00,  5.82it/s]100%|██████████| 25/25 [00:04<00:00,  6.18it/s]
Run 00 | Epoch 00265 | Loss 0.3302 | Train 0.6872 | Val 0.6743 | Test 0.5452
Number of nodes during this epoch:  4637356
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428958415985107  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.12752366065979
range selection method range initialization spend 0.024748563766479492
time for parepare:  0.37854552268981934
local_output_nid generation:  0.0261838436126709
local_in_edges_tensor generation:  0.23528790473937988
mini_batch_src_global generation:  0.3833436965942383
r_  generation:  5.5390660762786865
local_output_nid generation:  0.02789473533630371
local_in_edges_tensor generation:  0.21588540077209473
mini_batch_src_global generation:  0.46843910217285156
r_  generation:  5.589137077331543
----------------------check_connections_block total spend ----------------------------- 14.573456525802612
generate_one_block  7.340681076049805
generate_one_block  7.195212125778198
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.139457941055298
gen group dst list time:  0.08547830581665039
time for parepare:  0.4336585998535156
local_output_nid generation:  0.25395727157592773
local_in_edges_tensor generation:  1.5596609115600586
mini_batch_src_global generation:  2.4138240814208984
r_  generation:  28.914524793624878
local_output_nid generation:  0.514272928237915
local_in_edges_tensor generation:  2.0586416721343994
mini_batch_src_global generation:  3.5029494762420654
r_  generation:  29.847044229507446
----------------------check_connections_block total spend ----------------------------- 81.28853106498718
generate_one_block  40.66012644767761
generate_one_block  40.82695436477661
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.225381851196289
gen group dst list time:  0.19145441055297852
time for parepare:  0.48035264015197754
local_output_nid generation:  0.42621684074401855
local_in_edges_tensor generation:  1.521857500076294
mini_batch_src_global generation:  2.1998720169067383
r_  generation:  26.27945375442505
local_output_nid generation:  0.7366814613342285
local_in_edges_tensor generation:  1.9301810264587402
mini_batch_src_global generation:  2.8176980018615723
r_  generation:  26.191798210144043
----------------------check_connections_block total spend ----------------------------- 72.57429337501526
generate_one_block  35.209004640579224
generate_one_block  36.01893758773804
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428958415985107  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.86282444000244
block generation total time  152.71502304077148
average batch blocks generation time:  76.35751152038574
block dataloader generation time/epoch 367.975164525491
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37542200088500977 |1.2905428409576416 |0.0044716596603393555 |0.00015532970428466797 |0.005058169364929199 |0.0029823780059814453 |
----------------------------------------------------------pseudo_mini_loss sum 0.32916298508644104
Total (block generation + training)time/epoch 371.82198471323886
Training time/epoch 3.7637035846710205
Training time without block to device /epoch 1.1826179027557373
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.03it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.59it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.13it/s] 32%|███▏      | 8/25 [00:00<00:01, 17.00it/s] 40%|████      | 10/25 [00:00<00:00, 16.78it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.13it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.16it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.42it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.65it/s] 80%|████████  | 20/25 [00:01<00:00, 17.67it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.16it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.43it/s]100%|██████████| 25/25 [00:01<00:00, 17.47it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.58it/s]  8%|▊         | 2/25 [00:00<00:03,  6.64it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.63it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.63it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.64it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.59it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.62it/s] 40%|████      | 10/25 [00:01<00:02,  6.64it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.65it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.57it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.57it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.07it/s] 60%|██████    | 15/25 [00:02<00:01,  5.84it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.86it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.90it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.99it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.09it/s] 80%|████████  | 20/25 [00:03<00:00,  6.25it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.35it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.54it/s]100%|██████████| 25/25 [00:03<00:00,  7.03it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.79it/s]  8%|▊         | 2/25 [00:00<00:04,  5.65it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.12it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.25it/s] 20%|██        | 5/25 [00:00<00:03,  5.47it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.71it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.95it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.14it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.27it/s] 40%|████      | 10/25 [00:01<00:02,  6.31it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.38it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.42it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.49it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.53it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.55it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.57it/s]100%|██████████| 25/25 [00:03<00:00,  6.32it/s]
Run 00 | Epoch 00266 | Loss 0.3292 | Train 0.6883 | Val 0.6760 | Test 0.5456
Number of nodes during this epoch:  4637737
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428024768829346  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1112415790557861
range selection method range initialization spend 0.025120019912719727
time for parepare:  0.35956621170043945
local_output_nid generation:  0.03092050552368164
local_in_edges_tensor generation:  0.2015218734741211
mini_batch_src_global generation:  0.3698575496673584
r_  generation:  5.645747423171997
local_output_nid generation:  0.029347896575927734
local_in_edges_tensor generation:  0.2326202392578125
mini_batch_src_global generation:  0.47138166427612305
r_  generation:  5.897840738296509
----------------------check_connections_block total spend ----------------------------- 14.898986339569092
generate_one_block  7.169101715087891
generate_one_block  6.869157791137695
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.02295994758606
gen group dst list time:  0.09193968772888184
time for parepare:  0.4755575656890869
local_output_nid generation:  0.26526665687561035
local_in_edges_tensor generation:  1.6322462558746338
mini_batch_src_global generation:  2.621088981628418
r_  generation:  29.642597198486328
local_output_nid generation:  0.527693510055542
local_in_edges_tensor generation:  2.104224443435669
mini_batch_src_global generation:  3.508344888687134
r_  generation:  30.08021306991577
----------------------check_connections_block total spend ----------------------------- 82.95197892189026
generate_one_block  41.01938343048096
generate_one_block  42.05942702293396
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3773789405822754
gen group dst list time:  0.1980581283569336
time for parepare:  0.4880073070526123
local_output_nid generation:  0.43228816986083984
local_in_edges_tensor generation:  1.5073797702789307
mini_batch_src_global generation:  2.0207197666168213
r_  generation:  26.242997646331787
local_output_nid generation:  0.760601282119751
local_in_edges_tensor generation:  1.9307820796966553
mini_batch_src_global generation:  2.877314805984497
r_  generation:  26.336124897003174
----------------------check_connections_block total spend ----------------------------- 72.70102667808533
generate_one_block  35.420936584472656
generate_one_block  36.084773778915405
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428024768829346  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.6530055999756
block generation total time  154.58452081680298
average batch blocks generation time:  77.29226040840149
block dataloader generation time/epoch 367.98000206482993
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3902018070220947 |1.3229584693908691 |0.004453778266906738 |0.0001494884490966797 |0.00529325008392334 |0.0031232833862304688 |
----------------------------------------------------------pseudo_mini_loss sum 0.328669011592865
Total (block generation + training)time/epoch 371.82688115241376
Training time/epoch 3.862366199493408
Training time without block to device /epoch 1.21644926071167
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.00it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.65it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:00, 17.92it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.07it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.16it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.18it/s] 80%|████████  | 20/25 [00:01<00:00, 18.27it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.31it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.33it/s]100%|██████████| 25/25 [00:01<00:00, 18.22it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.43it/s]  8%|▊         | 2/25 [00:00<00:03,  6.53it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.52it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.51it/s] 20%|██        | 5/25 [00:00<00:03,  6.01it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.73it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.56it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.37it/s] 40%|████      | 10/25 [00:01<00:02,  5.33it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.29it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.26it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.25it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.25it/s] 60%|██████    | 15/25 [00:02<00:01,  5.23it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.24it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.22it/s] 80%|████████  | 20/25 [00:03<00:00,  5.23it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.20it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.19it/s] 92%|█████████▏| 23/25 [00:04<00:00,  4.98it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.35it/s]100%|██████████| 25/25 [00:04<00:00,  5.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.02it/s]  8%|▊         | 2/25 [00:00<00:03,  5.86it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.46it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.81it/s] 20%|██        | 5/25 [00:00<00:03,  6.04it/s] 24%|██▍       | 6/25 [00:01<00:03,  6.14it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.26it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.36it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.37it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.38it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.43it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.43it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.41it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.44it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.28it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.29it/s]100%|██████████| 25/25 [00:03<00:00,  6.86it/s]100%|██████████| 25/25 [00:03<00:00,  6.36it/s]
Run 00 | Epoch 00267 | Loss 0.3287 | Train 0.6868 | Val 0.6753 | Test 0.5448
Number of nodes during this epoch:  4638254
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429781436920166  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1352193355560303
range selection method range initialization spend 0.03580331802368164
time for parepare:  0.4155106544494629
local_output_nid generation:  0.02744603157043457
local_in_edges_tensor generation:  0.26059460639953613
mini_batch_src_global generation:  0.3699073791503906
r_  generation:  5.453857898712158
local_output_nid generation:  0.033959388732910156
local_in_edges_tensor generation:  0.21407556533813477
mini_batch_src_global generation:  0.4929828643798828
r_  generation:  5.779546737670898
----------------------check_connections_block total spend ----------------------------- 14.762486457824707
generate_one_block  7.266032695770264
generate_one_block  6.860748291015625
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.99741530418396
gen group dst list time:  0.09181571006774902
time for parepare:  0.4563932418823242
local_output_nid generation:  0.29514479637145996
local_in_edges_tensor generation:  1.6243739128112793
mini_batch_src_global generation:  2.5293891429901123
r_  generation:  29.827693939208984
local_output_nid generation:  0.5275759696960449
local_in_edges_tensor generation:  2.1140313148498535
mini_batch_src_global generation:  3.536928176879883
r_  generation:  30.260165214538574
----------------------check_connections_block total spend ----------------------------- 83.38920140266418
generate_one_block  40.727832317352295
generate_one_block  40.603158950805664
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2623441219329834
gen group dst list time:  0.18549132347106934
time for parepare:  0.49176812171936035
local_output_nid generation:  0.40450406074523926
local_in_edges_tensor generation:  1.5655617713928223
mini_batch_src_global generation:  2.0914833545684814
r_  generation:  26.383131742477417
local_output_nid generation:  0.7267024517059326
local_in_edges_tensor generation:  2.009836196899414
mini_batch_src_global generation:  2.838590145111084
r_  generation:  26.355751991271973
----------------------check_connections_block total spend ----------------------------- 73.060800075531
generate_one_block  35.41962790489197
generate_one_block  36.183554887771606
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429781436920166  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.4500014781952
block generation total time  152.93417406082153
average batch blocks generation time:  76.46708703041077
block dataloader generation time/epoch 367.980868529028
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38703644275665283 |1.3160160779953003 |0.004920601844787598 |0.00016832351684570312 |0.005038022994995117 |0.0018584728240966797 |
----------------------------------------------------------pseudo_mini_loss sum 0.3281551003456116
Total (block generation + training)time/epoch 371.8277041013561
Training time/epoch 3.8350276947021484
Training time without block to device /epoch 1.2029955387115479
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.12it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.36it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.08it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.40it/s] 40%|████      | 10/25 [00:00<00:00, 17.69it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.85it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.52it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.67it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.81it/s] 80%|████████  | 20/25 [00:01<00:00, 17.79it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.86it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.96it/s]100%|██████████| 25/25 [00:01<00:00, 17.87it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.53it/s]  8%|▊         | 2/25 [00:00<00:03,  6.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.60it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.64it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:03,  5.62it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.54it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.66it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.83it/s] 40%|████      | 10/25 [00:01<00:02,  5.85it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.96it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.09it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.24it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.35it/s] 60%|██████    | 15/25 [00:02<00:01,  6.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.39it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.40it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.02it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.69it/s] 80%|████████  | 20/25 [00:03<00:00,  5.42it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.06it/s] 88%|████████▊ | 22/25 [00:03<00:00,  4.84it/s] 92%|█████████▏| 23/25 [00:04<00:00,  4.91it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.91it/s]100%|██████████| 25/25 [00:04<00:00,  5.51it/s]100%|██████████| 25/25 [00:04<00:00,  5.76it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.74it/s]  8%|▊         | 2/25 [00:00<00:03,  6.16it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.36it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.47it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.53it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.11it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.73it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.53it/s] 40%|████      | 10/25 [00:01<00:02,  5.29it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.18it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.13it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.05it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.39it/s] 60%|██████    | 15/25 [00:02<00:01,  5.69it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.88it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.05it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.20it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.27it/s] 80%|████████  | 20/25 [00:03<00:00,  6.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.32it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.36it/s]100%|██████████| 25/25 [00:04<00:00,  6.03it/s]
Run 00 | Epoch 00268 | Loss 0.3282 | Train 0.6845 | Val 0.6732 | Test 0.5441
Number of nodes during this epoch:  4637830
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424657344818115  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1388206481933594
range selection method range initialization spend 0.02611064910888672
time for parepare:  0.36038756370544434
local_output_nid generation:  0.0282595157623291
local_in_edges_tensor generation:  0.20247983932495117
mini_batch_src_global generation:  0.37849950790405273
r_  generation:  5.580676794052124
local_output_nid generation:  0.029206275939941406
local_in_edges_tensor generation:  0.23345303535461426
mini_batch_src_global generation:  0.4568448066711426
r_  generation:  5.807803392410278
----------------------check_connections_block total spend ----------------------------- 14.802257537841797
generate_one_block  7.151708602905273
generate_one_block  6.775839805603027
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.86346173286438
gen group dst list time:  0.0948333740234375
time for parepare:  0.4837312698364258
local_output_nid generation:  0.2877326011657715
local_in_edges_tensor generation:  1.6417627334594727
mini_batch_src_global generation:  2.5520989894866943
r_  generation:  29.996880531311035
local_output_nid generation:  0.5362896919250488
local_in_edges_tensor generation:  2.165666103363037
mini_batch_src_global generation:  3.558108329772949
r_  generation:  30.209580659866333
----------------------check_connections_block total spend ----------------------------- 83.56586766242981
generate_one_block  40.851709604263306
generate_one_block  41.15790104866028
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.256805896759033
gen group dst list time:  0.1833024024963379
time for parepare:  0.4727003574371338
local_output_nid generation:  0.4208974838256836
local_in_edges_tensor generation:  1.5339381694793701
mini_batch_src_global generation:  2.055184841156006
r_  generation:  26.041399478912354
local_output_nid generation:  0.7187774181365967
local_in_edges_tensor generation:  1.8951663970947266
mini_batch_src_global generation:  2.8289904594421387
r_  generation:  25.858851432800293
----------------------check_connections_block total spend ----------------------------- 71.64519000053406
generate_one_block  35.11178421974182
generate_one_block  35.79339051246643
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424657344818115  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.21105766296387
block generation total time  152.91478538513184
average batch blocks generation time:  76.45739269256592
block dataloader generation time/epoch 367.9753445515402
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3867000341415405 |1.2883479595184326 |0.004406094551086426 |0.0001556873321533203 |0.005116105079650879 |0.0014510154724121094 |
----------------------------------------------------------pseudo_mini_loss sum 0.32977351546287537
Total (block generation + training)time/epoch 371.82194617689765
Training time/epoch 3.783719539642334
Training time without block to device /epoch 1.2070236206054688
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.36it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.67it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.36it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.80it/s] 40%|████      | 10/25 [00:00<00:00, 17.91it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.13it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.15it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.24it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.28it/s] 80%|████████  | 20/25 [00:01<00:00, 18.35it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.39it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.30it/s]100%|██████████| 25/25 [00:01<00:00, 18.28it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.50it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.57it/s] 20%|██        | 5/25 [00:00<00:03,  6.61it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.62it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.60it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.61it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.62it/s] 40%|████      | 10/25 [00:01<00:02,  6.63it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.60it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.61it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.61it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.61it/s] 60%|██████    | 15/25 [00:02<00:01,  6.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.61it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.62it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.62it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.61it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.60it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.59it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.58it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.57it/s]100%|██████████| 25/25 [00:03<00:00,  7.07it/s]100%|██████████| 25/25 [00:03<00:00,  6.66it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.72it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.77it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.69it/s] 20%|██        | 5/25 [00:00<00:02,  6.74it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.78it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.78it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.70it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.65it/s] 40%|████      | 10/25 [00:01<00:02,  6.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.18it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.62it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.46it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.29it/s] 60%|██████    | 15/25 [00:02<00:01,  5.13it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.04it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.06it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.07it/s] 76%|███████▌  | 19/25 [00:03<00:01,  3.99it/s] 80%|████████  | 20/25 [00:03<00:01,  4.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  4.97it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.03it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.51it/s]100%|██████████| 25/25 [00:04<00:00,  6.36it/s]100%|██████████| 25/25 [00:04<00:00,  5.66it/s]
Run 00 | Epoch 00269 | Loss 0.3298 | Train 0.6840 | Val 0.6714 | Test 0.5435
Number of nodes during this epoch:  4637199
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422329425811768  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1181018352508545
range selection method range initialization spend 0.024706125259399414
time for parepare:  0.38234567642211914
local_output_nid generation:  0.026365995407104492
local_in_edges_tensor generation:  0.23362326622009277
mini_batch_src_global generation:  0.37263035774230957
r_  generation:  5.413423538208008
local_output_nid generation:  0.028397798538208008
local_in_edges_tensor generation:  0.21426701545715332
mini_batch_src_global generation:  0.46983861923217773
r_  generation:  5.718562364578247
----------------------check_connections_block total spend ----------------------------- 14.540561199188232
generate_one_block  7.31227445602417
generate_one_block  6.992394208908081
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.04551362991333
gen group dst list time:  0.1107485294342041
time for parepare:  0.48932909965515137
local_output_nid generation:  0.28052330017089844
local_in_edges_tensor generation:  1.6341431140899658
mini_batch_src_global generation:  2.5166544914245605
r_  generation:  29.68623948097229
local_output_nid generation:  0.5290184020996094
local_in_edges_tensor generation:  2.102646589279175
mini_batch_src_global generation:  3.588804006576538
r_  generation:  29.855396509170532
----------------------check_connections_block total spend ----------------------------- 82.84690260887146
generate_one_block  40.785797119140625
generate_one_block  40.84134030342102
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.18021297454834
gen group dst list time:  0.18450284004211426
time for parepare:  0.4709291458129883
local_output_nid generation:  0.3889338970184326
local_in_edges_tensor generation:  1.54364013671875
mini_batch_src_global generation:  2.0237956047058105
r_  generation:  25.84838604927063
local_output_nid generation:  0.7341241836547852
local_in_edges_tensor generation:  2.118191719055176
mini_batch_src_global generation:  2.9391727447509766
r_  generation:  26.07649850845337
----------------------check_connections_block total spend ----------------------------- 72.33662819862366
generate_one_block  35.460495471954346
generate_one_block  35.759883403778076
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422329425811768  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.18353080749512
block generation total time  152.84751629829407
average batch blocks generation time:  76.42375814914703
block dataloader generation time/epoch 367.9700007473981
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3897925615310669 |1.3153338432312012 |0.004709959030151367 |0.00016415119171142578 |0.005080103874206543 |0.0014755725860595703 |
----------------------------------------------------------pseudo_mini_loss sum 0.32972386479377747
Total (block generation + training)time/epoch 371.8165766309809
Training time/epoch 3.8394713401794434
Training time without block to device /epoch 1.208803653717041
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.17it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.75it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.45it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.70it/s] 40%|████      | 10/25 [00:00<00:01, 14.07it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.30it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.17it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.82it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.18it/s] 80%|████████  | 20/25 [00:01<00:00, 17.44it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.66it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.88it/s]100%|██████████| 25/25 [00:01<00:00, 17.14it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.68it/s]  8%|▊         | 2/25 [00:00<00:03,  6.74it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.65it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.70it/s] 20%|██        | 5/25 [00:00<00:02,  6.71it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.75it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.12it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.28it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.36it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.81it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.03it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.22it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.81it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.03it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.24it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.47it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.59it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.64it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.64it/s]100%|██████████| 25/25 [00:03<00:00,  7.36it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.13it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.78it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.48it/s] 20%|██        | 5/25 [00:00<00:03,  5.36it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.29it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.45it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.77it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.99it/s] 40%|████      | 10/25 [00:01<00:02,  6.15it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.24it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.29it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.32it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.36it/s] 60%|██████    | 15/25 [00:02<00:01,  6.37it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.44it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.37it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.27it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.07it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.97it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.10it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.19it/s]100%|██████████| 25/25 [00:04<00:00,  6.17it/s]
Run 00 | Epoch 00270 | Loss 0.3297 | Train 0.6841 | Val 0.6725 | Test 0.5438
Number of nodes during this epoch:  4637624
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422853469848633  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1316578388214111
range selection method range initialization spend 0.024881839752197266
time for parepare:  0.4043092727661133
local_output_nid generation:  0.026460886001586914
local_in_edges_tensor generation:  0.27384448051452637
mini_batch_src_global generation:  0.3848738670349121
r_  generation:  5.484220027923584
local_output_nid generation:  0.02902388572692871
local_in_edges_tensor generation:  0.22611355781555176
mini_batch_src_global generation:  0.5182151794433594
r_  generation:  5.874691486358643
----------------------check_connections_block total spend ----------------------------- 14.958497285842896
generate_one_block  7.26122522354126
generate_one_block  6.963062524795532
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.0970234870910645
gen group dst list time:  0.09319210052490234
time for parepare:  0.4736518859863281
local_output_nid generation:  0.27109718322753906
local_in_edges_tensor generation:  1.6409125328063965
mini_batch_src_global generation:  2.5179543495178223
r_  generation:  29.995898246765137
local_output_nid generation:  0.5430762767791748
local_in_edges_tensor generation:  2.2618558406829834
mini_batch_src_global generation:  3.7373340129852295
r_  generation:  29.936360836029053
----------------------check_connections_block total spend ----------------------------- 83.40837597846985
generate_one_block  41.62113428115845
generate_one_block  40.88416600227356
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.274935722351074
gen group dst list time:  0.1828458309173584
time for parepare:  0.4699673652648926
local_output_nid generation:  0.37917542457580566
local_in_edges_tensor generation:  1.5125789642333984
mini_batch_src_global generation:  2.01220965385437
r_  generation:  25.386425256729126
local_output_nid generation:  0.7415339946746826
local_in_edges_tensor generation:  1.9149198532104492
mini_batch_src_global generation:  2.985610008239746
r_  generation:  25.791158437728882
----------------------check_connections_block total spend ----------------------------- 71.35795474052429
generate_one_block  35.28244924545288
generate_one_block  35.78740119934082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.422853469848633  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.76633071899414
block generation total time  153.5751507282257
average batch blocks generation time:  76.78757536411285
block dataloader generation time/epoch 367.967144843837
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39212048053741455 |1.3431943655014038 |0.004619240760803223 |0.00015747547149658203 |0.005097389221191406 |0.001842498779296875 |
----------------------------------------------------------pseudo_mini_loss sum 0.3272174000740051
Total (block generation + training)time/epoch 371.8140603581038
Training time/epoch 3.938232660293579
Training time without block to device /epoch 1.2518439292907715
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.48it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.17it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.58it/s] 40%|████      | 10/25 [00:00<00:00, 17.70it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.92it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.08it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.21it/s] 80%|████████  | 20/25 [00:01<00:00, 18.03it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.13it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.18it/s]100%|██████████| 25/25 [00:01<00:00, 18.08it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.53it/s]  8%|▊         | 2/25 [00:00<00:03,  6.59it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.56it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.59it/s] 20%|██        | 5/25 [00:00<00:03,  6.59it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.62it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.66it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.66it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.69it/s] 40%|████      | 10/25 [00:01<00:02,  6.17it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.25it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.43it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.48it/s] 60%|██████    | 15/25 [00:02<00:01,  6.51it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.54it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.56it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.15it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.14it/s] 80%|████████  | 20/25 [00:03<00:00,  6.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.45it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.31it/s]  8%|▊         | 2/25 [00:00<00:03,  6.45it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.46it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.44it/s] 20%|██        | 5/25 [00:00<00:03,  6.34it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.36it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.37it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.38it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.40it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.20it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.16it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.77it/s] 80%|████████  | 20/25 [00:03<00:00,  5.96it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.12it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.18it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.23it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.10it/s]100%|██████████| 25/25 [00:03<00:00,  6.84it/s]100%|██████████| 25/25 [00:03<00:00,  6.35it/s]
Run 00 | Epoch 00271 | Loss 0.3272 | Train 0.6872 | Val 0.6756 | Test 0.5460
Number of nodes during this epoch:  4636895
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425882339477539  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1537256240844727
range selection method range initialization spend 0.025912046432495117
time for parepare:  0.35962414741516113
local_output_nid generation:  0.025821208953857422
local_in_edges_tensor generation:  0.21744775772094727
mini_batch_src_global generation:  0.3770632743835449
r_  generation:  5.603359937667847
local_output_nid generation:  0.028604984283447266
local_in_edges_tensor generation:  0.2370152473449707
mini_batch_src_global generation:  0.47171759605407715
r_  generation:  5.826944828033447
----------------------check_connections_block total spend ----------------------------- 14.8921058177948
generate_one_block  7.610394477844238
generate_one_block  7.461778163909912
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.086740970611572
gen group dst list time:  0.09235692024230957
time for parepare:  0.49427318572998047
local_output_nid generation:  0.27579593658447266
local_in_edges_tensor generation:  1.783332347869873
mini_batch_src_global generation:  2.5247132778167725
r_  generation:  29.967260599136353
local_output_nid generation:  0.5433897972106934
local_in_edges_tensor generation:  2.2055933475494385
mini_batch_src_global generation:  3.744858503341675
r_  generation:  30.080503702163696
----------------------check_connections_block total spend ----------------------------- 83.61477518081665
generate_one_block  40.780447483062744
generate_one_block  41.1361563205719
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.185180187225342
gen group dst list time:  0.18787837028503418
time for parepare:  0.47332143783569336
local_output_nid generation:  0.4089646339416504
local_in_edges_tensor generation:  1.50262451171875
mini_batch_src_global generation:  2.035391330718994
r_  generation:  25.579724073410034
local_output_nid generation:  0.7724428176879883
local_in_edges_tensor generation:  1.975689172744751
mini_batch_src_global generation:  2.9740068912506104
r_  generation:  25.956371068954468
----------------------check_connections_block total spend ----------------------------- 72.00080466270447
generate_one_block  35.41478705406189
generate_one_block  35.824079513549805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425882339477539  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.61557984352112
block generation total time  153.15547037124634
average batch blocks generation time:  76.57773518562317
block dataloader generation time/epoch 367.9714386752423
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4468421936035156 |1.367051124572754 |0.004450559616088867 |0.0001659393310546875 |0.005157828330993652 |0.0029745101928710938 |
----------------------------------------------------------pseudo_mini_loss sum 0.3289335072040558
Total (block generation + training)time/epoch 371.81916005295864
Training time/epoch 4.065930128097534
Training time without block to device /epoch 1.3318278789520264
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.13it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.55it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.97it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.43it/s] 40%|████      | 10/25 [00:00<00:00, 17.56it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.78it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.90it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.98it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.01it/s] 80%|████████  | 20/25 [00:01<00:00, 18.08it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.15it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.18it/s]100%|██████████| 25/25 [00:01<00:00, 18.03it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.20it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.68it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.89it/s] 20%|██        | 5/25 [00:00<00:03,  6.08it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.24it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.18it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.24it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.31it/s] 40%|████      | 10/25 [00:01<00:02,  6.31it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.35it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.35it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.36it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.40it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.39it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.43it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.44it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  7.08it/s]100%|██████████| 25/25 [00:03<00:00,  6.39it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.13it/s]  8%|▊         | 2/25 [00:00<00:03,  6.17it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.26it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.33it/s] 20%|██        | 5/25 [00:00<00:03,  6.31it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.29it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.31it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.30it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.19it/s] 40%|████      | 10/25 [00:01<00:02,  6.18it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.79it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.73it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.92it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.96it/s] 60%|██████    | 15/25 [00:02<00:01,  6.03it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.00it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.02it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.04it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.15it/s] 80%|████████  | 20/25 [00:03<00:00,  6.03it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.81it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.82it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.93it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.02it/s]100%|██████████| 25/25 [00:04<00:00,  6.82it/s]100%|██████████| 25/25 [00:04<00:00,  6.14it/s]
Run 00 | Epoch 00272 | Loss 0.3289 | Train 0.6868 | Val 0.6745 | Test 0.5452
Number of nodes during this epoch:  4636885
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42608118057251  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1576383113861084
range selection method range initialization spend 0.031337738037109375
time for parepare:  0.3943922519683838
local_output_nid generation:  0.02690887451171875
local_in_edges_tensor generation:  0.2256004810333252
mini_batch_src_global generation:  0.3791778087615967
r_  generation:  5.682962894439697
local_output_nid generation:  0.02914714813232422
local_in_edges_tensor generation:  0.23717284202575684
mini_batch_src_global generation:  0.46892619132995605
r_  generation:  5.9104814529418945
----------------------check_connections_block total spend ----------------------------- 15.039520502090454
generate_one_block  7.232917785644531
generate_one_block  6.918194770812988
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.048834800720215
gen group dst list time:  0.08508133888244629
time for parepare:  0.46718525886535645
local_output_nid generation:  0.27792787551879883
local_in_edges_tensor generation:  1.7614078521728516
mini_batch_src_global generation:  2.5168464183807373
r_  generation:  30.549306392669678
local_output_nid generation:  0.5368704795837402
local_in_edges_tensor generation:  2.1036996841430664
mini_batch_src_global generation:  3.7647652626037598
r_  generation:  30.05742335319519
----------------------check_connections_block total spend ----------------------------- 84.19768977165222
generate_one_block  41.30761647224426
generate_one_block  40.835164308547974
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3767952919006348
gen group dst list time:  0.19523358345031738
time for parepare:  0.4976933002471924
local_output_nid generation:  0.4230365753173828
local_in_edges_tensor generation:  1.5294907093048096
mini_batch_src_global generation:  2.02258038520813
r_  generation:  26.266330003738403
local_output_nid generation:  0.7504303455352783
local_in_edges_tensor generation:  2.031550407409668
mini_batch_src_global generation:  2.939096689224243
r_  generation:  26.898587703704834
----------------------check_connections_block total spend ----------------------------- 73.9075779914856
generate_one_block  36.60994744300842
generate_one_block  35.720752000808716
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42608118057251  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  158.10526776313782
block generation total time  154.47348022460938
average batch blocks generation time:  77.23674011230469
block dataloader generation time/epoch 367.98672384132834
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3772006034851074 |1.3683167695999146 |0.0043097734451293945 |0.00014913082122802734 |0.004961609840393066 |0.0029888153076171875 |
----------------------------------------------------------pseudo_mini_loss sum 0.32929253578186035
Total (block generation + training)time/epoch 371.83473621619925
Training time/epoch 3.9269826412200928
Training time without block to device /epoch 1.1903491020202637
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.25it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.88it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.65it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.25it/s] 40%|████      | 10/25 [00:00<00:00, 17.52it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.75it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.55it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.28it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.44it/s] 80%|████████  | 20/25 [00:01<00:00, 17.38it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.36it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.35it/s]100%|██████████| 25/25 [00:01<00:00, 17.43it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.20it/s]  8%|▊         | 2/25 [00:00<00:04,  5.06it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.04it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.97it/s] 20%|██        | 5/25 [00:01<00:04,  4.90it/s] 24%|██▍       | 6/25 [00:01<00:03,  4.91it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.93it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.83it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.21it/s] 40%|████      | 10/25 [00:01<00:02,  5.59it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.89it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.63it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.38it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.29it/s] 60%|██████    | 15/25 [00:02<00:01,  5.24it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.20it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.13it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.08it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.24it/s] 80%|████████  | 20/25 [00:03<00:00,  5.62it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.88it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.68it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.52it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.42it/s]100%|██████████| 25/25 [00:04<00:00,  6.02it/s]100%|██████████| 25/25 [00:04<00:00,  5.37it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.35it/s]  8%|▊         | 2/25 [00:00<00:03,  6.04it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.00it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.26it/s] 20%|██        | 5/25 [00:00<00:03,  6.36it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.52it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.54it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.53it/s] 40%|████      | 10/25 [00:01<00:02,  6.56it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.58it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.60it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.60it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.59it/s] 60%|██████    | 15/25 [00:02<00:01,  6.60it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.58it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.56it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.45it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.45it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
Run 00 | Epoch 00273 | Loss 0.3293 | Train 0.6833 | Val 0.6716 | Test 0.5439
Number of nodes during this epoch:  4637788
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4217424392700195  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1923086643218994
range selection method range initialization spend 0.024779319763183594
time for parepare:  0.3874523639678955
local_output_nid generation:  0.02598714828491211
local_in_edges_tensor generation:  0.22975730895996094
mini_batch_src_global generation:  0.39004993438720703
r_  generation:  5.472826242446899
local_output_nid generation:  0.0290830135345459
local_in_edges_tensor generation:  0.22543859481811523
mini_batch_src_global generation:  0.45763468742370605
r_  generation:  5.824833631515503
----------------------check_connections_block total spend ----------------------------- 14.745144605636597
generate_one_block  7.208654403686523
generate_one_block  6.911691427230835
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.018329620361328
gen group dst list time:  0.08931541442871094
time for parepare:  0.480457067489624
local_output_nid generation:  0.27446579933166504
local_in_edges_tensor generation:  1.5854988098144531
mini_batch_src_global generation:  2.556894540786743
r_  generation:  29.8232421875
local_output_nid generation:  0.5373783111572266
local_in_edges_tensor generation:  2.1205196380615234
mini_batch_src_global generation:  3.775855779647827
r_  generation:  29.81076169013977
----------------------check_connections_block total spend ----------------------------- 82.83380627632141
generate_one_block  40.90289568901062
generate_one_block  40.76606750488281
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.194349527359009
gen group dst list time:  0.18629145622253418
time for parepare:  0.498380184173584
local_output_nid generation:  0.4238753318786621
local_in_edges_tensor generation:  1.7273530960083008
mini_batch_src_global generation:  2.0172152519226074
r_  generation:  26.206099033355713
local_output_nid generation:  0.7509632110595703
local_in_edges_tensor generation:  1.9950788021087646
mini_batch_src_global generation:  2.958656072616577
r_  generation:  26.78507161140442
----------------------check_connections_block total spend ----------------------------- 74.00167226791382
generate_one_block  37.00392007827759
generate_one_block  37.595523834228516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4217424392700195  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.83547854423523
block generation total time  156.26840710639954
average batch blocks generation time:  78.13420355319977
block dataloader generation time/epoch 368.0005978815747
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41443371772766113 |1.4549815654754639 |0.004734635353088379 |0.0001703500747680664 |0.005239129066467285 |0.001402139663696289 |
----------------------------------------------------------pseudo_mini_loss sum 0.32814180850982666
Total (block generation + training)time/epoch 371.84983062570114
Training time/epoch 4.182207107543945
Training time without block to device /epoch 1.2722439765930176
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 13.98it/s] 16%|█▌        | 4/25 [00:00<00:01, 14.97it/s] 24%|██▍       | 6/25 [00:00<00:01, 15.61it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.01it/s] 40%|████      | 10/25 [00:00<00:00, 16.10it/s] 48%|████▊     | 12/25 [00:00<00:00, 16.28it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.37it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.34it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.43it/s] 80%|████████  | 20/25 [00:01<00:00, 16.43it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.51it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.58it/s]100%|██████████| 25/25 [00:01<00:00, 16.46it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.17it/s]  8%|▊         | 2/25 [00:00<00:03,  6.18it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.20it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.21it/s] 20%|██        | 5/25 [00:00<00:03,  6.19it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.19it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.19it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.22it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.22it/s] 40%|████      | 10/25 [00:01<00:02,  5.84it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.90it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.98it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.03it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.08it/s] 60%|██████    | 15/25 [00:02<00:01,  6.10it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.12it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.14it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.16it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.18it/s] 80%|████████  | 20/25 [00:03<00:00,  6.16it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.18it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.11it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.77it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.54it/s]100%|██████████| 25/25 [00:04<00:00,  6.19it/s]100%|██████████| 25/25 [00:04<00:00,  6.09it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.43it/s]  8%|▊         | 2/25 [00:00<00:03,  5.79it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.97it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.96it/s] 20%|██        | 5/25 [00:00<00:03,  5.98it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.97it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.94it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.02it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.05it/s] 40%|████      | 10/25 [00:01<00:02,  6.07it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.08it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.09it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.12it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.01it/s] 60%|██████    | 15/25 [00:02<00:01,  5.57it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.52it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.61it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.71it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.72it/s] 80%|████████  | 20/25 [00:03<00:00,  5.85it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.90it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.98it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.99it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.02it/s]100%|██████████| 25/25 [00:04<00:00,  6.67it/s]100%|██████████| 25/25 [00:04<00:00,  5.99it/s]
Run 00 | Epoch 00274 | Loss 0.3281 | Train 0.6829 | Val 0.6708 | Test 0.5436
Number of nodes during this epoch:  4637351
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424356460571289  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1501452922821045
range selection method range initialization spend 0.024619340896606445
time for parepare:  0.3605821132659912
local_output_nid generation:  0.026200056076049805
local_in_edges_tensor generation:  0.19287610054016113
mini_batch_src_global generation:  0.3738210201263428
r_  generation:  5.4168455600738525
local_output_nid generation:  0.028048992156982422
local_in_edges_tensor generation:  0.21876955032348633
mini_batch_src_global generation:  0.4789543151855469
r_  generation:  5.710267543792725
----------------------check_connections_block total spend ----------------------------- 14.482035398483276
generate_one_block  7.183751106262207
generate_one_block  6.782850742340088
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.026288032531738
gen group dst list time:  0.09604620933532715
time for parepare:  0.4489412307739258
local_output_nid generation:  0.27245187759399414
local_in_edges_tensor generation:  1.8234837055206299
mini_batch_src_global generation:  2.438953399658203
r_  generation:  29.66247296333313
local_output_nid generation:  0.5221552848815918
local_in_edges_tensor generation:  2.2169013023376465
mini_batch_src_global generation:  3.512103796005249
r_  generation:  30.06726622581482
----------------------check_connections_block total spend ----------------------------- 82.85206270217896
generate_one_block  41.31840372085571
generate_one_block  41.085126876831055
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.236898899078369
gen group dst list time:  0.19075369834899902
time for parepare:  0.4563109874725342
local_output_nid generation:  0.39923524856567383
local_in_edges_tensor generation:  1.5827014446258545
mini_batch_src_global generation:  2.1855340003967285
r_  generation:  26.21948790550232
local_output_nid generation:  0.7334842681884766
local_in_edges_tensor generation:  1.9470949172973633
mini_batch_src_global generation:  2.8208324909210205
r_  generation:  26.199790954589844
----------------------check_connections_block total spend ----------------------------- 72.63033056259155
generate_one_block  35.20291829109192
generate_one_block  36.16908669471741
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424356460571289  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.4823932647705
block generation total time  153.7755355834961
average batch blocks generation time:  76.88776779174805
block dataloader generation time/epoch 367.99743652950633
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3849383592605591 |1.3123029470443726 |0.004527926445007324 |0.0001531839370727539 |0.00505828857421875 |0.0029261112213134766 |
----------------------------------------------------------pseudo_mini_loss sum 0.32627397775650024
Total (block generation + training)time/epoch 371.84658671552484
Training time/epoch 3.8263509273529053
Training time without block to device /epoch 1.2017450332641602
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.77it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.53it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.22it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.66it/s] 40%|████      | 10/25 [00:00<00:01, 14.07it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.26it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.95it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.62it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.05it/s] 80%|████████  | 20/25 [00:01<00:00, 17.38it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.66it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.80it/s]100%|██████████| 25/25 [00:01<00:00, 17.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.26it/s]  8%|▊         | 2/25 [00:00<00:04,  5.18it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.18it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.13it/s] 20%|██        | 5/25 [00:00<00:03,  5.47it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.80it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.63it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.39it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.62it/s] 40%|████      | 10/25 [00:01<00:02,  5.89it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.98it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.12it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.25it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.23it/s] 60%|██████    | 15/25 [00:02<00:01,  6.29it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.29it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.33it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.37it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.40it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.35it/s]100%|██████████| 25/25 [00:04<00:00,  7.06it/s]100%|██████████| 25/25 [00:04<00:00,  6.10it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.09it/s]  8%|▊         | 2/25 [00:00<00:03,  6.19it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.23it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.20it/s] 20%|██        | 5/25 [00:00<00:03,  6.24it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.22it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.25it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.09it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.11it/s] 40%|████      | 10/25 [00:01<00:02,  5.90it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.64it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.83it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.96it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.09it/s] 60%|██████    | 15/25 [00:02<00:01,  6.17it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.18it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.20it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.20it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.22it/s] 80%|████████  | 20/25 [00:03<00:00,  6.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.23it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.27it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.89it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.65it/s]100%|██████████| 25/25 [00:04<00:00,  6.37it/s]100%|██████████| 25/25 [00:04<00:00,  6.12it/s]
Run 00 | Epoch 00275 | Loss 0.3263 | Train 0.6843 | Val 0.6720 | Test 0.5439
Number of nodes during this epoch:  4637836
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42534875869751  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1496236324310303
range selection method range initialization spend 0.02798295021057129
time for parepare:  0.39081430435180664
local_output_nid generation:  0.028138399124145508
local_in_edges_tensor generation:  0.239487886428833
mini_batch_src_global generation:  0.3914473056793213
r_  generation:  5.590318918228149
local_output_nid generation:  0.030758142471313477
local_in_edges_tensor generation:  0.24356770515441895
mini_batch_src_global generation:  0.48549818992614746
r_  generation:  5.897670745849609
----------------------check_connections_block total spend ----------------------------- 15.07979440689087
generate_one_block  7.2465808391571045
generate_one_block  6.9270689487457275
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.019867420196533
gen group dst list time:  0.0924835205078125
time for parepare:  0.45702433586120605
local_output_nid generation:  0.27231884002685547
local_in_edges_tensor generation:  1.6460790634155273
mini_batch_src_global generation:  2.5199010372161865
r_  generation:  29.898085117340088
local_output_nid generation:  0.5359458923339844
local_in_edges_tensor generation:  2.300405979156494
mini_batch_src_global generation:  3.7256834506988525
r_  generation:  29.75476574897766
----------------------check_connections_block total spend ----------------------------- 83.12540578842163
generate_one_block  41.117783069610596
generate_one_block  40.66536331176758
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.294553518295288
gen group dst list time:  0.1802818775177002
time for parepare:  0.46587491035461426
local_output_nid generation:  0.38069748878479004
local_in_edges_tensor generation:  1.4464671611785889
mini_batch_src_global generation:  2.0061724185943604
r_  generation:  25.4094820022583
local_output_nid generation:  0.7324798107147217
local_in_edges_tensor generation:  1.9223926067352295
mini_batch_src_global generation:  2.9121954441070557
r_  generation:  25.80653190612793
----------------------check_connections_block total spend ----------------------------- 70.83461952209473
generate_one_block  35.05100059509277
generate_one_block  35.83994674682617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42534875869751  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.96002531051636
block generation total time  152.67409372329712
average batch blocks generation time:  76.33704686164856
block dataloader generation time/epoch 367.98973685762155
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3885979652404785 |1.2953341007232666 |0.004361152648925781 |0.00015604496002197266 |0.0051795244216918945 |0.0013861656188964844 |
----------------------------------------------------------pseudo_mini_loss sum 0.33022594451904297
Total (block generation + training)time/epoch 371.83869831717533
Training time/epoch 3.796884775161743
Training time without block to device /epoch 1.20621657371521
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.24it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.57it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.25it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.67it/s] 40%|████      | 10/25 [00:00<00:00, 17.88it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.80it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.00it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.06it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.14it/s] 80%|████████  | 20/25 [00:01<00:00, 18.18it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.21it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.25it/s]100%|██████████| 25/25 [00:01<00:00, 18.14it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.46it/s]  8%|▊         | 2/25 [00:00<00:03,  6.55it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.57it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.57it/s] 20%|██        | 5/25 [00:00<00:03,  6.57it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.59it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.59it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.57it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.52it/s] 40%|████      | 10/25 [00:01<00:02,  6.54it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.57it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.56it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.57it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.57it/s] 60%|██████    | 15/25 [00:02<00:01,  6.57it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.56it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.53it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.54it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.55it/s] 80%|████████  | 20/25 [00:03<00:00,  6.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.53it/s]100%|██████████| 25/25 [00:03<00:00,  6.65it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.24it/s]  8%|▊         | 2/25 [00:00<00:03,  6.38it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.48it/s] 20%|██        | 5/25 [00:00<00:03,  6.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.44it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.49it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.28it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.35it/s] 60%|██████    | 15/25 [00:02<00:01,  6.15it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.24it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.32it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.22it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.27it/s] 80%|████████  | 20/25 [00:03<00:00,  6.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.35it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.40it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00276 | Loss 0.3302 | Train 0.6830 | Val 0.6708 | Test 0.5434
Number of nodes during this epoch:  4637497
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4229350090026855  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.154001235961914
range selection method range initialization spend 0.02470707893371582
time for parepare:  0.35063791275024414
local_output_nid generation:  0.026101350784301758
local_in_edges_tensor generation:  0.18346309661865234
mini_batch_src_global generation:  0.36812496185302734
r_  generation:  5.2787370681762695
local_output_nid generation:  0.026605606079101562
local_in_edges_tensor generation:  0.1929917335510254
mini_batch_src_global generation:  0.4544203281402588
r_  generation:  5.5340588092803955
----------------------check_connections_block total spend ----------------------------- 14.004399538040161
generate_one_block  7.066863059997559
generate_one_block  6.660318374633789
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.158661842346191
gen group dst list time:  0.08457827568054199
time for parepare:  0.4123225212097168
local_output_nid generation:  0.2516798973083496
local_in_edges_tensor generation:  1.586273193359375
mini_batch_src_global generation:  2.4551773071289062
r_  generation:  29.57656741142273
local_output_nid generation:  0.5371437072753906
local_in_edges_tensor generation:  2.087538957595825
mini_batch_src_global generation:  3.6017980575561523
r_  generation:  29.924089431762695
----------------------check_connections_block total spend ----------------------------- 82.46385407447815
generate_one_block  41.18098020553589
generate_one_block  40.98279333114624
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.281294107437134
gen group dst list time:  0.1926584243774414
time for parepare:  0.4565582275390625
local_output_nid generation:  0.40222692489624023
local_in_edges_tensor generation:  1.5351383686065674
mini_batch_src_global generation:  2.191793918609619
r_  generation:  26.311294317245483
local_output_nid generation:  0.7155272960662842
local_in_edges_tensor generation:  1.92325758934021
mini_batch_src_global generation:  2.829152822494507
r_  generation:  26.114673852920532
----------------------check_connections_block total spend ----------------------------- 72.3924331665039
generate_one_block  35.40128040313721
generate_one_block  36.16443634033203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4229350090026855  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.85628724098206
block generation total time  153.72949028015137
average batch blocks generation time:  76.86474514007568
block dataloader generation time/epoch 367.9818355830568
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.43944835662841797 |1.3450456857681274 |0.004904627799987793 |0.0001723766326904297 |0.005055785179138184 |0.001802682876586914 |
----------------------------------------------------------pseudo_mini_loss sum 0.3299400210380554
Total (block generation + training)time/epoch 371.8313643906521
Training time/epoch 4.005933523178101
Training time without block to device /epoch 1.3158421516418457
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.71it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.42it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.55it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.16it/s] 40%|████      | 10/25 [00:00<00:00, 17.47it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.36it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.61it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.86it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.50it/s] 80%|████████  | 20/25 [00:01<00:00, 17.76it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.85it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.75it/s]100%|██████████| 25/25 [00:01<00:00, 17.69it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.55it/s]  8%|▊         | 2/25 [00:00<00:03,  6.75it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.99it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.50it/s] 20%|██        | 5/25 [00:00<00:03,  5.89it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.22it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.41it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.57it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.03it/s] 40%|████      | 10/25 [00:01<00:02,  5.67it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.93it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.17it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.39it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.63it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.07it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.14it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.32it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.55it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.99it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.18it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.37it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.96it/s]100%|██████████| 25/25 [00:04<00:00,  6.39it/s]100%|██████████| 25/25 [00:04<00:00,  6.22it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.89it/s]  8%|▊         | 2/25 [00:00<00:03,  6.29it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.65it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.01it/s] 20%|██        | 5/25 [00:00<00:03,  6.15it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.33it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.38it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.89it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.08it/s] 40%|████      | 10/25 [00:01<00:02,  6.24it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.29it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.58it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.11it/s] 60%|██████    | 15/25 [00:02<00:01,  5.58it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.08it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.25it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.61it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.92it/s] 80%|████████  | 20/25 [00:03<00:00,  6.12it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.27it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.38it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.94it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.56it/s]100%|██████████| 25/25 [00:04<00:00,  5.86it/s]100%|██████████| 25/25 [00:04<00:00,  5.96it/s]
Run 00 | Epoch 00277 | Loss 0.3299 | Train 0.6829 | Val 0.6703 | Test 0.5424
Number of nodes during this epoch:  4637882
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4243550300598145  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.12461256980896
range selection method range initialization spend 0.03454709053039551
time for parepare:  0.38617634773254395
local_output_nid generation:  0.028603553771972656
local_in_edges_tensor generation:  0.21794915199279785
mini_batch_src_global generation:  0.37683987617492676
r_  generation:  5.723432302474976
local_output_nid generation:  0.028908252716064453
local_in_edges_tensor generation:  0.2370452880859375
mini_batch_src_global generation:  0.4664018154144287
r_  generation:  5.945223569869995
----------------------check_connections_block total spend ----------------------------- 15.092145919799805
generate_one_block  7.252547740936279
generate_one_block  6.910379409790039
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.070284366607666
gen group dst list time:  0.08667445182800293
time for parepare:  0.4673278331756592
local_output_nid generation:  0.25957226753234863
local_in_edges_tensor generation:  1.6070430278778076
mini_batch_src_global generation:  2.6550254821777344
r_  generation:  30.23681950569153
local_output_nid generation:  0.5254297256469727
local_in_edges_tensor generation:  2.124351739883423
mini_batch_src_global generation:  3.5644211769104004
r_  generation:  30.310078859329224
----------------------check_connections_block total spend ----------------------------- 84.06074261665344
generate_one_block  40.59766387939453
generate_one_block  40.851250410079956
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1592605113983154
gen group dst list time:  0.18717384338378906
time for parepare:  0.47636985778808594
local_output_nid generation:  0.411823034286499
local_in_edges_tensor generation:  1.5970873832702637
mini_batch_src_global generation:  2.094743251800537
r_  generation:  27.31414818763733
local_output_nid generation:  0.735400915145874
local_in_edges_tensor generation:  1.957754373550415
mini_batch_src_global generation:  2.854163408279419
r_  generation:  26.001339197158813
----------------------check_connections_block total spend ----------------------------- 73.70838236808777
generate_one_block  35.16174578666687
generate_one_block  35.93979358673096
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4243550300598145  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.7691249847412
block generation total time  152.55045366287231
average batch blocks generation time:  76.27522683143616
block dataloader generation time/epoch 367.9876953749348
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38166987895965576 |1.294716715812683 |0.004431009292602539 |0.00015342235565185547 |0.005089282989501953 |0.0029158592224121094 |
----------------------------------------------------------pseudo_mini_loss sum 0.32897764444351196
Total (block generation + training)time/epoch 371.83698703659525
Training time/epoch 3.7834208011627197
Training time without block to device /epoch 1.1939873695373535
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.82it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.03it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.48it/s] 40%|████      | 10/25 [00:00<00:00, 17.76it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.94it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.97it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.09it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.13it/s] 80%|████████  | 20/25 [00:01<00:00, 18.08it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.89it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.02it/s]100%|██████████| 25/25 [00:01<00:00, 18.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.05it/s]  8%|▊         | 2/25 [00:00<00:04,  5.10it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.14it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.15it/s] 20%|██        | 5/25 [00:00<00:03,  5.16it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.17it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.15it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.97it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.64it/s] 40%|████      | 10/25 [00:02<00:03,  4.82it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.88it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.07it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.37it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.59it/s] 60%|██████    | 15/25 [00:02<00:01,  5.81it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.63it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.44it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.27it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.70it/s] 80%|████████  | 20/25 [00:03<00:00,  5.10it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.40it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.67it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.88it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.05it/s]100%|██████████| 25/25 [00:04<00:00,  5.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:03,  6.34it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.31it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.34it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.32it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.35it/s] 40%|████      | 10/25 [00:01<00:02,  6.38it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.34it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.33it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.37it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.37it/s] 60%|██████    | 15/25 [00:02<00:01,  6.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.37it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.41it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.35it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.39it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.47it/s]
Run 00 | Epoch 00278 | Loss 0.3290 | Train 0.6856 | Val 0.6733 | Test 0.5436
Number of nodes during this epoch:  4637709
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42703914642334  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1906089782714844
range selection method range initialization spend 0.03715229034423828
time for parepare:  0.3660709857940674
local_output_nid generation:  0.026838302612304688
local_in_edges_tensor generation:  0.21861696243286133
mini_batch_src_global generation:  0.3839602470397949
r_  generation:  5.644482135772705
local_output_nid generation:  0.031122684478759766
local_in_edges_tensor generation:  0.2372148036956787
mini_batch_src_global generation:  0.46878504753112793
r_  generation:  5.943001747131348
----------------------check_connections_block total spend ----------------------------- 15.017030239105225
generate_one_block  7.242314100265503
generate_one_block  6.942646026611328
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9843318462371826
gen group dst list time:  0.0836184024810791
time for parepare:  0.47000622749328613
local_output_nid generation:  0.2743523120880127
local_in_edges_tensor generation:  1.61773681640625
mini_batch_src_global generation:  2.5472912788391113
r_  generation:  30.13506817817688
local_output_nid generation:  0.5395066738128662
local_in_edges_tensor generation:  2.0788745880126953
mini_batch_src_global generation:  3.7388415336608887
r_  generation:  29.9844069480896
----------------------check_connections_block total spend ----------------------------- 83.45315313339233
generate_one_block  41.339599609375
generate_one_block  41.169795989990234
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.290736198425293
gen group dst list time:  0.1817150115966797
time for parepare:  0.4402744770050049
local_output_nid generation:  0.40294575691223145
local_in_edges_tensor generation:  1.4805858135223389
mini_batch_src_global generation:  2.1923274993896484
r_  generation:  26.267478466033936
local_output_nid generation:  0.7717459201812744
local_in_edges_tensor generation:  1.9377875328063965
mini_batch_src_global generation:  2.8845131397247314
r_  generation:  25.96860432624817
----------------------check_connections_block total spend ----------------------------- 72.51540446281433
generate_one_block  35.40629959106445
generate_one_block  36.049870014190674
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42703914642334  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.96855759620667
block generation total time  153.96556520462036
average batch blocks generation time:  76.98278260231018
block dataloader generation time/epoch 367.9914980960149
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38455331325531006 |1.391953706741333 |0.0048531293869018555 |0.00016808509826660156 |0.005106210708618164 |0.0018105506896972656 |
----------------------------------------------------------pseudo_mini_loss sum 0.3275671601295471
Total (block generation + training)time/epoch 371.8412776617166
Training time/epoch 3.9852347373962402
Training time without block to device /epoch 1.2013273239135742
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.22it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.65it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.31it/s] 40%|████      | 10/25 [00:00<00:00, 17.69it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.71it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.90it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.85it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.88it/s] 80%|████████  | 20/25 [00:01<00:00, 18.00it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.08it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.21it/s]100%|██████████| 25/25 [00:01<00:00, 17.96it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.68it/s]  8%|▊         | 2/25 [00:00<00:03,  5.82it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.30it/s] 20%|██        | 5/25 [00:00<00:03,  5.25it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.17it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.12it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.08it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.07it/s] 40%|████      | 10/25 [00:01<00:02,  5.06it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.92it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.99it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.22it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.60it/s] 60%|██████    | 15/25 [00:02<00:01,  5.84it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.10it/s] 68%|██████▊   | 17/25 [00:03<00:01,  6.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.35it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.09it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.57it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.76it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.93it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.01it/s]100%|██████████| 25/25 [00:04<00:00,  5.71it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.08it/s]  8%|▊         | 2/25 [00:00<00:03,  6.24it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.14it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.24it/s] 20%|██        | 5/25 [00:00<00:03,  6.14it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.28it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.29it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.40it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.45it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.42it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.49it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.45it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.43it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.42it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.40it/s]100%|██████████| 25/25 [00:03<00:00,  6.48it/s]
Run 00 | Epoch 00279 | Loss 0.3276 | Train 0.6849 | Val 0.6733 | Test 0.5432
Number of nodes during this epoch:  4637718
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421531677246094  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.2234127521514893
range selection method range initialization spend 0.025000333786010742
time for parepare:  0.3651087284088135
local_output_nid generation:  0.02673816680908203
local_in_edges_tensor generation:  0.19040799140930176
mini_batch_src_global generation:  0.37018489837646484
r_  generation:  5.39149284362793
local_output_nid generation:  0.02767658233642578
local_in_edges_tensor generation:  0.21428513526916504
mini_batch_src_global generation:  0.47161149978637695
r_  generation:  5.62268328666687
----------------------check_connections_block total spend ----------------------------- 14.364787101745605
generate_one_block  7.137173891067505
generate_one_block  6.721849203109741
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.186401605606079
gen group dst list time:  0.08917927742004395
time for parepare:  0.4488692283630371
local_output_nid generation:  0.2660830020904541
local_in_edges_tensor generation:  1.7037146091461182
mini_batch_src_global generation:  2.4258992671966553
r_  generation:  29.496408224105835
local_output_nid generation:  0.5221800804138184
local_in_edges_tensor generation:  2.0375001430511475
mini_batch_src_global generation:  3.670742988586426
r_  generation:  31.25135827064514
----------------------check_connections_block total spend ----------------------------- 84.82777047157288
generate_one_block  41.28196835517883
generate_one_block  41.261502742767334
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3629658222198486
gen group dst list time:  0.2053229808807373
time for parepare:  0.4794759750366211
local_output_nid generation:  0.416201114654541
local_in_edges_tensor generation:  1.5626530647277832
mini_batch_src_global generation:  2.016465902328491
r_  generation:  26.34407329559326
local_output_nid generation:  0.722339391708374
local_in_edges_tensor generation:  2.0024704933166504
mini_batch_src_global generation:  2.8235929012298584
r_  generation:  26.05427050590515
----------------------check_connections_block total spend ----------------------------- 72.33189272880554
generate_one_block  35.17823934555054
generate_one_block  35.817617893218994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421531677246094  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.15966320037842
block generation total time  153.5393283367157
average batch blocks generation time:  76.76966416835785
block dataloader generation time/epoch 367.99488484859467
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3842642307281494 |1.2935388088226318 |0.004406332969665527 |0.00014841556549072266 |0.005008578300476074 |0.0014204978942871094 |
----------------------------------------------------------pseudo_mini_loss sum 0.3294486403465271
Total (block generation + training)time/epoch 371.8444391642298
Training time/epoch 3.786529779434204
Training time without block to device /epoch 1.1994521617889404
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.02it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.86it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.53it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.79it/s] 40%|████      | 10/25 [00:00<00:01, 14.15it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.33it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.18it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.66it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.14it/s] 80%|████████  | 20/25 [00:01<00:00, 17.48it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.71it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.91it/s]100%|██████████| 25/25 [00:01<00:00, 17.16it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.54it/s]  8%|▊         | 2/25 [00:00<00:03,  6.52it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.54it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.55it/s] 20%|██        | 5/25 [00:00<00:03,  6.51it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.51it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.51it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.48it/s] 40%|████      | 10/25 [00:01<00:02,  6.49it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.50it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.44it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.44it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.28it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.29it/s] 76%|███████▌  | 19/25 [00:02<00:01,  5.94it/s] 80%|████████  | 20/25 [00:03<00:00,  5.64it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.61it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.70it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.82it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.96it/s]100%|██████████| 25/25 [00:03<00:00,  6.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.00it/s]  8%|▊         | 2/25 [00:00<00:03,  6.14it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.25it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.30it/s] 20%|██        | 5/25 [00:00<00:03,  6.34it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.31it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.35it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.93it/s] 40%|████      | 10/25 [00:01<00:02,  5.71it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.77it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.91it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.04it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.13it/s] 60%|██████    | 15/25 [00:02<00:01,  6.22it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.26it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.33it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.37it/s] 80%|████████  | 20/25 [00:03<00:00,  6.31it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.32it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.33it/s]100%|██████████| 25/25 [00:03<00:00,  6.30it/s]
Run 00 | Epoch 00280 | Loss 0.3294 | Train 0.6806 | Val 0.6686 | Test 0.5399
Number of nodes during this epoch:  4637815
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429263591766357  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1580195426940918
range selection method range initialization spend 0.024953603744506836
time for parepare:  0.36298513412475586
local_output_nid generation:  0.02614760398864746
local_in_edges_tensor generation:  0.21750879287719727
mini_batch_src_global generation:  0.370236873626709
r_  generation:  5.382552623748779
local_output_nid generation:  0.02745532989501953
local_in_edges_tensor generation:  0.21566176414489746
mini_batch_src_global generation:  0.4698042869567871
r_  generation:  5.694751977920532
----------------------check_connections_block total spend ----------------------------- 14.456313371658325
generate_one_block  7.226858377456665
generate_one_block  6.750533103942871
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.001493453979492
gen group dst list time:  0.0907282829284668
time for parepare:  0.4588165283203125
local_output_nid generation:  0.2769582271575928
local_in_edges_tensor generation:  1.7271397113800049
mini_batch_src_global generation:  2.4935123920440674
r_  generation:  30.0650475025177
local_output_nid generation:  0.5475938320159912
local_in_edges_tensor generation:  2.1785030364990234
mini_batch_src_global generation:  3.5288920402526855
r_  generation:  30.01059079170227
----------------------check_connections_block total spend ----------------------------- 84.04533505439758
generate_one_block  40.907289266586304
generate_one_block  41.00115442276001
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.304908275604248
gen group dst list time:  0.19053888320922852
time for parepare:  0.49780964851379395
local_output_nid generation:  0.42933106422424316
local_in_edges_tensor generation:  1.577854871749878
mini_batch_src_global generation:  2.0368809700012207
r_  generation:  26.29143524169922
local_output_nid generation:  0.7335638999938965
local_in_edges_tensor generation:  1.9445528984069824
mini_batch_src_global generation:  2.970400333404541
r_  generation:  26.700604677200317
----------------------check_connections_block total spend ----------------------------- 73.76930904388428
generate_one_block  35.345980644226074
generate_one_block  35.77450728416443
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429263591766357  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.81464409828186
block generation total time  153.02893161773682
average batch blocks generation time:  76.51446580886841
block dataloader generation time/epoch 367.99987422953296
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39486241340637207 |1.3471429347991943 |0.0048667192459106445 |0.00018608570098876953 |0.005181789398193359 |0.00393986701965332 |
----------------------------------------------------------pseudo_mini_loss sum 0.3261566758155823
Total (block generation + training)time/epoch 371.8496637590415
Training time/epoch 3.9154624938964844
Training time without block to device /epoch 1.2211766242980957
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.03it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.90it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.16it/s] 40%|████      | 10/25 [00:00<00:00, 17.40it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.59it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.77it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.94it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.03it/s] 80%|████████  | 20/25 [00:01<00:00, 18.05it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.06it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.13it/s]100%|██████████| 25/25 [00:01<00:00, 17.95it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.57it/s]  8%|▊         | 2/25 [00:00<00:03,  6.61it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.62it/s] 20%|██        | 5/25 [00:00<00:03,  6.60it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.61it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.60it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.60it/s] 40%|████      | 10/25 [00:01<00:02,  6.61it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.59it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.61it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.52it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.04it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.13it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.23it/s] 80%|████████  | 20/25 [00:03<00:00,  6.31it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.36it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.45it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.47it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.17it/s]  8%|▊         | 2/25 [00:00<00:03,  6.41it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.49it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.50it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.49it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.50it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.46it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.48it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.50it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.49it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.50it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.49it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.44it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.46it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.46it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.43it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  7.20it/s]100%|██████████| 25/25 [00:03<00:00,  6.56it/s]
Run 00 | Epoch 00281 | Loss 0.3262 | Train 0.6805 | Val 0.6683 | Test 0.5406
Number of nodes during this epoch:  4637757
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425178050994873  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.176910400390625
range selection method range initialization spend 0.024927139282226562
time for parepare:  0.37591052055358887
local_output_nid generation:  0.026270151138305664
local_in_edges_tensor generation:  0.2359912395477295
mini_batch_src_global generation:  0.3747835159301758
r_  generation:  5.479432106018066
local_output_nid generation:  0.028146982192993164
local_in_edges_tensor generation:  0.21483111381530762
mini_batch_src_global generation:  0.46764659881591797
r_  generation:  5.608929395675659
----------------------check_connections_block total spend ----------------------------- 14.518699169158936
generate_one_block  7.226726055145264
generate_one_block  7.177709341049194
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.098280429840088
gen group dst list time:  0.08888745307922363
time for parepare:  0.45777177810668945
local_output_nid generation:  0.2693824768066406
local_in_edges_tensor generation:  1.6767215728759766
mini_batch_src_global generation:  2.4843146800994873
r_  generation:  29.76553225517273
local_output_nid generation:  0.5253176689147949
local_in_edges_tensor generation:  2.085409164428711
mini_batch_src_global generation:  3.4774811267852783
r_  generation:  30.235102891921997
----------------------check_connections_block total spend ----------------------------- 83.02470302581787
generate_one_block  40.949162006378174
generate_one_block  41.215245723724365
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1704297065734863
gen group dst list time:  0.1902759075164795
time for parepare:  0.4538919925689697
local_output_nid generation:  0.39928507804870605
local_in_edges_tensor generation:  1.4703953266143799
mini_batch_src_global generation:  2.0184009075164795
r_  generation:  25.569544076919556
local_output_nid generation:  0.7512412071228027
local_in_edges_tensor generation:  1.9497721195220947
mini_batch_src_global generation:  2.787760019302368
r_  generation:  26.25190567970276
----------------------check_connections_block total spend ----------------------------- 71.73374009132385
generate_one_block  35.101184606552124
generate_one_block  36.03803563117981
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.425178050994873  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.75844311714172
block generation total time  153.30362796783447
average batch blocks generation time:  76.65181398391724
block dataloader generation time/epoch 367.99535376974876
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3932148218154907 |1.4322501420974731 |0.004835724830627441 |0.00017380714416503906 |0.0050792694091796875 |0.001848459243774414 |
----------------------------------------------------------pseudo_mini_loss sum 0.32707810401916504
Total (block generation + training)time/epoch 371.84597371571454
Training time/epoch 4.083782911300659
Training time without block to device /epoch 1.219282627105713
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.32it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.79it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.25it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.69it/s] 40%|████      | 10/25 [00:00<00:00, 17.93it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.90it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.74it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.84it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.61it/s] 80%|████████  | 20/25 [00:01<00:00, 17.42it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.67it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.80it/s]100%|██████████| 25/25 [00:01<00:00, 17.78it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.07it/s]  8%|▊         | 2/25 [00:00<00:04,  5.12it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.13it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.14it/s] 20%|██        | 5/25 [00:00<00:03,  5.50it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.83it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.83it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.09it/s] 40%|████      | 10/25 [00:01<00:02,  6.32it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.94it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.67it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.96it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.18it/s] 60%|██████    | 15/25 [00:02<00:01,  6.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.35it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.51it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.63it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.18it/s] 80%|████████  | 20/25 [00:03<00:00,  5.87it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.62it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.47it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.38it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.68it/s]100%|██████████| 25/25 [00:04<00:00,  5.80it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.19it/s]  8%|▊         | 2/25 [00:00<00:04,  5.58it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.34it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.08it/s] 20%|██        | 5/25 [00:00<00:03,  5.47it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.85it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.58it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.42it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.26it/s] 40%|████      | 10/25 [00:01<00:03,  4.84it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.20it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.54it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.85it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.08it/s] 60%|██████    | 15/25 [00:02<00:01,  6.24it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.36it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.39it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.46it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.43it/s] 80%|████████  | 20/25 [00:03<00:00,  6.46it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.69it/s]100%|██████████| 25/25 [00:04<00:00,  6.18it/s]100%|██████████| 25/25 [00:04<00:00,  5.88it/s]
Run 00 | Epoch 00282 | Loss 0.3271 | Train 0.6808 | Val 0.6694 | Test 0.5420
Number of nodes during this epoch:  4637791
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423457622528076  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1199982166290283
range selection method range initialization spend 0.024390697479248047
time for parepare:  0.36724162101745605
local_output_nid generation:  0.02652430534362793
local_in_edges_tensor generation:  0.23611760139465332
mini_batch_src_global generation:  0.3784053325653076
r_  generation:  5.668966293334961
local_output_nid generation:  0.029232263565063477
local_in_edges_tensor generation:  0.23527932167053223
mini_batch_src_global generation:  0.47171735763549805
r_  generation:  5.9021220207214355
----------------------check_connections_block total spend ----------------------------- 15.030222654342651
generate_one_block  7.217149257659912
generate_one_block  6.885722398757935
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.120117902755737
gen group dst list time:  0.08636879920959473
time for parepare:  0.4434828758239746
local_output_nid generation:  0.26943278312683105
local_in_edges_tensor generation:  1.6518757343292236
mini_batch_src_global generation:  2.6054816246032715
r_  generation:  29.811185598373413
local_output_nid generation:  0.5382437705993652
local_in_edges_tensor generation:  2.071648120880127
mini_batch_src_global generation:  4.088277101516724
r_  generation:  30.83020853996277
----------------------check_connections_block total spend ----------------------------- 84.61663484573364
generate_one_block  41.335413694381714
generate_one_block  42.251925230026245
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.4156761169433594
gen group dst list time:  0.18322300910949707
time for parepare:  0.4550471305847168
local_output_nid generation:  0.39112138748168945
local_in_edges_tensor generation:  1.605729341506958
mini_batch_src_global generation:  2.0667638778686523
r_  generation:  26.61305809020996
local_output_nid generation:  0.7333962917327881
local_in_edges_tensor generation:  2.2457478046417236
mini_batch_src_global generation:  2.8162693977355957
r_  generation:  26.04220676422119
----------------------check_connections_block total spend ----------------------------- 73.7653603553772
generate_one_block  35.2944221496582
generate_one_block  35.97280430793762
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423457622528076  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  158.38199520111084
block generation total time  154.85456538200378
average batch blocks generation time:  77.42728269100189
block dataloader generation time/epoch 368.0129708923636
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3937208652496338 |1.3162825107574463 |0.004435181617736816 |0.00015032291412353516 |0.005072474479675293 |0.0014486312866210938 |
----------------------------------------------------------pseudo_mini_loss sum 0.32683563232421875
Total (block generation + training)time/epoch 371.8636084386401
Training time/epoch 3.8554210662841797
Training time without block to device /epoch 1.222856044769287
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.22it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.85it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.27it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.62it/s] 40%|████      | 10/25 [00:00<00:00, 17.83it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.03it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.18it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.20it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.27it/s] 80%|████████  | 20/25 [00:01<00:00, 18.33it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.33it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.40it/s]100%|██████████| 25/25 [00:01<00:00, 18.25it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.50it/s]  8%|▊         | 2/25 [00:00<00:03,  6.50it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.47it/s] 20%|██        | 5/25 [00:00<00:03,  6.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.51it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.53it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.55it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.55it/s] 40%|████      | 10/25 [00:01<00:02,  6.56it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.54it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.52it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.53it/s] 60%|██████    | 15/25 [00:02<00:01,  6.54it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.57it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.52it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.51it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.52it/s] 80%|████████  | 20/25 [00:03<00:00,  6.53it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.51it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.53it/s]100%|██████████| 25/25 [00:03<00:00,  7.27it/s]100%|██████████| 25/25 [00:03<00:00,  6.61it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.25it/s]  8%|▊         | 2/25 [00:00<00:03,  6.42it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.46it/s] 20%|██        | 5/25 [00:00<00:03,  6.49it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.30it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.12it/s] 40%|████      | 10/25 [00:01<00:02,  6.18it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.08it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.22it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.32it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.38it/s] 60%|██████    | 15/25 [00:02<00:01,  6.31it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.38it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.41it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  7.21it/s]100%|██████████| 25/25 [00:03<00:00,  6.45it/s]
Run 00 | Epoch 00283 | Loss 0.3268 | Train 0.6793 | Val 0.6676 | Test 0.5409
Number of nodes during this epoch:  4636537
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421473979949951  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0878100395202637
range selection method range initialization spend 0.024870634078979492
time for parepare:  0.3446080684661865
local_output_nid generation:  0.02649092674255371
local_in_edges_tensor generation:  0.22084522247314453
mini_batch_src_global generation:  0.37019920349121094
r_  generation:  5.381285667419434
local_output_nid generation:  0.026959896087646484
local_in_edges_tensor generation:  0.19910502433776855
mini_batch_src_global generation:  0.47031402587890625
r_  generation:  5.627779245376587
----------------------check_connections_block total spend ----------------------------- 14.325119256973267
generate_one_block  7.160091400146484
generate_one_block  6.941922187805176
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.068126440048218
gen group dst list time:  0.09701657295227051
time for parepare:  0.42749476432800293
local_output_nid generation:  0.26381945610046387
local_in_edges_tensor generation:  1.6613178253173828
mini_batch_src_global generation:  2.551616668701172
r_  generation:  29.992847681045532
local_output_nid generation:  0.5369813442230225
local_in_edges_tensor generation:  2.1933517456054688
mini_batch_src_global generation:  3.5058884620666504
r_  generation:  30.323417901992798
----------------------check_connections_block total spend ----------------------------- 83.98776817321777
generate_one_block  41.05253791809082
generate_one_block  41.179786920547485
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2421875
gen group dst list time:  0.18337702751159668
time for parepare:  0.4618535041809082
local_output_nid generation:  0.398665189743042
local_in_edges_tensor generation:  1.4799339771270752
mini_batch_src_global generation:  2.0141782760620117
r_  generation:  25.57481598854065
local_output_nid generation:  0.7497446537017822
local_in_edges_tensor generation:  1.9607431888580322
mini_batch_src_global generation:  3.002063274383545
r_  generation:  25.80291771888733
----------------------check_connections_block total spend ----------------------------- 71.49247574806213
generate_one_block  35.415250062942505
generate_one_block  35.899463176727295
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.421473979949951  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.4802439212799
block generation total time  153.5470380783081
average batch blocks generation time:  76.77351903915405
block dataloader generation time/epoch 368.0081613256898
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37607109546661377 |1.2886384725570679 |0.0044591426849365234 |0.0001533031463623047 |0.005043625831604004 |0.0015976428985595703 |
----------------------------------------------------------pseudo_mini_loss sum 0.32502442598342896
Total (block generation + training)time/epoch 371.8584879922195
Training time/epoch 3.76214599609375
Training time without block to device /epoch 1.1848690509796143
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.16it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.66it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.27it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.40it/s] 40%|████      | 10/25 [00:00<00:00, 17.71it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.72it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.92it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.06it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.83it/s] 80%|████████  | 20/25 [00:01<00:00, 17.75it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.88it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.47it/s]100%|██████████| 25/25 [00:01<00:00, 17.63it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.92it/s]  8%|▊         | 2/25 [00:00<00:03,  5.78it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.12it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.35it/s] 20%|██        | 5/25 [00:00<00:03,  6.47it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.37it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.52it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.58it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.66it/s] 40%|████      | 10/25 [00:01<00:02,  6.70it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.74it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.74it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.71it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.70it/s] 60%|██████    | 15/25 [00:02<00:01,  6.58it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.59it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.62it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.65it/s] 80%|████████  | 20/25 [00:03<00:00,  6.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.87it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.66it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.50it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.38it/s]100%|██████████| 25/25 [00:03<00:00,  6.10it/s]100%|██████████| 25/25 [00:03<00:00,  6.28it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.21it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.29it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.39it/s] 20%|██        | 5/25 [00:00<00:03,  6.43it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.39it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.15it/s] 40%|████      | 10/25 [00:01<00:02,  6.08it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.20it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.22it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.34it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.42it/s] 60%|██████    | 15/25 [00:02<00:01,  6.47it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.08it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.00it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.10it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.94it/s] 80%|████████  | 20/25 [00:03<00:00,  6.06it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.93it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.70it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.76it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.90it/s]100%|██████████| 25/25 [00:04<00:00,  6.22it/s]
Run 00 | Epoch 00284 | Loss 0.3250 | Train 0.6823 | Val 0.6705 | Test 0.5432
Number of nodes during this epoch:  4637584
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4290971755981445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1378068923950195
range selection method range initialization spend 0.024541378021240234
time for parepare:  0.38863420486450195
local_output_nid generation:  0.026864290237426758
local_in_edges_tensor generation:  0.2301807403564453
mini_batch_src_global generation:  0.3757951259613037
r_  generation:  5.402291297912598
local_output_nid generation:  0.028115272521972656
local_in_edges_tensor generation:  0.21621203422546387
mini_batch_src_global generation:  0.47205185890197754
r_  generation:  5.711301326751709
----------------------check_connections_block total spend ----------------------------- 14.524657726287842
generate_one_block  7.323291778564453
generate_one_block  6.992412090301514
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.11917519569397
gen group dst list time:  0.08477091789245605
time for parepare:  0.4611551761627197
local_output_nid generation:  0.2719151973724365
local_in_edges_tensor generation:  1.6224861145019531
mini_batch_src_global generation:  2.4983763694763184
r_  generation:  30.004290342330933
local_output_nid generation:  0.5421574115753174
local_in_edges_tensor generation:  2.0858864784240723
mini_batch_src_global generation:  3.495136022567749
r_  generation:  30.344236373901367
----------------------check_connections_block total spend ----------------------------- 83.19890332221985
generate_one_block  41.010571002960205
generate_one_block  41.112389087677
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3567938804626465
gen group dst list time:  0.18546772003173828
time for parepare:  0.49249768257141113
local_output_nid generation:  0.4246561527252197
local_in_edges_tensor generation:  1.558546543121338
mini_batch_src_global generation:  2.017261505126953
r_  generation:  26.164278984069824
local_output_nid generation:  0.7329046726226807
local_in_edges_tensor generation:  2.0897467136383057
mini_batch_src_global generation:  2.814967632293701
r_  generation:  26.215986490249634
----------------------check_connections_block total spend ----------------------------- 72.98753666877747
generate_one_block  35.21447157859802
generate_one_block  36.0162034034729
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4290971755981445  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.18643999099731
block generation total time  153.35363507270813
average batch blocks generation time:  76.67681753635406
block dataloader generation time/epoch 368.00996758979664
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3789641857147217 |1.2949445247650146 |0.004424691200256348 |0.00015473365783691406 |0.005117297172546387 |0.0019512176513671875 |
----------------------------------------------------------pseudo_mini_loss sum 0.3260323107242584
Total (block generation + training)time/epoch 371.8600582925897
Training time/epoch 3.782895088195801
Training time without block to device /epoch 1.1930060386657715
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.30it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.73it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.30it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.55it/s] 40%|████      | 10/25 [00:00<00:01, 12.84it/s] 48%|████▊     | 12/25 [00:00<00:00, 14.23it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.25it/s] 64%|██████▍   | 16/25 [00:01<00:00, 16.08it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.64it/s] 80%|████████  | 20/25 [00:01<00:00, 17.06it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.36it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.54it/s]100%|██████████| 25/25 [00:01<00:00, 16.53it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.05it/s]  8%|▊         | 2/25 [00:00<00:04,  5.09it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.58it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.99it/s] 20%|██        | 5/25 [00:00<00:03,  6.27it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.96it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.66it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.48it/s] 40%|████      | 10/25 [00:01<00:02,  5.35it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.09it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.15it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.25it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.35it/s] 60%|██████    | 15/25 [00:02<00:01,  5.03it/s] 64%|██████▍   | 16/25 [00:02<00:01,  4.96it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.26it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.55it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.59it/s] 80%|████████  | 20/25 [00:03<00:00,  5.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.25it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.19it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.48it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.37it/s]100%|██████████| 25/25 [00:04<00:00,  5.90it/s]100%|██████████| 25/25 [00:04<00:00,  5.48it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.73it/s]  8%|▊         | 2/25 [00:00<00:04,  5.65it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.10it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.34it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.89it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.62it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.40it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.22it/s] 40%|████      | 10/25 [00:01<00:02,  5.19it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.19it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.11it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.13it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.13it/s] 60%|██████    | 15/25 [00:02<00:01,  5.03it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.30it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.67it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.86it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.09it/s] 80%|████████  | 20/25 [00:03<00:00,  6.28it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.94it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.98it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.17it/s]100%|██████████| 25/25 [00:04<00:00,  5.78it/s]
Run 00 | Epoch 00285 | Loss 0.3260 | Train 0.6846 | Val 0.6721 | Test 0.5453
Number of nodes during this epoch:  4637329
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4276814460754395  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.168705940246582
range selection method range initialization spend 0.024547815322875977
time for parepare:  0.36357593536376953
local_output_nid generation:  0.031223535537719727
local_in_edges_tensor generation:  0.23896336555480957
mini_batch_src_global generation:  0.3771028518676758
r_  generation:  5.459496736526489
local_output_nid generation:  0.028161048889160156
local_in_edges_tensor generation:  0.19462203979492188
mini_batch_src_global generation:  0.46947240829467773
r_  generation:  5.670925855636597
----------------------check_connections_block total spend ----------------------------- 14.542332887649536
generate_one_block  7.322462320327759
generate_one_block  7.149809122085571
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.208287000656128
gen group dst list time:  0.08682489395141602
time for parepare:  0.44809436798095703
local_output_nid generation:  0.27124595642089844
local_in_edges_tensor generation:  1.6796231269836426
mini_batch_src_global generation:  2.4717628955841064
r_  generation:  29.621779680252075
local_output_nid generation:  0.5285346508026123
local_in_edges_tensor generation:  2.0728957653045654
mini_batch_src_global generation:  3.5027754306793213
r_  generation:  30.20280385017395
----------------------check_connections_block total spend ----------------------------- 82.65610408782959
generate_one_block  40.89995098114014
generate_one_block  41.026224851608276
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1527199745178223
gen group dst list time:  0.18608736991882324
time for parepare:  0.4569051265716553
local_output_nid generation:  0.40175867080688477
local_in_edges_tensor generation:  1.531531810760498
mini_batch_src_global generation:  2.0168826580047607
r_  generation:  25.666083335876465
local_output_nid generation:  0.739067554473877
local_in_edges_tensor generation:  2.1667962074279785
mini_batch_src_global generation:  2.953869581222534
r_  generation:  26.08281970024109
----------------------check_connections_block total spend ----------------------------- 72.26426863670349
generate_one_block  35.40850257873535
generate_one_block  36.06892991065979
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4276814460754395  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.92037272453308
block generation total time  153.40360832214355
average batch blocks generation time:  76.70180416107178
block dataloader generation time/epoch 368.0093917646608
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3873518705368042 |1.3131412267684937 |0.004684805870056152 |0.00016021728515625 |0.005161762237548828 |0.0019919872283935547 |
----------------------------------------------------------pseudo_mini_loss sum 0.32757753133773804
Total (block generation + training)time/epoch 371.8594432994202
Training time/epoch 3.8387091159820557
Training time without block to device /epoch 1.2124266624450684
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.71it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.37it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.69it/s] 40%|████      | 10/25 [00:00<00:00, 17.74it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.87it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.01it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.99it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.08it/s] 80%|████████  | 20/25 [00:01<00:00, 18.11it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.15it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.18it/s]100%|██████████| 25/25 [00:01<00:00, 18.11it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.42it/s]  8%|▊         | 2/25 [00:00<00:03,  6.44it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.40it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.31it/s] 20%|██        | 5/25 [00:00<00:03,  6.35it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.42it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.41it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.46it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.47it/s] 40%|████      | 10/25 [00:01<00:02,  6.45it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.49it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.55it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.55it/s] 60%|██████    | 15/25 [00:02<00:01,  6.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.53it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.52it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.52it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.53it/s] 80%|████████  | 20/25 [00:03<00:00,  6.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.53it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.49it/s]100%|██████████| 25/25 [00:03<00:00,  7.20it/s]100%|██████████| 25/25 [00:03<00:00,  6.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.21it/s]  8%|▊         | 2/25 [00:00<00:03,  6.38it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.44it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.43it/s] 20%|██        | 5/25 [00:00<00:03,  6.44it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.45it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.44it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.48it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.51it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.46it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.46it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.47it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.24it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.97it/s] 96%|█████████▌| 24/25 [00:03<00:00,  5.82it/s]100%|██████████| 25/25 [00:03<00:00,  6.43it/s]
Run 00 | Epoch 00286 | Loss 0.3276 | Train 0.6808 | Val 0.6683 | Test 0.5429
Number of nodes during this epoch:  4637727
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426876544952393  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0927340984344482
range selection method range initialization spend 0.024793148040771484
time for parepare:  0.36890578269958496
local_output_nid generation:  0.02575826644897461
local_in_edges_tensor generation:  0.2851567268371582
mini_batch_src_global generation:  0.38041257858276367
r_  generation:  5.455815315246582
local_output_nid generation:  0.02792668342590332
local_in_edges_tensor generation:  0.19334864616394043
mini_batch_src_global generation:  0.4541153907775879
r_  generation:  5.585287809371948
----------------------check_connections_block total spend ----------------------------- 14.444720983505249
generate_one_block  7.216044664382935
generate_one_block  7.1325907707214355
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.050839185714722
gen group dst list time:  0.08879494667053223
time for parepare:  0.44809985160827637
local_output_nid generation:  0.27082276344299316
local_in_edges_tensor generation:  1.6077346801757812
mini_batch_src_global generation:  2.482686758041382
r_  generation:  29.797499418258667
local_output_nid generation:  0.5349416732788086
local_in_edges_tensor generation:  2.0423331260681152
mini_batch_src_global generation:  3.4700188636779785
r_  generation:  30.149288415908813
----------------------check_connections_block total spend ----------------------------- 82.71203970909119
generate_one_block  40.939377784729004
generate_one_block  41.02168035507202
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.223869562149048
gen group dst list time:  0.19009113311767578
time for parepare:  0.4652550220489502
local_output_nid generation:  0.39266109466552734
local_in_edges_tensor generation:  1.4379000663757324
mini_batch_src_global generation:  2.008284568786621
r_  generation:  25.357690572738647
local_output_nid generation:  0.7254374027252197
local_in_edges_tensor generation:  1.9457509517669678
mini_batch_src_global generation:  2.8620998859405518
r_  generation:  25.998180866241455
----------------------check_connections_block total spend ----------------------------- 71.28291153907776
generate_one_block  35.02872037887573
generate_one_block  35.39868354797363
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426876544952393  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  153.99495124816895
block generation total time  152.3884620666504
average batch blocks generation time:  76.1942310333252
block dataloader generation time/epoch 367.9985117015108
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37875640392303467 |1.3651047945022583 |0.0043228864669799805 |0.00015652179718017578 |0.005167603492736816 |0.0031659603118896484 |
----------------------------------------------------------pseudo_mini_loss sum 0.3267112970352173
Total (block generation + training)time/epoch 371.84882223564574
Training time/epoch 3.9242093563079834
Training time without block to device /epoch 1.1939997673034668
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.32it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.25it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.04it/s] 32%|███▏      | 8/25 [00:00<00:01, 16.75it/s] 40%|████      | 10/25 [00:00<00:00, 16.95it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.19it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.80it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.10it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.17it/s] 80%|████████  | 20/25 [00:01<00:00, 17.47it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.44it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.67it/s]100%|██████████| 25/25 [00:01<00:00, 17.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.12it/s]  8%|▊         | 2/25 [00:00<00:04,  5.12it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.11it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.08it/s] 20%|██        | 5/25 [00:00<00:03,  5.07it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.01it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.84it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.56it/s] 40%|████      | 10/25 [00:01<00:02,  5.89it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.16it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.78it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.81it/s] 60%|██████    | 15/25 [00:02<00:01,  6.10it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.68it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.98it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.17it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.16it/s] 80%|████████  | 20/25 [00:03<00:00,  6.39it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.33it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.50it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.61it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.08it/s]100%|██████████| 25/25 [00:04<00:00,  5.93it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.37it/s]  8%|▊         | 2/25 [00:00<00:03,  6.58it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.71it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.94it/s] 20%|██        | 5/25 [00:00<00:03,  5.56it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.87it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.12it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  5.99it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.15it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.28it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.87it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.01it/s] 60%|██████    | 15/25 [00:02<00:01,  5.68it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.87it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.05it/s] 72%|███████▏  | 18/25 [00:02<00:01,  5.75it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.54it/s] 80%|████████  | 20/25 [00:03<00:00,  5.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.29it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.21it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.15it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.11it/s]100%|██████████| 25/25 [00:04<00:00,  5.70it/s]100%|██████████| 25/25 [00:04<00:00,  5.79it/s]
Run 00 | Epoch 00287 | Loss 0.3267 | Train 0.6812 | Val 0.6692 | Test 0.5435
Number of nodes during this epoch:  4638144
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4228081703186035  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1259543895721436
range selection method range initialization spend 0.027486324310302734
time for parepare:  0.3905618190765381
local_output_nid generation:  0.026330232620239258
local_in_edges_tensor generation:  0.22813940048217773
mini_batch_src_global generation:  0.39415979385375977
r_  generation:  5.519427061080933
local_output_nid generation:  0.029296398162841797
local_in_edges_tensor generation:  0.22220849990844727
mini_batch_src_global generation:  0.4940938949584961
r_  generation:  5.819867849349976
----------------------check_connections_block total spend ----------------------------- 14.799294710159302
generate_one_block  7.329867839813232
generate_one_block  6.992105960845947
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.046593427658081
gen group dst list time:  0.08281350135803223
time for parepare:  0.48180222511291504
local_output_nid generation:  0.2821235656738281
local_in_edges_tensor generation:  1.6179478168487549
mini_batch_src_global generation:  2.6197707653045654
r_  generation:  29.857558727264404
local_output_nid generation:  0.5361003875732422
local_in_edges_tensor generation:  2.0926034450531006
mini_batch_src_global generation:  3.730823278427124
r_  generation:  29.899250507354736
----------------------check_connections_block total spend ----------------------------- 83.16853761672974
generate_one_block  41.04682731628418
generate_one_block  40.63534140586853
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2807607650756836
gen group dst list time:  0.18782663345336914
time for parepare:  0.46156978607177734
local_output_nid generation:  0.40876317024230957
local_in_edges_tensor generation:  1.5188379287719727
mini_batch_src_global generation:  2.074420928955078
r_  generation:  27.16997790336609
local_output_nid generation:  0.7337214946746826
local_in_edges_tensor generation:  1.936774730682373
mini_batch_src_global generation:  2.816744089126587
r_  generation:  26.663408279418945
----------------------check_connections_block total spend ----------------------------- 74.21861553192139
generate_one_block  34.93188691139221
generate_one_block  36.560120820999146
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4228081703186035  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.38715314865112
block generation total time  153.17417645454407
average batch blocks generation time:  76.58708822727203
block dataloader generation time/epoch 368.00631799383297
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39554154872894287 |1.4747350215911865 |0.005235075950622559 |0.00019812583923339844 |0.005321145057678223 |0.0038497447967529297 |
----------------------------------------------------------pseudo_mini_loss sum 0.32494133710861206
Total (block generation + training)time/epoch 371.85774487091436
Training time/epoch 4.171627998352051
Training time without block to device /epoch 1.2221579551696777
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.12it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.82it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.43it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:00, 17.60it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.38it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.57it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.81it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.54it/s] 80%|████████  | 20/25 [00:01<00:00, 17.81it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.99it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.83it/s]100%|██████████| 25/25 [00:01<00:00, 17.65it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.05it/s]  8%|▊         | 2/25 [00:00<00:03,  5.98it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.37it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.83it/s] 20%|██        | 5/25 [00:00<00:03,  5.53it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.88it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.21it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.81it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.10it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.94it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.51it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.79it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.08it/s] 60%|██████    | 15/25 [00:02<00:01,  5.77it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.05it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.85it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.45it/s] 80%|████████  | 20/25 [00:03<00:00,  5.77it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.05it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.76it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.61it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.46it/s]100%|██████████| 25/25 [00:04<00:00,  6.26it/s]100%|██████████| 25/25 [00:04<00:00,  5.90it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.74it/s]  8%|▊         | 2/25 [00:00<00:04,  5.70it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.12it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.32it/s] 20%|██        | 5/25 [00:00<00:03,  6.46it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.58it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.04it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.69it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.49it/s] 40%|████      | 10/25 [00:01<00:02,  5.27it/s] 44%|████▍     | 11/25 [00:01<00:02,  4.93it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.20it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.74it/s] 60%|██████    | 15/25 [00:02<00:01,  5.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.42it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.55it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.85it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.00it/s] 80%|████████  | 20/25 [00:03<00:00,  6.12it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.19it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.27it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.80it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.03it/s]100%|██████████| 25/25 [00:04<00:00,  5.89it/s]
Run 00 | Epoch 00288 | Loss 0.3249 | Train 0.6807 | Val 0.6695 | Test 0.5438
Number of nodes during this epoch:  4637442
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42358922958374  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.117231845855713
range selection method range initialization spend 0.0269777774810791
time for parepare:  0.38840794563293457
local_output_nid generation:  0.026549339294433594
local_in_edges_tensor generation:  0.20389151573181152
mini_batch_src_global generation:  0.3691394329071045
r_  generation:  5.704602241516113
local_output_nid generation:  0.0295562744140625
local_in_edges_tensor generation:  0.23664522171020508
mini_batch_src_global generation:  0.4679982662200928
r_  generation:  5.956333637237549
----------------------check_connections_block total spend ----------------------------- 15.064185619354248
generate_one_block  7.226384401321411
generate_one_block  6.928119659423828
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.965346336364746
gen group dst list time:  0.08472561836242676
time for parepare:  0.47522687911987305
local_output_nid generation:  0.26709771156311035
local_in_edges_tensor generation:  1.630251169204712
mini_batch_src_global generation:  2.60414457321167
r_  generation:  29.79997968673706
local_output_nid generation:  0.5337841510772705
local_in_edges_tensor generation:  2.0673391819000244
mini_batch_src_global generation:  3.500328779220581
r_  generation:  30.03250813484192
----------------------check_connections_block total spend ----------------------------- 83.04375791549683
generate_one_block  41.01109075546265
generate_one_block  40.80540180206299
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1806492805480957
gen group dst list time:  0.1837606430053711
time for parepare:  0.44930553436279297
local_output_nid generation:  0.40412306785583496
local_in_edges_tensor generation:  1.4702274799346924
mini_batch_src_global generation:  2.020852565765381
r_  generation:  25.31806516647339
local_output_nid generation:  0.7556898593902588
local_in_edges_tensor generation:  1.9447262287139893
mini_batch_src_global generation:  3.0062716007232666
r_  generation:  25.729490995407104
----------------------check_connections_block total spend ----------------------------- 71.25273656845093
generate_one_block  35.269697427749634
generate_one_block  35.929654598236084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42358922958374  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.29649448394775
block generation total time  153.01584458351135
average batch blocks generation time:  76.50792229175568
block dataloader generation time/epoch 368.00193185047294
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3877147436141968 |1.2978273630142212 |0.004624843597412109 |0.0001633167266845703 |0.0051746368408203125 |0.0015408992767333984 |
----------------------------------------------------------pseudo_mini_loss sum 0.3250960409641266
Total (block generation + training)time/epoch 371.85319565901705
Training time/epoch 3.8040947914123535
Training time without block to device /epoch 1.2084400653839111
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.26it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.81it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.41it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.79it/s] 40%|████      | 10/25 [00:00<00:00, 17.99it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.01it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.11it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.24it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.30it/s] 80%|████████  | 20/25 [00:01<00:00, 18.28it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.29it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.35it/s]100%|██████████| 25/25 [00:01<00:00, 18.26it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.88it/s]  8%|▊         | 2/25 [00:00<00:03,  5.77it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.09it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.23it/s] 20%|██        | 5/25 [00:00<00:03,  6.30it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.39it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.42it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.43it/s] 40%|████      | 10/25 [00:01<00:02,  6.44it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.40it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.31it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.36it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.38it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.38it/s] 80%|████████  | 20/25 [00:03<00:00,  6.40it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.39it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.39it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.35it/s]100%|██████████| 25/25 [00:03<00:00,  7.04it/s]100%|██████████| 25/25 [00:03<00:00,  6.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.18it/s]  8%|▊         | 2/25 [00:00<00:03,  6.32it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.36it/s] 20%|██        | 5/25 [00:00<00:03,  6.35it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.32it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.36it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.35it/s] 40%|████      | 10/25 [00:01<00:02,  6.37it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.37it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.38it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.35it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.36it/s] 60%|██████    | 15/25 [00:02<00:01,  6.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.30it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.28it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.30it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.25it/s] 80%|████████  | 20/25 [00:03<00:00,  6.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.86it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.85it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.01it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.10it/s]100%|██████████| 25/25 [00:03<00:00,  6.34it/s]
Run 00 | Epoch 00289 | Loss 0.3251 | Train 0.6770 | Val 0.6661 | Test 0.5409
Number of nodes during this epoch:  4637232
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429309368133545  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1212973594665527
range selection method range initialization spend 0.025859355926513672
time for parepare:  0.38129115104675293
local_output_nid generation:  0.02613997459411621
local_in_edges_tensor generation:  0.2982065677642822
mini_batch_src_global generation:  0.3784658908843994
r_  generation:  5.4461140632629395
local_output_nid generation:  0.028126001358032227
local_in_edges_tensor generation:  0.19579458236694336
mini_batch_src_global generation:  0.4688396453857422
r_  generation:  5.6179351806640625
----------------------check_connections_block total spend ----------------------------- 14.530222415924072
generate_one_block  7.231589317321777
generate_one_block  7.164990425109863
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.078821182250977
gen group dst list time:  0.09521627426147461
time for parepare:  0.457517147064209
local_output_nid generation:  0.26279330253601074
local_in_edges_tensor generation:  1.7764878273010254
mini_batch_src_global generation:  2.544882297515869
r_  generation:  30.251302242279053
local_output_nid generation:  0.5408840179443359
local_in_edges_tensor generation:  2.2805304527282715
mini_batch_src_global generation:  3.767512083053589
r_  generation:  29.896366596221924
----------------------check_connections_block total spend ----------------------------- 84.58548974990845
generate_one_block  41.646735429763794
generate_one_block  41.29863142967224
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.245145797729492
gen group dst list time:  0.19275665283203125
time for parepare:  0.4841437339782715
local_output_nid generation:  0.4053628444671631
local_in_edges_tensor generation:  1.533952236175537
mini_batch_src_global generation:  2.1888532638549805
r_  generation:  26.45962142944336
local_output_nid generation:  0.7309458255767822
local_in_edges_tensor generation:  1.956063985824585
mini_batch_src_global generation:  2.8215701580047607
r_  generation:  26.194617748260498
----------------------check_connections_block total spend ----------------------------- 72.90101361274719
generate_one_block  35.31774306297302
generate_one_block  36.05797529220581
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.429309368133545  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.48650336265564
block generation total time  154.32108521461487
average batch blocks generation time:  77.16054260730743
block dataloader generation time/epoch 368.0117376294629
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3768981695175171 |1.2920105457305908 |0.004399418830871582 |0.0001475811004638672 |0.0051076412200927734 |0.0013964176177978516 |
----------------------------------------------------------pseudo_mini_loss sum 0.32373252511024475
Total (block generation + training)time/epoch 371.8627108409487
Training time/epoch 3.7668099403381348
Training time without block to device /epoch 1.1827888488769531
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.23it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.81it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.08it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.58it/s] 40%|████      | 10/25 [00:00<00:01, 13.91it/s] 48%|████▊     | 12/25 [00:00<00:00, 15.08it/s] 56%|█████▌    | 14/25 [00:00<00:00, 16.01it/s] 64%|██████▍   | 16/25 [00:00<00:00, 16.67it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.13it/s] 80%|████████  | 20/25 [00:01<00:00, 17.23it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.20it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.45it/s]100%|██████████| 25/25 [00:01<00:00, 16.80it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.70it/s]  8%|▊         | 2/25 [00:00<00:04,  5.73it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.44it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.15it/s] 20%|██        | 5/25 [00:00<00:03,  5.60it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.78it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.39it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.69it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.54it/s] 40%|████      | 10/25 [00:01<00:02,  5.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.68it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.51it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.51it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.84it/s] 60%|██████    | 15/25 [00:02<00:01,  5.55it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.36it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.18it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.06it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.85it/s] 80%|████████  | 20/25 [00:03<00:00,  5.19it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.55it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.79it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.94it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.61it/s]100%|██████████| 25/25 [00:04<00:00,  6.45it/s]100%|██████████| 25/25 [00:04<00:00,  5.60it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.76it/s]  8%|▊         | 2/25 [00:00<00:04,  4.85it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.72it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.36it/s] 20%|██        | 5/25 [00:00<00:03,  5.79it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.53it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.75it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.02it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.18it/s] 40%|████      | 10/25 [00:01<00:02,  6.37it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.89it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.98it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.18it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.35it/s] 60%|██████    | 15/25 [00:02<00:01,  5.91it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.08it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.27it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.40it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.53it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.56it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.00it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.15it/s]100%|██████████| 25/25 [00:04<00:00,  6.11it/s]
Run 00 | Epoch 00290 | Loss 0.3237 | Train 0.6759 | Val 0.6646 | Test 0.5397
Number of nodes during this epoch:  4637992
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42234468460083  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.116642713546753
range selection method range initialization spend 0.024740934371948242
time for parepare:  0.384418249130249
local_output_nid generation:  0.026337623596191406
local_in_edges_tensor generation:  0.2346947193145752
mini_batch_src_global generation:  0.37319493293762207
r_  generation:  5.648793458938599
local_output_nid generation:  0.029347896575927734
local_in_edges_tensor generation:  0.23966383934020996
mini_batch_src_global generation:  0.47281336784362793
r_  generation:  5.8820881843566895
----------------------check_connections_block total spend ----------------------------- 15.006397724151611
generate_one_block  7.206065654754639
generate_one_block  6.948381662368774
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.028372049331665
gen group dst list time:  0.0857093334197998
time for parepare:  0.45536255836486816
local_output_nid generation:  0.2707219123840332
local_in_edges_tensor generation:  1.6446821689605713
mini_batch_src_global generation:  2.6197426319122314
r_  generation:  30.070576906204224
local_output_nid generation:  0.5537395477294922
local_in_edges_tensor generation:  2.0778143405914307
mini_batch_src_global generation:  3.742067575454712
r_  generation:  29.807971477508545
----------------------check_connections_block total spend ----------------------------- 83.24150705337524
generate_one_block  41.178932428359985
generate_one_block  41.03075170516968
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.223604917526245
gen group dst list time:  0.1822507381439209
time for parepare:  0.4428369998931885
local_output_nid generation:  0.3977086544036865
local_in_edges_tensor generation:  1.464212417602539
mini_batch_src_global generation:  2.147167921066284
r_  generation:  26.294198274612427
local_output_nid generation:  0.7336795330047607
local_in_edges_tensor generation:  1.9128479957580566
mini_batch_src_global generation:  2.8194587230682373
r_  generation:  26.17018485069275
----------------------check_connections_block total spend ----------------------------- 72.68402647972107
generate_one_block  35.186699628829956
generate_one_block  35.94163537025452
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42234468460083  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.9255335330963
block generation total time  153.33801913261414
average batch blocks generation time:  76.66900956630707
block dataloader generation time/epoch 368.0138397241376
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38124918937683105 |1.3025449514389038 |0.004373073577880859 |0.00014901161193847656 |0.00511324405670166 |0.0018873214721679688 |
----------------------------------------------------------pseudo_mini_loss sum 0.32541990280151367
Total (block generation + training)time/epoch 371.8646407938495
Training time/epoch 3.8007004261016846
Training time without block to device /epoch 1.195610523223877
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.11it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.80it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.47it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.66it/s] 40%|████      | 10/25 [00:00<00:00, 17.90it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.98it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.97it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.86it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.60it/s] 80%|████████  | 20/25 [00:01<00:00, 17.84it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.75it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.74it/s]100%|██████████| 25/25 [00:01<00:00, 17.88it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.08it/s]  8%|▊         | 2/25 [00:00<00:04,  5.17it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.17it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.13it/s] 20%|██        | 5/25 [00:00<00:04,  4.92it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.26it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.67it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.51it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.08it/s] 40%|████      | 10/25 [00:01<00:02,  5.21it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.02it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.96it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.95it/s] 56%|█████▌    | 14/25 [00:02<00:02,  4.91it/s] 60%|██████    | 15/25 [00:02<00:01,  5.13it/s] 64%|██████▍   | 16/25 [00:03<00:01,  4.98it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.33it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.74it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.07it/s] 80%|████████  | 20/25 [00:03<00:00,  6.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.46it/s] 88%|████████▊ | 22/25 [00:04<00:00,  6.59it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.65it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.71it/s]100%|██████████| 25/25 [00:04<00:00,  7.20it/s]100%|██████████| 25/25 [00:04<00:00,  5.65it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.84it/s]  8%|▊         | 2/25 [00:00<00:04,  5.74it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.09it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.23it/s] 20%|██        | 5/25 [00:00<00:03,  6.26it/s] 24%|██▍       | 6/25 [00:00<00:03,  6.30it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.32it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.41it/s] 40%|████      | 10/25 [00:01<00:02,  6.46it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.43it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.47it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.50it/s] 60%|██████    | 15/25 [00:02<00:01,  6.45it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.48it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.47it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.50it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.52it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.48it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.52it/s]100%|██████████| 25/25 [00:03<00:00,  6.49it/s]
Run 00 | Epoch 00291 | Loss 0.3254 | Train 0.6773 | Val 0.6660 | Test 0.5410
Number of nodes during this epoch:  4637554
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424550533294678  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1112639904022217
range selection method range initialization spend 0.024982929229736328
time for parepare:  0.3689000606536865
local_output_nid generation:  0.026803016662597656
local_in_edges_tensor generation:  0.23164725303649902
mini_batch_src_global generation:  0.3729391098022461
r_  generation:  5.445398330688477
local_output_nid generation:  0.027840614318847656
local_in_edges_tensor generation:  0.21506810188293457
mini_batch_src_global generation:  0.47304511070251465
r_  generation:  5.730000972747803
----------------------check_connections_block total spend ----------------------------- 14.577468872070312
generate_one_block  7.262664794921875
generate_one_block  6.83454704284668
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.250995874404907
gen group dst list time:  0.10216736793518066
time for parepare:  0.4605574607849121
local_output_nid generation:  0.265181303024292
local_in_edges_tensor generation:  1.7681353092193604
mini_batch_src_global generation:  2.4785549640655518
r_  generation:  29.94353985786438
local_output_nid generation:  0.5344276428222656
local_in_edges_tensor generation:  2.1956076622009277
mini_batch_src_global generation:  3.721487522125244
r_  generation:  30.702192068099976
----------------------check_connections_block total spend ----------------------------- 85.07201814651489
generate_one_block  41.40363907814026
generate_one_block  41.08938670158386
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3527863025665283
gen group dst list time:  0.18500757217407227
time for parepare:  0.5130612850189209
local_output_nid generation:  0.43276286125183105
local_in_edges_tensor generation:  1.674260139465332
mini_batch_src_global generation:  2.056241273880005
r_  generation:  26.54174041748047
local_output_nid generation:  0.7435567378997803
local_in_edges_tensor generation:  2.06803560256958
mini_batch_src_global generation:  2.8259849548339844
r_  generation:  26.410513877868652
----------------------check_connections_block total spend ----------------------------- 74.09610247612
generate_one_block  35.41646695137024
generate_one_block  36.11967730522156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424550533294678  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  159.1681206226349
block generation total time  154.02917003631592
average batch blocks generation time:  77.01458501815796
block dataloader generation time/epoch 368.0278884311245
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38354694843292236 |1.3115090131759644 |0.00439143180847168 |0.00014710426330566406 |0.005029797554016113 |0.002988100051879883 |
----------------------------------------------------------pseudo_mini_loss sum 0.3259425163269043
Total (block generation + training)time/epoch 371.8786087517869
Training time/epoch 3.8270392417907715
Training time without block to device /epoch 1.2040212154388428
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.18it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.47it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.06it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.56it/s] 40%|████      | 10/25 [00:00<00:00, 17.80it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.94it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.83it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.91it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.16it/s] 80%|████████  | 20/25 [00:01<00:00, 17.53it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.79it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.93it/s]100%|██████████| 25/25 [00:01<00:00, 17.84it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.55it/s]  8%|▊         | 2/25 [00:00<00:03,  6.59it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.60it/s] 20%|██        | 5/25 [00:00<00:03,  6.57it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.55it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.60it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.56it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.61it/s] 40%|████      | 10/25 [00:01<00:02,  6.62it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.50it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.28it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.03it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.01it/s] 60%|██████    | 15/25 [00:02<00:01,  6.11it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.04it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.12it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.21it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.34it/s] 80%|████████  | 20/25 [00:03<00:00,  6.45it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.51it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.54it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.61it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.66it/s]100%|██████████| 25/25 [00:03<00:00,  6.53it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.41it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.66it/s] 20%|██        | 5/25 [00:00<00:03,  6.54it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.60it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.88it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.00it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.11it/s] 40%|████      | 10/25 [00:01<00:02,  5.87it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.73it/s] 48%|████▊     | 12/25 [00:01<00:02,  5.83it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.95it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.10it/s] 60%|██████    | 15/25 [00:02<00:01,  6.23it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.28it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.37it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.42it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.39it/s] 80%|████████  | 20/25 [00:03<00:00,  6.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.38it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.42it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.45it/s]100%|██████████| 25/25 [00:03<00:00,  6.36it/s]
Run 00 | Epoch 00292 | Loss 0.3259 | Train 0.6804 | Val 0.6680 | Test 0.5428
Number of nodes during this epoch:  4637601
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423977851867676  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1746013164520264
range selection method range initialization spend 0.025951623916625977
time for parepare:  0.39784765243530273
local_output_nid generation:  0.026319026947021484
local_in_edges_tensor generation:  0.22519516944885254
mini_batch_src_global generation:  0.37787556648254395
r_  generation:  5.525677919387817
local_output_nid generation:  0.02792644500732422
local_in_edges_tensor generation:  0.22822904586791992
mini_batch_src_global generation:  0.4856293201446533
r_  generation:  5.709500074386597
----------------------check_connections_block total spend ----------------------------- 14.67874789237976
generate_one_block  7.327342510223389
generate_one_block  7.0651068687438965
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.135303020477295
gen group dst list time:  0.08908414840698242
time for parepare:  0.5018737316131592
local_output_nid generation:  0.28833532333374023
local_in_edges_tensor generation:  1.6805462837219238
mini_batch_src_global generation:  2.462531328201294
r_  generation:  30.09714651107788
local_output_nid generation:  0.5389883518218994
local_in_edges_tensor generation:  2.1008284091949463
mini_batch_src_global generation:  3.493842124938965
r_  generation:  30.30610227584839
----------------------check_connections_block total spend ----------------------------- 83.51186394691467
generate_one_block  40.99305844306946
generate_one_block  41.17841410636902
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.1896162033081055
gen group dst list time:  0.1814730167388916
time for parepare:  0.4722561836242676
local_output_nid generation:  0.3957960605621338
local_in_edges_tensor generation:  1.542069911956787
mini_batch_src_global generation:  2.013216495513916
r_  generation:  25.667101860046387
local_output_nid generation:  0.7484340667724609
local_in_edges_tensor generation:  1.9289474487304688
mini_batch_src_global generation:  2.984092950820923
r_  generation:  26.057030200958252
----------------------check_connections_block total spend ----------------------------- 71.98575735092163
generate_one_block  35.53373885154724
generate_one_block  36.11492466926575
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.423977851867676  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.4976212978363
block generation total time  153.82013607025146
average batch blocks generation time:  76.91006803512573
block dataloader generation time/epoch 368.0296323429602
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3939553499221802 |1.3065471649169922 |0.004538774490356445 |0.00016129016876220703 |0.005267977714538574 |0.00292205810546875 |
----------------------------------------------------------pseudo_mini_loss sum 0.32420673966407776
Total (block generation + training)time/epoch 371.8803190135305
Training time/epoch 3.840650796890259
Training time without block to device /epoch 1.2275564670562744
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.81it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.12it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.44it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.61it/s] 40%|████      | 10/25 [00:00<00:00, 17.78it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.07it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.18it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.21it/s] 80%|████████  | 20/25 [00:01<00:00, 18.25it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.27it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.30it/s]100%|██████████| 25/25 [00:01<00:00, 18.24it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.47it/s]  8%|▊         | 2/25 [00:00<00:03,  6.53it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.57it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.58it/s] 20%|██        | 5/25 [00:00<00:03,  6.58it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.57it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.54it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.54it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.54it/s] 40%|████      | 10/25 [00:01<00:02,  6.54it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.55it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.52it/s] 52%|█████▏    | 13/25 [00:01<00:01,  6.48it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.50it/s] 60%|██████    | 15/25 [00:02<00:01,  6.48it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.49it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.48it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.48it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.50it/s] 80%|████████  | 20/25 [00:03<00:00,  6.51it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.44it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.45it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.44it/s]100%|██████████| 25/25 [00:03<00:00,  7.18it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.37it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.40it/s] 20%|██        | 5/25 [00:00<00:03,  6.42it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.42it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.42it/s] 40%|████      | 10/25 [00:01<00:02,  6.41it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.41it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.40it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.41it/s] 60%|██████    | 15/25 [00:02<00:01,  6.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.44it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.42it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.41it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.40it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.42it/s]100%|██████████| 25/25 [00:03<00:00,  6.51it/s]
Run 00 | Epoch 00293 | Loss 0.3242 | Train 0.6813 | Val 0.6684 | Test 0.5429
Number of nodes during this epoch:  4637314
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424134254455566  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0065717697143555
range selection method range initialization spend 0.02474045753479004
time for parepare:  0.3764455318450928
local_output_nid generation:  0.02621626853942871
local_in_edges_tensor generation:  0.22391295433044434
mini_batch_src_global generation:  0.3656923770904541
r_  generation:  5.407321453094482
local_output_nid generation:  0.027025222778320312
local_in_edges_tensor generation:  0.19460272789001465
mini_batch_src_global generation:  0.4815504550933838
r_  generation:  5.641772985458374
----------------------check_connections_block total spend ----------------------------- 14.429421663284302
generate_one_block  7.248614549636841
generate_one_block  6.808312892913818
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.091829061508179
gen group dst list time:  0.10912203788757324
time for parepare:  0.49939393997192383
local_output_nid generation:  0.27008986473083496
local_in_edges_tensor generation:  1.6784100532531738
mini_batch_src_global generation:  2.513310432434082
r_  generation:  29.833425283432007
local_output_nid generation:  0.5345396995544434
local_in_edges_tensor generation:  2.074472188949585
mini_batch_src_global generation:  3.7740023136138916
r_  generation:  29.87526845932007
----------------------check_connections_block total spend ----------------------------- 83.00912952423096
generate_one_block  41.208595752716064
generate_one_block  40.7536780834198
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.36661434173584
gen group dst list time:  0.18439793586730957
time for parepare:  0.47983312606811523
local_output_nid generation:  0.4015038013458252
local_in_edges_tensor generation:  1.4639790058135986
mini_batch_src_global generation:  2.0680768489837646
r_  generation:  25.38278841972351
local_output_nid generation:  0.7295868396759033
local_in_edges_tensor generation:  1.924386978149414
mini_batch_src_global generation:  2.969707727432251
r_  generation:  25.884018421173096
----------------------check_connections_block total spend ----------------------------- 70.99252724647522
generate_one_block  35.31859278678894
generate_one_block  35.81856727600098
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.424134254455566  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  154.00165677070618
block generation total time  153.09943389892578
average batch blocks generation time:  76.54971694946289
block dataloader generation time/epoch 368.0203140860512
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3904041051864624 |1.30931556224823 |0.004377484321594238 |0.00015723705291748047 |0.005099058151245117 |0.002867460250854492 |
----------------------------------------------------------pseudo_mini_loss sum 0.3242601454257965
Total (block generation + training)time/epoch 371.8709313009872
Training time/epoch 3.830080986022949
Training time without block to device /epoch 1.2114498615264893
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.51it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.81it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.63it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.28it/s] 40%|████      | 10/25 [00:00<00:00, 17.55it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.82it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.80it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.82it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.74it/s] 80%|████████  | 20/25 [00:01<00:00, 17.87it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.05it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.21it/s]100%|██████████| 25/25 [00:01<00:00, 17.88it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.46it/s]  8%|▊         | 2/25 [00:00<00:03,  6.31it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.43it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.30it/s] 20%|██        | 5/25 [00:00<00:03,  6.35it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.40it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.46it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.47it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.44it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.52it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.46it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.50it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.50it/s] 60%|██████    | 15/25 [00:02<00:01,  6.54it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.55it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.56it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.56it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.56it/s] 80%|████████  | 20/25 [00:03<00:00,  6.52it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.52it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.53it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.27it/s]  8%|▊         | 2/25 [00:00<00:03,  6.39it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.41it/s] 20%|██        | 5/25 [00:00<00:03,  6.41it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.46it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.48it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.45it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.46it/s] 40%|████      | 10/25 [00:01<00:02,  6.48it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.46it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.47it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.44it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.45it/s] 60%|██████    | 15/25 [00:02<00:01,  6.46it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.42it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.45it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.47it/s] 80%|████████  | 20/25 [00:03<00:00,  6.48it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.50it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.51it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.46it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.48it/s]100%|██████████| 25/25 [00:03<00:00,  6.55it/s]
Run 00 | Epoch 00294 | Loss 0.3243 | Train 0.6809 | Val 0.6687 | Test 0.5427
Number of nodes during this epoch:  4637580
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4285664558410645  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.133589267730713
range selection method range initialization spend 0.024634838104248047
time for parepare:  0.3726801872253418
local_output_nid generation:  0.03070831298828125
local_in_edges_tensor generation:  0.2551724910736084
mini_batch_src_global generation:  0.37915682792663574
r_  generation:  5.47340989112854
local_output_nid generation:  0.02821183204650879
local_in_edges_tensor generation:  0.1958150863647461
mini_batch_src_global generation:  0.46983957290649414
r_  generation:  5.576812744140625
----------------------check_connections_block total spend ----------------------------- 14.4806387424469
generate_one_block  7.350481748580933
generate_one_block  7.10068154335022
The real block id is  1
get_global_graph_edges_ids_block function  spend 3.9282782077789307
gen group dst list time:  0.08679723739624023
time for parepare:  0.4526190757751465
local_output_nid generation:  0.25926756858825684
local_in_edges_tensor generation:  1.5855679512023926
mini_batch_src_global generation:  2.4346418380737305
r_  generation:  28.923455953598022
local_output_nid generation:  0.5196468830108643
local_in_edges_tensor generation:  2.0191683769226074
mini_batch_src_global generation:  3.3252358436584473
r_  generation:  30.201464891433716
----------------------check_connections_block total spend ----------------------------- 81.62237572669983
generate_one_block  40.94826054573059
generate_one_block  40.96984028816223
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.2162444591522217
gen group dst list time:  0.19193363189697266
time for parepare:  0.47826600074768066
local_output_nid generation:  0.4114387035369873
local_in_edges_tensor generation:  1.53108811378479
mini_batch_src_global generation:  2.170300006866455
r_  generation:  26.330092906951904
local_output_nid generation:  0.7511496543884277
local_in_edges_tensor generation:  2.025552988052368
mini_batch_src_global generation:  2.9249446392059326
r_  generation:  26.60608148574829
----------------------check_connections_block total spend ----------------------------- 73.42936682701111
generate_one_block  35.42952585220337
generate_one_block  36.06041884422302
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.4285664558410645  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  155.05174255371094
block generation total time  153.4080455303192
average batch blocks generation time:  76.7040227651596
block dataloader generation time/epoch 368.0174522149361
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3752880096435547 |1.2912911176681519 |0.004667401313781738 |0.0001571178436279297 |0.0051697492599487305 |0.0018215179443359375 |
----------------------------------------------------------pseudo_mini_loss sum 0.32581108808517456
Total (block generation + training)time/epoch 371.8677951869318
Training time/epoch 3.76953387260437
Training time without block to device /epoch 1.1869516372680664
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.14it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.74it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.23it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.50it/s] 40%|████      | 10/25 [00:00<00:01, 12.37it/s] 48%|████▊     | 12/25 [00:00<00:00, 13.89it/s] 56%|█████▌    | 14/25 [00:00<00:00, 15.07it/s] 64%|██████▍   | 16/25 [00:01<00:00, 15.92it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.48it/s] 80%|████████  | 20/25 [00:01<00:00, 16.87it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.17it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.37it/s]100%|██████████| 25/25 [00:01<00:00, 16.18it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.65it/s]  8%|▊         | 2/25 [00:00<00:03,  5.80it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.48it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.34it/s] 20%|██        | 5/25 [00:00<00:03,  5.26it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.20it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.13it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.49it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.78it/s] 40%|████      | 10/25 [00:01<00:02,  5.91it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.07it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.33it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.40it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.56it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.59it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.58it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.60it/s] 80%|████████  | 20/25 [00:03<00:00,  6.61it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.14it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.64it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.88it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.05it/s]100%|██████████| 25/25 [00:04<00:00,  6.84it/s]100%|██████████| 25/25 [00:04<00:00,  6.08it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.29it/s]  8%|▊         | 2/25 [00:00<00:04,  5.63it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.39it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.25it/s] 20%|██        | 5/25 [00:00<00:03,  5.58it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.90it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.08it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.23it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.26it/s] 40%|████      | 10/25 [00:01<00:02,  6.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.32it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.37it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.42it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.43it/s] 60%|██████    | 15/25 [00:02<00:01,  6.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.26it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.28it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.19it/s] 80%|████████  | 20/25 [00:03<00:00,  6.03it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.14it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.27it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.41it/s]100%|██████████| 25/25 [00:04<00:00,  6.92it/s]100%|██████████| 25/25 [00:04<00:00,  6.24it/s]
Run 00 | Epoch 00295 | Loss 0.3258 | Train 0.6784 | Val 0.6657 | Test 0.5408
Number of nodes during this epoch:  4637292
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428311347961426  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1510250568389893
range selection method range initialization spend 0.02883291244506836
time for parepare:  0.3846557140350342
local_output_nid generation:  0.03127908706665039
local_in_edges_tensor generation:  0.20713090896606445
mini_batch_src_global generation:  0.375063419342041
r_  generation:  5.702269792556763
local_output_nid generation:  0.029407024383544922
local_in_edges_tensor generation:  0.2350475788116455
mini_batch_src_global generation:  0.46416735649108887
r_  generation:  5.910555839538574
----------------------check_connections_block total spend ----------------------------- 15.019937515258789
generate_one_block  7.302753686904907
generate_one_block  6.924018144607544
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.106956243515015
gen group dst list time:  0.09417581558227539
time for parepare:  0.48033976554870605
local_output_nid generation:  0.27231931686401367
local_in_edges_tensor generation:  1.7814557552337646
mini_batch_src_global generation:  2.51117205619812
r_  generation:  30.108489274978638
local_output_nid generation:  0.5538215637207031
local_in_edges_tensor generation:  2.1776599884033203
mini_batch_src_global generation:  3.791273355484009
r_  generation:  30.076287269592285
----------------------check_connections_block total spend ----------------------------- 83.68264698982239
generate_one_block  41.38335418701172
generate_one_block  40.83963656425476
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.3494327068328857
gen group dst list time:  0.19765949249267578
time for parepare:  0.4867541790008545
local_output_nid generation:  0.4284989833831787
local_in_edges_tensor generation:  1.5976307392120361
mini_batch_src_global generation:  2.0694072246551514
r_  generation:  26.577807903289795
local_output_nid generation:  0.7292428016662598
local_in_edges_tensor generation:  2.0475666522979736
mini_batch_src_global generation:  2.815256118774414
r_  generation:  26.114342212677002
----------------------check_connections_block total spend ----------------------------- 73.38721585273743
generate_one_block  35.218040466308594
generate_one_block  35.91827082633972
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.428311347961426  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  157.06986284255981
block generation total time  153.3593020439148
average batch blocks generation time:  76.6796510219574
block dataloader generation time/epoch 368.0234311883514
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3755781650543213 |1.3025368452072144 |0.004455089569091797 |0.00016164779663085938 |0.005086302757263184 |0.0028908252716064453 |
----------------------------------------------------------pseudo_mini_loss sum 0.32358700037002563
Total (block generation + training)time/epoch 371.8735725460826
Training time/epoch 3.7904820442199707
Training time without block to device /epoch 1.185408353805542
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.07it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.42it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.12it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.61it/s] 40%|████      | 10/25 [00:00<00:00, 17.94it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.98it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.93it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.96it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.79it/s] 80%|████████  | 20/25 [00:01<00:00, 18.01it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.12it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.00it/s]100%|██████████| 25/25 [00:01<00:00, 17.94it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.14it/s]  8%|▊         | 2/25 [00:00<00:04,  5.20it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.21it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.22it/s] 20%|██        | 5/25 [00:00<00:03,  5.21it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.21it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.21it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.22it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.21it/s] 40%|████      | 10/25 [00:01<00:02,  5.19it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.16it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.17it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.16it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.15it/s] 60%|██████    | 15/25 [00:02<00:02,  4.98it/s] 64%|██████▍   | 16/25 [00:03<00:01,  4.88it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.95it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.81it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.05it/s] 80%|████████  | 20/25 [00:03<00:00,  5.40it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.26it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.14it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.14it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.14it/s]100%|██████████| 25/25 [00:04<00:00,  5.76it/s]100%|██████████| 25/25 [00:04<00:00,  5.21it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.86it/s]  8%|▊         | 2/25 [00:00<00:05,  4.50it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.27it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.73it/s] 20%|██        | 5/25 [00:00<00:03,  5.61it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.68it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.31it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.06it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.95it/s] 40%|████      | 10/25 [00:01<00:02,  5.29it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.57it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.35it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.22it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.18it/s] 60%|██████    | 15/25 [00:02<00:01,  5.12it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.42it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.78it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.03it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.19it/s] 80%|████████  | 20/25 [00:03<00:00,  6.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.41it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.35it/s] 92%|█████████▏| 23/25 [00:04<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:04<00:00,  6.38it/s]100%|██████████| 25/25 [00:04<00:00,  5.76it/s]
Run 00 | Epoch 00296 | Loss 0.3236 | Train 0.6776 | Val 0.6652 | Test 0.5406
Number of nodes during this epoch:  4637661
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42432165145874  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1160356998443604
range selection method range initialization spend 0.02537226676940918
time for parepare:  0.3598928451538086
local_output_nid generation:  0.02614307403564453
local_in_edges_tensor generation:  0.22893738746643066
mini_batch_src_global generation:  0.3690659999847412
r_  generation:  5.49036169052124
local_output_nid generation:  0.027543306350708008
local_in_edges_tensor generation:  0.24269509315490723
mini_batch_src_global generation:  0.5184919834136963
r_  generation:  5.544005870819092
----------------------check_connections_block total spend ----------------------------- 14.492857694625854
generate_one_block  7.2489073276519775
generate_one_block  7.150910139083862
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.047137022018433
gen group dst list time:  0.0910654067993164
time for parepare:  0.47219228744506836
local_output_nid generation:  0.26726245880126953
local_in_edges_tensor generation:  1.6772749423980713
mini_batch_src_global generation:  2.480830669403076
r_  generation:  30.027200937271118
local_output_nid generation:  0.5279052257537842
local_in_edges_tensor generation:  2.1013059616088867
mini_batch_src_global generation:  3.499357223510742
r_  generation:  30.517075777053833
----------------------check_connections_block total spend ----------------------------- 83.57910132408142
generate_one_block  41.07257580757141
generate_one_block  41.27525329589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.259913921356201
gen group dst list time:  0.1870739459991455
time for parepare:  0.48502492904663086
local_output_nid generation:  0.43068957328796387
local_in_edges_tensor generation:  1.671051263809204
mini_batch_src_global generation:  2.024249792098999
r_  generation:  26.20669198036194
local_output_nid generation:  0.7369675636291504
local_in_edges_tensor generation:  2.043447732925415
mini_batch_src_global generation:  2.805192708969116
r_  generation:  26.490723133087158
----------------------check_connections_block total spend ----------------------------- 73.11212801933289
generate_one_block  35.39544486999512
generate_one_block  36.17481303215027
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.42432165145874  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.6912293434143
block generation total time  153.91808700561523
average batch blocks generation time:  76.95904350280762
block dataloader generation time/epoch 368.0298042706769
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37083864212036133 |1.2997925281524658 |0.004442453384399414 |0.00015473365783691406 |0.005068421363830566 |0.0029587745666503906 |
----------------------------------------------------------pseudo_mini_loss sum 0.3243255019187927
Total (block generation + training)time/epoch 371.8796869295615
Training time/epoch 3.7731239795684814
Training time without block to device /epoch 1.1735389232635498
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.21it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.79it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.35it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.59it/s] 40%|████      | 10/25 [00:00<00:00, 17.71it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.37it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.49it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.74it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.92it/s] 80%|████████  | 20/25 [00:01<00:00, 17.88it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.00it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.06it/s]100%|██████████| 25/25 [00:01<00:00, 17.89it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.12it/s]  8%|▊         | 2/25 [00:00<00:04,  5.14it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.15it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.16it/s] 20%|██        | 5/25 [00:00<00:03,  5.15it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.12it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.12it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.12it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.92it/s] 40%|████      | 10/25 [00:02<00:03,  4.61it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.78it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.10it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.40it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.70it/s] 60%|██████    | 15/25 [00:02<00:01,  5.93it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.69it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.97it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.18it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.84it/s] 80%|████████  | 20/25 [00:03<00:00,  5.54it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.38it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.46it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.21it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.17it/s]100%|██████████| 25/25 [00:04<00:00,  5.26it/s]100%|██████████| 25/25 [00:04<00:00,  5.32it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.21it/s]  8%|▊         | 2/25 [00:00<00:03,  6.40it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.67it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.04it/s] 20%|██        | 5/25 [00:00<00:03,  6.17it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.64it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.42it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.26it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.03it/s] 40%|████      | 10/25 [00:01<00:02,  5.34it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.73it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.01it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.25it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.86it/s] 60%|██████    | 15/25 [00:02<00:01,  5.59it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.37it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.43it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.76it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.03it/s] 80%|████████  | 20/25 [00:03<00:00,  5.66it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.92it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.64it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.42it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.69it/s]100%|██████████| 25/25 [00:04<00:00,  5.79it/s]
Run 00 | Epoch 00297 | Loss 0.3243 | Train 0.6778 | Val 0.6669 | Test 0.5416
Number of nodes during this epoch:  4637372
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426266193389893  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0971472263336182
range selection method range initialization spend 0.037497520446777344
time for parepare:  0.38213300704956055
local_output_nid generation:  0.030987024307250977
local_in_edges_tensor generation:  0.2656865119934082
mini_batch_src_global generation:  0.3909797668457031
r_  generation:  5.453604221343994
local_output_nid generation:  0.028786659240722656
local_in_edges_tensor generation:  0.2193610668182373
mini_batch_src_global generation:  0.5004832744598389
r_  generation:  5.926773309707642
----------------------check_connections_block total spend ----------------------------- 14.907089948654175
generate_one_block  7.338074207305908
generate_one_block  7.278119087219238
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.13546085357666
gen group dst list time:  0.08554935455322266
time for parepare:  0.4418659210205078
local_output_nid generation:  0.25968050956726074
local_in_edges_tensor generation:  1.6589295864105225
mini_batch_src_global generation:  2.598034381866455
r_  generation:  29.77481198310852
local_output_nid generation:  0.5278244018554688
local_in_edges_tensor generation:  2.0917234420776367
mini_batch_src_global generation:  3.5106678009033203
r_  generation:  30.16846227645874
----------------------check_connections_block total spend ----------------------------- 83.09875702857971
generate_one_block  40.86221671104431
generate_one_block  41.10553526878357
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.19268536567688
gen group dst list time:  0.18527841567993164
time for parepare:  0.4765315055847168
local_output_nid generation:  0.4233386516571045
local_in_edges_tensor generation:  1.581345558166504
mini_batch_src_global generation:  2.0414905548095703
r_  generation:  25.968465089797974
local_output_nid generation:  0.723675012588501
local_in_edges_tensor generation:  1.935286283493042
mini_batch_src_global generation:  2.9413275718688965
r_  generation:  26.661455154418945
----------------------check_connections_block total spend ----------------------------- 73.42173671722412
generate_one_block  35.2933452129364
generate_one_block  35.78895688056946
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.426266193389893  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.52049374580383
block generation total time  153.05005407333374
average batch blocks generation time:  76.52502703666687
block dataloader generation time/epoch 368.03391766148127
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38493597507476807 |1.3996963500976562 |0.004376411437988281 |0.00018537044525146484 |0.0050421953201293945 |0.0016794204711914062 |
----------------------------------------------------------pseudo_mini_loss sum 0.3248331844806671
Total (block generation + training)time/epoch 371.884336950795
Training time/epoch 4.009619951248169
Training time without block to device /epoch 1.2102272510528564
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.15it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.54it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.19it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.61it/s] 40%|████      | 10/25 [00:00<00:00, 17.82it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.02it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.12it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.18it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.85it/s] 80%|████████  | 20/25 [00:01<00:00, 18.03it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.10it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.07it/s]100%|██████████| 25/25 [00:01<00:00, 18.04it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.51it/s]  8%|▊         | 2/25 [00:00<00:03,  6.66it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.95it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.61it/s] 20%|██        | 5/25 [00:00<00:03,  5.88it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.60it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.82it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.10it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.76it/s] 40%|████      | 10/25 [00:01<00:02,  6.04it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.21it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.33it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.41it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.47it/s] 60%|██████    | 15/25 [00:02<00:01,  6.50it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.57it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.58it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.59it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.61it/s] 80%|████████  | 20/25 [00:03<00:00,  6.64it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.67it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.69it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.67it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.65it/s]100%|██████████| 25/25 [00:03<00:00,  6.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.42it/s]  8%|▊         | 2/25 [00:00<00:03,  6.56it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.56it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.53it/s] 20%|██        | 5/25 [00:00<00:03,  6.51it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.54it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.57it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.50it/s] 40%|████      | 10/25 [00:01<00:02,  6.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.54it/s] 48%|████▊     | 12/25 [00:01<00:01,  6.53it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.00it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.16it/s] 60%|██████    | 15/25 [00:02<00:01,  6.28it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.33it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.42it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.45it/s] 76%|███████▌  | 19/25 [00:02<00:00,  6.48it/s] 80%|████████  | 20/25 [00:03<00:00,  6.43it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.47it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.52it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.50it/s]100%|██████████| 25/25 [00:03<00:00,  7.26it/s]100%|██████████| 25/25 [00:03<00:00,  6.54it/s]
Run 00 | Epoch 00298 | Loss 0.3248 | Train 0.6797 | Val 0.6683 | Test 0.5429
Number of nodes during this epoch:  4637648
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427969455718994  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 1.1055374145507812
range selection method range initialization spend 0.02530837059020996
time for parepare:  0.40135645866394043
local_output_nid generation:  0.02810072898864746
local_in_edges_tensor generation:  0.22979426383972168
mini_batch_src_global generation:  0.3805854320526123
r_  generation:  5.687578439712524
local_output_nid generation:  0.028949975967407227
local_in_edges_tensor generation:  0.2391352653503418
mini_batch_src_global generation:  0.4625668525695801
r_  generation:  5.908787488937378
----------------------check_connections_block total spend ----------------------------- 15.062202453613281
generate_one_block  7.257593631744385
generate_one_block  6.882337331771851
The real block id is  1
get_global_graph_edges_ids_block function  spend 4.033783674240112
gen group dst list time:  0.08845829963684082
time for parepare:  0.47420525550842285
local_output_nid generation:  0.2770838737487793
local_in_edges_tensor generation:  1.7088854312896729
mini_batch_src_global generation:  2.550739049911499
r_  generation:  29.808921575546265
local_output_nid generation:  0.5377209186553955
local_in_edges_tensor generation:  2.1605477333068848
mini_batch_src_global generation:  3.758293390274048
r_  generation:  29.77262854576111
----------------------check_connections_block total spend ----------------------------- 83.02416276931763
generate_one_block  41.09756541252136
generate_one_block  40.875367164611816
The real block id is  0
get_global_graph_edges_ids_block function  spend 3.431778907775879
gen group dst list time:  0.18142199516296387
time for parepare:  0.4712812900543213
local_output_nid generation:  0.42201995849609375
local_in_edges_tensor generation:  1.582366943359375
mini_batch_src_global generation:  2.019408702850342
r_  generation:  26.403164625167847
local_output_nid generation:  0.7384421825408936
local_in_edges_tensor generation:  1.9422528743743896
mini_batch_src_global generation:  2.824782609939575
r_  generation:  26.682798385620117
----------------------check_connections_block total spend ----------------------------- 73.16209816932678
generate_one_block  35.316364765167236
generate_one_block  36.13877034187317
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.4617919921875 GB
    Memory Allocated: 4.427969455718994  GigaBytes
Max Memory Allocated: 12.219849586486816  GigaBytes

connection checking time:  156.1862609386444
block generation total time  153.42806768417358
average batch blocks generation time:  76.71403384208679
block dataloader generation time/epoch 368.0389863280548
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3929014205932617 |1.3245854377746582 |0.0044443607330322266 |0.00014710426330566406 |0.004969596862792969 |0.0030395984649658203 |
----------------------------------------------------------pseudo_mini_loss sum 0.32348746061325073
Total (block generation + training)time/epoch 371.8894630889829
Training time/epoch 3.867422342300415
Training time without block to device /epoch 1.2182514667510986
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.02it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.71it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.30it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.67it/s] 40%|████      | 10/25 [00:00<00:00, 17.77it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.09it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.19it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.26it/s] 80%|████████  | 20/25 [00:01<00:00, 18.22it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.25it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.26it/s]100%|██████████| 25/25 [00:01<00:00, 18.19it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.47it/s]  8%|▊         | 2/25 [00:00<00:03,  6.52it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.55it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.56it/s] 20%|██        | 5/25 [00:00<00:03,  6.56it/s] 24%|██▍       | 6/25 [00:00<00:02,  6.54it/s] 28%|██▊       | 7/25 [00:01<00:02,  6.50it/s] 32%|███▏      | 8/25 [00:01<00:02,  6.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.51it/s] 40%|████      | 10/25 [00:01<00:02,  6.26it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.32it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.19it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.19it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.96it/s] 60%|██████    | 15/25 [00:02<00:01,  5.78it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.80it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.91it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.04it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.16it/s] 80%|████████  | 20/25 [00:03<00:00,  6.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.30it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.31it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.34it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.39it/s]100%|██████████| 25/25 [00:03<00:00,  6.37it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.23it/s]  8%|▊         | 2/25 [00:00<00:03,  6.35it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.36it/s] 16%|█▌        | 4/25 [00:00<00:03,  6.04it/s] 20%|██        | 5/25 [00:00<00:03,  6.02it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.82it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.83it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.86it/s] 36%|███▌      | 9/25 [00:01<00:02,  6.01it/s] 40%|████      | 10/25 [00:01<00:02,  6.12it/s] 44%|████▍     | 11/25 [00:01<00:02,  6.18it/s] 48%|████▊     | 12/25 [00:01<00:02,  6.25it/s] 52%|█████▏    | 13/25 [00:02<00:01,  6.28it/s] 56%|█████▌    | 14/25 [00:02<00:01,  6.31it/s] 60%|██████    | 15/25 [00:02<00:01,  6.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  6.38it/s] 68%|██████▊   | 17/25 [00:02<00:01,  6.32it/s] 72%|███████▏  | 18/25 [00:02<00:01,  6.33it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.36it/s] 80%|████████  | 20/25 [00:03<00:00,  6.34it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.33it/s] 88%|████████▊ | 22/25 [00:03<00:00,  6.36it/s] 92%|█████████▏| 23/25 [00:03<00:00,  6.35it/s] 96%|█████████▌| 24/25 [00:03<00:00,  6.24it/s]100%|██████████| 25/25 [00:03<00:00,  7.00it/s]100%|██████████| 25/25 [00:03<00:00,  6.30it/s]
Run 00 | Epoch 00299 | Loss 0.3235 | Train 0.6791 | Val 0.6677 | Test 0.5430
Number of nodes during this epoch:  4637581
The number of model layers:  3
Run 01:
Highest Train: 70.92
Highest Valid: 70.12
  Final Train: 70.92
   Final Test: 55.69
The number of model layers:  3
All runs:
Highest Train: 70.92 ± nan
Highest Valid: 70.12 ± nan
  Final Train: 70.92 ± nan
   Final Test: 55.69 ± nan
